original_index,question,cypher,typeql
0,What are the top 5 movies with a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has runtime $r, has title $t;
$r > 120;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
1,List the first 3 directors born before 1950.,"MATCH (d:Director)
WHERE d.born < date('1950-01-01')
RETURN d.name, d.born
ORDER BY d.born
LIMIT 3","match
$d isa person, has born $b, has name $n;
directed (director: $d, film: $m);
$b < 1950-01-01;
sort $b asc;
limit 3;
fetch { ""name"": $n, ""born"": $b };"
2,Which 5 users have rated more than 20 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
WHERE numRatings > 20
RETURN u.name, numRatings
ORDER BY numRatings DESC
LIMIT 5","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $u, $n;
match $numRatings > 20;
sort $numRatings desc;
limit 5;
fetch { ""name"": $n, ""numRatings"": $numRatings };"
3,Identify the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
match $numMovies > 10;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
4,What are the top 3 genres associated with movies released after 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.year > 2000
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has year $y;
$y > 2000;
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $n;
sort $count desc;
limit 3;
fetch { ""genre"": $n, ""count"": $count };"
5,List the first 3 movies with a budget over 100 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has budget $b, has title $t;
$b > 100000000;
sort $b desc;
limit 3;
fetch { ""title"": $t, ""budget"": $b };"
6,Which 5 directors have directed at least 5 movies with an IMDb rating above 7.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 7.0
WITH d, count(m) AS numMovies
WHERE numMovies >= 5
RETURN d.name AS director, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$d isa person, has name $n;
$m isa movie, has imdb_rating $r;
$r > 7.0;
directed (director: $d, film: $m);
reduce $num_movies = count($m) groupby $d, $n;
match $num_movies >= 5;
sort $num_movies desc;
limit 5;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
7,Show the top 3 actors who have acted in movies that generated over 500 million in revenue.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
WITH a, count(m) AS numHighRevenueMovies
ORDER BY numHighRevenueMovies DESC
LIMIT 3
RETURN a.name AS actor, numHighRevenueMovies","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has revenue $rev;
$rev > 500000000;
reduce $numHighRevenueMovies = count($m) groupby $n;
sort $numHighRevenueMovies desc;
limit 3;
fetch { ""actor"": $n, ""numHighRevenueMovies"": $numHighRevenueMovies };"
8,What are the first 5 movies that were rated by users named 'John Smith'?,"MATCH (u:User {name: 'John Smith'})-[r:RATED]->(m:Movie)
RETURN m.title
ORDER BY r.timestamp
LIMIT 5","match
$u isa user, has name ""John Smith"";
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has timestamp $ts;
sort $ts asc;
limit 5;
fetch { ""title"": $t };"
9,List the top 3 users who have given the highest average ratings.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avg = mean($rating) groupby $u;
sort $avg desc;
limit 3;
fetch {
  ""user"": $u.name,
  ""avgRating"": $avg
};"
10,Which 5 movies have the most number of votes on IMDb?,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v };"
11,Identify the first 3 genres most frequently linked to movies directed by 'Steven Spielberg'.,"MATCH (d:Director {name: 'Steven Spielberg'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$d isa person, has name ""Steven Spielberg"";
$g isa genre, has name $gn;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;
fetch {
  ""genre"": $gn,
  ""frequency"": $count
};"
12,Show the top 5 movies with revenues exceeding 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
$r > 1000000000;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
13,List the first 3 actors who have played roles in both comedy and action movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Action']
WITH a, count(DISTINCT g.name) AS numGenres
WHERE numGenres = 2
RETURN a.name
LIMIT 3","match
$a isa person, has name $n;
$comedy isa genre, has name ""Comedy"";
$action isa genre, has name ""Action"";
acted_in (actor: $a, film: $m1);
acted_in (actor: $a, film: $m2);
in_genre (film: $m1, genre: $comedy);
in_genre (film: $m2, genre: $action);
limit 3;
fetch { ""name"": $n };"
14,Which 5 directors were born in the USA and have directed at least 3 movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn CONTAINS 'USA'
WITH d, count(m) AS numMovies
WHERE numMovies >= 3
RETURN d.name, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$d isa person, has name $n, has born_in $b;
directed (director: $d, film: $m);
$b like ""%USA%"";
reduce $count = count($m) groupby $d, $n;
match $count >= 3;
sort $count desc;
limit 5;
fetch {
  ""name"": $n,
  ""numMovies"": $count
};"
15,What are the top 3 movies with the highest IMDb ratings that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.year >= 1990 AND m.year < 2000
RETURN m.title, m.imdbRating, m.year
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_rating $r, has year $y;
$y >= 1990;
$y < 2000;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""imdbRating"": $r, ""year"": $y };"
16,List the first 5 movies that involve actors born in France.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor {bornIn: 'France'})
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t;
$a isa person, has born_in ""France"";
acted_in (actor: $a, film: $m);
limit 5;
fetch { ""title"": $t };"
17,Show the top 3 highest-grossing movies of the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y >= 2000;
$y < 2010;
sort $r desc;
limit 3;
fetch { ""movie"": $t, ""revenue"": $r };"
18,Identify the first 5 actors who have acted in movies with a budget less than 50 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 50000000
RETURN a.name
LIMIT 5","match
$a isa person, has name $n;
$m isa movie, has budget $b;
acted_in (actor: $a, film: $m);
$b < 50000000;
limit 5;
fetch { ""name"": $n };"
19,What are the top 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.year
ORDER BY m.year
LIMIT 3","match
$m isa movie, has title $t, has year $y;
sort $y asc;
limit 3;
fetch { ""title"": $t, ""year"": $y };"
20,List the first 5 directors who have a biography listed in the database.,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
LIMIT 5","match
$d isa person, has name $n, has bio $b;
directed (director: $d, film: $m);
limit 5;
fetch { ""name"": $n, ""bio"": $b };"
24,List the top 3 movies that have been released on Christmas Day.,"MATCH (m:Movie)
WHERE m.released ENDS WITH ""12-25""
RETURN m.title, m.released, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has released $r, has imdb_rating $ir;
$r like ""%12-25"";
sort $ir desc;
limit 3;
fetch { ""title"": $t, ""released"": $r, ""imdbRating"": $ir };"
25,Which 5 actors have the highest number of credited roles in the database?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
sort $count desc;
limit 5;
fetch {
  ""actor"": $n,
  ""roles"": $count
};"
26,Identify the first 3 directors who have directed a movie with an IMDb rating lower than 4.0.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating < 4.0
RETURN d.name AS director, m.title AS movie, m.imdbRating AS rating
ORDER BY m.imdbRating
LIMIT 3","match
$d isa person, has name $dn;
$m isa movie, has title $t, has imdb_rating $r;
directed (director: $d, film: $m);
$r < 4.0;
sort $r asc;
limit 3;
fetch { ""director"": $dn, ""movie"": $t, ""rating"": $r };"
27,Show the top 5 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r asc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
29,What are the top 3 highest-budget films directed by directors born in the UK?,"MATCH (d:Director {bornIn: 'UK'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, m.budget AS budget
ORDER BY m.budget DESC
LIMIT 3","match
$d isa person, has born_in ""UK"";
$m isa movie, has title $t, has budget $b;
directed (director: $d, film: $m);
sort $b desc;
limit 3;
fetch { ""movie"": $t, ""budget"": $b };"
30,List the top 5 oldest actors in the database.,"MATCH (a:Actor)
WHERE a.born IS NOT NULL
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match
$a isa person, has name $n, has born $b;
acted_in (actor: $a, film: $m);
sort $b asc;
limit 5;
fetch { ""name"": $n, ""born"": $b };"
31,Which 5 users have rated the most number of 'Horror' movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
RETURN u.name AS user, count(r) AS horror_movies_rated
ORDER BY horror_movies_rated DESC
LIMIT 5","match
$u isa user, has name $n;
$g isa genre, has name ""Horror"";
$r isa rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($r) groupby $u, $n;
sort $count desc;
limit 5;
fetch {
  ""user"": $n,
  ""horror_movies_rated"": $count
};"
32,Identify the first 3 movies with the most number of genres associated.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS movie, genreCount","match
$m isa movie, has title $t;
in_genre (film: $m, genre: $g);
reduce $count = count($g) groupby $m, $t;
sort $count desc;
limit 3;
fetch {
  ""movie"": $t,
  ""genreCount"": $count
};"
34,What are the first 5 movies where the main actor has also directed the film?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 5","match
$p isa person;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
limit 5;
fetch { ""title"": $t };"
35,List the top 3 directors who have also acted in a movie they directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(d)
WITH d, count(*) AS both
ORDER BY both DESC
LIMIT 3
RETURN d.name AS director, both AS directedAndActedCount","match
$d isa person, has name $n;
directed (director: $d, film: $m);
acted_in (actor: $d, film: $m);
reduce $count = count($m) groupby $d;
sort $count desc;
limit 3;
fetch {
  ""director"": $d.name,
  ""directedAndActedCount"": $count
};"
36,Identify the first 3 users who have rated movies released before 1980.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.year < 1980
WITH u, r, m
ORDER BY r.timestamp
RETURN u.name AS user, m.title AS movie, m.year AS year
LIMIT 3","match
$u isa user, has name $un;
$m isa movie, has title $t, has year $y;
$r isa rated (user: $u, film: $m), has timestamp $ts;
$y < 1980;
sort $ts asc;
limit 3;
fetch { ""user"": $un, ""movie"": $t, ""year"": $y };"
37,Show the top 5 movies with the most IMDb votes released after 2010.,"MATCH (m:Movie)
WHERE m.year > 2010 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes, m.year
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v, has year $y;
$y > 2010;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v, ""year"": $y };"
38,What are the first 5 movies with a plot containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t, has plot $p;
$p like ""%adventure%"";
limit 5;
fetch { ""title"": $t };"
39,List the top 3 movies with the most revenue that have a runtime under 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime < 90 AND exists((m)<-[:RATED]-())
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has runtime $rt;
rated (user: $u, film: $m);
$rt < 90;
sort $rev desc;
limit 3;
fetch { ""movie"": $t, ""revenue"": $rev };"
40,Which 5 directors have directed movies in more than 3 different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 5","match
$d isa person, has name $n;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
select $d, $n, $g;
distinct;
reduce $num_genres = count($g) groupby $d, $n;
match $num_genres > 3;
sort $num_genres desc;
limit 5;
fetch { ""director"": $n, ""num_genres"": $num_genres };"
41,Identify the first 3 actors who have acted in movies with at least three different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 3
RETURN a.name AS actor
ORDER BY numDirectors DESC
LIMIT 3","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
directed (director: $d, film: $m);
select $a, $n, $d;
distinct;
reduce $numDirectors = count($d) groupby $a, $n;
match $numDirectors >= 3;
sort $numDirectors desc;
limit 3;
fetch { ""actor"": $n };"
43,What are the first 5 movies to have a poster URL containing 'face'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t, has poster $p;
$p like ""%face%"";
limit 5;
fetch { ""title"": $t };"
44,List the top 3 movies with a budget under 10 million that have generated over 100 million in revenue.,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has budget $b, has revenue $r;
$b < 10000000;
$r > 100000000;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
45,Which 5 users have the most ratings in the 'Comedy' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN u.name AS user, count(r) AS comedyRatings
ORDER BY comedyRatings DESC
LIMIT 5","match
$u isa user, has name $n;
$g isa genre, has name ""Comedy"";
$r isa rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($r) groupby $u, $n;
sort $count desc;
limit 5;
fetch {
  ""user"": $n,
  ""comedyRatings"": $count
};"
47,What are the names of the top 5 movies with a budget over 100 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has title $t, has budget $b;
$b > 100000000;
sort $b desc;
limit 5;
fetch { ""title"": $t };"
48,List the names of 3 directors who directed a movie released after 2010.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.released > '2010'
RETURN d.name
LIMIT 3","match
$d isa person, has name $n;
$m isa movie, has year $y;
directed (director: $d, film: $m);
$y > 2010;
limit 3;
fetch { ""name"": $n };"
49,Who are the actors in the movie titled 'Open Season'?,"MATCH (m:Movie {title: 'Open Season'})<-[:ACTED_IN]-(a:Actor)
RETURN a.name AS actor","match
$m isa movie, has title ""Open Season"";
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
fetch { ""actor"": $n };"
50,"Which movies have been rated by more than 600,000 IMDb users?","MATCH (m:Movie)
WHERE m.imdbVotes > 600000
RETURN m.title, m.imdbVotes","match
$m isa movie, has title $t, has imdb_votes $v;
$v > 600000;
fetch { ""title"": $t, ""imdbVotes"": $v };"
51,Name the top 5 highest-grossing movies directed by Harold Lloyd.,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match
$d isa person, has name ""Harold Lloyd"";
$m isa movie, has title $t, has revenue $r;
directed (director: $d, film: $m);
sort $r desc;
limit 5;
fetch { ""movie"": $t, ""revenue"": $r };"
52,What are the three most recent movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match
$m isa movie, has title $t, has released $r;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""released"": $r };"
53,List all genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
$m isa movie, has title ""Toy Story"";
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
fetch { ""genre"": $gn };"
54,Who are the top 5 actors by the number of movies acted in the 'Adventure' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
WITH a, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5
RETURN a.name AS actor, movieCount","match
$a isa person, has name $n;
$g isa genre, has name ""Adventure"";
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $a;
sort $count desc;
limit 5;
fetch {
  ""actor"": $a.name,
  ""movieCount"": $count
};"
55,What are the IMDb ratings of movies directed by François Lallement?,"MATCH (p:Person {name: 'François Lallement'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, m.imdbRating AS imdbRating","match
$d isa person, has name ""François Lallement"";
$m isa movie, has title $t, has imdb_rating $r;
directed (director: $d, film: $m);
fetch { ""movie"": $t, ""imdbRating"": $r };"
56,Which users rated the movie with an IMDb ID '0787474'?,"MATCH (u:User)-[r:RATED]->(m:Movie {imdbId: '0787474'})
RETURN u.name AS user, r.rating AS rating","match
$m isa movie, has imdb_id ""0787474"";
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
fetch { ""user"": $n, ""rating"": $rating };"
57,List the top 3 highest revenue movies released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y >= 2000;
$y < 2010;
sort $r desc;
limit 3;
fetch { ""movie"": $t, ""revenue"": $r };"
58,What are the names of users who rated a movie from the 'Animation' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN u.name","match
$u isa user, has name $n;
$g isa genre, has name ""Animation"";
rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""name"": $n };"
59,Find the names of all directors who were born in France.,"MATCH (d:Director)
WHERE d.bornIn = 'France'
RETURN d.name","match
$d isa person, has name $n, has born_in ""France"";
directed (director: $d, film: $m);
fetch { ""name"": $n };"
60,Which movies have a runtime longer than 180 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 180
RETURN m.title, m.runtime","match
$m isa movie, has title $t, has runtime $r;
$r > 180;
fetch { ""title"": $t, ""runtime"": $r };"
61,Name the actors who have acted in movies with a budget less than 50 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 50000000
RETURN DISTINCT a.name AS actor","match
$a isa person, has name $n;
$m isa movie, has budget $b;
acted_in (actor: $a, film: $m);
$b < 50000000;
fetch { ""actor"": $n };"
62,List the movies that have been both directed and acted in by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
$p isa person, has name $n;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
fetch { ""movie"": $t, ""person"": $n };"
64,Which movies have won more than 200 million dollars but were rated below 6.0 on IMDb?,"MATCH (m:Movie)
WHERE m.revenue > 200000000 AND m.imdbRating < 6.0
RETURN m.title, m.revenue, m.imdbRating","match
$m isa movie, has title $t, has revenue $r, has imdb_rating $ir;
$r > 200000000;
$ir < 6.0;
fetch { ""title"": $t, ""revenue"": $r, ""imdbRating"": $ir };"
65,List the movies where the primary language is English and have a runtime of exactly 96 minutes.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND m.runtime = 96
RETURN m.title","match
$m isa movie, has title $t, has languages $l, has runtime $r;
$l like ""%English%"";
$r == 96;
fetch { ""title"": $t };"
66,Name the top 5 movies with the most IMDb votes released before the year 2000.,"MATCH (m:Movie)
WHERE m.year < 2000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v, has year $y;
$y < 2000;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v };"
67,Which genres have the most movies with a runtime over 120 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 120
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 10","match
$g isa genre, has name $gn;
$m isa movie, has runtime $r;
in_genre (film: $m, genre: $g);
$r > 120;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 10;
fetch {
  ""genre"": $g.name,
  ""numMovies"": $count
};"
68,List the names of movies that have a plot mentioning 'friendship'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title","match
$m isa movie, has title $t, has plot $p;
$p like ""%friendship%"";
fetch { ""title"": $t };"
70,Who are the directors of movies that have an IMDb rating greater than 8.0?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
WHERE m.imdbRating > 8.0
RETURN DISTINCT d.name AS director","match
$d isa person, has name $n;
$m isa movie, has imdb_rating $r;
directed (director: $d, film: $m);
$r > 8.0;
fetch { ""director"": $n };"
71,List the movies that have been rated by user '1'.,"MATCH (u:User {userId: '1'})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating $rating;
fetch { ""title"": $t, ""rating"": $rating };"
72,Which actors have appeared in movies released in the 'Comedy' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN DISTINCT a.name AS actor","match
$a isa person, has name $n;
$g isa genre, has name ""Comedy"";
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""actor"": $n };"
73,"What are the names of the movies directed by persons born in 'Burchard, Nebraska, USA'?","MATCH (p:Person {bornIn: 'Burchard, Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title","match
$p isa person, has born_in ""Burchard, Nebraska, USA"";
$m isa movie, has title $t;
directed (director: $p, film: $m);
fetch { ""title"": $t };"
74,Name the movies where the main language is not English and have a budget over 75 million dollars.,"MATCH (m:Movie)
WHERE m.languages[0] <> 'English' AND m.budget > 75000000
RETURN m.title","match
$m isa movie, has title $t, has languages $l, has budget $b;
not { $l like ""English%""; };
$b > 75000000;
fetch { ""title"": $t };"
75,List the top 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
76,Name genres in which Harold Lloyd has directed movies.,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name","match
$d isa person, has name ""Harold Lloyd"";
$g isa genre, has name $gn;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""name"": $gn };"
77,Which users have rated movies directed by directors born after 1960?,"MATCH (u:User)-[:RATED]->(m:Movie)<-[:DIRECTED]-(d:Director)
WHERE d.born > date('1960-01-01')
RETURN DISTINCT u","match
$u isa user, has name $un;
$d isa person, has born $b;
rated (user: $u, film: $m);
directed (director: $d, film: $m);
$b > 1960-01-01;
fetch { ""user"": $un };"
78,Name the movies that have posters ending with 'w5Lctmkc1yah215Luxmci4djaiW.jpg'.,"MATCH (m:Movie)
WHERE m.poster ENDS WITH 'w5Lctmkc1yah215Luxmci4djaiW.jpg'
RETURN m.title","match
$m isa movie, has title $t, has poster $p;
$p like ""%w5Lctmkc1yah215Luxmci4djaiW.jpg"";
fetch { ""title"": $t };"
79,List the top 3 actors by the number of roles in movies released after 2010.,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year > 2010
RETURN a.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match
$a isa person, has name $n;
$m isa movie, has year $y;
$r isa acted_in (actor: $a, film: $m);
$y > 2010;
reduce $count = count($r) groupby $a;
sort $count desc;
limit 3;
fetch {
  ""actor"": $a.name,
  ""roles"": $count
};"
80,Which movies have been rated by users named 'Omar Huffman'?,"MATCH (u:User {name: 'Omar Huffman'})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
$u isa user, has name ""Omar Huffman"";
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating $rating;
fetch { ""movie"": $t, ""rating"": $rating };"
81,Name the genres of movies that have a plot mentioning 'army'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.plot CONTAINS 'army'
RETURN DISTINCT g.name","match
$m isa movie, has plot $p;
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
$p like ""%army%"";
fetch { ""name"": $gn };"
82,List movies with a revenue less than 20 million dollars and released before 1980.,"MATCH (m:Movie)
WHERE m.revenue < 20000000 AND m.released < '1980-01-01'
RETURN m.title, m.released, m.revenue","match
$m isa movie, has title $t, has revenue $r, has year $y;
$r < 20000000;
$y < 1980;
fetch { ""title"": $t, ""year"": $y, ""revenue"": $r };"
83,What are the IMDb ratings of movies that have a plot mentioning 'evil exterminator'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil exterminator'
RETURN m.title, m.imdbRating","match
$m isa movie, has title $t, has plot $p, has imdb_rating $r;
$p like ""%evil exterminator%"";
fetch { ""title"": $t, ""imdbRating"": $r };"
84,Name the movies that have been acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title","match
$p isa person;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
fetch { ""title"": $t };"
85,Which movies have a runtime greater than 120 minutes and were released after 2000?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.year > 2000
RETURN m.title, m.runtime, m.year","match
$m isa movie, has title $t, has runtime $r, has year $y;
$r > 120;
$y > 2000;
fetch { ""title"": $t, ""runtime"": $r, ""year"": $y };"
86,What are the top 5 highest-grossing movies that were released before 2010?,"MATCH (m:Movie)
WHERE m.released < '2010-01-01' AND exists {(m)<-[:ACTED_IN]-(:Person)}
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r, has year $y;
acted_in (actor: $a, film: $m);
$y < 2010;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
87,List 3 movies directed by 'Anthony Stacchi'.,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match
$d isa person, has name ""Anthony Stacchi"";
$m isa movie, has title $t;
directed (director: $d, film: $m);
limit 3;
fetch { ""title"": $t };"
88,Which 5 actors have acted in the most movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a;
sort $count desc;
limit 5;
fetch {
  ""actor"": $a.name,
  ""movieCount"": $count
};"
89,What are the top 3 genres by the number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.name,
  ""movieCount"": $count
};"
90,Who are the top 5 directors by the number of movies they have directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
reduce $count = count($m) groupby $d;
sort $count desc;
limit 5;
fetch {
  ""director"": $d.name,
  ""numMovies"": $count
};"
91,"What are the top 5 movies by IMDB rating that have more than 100,000 IMDB votes?","MATCH (m:Movie)
WHERE m.imdbVotes > 100000
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r, has imdb_votes $v;
$v > 100000;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r };"
92,Which movies have been rated by user '1' and have a rating greater than 8?,"MATCH (u:User {userId: '1'})-[r:RATED]->(m:Movie)
WHERE r.rating > 8
RETURN m.title, r.rating","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m), has rating $r;
$r > 8;
fetch { ""title"": $t, ""rating"": $r };"
93,List the movies that have grossed over 1 billion USD in revenue.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m.title, m.revenue","match
$m isa movie, has title $t, has revenue $r;
$r > 1000000000;
fetch { ""title"": $t, ""revenue"": $r };"
94,What are the top 3 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""runtime"": $r };"
95,Provide the names of 3 actors who have also directed movies.,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match
$p isa person, has name $n;
acted_in (actor: $p, film: $m1);
directed (director: $p, film: $m2);
limit 3;
fetch { ""name"": $n };"
98,List 3 movies that were released in the 1990s and have an IMDB rating above 7.,"MATCH (m:Movie)
WHERE m.year >= 1990 AND m.year < 2000
  AND m.imdbRating > 7
RETURN m.title, m.year, m.imdbRating
LIMIT 3","match
$m isa movie, has title $t, has year $y, has imdb_rating $r;
$y >= 1990;
$y < 2000;
$r > 7;
limit 3;
fetch { ""title"": $t, ""year"": $y, ""imdbRating"": $r };"
99,Which directors were born in the USA?,"MATCH (d:Director)
WHERE d.bornIn CONTAINS 'USA'
RETURN d.name AS director, d.bornIn AS bornIn","match
$d isa person, has name $n, has born_in $b;
directed (director: $d, film: $m);
$b like ""%USA%"";
fetch { ""director"": $n, ""bornIn"": $b };"
100,"What are the top 5 highest-rated movies by users, based on the average user rating?","MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating","match
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m), has rating $r;
reduce $avg = mean($r) groupby $m, $t;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $t,
  ""avgRating"": $avg
};"
101,List the movies that have a budget greater than 200 million USD.,"MATCH (m:Movie)
WHERE m.budget > 200000000
RETURN m.title, m.budget","match
$m isa movie, has title $t, has budget $b;
$b > 200000000;
fetch { ""title"": $t, ""budget"": $b };"
102,Which 3 movies feature both English and Japanese languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'Japanese' IN m.languages
RETURN m.title
LIMIT 3","match
$m isa movie, has title $t, has languages $l;
$l like ""%English%"";
$l like ""%Japanese%"";
limit 3;
fetch { ""title"": $t };"
103,What are the top 3 movies by revenue released in 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y == 2014;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $r };"
104,Which actors have played in a movie and also directed a movie?,"MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
  AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name AS name","match
$p isa person, has name $n;
acted_in (actor: $p, film: $m1);
directed (director: $p, film: $m2);
fetch { ""name"": $n };"
105,Who are the 5 most frequent actors in the 'Adventure' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
WITH a, count(*) AS count
ORDER BY count DESC
LIMIT 5
RETURN a.name AS actor, count","match
$a isa person, has name $n;
$g isa genre, has name ""Adventure"";
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $a;
sort $count desc;
limit 5;
fetch {
  ""actor"": $a.name,
  ""count"": $count
};"
106,List the 3 oldest directors based on their birth date.,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d.name, d.born
ORDER BY d.born
LIMIT 3","match
$d isa person, has name $n, has born $b;
directed (director: $d, film: $m);
sort $b asc;
limit 3;
fetch { ""name"": $n, ""born"": $b };"
107,Which movies have both high revenue (over 500 million USD) and high imdbRating (above 8.0)?,"MATCH (m:Movie)
WHERE m.revenue > 500000000 AND m.imdbRating > 8.0
RETURN m.title, m.revenue, m.imdbRating","match
$m isa movie, has title $t, has revenue $r, has imdb_rating $ir;
$r > 500000000;
$ir > 8.0;
fetch { ""title"": $t, ""revenue"": $r, ""imdbRating"": $ir };"
108,What are the most recent 3 movies directed by any director born in Canada?,"MATCH (d:Director {bornIn: 'Canada'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year
ORDER BY m.year DESC
LIMIT 3","match
$d isa person, has born_in ""Canada"";
$m isa movie, has title $t, has year $y;
directed (director: $d, film: $m);
sort $y desc;
limit 3;
fetch { ""title"": $t, ""year"": $y };"
109,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match
$u isa user, has name $n;
rated (user: $u, film: $m);
reduce $count = count($m) groupby $u, $n;
sort $count desc;
limit 3;
fetch {
  ""user"": $n,
  ""numRatings"": $count
};"
110,What are the top 3 highest budget movies that failed to gross more than their budget?,"MATCH (m:Movie)
WHERE m.revenue < m.budget
RETURN m.title, m.budget, m.revenue
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has title $t, has budget $b, has revenue $r;
$r < $b;
sort $b desc;
limit 3;
fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
111,Which movies have been rated by more than 1000 users?,"MATCH (m:Movie)
WHERE m.imdbVotes > 1000
RETURN m.title, m.imdbVotes","match
$m isa movie, has title $t, has imdb_votes $v;
$v > 1000;
fetch {
  ""title"": $t,
  ""imdb_votes"": $v
};"
113,What movies have a runtime longer than 120 minutes and were released after 2000?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.released > '2000-01-01'
RETURN m.title, m.released, m.runtime","match
$m isa movie, has title $t, has released $rel, has runtime $rt;
$rt > 120;
$rel > ""2000-01-01"";
fetch { ""title"": $t, ""released"": $rel, ""runtime"": $rt };"
114,List the top 5 movies with the highest IMDb rating.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r };"
115,What are the names of actors who have acted in more than five movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a;
match $count > 5;
fetch { ""name"": $a.name };"
116,Which users have rated movies in the 'Adventure' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN u, r, m","match
$u isa user, has name $n;
$g isa genre, has name ""Adventure"";
rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""name"": $n };"
117,What movies had a budget greater than 100 million dollars and were directed by a director born in the USA?,"MATCH (m:Movie)
WHERE m.budget > 100000000
AND exists {
  (d:Director)-[:DIRECTED]->(m)
  WHERE d.bornIn CONTAINS 'USA'
}
RETURN m.title, m.budget, m.year","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
$m has budget $b;
$b > 100000000;
reduce $num_high_budget_movies = count($m) groupby $n;
sort $num_high_budget_movies desc;
limit 10;
fetch { ""director"": $n, ""num_high_budget_movies"": $num_high_budget_movies };"
118,Find all movies where the revenue was more than double the budget.,"MATCH (m:Movie)
WHERE m.revenue > 2 * m.budget
RETURN m.title, m.budget, m.revenue","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > ($bud * 2);
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
119,What genres have more than ten movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
WHERE movieCount > 10
RETURN g.name AS genre, movieCount","match
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
match $count > 10;
fetch {
  ""genre"": $gn,
  ""movieCount"": $count
};"
120,Which movies have been rated by both user '1' and user '2'?,"MATCH (u1:User {userId: '1'})-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User {userId: '2'})
RETURN m.title","match
$u1 isa user, has user_id ""1"";
$u2 isa user, has user_id ""2"";
$m isa movie, has title $t;
(user: $u1, film: $m) isa rated;
(user: $u2, film: $m) isa rated;
fetch { ""title"": $t };"
121,What are the names of directors who have directed both a 'Comedy' and a 'Drama' movie?,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
WHERE exists{ (d)-[:DIRECTED]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'}) }
RETURN DISTINCT d.name","match
$d isa person, has name $n;
(director: $d, film: $m1) isa directed;
(film: $m1, genre: $g1) isa in_genre;
$g1 has name ""Comedy"";
(director: $d, film: $m2) isa directed;
(film: $m2, genre: $g2) isa in_genre;
$g2 has name ""Drama"";
fetch { ""director"": $n };"
122,How many movies have been released in each year from 2010 to 2020?,"MATCH (m:Movie)
WHERE m.year >= 2010 AND m.year <= 2020
RETURN m.year AS year, count(m) AS numMovies
ORDER BY year","match
$m isa movie, has year $y;
$y >= 2010;
$y <= 2020;
reduce $count = count($m) groupby $y;
sort $y asc;
fetch { ""year"": $y, ""numMovies"": $count };"
124,List the top 3 movies with the most IMDb votes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 3;
fetch { ""title"": $t, ""imdbVotes"": $v };"
125,Which directors have a bio that mentions 'Academy Award'?,"MATCH (d:Director)
WHERE d.bio CONTAINS 'Academy Award'
RETURN d.name, d.bio","match
$d isa person, has name $n, has bio $b;
directed (director: $d, film: $m);
$b like ""%Academy Award%"";
fetch { ""name"": $n };"
126,What movies have both English and French as their languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m.title","match
$m isa movie, has title $t, has languages $l;
$l like ""%English%"";
$l like ""%French%"";
fetch { ""title"": $t };"
127,How many users have rated the movie with the IMDb ID '0114709'?,"MATCH (m:Movie {imdbId: '0114709'})
MATCH (u:User)-[r:RATED]->(m)
RETURN count(u) AS numUsers","match
$m isa movie, has imdb_id ""0114709"";
rated (user: $u, film: $m);
reduce $count = count($u);"
128,Which actor has the highest number of roles in movies released before 1980?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year < 1980
WITH a, count(r) AS numRoles
RETURN a.name AS actor, numRoles
ORDER BY numRoles DESC
LIMIT 1","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has year $y;
$y < 1980;
reduce $numRoles = count($m) groupby $n;
sort $numRoles desc;
limit 1;
fetch { ""actor"": $n, ""numRoles"": $numRoles };"
129,Can you list all genres that a movie with the title 'Toy Story' falls under?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
$m isa movie, has title ""Toy Story"";
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
fetch { ""genre"": $gn };"
130,Which movies feature actors born in France?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor {bornIn: 'France'})
RETURN m.title, a.name","match
$a isa person, has name $n, has born_in ""France"";
$m isa movie, has title $t;
acted_in (actor: $a, film: $m);
fetch { ""title"": $t };"
131,What are the top 5 highest-grossing movies of 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y == 2014;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
132,How many genres has each movie been classified under?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN m.title AS movie, count(g) AS genreCount","match
$m isa movie, has title $t;
in_genre (film: $m, genre: $g);
reduce $count = count($g) groupby $t;"
133,Which movie had the largest number of actors participating?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 1","match
$m isa movie, has title $t;
acted_in (actor: $a, film: $m);
reduce $count = count($a) groupby $m, $t;
sort $count desc;
limit 1;
fetch {
  ""movie"": $t,
  ""numActors"": $count
};"
134,List all movies directed by someone who was born after 1970.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > date('1970-01-01')
RETURN m.title AS movie, p.name AS director, p.born AS birthDate","match
$p isa person, has name $n, has born $b;
(director: $p, film: $m) isa directed;
$m has title $t;
$b > 1970-01-01;
fetch { ""movie"": $t, ""director"": $n, ""birthDate"": $b };"
135,What is the average IMDb rating of movies with a runtime under 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating IS NOT NULL
RETURN avg(m.imdbRating) AS averageRating","match
$m isa movie, has runtime $rt, has imdb_rating $r;
$rt < 90;
reduce $averageRating = mean($r);
fetch { ""averageRating"": $averageRating };"
136,Which movies have been rated exactly 5 by more than one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5
WITH m, count(u) AS numRatings
WHERE numRatings > 1
RETURN m.title AS movie, numRatings","match
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m), has rating $r;
$r == 5.0;
reduce $count = count($u) groupby $m, $t;
match $count > 1;
fetch {
  ""movie"": $t,
  ""numRatings"": $count
};"
137,Find movies where the sum of the revenue and budget is more than 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue + m.budget > 1000000000
RETURN m.title, m.revenue, m.budget","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
($rev + $bud) > 1000000000;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
139,List the top 5 movies by revenue that were released in the last five years of the schema's data range.,"MATCH (m:Movie)
WHERE m.released >= '2011'
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has released $rel;
$rel >= ""2011"";
sort $rev desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev };"
140,Which users have rated a movie but have not rated any movie in the 'Sci-Fi' genre?,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE NOT exists {
  (u)-[:RATED]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Sci-Fi'})
}
RETURN u, m","match
$u isa user, has name $n;
rated (user: $u, film: $m);
$m has title $t;
not {
    rated (user: $u, film: $scifi_movie);
    in_genre (film: $scifi_movie, genre: $g);
    $g has name ""Sci-Fi"";
};
fetch { ""user"": $n, ""movie"": $t };"
141,What are the different roles played by actors in the movie with the IMDb ID '0829150'?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie {imdbId: '0829150'})
RETURN a.name AS actor, r.role AS role","match
$m isa movie, has imdb_id ""0829150"";
(actor: $a, film: $m) isa acted_in, has character_role $role;
$a has name $n;
fetch { ""actor"": $n, ""role"": $role };"
142,List all the movies that have been both directed and acted in by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
$p isa person, has name $n;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
fetch { ""title"": $t, ""person"": $n };"
143,Which actor has the most diverse filmography in terms of genres acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
RETURN a.name AS actor, genreCount
ORDER BY genreCount DESC
LIMIT 1","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
select $a, $n, $g;
distinct;
reduce $count = count($g) groupby $a, $n;
sort $count desc;
limit 1;
fetch {
  ""actor"": $n,
  ""genreCount"": $count
};
"
144,What are the names of the users who rated the movie 'Dracula Untold'?,"MATCH (m:Movie {title: 'Dracula Untold'})<-[r:RATED]-(u:User)
RETURN u.name","match
$m isa movie, has title ""Dracula Untold"";
$u isa user, has name $n;
(user: $u, film: $m) isa rated;
fetch { ""name"": $n };"
145,Which directors have a poster URL that includes 'w440_and_h660_face'?,"MATCH (d:Director)
WHERE d.poster CONTAINS 'w440_and_h660_face'
RETURN d.name, d.poster","match
$d isa person, has name $n, has poster $p;
(director: $d, film: $m) isa directed;
$p like "".*w440_and_h660_face.*"";
fetch { ""name"": $n, ""poster"": $p };"
146,List the movies that have a plot mentioning 'kingdom'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'kingdom'
RETURN m.title, m.plot","match
$m isa movie, has title $t, has plot $p;
$p like ""%kingdom%"";
fetch { ""title"": $t };"
147,"What is the total revenue generated by movies directed by directors born in 'Burchard, Nebraska, USA'?","MATCH (d:Director {bornIn: 'Burchard, Nebraska, USA'})-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN sum(m.revenue) AS totalRevenue","match
$d isa person, has name $n, has born_in ""Burchard, Nebraska, USA"";
(director: $d, film: $m) isa directed;
$m has revenue $rev;
reduce $totalRevenue = sum($rev);
fetch { ""totalRevenue"": $totalRevenue };"
149,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
sort $r asc;
limit 3;
fetch { ""title"": $t, ""runtime"": $r };"
151,"What are the IMDb IDs of movies that have more than 500,000 IMDb votes?","MATCH (m:Movie)
WHERE m.imdbVotes > 500000
RETURN m.imdbId","match
$m isa movie, has imdb_id $id, has imdb_votes $v;
$v > 500000;
fetch { ""imdbId"": $id };"
152,Which movies have been acted in by persons born before 1900?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < date('1900-01-01')
RETURN m.title AS movie, p.name AS actor, p.born AS birthDate","match
$p isa person, has name $n, has born $b;
(actor: $p, film: $m) isa acted_in;
$m has title $t;
$b < 1900-01-01;
fetch { ""movie"": $t, ""actor"": $n, ""birthDate"": $b };"
153,What are the top 5 movies by revenue released in 1995?,"MATCH (m:Movie)
WHERE m.year = 1995 AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has year 1995;
sort $rev desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev };"
154,Which movies have a runtime longer than 150 minutes and less than 200 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.runtime < 200
RETURN m.title, m.runtime","match
$m isa movie, has title $t, has runtime $rt;
$rt > 150;
$rt < 200;
fetch { ""title"": $t, ""runtime"": $rt };"
155,List the top 3 highest imdbRating movies that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.released < '2000-01-01' AND exists((m)-[:IN_GENRE]->(:Genre))
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_rating $r, has released $rel;
(film: $m, genre: $g) isa in_genre;
$rel < ""2000-01-01"";
sort $r desc;
limit 3;
fetch { ""title"": $t, ""imdbRating"": $r };"
157,Which directors have directed more than one movie in the 'Drama' genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WITH d, count(m) AS num_drama_movies
WHERE num_drama_movies > 1
RETURN d.name AS director, num_drama_movies","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
(film: $m, genre: $g) isa in_genre;
$g has name ""Drama"";
reduce $num_drama_movies = count($m) groupby $n;
sort $num_drama_movies desc;
limit 10;
fetch { ""director"": $n, ""num_drama_movies"": $num_drama_movies };"
158,List the top 3 movies with the highest number of imdbVotes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 3;
fetch { ""title"": $t, ""imdbVotes"": $v };"
159,What are the top 5 movies with the most countries listed in their production?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries
ORDER BY size(m.countries) DESC
LIMIT 5","match
$m isa movie, has title $t, has countries $c;
reduce $count = count($c) groupby $m, $t;
sort $count desc;
limit 5;
fetch { ""title"": $t, ""country_count"": $count };"
160,Which users have rated more than 5 movies with a rating above 7.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating > 7.0
WITH u, count(r) AS numHighRatings
WHERE numHighRatings > 5
RETURN u.name AS user, numHighRatings","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
$rating > 7.0;
reduce $numHighRatings = count($r) groupby $n;
sort $numHighRatings desc;
limit 10;
fetch { ""user"": $n, ""numHighRatings"": $numHighRatings };"
161,List the top 3 genres with the most movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
reduce $movieCount = count($m) groupby $n;
sort $movieCount desc;
limit 3;
fetch { ""genre"": $n, ""movieCount"": $movieCount };"
162,What are the 5 most recent movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: 'USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match
$d isa person, has born_in $b;
$m isa movie, has title $t, has year $y;
directed (director: $d, film: $m);
$b like ""%USA%"";
sort $y desc;
limit 5;
fetch { ""title"": $t, ""year"": $y };"
163,Which actors have acted in both 'Comedy' and 'Drama' genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama'] 
WITH a, collect(distinct g.name) AS genres
WHERE size(genres) = 2
RETURN a.name AS actor","match
$a isa person, has name $n;
$g1 isa genre, has name ""Comedy"";
$g2 isa genre, has name ""Drama"";
acted_in (actor: $a, film: $m1);
acted_in (actor: $a, film: $m2);
in_genre (film: $m1, genre: $g1);
in_genre (film: $m2, genre: $g2);
fetch { ""name"": $n };"
164,List the top 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
165,Which movies have been rated by more than 1000 users?,"MATCH (m:Movie)
WHERE m.imdbVotes > 1000
RETURN m.title, m.imdbVotes","match
$m isa movie, has title $t, has imdb_votes $v;
$v > 1000;
fetch {
  ""title"": $t,
  ""imdbVotes"": $v
};"
167,List the top 3 movies that have the highest revenue and were released in 2014.,"MATCH (m:Movie)
WHERE m.year = 2014
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has year 2014;
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev };"
168,What are the top 5 directors by number of movies directed in the 'Action' genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Action'})
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match
$d isa person, has name $n;
$g isa genre, has name ""Action"";
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 5;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
169,Which users have the highest average rating given to movies? (minimum 3 ratings),"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 3
RETURN u.name AS user, avgRating
ORDER BY avgRating DESC","match
$u isa user, has name $n;
$rel isa rated (user: $u, film: $m), has rating $r;
reduce $count = count($rel), $avg = mean($r) groupby $u, $n;
match $count >= 3;
sort $avg desc;
fetch { ""user"": $n, ""avgRating"": $avg };"
170,List the genres that have movies with an imdbRating less than 4.0.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.imdbRating < 4.0
RETURN DISTINCT g.name","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
$m has imdb_rating $r;
$r < 4.0;
fetch { ""genre"": $n };"
171,What are the 5 most recent movies with a runtime less than 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90
RETURN m.title, m.released, m.runtime
ORDER BY m.released DESC
LIMIT 5","match
$m isa movie, has title $t, has released $rel, has runtime $rt;
$rt < 90;
sort $rel desc;
limit 5;
fetch { ""title"": $t, ""released"": $rel, ""runtime"": $rt };"
172,Which actors have the most roles in movies with a budget over 100 million dollars?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.budget > 100000000
WITH a, count(r) AS numRoles
ORDER BY numRoles DESC
RETURN a.name AS actor, numRoles
LIMIT 10","match
$a isa person, has name $n;
$m isa movie, has budget $b;
acted_in (actor: $a, film: $m);
$b > 100000000;
reduce $count = count($m) groupby $a;
sort $count desc;
limit 10;
fetch {
  ""actor"": $a.name,
  ""numRoles"": $count
};"
173,List the top 3 movies with the lowest imdbVotes released after 2000.,"MATCH (m:Movie)
WHERE m.year > 2000 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes
LIMIT 3","match
$m isa movie, has title $t, has imdb_votes $v, has year $y;
$y > 2000;
sort $v asc;
limit 3;
fetch { ""title"": $t, ""imdbVotes"": $v };"
174,What are the top 5 actors by number of movies acted in with a revenue greater than 500 million dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has revenue $rev;
$rev > 500000000;
reduce $numHighRevenueMovies = count($m) groupby $n;
sort $numHighRevenueMovies desc;
limit 5;
fetch { ""actor"": $n, ""numHighRevenueMovies"": $numHighRevenueMovies };"
176,List the top 3 movies with the smallest difference between budget and revenue.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget AS budget, m.revenue AS revenue, m.revenue - m.budget AS profit
ORDER BY profit
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit asc;
limit 3;
fetch { ""title"": $t, ""budget"": $bud, ""revenue"": $rev, ""profit"": $profit };"
177,What are the top 5 movies with the highest number of actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5","match
$m isa movie, has title $t;
acted_in (actor: $a, film: $m);
reduce $count = count($a) groupby $m, $t;
sort $count desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numActors"": $count
};"
178,Which users have rated the same movie more than once?,"MATCH (u:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u)
WHERE r1.timestamp <> r2.timestamp
RETURN u.name AS user, m.title AS movie","match
$u isa user, has name $n;
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m);
reduce $count = count($rel) groupby $u, $m, $n, $t;
match $count > 1;
fetch { ""user"": $n, ""movie"": $t };"
179,List the top 3 movies with the lowest imdbRating that have been rated by more than 500 users.,"MATCH (m:Movie)
WHERE m.imdbVotes > 500
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating
LIMIT 3","match
$m isa movie, has title $t, has imdb_rating $r, has imdb_votes $v;
$v > 500;
sort $r asc;
limit 3;
fetch { ""title"": $t, ""imdbRating"": $r };"
180,What are the top 5 actors who have acted in movies directed by Denzel Washington?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director {name: 'Denzel Washington'})
RETURN a.name AS actor, count(*) AS appearances
ORDER BY appearances DESC
LIMIT 5","match
$d isa person, has name ""Denzel Washington"";
(director: $d, film: $m) isa directed;
(actor: $a, film: $m) isa acted_in;
$a has name $an;
reduce $appearances = count($m) groupby $an;
sort $appearances desc;
limit 5;
fetch { ""actor"": $an, ""appearances"": $appearances };"
181,List the top 3 highest grossing movies of 2013.,"MATCH (m:Movie)
WHERE m.year = 2013 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y == 2013;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $r };"
182,What are the top 5 movies with the most distinct genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS distinctGenres","match
$m isa movie, has title $t;
in_genre (film: $m, genre: $g);
select $t, $g;
distinct;
reduce $count = count($g) groupby $t;
sort $count desc;
limit 5;
fetch {
  ""movie"": $t,
  ""distinctGenres"": $count
};"
183,List the top 3 actors by number of movies acted in that were released in the 1990s.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released STARTS WITH '199'
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
$m isa movie, has year $y;
$y >= 1990;
$y < 2000;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
185,Which actors have acted in both high-budget (over 200 million dollars) and low-budget (under 10 million dollars) movies?,"MATCH (a:Actor)-[:ACTED_IN]->(highBudget:Movie), (a)-[:ACTED_IN]->(lowBudget:Movie)
WHERE highBudget.budget > 200000000 AND lowBudget.budget < 10000000
RETURN a.name AS actor, highBudget.title AS highBudgetMovie, lowBudget.title AS lowBudgetMovie","match
$a isa person, has name $n;
(actor: $a, film: $m1) isa acted_in;
$m1 has budget $b1, has title $t1;
$b1 > 200000000;
(actor: $a, film: $m2) isa acted_in;
$m2 has budget $b2, has title $t2;
$b2 < 10000000;
fetch { ""actor"": $n, ""highBudgetMovie"": $t1, ""lowBudgetMovie"": $t2 };"
186,List the top 3 movies with a plot involving 'love' that have a runtime over 120 minutes.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love' AND m.runtime > 120
RETURN m.title, m.plot, m.runtime
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has plot $p, has runtime $rt, has imdb_rating $r;
$p like "".*love.*"";
$rt > 120;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""plot"": $p, ""runtime"": $rt };"
187,What are the top 5 movies with the highest imdbRating that were released in the 21st century?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '20' AND exists((m)-[:IN_GENRE]->(:Genre))
RETURN m.title, m.imdbRating, m.year
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r, has year $y, has released $rel;
(film: $m, genre: $g) isa in_genre;
$rel like ""20%"";
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r, ""year"": $y };"
189,List the top 3 actors with the highest average imdbRating across movies they've acted in (minimum 3 movies).,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating, count(m) AS numMovies
WHERE numMovies >= 3
RETURN a.name AS actor, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$a isa person, has name $n;
$m isa movie, has imdb_rating $r;
acted_in (actor: $a, film: $m);
reduce $count = count($m), $avg = mean($r) groupby $a, $n;
match $count >= 3;
sort $avg desc;
limit 3;
fetch {
  ""actor"": $n,
  ""avgRating"": $avg
};"
190,List the names of the top 5 movies with the highest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
191,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
192,Find the names of the top 5 movies with the lowest imdbRating.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title AS movie, m.imdbRating AS rating
ORDER BY m.imdbRating
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r;
sort $r asc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r };"
193,List the top 5 movies with the most imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v };"
194,Find the names of the top 5 directors by the number of movies they have directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
reduce $count = count($m) groupby $d;
sort $count desc;
limit 5;
fetch {
  ""director"": $d.name,
  ""numMovies"": $count
};"
195,What are the top 5 actors who acted in the most number of movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
sort $count desc;
limit 5;
fetch {
  ""actor"": $n,
  ""numMovies"": $count
};"
196,List the names of the first 3 genres that have the most movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn };"
197,Which 5 movies have been rated by the highest number of users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5","match
$m isa movie, has title $t;
rated (user: $u, film: $m);
reduce $count = count($u) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""numRatings"": $count
};"
199,List the names of the top 3 users who have rated the most movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.name AS user, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match
$u isa user, has name $n;
rated (user: $u, film: $m);
reduce $count = count($m) groupby $n;
sort $count desc;
limit 3;
fetch { ""user"": $n };"
201,Find the top 5 movies released most recently.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match $m isa movie, has title $t, has released $r; sort $r desc; limit 5; fetch { ""title"": $t, ""released"": $r };"
202,What are the top 3 oldest movies based on the 'year' property?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m.title, m.year
ORDER BY m.year
LIMIT 3","match $m isa movie, has title $t, has year $y; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y };"
203,List the 5 oldest actors based on the 'born' property.,"MATCH (a:Actor)
WHERE a.born IS NOT NULL
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match $a isa person, has name $n, has born $b; acted_in (actor: $a, film: $m); sort $b asc; limit 5; fetch { ""name"": $n, ""born"": $b };"
204,Who are the top 5 youngest directors based on the 'born' property?,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d.name, d.born
ORDER BY d.born DESC
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d, film: $m); sort $b desc; limit 5; fetch { ""name"": $n, ""born"": $b };"
205,What are the top 5 movies with the highest budgets?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
206,List the top 5 movies with the smallest budgets.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match $m isa movie, has title $t, has budget $b; sort $b asc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
207,Which 5 actors have acted in movies with the highest average imdbRating?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
RETURN a.name, avgRating
ORDER BY avgRating DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
208,Find the top 5 directors who have directed movies with the highest average imdbRating.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name AS director, avgRating","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
209,List the top 5 users who have given the highest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $rel isa rated (user: $u, film: $m); $rel has rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
210,What are the top 5 movies directed by Harold Lloyd?,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has name ""Harold Lloyd""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
211,List the first 3 genres that have movies with a runtime greater than 120 minutes.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 120
RETURN g.name AS genre
ORDER BY genre
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has runtime $r; $r > 120; sort $n asc; limit 3; fetch { ""genre"": $n };"
212,Which 3 users rated the movie with the highest revenue?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE m.revenue IS NOT NULL
WITH m, u, r
ORDER BY m.revenue DESC
LIMIT 1
RETURN u.name AS user
LIMIT 3","match $m isa movie, has revenue $rev; rated (user: $u, film: $m); $u has name $n; sort $rev desc; limit 3; fetch { ""user"": $n };"
213,Show the first 5 actors who acted in movies released in the year 2014.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie {year: 2014})
RETURN a.name AS actor, m.title AS movie
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has year 2014, has title $t; limit 5; fetch { ""actor"": $n, ""movie"": $t };"
214,What are the top 3 movies with the highest imdbRating that were released in 1995?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995' AND exists((m)-[:IN_GENRE]->(:Genre))
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r, has released $rel; $rel like ""1995%""; in_genre (film: $m, genre: $g); sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
215,List the first 5 directors born in France.,"MATCH (d:Director {bornIn: 'France'})
RETURN d.name, d.born
ORDER BY d.born
LIMIT 5","match $d isa person, has name $n, has born $b, has born_in ""France""; directed (director: $d, film: $m); sort $b asc; limit 5; fetch { ""name"": $n, ""born"": $b };"
216,Which 3 movies have the most number of votes cast by users?,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
217,Show the top 5 movies with a budget greater than 100 million USD.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b; $b > 100000000; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
218,What are the first 3 genres associated with movies that have been rated by at least 5 different users?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)<-[r:RATED]-(u:User)
WITH g, m, count(DISTINCT u) AS userCount
WHERE userCount >= 5
RETURN g.name AS genre
ORDER BY userCount DESC
LIMIT 3","match 
$m isa movie;
rated (film: $m, user: $u);
reduce $count = count($u) groupby $m;
match $count >= 5;
in_genre (film: $m, genre: $g);
$g has name $n;
sort $count desc;
limit 3;
fetch { ""genre"": $n };"
220,Who are the top 3 actors based on the number of movies they have acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN a.name AS actor, numMovies","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
221,What are the first 5 movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: 'USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 5","match $d isa person, has born_in ""USA""; directed (director: $d, film: $m); $m has title $t; limit 5; fetch { ""title"": $t };"
222,Which 3 actors have acted in movies with a runtime less than 90 minutes?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.runtime < 90
RETURN a.name AS actor, m.title AS movie
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has runtime $r; $r < 90; $m has title $t; limit 3; fetch { ""actor"": $n, ""movie"": $t };"
223,List the top 5 highest-grossing movies of 2006.,"MATCH (m:Movie)
WHERE m.year = 2006 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has year 2006, has revenue $rev, has title $t; sort $rev desc; limit 5; fetch { ""movie"": $t, ""revenue"": $rev };"
224,Show the first 3 movies that have been rated below 3.0 by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating < 3.0
RETURN m.title, r.rating, u.name
LIMIT 3","match $r isa rated, links (user: $u, film: $m), has rating $rating; $rating < 3.0; $m has title $t; $u has name $n; limit 3; fetch { ""title"": $t, ""rating"": $rating, ""user"": $n };"
225,What are the first 5 movies with the most distinct genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS distinctGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $t; sort $count desc; limit 5;"
226,Which 3 directors have directed movies in more than one genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(distinct g) AS num_genres
WHERE num_genres > 1
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
select $n, $g;
distinct;
reduce $count = count groupby $n;
match $count > 1;
sort $count desc;
limit 3;
fetch { ""director"": $n, ""num_genres"": $count };"
227,List the first 5 actors who have a poster URL listed on their profile.,"MATCH (a:Actor)
WHERE a.poster IS NOT NULL
RETURN a.name, a.poster
LIMIT 5","match
$a isa person, has name $n, has poster $p;
(actor: $a, film: $m) isa acted_in;
limit 5;
fetch { ""name"": $n, ""poster"": $p };"
228,Show the top 5 users by the number of movies they have rated.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
229,Which 3 movies have the highest budget-revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
230,List the first 5 actors who were born before 1900.,"MATCH (a:Actor)
WHERE a.born < date('1900-01-01')
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match
$a isa person, has name $n, has born $b;
acted_in (actor: $a, film: $m);
$b < 1900-01-01;
sort $b asc;
limit 5;
fetch { ""name"": $n, ""born"": $b };"
231,What are the top 3 genres in which movies with an imdbRating above 8.0 fall?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating > 8.0
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match $m isa movie, has imdb_rating $r; $r > 8.0; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
232,Which 5 movies have been directed by persons who also have an acting role in any movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS movie
LIMIT 5","match $p isa person, has name $n; directed (director: $p, film: $m); acted_in (actor: $p, film: $m2); $m has title $t; limit 5; fetch { ""movie"": $t };"
233,Show the first 3 movies released in the USA that have a revenue exceeding 500 million USD.,"MATCH (m:Movie)
WHERE 'USA' IN m.countries AND m.revenue > 500000000
RETURN m.title, m.year, m.revenue
ORDER BY m.released
LIMIT 3","match $m isa movie, has countries $c, has revenue $r, has title $t, has year $y; $c contains ""USA""; $r > 500000000; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y, ""revenue"": $r };"
234,List the 5 most recently released movies with a plot description available.,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.released, m.plot
ORDER BY m.released DESC
LIMIT 5","match $m isa movie, has title $t, has released $r, has plot $p; sort $r desc; limit 5; fetch { ""title"": $t, ""released"": $r, ""plot"": $p };"
235,What are the first 3 directors who died after 2000?,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died
LIMIT 3","match $d isa person, has name $n, has died $d2; $d2 > 2000-01-01; directed (director: $d, film: $m); sort $d2 asc; limit 3; fetch { ""name"": $n, ""died"": $d2 };"
236,Which 3 users have rated the oldest movies in the database?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, m
ORDER BY m.year
RETURN DISTINCT u.name AS user, m.title AS movie, m.year AS year
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); $m has title $t, has year $y; sort $y asc; limit 3; fetch { ""user"": $n, ""movie"": $t, ""year"": $y };"
237,List the top 5 movies with the most user ratings.,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 5;"
238,Show the first 5 genres of movies directed by directors who were born after 1960.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE d.born > date('1960-01-01')
RETURN DISTINCT g.name
LIMIT 5","match $d isa person, has born $b; $b > 1960-01-01; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name $n; limit 5; fetch { ""genre"": $n };"
239,List the first 5 directors with the most diverse filmography based on genre diversity.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN d.name AS director, genreCount AS genreDiversity","match $d isa person, has name $n; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $n; sort $count desc; limit 5;"
240,What are the top 3 movies with the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
241,Which 5 actors have acted in the most commercially successful movies (highest revenue)?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue IS NOT NULL
WITH a, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN a.name AS actor, total_revenue","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has revenue $r; reduce $total = sum($r) groupby $n; sort $total desc; limit 5;"
243,List the top 5 movies with a plot involving a 'young boy' or 'orphan'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'young boy' OR m.plot CONTAINS 'orphan'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; { $p contains ""young boy""; } or { $p contains ""orphan""; }; sort $r desc; limit 5; fetch { ""title"": $t, ""plot"": $p };"
244,What are the top 3 genres of movies that have a budget less than 50 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget < 50000000
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match $m isa movie, has budget $b; $b < 50000000; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
246,Show the first 3 movies that feature an actor from France.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE a.bornIn = 'France'
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; acted_in (actor: $a, film: $m); $a has born_in ""France""; limit 3; fetch { ""title"": $t };"
247,List the top 5 users who have rated the most movies released before 2000.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.year < 2000
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); $m has year $y; $y < 2000; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
248,Which 3 movies have the lowest imdbVotes but a rating higher than 7.0?,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0
RETURN m.title, m.imdbVotes, m.imdbRating
ORDER BY m.imdbVotes
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v, has imdb_rating $r; $r > 7.0; sort $v asc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v, ""imdb_rating"": $r };"
249,List the first 5 actors who have acted in movies directed by a director born in Nebraska.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'Nebraska'})
RETURN a.name AS actor, m.title AS movie, d.name AS director
LIMIT 5","match $a isa person, has name $an; acted_in (actor: $a, film: $m); directed (director: $d, film: $m); $d has born_in ""Nebraska"", has name $dn; $m has title $t; limit 5; fetch { ""actor"": $an, ""movie"": $t, ""director"": $dn };"
250,What are the top 3 movies released during the Christmas season (December)?,"MATCH (m:Movie)
WHERE m.released STARTS WITH ""12-""
RETURN m.title, m.released, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has released $rel, has imdb_rating $r; $rel contains ""-12-""; sort $r desc; limit 3; fetch { ""title"": $t, ""released"": $rel, ""imdb_rating"": $r };"
251,Which 5 directors have directed movies with the highest average imdbRating?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
RETURN d.name AS director, avgRating
ORDER BY avgRating DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
252,Show the first 3 actors who starred in a movie with a budget over 200 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 200000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b > 200000000; limit 3; fetch { ""name"": $n };"
254,Which 3 actors have the most roles listed in their ACTED_IN relationships?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(r) AS numRoles
ORDER BY numRoles DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
256,Show the top 5 actors who have acted in movies with at least three different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 3
RETURN a.name AS actor, numDirectors
ORDER BY numDirectors DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
directed (director: $d, film: $m);
select $a, $n, $d;
distinct;
reduce $count = count($d) groupby $a, $n;
match $count >= 3;
sort $count desc;
limit 5;
fetch { ""actor"": $n, ""numDirectors"": $count };"
258,List the first 5 directors who have a biography listed in their profile.,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
LIMIT 5","match $d isa person, has name $n, has bio $b; directed (director: $d, film: $m); limit 5; fetch { ""name"": $n, ""bio"": $b };"
259,What are the top 3 movies with the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit desc;
limit 3;
fetch { ""title"": $t, ""profit"": $profit };"
260,Which 5 actors were born in the USA and have acted in at least two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bornIn = 'USA'
WITH a, count(m) AS numMovies
WHERE numMovies >= 2
RETURN a.name, a.bornIn, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n, has born_in ""USA"";
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
match $count >= 2;
sort $count desc;
limit 5;
fetch {
  ""name"": $n,
  ""born_in"": ""USA"",
  ""numMovies"": $count
};"
261,Show the first 3 movies that have a poster URL and were released after 2010.,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL AND m.released > '2010'
RETURN m.title, m.poster, m.released
LIMIT 3","match $m isa movie, has poster $p, has released $r, has title $t; $r > ""2010""; limit 3; fetch { ""title"": $t, ""poster"": $p, ""released"": $r };"
262,List the top 5 movies that have been rated the most number of times.,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 5;"
263,What are the first 3 genres in which Harold Lloyd has directed movies?,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name
LIMIT 3","match $d isa person, has name ""Harold Lloyd""; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name $n; limit 3; fetch { ""genre"": $n };"
264,Which 3 users have given the highest average rating to movies they've rated?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $n; sort $avg desc; limit 3;"
265,List the first 5 directors who have directed a movie with an imdbRating of 9 or higher.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating >= 9
RETURN DISTINCT d.name
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; $r >= 9.0; limit 5; fetch { ""director"": $n };"
266,Show the top 5 movies with the most actors involved.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title AS movie, numActors","match $m isa movie, has title $t; acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $t; sort $count desc; limit 5;"
267,Which 3 movies have been directed by directors who have also acted in movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 3","match $d isa person; directed (director: $d, film: $m); acted_in (actor: $d, film: $m2); $m has title $t; limit 3; fetch { ""title"": $t };"
268,List the first 5 movies that have a language listed as 'French'.,"MATCH (m:Movie)
WHERE 'French' IN m.languages
RETURN m.title
LIMIT 5","match $m isa movie, has title $t, has languages $l; $l contains ""French""; limit 5; fetch { ""title"": $t };"
269,What are the top 3 directors who have directed movies with the most diverse set of actors?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(DISTINCT a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN d.name AS director, numActors","match $d isa person, has name $n; directed (director: $d, film: $m); acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $n; sort $count desc; limit 3;"
271,Show the first 3 actors who have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name AS actor, p.tmdbId
LIMIT 3","match
$p isa person, has name $n, has tmdb_id $t;
acted_in (actor: $p, film: $m1);
directed (director: $p, film: $m2);
limit 3;
fetch { ""actor"": $n, ""tmdb_id"": $t };"
274,Show the top 5 genres of movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime = 90
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 5","match $m isa movie, has runtime 90; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
275,Which 3 movies have been rated by the oldest users in terms of account creation date?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, u, r.timestamp AS ratedAt
ORDER BY ratedAt
RETURN m.title AS movie, m.year AS year
  ORDER BY ratedAt
  LIMIT 3","match $m isa movie, has title $t, has year $y; $r isa rated, links (user: $u, film: $m), has timestamp $ts; sort $ts asc; limit 3; fetch { ""movie"": $t, ""year"": $y };"
277,Which 5 directors have the most movies released in the 2000s?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has year $y; $y >= 2000; $y < 2010; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
278,Show the first 3 genres that have movies with both an English and French language option.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN g.name AS genre
LIMIT 3","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has languages ""English"";
$m has languages ""French"";
limit 3;
fetch { ""genre"": $n };"
279,List the top 5 highest-rated movies by users named 'John'.,"MATCH (u:User {name: 'John'})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5","match $u isa user, has name ""John""; $r isa rated, links (user: $u, film: $m), has rating $rating; $m has title $t; reduce $avg = mean($rating) groupby $t; sort $avg desc; limit 5;"
280,What are the first 3 movies with the highest number of genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS movie, genreCount","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $t; sort $count desc; limit 3;"
281,Which 3 directors have directed the most movies with a runtime over 150 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 150
WITH d, count(m) AS numLongMovies
ORDER BY numLongMovies DESC
LIMIT 3
RETURN d.name AS director, numLongMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r > 150; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
282,Which 3 genres have the least number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3
RETURN g.name AS genre, movieCount","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count asc; limit 3;"
283,List the first 5 movies with a plot involving an 'evil exterminator'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil exterminator'
RETURN m.title, m.plot
LIMIT 5","match $m isa movie, has title $t, has plot $p; $p contains ""evil exterminator""; limit 5; fetch { ""title"": $t, ""plot"": $p };"
284,What are the top 3 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r asc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
286,Show the first 3 actors who have acted in movies with a budget under 10 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 10000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b < 10000000; limit 3; fetch { ""name"": $n };"
287,List the top 5 movies that have been rated by users with the most distinct names.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, count(distinct u.name) AS distinctNames
RETURN m.title, distinctNames
ORDER BY distinctNames DESC
LIMIT 5","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 5;"
289,Which 3 directors have directed both animated and non-animated movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:IN_GENRE]->(:Genre {name: 'Animation'}) }
  AND exists{ (m)-[:IN_GENRE]->(:Genre) WHERE NOT exists{ (m)-[:IN_GENRE]->(:Genre {name: 'Animation'}) } }
RETURN d.name AS director
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m1) isa directed;
(film: $m1, genre: $g1) isa in_genre;
$g1 has name ""Animation"";
(director: $d, film: $m2) isa directed;
(film: $m2, genre: $g2) isa in_genre;
not { $g2 has name ""Animation""; };
limit 3;
fetch { ""director"": $n };"
290,List the first 5 movies with a director who has also acted in a movie.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 5","match $d isa person; directed (director: $d, film: $m); acted_in (actor: $d, film: $m2); $m has title $t; limit 5; fetch { ""title"": $t };"
291,Show the top 5 genres of movies that have been rated by the most users.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)<-[r:RATED]-(u:User)
WITH g, count(distinct u) AS userCount
ORDER BY userCount DESC
LIMIT 5
RETURN g.name AS genre, userCount","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); rated (user: $u, film: $m); reduce $count = count($u) groupby $n; sort $count desc; limit 5;"
292,Which 3 actors have the most diverse range of genres in the movies they've acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name AS actor, genreCount AS numGenres","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $n; sort $count desc; limit 3;"
293,List the first 5 movies with the highest number of directors involved.,"MATCH (m:Movie)
WITH m, size([(d)-[:DIRECTED]->(m) | d]) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 5
RETURN m.title AS movie, numDirectors","match $m isa movie, has title $t; directed (director: $d, film: $m); reduce $count = count($d) groupby $t; sort $count desc; limit 5;"
294,What are the top 3 movies with a plot involving a 'friendship'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; $p contains ""friendship""; sort $r desc; limit 3; fetch { ""title"": $t, ""plot"": $p };"
295,Which 5 actors have acted in movies released in the most distinct years?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(DISTINCT m.year) AS num_years
ORDER BY num_years DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has year $y; reduce $count = count($y) groupby $n; sort $count desc; limit 5;"
296,List the top 5 directors with the most movies that have an imdbRating of 6 or higher.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating >= 6
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; $r >= 6.0; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
297,What are the first 3 genres of movies that have been directed by directors born after 1980?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE d.born > date('1980-01-01')
RETURN g.name AS genre
ORDER BY genre
LIMIT 3","match $d isa person, has born $b; $b > 1980-01-01; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name $n; sort $n asc; limit 3; fetch { ""genre"": $n };"
298,Which 3 users have rated movies with the most diverse range of imdbRatings?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, max(m.imdbRating) AS maxRating, min(m.imdbRating) AS minRating
RETURN u.name AS user, maxRating, minRating, maxRating - minRating AS ratingRange
ORDER BY ratingRange DESC
LIMIT 3","match
$u isa user, has name $n;
rated (user: $u, film: $m);
$m has imdb_rating $r;
reduce $maxRating = max($r), $minRating = min($r) groupby $u, $n;
match
let $ratingRange = $maxRating - $minRating;
sort $ratingRange desc;
limit 3;
fetch { ""user"": $n, ""maxRating"": $maxRating, ""minRating"": $minRating, ""ratingRange"": $ratingRange };"
301,List the top 5 movies directed by a person named 'Graham Annable'.,"MATCH (p:Person {name: 'Graham Annable'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $p isa person, has name ""Graham Annable""; directed (director: $p, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
302,Which 3 users gave the highest ratings to the movie titled 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[r:RATED]-(u:User)
RETURN u.name AS user, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 3","match $m isa movie, has title ""Toy Story""; $r isa rated, links (user: $u, film: $m), has rating $rating; $u has name $n; sort $rating desc; limit 3; fetch { ""user"": $n, ""rating"": $rating };"
303,Find the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
match $numMovies > 10;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
304,"What are the top 3 most profitable movies, considering the difference between revenue and budget?","MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL
RETURN m.title AS movie, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit desc;
limit 3;
fetch { ""title"": $t, ""profit"": $profit };"
305,Which 3 movies have been rated by the most users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 3;"
306,Name the top 5 directors born in the USA.,"MATCH (d:Director {bornIn: 'USA'})
RETURN d.name
ORDER BY d.born DESC
LIMIT 5","match $d isa person, has name $n, has born_in ""USA"", has born $b; directed (director: $d, film: $m); sort $b desc; limit 5; fetch { ""name"": $n };"
307,List 3 movies released in 1995.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995'
RETURN m.title
LIMIT 3","match
$m isa movie, has released $r, has title $t;
$r like ""1995.*"";
limit 3;
fetch { ""title"": $t };"
308,What are the top 5 highest-grossing movies of 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has year 2014, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
309,Which 3 actors have played roles in both acting and directing for the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""person"": $n, ""movie"": $t };"
310,List the top 5 movies with an IMDb rating above 8.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 8.0
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; $r > 8.0; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
311,What are the top 3 genres with the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
312,Which 3 directors have the longest filmography in the database?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
313,List the top 5 movies that have been rated after 2015.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= 1420070400 // Unix timestamp for 2015-01-01
WITH m, avg(r.rating) AS avgRating, count(r) AS numRatings
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating, numRatings","match
$m isa movie, has title $t;
$r isa rated, links (user: $u, film: $m), has timestamp $ts, has rating $rating;
$ts >= 1451606400;
reduce $avg = mean($rating), $count = count($r) groupby $m, $t;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $t,
  ""avgRating"": $avg,
  ""numRatings"": $count
};"
314,Which 3 movies have the highest IMDb votes?,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
315,Name the top 5 actors who have acted in movies with a runtime longer than 150 minutes.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.runtime > 150
RETURN a.name, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has runtime $r; $r > 150; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
316,List 3 actors born in France who have directed a movie.,"MATCH (p:Person)
WHERE p.bornIn = 'France' AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n, has born_in ""France""; directed (director: $p, film: $m1); acted_in (actor: $p, film: $m2); limit 3; fetch { ""name"": $n };"
317,What are the top 5 movies with a budget over $100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b; $b > 100000000; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
318,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
319,Name the top 5 movies with IMDb ratings lower than 5.0.,"MATCH (m:Movie)
WHERE m.imdbRating < 5.0
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; $r < 5.0; sort $r asc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
320,List the top 3 directors who died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died DESC
LIMIT 3","match $d isa person, has name $n, has died $d2; directed (director: $d, film: $m); $d2 > 2000-01-01; sort $d2 desc; limit 3; fetch { ""name"": $n, ""died"": $d2 };"
321,What are the top 5 movies in the 'Adventure' genre with the highest revenue?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; in_genre (film: $m, genre: $g); $g has name ""Adventure""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
323,List the top 5 actors with the most roles in movies released before 1980.,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year < 1980
WITH a, count(r) AS numRoles
ORDER BY numRoles DESC
LIMIT 5
RETURN a.name AS actor, numRoles","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has year $y; $y < 1980; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
324,Which 3 directors were born before 1900?,"MATCH (d:Director)
WHERE d.born < date('1900-01-01')
RETURN d.name, d.born
ORDER BY d.born
LIMIT 3","match $d isa person, has name $n, has born $b; directed (director: $d, film: $m); $b < 1900-01-01; sort $b asc; limit 3; fetch { ""name"": $n, ""born"": $b };"
325,Name the top 5 most voted movies on IMDb released after 2010.,"MATCH (m:Movie)
WHERE m.year > 2010 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has imdb_votes $v; $y > 2010; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
326,List the 3 users who have given the lowest average ratings.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $n; sort $avg asc; limit 3;"
328,Which 3 actors have the most roles in comedy movies?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN a.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); $g has name ""Comedy""; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
329,Name the top 5 movies that have been rated by users named 'Omar Huffman'.,"MATCH (u:User {name: 'Omar Huffman'})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 5","match $u isa user, has name ""Omar Huffman""; $r isa rated, links (user: $u, film: $m), has rating $rating; $m has title $t; sort $rating desc; limit 5; fetch { ""title"": $t, ""rating"": $rating };"
330,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r asc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
331,What are the top 5 movies directed by directors born in Nebraska?,"MATCH (d:Director {bornIn: 'Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has born_in ""Nebraska, USA""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
332,Which 3 movies have the lowest revenue despite having a high IMDb rating (over 7.0)?,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 3","match $m isa movie, has title $t, has revenue $r, has imdb_rating $i; $i > 7.0; sort $r asc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
333,List the top 5 actors who have acted in movies directed by 'Anthony Stacchi'.,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN a.name AS actor, count(*) AS appearances
ORDER BY appearances DESC
LIMIT 5","match $d isa person, has name ""Anthony Stacchi""; directed (director: $d, film: $m); acted_in (actor: $a, film: $m); $a has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
334,Which 3 genres has 'Toy Story' been categorized under?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match $m isa movie, has title ""Toy Story""; in_genre (film: $m, genre: $g); $g has name $n; limit 3; fetch { ""genre"": $n };"
335,Name the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 5;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
336,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
337,Which three movies have the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
338,List the top 5 movies with the most number of IMDb votes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
339,What are the first 3 movies released after 2010?,"MATCH (m:Movie)
WHERE m.released > '2010-01-01'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match $m isa movie, has title $t, has released $r; $r > ""2010-01-01""; sort $r asc; limit 3; fetch { ""title"": $t, ""released"": $r };"
340,Which three users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
341,List the top 3 directors by the number of movies directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
342,What are the top 3 genres by the number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
343,Which three actors have acted in the most movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
344,List the first 3 movies that have a budget greater than 100 million USD.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match $m isa movie, has title $t, has budget $b; $b > 100000000; sort $b desc; limit 3; fetch { ""title"": $t, ""budget"": $b };"
345,What are the top 3 highest rated movies by users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN m.title AS movie, avgRating AS `Average Rating`","match $m isa movie, has title $t; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $t; sort $avg desc; limit 3;"
346,Which three movies have the highest IMDb rating?,"MATCH (m:Movie)
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
347,List the top 5 movies with the lowest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r asc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
348,What are the first 3 movies that were released in the USA?,"MATCH (m:Movie)
WHERE 'USA' IN m.countries
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
$m isa movie, has countries $c, has title $t, has released $r;
$c like "".*USA.*"";
sort $r asc;
limit 3;
fetch { ""title"": $t, ""released"": $r };"
349,Which three directors were born in the USA?,"MATCH (d:Director)
WHERE d.bornIn CONTAINS 'USA'
RETURN d.name
LIMIT 3","match
$d isa person, has born_in $b, has name $n;
(director: $d, film: $m) isa directed;
$b like "".*USA.*"";
limit 3;
fetch { ""name"": $n };"
350,List the top 3 actors by the number of IMDb votes they've received for their movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, sum(m.imdbVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_votes $v; reduce $total = sum($v) groupby $n; sort $total desc; limit 3;"
351,What are the first 3 movies with a runtime less than 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90
RETURN m.title
LIMIT 3","match $m isa movie, has title $t, has runtime $r; $r < 90; limit 3; fetch { ""title"": $t };"
352,Which three users have the highest average rating given to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $n; sort $avg desc; limit 3;"
353,List the top 3 movies with a plot mentioning 'love'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has plot $p, has title $t, has imdb_rating $r;
$p like "".*love.*"";
sort $r desc;
limit 3;
fetch { ""title"": $t, ""plot"": $p };"
354,What are the first 3 movies that have a revenue to budget ratio greater than 3?,"MATCH (m:Movie)
WHERE m.revenue > 3 * m.budget
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue / m.budget DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > ($bud * 3);
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
356,List the top 5 movies released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has imdb_rating $r; $y >= 2000; $y < 2010; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
357,What are the first 3 movies with a title starting with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; $t like ""The%""; limit 3; fetch { ""title"": $t };"
358,Which three directors have directed movies in more than 2 different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 2
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
select $d, $n, $g;
distinct;
reduce $count = count($g) groupby $d, $n;
match $count > 2;
sort $count desc;
limit 3;
fetch {
  ""director"": $n,
  ""num_genres"": $count
};"
359,List the top 3 genres that have movies with an average IMDb rating over 7.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH g, avg(m.imdbRating) AS avgRating
WHERE avgRating > 7
RETURN g.name AS genre, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has imdb_rating $r;
reduce $avg = mean($r) groupby $n;
match $avg > 7;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $n,
  ""avgRating"": $avg
};"
360,What are the first 3 movies where the main actor was born in France?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bornIn = 'France'
RETURN m.title
LIMIT 3","match $a isa person, has born_in ""France""; acted_in (actor: $a, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
362,List the top 3 movies that were most frequently rated by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 3;"
363,What are the first 3 movies with an IMDb rating lower than 5?,"MATCH (m:Movie)
WHERE m.imdbRating < 5
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; $r < 5.0; sort $r asc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
364,Which three directors have directed movies with a total revenue over 500 million USD?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
WITH d, sum(m.revenue) AS total_revenue
WHERE total_revenue > 500000000
RETURN d.name AS director, total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has revenue $r; reduce $total = sum($r) groupby $d, $n; match $total > 500000000; sort $total desc; limit 3; fetch { ""director"": $n, ""total_revenue"": $total };"
365,What are the first 3 movies with a poster URL containing 'face'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster $p, has title $t;
$p like "".*face.*"";
limit 3;
fetch { ""title"": $t };"
366,Which three movies feature both American and Japanese actors?,"MATCH (m:Movie)
WHERE exists{ (a1:Actor)-[:ACTED_IN]->(m) WHERE a1.bornIn = 'USA' }
  AND exists{ (a2:Actor)-[:ACTED_IN]->(m) WHERE a2.bornIn = 'Japan' }
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; acted_in (actor: $a1, film: $m); acted_in (actor: $a2, film: $m); $a1 has born_in ""USA""; $a2 has born_in ""Japan""; limit 3; fetch { ""title"": $t };"
367,List the first 3 directors who have died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died
LIMIT 3","match $d isa person, has name $n, has died $d2; directed (director: $d, film: $m); $d2 > 2000-01-01; sort $d2 asc; limit 3; fetch { ""name"": $n, ""died"": $d2 };"
368,What are the first 3 movies with an IMDb rating greater than 8 and less than 9?,"MATCH (m:Movie)
WHERE m.imdbRating > 8 AND m.imdbRating < 9
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; $r > 8.0; $r < 9.0; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
369,Which three genres have the least number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3
RETURN g.name AS genre, movieCount","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count asc; limit 3;"
370,What are the first 3 movies with a plot mentioning 'zombie'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'zombie'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*zombie.*"";
limit 3;
fetch { ""title"": $t };"
371,Which three directors have the highest average IMDb rating for their movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
RETURN d.name AS director, avgRating
ORDER BY avgRating DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 3;"
372,List the top 3 actors born in the 1980s.,"MATCH (a:Actor)
WHERE a.born >= date('1980-01-01') AND a.born < date('1990-01-01')
RETURN a.name, a.born
ORDER BY a.born DESC
LIMIT 3","match $a isa person, has name $n, has born $b; acted_in (actor: $a, film: $m); $b >= 1980-01-01; $b < 1990-01-01; sort $b desc; limit 3; fetch { ""name"": $n, ""born"": $b };"
373,What are the first 3 movies that have a language list containing 'Turkish'?,"MATCH (m:Movie)
WHERE 'Turkish' IN m.languages
RETURN m.title
LIMIT 3","match
$m isa movie, has languages $l, has title $t;
$l like "".*Turkish.*"";
limit 3;
fetch { ""title"": $t };"
374,Which three users have rated the oldest movies on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(m.year) AS avgYear
RETURN u.name, avgYear
ORDER BY avgYear
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); $m has year $y; reduce $avg = mean($y) groupby $n; sort $avg asc; limit 3;"
375,List the top 3 movies with a release date on or before '2000-01-01'.,"MATCH (m:Movie)
WHERE m.released <= '2000-01-01'
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match $m isa movie, has title $t, has released $r; $r <= ""2000-01-01""; sort $r desc; limit 3; fetch { ""title"": $t, ""released"": $r };"
376,What are the first 3 movies directed by a person who has also acted in movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 3","match $p isa person; directed (director: $p, film: $m); acted_in (actor: $p, film: $m2); $m has title $t; limit 3; fetch { ""title"": $t };"
378,List the top 3 actors who have directed movies they acted in.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WITH p, count(m) AS both
ORDER BY both DESC
LIMIT 3
RETURN p.name AS name, both","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
379,What are the first 3 movies with a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > $bud;
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
380,Which three genres have the highest average revenue per movie?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
WITH g.name AS genre, avg(m.revenue) AS avgRevenue
RETURN genre, avgRevenue
ORDER BY avgRevenue DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); $m has revenue $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 3;"
381,List the top 3 directors who have directed the most successful movies in terms of revenue.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
WITH d, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3
RETURN d.name AS director, total_revenue","match $d isa person, has name $n; directed (director: $d, film: $m); $m has revenue $r; reduce $total = sum($r) groupby $n; sort $total desc; limit 3;"
382,Which three actors have the longest total screen time in movies?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, sum(m.runtime) AS totalScreenTime
ORDER BY totalScreenTime DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has runtime $r; reduce $total = sum($r) groupby $n; sort $total desc; limit 3;"
384,What are the first 3 movies that have a plot mentioning 'war'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'war'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*war.*"";
limit 3;
fetch { ""title"": $t };"
385,Which three users have rated the most number of actors?,"MATCH (u:User)-[:RATED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH u, count(distinct a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN u.name AS user, numActors","match $u isa user, has name $n; rated (user: $u, film: $m); acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $n; sort $count desc; limit 3;"
386,List the top 3 movies that have been released on a leap year.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL AND date(m.released).year % 4 = 0
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match
$m isa movie, has title $t, has released $rel, has year $y;
let $rem = $y % 4;
$rem == 0;
sort $rel desc;
limit 3;
fetch { ""title"": $t, ""released"": $rel };"
387,What are the first 3 movies with the most number of associated actors?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 3","match $m isa movie, has title $t; acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $t; sort $count desc; limit 3;"
389,List the first 3 actors who have acted in a movie with a budget over 50 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 50000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b > 50000000; limit 3; fetch { ""name"": $n };"
390,What are the top 5 movies that have a genre of 'Sci-Fi'?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Sci-Fi'})
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; in_genre (film: $m, genre: $g); $g has name ""Sci-Fi""; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
393,What are the first 3 movies that have a plot mentioning 'adventure'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*adventure.*"";
limit 3;
fetch { ""title"": $t };"
394,Which three genres are most common among movies with a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
WITH g, count(*) AS count
ORDER BY count DESC
LIMIT 3
RETURN g.name AS genre, count","match $m isa movie, has budget $b; $b > 100000000; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
395,List the top 3 actors who have the highest average IMDb rating across their movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
RETURN a.name AS actor, avgRating
ORDER BY avgRating DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 3;"
397,Which three users have rated movies in the most number of different genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS numGenres
ORDER BY numGenres DESC
LIMIT 3
RETURN u.name AS user, numGenres","match
$u isa user, has name $n;
rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
select $u, $n, $g;
distinct;
reduce $count = count($g) groupby $u, $n;
sort $count desc;
limit 3;
fetch {
  ""user"": $n,
  ""numGenres"": $count
};"
398,List the top 3 movies that have been directed by actors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, count(*) AS actorDirectorCount
ORDER BY actorDirectorCount DESC
LIMIT 3","match $p isa person; acted_in (actor: $p); directed (director: $p, film: $m); $m has title $t; select $m, $p, $t; distinct; reduce $count = count($p) groupby $m, $t; sort $count desc; limit 3; fetch { ""movie"": $t, ""actorDirectorCount"": $count };"
399,What are the first 3 movies with a plot mentioning 'family'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'family'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*family.*"";
limit 3;
fetch { ""title"": $t };"
402,List the first 3 actors who have acted in historical movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'History'})
RETURN a.name AS actor
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); $g has name ""History""; limit 3; fetch { ""actor"": $n };"
403,What are the top 3 movies with a title ending in 'End'?,"MATCH (m:Movie)
WHERE m.title ENDS WITH 'End'
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_rating $r; $t like ""%End""; sort $r desc; limit 3; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
405,What are the first 3 movies with an IMDb rating above 7 and more than 100000 IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbRating > 7 AND m.imdbVotes > 100000
RETURN m.title, m.imdbRating, m.imdbVotes
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r, has imdb_votes $v; $r > 7.0; $v > 100000; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r, ""imdb_votes"": $v };"
407,What are the first 3 movies with an actor who has a biography mentioning 'model'?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bio CONTAINS 'model'
RETURN m.title
LIMIT 3","match
$a isa person, has bio $b;
(actor: $a, film: $m) isa acted_in;
$m has title $t;
$b like "".*model.*"";
limit 3;
fetch { ""title"": $t };"
408,Which three genres have the most movies with a runtime over 120 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 120
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has runtime $r;
$r > 120;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.name,
  ""numMovies"": $count
};"
409,What are the first 3 movies with an actor born before 1900?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born < date('1900-01-01')
RETURN m.title
LIMIT 3","match $a isa person, has born $b; $b < 1900-01-01; acted_in (actor: $a, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
410,Which three movies have the highest difference in revenue and budget?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL
RETURN m.title AS movie, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit desc;
limit 3;
fetch { ""title"": $t, ""profit"": $profit };"
411,List the top 3 directors who have worked with the most number of actors.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE d.name IS NOT NULL AND a.name IS NOT NULL
WITH d, count(DISTINCT a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN d.name AS director, numActors","match
$d isa person, has name $n;
directed (director: $d, film: $m);
acted_in (actor: $a, film: $m);
select $a, $n;
distinct;
reduce $count = count($a) groupby $n;
sort $count desc;
limit 3;
fetch {
  ""director"": $n,
  ""numActors"": $count
};
"
412,What are the first 3 movies with plots that involve a natural disaster?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'natural disaster'
RETURN m.title, m.plot
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*natural disaster.*"";
limit 3;
fetch { ""title"": $t, ""plot"": $p };"
413,Which three users have rated the highest budget movies on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(m.budget) AS avgBudget
ORDER BY avgBudget DESC
LIMIT 3
RETURN u.name AS user, avgBudget","match
$u isa user, has name $n;
rated (user: $u, film: $m);
$m has budget $b;
reduce $avg = mean($b) groupby $u, $n;
sort $avg desc;
limit 3;
fetch {
  ""user"": $n,
  ""avgBudget"": $avg
};"
414,List the top 3 actors who have acted in both 'Action' and 'Romance' genres.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Action', 'Romance']
WITH a, count(DISTINCT g) AS numGenres
WHERE numGenres = 2
RETURN a.name, a.tmdbId
ORDER BY a.name
LIMIT 3","match $a isa person, has name $n, has tmdb_id $t; acted_in (actor: $a, film: $m1); acted_in (actor: $a, film: $m2); in_genre (film: $m1, genre: $g1); in_genre (film: $m2, genre: $g2); $g1 has name ""Action""; $g2 has name ""Romance""; limit 3; fetch { ""name"": $n, ""tmdb_id"": $t };"
415,What are the first 3 movies released in 'January'?,"MATCH (m:Movie)
WHERE m.released STARTS WITH 'January'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
$m isa movie, has released $r, has title $t;
$r like ""January.*"";
sort $r asc;
limit 3;
fetch { ""title"": $t, ""released"": $r };"
416,Which three directors have the longest average movie runtime?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, avg(m.runtime) AS avgRuntime
RETURN d.name AS director, avgRuntime
ORDER BY avgRuntime DESC
LIMIT 3","match
$d isa person, has name $n;
directed (director: $d, film: $m);
$m has runtime $r;
reduce $avg = mean($r) groupby $n;
sort $avg desc;
limit 3;
fetch {
  ""director"": $n,
  ""avgRuntime"": $avg
};"
417,List the top 3 movies with a significant plot twist mentioned in the plot.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'twist'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has plot $p, has title $t, has imdb_rating $r;
$p like "".*twist.*"";
sort $r desc;
limit 3;
fetch { ""title"": $t, ""plot"": $p };"
418,What are the first 3 movies with a revenue less than 1000 USD?,"MATCH (m:Movie)
WHERE m.revenue < 1000
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 3","match $m isa movie, has title $t, has revenue $r; $r < 1000; sort $r asc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
419,Which three users have rated the most diverse set of movies in terms of genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN u.name AS user, genreCount AS distinctGenresRated","match $u isa user, has name $n; rated (user: $u, film: $m); in_genre (film: $m, genre: $g); select $n, $g; distinct; reduce $count = count($g) groupby $n; sort $count desc; limit 3; fetch { ""user"": $n, ""distinctGenresRated"": $count };"
420,List the top 3 actors who have the most diverse filmography in terms of genres they acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name AS actor, genreCount AS numGenres","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
select $a, $n, $g;
distinct;
reduce $count = count($g) groupby $a, $n;
sort $count desc;
limit 3;
fetch {
  ""actor"": $n,
  ""numGenres"": $count
};"
421,What are the first 3 movies with a poster URL containing 'moon'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'moon'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster $p, has title $t;
$p like "".*moon.*"";
limit 3;
fetch { ""title"": $t };"
422,List the first 3 actors who have acted in a superhero movie.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Superhero'})
RETURN a.name AS actor
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); $g has name ""Superhero""; limit 3; fetch { ""actor"": $n };"
424,Which three genres have the lowest average IMDb rating?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g, avg(m.imdbRating) AS avgRating
ORDER BY avgRating
LIMIT 3
RETURN g.name AS genre, avgRating","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has imdb_rating $r;
reduce $avg = mean($r) groupby $n;
sort $avg asc;
limit 3;
fetch { ""genre"": $n, ""avgRating"": $avg };"
425,List the top 3 movies that have been rated by over 1000 users.,"MATCH (m:Movie)<-[r:RATED]-()
WITH m, count(r) AS numRatings
WHERE numRatings > 1000
RETURN m.title, m.year, numRatings
ORDER BY numRatings DESC
LIMIT 3","match
$m isa movie, has title $t, has year $y;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $m, $t, $y;
match $numRatings > 1000;
sort $numRatings desc;
limit 3;
fetch { ""title"": $t, ""year"": $y, ""numRatings"": $numRatings };"
426,What are the first 3 movies with a plot mentioning 'magic'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'magic'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*magic.*"";
limit 3;
fetch { ""title"": $t };"
427,Which three directors have the most movies with a runtime under 90 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime < 90
WITH d, count(m) AS numShortMovies
ORDER BY numShortMovies DESC
LIMIT 3
RETURN d.name AS director, numShortMovies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
$m has runtime $r;
$r < 90;
reduce $count = count($m) groupby $d, $n;
sort $count desc;
limit 3;
fetch {
  ""director"": $n,
  ""numShortMovies"": $count
};"
428,Which movies have a runtime greater than 120 minutes and less than 180 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.runtime < 180
RETURN m.title, m.runtime
LIMIT 5","match $m isa movie, has title $t, has runtime $r; $r > 120; $r < 180; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
429,List all movies directed by a person born in France.,"MATCH (p:Person {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 5","match $p isa person, has born_in ""France""; directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t };"
430,What are the top 5 highest-grossing movies released after 2010?,"MATCH (m:Movie)
WHERE m.released >= '2010-01-01' AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has revenue $r; $rel >= ""2010-01-01""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
431,Find all actors who acted in a movie that grossed over 500 million.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has revenue $r; $r > 500000000; limit 5; fetch { ""actor"": $n };"
432,Which directors have directed more than three movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS num_movies
WHERE num_movies > 3
RETURN d.name AS director, num_movies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
reduce $num_movies = count($m) groupby $d, $n;
match $num_movies > 3;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
433,List all movies with an IMDb rating above 8.0 that were released after 2000.,"MATCH (m:Movie)
WHERE m.imdbRating > 8.0 AND m.year >= 2000
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r, has year $y; $r > 8.0; $y >= 2000; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
434,Which users have rated more than 50 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
WHERE num_ratings > 50
RETURN u.name AS user, num_ratings","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $u, $n;
match $numRatings > 50;
fetch { ""user"": $n, ""numRatings"": $numRatings };"
435,Which genres are associated with movies that have a budget over 100 million?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name AS genre
LIMIT 5","match $m isa movie, has budget $b; $b > 100000000; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
436,List all actors born in the USA who have acted in more than 5 movies.,"MATCH (a:Actor {bornIn: 'USA'})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n, has born_in ""USA"";
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
match $count > 5;
sort $count desc;
limit 5;
fetch {
  ""name"": $n,
  ""numMovies"": $count
};"
437,What are the top 3 movies with the highest IMDb rating released before 1990?,"MATCH (m:Movie)
WHERE m.released < '1990-01-01' AND m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has released $rel, has imdb_rating $r; $rel < ""1990-01-01""; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
438,Which movies have been acted in and directed by the same person?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title, p.name
LIMIT 5","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t, ""person"": $n };"
439,Find all movies where the main language is English and have a budget over 50 million dollars.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND m.budget > 50000000
RETURN m","match
$m isa movie, has languages $l, has budget $b, has title $t, has url $u, has runtime $rt, has revenue $rev, has imdb_rating $ir, has released $rel, has countries $c, has plot $p, has imdb_votes $iv, has imdb_id $iid, has year $y, has poster $po, has movie_id $mid, has tmdb_id $tid;
$l like "".*English.*"";
$b > 50000000;
fetch { ""title"": $t, ""url"": $u, ""runtime"": $rt, ""revenue"": $rev, ""imdb_rating"": $ir, ""released"": $rel, ""countries"": $c, ""languages"": $l, ""plot"": $p, ""imdb_votes"": $iv, ""imdb_id"": $iid, ""year"": $y, ""poster"": $po, ""movie_id"": $mid, ""tmdb_id"": $tid, ""budget"": $b };"
440,Which users have given a rating of less than 3.0 to any movie?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating < 3.0
RETURN u.name, m.title, r.rating
LIMIT 5","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; $rating < 3.0; $m has title $t; limit 5; fetch { ""user"": $n, ""movie"": $t, ""rating"": $rating };"
441,List the top 5 movies with the most IMDb votes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
442,Which movies feature both English and Spanish as languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'Spanish' IN m.languages
RETURN m.title","match
$m isa movie, has languages $l, has title $t;
$l like "".*English.*"";
$l like "".*Spanish.*"";
fetch { ""title"": $t };"
443,Find all directors who were born after 1970.,"MATCH (d:Director)
WHERE d.born > date('1970-01-01')
RETURN d.name, d.born
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d, film: $m); $b > 1970-01-01; limit 5; fetch { ""name"": $n, ""born"": $b };"
444,Which actors have worked in both 'Animation' and 'Comedy' genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Animation'})
MATCH (a)-[:ACTED_IN]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Comedy'})
RETURN DISTINCT a.name
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m1); acted_in (actor: $a, film: $m2); in_genre (film: $m1, genre: $g1); in_genre (film: $m2, genre: $g2); $g1 has name ""Animation""; $g2 has name ""Comedy""; limit 5; fetch { ""actor"": $n };"
445,List all movies that have grossed more than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.revenue, m.budget","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > $bud;
sort $rev desc;
limit 10;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
446,What are the top 5 movies with the lowest budgets that have a runtime over 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 90 AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match $m isa movie, has title $t, has budget $b, has runtime $r; $r > 90; sort $b asc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
448,Which directors have a biography mentioning 'Academy Award'?,"MATCH (d:Director)
WHERE d.bio CONTAINS 'Academy Award'
RETURN d.name, d.bio","match
$d isa person, has bio $b, has name $n;
(director: $d, film: $m) isa directed;
$b like "".*Academy Award.*"";
fetch { ""name"": $n, ""bio"": $b };"
449,List all movies directed by someone who has also acted in a movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 5","match $p isa person, has name $n; directed (director: $p, film: $m); acted_in (actor: $p, film: $m2); $m has title $t; limit 5; fetch { ""title"": $t };"
451,Find all actors who have acted in a movie directed by someone born in France.,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)<-[:DIRECTED]-(director:Director {bornIn: 'France'})
RETURN actor.name, movie.title
LIMIT 5","match $actor isa person, has name $an; $director isa person, has name $dn; acted_in (actor: $actor, film: $movie); directed (director: $director, film: $movie); $director has born_in ""France""; $movie has title $t; limit 5; fetch { ""actor"": $an, ""movie"": $t };"
452,Which movies have a plot mentioning 'war'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'war'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*war.*"";
fetch { ""title"": $t, ""plot"": $p };"
453,List all genres that a specific movie 'Toy Story' belongs to.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name","match $m isa movie, has title ""Toy Story""; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
454,Find the top 5 movies by revenue that have a runtime under 100 minutes.,"MATCH (m:Movie)
WHERE m.runtime < 100
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r, has runtime $rt; $rt < 100; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
455,Which actors have the highest number of movies acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
456,List all directors who have directed a movie in the Comedy genre.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN DISTINCT d.name
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name ""Comedy""; limit 5; fetch { ""director"": $n };"
457,What are the top 3 movies with the highest budget that also have revenue data?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue
ORDER BY m.budget DESC
LIMIT 3","match $m isa movie, has title $t, has budget $b, has revenue $r; sort $b desc; limit 3; fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
458,Which movies have been rated 5.0 by more than 10 users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
WITH m, count(u) AS numRatings
WHERE numRatings > 10
RETURN m.title, numRatings","match
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating 5.0;
reduce $numRatings = count($u) groupby $t;
sort $numRatings desc;
limit 10;
fetch { ""title"": $t, ""numRatings"": $numRatings };"
459,List all movies where the main actor is also the director.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title, p.name
LIMIT 5","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t, ""person"": $n };"
460,Find all movies with a poster URL that includes 'face' in it.,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m","match
$m isa movie, has poster $p, has title $t, has url $u, has runtime $rt, has revenue $rev, has imdb_rating $ir, has released $rel, has countries $c, has languages $l, has plot $pl, has imdb_votes $iv, has imdb_id $iid, has year $y, has movie_id $mid, has tmdb_id $tid, has budget $b;
$p like "".*face.*"";
fetch { ""title"": $t, ""url"": $u, ""runtime"": $rt, ""revenue"": $rev, ""imdb_rating"": $ir, ""released"": $rel, ""countries"": $c, ""languages"": $l, ""plot"": $pl, ""imdb_votes"": $iv, ""imdb_id"": $iid, ""year"": $y, ""poster"": $p, ""movie_id"": $mid, ""tmdb_id"": $tid, ""budget"": $b };"
461,Which movies have been released on a leap day?,"MATCH (m:Movie)
WHERE m.released =~ "".+02-29""
RETURN m.title, m.released","match $m isa movie, has released $r, has title $t; $r like "".*02-29.*""; fetch { ""title"": $t, ""released"": $r };"
462,List all actors who have never acted in an 'Action' genre movie.,"MATCH (a:Actor)
WHERE NOT exists {
  (a)-[:ACTED_IN]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Action'})
}
RETURN a.name AS actor","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
not {
    (film: $m, genre: $g) isa in_genre;
    $g has name ""Action"";
};
fetch { ""actor"": $n };"
463,Which director has the most diverse portfolio of movie genres directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 1","match $d isa person, has name $n; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); reduce $num_genres = count($g) groupby $n; sort $num_genres desc; limit 1; fetch { ""director"": $n, ""num_genres"": $num_genres };"
464,What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match $m isa movie, has title $t, has runtime $r; sort $r asc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
466,Which actors have played a role in movies with a budget over 200 million dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 200000000
RETURN a.name AS actor, m.title AS movie","match $a isa person, has name $an; acted_in (actor: $a, film: $m); $m has title $mt, has budget $b; $b > 200000000; fetch { ""actor"": $an, ""movie"": $mt };"
468,List all users who have rated the same movie with different ratings.,"MATCH (u1:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User)
WHERE u1 <> u2 AND r1.rating <> r2.rating
RETURN u1.name AS User1, r1.rating AS User1Rating, 
       u2.name AS User2, r2.rating AS User2Rating,
       m.title AS Movie","match $r1 isa rated (user: $u1, film: $m), has rating $rating1; $r2 isa rated (user: $u2, film: $m), has rating $rating2; not { $u1 is $u2; }; not { $rating1 == $rating2; }; $u1 has name $n1; $u2 has name $n2; $m has title $t; fetch { ""User1"": $n1, ""User1Rating"": $rating1, ""User2"": $n2, ""User2Rating"": $rating2, ""Movie"": $t };"
469,What are the top 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.year
ORDER BY m.year
LIMIT 3","match $m isa movie, has title $t, has year $y; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y };"
470,Find all movies that have been acted in by an actor born before 1950.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born < date('1950-01-01')
RETURN m","match $a isa person, has born $b; $b < 1950-01-01; acted_in (actor: $a, film: $m); $m has title $t; fetch { ""title"": $t };"
471,Which movies have a plot that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*love.*"";
fetch { ""title"": $t, ""plot"": $p };"
472,List all movies that have been directed by a person who died before 2000.,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person)
WHERE p.died < date('2000-01-01')
RETURN m.title, p.name, p.died","match $p isa person, has name $n, has died $d; $d < 2000-01-01; directed (director: $p, film: $m); $m has title $t; fetch { ""title"": $t, ""name"": $n, ""died"": $d };"
474,Find all users who have rated movies from more than three different genres.,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN u","match
$u isa user, has name $n;
(user: $u, film: $m) isa rated;
(film: $m, genre: $g) isa in_genre;
$g has name $gn;
reduce $num_genres = count($gn) groupby $n;
sort $num_genres desc;
limit 10;
fetch { ""user"": $n };"
475,Which actors have a biography mentioning 'Broadway'?,"MATCH (a:Actor)
WHERE a.bio CONTAINS 'Broadway'
RETURN a.name, a.bio","match
$a isa person, has bio $b, has name $n;
(actor: $a, film: $m) isa acted_in;
$b like "".*Broadway.*"";
fetch { ""name"": $n, ""bio"": $b };"
476,List all movies with a revenue greater than 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m.title, m.revenue","match $m isa movie, has title $t, has revenue $r; $r > 1000000000; fetch { ""title"": $t, ""revenue"": $r };"
478,Find all directors who have directed a movie in their country of birth.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn IN m.countries
RETURN DISTINCT d.name AS director, d.bornIn AS bornIn","match
$d isa person, has born_in $b, has name $n;
(director: $d, film: $m) isa directed;
$m has countries $c;
$b == $c;
fetch { ""director"": $n, ""bornIn"": $b };"
479,Which movies have actors who have also directed a movie?,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)
WHERE exists{ (actor)-[:DIRECTED]->(:Movie) }
RETURN movie.title, actor.name","match $actor isa person, has name $an; acted_in (actor: $actor, film: $movie); directed (director: $actor); $movie has title $t; fetch { ""title"": $t, ""name"": $an };"
480,List all movies that have an IMDb rating and were released in the year 2000.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.year = 2000
RETURN m.title, m.imdbRating, m.year","match $m isa movie, has title $t, has imdb_rating $r, has year $y; $y == 2000; fetch { ""title"": $t, ""imdb_rating"": $r, ""year"": $y };"
481,Find all movies that feature an actor born in Canada.,"MATCH (a:Actor {bornIn: 'Canada'})-[:ACTED_IN]->(m:Movie)
RETURN m","match $a isa person, has born_in ""Canada""; acted_in (actor: $a, film: $m); $m has title $t; fetch { ""title"": $t };"
482,Which movies have been rated by users named 'John Smith'?,"MATCH (u:User {name: 'John Smith'})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match $u isa user, has name ""John Smith""; $r isa rated (user: $u, film: $m), has rating $rating; $m has title $t; fetch { ""movie"": $t, ""rating"": $rating };"
483,Which directors have directed both a comedy and a drama movie?,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Comedy'})
WHERE exists{ (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Drama'}) }
RETURN d.name AS director","match $d isa person, has name $n; directed (director: $d, film: $m1); in_genre (film: $m1, genre: $g1); $g1 has name ""Comedy""; directed (director: $d, film: $m2); in_genre (film: $m2, genre: $g2); $g2 has name ""Drama""; fetch { ""director"": $n };"
485,Find all movies that have a movieId starting with '1' and have been rated by at least one user.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WHERE m.movieId STARTS WITH '1'
RETURN m","match
$m isa movie, has movie_id $mid, has title $t;
$mid like ""1%"";
(user: $u, film: $m) isa rated;
fetch { ""title"": $t, ""movieId"": $mid };"
486,Which actors have acted in movies that have a plot mentioning 'adventure'?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN a.name AS actor","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has plot $p;
$p like "".*adventure.*"";
fetch { ""actor"": $n };"
487,List all movies that have been released on Christmas Day.,"MATCH (m:Movie)
WHERE m.released ENDS WITH ""12-25""
RETURN m.title, m.released","match $m isa movie, has title $t, has released $r; $r like "".*12-25$""; fetch { ""title"": $t, ""released"": $r };"
490,What are the top 3 movies with the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
491,Find all actors who have acted in a movie that has an IMDb rating of 9 or higher.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating >= 9
RETURN a.name AS actor, m.title AS movie, m.imdbRating AS rating","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has title $t, has imdb_rating $r; $r >= 9; fetch { ""actor"": $n, ""movie"": $t, ""rating"": $r };"
492,Which movies have a plot that includes the word 'escape'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'escape'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*escape.*"";
fetch { ""title"": $t, ""plot"": $p };"
493,List all genres associated with movies that have a runtime less than 80 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime < 80
RETURN DISTINCT g.name","match $m isa movie, has runtime $r; $r < 80; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
494,Find the top 5 movies with the highest revenue that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '199' AND m.revenue IS NOT NULL
RETURN m.title, m.released, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has revenue $rev; $rel like ""^199.*""; sort $rev desc; limit 5; fetch { ""title"": $t, ""released"": $rel, ""revenue"": $rev };"
495,Which actors have worked in a movie with a director from the same country?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WHERE a.bornIn IS NOT NULL AND d.bornIn IS NOT NULL AND a.bornIn = d.bornIn
RETURN a.name AS actor, d.name AS director, a.bornIn AS country, m.title AS movie","match $a isa person, has name $an, has born_in $abc; acted_in (actor: $a, film: $m); directed (director: $d, film: $m); $d has name $dn, has born_in $dbc; $abc == $dbc; $m has title $t; fetch { ""actor"": $an, ""director"": $dn, ""country"": $abc, ""movie"": $t };"
496,List all movies that have a director who has also acted in a movie.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title","match $d isa person; directed (director: $d, film: $m); acted_in (actor: $d); $m has title $t; fetch { ""title"": $t };"
497,What are the top 3 movies with the lowest IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v; sort $v asc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
499,List the top 5 oldest directors in the database.,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d.name, d.born
ORDER BY d.born
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d); sort $b asc; limit 5; fetch { ""name"": $n, ""born"": $b };"
500,Find all movies that have a plot mentioning 'hero'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'hero'
RETURN m","match $m isa movie, has title $t, has plot $p; $p contains ""hero""; fetch { ""title"": $t };"
501,List all movies that have a language list including Japanese.,"MATCH (m:Movie)
WHERE 'Japanese' IN m.languages
RETURN m","match
$m isa movie, has languages $l, has title $t, has url $u, has runtime $rt, has revenue $rev, has imdb_rating $ir, has released $rel, has countries $c, has plot $p, has imdb_votes $iv, has imdb_id $iid, has year $y, has poster $po, has movie_id $mid, has tmdb_id $tid, has budget $b;
$l like "".*Japanese.*"";
fetch { ""title"": $t, ""url"": $u, ""runtime"": $rt, ""revenue"": $rev, ""imdb_rating"": $ir, ""released"": $rel, ""countries"": $c, ""languages"": $l, ""plot"": $p, ""imdb_votes"": $iv, ""imdb_id"": $iid, ""year"": $y, ""poster"": $po, ""movie_id"": $mid, ""tmdb_id"": $tid, ""budget"": $b };"
502,Which directors have directed a movie that has been rated below 3.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating < 3.0
RETURN DISTINCT d.name AS director, m.title AS movie, r.rating AS rating","match $d isa person, has name $dn; directed (director: $d, film: $m); $r isa rated (film: $m), has rating $rating; $rating < 3.0; $m has title $t; fetch { ""director"": $dn, ""movie"": $t, ""rating"": $rating };"
503,List all actors who have a poster URL that includes 'smile' in it.,"MATCH (a:Actor)
WHERE a.poster CONTAINS 'smile'
RETURN a.name, a.poster","match
$a isa person, has poster $p, has name $n;
(actor: $a, film: $m) isa acted_in;
$p like "".*smile.*"";
fetch { ""name"": $n, ""poster"": $p };"
505,Find all directors who have directed a movie in a language other than English.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE NOT 'English' IN m.languages
RETURN DISTINCT d.name AS director","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
$m has languages $l;
not { $l like "".*English.*""; };
fetch { ""director"": $n };"
507,Find all movies with an IMDb rating less than 5 that have been directed by a director born in the USA.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'USA'})
WHERE m.imdbRating < 5
RETURN m.title AS movie, m.imdbRating AS rating, d.name AS director","match $d isa person, has name $dn, has born_in ""USA""; directed (director: $d, film: $m); $m has title $t, has imdb_rating $r; $r < 5; fetch { ""movie"": $t, ""rating"": $r, ""director"": $dn };"
508,Which movies have a plot that includes the word 'monster'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'monster'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*monster.*"";
fetch { ""title"": $t, ""plot"": $p };"
509,List all movies that have been acted in by an actor who has also directed a movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN m.title","match $p isa person; acted_in (actor: $p, film: $m); directed (director: $p); $m has title $t; fetch { ""title"": $t };"
511,Find all actors who have acted in movies that have been released on New Year's Day.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released ENDS WITH ""01-01""
RETURN a.name AS actor, m.title AS movie, m.released AS releaseDate","match $a isa person, has name $an; acted_in (actor: $a, film: $m); $m has title $t, has released $r; $r like "".*01-01$""; fetch { ""actor"": $an, ""movie"": $t, ""releaseDate"": $r };"
512,Which movies have been directed by directors who have also acted in movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS movie, d.name AS director","match $d isa person, has name $dn; directed (director: $d, film: $m); acted_in (actor: $d); $m has title $t; fetch { ""movie"": $t, ""director"": $dn };"
513,List all movies that have a revenue greater than 100 million dollars and have been rated by more than 500 users.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.imdbVotes > 500
RETURN m.title, m.revenue, m.imdbVotes","match
$m isa movie, has revenue $r, has title $t;
$r > 100000000;
rated (user: $u, film: $m);
reduce $count = count($u) groupby $m, $r, $t;
match $count > 500;
fetch { ""title"": $t, ""revenue"": $r, ""rating_count"": $count };"
514,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
515,List the first 3 actors born in France.,"MATCH (a:Actor {bornIn: 'France'})
RETURN a.name
LIMIT 3","match $a isa person, has name $n, has born_in ""France""; acted_in (actor: $a); limit 3; fetch { ""name"": $n };"
516,Which 5 movies have the highest imdbRating?,"MATCH (m:Movie)
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
517,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
518,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
519,List the first 3 directors born in the USA.,"MATCH (d:Director)
WHERE d.bornIn CONTAINS 'USA'
RETURN d.name, d.bornIn
LIMIT 3","match
$d isa person, has born_in $b, has name $n;
(director: $d, film: $m) isa directed;
$b like "".*USA.*"";
limit 3;
fetch { ""name"": $n, ""bornIn"": $b };"
520,Which movies released after 2010 have a budget over 100 million? Limit to 5 movies.,"MATCH (m:Movie)
WHERE m.released > '2010' AND m.budget > 100000000
RETURN m.title, m.released, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has released $r, has budget $b; $r > ""2010""; $b > 100000000; sort $b desc; limit 5; fetch { ""title"": $t, ""released"": $r, ""budget"": $b };"
521,What are the top 3 genres by number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
522,List 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
match $numMovies > 10;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
523,Which 3 movies have been rated by the most users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $m isa movie, has title $t; rated (film: $m, user: $u); reduce $numRatings = count($u) groupby $t; sort $numRatings desc; limit 3; fetch { ""title"": $t, ""numRatings"": $numRatings };"
525,List the first 3 directors who have also acted in movies.,"MATCH (p:Person)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) } 
  AND exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n; directed (director: $p); acted_in (actor: $p); limit 3; fetch { ""name"": $n };"
526,Which movies have a revenue to budget ratio greater than 2? Limit to 5 movies.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.revenue / m.budget > 2
RETURN m.title, m.revenue, m.budget, m.revenue / m.budget AS ratio
ORDER BY ratio DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$bud > 0;
let $ratio = $rev / $bud;
$ratio > 2.0;
sort $ratio desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud, ""ratio"": $ratio };"
527,What are the first 3 recent movies directed by directors born after 1970?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.born > date('1970-01-01')
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match $d isa person, has born $b; $b > 1970-01-01; directed (director: $d, film: $m); $m has title $t, has released $r; sort $r desc; limit 3; fetch { ""title"": $t, ""released"": $r };"
528,List 5 movies that have both English and French as languages.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m.title
LIMIT 5","match
$m isa movie, has languages $l1, has languages $l2, has title $t;
$l1 like "".*English.*"";
$l2 like "".*French.*"";
limit 5;
fetch { ""title"": $t };"
529,Which 3 users have the highest average movie rating?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated (user: $u), has rating $rating; reduce $avgRating = mean($rating) groupby $n; sort $avgRating desc; limit 3; fetch { ""user"": $n, ""avgRating"": $avgRating };"
530,List the top 5 movies with the lowest imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v asc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
531,What are the first 3 movies directed by a person born in France?,"MATCH (p:Person {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match $p isa person, has born_in ""France""; directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
532,Which actors have a poster URL on IMDb? Limit to 5 actors.,"MATCH (a:Actor)
WHERE a.poster IS NOT NULL
RETURN a.name, a.poster
LIMIT 5","match $a isa person, has name $n, has poster $p; acted_in (actor: $a); limit 5; fetch { ""name"": $n, ""poster"": $p };"
533,What are the first 3 movies with a plot containing the word 'friendship'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*friendship.*"";
limit 3;
fetch { ""title"": $t };"
534,Which 5 directors have directed the most movies with budgets over 50 million?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 50000000
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has budget $b; $b > 50000000; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""director"": $n, ""numMovies"": $numMovies };"
535,List the first 3 actors who have acted in a movie released before 1950.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released < '1950'
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has released $r; $r < ""1950""; limit 3; fetch { ""name"": $n };"
539,What are the first 3 movies where a director has also acted?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title
LIMIT 3","match $p isa person; directed (director: $p, film: $m); acted_in (actor: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
540,Which actors have directed a movie they acted in? Limit to 5 actors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(a)
RETURN a.name AS actor, m.title AS movie
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); directed (director: $a, film: $m); $m has title $t; limit 5; fetch { ""actor"": $n, ""movie"": $t };"
541,List the top 5 highest-grossing movies of 2014.,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has revenue $r; $y == 2014; sort $r desc; limit 5; fetch { ""movie"": $t, ""revenue"": $r };"
542,What are the first 3 movies with an imdbRating greater than 8.5?,"MATCH (m:Movie)
WHERE m.imdbRating > 8.5
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; $r > 8.5; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
544,List the first 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
545,Which 5 movies have the most actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 5; fetch { ""movie"": $t, ""numActors"": $numActors };"
546,List the top 5 directors by number of movies directed in the 1990s.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year >= 1990 AND m.year < 2000
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has year $y; $y >= 1990; $y < 2000; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""director"": $n, ""numMovies"": $numMovies };"
547,What are the first 3 movies with a runtime less than 90 minutes and an imdbRating over 7?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating > 7
RETURN m.title, m.runtime, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $rt, has imdb_rating $ir; $rt < 90; $ir > 7; sort $ir desc; limit 3; fetch { ""title"": $t, ""runtime"": $rt, ""imdb_rating"": $ir };"
549,What are the first 3 movies with a poster URL from tmdb?,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL
RETURN m.title, m.poster
LIMIT 3","match
$m isa movie, has title $t, has poster $p;
limit 3;
fetch { ""title"": $t, ""poster"": $p };"
550,Which 5 users have rated movies in the most diverse set of genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN u.name AS user, genreCount AS distinctGenresRated","match $u isa user, has name $n; rated (user: $u, film: $m); in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $n; sort $genreCount desc; limit 5; fetch { ""user"": $n, ""distinctGenresRated"": $genreCount };"
551,List the top 5 actors by number of different genres they've acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN a.name AS actor, genreCount AS numberOfGenres","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $n; sort $genreCount desc; limit 5; fetch { ""actor"": $n, ""numberOfGenres"": $genreCount };"
552,What are the first 3 most recently released movies with a revenue under 10 million?,"MATCH (m:Movie)
WHERE m.revenue < 10000000
RETURN m.title, m.released, m.revenue
ORDER BY m.released DESC
LIMIT 3","match $m isa movie, has title $t, has released $rel, has revenue $rev; $rev < 10000000; sort $rel desc; limit 3; fetch { ""title"": $t, ""released"": $rel, ""revenue"": $rev };"
553,Which 5 movies have the highest average user rating? Limit to movies rated by at least 10 users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 10
RETURN m.title AS movie, avgRating
ORDER BY avgRating DESC
LIMIT 5","match
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avgRating = mean($rating), $numRatings = count($r) groupby $m, $t;
match $numRatings >= 10;
sort $avgRating desc;
limit 5;
fetch { ""movie"": $t, ""avgRating"": $avgRating };"
554,List the first 3 directors who died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died
LIMIT 3","match $d isa person, has name $n, has died $di; $di > 2000-01-01; directed (director: $d); sort $di asc; limit 3; fetch { ""name"": $n, ""died"": $di };"
555,What are the top 5 movies that have the most votes on IMDb?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
556,List the top 5 movies that have been rated the lowest by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating
LIMIT 5
RETURN m.title AS movie, avgRating","match $m isa movie, has title $t; $r isa rated (film: $m), has rating $rating; reduce $avgRating = mean($rating) groupby $t; sort $avgRating asc; limit 5; fetch { ""movie"": $t, ""avgRating"": $avgRating };"
557,Which 3 directors were born in the same country they directed their first movie?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn IS NOT NULL AND d.bornIn IN m.countries
WITH d, m
ORDER BY m.year
RETURN d.name AS director, d.bornIn AS bornCountry, m.title AS firstMovie
  LIMIT 3","with fun first_movie_year($d: person) -> integer:
  match 
    directed (director: $d, film: $m);
    $m has year $y;
  return min($y);
match
$d isa person, has born_in $b, has name $n;
directed (director: $d, film: $m);
$m has countries $c, has year $y, has title $t;
$b == $c;
let $first_year = first_movie_year($d);
$y == $first_year;
sort $y asc;
limit 3;
fetch { ""director"": $n, ""bornCountry"": $b, ""firstMovie"": $t };"
560,List the first 3 actors who have a tmdbId but no imdbId.,"MATCH (a:Actor)
WHERE a.tmdbId IS NOT NULL AND a.imdbId IS NULL
RETURN a.name
LIMIT 3","match $a isa person, has name $n, has tmdb_id $t; acted_in (actor: $a); not { $a has imdb_id $i; }; limit 3; fetch { ""name"": $n };"
562,List the first 3 movies where the main genre is 'Adventure'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); $g has name ""Adventure""; limit 3; fetch { ""title"": $t };"
563,What are the top 5 oldest movies in the database by release year?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m.title, m.year
ORDER BY m.year
LIMIT 5","match $m isa movie, has title $t, has year $y; sort $y asc; limit 5; fetch { ""title"": $t, ""year"": $y };"
564,List the first 3 directors who have directed a movie without having a bio on their profile.,"MATCH (d:Director)-[:DIRECTED]->(:Movie)
WHERE d.bio IS NULL
RETURN d.name
LIMIT 3","match $d isa person, has name $n; directed (director: $d); not { $d has bio $b; }; limit 3; fetch { ""name"": $n };"
565,Which 5 actors have the most roles listed as uncredited?,"MATCH (a:Actor)-[r:ACTED_IN]->(:Movie)
WHERE r.role CONTAINS 'uncredited'
RETURN a.name AS actor, count(r) AS uncreditedRoles
ORDER BY uncreditedRoles DESC
LIMIT 5","match $a isa person, has name $n; $r isa acted_in (actor: $a), has character_role $role; $role like "".*uncredited.*""; reduce $uncreditedRoles = count($r) groupby $a; sort $uncreditedRoles desc; limit 5; fetch { ""actor"": $a.name, ""uncreditedRoles"": $uncreditedRoles };"
566,List the top 5 most reviewed movies on IMDb.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
567,What are the first 3 movies directed by a director born in Nebraska?,"MATCH (d:Director {bornIn: 'Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match $d isa person, has born_in ""Nebraska, USA""; directed (director: $d, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
568,Which 5 directors have directed the same movie?,"MATCH (d1:Director)-[:DIRECTED]->(m:Movie)<-[:DIRECTED]-(d2:Director)
WHERE d1 <> d2
RETURN d1.name AS director1, d2.name AS director2, m.title AS movie
LIMIT 5","match directed (director: $d1, film: $m); directed (director: $d2, film: $m); not { $d1 is $d2; }; $d1 has name $n1; $d2 has name $n2; $m has title $t; limit 5; fetch { ""director1"": $n1, ""director2"": $n2, ""movie"": $t };"
569,List the first 3 actors who acted in a movie without having a born date listed.,"MATCH (a:Actor)-[:ACTED_IN]->(:Movie)
WHERE a.born IS NULL
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a); not { $a has born $b; }; limit 3; fetch { ""name"": $n };"
571,List the first 3 users who rated a movie with a budget over 200 million.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.budget > 200000000
RETURN u.name AS user, m.title AS movie, r.rating AS rating
ORDER BY r.timestamp
LIMIT 3","match $u isa user, has name $n; $r isa rated (user: $u, film: $m), has rating $rating, has timestamp $ts; $m has title $t, has budget $b; $b > 200000000; sort $ts asc; limit 3; fetch { ""user"": $n, ""movie"": $t, ""rating"": $rating };"
573,List the first 3 movies with a poster URL on tmdb but not on IMDb.,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL AND m.imdbId IS NULL
RETURN m.title, m.poster
LIMIT 3","match $m isa movie, has title $t, has poster $p; not { $m has imdb_id $i; }; limit 3; fetch { ""title"": $t, ""poster"": $p };"
574,What are the top 5 movies with the most genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 5; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
575,Which 5 movies have been directed by a person who also acted in them?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title
LIMIT 5","match $p isa person; directed (director: $p, film: $m); acted_in (actor: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t };"
576,List the top 5 movies by number of actors born in the USA who acted in them.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE a.bornIn = 'USA'
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); $a has born_in ""USA""; reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 5; fetch { ""movie"": $t, ""numActors"": $numActors };"
578,Which 5 movies have the most diverse cast in terms of countries of origin?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE p.bornIn IS NOT NULL
WITH m, count(DISTINCT p.bornIn) AS numCountries
ORDER BY numCountries DESC
LIMIT 5
RETURN m.title AS movie, numCountries AS distinctCountriesRepresented","match $m isa movie, has title $t; acted_in (film: $m, actor: $p); $p has born_in $b; reduce $numCountries = count($b) groupby $t; sort $numCountries desc; limit 5; fetch { ""movie"": $t, ""distinctCountriesRepresented"": $numCountries };"
579,List the first 3 directors who have directed a movie with a runtime over 180 minutes.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 180
RETURN d.name AS director
ORDER BY director
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r > 180; sort $n asc; limit 3; fetch { ""director"": $n };"
581,List the first 3 movies with an imdbId that starts with '07'.,"MATCH (m:Movie)
WHERE m.imdbId STARTS WITH '07'
RETURN m.title, m.imdbId
LIMIT 3","match $m isa movie, has title $t, has imdb_id $i; $i like ""^07.*""; limit 3; fetch { ""title"": $t, ""imdb_id"": $i };"
582,Which 5 directors have the most distinct movies directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(DISTINCT m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $num_movies = count($m) groupby $n; sort $num_movies desc; limit 5; fetch { ""director"": $n, ""num_movies"": $num_movies };"
583,List the top 5 actors by number of movies they've acted in with a budget over 100 million.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 100000000
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b > 100000000; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""actor"": $n, ""numMovies"": $numMovies };"
586,List the first 3 movies released in the year 2000 or later with a rating under 5.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.imdbRating < 5
RETURN m.title, m.year, m.imdbRating
ORDER BY m.year
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_rating $r; $y >= 2000; $r < 5; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
587,What are the top 5 movies with the highest revenue in the Adventure genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; in_genre (film: $m, genre: $g); $g has name ""Adventure""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
588,List the first 3 actors who have died after 2000.,"MATCH (a:Actor)
WHERE a.died IS NOT NULL AND a.died > date('2000-01-01')
RETURN a.name, a.died
ORDER BY a.died
LIMIT 3","match $a isa person, has name $n, has died $d; acted_in (actor: $a); $d > 2000-01-01; sort $d asc; limit 3; fetch { ""name"": $n, ""died"": $d };"
589,Which 5 directors have directed movies with the highest average imdbRating?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name AS director, avgRating","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avgRating = mean($r) groupby $n; sort $avgRating desc; limit 5; fetch { ""director"": $n, ""avgRating"": $avgRating };"
592,List the first 3 movies where the main actor is also the director.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match $p isa person; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
594,List the top 5 actors by number of movies they've acted in that have been released on Christmas Day.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released ENDS WITH ""12-25""
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has released $r; $r like "".*12-25$""; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""actor"": $n, ""numMovies"": $numMovies };"
595,What are the first 3 movies with a plot containing the word 'evil'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*evil.*"";
limit 3;
fetch { ""title"": $t };"
596,Which 5 directors have the longest cumulative runtime of all movies they've directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, sum(m.runtime) AS totalRuntime
RETURN d.name AS director, totalRuntime
ORDER BY totalRuntime DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; reduce $totalRuntime = sum($r) groupby $n; sort $totalRuntime desc; limit 5; fetch { ""director"": $n, ""totalRuntime"": $totalRuntime };"
597,Which movies have a runtime greater than 120 minutes and were released after 2010?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.released > '2010-01-01'
RETURN m.title, m.released, m.runtime","match $m isa movie, has title $t, has released $rel, has runtime $rt; $rt > 120; $rel > ""2010-01-01""; fetch { ""title"": $t, ""released"": $rel, ""runtime"": $rt };"
598,List all movies directed by a person born in France.,"MATCH (p:Person {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, p.name AS director","match $p isa person, has name $n, has born_in ""France""; directed (director: $p, film: $m); $m has title $t; fetch { ""movie"": $t, ""director"": $n };"
599,What are the top 5 highest-grossing movies of the 1990s?,"MATCH (m:Movie)
WHERE m.year >= 1990 AND m.year < 2000 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has revenue $r; $y >= 1990; $y < 2000; sort $r desc; limit 5; fetch { ""movie"": $t, ""revenue"": $r };"
600,Find all actors who have acted in more than one movie with an IMDb rating over 7.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating > 7
WITH a, count(m) AS numMovies
WHERE numMovies > 1
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
601,Which directors have directed at least three movies with budgets over 100 million dollars?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 100000000
WITH d, count(m) AS num_high_budget_movies
WHERE num_high_budget_movies >= 3
RETURN d.name AS director, num_high_budget_movies","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
$m has budget $b;
$b > 100000000;
reduce $num_high_budget_movies = count($m) groupby $n;
sort $num_high_budget_movies desc;
limit 10;
fetch { ""director"": $n, ""num_high_budget_movies"": $num_high_budget_movies };"
602,List the top 3 movies with the most IMDb votes released before 2000.,"MATCH (m:Movie)
WHERE m.year < 2000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_votes $v; $y < 2000; sort $v desc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
603,What are the genres of movies that have generated over 500 million dollars in revenue?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 500000000
RETURN DISTINCT g.name","match $m isa movie, has revenue $r; $r > 500000000; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
605,List all the directors who have both directed and acted in the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name AS director, m.title AS movie","match $p isa person, has name $n; directed (director: $p, film: $m); acted_in (actor: $p, film: $m); $m has title $t; fetch { ""director"": $n, ""movie"": $t };"
606,Find movies where the plot includes the word 'love' and were released on Valentine's Day.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love' AND m.released ENDS WITH '02-14'
RETURN m.title, m.released, m.plot","match $m isa movie, has title $t, has released $r, has plot $p; $p contains ""love""; $r like "".*02-14$""; fetch { ""title"": $t, ""released"": $r, ""plot"": $p };"
607,Which movies have a poster URL that contains 'face' and an IMDb rating above 8?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face' AND m.imdbRating > 8
RETURN m.title, m.poster, m.imdbRating","match
$m isa movie, has poster $p, has title $t, has imdb_rating $r;
$p like "".*face.*"";
$r > 8.0;
fetch { ""title"": $t, ""poster"": $p, ""imdbRating"": $r };"
608,List all genres associated with movies that have a budget less than 5 million dollars.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget < 5000000
RETURN DISTINCT g.name","match $m isa movie, has budget $b; $b < 5000000; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
609,What are the top 5 movies by revenue that contain the word 'war' in their title?,"MATCH (m:Movie)
WHERE toLower(m.title) CONTAINS 'war'
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; $t like ""(?i).*war.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
610,Identify all actors who have played roles in movies directed by directors born in Nebraska.,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)<-[:DIRECTED]-(director:Director)
WHERE director.bornIn = 'Nebraska'
RETURN actor.name AS actor, collect(movie.title) AS movies, collect(director.name) AS directors","match $actor isa person, has name $an; acted_in (actor: $actor, film: $movie); directed (director: $director, film: $movie); $director has born_in ""Nebraska"", has name $dn; $movie has title $t; fetch { ""actor"": $an, ""movie"": $t, ""director"": $dn };"
611,Which movies have been rated exactly 5 stars by at least one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title, m.year","match $m isa movie, has title $t, has year $y; $r isa rated (film: $m), has rating $rating; $rating == 5.0; fetch { ""title"": $t, ""year"": $y };"
613,What are the movies with a budget over 200 million dollars and a revenue under 500 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 200000000 AND m.revenue < 500000000
RETURN m.title, m.budget, m.revenue","match $m isa movie, has title $t, has budget $b, has revenue $r; $b > 200000000; $r < 500000000; fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
614,Identify directors who have never directed a movie rated under 6 on IMDb.,"MATCH (d:Director)
WHERE NOT exists {
  (d)-[:DIRECTED]->(m:Movie)
  WHERE m.imdbRating < 6
}
RETURN d.name AS director","match $d isa person, has name $n; directed (director: $d); not { directed (director: $d, film: $m); $m has imdb_rating $r; $r < 6; }; fetch { ""director"": $n };"
616,Find the top 3 movies with the shortest runtime and a revenue over 100 million dollars.,"MATCH (m:Movie)
WHERE m.revenue > 100000000
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match $m isa movie, has title $t, has runtime $rt, has revenue $r; $r > 100000000; sort $rt asc; limit 3; fetch { ""title"": $t, ""runtime"": $rt };"
617,What are the top 5 movies with the lowest IMDb ratings but highest revenues?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.imdbRating, m.revenue
ORDER BY m.imdbRating ASC, m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $ir, has revenue $r; sort $ir asc, $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $ir, ""revenue"": $r };"
618,Identify movies that have been released in both English and French.,"MATCH (m:Movie)
WHERE 'en' IN m.languages AND 'fr' IN m.languages
RETURN m.title","match
$m isa movie, has languages $l1, has languages $l2, has title $t;
$l1 == ""en"";
$l2 == ""fr"";
fetch { ""title"": $t };"
619,Which directors have the most movies with an IMDb rating over 8?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8
WITH d, count(m) AS numHighRatedMovies
ORDER BY numHighRatedMovies DESC
RETURN d.name AS director, numHighRatedMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; $r > 8; reduce $numHighRatedMovies = count($m) groupby $n; sort $numHighRatedMovies desc; fetch { ""director"": $n, ""numHighRatedMovies"": $numHighRatedMovies };"
620,List all users who have rated more than 50 movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
WHERE num_ratings > 50
RETURN u.name AS user, num_ratings","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $n;
sort $numRatings desc;
limit 5;
fetch { ""name"": $n, ""numRatings"": $numRatings };"
621,What are the top 3 most popular movies among users named 'John'?,"MATCH (u:User {name: 'John'})-[r:RATED]->(m:Movie)
WITH m, avg(r.rating) AS avgRating, count(r) AS numRatings
ORDER BY avgRating DESC, numRatings DESC
RETURN m.title AS movie, avgRating, numRatings
LIMIT 3","match $u isa user, has name ""John""; $r isa rated (user: $u, film: $m), has rating $rating; $m has title $t; reduce $avgRating = mean($rating), $numRatings = count($r) groupby $t; sort $avgRating desc, $numRatings desc; limit 3; fetch { ""movie"": $t, ""avgRating"": $avgRating, ""numRatings"": $numRatings };"
622,"Identify movies with more than 10,000 IMDb votes and a runtime under 90 minutes.","MATCH (m:Movie)
WHERE m.imdbVotes > 10000 AND m.runtime < 90
RETURN m.title, m.imdbVotes, m.runtime","match $m isa movie, has title $t, has imdb_votes $v, has runtime $r; $v > 10000; $r < 90; fetch { ""title"": $t, ""imdb_votes"": $v, ""runtime"": $r };"
623,Which actors have acted in movies that grossed over 1 billion dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 1000000000
RETURN a.name AS actor, m.title AS movie, m.revenue AS revenue","match $a isa person, has name $an; acted_in (actor: $a, film: $m); $m has title $t, has revenue $r; $r > 1000000000; fetch { ""actor"": $an, ""movie"": $t, ""revenue"": $r };"
625,What are the movies that have a plot containing the word 'zombie' with an IMDb rating over 7?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'zombie' AND m.imdbRating > 7
RETURN m.title, m.imdbRating, m.plot","match
$m isa movie, has plot $p, has title $t, has imdb_rating $r;
$p like "".*zombie.*"";
$r > 7.0;
fetch { ""title"": $t, ""imdbRating"": $r, ""plot"": $p };"
627,Which movies have actors with a bio that includes 'Wikipedia' and a revenue over 300 million dollars?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE a.bio CONTAINS 'Wikipedia' AND m.revenue > 300000000
RETURN m.title, m.revenue, a.name, a.bio","match
$m isa movie, has title $t, has revenue $rev;
(actor: $a, film: $m) isa acted_in;
$a has bio $b, has name $n;
$b like "".*Wikipedia.*"";
$rev > 300000000;
fetch { ""title"": $t, ""revenue"": $rev, ""name"": $n, ""bio"": $b };"
628,List the movies where the plot mentions 'friendship' and the budget was under 20 million dollars.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship' AND m.budget < 20000000
RETURN m.title, m.plot, m.budget","match
$m isa movie, has plot $p, has title $t, has budget $b;
$p like "".*friendship.*"";
$b < 20000000;
fetch { ""title"": $t, ""plot"": $p, ""budget"": $b };"
629,What are the top 5 highest-rated movies by users from the USA?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE u.name CONTAINS 'USA'
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating","match
$m isa movie, has title $t;
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
$n like "".*USA.*"";
reduce $avg = mean($rating) groupby $t;
sort $avg desc;
limit 5;
fetch { ""movie"": $t, ""avgRating"": $avg };"
630,Identify movies released in 'December' that have a genre of 'Horror'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Horror' AND m.released STARTS WITH 'December'
RETURN m.title, m.released","match
$m isa movie, has title $t, has released $rel;
(film: $m, genre: $g) isa in_genre;
$g has name ""Horror"";
$rel like ""December%"";
fetch { ""title"": $t, ""released"": $rel };"
632,List all movies with a title that starts with 'The' and have a poster URL ending with 'jpg'.,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The' AND m.poster ENDS WITH 'jpg'
RETURN m.title, m.poster","match $m isa movie, has title $t, has poster $p; $t like ""^The.*""; $p like "".*jpg$""; fetch { ""title"": $t, ""poster"": $p };"
633,What are the genres associated with movies that have an IMDb rating exactly 6.5?,"MATCH (m:Movie {imdbRating: 6.5})-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name","match $m isa movie, has imdb_rating 6.5; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
634,Identify all movies that have been directed by actors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; fetch { ""movie"": $t, ""person"": $n };"
635,Which movies have a director who was born after 1960 and have generated over 100 million in revenue?,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND exists {
  (d:Director)-[:DIRECTED]->(m)
  WHERE d.born > date('1960-01-01')  
}
RETURN m.title, m.revenue, m.year","match $m isa movie, has title $t, has revenue $r, has year $y; $r > 100000000; directed (director: $d, film: $m); $d has born $b; $b > 1960-01-01; fetch { ""title"": $t, ""revenue"": $r, ""year"": $y };"
636,List the top 3 movies with the highest budgets that were released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title AS movie, m.budget AS budget
ORDER BY m.budget DESC
LIMIT 3","match $m isa movie, has title $t, has budget $b, has year $y; $y >= 2000; $y < 2010; sort $b desc; limit 3; fetch { ""movie"": $t, ""budget"": $b };"
637,What are the top 5 movies with the most revenue that are in the 'Sci-Fi' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Sci-Fi'})
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; in_genre (film: $m, genre: $g); $g has name ""Sci-Fi""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
639,Which directors have directed movies with a plot mentioning 'evil'?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.plot CONTAINS 'evil'
RETURN DISTINCT d.name AS director","match $d isa person, has name $n; directed (director: $d, film: $m); $m has plot $p; $p contains ""evil""; fetch { ""director"": $n };"
640,List all actors who have acted in movies with at least two different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 2
RETURN a.name AS actor, numDirectors","match
$a isa person, has name $n;
$d isa person;
acted_in (actor: $a, film: $m);
directed (director: $d, film: $m);
select $a, $d;
distinct;
reduce $numDirectors = count($d) groupby $a;
match $numDirectors >= 2;
fetch { ""actor"": $a.name, ""numDirectors"": $numDirectors };"
641,What are the top 3 movies with a revenue of exactly 50 million dollars?,"MATCH (m:Movie)
WHERE m.revenue = 50000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie, has title $t, has revenue $r; $r == 50000000; sort $r desc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
642,Identify movies that have been rated 10 times or more with a rating above 8.,"MATCH (m:Movie)
WHERE m.imdbRating > 8
  AND exists {
    MATCH (m)<-[r:RATED]-()
    WITH m, count(r) AS numRatings
    WHERE numRatings >= 10
  }
RETURN m","match
$m isa movie, has imdb_rating $ir;
$ir > 8;
$r isa rated (film: $m);
reduce $numRatings = count($r) groupby $m, $ir;
match $numRatings >= 10;
fetch { ""movie"": $m };"
643,Which movies have actors who were born in Canada and have acted in a thriller genre?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Thriller'})
MATCH (a:Actor {bornIn: 'Canada'})-[:ACTED_IN]->(m)
RETURN m.title AS movie, collect(a.name) AS actors","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); $g has name ""Thriller""; acted_in (actor: $a, film: $m); $a has born_in ""Canada"", has name $an; fetch { ""movie"": $t, ""actor"": $an };"
644,What are the top 5 movies with the highest imdbRating?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
645,Which 3 actors have acted in the most number of movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""actor"": $n, ""movieCount"": $movieCount };"
646,List the top 5 directors by the number of movies they have directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS numberOfMovies
ORDER BY numberOfMovies DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $numberOfMovies = count($m) groupby $n; sort $numberOfMovies desc; limit 5; fetch { ""director"": $n, ""numberOfMovies"": $numberOfMovies };"
647,What are the top 3 highest-grossing movies of all time?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
648,Which 3 movies have the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
649,List the top 5 movies with the largest budgets released before 2000.,"MATCH (m:Movie)
WHERE m.year < 2000 AND m.budget IS NOT NULL
RETURN m.title, m.budget, m.year
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b, has year $y; $y < 2000; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b, ""year"": $y };"
650,Which 3 genres contain the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
652,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.name AS user, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
653,List the top 5 movies with the highest number of imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
654,Which 3 actors were born in France and acted in more than one movie?,"MATCH (a:Actor {bornIn: 'France'})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 1
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
655,What are the top 5 movies released in the 1990s by revenue?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '199' AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has revenue $r; $rel like ""^199.*""; sort $r desc; limit 5; fetch { ""movie"": $t, ""revenue"": $r };"
656,Which 3 directors have directed movies with an imdbRating greater than 8.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8.0
RETURN d.name AS director, collect(m.title) AS movies
ORDER BY size(movies) DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r, has title $t; $r > 8.0; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 3; fetch { ""director"": $n, ""numMovies"": $numMovies };"
658,Which 3 actors have acted in movies and also directed movies?,"MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) } 
  AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n; acted_in (actor: $p); directed (director: $p); limit 3; fetch { ""name"": $n };"
659,What are the top 5 oldest movies in the database by release year?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m.title, m.year
ORDER BY m.year
LIMIT 5","match $m isa movie, has title $t, has year $y; sort $y asc; limit 5; fetch { ""title"": $t, ""year"": $y };"
660,Which 3 genres are most common among movies with a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
WITH g, count(*) AS count
RETURN g.name AS genre, count
ORDER BY count DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has budget $b; $b > 100000000; reduce $count = count($m) groupby $n; sort $count desc; limit 3; fetch { ""genre"": $n, ""count"": $count };"
661,List the top 5 movies with the smallest budgets that have an imdbRating over 7.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match $m isa movie, has title $t, has budget $b, has imdb_rating $r; $r > 7.0; sort $b asc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
662,Which 3 users have rated movies released before the year 2000?,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE m.year < 2000
RETURN u.name AS user
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); $m has year $y; $y < 2000; limit 3; fetch { ""user"": $n };"
663,What are the top 5 most recent movies in the database and their genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN m.title AS movie, m.year AS year, collect(g.name) AS genres
ORDER BY m.year DESC
LIMIT 5","match $m isa movie, has title $t, has year $y; in_genre (film: $m, genre: $g); $g has name $gn; sort $y desc; limit 5; fetch { ""movie"": $t, ""year"": $y, ""genre"": $gn };"
664,Which 3 directors died after 2000 and directed more than two movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.died > date('2000-01-01')
WITH d, count(m) AS num_movies
WHERE num_movies > 2
RETURN d.name AS director, d.died AS died, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 3;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
665,List the top 5 movies with a plot containing the word 'adventure'.,"MATCH (m:Movie)
WHERE toLower(m.plot) CONTAINS 'adventure'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; $p like ""(?i).*adventure.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""plot"": $p };"
666,Which 3 actors have the highest average imdbRating for movies they acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
RETURN a.name, avgRating
ORDER BY avgRating DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_rating $r; reduce $avgRating = mean($r) groupby $n; sort $avgRating desc; limit 3; fetch { ""name"": $n, ""avgRating"": $avgRating };"
667,What are the top 5 movies with runtime less than 90 minutes and imdbRating above 8.0?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating > 8.0
RETURN m.title, m.imdbRating, m.runtime
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r, has runtime $rt; $rt < 90; $r > 8.0; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r, ""runtime"": $rt };"
668,Which 3 genres have the fewest movies associated with them in the database?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3
RETURN g.name AS genre, movieCount","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount asc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
669,List the top 5 movies that have been rated by the highest number of different users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, count(DISTINCT u) AS numRaters
ORDER BY numRaters DESC
LIMIT 5","match $m isa movie, has title $t; rated (film: $m, user: $u); reduce $numRaters = count($u) groupby $t; sort $numRaters desc; limit 5; fetch { ""movie"": $t, ""numRaters"": $numRaters };"
670,Which 3 actors have a poster listed and acted in at least two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.poster IS NOT NULL
WITH a, count(m) AS numMovies
WHERE numMovies >= 2
RETURN a.name, a.poster
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
671,What are the top 5 movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: 'USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has born_in ""USA""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
672,Which 3 movies have the most diverse set of genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(distinct g) as genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title as movie, genreCount as numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 3; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
673,List the top 5 movies that have generated revenue more than 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; $r > 500000000; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
674,Which 3 users have the highest average rating given to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated (user: $u), has rating $rating; reduce $avgRating = mean($rating) groupby $n; sort $avgRating desc; limit 3; fetch { ""user"": $n, ""avgRating"": $avgRating };"
675,What are the top 5 movies with the most actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title AS movie, numActors","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 5; fetch { ""movie"": $t, ""numActors"": $numActors };"
676,Which 3 directors have the longest total runtime for all their directed movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, sum(m.runtime) AS totalRuntime
RETURN d.name AS director, totalRuntime
ORDER BY totalRuntime DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; reduce $totalRuntime = sum($r) groupby $n; sort $totalRuntime desc; limit 3; fetch { ""director"": $n, ""totalRuntime"": $totalRuntime };"
677,List the top 5 movies that were released in languages other than English and have an imdbRating above 7.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0 AND NOT 'English' IN m.languages
RETURN m.title, m.imdbRating, m.languages
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has imdb_rating $r, has title $t, has languages $l;
$r > 7.0;
not { $l like "".*English.*""; };
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r, ""languages"": $l };"
678,Which 3 actors are born on or before 1900 and have acted in at least one movie?,"MATCH (a:Actor)
WHERE a.born <= date('1900-01-01') AND exists{ (a)-[:ACTED_IN]->(:Movie) }
RETURN a.name, a.born
LIMIT 3","match $a isa person, has name $n, has born $b; acted_in (actor: $a); $b <= 1900-01-01; limit 3; fetch { ""name"": $n, ""born"": $b };"
679,What are the top 5 movies with the most budget and were released after 2010?,"MATCH (m:Movie)
WHERE m.released >= '2010'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b, has released $r; $r >= ""2010""; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
680,Which 3 genres have movies with an average imdbRating above 7.5?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g.name AS genre, avg(m.imdbRating) AS avgRating
WHERE avgRating > 7.5
RETURN genre, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
$m has imdb_rating $r;
reduce $avgRating = mean($r) groupby $n;
sort $avgRating desc;
limit 3;
fetch { ""genre"": $n, ""avgRating"": $avgRating };"
682,Which 3 directors have directed movies in more than three different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
(film: $m, genre: $g) isa in_genre;
$g has name $gn;
reduce $num_genres = count($gn) groupby $n;
sort $num_genres desc;
limit 3;
fetch { ""director"": $n, ""num_genres"": $num_genres };"
684,Which 3 actors have the lowest average imdbRating for movies they acted in and acted in more than three movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating, count(m) AS numMovies
WHERE numMovies > 3
RETURN a.name AS actor, avgRating, numMovies
ORDER BY avgRating
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
685,List the top 5 movies with an imdbRating below 5.0 and a budget exceeding 50 million USD.,"MATCH (m:Movie)
WHERE m.imdbRating < 5.0 AND m.budget > 50000000
RETURN m.title, m.imdbRating, m.budget
ORDER BY m.imdbRating
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r, has budget $b; $r < 5.0; $b > 50000000; sort $r asc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r, ""budget"": $b };"
686,Which 3 users have rated the same movie with different ratings?,"MATCH (u1:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User), 
       (m)<-[r3:RATED]-(u3:User)
WHERE u1 <> u2 AND u1 <> u3 AND u2 <> u3
  AND r1.rating <> r2.rating
  AND r1.rating <> r3.rating
  AND r2.rating <> r3.rating
RETURN u1.name AS User1, r1.rating AS User1Rating,
       u2.name AS User2, r2.rating AS User2Rating,  
       u3.name AS User3, r3.rating AS User3Rating,
       m.title AS Movie
LIMIT 1","match $r1 isa rated (user: $u1, film: $m), has rating $rating1; $r2 isa rated (user: $u2, film: $m), has rating $rating2; $r3 isa rated (user: $u3, film: $m), has rating $rating3; not { $u1 is $u2; }; not { $u1 is $u3; }; not { $u2 is $u3; }; not { $rating1 == $rating2; }; not { $rating1 == $rating3; }; not { $rating2 == $rating3; }; $u1 has name $n1; $u2 has name $n2; $u3 has name $n3; $m has title $t; limit 1; fetch { ""User1"": $n1, ""User1Rating"": $rating1, ""User2"": $n2, ""User2Rating"": $rating2, ""User3"": $n3, ""User3Rating"": $rating3, ""Movie"": $t };"
687,What are the top 5 movies with the most genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 5; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
688,Which 3 directors have the most distinct actors worked with across all movies directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(distinct a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN d.name AS director, numActors","match $d isa person, has name $n; directed (director: $d, film: $m); acted_in (actor: $a, film: $m); reduce $numActors = count($a) groupby $n; sort $numActors desc; limit 3; fetch { ""director"": $n, ""numActors"": $numActors };"
689,List the top 5 movies where actors also served as directors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, collect(p.name) AS actor_directors
ORDER BY size(collect(p.name)) DESC
LIMIT 5","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""movie"": $t, ""actor_director"": $n };"
690,Which 3 movies have the highest revenue to budget ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, toFloat(m.revenue) / m.budget AS revenueToBudgetRatio
ORDER BY revenueToBudgetRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$bud > 0;
let $ratio = $rev / $bud;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""revenueToBudgetRatio"": $ratio };"
691,What are the top 5 movies by revenue that were released in languages other than English?,"MATCH (m:Movie)
WHERE NOT 'English' IN m.languages
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has revenue $rev, has title $t, has languages $l;
not { $l like "".*English.*""; };
sort $rev desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev };"
692,Which 3 actors have the most distinct genres of movies they've acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name AS actor, genreCount","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $n; sort $genreCount desc; limit 3; fetch { ""actor"": $n, ""genreCount"": $genreCount };"
693,List the top 5 oldest directors based on their birth year who have directed at least one movie.,"MATCH (d:Director)-[:DIRECTED]->(:Movie)
WHERE d.born IS NOT NULL
RETURN d.name AS director, d.born AS birthDate
ORDER BY d.born
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d); sort $b asc; limit 5; fetch { ""director"": $n, ""birthDate"": $b };"
694,Which 3 genres are most common in movies with a runtime over 120 minutes?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has runtime $r; $r > 120; reduce $count = count($m) groupby $n; sort $count desc; limit 3; fetch { ""genre"": $n, ""count"": $count };"
696,Which 3 actors have died and acted in more than two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.died IS NOT NULL
WITH a, count(m) AS movieCount
WHERE movieCount > 2
RETURN a.name, a.died, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$a isa person, has name $n, has died $d;
(actor: $a, film: $m) isa acted_in;
reduce $movieCount = count($m) groupby $n, $d;
sort $movieCount desc;
limit 3;
fetch { ""name"": $n, ""died"": $d, ""movieCount"": $movieCount };"
697,List the top 5 movies with the most distinct directors involved.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
RETURN m.title AS movie, count(distinct d) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 5","match $m isa movie, has title $t; directed (director: $d, film: $m); reduce $numDirectors = count($d) groupby $t; sort $numDirectors desc; limit 5; fetch { ""movie"": $t, ""numDirectors"": $numDirectors };"
698,Which 3 movies released in the last 5 years of the database have the highest imdbVotes?,"MATCH (m:Movie)
WHERE m.year >= 2012 AND m.year <= 2016 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.year, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_votes $v; $y >= 2012; $y <= 2016; sort $v desc; limit 3; fetch { ""title"": $t, ""year"": $y, ""imdb_votes"": $v };"
699,What are the top 5 movies that were directed by persons who were not primarily directors?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE NOT exists{ (p)-[:ACTED_IN]->() }
WITH m, count(*) AS directorCount
ORDER BY directorCount DESC
LIMIT 5
RETURN m.title AS movie, directorCount AS timesDirected","match $p isa person; directed (director: $p, film: $m); not { acted_in (actor: $p); }; $m has title $t; reduce $count = count($m) groupby $t; sort $count desc; limit 5; fetch { ""movie"": $t, ""timesDirected"": $count };"
700,Which 3 users have rated movies with an average rating below 3.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
WHERE avgRating < 3.0
RETURN u.name AS user, avgRating
ORDER BY avgRating
LIMIT 3","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avgRating = mean($rating) groupby $n;
sort $avgRating asc;
limit 3;
fetch { ""user"": $n, ""avgRating"": $avgRating };"
701,List the top 5 movies that have the word 'love' in their plot description.,"MATCH (m:Movie)
WHERE toLower(m.plot) CONTAINS 'love'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; $p like ""(?i).*love.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""plot"": $p };"
702,Which 3 directors have directed the most movies with a budget over 200 million USD?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 200000000
WITH d, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN d.name AS director, num_movies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has budget $b; $b > 200000000; reduce $num_movies = count($m) groupby $n; sort $num_movies desc; limit 3; fetch { ""director"": $n, ""num_movies"": $num_movies };"
704,Which 3 actors have the highest total imdbVotes for all movies they acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, sum(m.imdbVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3
RETURN a.name AS actor, totalVotes","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_votes $v; reduce $totalVotes = sum($v) groupby $n; sort $totalVotes desc; limit 3; fetch { ""actor"": $n, ""totalVotes"": $totalVotes };"
705,List the top 5 shortest movies with an imdbRating above 6.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 6.0
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match $m isa movie, has title $t, has runtime $r, has imdb_rating $ir; $ir > 6.0; sort $r asc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
706,Which 3 users have rated the most movies with an imdbRating below 5.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.imdbRating < 5.0
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); $m has imdb_rating $r; $r < 5.0; reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
707,Which top 5 movies have a runtime longer than 150 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match $m isa movie, has title $t, has runtime $r; $r > 150; sort $r desc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
708,List the top 3 directors born in the USA.,"MATCH (d:Director {bornIn: 'USA'})
RETURN d.name AS director, d.born AS birthDate
ORDER BY d.born DESC
LIMIT 3","match $d isa person, has name $n, has born $b, has born_in ""USA""; directed (director: $d); sort $b desc; limit 3; fetch { ""director"": $n, ""birthDate"": $b };"
709,What are the first 3 movies released after 2010 with a budget over 100 million USD?,"MATCH (m:Movie)
WHERE m.released > '2010' AND m.budget > 100000000
RETURN m.title, m.released, m.budget
ORDER BY m.released
LIMIT 3","match $m isa movie, has title $t, has released $r, has budget $b; $r > ""2010""; $b > 100000000; sort $r asc; limit 3; fetch { ""title"": $t, ""released"": $r, ""budget"": $b };"
710,Name the top 5 highest-grossing movies.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
711,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
712,List the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
713,What are the top 3 genres by the number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
714,"Which top 5 movies have been rated by more than 500,000 users?","MATCH (m:Movie)
WHERE m.imdbVotes > 500000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; $v > 500000; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
715,List the first 3 movies directed by a director born in France.,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match $d isa person, has born_in ""France""; directed (director: $d, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
716,What are the top 5 movies with an IMDb rating above 8?,"MATCH (m:Movie)
WHERE m.imdbRating > 8
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; $r > 8; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
717,Which 3 actors have played in both comedy and drama genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama']
WITH a, collect(distinct g.name) AS genres
WHERE all(x IN ['Comedy', 'Drama'] WHERE x IN genres)
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m1); in_genre (film: $m1, genre: $g1); $g1 has name ""Comedy""; acted_in (actor: $a, film: $m2); in_genre (film: $m2, genre: $g2); $g2 has name ""Drama""; limit 3; fetch { ""name"": $n };"
718,List the first 3 movies that have both English and French languages.,"MATCH (m:Movie)
WHERE 'en' IN m.languages AND 'fr' IN m.languages
RETURN m.title
LIMIT 3","match
$m isa movie, has languages $l, has title $t;
$l like "".*en.*"";
$l like "".*fr.*"";
limit 3;
fetch { ""title"": $t };"
719,Which top 5 directors have the highest number of directed movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS numDirected
ORDER BY numDirected DESC
LIMIT 5
RETURN d.name AS director, numDirected AS numberOfMovies","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $numDirected = count($m) groupby $n; sort $numDirected desc; limit 5; fetch { ""director"": $n, ""numberOfMovies"": $numDirected };"
720,What are the first 3 movies with a revenue to budget ratio greater than 5?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.revenue / m.budget > 5
RETURN m.title, m.revenue, m.budget, m.revenue / m.budget AS ratio
ORDER BY ratio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$bud > 0;
let $ratio = $rev / $bud;
$ratio > 5.0;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud, ""ratio"": $ratio };"
721,List the top 5 movies that were released in the '90s.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '199'
RETURN m.title, m.released, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has imdb_rating $r; $rel like ""^199.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""released"": $rel, ""imdb_rating"": $r };"
722,Which 3 actors were born after 1980 and have acted in more than 5 movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born > date('1980-01-01')
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name, a.born, numMovies
ORDER BY numMovies DESC
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
723,List the first 3 users who have an average rating less than 3.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
WHERE avgRating < 3
RETURN u.name AS user, avgRating
ORDER BY avgRating
LIMIT 3","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avgRating = mean($rating) groupby $n;
sort $avgRating asc;
limit 3;
fetch { ""user"": $n, ""avgRating"": $avgRating };"
724,What are the top 5 genres in which movies have the highest average IMDb rating?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g.name AS genre, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN genre, avgRating","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has imdb_rating $r; reduce $avgRating = mean($r) groupby $n; sort $avgRating desc; limit 5; fetch { ""genre"": $n, ""avgRating"": $avgRating };"
726,List the first 3 directors who have also acted in a movie.,"MATCH (p:Person)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) } 
  AND exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n; directed (director: $p); acted_in (actor: $p); limit 3; fetch { ""name"": $n };"
727,What are the top 5 movies with IMDb votes greater than 100000?,"MATCH (m:Movie)
WHERE m.imdbVotes > 100000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; $v > 100000; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
728,Which 3 users have the highest average movie rating with at least 20 rated movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 20
RETURN u.name AS user, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $n;
sort $numRatings desc;
limit 3;
fetch { ""name"": $n, ""numRatings"": $numRatings };"
729,What are the top 5 longest movies that have been released after 2000?,"MATCH (m:Movie)
WHERE m.released >= '2000-01-01' AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has runtime $r; $rel >= ""2000-01-01""; sort $r desc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
730,Which 3 directors have directed movies in more than three genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
(film: $m, genre: $g) isa in_genre;
$g has name $gn;
reduce $num_genres = count($gn) groupby $n;
sort $num_genres desc;
limit 3;
fetch { ""director"": $n, ""num_genres"": $num_genres };"
731,List the first 3 actors who have acted in movies with a revenue of over 500 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has revenue $r; $r > 500000000; limit 3; fetch { ""name"": $n };"
732,What are the top 5 movies that have been directed by directors born in Nebraska?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'Nebraska, USA'})
RETURN m.title AS movie, m.year AS year, m.imdbRating AS rating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has born_in ""Nebraska, USA""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""movie"": $t, ""year"": $y, ""rating"": $r };"
733,Which 3 movies have the highest number of actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 3","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 3; fetch { ""movie"": $t, ""numActors"": $numActors };"
734,List the first 3 genres that have more than 50 movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
WHERE movieCount > 50
RETURN g.name AS genre, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
reduce $movieCount = count($m) groupby $n;
sort $movieCount desc;
limit 3;
fetch { ""genre"": $n, ""movieCount"": $movieCount };"
735,What are the top 5 movies with the lowest IMDb rating but highest revenue?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.imdbRating, m.revenue
ORDER BY m.imdbRating ASC, m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $ir, has revenue $r; sort $ir asc, $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $ir, ""revenue"": $r };"
739,Which 3 directors have the most movies with a runtime over 180 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 180
WITH d, count(m) AS numLongMovies
ORDER BY numLongMovies DESC
LIMIT 3
RETURN d.name AS director, numLongMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r > 180; reduce $numLongMovies = count($m) groupby $n; sort $numLongMovies desc; limit 3; fetch { ""director"": $n, ""numLongMovies"": $numLongMovies };"
741,What are the top 5 movies with a budget less than 10 million USD but revenue over 100 million USD?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b, has revenue $r; $b < 10000000; $r > 100000000; sort $r desc; limit 5; fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
742,List the first 3 movies with plots containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m.title, m.plot
LIMIT 3","match $m isa movie, has title $t, has plot $p; $p contains ""adventure""; limit 3; fetch { ""title"": $t, ""plot"": $p };"
743,What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.year
ORDER BY m.year
LIMIT 5","match $m isa movie, has title $t, has year $y; sort $y asc; limit 5; fetch { ""title"": $t, ""year"": $y };"
744,Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
745,List the first 3 directors who have directed both a comedy and a drama.,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Comedy'}),
      (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Drama'})
RETURN d.name AS director
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m1); in_genre (film: $m1, genre: $g1); $g1 has name ""Comedy""; directed (director: $d, film: $m2); in_genre (film: $m2, genre: $g2); $g2 has name ""Drama""; limit 3; fetch { ""director"": $n };"
746,What are the top 5 movies with the most number of genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 5; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
747,List the first 3 actors who have acted in a movie without a poster link.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.poster IS NULL
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); not { $m has poster $p; }; limit 3; fetch { ""name"": $n };"
749,List the first 3 movies that have been directed by actors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match $p isa person; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
750,What are the top 5 directors who have directed the most movies with a runtime under 90 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime < 90
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r < 90; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""director"": $n, ""numMovies"": $numMovies };"
752,List the first 3 genres with movies having an average IMDb rating under 5.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH g, avg(m.imdbRating) AS avgRating
WHERE avgRating < 5
RETURN g.name AS genre, avgRating
ORDER BY avgRating
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
$m has imdb_rating $r;
reduce $avgRating = mean($r) groupby $n;
sort $avgRating asc;
limit 3;
fetch { ""genre"": $n, ""avgRating"": $avgRating };"
23,What are the first 5 genres associated with movies having the most languages available?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, max(size(m.languages)) AS maxLanguages
ORDER BY maxLanguages DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
reduce $max_langs = max($lang_count) groupby $g;
sort $max_langs desc;
limit 5;
fetch { ""genre"": $g.name, ""maxLanguages"": $max_langs };"
33,Show the top 5 movies with the most languages spoken.,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie, has languages $lang;
let $lang_count = language_count($m);
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
96,Which 5 movies have the most diverse language offerings?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
166,What are the top 5 movies that have the most languages spoken in them?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
219,List the 5 movies with the most languages spoken.,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
245,Which 5 movies have been released in the most number of countries?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
270,Which 5 movies have the most distinct countries of release listed?,"MATCH (m:Movie)
RETURN m.title, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
276,What are the top 3 movies based on the number of different languages they have been released in?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
288,What are the first 3 movies that have been released in exactly three different countries?,"MATCH (m:Movie)
WHERE size(m.countries) = 3
RETURN m.title, m.released, m.countries
ORDER BY m.released
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie, has released $rel;
let $ctry_count = country_count($m);
$ctry_count == 3;
sort $rel;
limit 3;
fetch { ""title"": $m.title, ""released"": $rel };"
299,List the first 5 movies with at least three different languages listed.,"MATCH (m:Movie)
WHERE size(m.languages) >= 3
RETURN m.title, m.languages
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count >= 3;
limit 5;
fetch { ""title"": $m.title };"
322,Which 3 movies have the highest number of languages spoken?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
327,What are the top 5 movies with the most distinct countries of origin?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
361,Which three movies have the most diverse set of spoken languages?,"MATCH (m:Movie)
RETURN m.title, m.languages, size(m.languages) AS numLanguages
ORDER BY numLanguages DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
377,Which three movies have the most different countries listed?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
383,List the top 3 movies that have multiple languages but a single country of origin.,"MATCH (m:Movie)
WHERE size(m.languages) > 1 AND size(m.countries) = 1
RETURN m.title, m.languages, m.countries
ORDER BY m.imdbRating DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie, has imdb_rating $r;
let $lang_count = language_count($m);
let $ctry_count = country_count($m);
$lang_count > 1;
$ctry_count == 1;
sort $r desc;
limit 3;
fetch { ""title"": $m.title };"
406,List the first 3 movies that were shot in more than five different locations.,"MATCH (m:Movie)
WHERE size(m.countries) > 5
RETURN m.title, m.countries
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 5;
limit 3;
fetch { ""title"": $m.title };"
450,What are the top 3 movies with the most diverse set of spoken languages?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
467,List the movies that have been released in more than 5 countries.,"MATCH (m:Movie)
WHERE size(m.countries) > 5
RETURN m.title, m.countries","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 5;
fetch { ""title"": $m.title };"
473,What are the top 5 movies by number of languages spoken in them?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
477,What are the top 3 movies with the most countries listed in their release?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries
ORDER BY size(m.countries) DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
504,What are the top 3 movies with the highest number of countries involved in their production?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
524,What are the top 5 movies with the most languages spoken?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
536,What are the top 5 movies with the highest number of countries involved?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
558,List the first 3 movies with exactly three languages spoken.,"MATCH (m:Movie)
WHERE size(m.languages) = 3
RETURN m.title
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count == 3;
limit 3;
fetch { ""title"": $m.title };"
572,Which 5 movies had their entire plot translated into more than one language?,"MATCH (m:Movie)
WHERE size(m.languages) > 1
RETURN m.title, m.languages
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 1;
limit 5;
fetch { ""title"": $m.title };"
584,What are the first 3 movies with the highest number of languages available?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title };"
612,List the movies that have been released in at least three different languages.,"MATCH (m:Movie)
WHERE size(m.languages) >= 3
RETURN m.title, m.languages","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count >= 3;
fetch { ""title"": $m.title };"
638,Identify movies that have languages lists containing more than 5 languages.,"MATCH (m:Movie)
WHERE size(m.languages) > 5
RETURN m.title, m.languages","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 5;
fetch { ""title"": $m.title };"
651,What are the top 5 movies with the most languages available?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
657,List the top 5 movies with the most countries available in their languages list.,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
683,What are the top 5 movies with the highest number of countries represented in their languages list?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
695,What are the top 5 movies with a single-country language setting and the highest imdbRating?,"MATCH (m:Movie)
WHERE size(m.languages) = 1 AND exists {(m)-[:IN_GENRE]->(:Genre)}
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie, has imdb_rating $r;
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
$lang_count == 1;
sort $r desc;
limit 5;
fetch { ""title"": $m.title, ""imdbRating"": $r };"
703,What are the top 5 movies with the most languages and at least one genre being 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Action'
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
$g isa genre, has name ""Action"";
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title };"
725,Which top 5 movies have the most diverse range of spoken languages?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
740,List the first 3 movies with the most diverse country production origins.,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
63,What are the three most common languages spoken in movies directed by Anthony Stacchi?,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)
WITH m.languages AS languages
UNWIND languages AS language
RETURN language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$d isa person, has name ""Anthony Stacchi"";
directed (director: $d, film: $m);
$m has languages $l;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l, ""count"": $count };"
69,What are the top 3 countries producing movies with a revenue over 500 million dollars?,"MATCH (m:Movie)
WHERE m.revenue > 500000000
WITH m.countries AS countries
UNWIND countries AS country
RETURN country, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has revenue $r, has countries $c;
$r > 500000000;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c, ""count"": $count };"
97,What are the 3 most common countries for movie settings in the database?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
UNWIND m.countries AS country
RETURN country, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has countries $c;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c, ""count"": $count };"
112,Which actors have featured in movies released in multiple languages?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE size(m.languages) > 1
RETURN a.name AS actor, collect(DISTINCT m.title) AS movies","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$p isa person;
$m isa movie;
acted_in (actor: $p, film: $m);
let $lang_count = language_count($m);
$lang_count > 1;
select $p;
distinct;
fetch { ""actor"": $p.name };"
123,Which actors have acted in movies from at least three different countries?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, size(collect(distinct m.countries)) AS numCountries
WHERE numCountries >= 3
RETURN a.name AS actor, numCountries","match
$p isa person;
$m isa movie, has countries $c;
acted_in (actor: $p, film: $m);
select $p, $c;
distinct;
reduce $num_countries = count($c) groupby $p;
match
$num_countries >= 3;
fetch { ""actor"": $p.name, ""numCountries"": $num_countries };"
138,Which directors have directed movies in more than two languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE size(m.languages) > 2
RETURN d.name AS director, collect(DISTINCT m.title) AS movies, collect(DISTINCT m.languages) AS languages","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$p isa person;
$m isa movie;
directed (director: $p, film: $m);
let $lang_count = language_count($m);
$lang_count > 2;
select $p;
distinct;
fetch { ""director"": $p.name };"
150,"Find all movies that have been rated after January 1st, 2015.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= datetime('2015-01-01').epochSeconds
RETURN m, r, u","match
$m isa movie;
$u isa user;
$r isa rated (user: $u, film: $m), has timestamp $t;
$t >= 1420070400;
fetch { ""title"": $m.title, ""user"": $u.name };"
156,What are the top 5 oldest actors who have acted in English language movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born IS NOT NULL AND 'English' IN m.languages
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match
$p isa person, has born $b;
$m isa movie, has languages ""English"";
acted_in (actor: $p, film: $m);
select $p, $b;
distinct;
sort $b;
limit 5;
fetch { ""name"": $p.name, ""born"": $b };"
175,Which directors have directed movies in more than three different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.languages IS NOT NULL
WITH d, size(collect(DISTINCT m.languages)) AS num_languages 
WHERE num_languages > 3
RETURN d.name AS director, num_languages","match
$p isa person;
$m isa movie, has languages $l;
directed (director: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 3;
fetch { ""director"": $p.name, ""num_languages"": $num_languages };"
188,Which directors have directed movies in both the 'Horror' and 'Romance' genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Horror', 'Romance']
WITH d, collect(distinct g.name) AS genres
WHERE size(genres) = 2
RETURN d.name AS director","match
$d isa person;
$m1 isa movie;
directed (director: $d, film: $m1);
$g1 isa genre, has name ""Horror"";
in_genre (film: $m1, genre: $g1);
$m2 isa movie;
directed (director: $d, film: $m2);
$g2 isa genre, has name ""Romance"";
in_genre (film: $m2, genre: $g2);
select $d;
distinct;
fetch { ""director"": $d.name };"
198,What are the top 5 countries where the most movies originate from based on the 'countries' property of movies?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
UNWIND m.countries AS country
RETURN country, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$m isa movie, has countries $c;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c, ""numMovies"": $count };"
200,What are the top 5 languages in which movies are made based on the 'languages' property of movies?,"MATCH (m:Movie)
UNWIND m.languages AS language
RETURN language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$m isa movie, has languages $l;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 5;
fetch { ""language"": $l, ""count"": $count };"
253,List the top 5 genres of movies with the most language diversity.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, m.languages AS languages
WITH g, size(languages) AS languageCount
RETURN g.name AS genre, avg(languageCount) AS avgLanguages
ORDER BY avgLanguages DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
reduce $avg_langs = mean($lang_count) groupby $g;
sort $avg_langs desc;
limit 5;
fetch { ""genre"": $g.name, ""avgLanguages"": $avg_langs };"
285,Which 5 directors have directed movies in more than three different countries?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, size(collect(distinct m.countries)) AS numCountries
WHERE numCountries > 3
RETURN d.name AS director, numCountries
ORDER BY numCountries DESC
LIMIT 5","match
$p isa person;
$m isa movie, has countries $c;
directed (director: $p, film: $m);
select $p, $c;
distinct;
reduce $num_countries = count($c) groupby $p;
match
$num_countries > 3;
sort $num_countries desc;
limit 5;
fetch { ""director"": $p.name, ""numCountries"": $num_countries };"
355,Which three actors have acted in movies in more than 3 different languages?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, size(collect(distinct m.languages)) AS num_languages
WHERE num_languages > 3
RETURN a.name, num_languages
ORDER BY num_languages DESC
LIMIT 3","match
$p isa person;
$m isa movie, has languages $l;
acted_in (actor: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 3;
sort $num_languages desc;
limit 3;
fetch { ""name"": $p.name, ""num_languages"": $num_languages };"
388,Which three directors have directed movies in more than one language?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE size(m.languages) > 1
WITH d, count(DISTINCT m) AS num_multilingual_movies
WHERE num_multilingual_movies > 1
RETURN d.name AS director, num_multilingual_movies
ORDER BY num_multilingual_movies DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$p isa person;
$m isa movie;
directed (director: $p, film: $m);
let $lang_count = language_count($m);
$lang_count > 1;
reduce $num_multilingual = count($m) groupby $p;
match
$num_multilingual > 1;
sort $num_multilingual desc;
limit 3;
fetch { ""director"": $p.name, ""num_multilingual_movies"": $num_multilingual };"
392,List the top 3 directors based on the number of different countries their movies have been released in.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, size(collect(distinct m.countries)) AS numCountries
ORDER BY numCountries DESC
LIMIT 3
RETURN d.name AS director, numCountries AS numberOfCountries","match
$p isa person;
$m isa movie, has countries $c;
directed (director: $p, film: $m);
select $p, $c;
distinct;
reduce $num_countries = count($c) groupby $p;
sort $num_countries desc;
limit 3;
fetch { ""director"": $p.name, ""numberOfCountries"": $num_countries };"
465,Find all movies that have been rated exactly 5 times.,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m","match
$m isa movie;
$r isa rated (film: $m);
reduce $rating_count = count($r) groupby $m;
match
$rating_count == 5;
fetch { ""title"": $m.title };"
498,Find all movies where the director has directed more than 5 movies.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS num_directed
WHERE num_directed > 5
MATCH (d)-[:DIRECTED]->(movie:Movie)
RETURN d.name AS director, collect(movie.title) AS movies","match
$d isa person;
$m isa movie;
directed (director: $d, film: $m);
reduce $num_directed = count($m) groupby $d;
match
$num_directed > 5;
fetch { ""director"": $d.name };"
548,List the first 3 movies that have been directed by more than one director.,"MATCH (m:Movie)
WHERE exists{ (m)<-[:DIRECTED]-(:Director) }
WITH m
MATCH (m)<-[:DIRECTED]-(d:Director)
WITH m, count(d) AS directorCount
WHERE directorCount > 1
RETURN m.title AS movie
LIMIT 3","match
$m isa movie;
$d isa person;
directed (director: $d, film: $m);
reduce $dir_count = count($d) groupby $m;
match
$dir_count > 1;
limit 3;
fetch { ""movie"": $m.title };"
561,Which 5 directors have directed movies in more than 5 different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, size(collect(distinct m.languages)) AS num_languages
WHERE num_languages > 5
RETURN d.name, num_languages
ORDER BY num_languages DESC
LIMIT 5","match
$p isa person;
$m isa movie, has languages $l;
directed (director: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 5;
sort $num_languages desc;
limit 5;
fetch { ""name"": $p.name, ""num_languages"": $num_languages };"
604,Which movies have actors who were born in the USA and have acted in a comedy genre?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
MATCH (a:Actor {bornIn: 'USA'})-[:ACTED_IN]->(m)
RETURN m.title AS movie, collect(a.name) AS actors","match
$p isa person, has born_in ""USA"";
$m isa movie;
acted_in (actor: $p, film: $m);
$g isa genre, has name ""Comedy"";
in_genre (film: $m, genre: $g);
select $m;
distinct;
fetch { ""movie"": $m.title };"
631,Which directors have directed movies in more than three different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.languages IS NOT NULL
WITH d, size(collect(DISTINCT m.languages)) AS num_languages 
WHERE num_languages > 3
RETURN d.name AS director, num_languages","match
$p isa person;
$m isa movie, has languages $l;
directed (director: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 3;
fetch { ""director"": $p.name, ""num_languages"": $num_languages };"
590,List the first 3 movies with the most different directors involved.,"MATCH (m:Movie)
WITH m, size([(m)<-[:DIRECTED]-(d) | d]) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 3
RETURN m.title AS movie, numDirectors","match
$m isa movie;
$d isa person;
directed (director: $d, film: $m);
reduce $num_directors = count($d) groupby $m;
sort $num_directors desc;
limit 3;
fetch { ""movie"": $m.title, ""numDirectors"": $num_directors };"
396,What are the first 3 movies with a majority of non-English languages?,"MATCH (m:Movie)
WHERE size([l IN m.languages WHERE l <> 'English']) > size(m.languages) / 2
RETURN m.title
LIMIT 3","with fun non_english_count($m: movie) -> integer:
  match $m has languages $l; $l != ""English"";
  return count;

with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $ne = non_english_count($m);
let $total = language_count($m);
$total > 0;
let $half = $total / 2;
$ne > $half;
limit 3;
fetch { ""title"": $m.title };"
46,Identify the first 3 movies that have been rated by users younger than 25.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE u.age < 25
RETURN m.title
LIMIT 3","match
$u isa user, has age $a;
$a < 25;
$r isa rated (user: $u, film: $m);
limit 3;
fetch { ""title"": $m.title };"
184,What are the top 5 directors who have directed movies that won an academy award?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.plot CONTAINS 'Academy Award'
WITH d, count(m) AS awardCount
ORDER BY awardCount DESC
LIMIT 5
RETURN d.name AS director, awardCount","match
$p isa person;
directed (director: $p, film: $m);
won (film: $m, award: $aw);
$aw has name $an;
$an like "".*Academy Award.*"";
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch { ""director"": $p.name, ""awards"": $count };"
255,List the first 5 movies that have been directed by women.,"MATCH (director:Person)-[:DIRECTED]->(movie:Movie)
WHERE director.name =~ ""(?i).*\\b(Ms\\.|Miss|Mrs\\.|Madam|Madame|Mademoiselle|Frau|Fräulein|Señora|Señorita|Doña|Donna)\\b.*""
RETURN movie.title
LIMIT 5","match
$p isa person, has name $n;
$n like "".*(Ms\\.|Miss |Mrs\\.|Madam |Madame |Mademoiselle |Frau |Señora |Señorita |Doña |Donna ).*"";
directed (director: $p, film: $m);
limit 5;
fetch { ""title"": $m.title };"
273,List the first 5 actors who were born and died in the same country.,"MATCH (a:Actor)
WHERE a.bornIn IS NOT NULL AND a.bornIn = a.diedIn
RETURN a.name AS actor, a.bornIn AS country
LIMIT 5","match
$p isa person, has born_in $bi, has died_in $di;
$bi == $di;
limit 5;
fetch { ""actor"": $p.name, ""country"": $bi };"
391,Which three movies have been rated by the youngest users on average?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(u.age) AS avgAge, count(r) AS numRatings
WHERE numRatings > 10
RETURN m.title, avgAge
ORDER BY avgAge
LIMIT 3","match
$m isa movie;
$u isa user, has age $a;
$r isa rated (user: $u, film: $m);
reduce $count = count($r), $avg_age = mean($a) groupby $m;
match $count > 10;
sort $avg_age asc;
limit 3;
fetch { ""title"": $m.title, ""avg_age"": $avg_age };"
400,Which three directors have directed movies that have won any cinematic awards?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN d.name AS director
LIMIT 3","match
$p isa person;
directed (director: $p, film: $m);
won (film: $m, award: $aw);
select $p;
distinct;
limit 3;
fetch { ""director"": $p.name };"
401,Which three directors have directed movies that have won any cinematic awards?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN d.name AS director
LIMIT 3","match
$p isa person;
directed (director: $p, film: $m);
won (film: $m, award: $aw);
select $p;
distinct;
limit 3;
fetch { ""director"": $p.name };"
423,What are the first 3 movies with a main actor over the age of 50 at the time of filming?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE date(m.released) - a.born > duration('P50Y')
RETURN m.title, a.name, duration.between(a.born, date(m.released)).years as age
ORDER BY m.released
LIMIT 3","match
$m isa movie, has year $y;
$p isa person, has born $b;
acted_in (actor: $p, film: $m);
let $threshold = $y - 50;
$b < $threshold;
limit 3;
fetch { ""title"": $m.title, ""actor"": $p.name };"
42,Show the top 5 highest IMDb rated movies directed by female directors.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WHERE d.name =~ ""(?i).*\\b(Ms\\.|Miss|Mrs\\.|Frau|Fräulein|Mademoiselle|Madame|Mlle\\.|Mme\\.|Señora|Señorita|Doña).*""
   OR exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS movie, m.imdbRating AS rating
ORDER BY m.imdbRating DESC
LIMIT 5","match
$p isa person, has name $n;
$n like "".*(Ms\\.|Miss |Mrs\\.|Madam |Madame |Mademoiselle |Frau |Señora |Señorita |Doña |Donna ).*"";
directed (director: $p, film: $m);
$m has imdb_rating $r;
sort $r desc;
limit 5;
fetch { ""movie"": $m.title, ""rating"": $r };"
488,List all movies that have won an award and have been directed by a director born in the UK.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'UK'})
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN m.title, d.name","match
$p isa person, has born_in ""UK"";
directed (director: $p, film: $m);
won (film: $m, award: $aw);
fetch { ""title"": $m.title, ""director"": $p.name };"
489,List all movies that have won an award and have been directed by a director born in the UK.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'UK'})
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN m.title, d.name","match
$p isa person, has born_in ""UK"";
directed (director: $p, film: $m);
won (film: $m, award: $aw);
fetch { ""title"": $m.title, ""director"": $p.name };"
22,Show the top 3 movies that have been rated by the oldest users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, u, r
ORDER BY u.born ASC
LIMIT 3
RETURN m.title AS movie, u.name AS user, r.rating AS rating","match
$u isa user, has age $a;
$r isa rated (user: $u, film: $m);
$r has rating $rt;
sort $a desc;
limit 3;
fetch { ""movie"": $m.title, ""user"": $u.name, ""rating"": $rt };"
242,Show the first 3 movies that have been rated by the youngest users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, u, r
ORDER BY u.born DESC, r.timestamp
RETURN m.title AS movie, u.name AS user
LIMIT 3","match
$u isa user, has age $a;
$r isa rated (user: $u, film: $m);
sort $a asc;
limit 3;
fetch { ""movie"": $m.title, ""user"": $u.name };"
736,Which 3 actors have acted in both a highest and lowest grossing movie?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, m
ORDER BY m.revenue DESC
WITH a, collect(m)[0] AS highestGrossingMovie, collect(m)[-1] AS lowestGrossingMovie
WHERE exists{ (a)-[:ACTED_IN]->(highestGrossingMovie) } 
  AND exists{ (a)-[:ACTED_IN]->(lowestGrossingMovie) }
RETURN a.name AS actor, highestGrossingMovie.title AS highestGrossingMovie, lowestGrossingMovie.title AS lowestGrossingMovie
LIMIT 3","with fun max_revenue() -> integer:
  match $m isa movie, has revenue $r;
  return max($r);

with fun min_revenue() -> integer:
  match $m isa movie, has revenue $r;
  $r > 0;
  return min($r);

match
$p isa person;
$m1 isa movie, has revenue $r1;
$m2 isa movie, has revenue $r2;
let $max = max_revenue();
let $min = min_revenue();
$r1 == $max;
$r2 == $min;
acted_in (actor: $p, film: $m1);
acted_in (actor: $p, film: $m2);
limit 3;
fetch { ""actor"": $p.name, ""highest"": $m1.title, ""lowest"": $m2.title };"
