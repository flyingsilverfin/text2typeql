original_index,question,cypher,typeql
0,Which users follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS follower","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""follower"": $u.screen_name };"
1,List all tweets tagged with the hashtag 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t","match
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
2,Find all users who have more than 30000 followers.,"MATCH (u:User)
WHERE u.followers > 30000
RETURN u","match
$u isa user, has followers $f;
$f > 30000;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""followers"": $f };"
3,What are the profile image URLs of users located in 'Graphs Are Everywhere'?,"MATCH (u:User)
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.profile_image_url","match
$u isa user, has location ""Graphs Are Everywhere"";
fetch { ""profile_image_url"": $u.profile_image_url };"
4,Retrieve the top 5 most recent tweets.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5","match
$t isa tweet, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
5,Which users are mentioned in the tweet with ID 1371846247913512966?,"MATCH (t:Tweet {id: 1371846247913512966})-[:MENTIONS]->(u:User)
RETURN u.name AS user","match
$t isa tweet, has tweet_id 1371846247913512966;
$u isa user;
mentions (source_tweet: $t, mentioned_user: $u);
fetch { ""user"": $u.name };"
6,List all users who follow 'Neo4j' and have a betweenness greater than 1000000.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.betweenness > 1000000
RETURN u","match
$u isa user, has betweenness $b;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
$b > 1000000;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""betweenness"": $b };"
7,What are the URLs of the links contained in tweets from 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""url"": $l.link_url };"
8,Show the top 3 users with the highest number of statuses.,"MATCH (u:User)
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
$u isa user, has statuses $s;
sort $s desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""statuses"": $s };"
9,Find all tweets that retweet the tweet with ID 690028662083612672.,"MATCH (t:Tweet)-[:RETWEETS]->(retweeted:Tweet {id: 690028662083612672})
RETURN t","match
$t isa tweet;
$retweeted isa tweet, has tweet_id 690028662083612672;
retweets (retweeting_tweet: $t, original_tweet: $retweeted);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
10,Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
$sc > 0.5;
fetch { ""screen_name"": $u.screen_name, ""score"": $sc };"
11,List the names of users who have interacted with 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'})<-[:INTERACTS_WITH]-(u:User)
RETURN u.name","match
$me isa me, has name ""Neo4j"";
$u isa user;
interacts_with (interactor: $u, target: $me);
fetch { ""name"": $u.name };"
12,How many users does 'Neo4j' follow?,"MATCH (me:Me {name: 'Neo4j'})
RETURN me.following AS following","match
$me isa me, has name ""Neo4j"";
fetch { ""following"": $me.following };"
13,Display tweets that use the source named 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t","match
$t isa tweet;
$s isa source, has source_name ""Buffer"";
using (tweet_content: $t, platform: $s);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
14,Find all tweets posted by 'Neo4j' between January and February 2021.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= date('2021-01-01') AND t.created_at < date('2021-03-01') 
RETURN t","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
$ca >= 2021-01-01T00:00:00;
$ca < 2021-03-01T00:00:00;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
15,What are the names of all hashtags used in tweets from 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN DISTINCT h.name","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$h isa hashtag;
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
fetch { ""name"": $h.hashtag_name };"
16,List all tweets that reply to the tweet with ID 1371815021265747970.,"MATCH (repliedTweet:Tweet)-[:REPLY_TO]->(originalTweet:Tweet {id: 1371815021265747970})
RETURN repliedTweet","match
$replying isa tweet;
$original isa tweet, has tweet_id 1371815021265747970;
reply_to (replying_tweet: $replying, original_tweet: $original);
fetch { ""text"": $replying.text, ""tweet_id"": $replying.tweet_id, ""created_at"": $replying.created_at };"
17,Which users are amplified by 'Me'?,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)
RETURN user.name AS user, user.screen_name AS handle","match
$me isa me;
$user isa user;
amplifies (amplifier: $me, amplified_user: $user);
fetch { ""user"": $user.name, ""handle"": $user.screen_name };"
18,Retrieve the top 5 tweets with the most favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 5;
fetch { ""text"": $t.text, ""favorites"": $f };"
19,Show all users followed by 'Me' with more than 10000 followers.,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
WHERE u.followers > 10000
RETURN u.name, u.screen_name, u.followers","match
$me isa me;
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
$f > 10000;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""followers"": $f };"
20,How many followers does the user with screen name 'neo4j' have?,"MATCH (u:User {screen_name: 'neo4j'})
RETURN u.followers AS followers","match
$u isa user, has screen_name ""neo4j"";
fetch { ""followers"": $u.followers };"
21,What is the location of the user with the highest betweenness value?,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.location
ORDER BY u.betweenness DESC
LIMIT 1","match
$u isa user, has betweenness $b;
sort $b desc;
limit 1;
fetch { ""location"": $u.location };"
22,List the screen names of users who follow at least 100 other users.,"MATCH (u:User)
WHERE u.following >= 100
RETURN u.screen_name","match
$u isa user, has following $f;
$f >= 100;
fetch { ""screen_name"": $u.screen_name };"
23,Which users have posted tweets containing the link 'https://twitter.com/i/web/status/13718150212657479'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link {url: 'https://twitter.com/i/web/status/13718150212657479'})
RETURN u.name, u.screen_name","match
$u isa user;
$t isa tweet;
$l isa link, has link_url ""https://twitter.com/i/web/status/13718150212657479"";
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name };"
24,Retrieve the top 3 users sorted by their following count in descending order.,"MATCH (u:User)
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
$u isa user, has following $f;
sort $f desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""following"": $f };"
25,Identify the users who are mentioned and retweeted in the same tweet.,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)-[:MENTIONS]->(u)
RETURN u.name AS user, t.text AS tweet_text, retweeted_tweet.text AS retweeted_tweet_text","match
$u isa user;
$t isa tweet;
$retweeted isa tweet;
mentions (source_tweet: $t, mentioned_user: $u);
retweets (retweeting_tweet: $t, original_tweet: $retweeted);
mentions (source_tweet: $retweeted, mentioned_user: $u);
fetch { ""user"": $u.name, ""tweet_text"": $t.text, ""retweeted_tweet_text"": $retweeted.text };"
26,Find tweets that mention 'Neo4j' and are tagged with 'education'.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE t.text CONTAINS 'Neo4j'
RETURN t","match
$t isa tweet, has text $txt;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
fetch { ""text"": $txt, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
27,Show the sources used by tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'}), 
      (t)-[:USING]->(s:Source)
RETURN DISTINCT s.name AS source","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
$s isa source;
mentions (source_tweet: $t, mentioned_user: $u);
using (tweet_content: $t, platform: $s);
fetch { ""source"": $s.source_name };"
28,What is the text of the most favorited tweet?,"MATCH (t:Tweet)
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 1","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 1;
fetch { ""tweet_text"": $t.text };"
29,List all users retweeted by 'Me'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN DISTINCT retweetedUser","match
$me isa me;
$tweet isa tweet;
$retweetedTweet isa tweet;
$retweetedUser isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
posts (author: $retweetedUser, content: $retweetedTweet);
fetch { ""screen_name"": $retweetedUser.screen_name, ""name"": $retweetedUser.name };"
30,List the top 5 users by number of followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
$u isa user, has followers $f;
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
31,Which users have more than 10000 followers and less than 15000 statuses?,"MATCH (u:User)
WHERE u.followers > 10000 AND u.statuses < 15000
RETURN u.screen_name AS username, u.followers AS followerCount, u.statuses AS statusesCount","match
$u isa user, has followers $f, has statuses $s;
$f > 10000;
$s < 15000;
fetch { ""username"": $u.screen_name, ""followerCount"": $f, ""statusesCount"": $s };"
32,Find the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""favorites"": $f };"
33,Who are the top 5 most followed users that Neo4j follows?,"MATCH (me:Me)-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
$me isa me;
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 5;
fetch { ""user"": $followed.screen_name, ""follower_count"": $f };"
34,List 3 users who follow Neo4j and have a location specified as 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {name: 'Neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$me isa me, has name ""Neo4j"";
follows (follower: $u, followed: $me);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""location"": $u.location };"
35,What are the names of the top 5 users with the highest betweenness centrality?,"MATCH (u:User)
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""name"": $u.name };"
36,Identify 5 users who follow more than 5000 users but have fewer than 10000 followers.,"MATCH (u:User)
WHERE u.following > 5000 AND u.followers < 10000
RETURN u.screen_name, u.following, u.followers
LIMIT 5","match
$u isa user, has following $fg, has followers $fr;
$fg > 5000;
$fr < 10000;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""following"": $fg, ""followers"": $fr };"
37,Find 3 tweets that contain links and were created in 2021.,"MATCH (t:Tweet)-[:CONTAINS]->(:Link)
WHERE t.created_at >= date('2021-01-01') AND t.created_at < date('2022-01-01') 
RETURN t
LIMIT 3","match
$t isa tweet, has created_at $ca;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
limit 3;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
38,Which 5 users are most similar to Neo4j based on the SIMILAR_TO score?,"MATCH (me:Me {name: 'Neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user;
$s isa similar_to (source_user: $u, similar_user: $me), has score $sc;
sort $sc desc;
limit 5;
fetch { ""user"": $u.screen_name, ""similarity"": $sc };"
39,List the top 3 hashtags used in tweets posted by users from 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$t isa tweet;
$h isa hashtag;
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
40,What are the top 3 sources used in the tweets that mention Neo4j?,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})-[:POSTS]->(t)
MATCH (t)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
$s isa source;
mentions (source_tweet: $t, mentioned_user: $u);
using (tweet_content: $t, platform: $s);
reduce $count = count($t) groupby $s;
sort $count desc;
limit 3;
fetch { ""source"": $s.source_name, ""count"": $count };"
41,Who are the 5 users with the most interactions with other users?,"MATCH (u:User)-[i:INTERACTS_WITH]->(other:User)
RETURN u.name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
$u isa user;
$other isa user;
$i isa interacts_with (interactor: $u, target: $other);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""user"": $u.name, ""interactions"": $interactions };"
43,Which 3 users amplified Neo4j the most?,"MATCH (me:Me)<-[:AMPLIFIES]-(u:User)
RETURN u.screen_name AS user, count(*) AS amplifications
ORDER BY amplifications DESC
LIMIT 3","match
$me isa me;
$u isa user;
$a isa amplifies (amplifier: $u, amplified_user: $me);
reduce $amplifications = count($a) groupby $u;
sort $amplifications desc;
limit 3;
fetch { ""user"": $u.screen_name, ""amplifications"": $amplifications };"
45,Who are the top 3 users that Neo4j has retweeted mentions from?,"MATCH (me:Me {screen_name: 'neo4j'})-[:RT_MENTIONS]->(user:User)
WITH user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN user.screen_name AS user, mentions","match
$me isa me, has screen_name ""neo4j"";
$user isa user;
$r isa rt_mentions (mentioner: $me, mentioned_user: $user);
reduce $mentions = count($r) groupby $user;
sort $mentions desc;
limit 3;
fetch { ""user"": $user.screen_name, ""mentions"": $mentions };"
46,List 3 users who have posted tweets tagging the hashtag 'education'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN u.name, u.screen_name, t.text
LIMIT 3","match
$u isa user;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""text"": $t.text };"
47,Which 3 tweets posted by Neo4j have the most replies?,"MATCH (me:Me {name: 'Neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)<-[:REPLY_TO]-() }
RETURN tweet.text AS tweet_text, count{(tweet)<-[:REPLY_TO]-()} AS reply_count
ORDER BY reply_count DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$tweet isa tweet;
$reply isa tweet;
posts (author: $me, content: $tweet);
reply_to (original_tweet: $tweet, replying_tweet: $reply);
reduce $reply_count = count($reply) groupby $tweet;
sort $reply_count desc;
limit 3;
fetch { ""tweet_text"": $tweet.text, ""reply_count"": $reply_count };"
48,Identify the top 5 tweets that mention Neo4j and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(:Me)
WHERE (t)-[:CONTAINS]->(:Link)
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
$me isa me;
$l isa link;
mentions (source_tweet: $t, mentioned_user: $me);
contains (containing_tweet: $t, contained_link: $l);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text };"
49,What are the 3 most common hashtags in tweets that have been retweeted more than 100 times?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 100
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $hashtag_count = count groupby $hashtag;
sort $hashtag_count desc;
limit 3;
fetch {
  ""hashtag"": $hashtag.hashtag_name,
  ""count"": $hashtag_count
};"
50,List the tweets containing the link 'https://twitter.com/i/web/status/13718150212657479' and were created in March 2021.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link {url: 'https://twitter.com/i/web/status/13718150212657479'})
WHERE t.created_at >= date('2021-03-01') AND t.created_at < date('2021-04-01') 
RETURN t","match
$t isa tweet, has created_at $ca;
$l isa link, has link_url ""https://twitter.com/i/web/status/13718150212657479"";
contains (containing_tweet: $t, contained_link: $l);
$ca >= 2021-03-01T00:00:00;
$ca < 2021-04-01T00:00:00;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
51,Which 3 users have the most followers among those who have interacted with Neo4j?,"MATCH (u:User)-[:INTERACTS_WITH]->(:Me {name: 'Neo4j'})
RETURN u.screen_name AS user, u.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 3","match
$u isa user, has followers $f;
$me isa me, has name ""Neo4j"";
interacts_with (interactor: $u, target: $me);
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""followerCount"": $f };"
52,Identify the top 5 tweets with texts containing the word 'education'.,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'education'
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has text $txt, has favorites $f;
$txt like ""%education%"";
sort $f desc;
limit 5;
fetch { ""text"": $txt, ""favorites"": $f };"
53,Find the 3 most recent tweets by Neo4j.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 3","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
sort $ca desc;
limit 3;
fetch { ""text"": $t.text, ""created_at"": $ca };"
54,Which 3 users with the highest betweenness have tweeted about 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$u isa user, has betweenness $b;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
sort $b desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
55,List the top 3 sources used by tweets mentioning 'Neo4j' and containing a hashtag.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'}),
      (t)-[:TAGS]->(:Hashtag),
      (t)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$t isa tweet;
$u isa user, has name ""Neo4j"";
$h isa hashtag;
$s isa source;
mentions (source_tweet: $t, mentioned_user: $u);
tags (tagged_tweet: $t, tag: $h);
using (tweet_content: $t, platform: $s);
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 3;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
56,Who are the top 5 users followed by Neo4j that have tweeted more than 1000 times?,"MATCH (me:Me {name: 'Neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > 1000
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user, has statuses $s;
follows (follower: $me, followed: $u);
$s > 1000;
sort $s desc;
limit 5;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""statuses"": $s };"
57,Find the top 3 users who amplified tweets by Neo4j and have a high betweenness score.,"MATCH (me:Me {name: 'Neo4j'})<-[:AMPLIFIES]-(u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name AS user, u.betweenness AS betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$u isa user, has betweenness $b;
amplifies (amplifier: $u, amplified_user: $me);
sort $b desc;
limit 3;
fetch { ""user"": $u.screen_name, ""betweenness"": $b };"
58,Which 3 tweets by Neo4j have the most favorites and were posted in 2020?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.created_at >= date('2020-01-01') AND tweet.created_at < date('2021-01-01') 
RETURN tweet.text AS tweet_text, tweet.favorites AS num_favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca, has favorites $f;
posts (author: $me, content: $tweet);
$ca >= 2020-01-01T00:00:00;
$ca < 2021-01-01T00:00:00;
sort $f desc;
limit 3;
fetch { ""tweet_text"": $tweet.text, ""num_favorites"": $f };"
59,List the 3 tweets by Neo4j that have been retweeted by users with more than 10000 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {
  (tweet)<-[:RETWEETS]-(:Tweet)<-[:POSTS]-(retweeter:User)
  WHERE retweeter.followers > 10000
}
RETURN tweet.text
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
$f > 10000;
limit 3;
fetch { ""text"": $tweet.text };"
60,What are the names of the top 5 users with the highest betweenness?,"MATCH (u:User)
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""name"": $u.name };"
61,List the screen names of the first 3 users who have the most followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 3","match
$u isa user, has followers $f;
sort $f desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
62,Who are the top 5 users based on the number of statuses they have posted?,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses AS status_count
ORDER BY u.statuses DESC
LIMIT 5","match
$u isa user, has statuses $s;
sort $s desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""status_count"": $s };"
63,Identify the top 3 users by the number of people they are following.,"MATCH (u:User)
RETURN u.screen_name AS user, u.following AS following
ORDER BY u.following DESC
LIMIT 3","match
$u isa user, has following $f;
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""following"": $f };"
64,Who are the three users with the most mentions in tweets?,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)
RETURN u.name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
$u isa user;
$t isa tweet;
$m isa mentions (source_tweet: $t, mentioned_user: $u);
reduce $mentions = count($m) groupby $u;
sort $mentions desc;
limit 3;
fetch { ""user"": $u.name, ""mentions"": $mentions };"
65,List the first 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 5;
fetch { ""text"": $t.text, ""favorites"": $f };"
66,What are the top 3 sources used most frequently in tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$t isa tweet;
$s isa source;
using (tweet_content: $t, platform: $s);
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 3;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
67,Which 5 users have posted the most tweets?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 5
RETURN u.screen_name AS user, num_tweets","match
$u isa user;
$t isa tweet;
posts (author: $u, content: $t);
reduce $num_tweets = count($t) groupby $u;
sort $num_tweets desc;
limit 5;
fetch { ""user"": $u.screen_name, ""num_tweets"": $num_tweets };"
68,Identify the top 3 hashtags used in tweets.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
69,What are the top 5 most recent tweets based on the creation date?,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5","match
$t isa tweet, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
70,List the URLs of the top 3 tweets containing links.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS url
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
sort $f desc;
limit 3;
fetch { ""url"": $l.link_url };"
71,Who are the top 3 users most similar to 'Neo4j' based on the SIMILAR_TO score?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 3;
fetch { ""similar_user"": $u.screen_name, ""similarity"": $sc };"
72,What are the first 3 locations where the most users are based?,"MATCH (u:User)
WHERE u.location IS NOT NULL
RETURN u.location, count(u) AS num_users
ORDER BY num_users DESC
LIMIT 3","match
$u isa user, has location $loc;
reduce $num_users = count($u) groupby $loc;
sort $num_users desc;
limit 3;
fetch { ""location"": $loc, ""num_users"": $num_users };"
73,List the top 5 tweets that have been retweeted the most times.,"MATCH (t:Tweet)-[:RETWEETS]->(retweet:Tweet)
RETURN t.text AS tweet_text, count(retweet) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 5","match
$t isa tweet, has text $txt;
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $count = count($rt) groupby $txt;
sort $count desc;
limit 5;
fetch { ""tweet_text"": $txt, ""retweet_count"": $count };"
74,Which 5 tweets have the most replies?,"MATCH (t:Tweet)
WHERE exists{ (t)<-[:REPLY_TO]-() }
RETURN t, count{(t)<-[:REPLY_TO]-()} AS replies
ORDER BY replies DESC
LIMIT 5","match
$t isa tweet;
$reply isa tweet;
reply_to (original_tweet: $t, replying_tweet: $reply);
reduce $replies = count($reply) groupby $t;
sort $replies desc;
limit 5;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""replies"": $replies };"
76,Who are the top 5 users mentioned in the most tweets?,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)
RETURN u.name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$u isa user;
$t isa tweet;
mentions (source_tweet: $t, mentioned_user: $u);
reduce $mentions = count($t) groupby $u;
sort $mentions desc;
limit 5;
fetch { ""user"": $u.name, ""mentions"": $mentions };"
78,What are the names of the top 5 users interacting most frequently with others?,"MATCH (u:User)-[i:INTERACTS_WITH]->(other)
RETURN u.name AS name, count(i) AS interactions 
ORDER BY interactions DESC
LIMIT 5","match
$u isa user;
$other isa user;
$i isa interacts_with (interactor: $u, target: $other);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""name"": $u.name, ""interactions"": $interactions };"
79,Identify the top 3 tweets with links pointing to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text AS tweet_text, l.url AS link_url
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link, has link_url $url;
contains (containing_tweet: $t, contained_link: $l);
$url like ""https://twitter.com%"";
sort $f desc;
limit 3;
fetch { ""tweet_text"": $t.text, ""link_url"": $url };"
80,Which 5 tweets contain the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text AS tweet_text
LIMIT 5","match
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
limit 5;
fetch { ""tweet_text"": $t.text };"
81,"List the top 5 tweets by the total interaction (mentions, retweets, replies).","MATCH (t:Tweet)
OPTIONAL MATCH (t)<-[:MENTIONS]-(mention)
OPTIONAL MATCH (t)<-[:RETWEETS]-(retweet) 
OPTIONAL MATCH (t)<-[:REPLY_TO]-(reply)
RETURN t.text AS tweet, 
       count(mention) AS mentions,
       count(retweet) AS retweets, 
       count(reply) AS replies,
       (count(mention) + count(retweet) + count(reply)) AS totalInteractions
ORDER BY totalInteractions DESC
LIMIT 5","match
$tweet isa tweet;
$rel isa $t;
{
  $t label mentions;
  $rel links (source_tweet: $tweet);
} or {
  $t label retweets;
  $rel links (original_tweet: $tweet);
} or {
  $t label reply_to;
  $rel links (original_tweet: $tweet);
};
reduce $count = count groupby $tweet;
sort $count desc;
limit 5;
fetch {
  ""tweet"": $tweet.text,
  ""count"": $count
};"
82,Who are the first 3 users followed by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$followed isa user;
follows (follower: $me, followed: $followed);
limit 3;
fetch { ""screen_name"": $followed.screen_name };"
83,What are the top 3 most common tweet sources for the user 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$s isa source;
posts (author: $u, content: $t);
using (tweet_content: $t, platform: $s);
reduce $count = count($t) groupby $s;
sort $count desc;
limit 3;
fetch { ""source"": $s.source_name, ""count"": $count };"
84,Identify the top 5 users with the most similar profiles to 'Neo4j' based on betweenness and following.,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score IS NOT NULL
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 5;
fetch { ""user"": $u.screen_name, ""similarity"": $sc };"
85,Which 3 tweets have the highest aggregation of favorites and retweets?,"MATCH (t:Tweet)
OPTIONAL MATCH (t)-[:RETWEETS]->(r:Tweet)
RETURN t, t.favorites + count(r) AS score
ORDER BY score DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet);
reduce $retweets = count groupby $tweet;
match
$tweet has favorites $favorites;
let $total = $favorites + $retweets;
sort $total desc;
limit 3;
fetch {
  ""tweet"": $tweet.text,
  ""total"": $total
};"
86,List the top 5 users who mostly tweet about 'education'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5
RETURN u.screen_name AS user, tweet_count","match
$u isa user;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
reduce $tweet_count = count($t) groupby $u;
sort $tweet_count desc;
limit 5;
fetch { ""user"": $u.screen_name, ""tweet_count"": $tweet_count };"
87,What are the top 3 most used hashtags in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $count = count($tweet) groupby $hashtag;
sort $count desc;
limit 3;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
88,Identify the top 5 tweets mentioning 'Neo4j' with the greatest number of favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has text $txt, has favorites $f;
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
$txt like ""%Neo4j%"";
sort $f desc;
limit 5;
fetch { ""tweet_text"": $txt, ""num_favorites"": $f };"
89,Who are the first 5 users retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweetedTweet isa tweet;
$retweetedUser isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
posts (author: $retweetedUser, content: $retweetedTweet);
limit 5;
fetch { ""screen_name"": $retweetedUser.screen_name };"
90,Which users have a betweenness higher than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u","match
$u isa user, has betweenness $b;
$b > 300000000;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""betweenness"": $b };"
91,List all users who follow 'neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name };"
92,Which tweets mention the user with the screen name 'neo4j'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
RETURN t","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
93,Find the top 5 most recent tweets by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 5","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""created_at"": $ca };"
94,What are the top 3 hashtags used by 'neo4j' in their tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $count = count($tweet) groupby $hashtag;
sort $count desc;
limit 3;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
95,Who are the top 5 followers of 'neo4j' by number of followers?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
RETURN follower.screen_name AS follower, follower.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$follower isa user, has followers $f;
follows (follower: $follower, followed: $me);
sort $f desc;
limit 5;
fetch { ""follower"": $follower.screen_name, ""followerCount"": $f };"
96,List all the sources used by 'neo4j' for tweeting.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN DISTINCT source.name","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$source isa source;
posts (author: $me, content: $tweet);
using (tweet_content: $tweet, platform: $source);
fetch { ""name"": $source.source_name };"
97,Which users are followed by 'neo4j' and have more than 10000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.followers > 10000
RETURN u.screen_name, u.followers","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
$f > 10000;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
98,Find tweets that contain links and were posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""link_url"": $l.link_url };"
99,Who does 'neo4j' interact with most frequently?,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 1","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$i isa interacts_with (interactor: $me, target: $u);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 1;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""interactions"": $interactions };"
100,List the top 3 users similar to 'neo4j' by similarity score.,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 3;
fetch { ""similar_user"": $u.screen_name, ""similarity"": $sc };"
102,List the top 5 tweets by 'neo4j' with the most favorites.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
103,Who are the top 3 users amplified by 'Me'?,"MATCH (me:Me)-[:AMPLIFIES]->(u:User)
RETURN u.name, u.screen_name
ORDER BY u.followers DESC
LIMIT 3","match
$me isa me;
$u isa user, has followers $f;
amplifies (amplifier: $me, amplified_user: $u);
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name };"
104,List all tweets that 'neo4j' has replied to.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet, repliedTo","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$repliedTo isa tweet;
posts (author: $me, content: $tweet);
reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
fetch { ""reply_text"": $tweet.text, ""original_text"": $repliedTo.text };"
105,Which users follow 'neo4j' and are located in 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
$u isa user, has location ""Graphs Are Everywhere"";
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""location"": $u.location };"
107,Which users mentioned by 'neo4j' in tweets have the highest betweenness?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.screen_name AS user, mentioned.betweenness AS betweenness
ORDER BY mentioned.betweenness DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$mentioned isa user, has betweenness $b;
posts (author: $me, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
sort $b desc;
limit 10;
fetch { ""user"": $mentioned.screen_name, ""betweenness"": $b };"
108,Which users following 'neo4j' have tweeted about 'education'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}),
      (u)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN u.screen_name AS user, t.text AS tweet","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
follows (follower: $u, followed: $me);
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
fetch { ""user"": $u.screen_name, ""tweet"": $t.text };"
109,"Who are the top 3 users that 'neo4j' interacts with, sorted by interaction frequency?","MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$i isa interacts_with (interactor: $me, target: $u);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
110,Which tweets by 'neo4j' contain the hashtag 'education'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet.text","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag, has hashtag_name ""education"";
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
fetch { ""text"": $tweet.text };"
111,List all the links contained in tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""url"": $l.link_url };"
112,What are the profile image URLs of users who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u.profile_image_url","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""profile_image_url"": $u.profile_image_url };"
113,Which users followed by 'neo4j' have the highest betweenness values?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(follower:User)
RETURN follower.screen_name, follower.betweenness
ORDER BY follower.betweenness DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$follower isa user, has betweenness $b;
follows (follower: $me, followed: $follower);
sort $b desc;
limit 10;
fetch { ""screen_name"": $follower.screen_name, ""betweenness"": $b };"
115,How many users does 'neo4j' amplify?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN count(user) AS amplified_users","match
$me isa me, has screen_name ""neo4j"";
$user isa user;
amplifies (amplifier: $me, amplified_user: $user);
reduce $amplified_users = count($user);
fetch { ""amplified_users"": $amplified_users };"
116,Which tweets made by 'neo4j' were retweeted by users with more than 10000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
WHERE retweeter.followers > 10000
RETURN tweet.text, retweet.text, retweeter.screen_name, retweeter.followers","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
$f > 10000;
fetch { ""tweet_text"": $tweet.text, ""retweet_text"": $retweet.text, ""retweeter_screen_name"": $retweeter.screen_name, ""followers"": $f };"
117,List the top 5 users who have mentioned 'neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$u isa user;
$t isa tweet;
$me isa me, has screen_name ""neo4j"";
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
reduce $mentions = count($t) groupby $u;
sort $mentions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""mentions"": $mentions };"
119,Find the top 5 tweets mentioning 'neo4j' with the most favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.text CONTAINS 'neo4j'
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has text $txt, has favorites $f;
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
$txt like ""%neo4j%"";
sort $f desc;
limit 5;
fetch { ""tweet_text"": $txt, ""num_favorites"": $f };"
120,Which tweets by 'neo4j' use the source named 'Buffer'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$source isa source, has source_name ""Buffer"";
posts (author: $me, content: $tweet);
using (tweet_content: $tweet, platform: $source);
fetch { ""text"": $tweet.text, ""tweet_id"": $tweet.tweet_id, ""created_at"": $tweet.created_at };"
121,List all the hashtags used in tweets that mention 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:TAGS]->(h:Hashtag)
RETURN DISTINCT h.name","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
$h isa hashtag;
mentions (source_tweet: $t, mentioned_user: $u);
tags (tagged_tweet: $t, tag: $h);
fetch { ""name"": $h.hashtag_name };"
122,Which users followed by 'neo4j' also follow 'Me'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(u:User)-[:FOLLOWS]->(neo4j:User {screen_name: 'neo4j'})
RETURN u.screen_name AS user","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $me);
follows (follower: $me, followed: $u);
fetch { ""user"": $u.screen_name };"
123,Find the tweets where 'neo4j' has been mentioned by users with more than 10000 followers.,"MATCH (u:User {screen_name: 'neo4j'})<-[:MENTIONS]-(t:Tweet)<-[:POSTS]-(mentioner:User)
WHERE mentioner.followers > 10000
RETURN t, mentioner","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$mentioner isa user, has followers $f;
mentions (source_tweet: $t, mentioned_user: $u);
posts (author: $mentioner, content: $t);
$f > 10000;
fetch { ""text"": $t.text, ""mentioner_screen_name"": $mentioner.screen_name, ""mentioner_followers"": $f };"
124,List the URLs of tweets posted by 'neo4j' that contain links.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""url"": $l.link_url };"
125,What are the names of the top 3 users with the most followers who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u.name AS name, u.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
$u isa user, has followers $f;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""followers"": $f };"
126,Find the top 5 users who have retweeted tweets made by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
RETURN retweeter.screen_name AS retweeter, count(*) AS retweets
ORDER BY retweets DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
reduce $retweets = count($retweet) groupby $retweeter;
sort $retweets desc;
limit 5;
fetch { ""retweeter"": $retweeter.screen_name, ""retweets"": $retweets };"
127,List all the tweets by 'neo4j' that reply to another tweet.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet.text AS tweet, repliedTo.id_str AS in_reply_to_tweet_id","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$repliedTo isa tweet;
posts (author: $me, content: $tweet);
reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
fetch { ""tweet"": $tweet.text, ""in_reply_to_tweet_id"": $repliedTo.id_str };"
128,Who are the users that 'neo4j' mentions most frequently in their tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned, count(*) AS num_mentions
ORDER BY num_mentions DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$mentioned isa user;
posts (author: $me, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
reduce $num_mentions = count($tweet) groupby $mentioned;
sort $num_mentions desc;
limit 10;
fetch { ""screen_name"": $mentioned.screen_name, ""name"": $mentioned.name, ""num_mentions"": $num_mentions };"
130,List the top 3 most followed users who mention 'neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WITH u, count(t) AS mentions
ORDER BY u.followers DESC
LIMIT 3
RETURN u.screen_name AS user, u.followers AS followers, mentions","match
$u isa user, has followers $f;
$t isa tweet;
$neo isa user, has screen_name ""neo4j"";
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $neo);
reduce $mentions = count($t) groupby $u, $f;
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""followers"": $f, ""mentions"": $mentions };"
131,Which users followed by 'neo4j' have tweeted the most?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS num_tweets
ORDER BY num_tweets DESC
RETURN u.screen_name AS user, num_tweets
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$t isa tweet;
follows (follower: $me, followed: $u);
posts (author: $u, content: $t);
reduce $num_tweets = count($t) groupby $u;
sort $num_tweets desc;
limit 10;
fetch { ""user"": $u.screen_name, ""num_tweets"": $num_tweets };"
132,Find the top 5 tweets by 'neo4j' tagged with a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN tweet.text AS tweet, hashtag.name AS hashtag
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
sort $f desc;
limit 5;
fetch { ""tweet"": $tweet.text, ""hashtag"": $hashtag.hashtag_name };"
133,Who are the top 3 users that 'neo4j' has the highest similarity scores with?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(other:User)
RETURN other.screen_name AS similar_user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$other isa user;
$s isa similar_to (source_user: $me, similar_user: $other), has score $sc;
sort $sc desc;
limit 3;
fetch { ""similar_user"": $other.screen_name, ""similarity"": $sc };"
134,What are the most common locations of users who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL
RETURN u.location, count(*) AS num_users
ORDER BY num_users DESC
LIMIT 10","match
$u isa user, has location $loc;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
reduce $num_users = count($u) groupby $loc;
sort $num_users desc;
limit 10;
fetch { ""location"": $loc, ""num_users"": $num_users };"
135,Which tweets by 'neo4j' have the highest number of favorites?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
137,Who are the top 5 users that follow both 'neo4j' and 'Me'?,"MATCH (u:User)-[:FOLLOWS]->(:User {screen_name: 'neo4j'}), 
      (u)-[:FOLLOWS]->(:Me)
RETURN u.screen_name AS user, u.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
$u isa user, has screen_name $sn, has followers $fc;
$neo4j isa user, has screen_name ""neo4j"";
$me isa me;
follows (follower: $u, followed: $neo4j);
follows (follower: $u, followed: $me);
sort $fc desc;
limit 5;
fetch { ""user"": $sn, ""followerCount"": $fc };"
139,List the top 5 users with the highest number of followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
$u isa user, has followers $f;
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
140,Which three users have tweeted the most as of the latest date in the dataset?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE t.created_at IS NOT NULL
WITH u, count(t) AS num_tweets, max(t.created_at) AS latest_tweet
RETURN u.screen_name AS user, num_tweets, latest_tweet
ORDER BY num_tweets DESC
LIMIT 3","match
$u isa user;
$t isa tweet;
posts (author: $u, content: $t);
reduce $num_tweets = count($t) groupby $u;
sort $num_tweets desc;
limit 3;
fetch { ""user"": $u.screen_name, ""num_tweets"": $num_tweets };"
141,Identify the top 5 tweets with the highest favorite counts.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 5;
fetch { ""text"": $t.text, ""favorites"": $f };"
142,What are the names of the top 3 users who have a betweenness greater than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 3","match
$u isa user, has betweenness $b;
$b > 300000000;
sort $b desc;
limit 3;
fetch { ""name"": $u.name };"
143,Which three tweets have the most mentions of other users?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WITH t, count(u) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN t.text AS tweet_text, mentions","match
$t isa tweet;
$u isa user;
mentions (source_tweet: $t, mentioned_user: $u);
reduce $mentions = count($u) groupby $t;
sort $mentions desc;
limit 3;
fetch { ""tweet_text"": $t.text, ""mentions"": $mentions };"
144,List the top 5 most recent tweets based on the 'created_at' date.,"MATCH (t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 5","match
$t isa tweet, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""created_at"": $ca };"
145,What are the three most commonly used hashtags in tweets?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
146,Identify the top 5 users based on the number of posts they have made.,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS num_posts
ORDER BY num_posts DESC
LIMIT 5
RETURN u.screen_name AS user, num_posts","match
$u isa user;
$t isa tweet;
posts (author: $u, content: $t);
reduce $num_posts = count($t) groupby $u;
sort $num_posts desc;
limit 5;
fetch { ""user"": $u.screen_name, ""num_posts"": $num_posts };"
147,Which three users are most similar to 'Neo4j' based on the 'SIMILAR_TO' score?,"MATCH (me:Me {screen_name: 'neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $u, similar_user: $me), has score $sc;
sort $sc desc;
limit 3;
fetch { ""user"": $u.screen_name, ""similarity"": $sc };"
148,List the URLs of the top 5 most linked-to external sites in tweets.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS url, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$t isa tweet;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
reduce $count = count($t) groupby $l;
sort $count desc;
limit 5;
fetch { ""url"": $l.link_url, ""count"": $count };"
149,What are the names of the top 3 sources most used in tweeting?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$t isa tweet;
$s isa source;
using (tweet_content: $t, platform: $s);
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 3;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
150,Which three users have the highest 'betweenness' metric in the network?,"MATCH (u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$u isa user, has betweenness $b;
sort $b desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
151,Find the top 5 hashtags mentioned by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $mentions = count($tweet) groupby $hashtag;
sort $mentions desc;
limit 5;
fetch { ""hashtag"": $hashtag.hashtag_name, ""mentions"": $mentions };"
152,Who are the top 3 users that 'Neo4j' follows?,"MATCH (me:Me {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.name AS user, followed.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 3;
fetch { ""user"": $followed.name, ""followers"": $f };"
153,List the screen names of the top 5 users followed by the most number of other users.,"MATCH (u:User)<-[:FOLLOWS]-(follower:User)
WITH u, count(follower) AS follower_count
ORDER BY follower_count DESC
LIMIT 5
RETURN u.screen_name AS screen_name, follower_count","match
$u isa user;
$follower isa user;
follows (follower: $follower, followed: $u);
reduce $follower_count = count($follower) groupby $u;
sort $follower_count desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""follower_count"": $follower_count };"
154,Which three tweets have the highest retweet counts?,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has text $txt;
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $count = count($rt) groupby $txt;
sort $count desc;
limit 3;
fetch { ""text"": $txt, ""retweet_count"": $count };"
155,Identify the top 5 users who are followed by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 5;
fetch { ""user"": $followed.screen_name, ""followerCount"": $f };"
156,What are the top 3 locations where the most active users are based?,"MATCH (u:User)
WHERE u.location IS NOT NULL
WITH u.location AS location, count(u) AS num_users, sum(u.statuses) AS total_statuses
RETURN location, num_users, total_statuses
ORDER BY total_statuses DESC
LIMIT 3","match
$u isa user, has location $loc, has statuses $s;
reduce $total_statuses = sum($s), $num_users = count($u) groupby $loc;
sort $total_statuses desc;
limit 3;
fetch { ""location"": $loc, ""num_users"": $num_users, ""total_statuses"": $total_statuses };"
157,Which three tweets contain the word 'graph' in their text?,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'graph'
RETURN t
LIMIT 3","match
$t isa tweet, has text $txt;
$txt like ""%graph%"";
limit 3;
fetch { ""text"": $txt, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
158,List the top 5 tweets which mention the user with the highest followers.,"MATCH (u:User)-[:MENTIONS]-(t:Tweet)
WHERE u.followers IS NOT NULL
WITH u, t
ORDER BY u.followers DESC
LIMIT 1
MATCH (t:Tweet)-[:MENTIONS]->(u) 
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 5","match
$u isa user, has followers $f;
$t isa tweet, has favorites $fav;
mentions (source_tweet: $t, mentioned_user: $u);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text };"
159,Who are the top 3 users that have interacted the most with 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[i:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$i isa interacts_with (interactor: $u, target: $me);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
160,What are the names of the top 3 hashtags used in tweets about technology?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'technology'
RETURN h.name as hashtag, count(*) as count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet, has text $txt;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%technology%"";
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
161,Which three users have posted the most about 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN u.name, u.screen_name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$u isa user;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
reduce $tweet_count = count($t) groupby $u;
sort $tweet_count desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""tweet_count"": $tweet_count };"
162,Who are the top 3 users that 'Neo4j' has retweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)<-[:POSTS]-(retweeted_user:User)
RETURN retweeted_user.screen_name AS retweeted_user, count(*) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweeted_tweet isa tweet;
$retweeted_user isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
posts (author: $retweeted_user, content: $retweeted_tweet);
reduce $retweet_count = count($tweet) groupby $retweeted_user;
sort $retweet_count desc;
limit 3;
fetch { ""retweeted_user"": $retweeted_user.screen_name, ""retweet_count"": $retweet_count };"
164,What are the top 3 external sources linked in tweets about software?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'software'})
MATCH (t)-[:CONTAINS]->(l:Link)
WITH l.url AS url, count(*) AS count
ORDER BY count DESC
LIMIT 3
RETURN url, count","match
$t isa tweet;
$h isa hashtag, has hashtag_name ""software"";
$l isa link;
tags (tagged_tweet: $t, tag: $h);
contains (containing_tweet: $t, contained_link: $l);
reduce $count = count($t) groupby $l;
sort $count desc;
limit 3;
fetch { ""url"": $l.link_url, ""count"": $count };"
165,Which three tweets have the highest replies?,"MATCH (t:Tweet)-[:REPLY_TO]->(reply:Tweet)
RETURN t, count(reply) AS replies
ORDER BY replies DESC
LIMIT 3","match
$t isa tweet;
$reply isa tweet;
reply_to (original_tweet: $t, replying_tweet: $reply);
reduce $replies = count($reply) groupby $t;
sort $replies desc;
limit 3;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""replies"": $replies };"
166,List the top 5 tweets by 'Neo4j' based on favorite counts.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
167,What are the top 5 users with the highest betweenness scores?,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
168,List the first 3 users who have more than 10000 followers.,"MATCH (u:User)
WHERE u.followers > 10000
RETURN u.name, u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 3","match
$u isa user, has followers $f;
$f > 10000;
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""followers"": $f };"
169,Which users follow 'Neo4j' and have a location specified as 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
$u isa user, has location ""Graphs Are Everywhere"";
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""location"": $u.location };"
170,Find the first 3 tweets that have been retweeted more than 100 times.,"MATCH (t:Tweet)
WHERE t.favorites > 100
RETURN t
ORDER BY t.favorites DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
sort $count desc;
limit 3;
fetch {
  ""tweet"": $tweet.text,
  ""retweets"": $count
};"
171,Identify the top 5 tweets tagged with the hashtag 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text, ""favorites"": $f };"
172,Who are the top 5 most followed users that 'Neo4j' follows?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 5;
fetch { ""user"": $followed.screen_name, ""follower_count"": $f };"
173,List the first 3 tweets posted using the source named 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t.text AS tweet_text
ORDER BY t.created_at
LIMIT 3","match
$t isa tweet, has created_at $ca;
$s isa source, has source_name ""Buffer"";
using (tweet_content: $t, platform: $s);
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $t.text };"
175,Identify the first 3 users who mentioned 'Neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
RETURN u.name, u.screen_name, t.text
LIMIT 3","match
$u isa user;
$t isa tweet;
$me isa me, has name ""Neo4j"";
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""text"": $t.text };"
176,What are the first 3 tweets that contain a link starting with 'https://twitter.com'?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text, l.url
LIMIT 3","match
$t isa tweet;
$l isa link, has link_url $url;
contains (containing_tweet: $t, contained_link: $l);
$url like ""https://twitter.com%"";
limit 3;
fetch { ""text"": $t.text, ""url"": $url };"
177,List the top 5 users by the number of statuses they have posted.,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses AS status_count
ORDER BY u.statuses DESC
LIMIT 5","match
$u isa user, has statuses $s;
sort $s desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""status_count"": $s };"
178,Who are the top 3 users followed by 'Me' with the highest betweenness scores?,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$me isa me;
$u isa user, has betweenness $b;
follows (follower: $me, followed: $u);
sort $b desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
179,List the first 3 tweets that 'Neo4j' has retweeted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)
RETURN retweeted.text
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweeted isa tweet;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
limit 3;
fetch { ""text"": $retweeted.text };"
180,Which tweets mention 'Neo4j' and contain a hashtag? Show the first 3.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag)
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text
LIMIT 3","match
$t isa tweet, has text $txt;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
limit 3;
fetch { ""tweet_text"": $txt };"
182,List the first 3 users who interact most frequently with 'Neo4j' based on the INTERACTS_WITH relationship.,"MATCH (u:User)-[i:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
interacts_with (interactor: $u, target: $me);
reduce $interactions = count($u) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
183,Which users have amplified 'Neo4j' and also follow more than 1000 users? List the first 3.,"MATCH (me:Me {name: 'Neo4j'})<-[:AMPLIFIES]-(u:User)
WHERE u.following > 1000
RETURN u.name, u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$u isa user, has following $f;
amplifies (amplifier: $u, amplified_user: $me);
$f > 1000;
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""following"": $f };"
184,Identify the top 5 users who have a profile image URL ending with 'normal.jpg' and follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {name: 'Neo4j'})
WHERE u.profile_image_url ENDS WITH 'normal.jpg'
RETURN u.screen_name, u.profile_image_url
ORDER BY u.followers DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user, has profile_image_url $purl, has followers $f;
follows (follower: $u, followed: $me);
$purl like ""%normal.jpg"";
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""profile_image_url"": $purl };"
185,List the first 3 tweets that reply to another tweet and were created before March 2021.,"MATCH (t:Tweet)-[:REPLY_TO]->(replied_to:Tweet)
WHERE t.created_at < date(""2021-03-01"")
RETURN t, replied_to
LIMIT 3","match
$t isa tweet, has created_at $ca;
$replied_to isa tweet;
reply_to (replying_tweet: $t, original_tweet: $replied_to);
$ca < 2021-03-01T00:00:00;
limit 3;
fetch { ""tweet_text"": $t.text, ""tweet_created"": $ca, ""replied_to_text"": $replied_to.text };"
186,What are the top 5 hashtags used in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $count = count($tweet) groupby $hashtag;
sort $count desc;
limit 5;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
187,Identify the first 3 links contained in tweets that have been favorited more than 200 times.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE t.favorites > 200
RETURN l.url
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
$f > 200;
limit 3;
fetch { ""url"": $l.link_url };"
188,Who are the top 3 users that 'Neo4j' follows and who also follow 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:FOLLOWS]->(me)
RETURN u.screen_name AS user, u.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
follows (follower: $u, followed: $me);
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""followers"": $f };"
189,List the first 3 tweets created by users located in 'Graphs Are Everywhere' and posted after December 2020.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
WHERE t.created_at > date('2020-12-31')
RETURN t.text, t.created_at
ORDER BY t.created_at
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
$ca > 2020-12-31T00:00:00;
sort $ca asc;
limit 3;
fetch { ""text"": $t.text, ""created_at"": $ca };"
190,"Which users follow 'Neo4j' and have a betweenness score higher than 300,000,000? Show the top 5.","MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.betweenness > 300000000
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has betweenness $b;
follows (follower: $u, followed: $me);
$b > 300000000;
sort $b desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
191,Identify the first 3 users who have retweeted tweets mentioning 'Neo4j'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
RETURN DISTINCT u.name, u.screen_name
LIMIT 3","match
$u isa user;
$t isa tweet;
$rt isa tweet;
$mentioned isa user, has name ""Neo4j"";
posts (author: $u, content: $t);
retweets (retweeting_tweet: $t, original_tweet: $rt);
mentions (source_tweet: $rt, mentioned_user: $mentioned);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name };"
192,What are the top 5 tweets by favorites that were posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me;
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
193,List the first 3 users who have been retweeted by 'Neo4j' and have more than 500 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
WHERE retweetedUser.followers > 500
RETURN retweetedUser.screen_name, retweetedUser.followers
ORDER BY retweetedUser.followers DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweetedTweet isa tweet;
$retweetedUser isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
posts (author: $retweetedUser, content: $retweetedTweet);
$f > 500;
sort $f desc;
limit 3;
fetch { ""screen_name"": $retweetedUser.screen_name, ""followers"": $f };"
194,Which tweets posted by 'Neo4j' include links and were created in January 2021? Show the first 3.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
WHERE tweet.created_at >= date('2021-01-01') AND tweet.created_at < date('2021-02-01') 
RETURN tweet.text, tweet.created_at, link.url
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$link isa link;
posts (author: $me, content: $tweet);
contains (containing_tweet: $tweet, contained_link: $link);
$ca >= 2021-01-01T00:00:00;
$ca < 2021-02-01T00:00:00;
limit 3;
fetch { ""text"": $tweet.text, ""created_at"": $ca, ""url"": $link.link_url };"
195,What are the top 5 tweets that 'Neo4j' has amplified?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:POSTS]-(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$t isa tweet, has favorites $f;
amplifies (amplifier: $me, amplified_user: $u);
posts (author: $u, content: $t);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text, ""favorites"": $f };"
196,Identify the first 3 users who mention 'Neo4j' and have a location of 'Graphs Are Everywhere'.,"MATCH (u:User)
WHERE u.location = 'Graphs Are Everywhere'
  AND EXISTS {
    (u)-[:POSTS]->(:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
  }
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$tweet isa tweet;
$me isa me, has name ""Neo4j"";
posts (author: $u, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $me);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""location"": $u.location };"
197,List the top 5 most recent tweets that 'Neo4j' has posted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.created_at
ORDER BY tweet.created_at DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
posts (author: $me, content: $tweet);
sort $ca desc;
limit 5;
fetch { ""text"": $tweet.text, ""created_at"": $ca };"
198,What are the first 3 tweets that 'Neo4j' has mentioned other users in and were created in 2021?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE tweet.created_at >= date('2021-01-01') AND tweet.created_at < date('2022-01-01') 
RETURN tweet.text AS tweet_text, tweet.created_at AS created_at, collect(mentioned.screen_name) AS mentioned_users
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$mentioned isa user;
posts (author: $me, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $tweet.text, ""created_at"": $ca, ""mentioned_user"": $mentioned.screen_name };"
199,Identify the top 5 users who have a following between 5000 and 15000 and follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.following >= 5000 AND u.following <= 15000
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has following $f;
follows (follower: $u, followed: $me);
$f >= 5000;
$f <= 15000;
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""following"": $f };"
201,List the top 5 tweets that have replied to 'Neo4j' and contain a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:REPLY_TO]-(tweet:Tweet)-[:TAGS]->(:Hashtag)
RETURN tweet.text AS tweet_text, tweet.favorites AS favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$myTweet isa tweet;
$tweet isa tweet, has favorites $f;
$h isa hashtag;
posts (author: $me, content: $myTweet);
reply_to (original_tweet: $myTweet, replying_tweet: $tweet);
tags (tagged_tweet: $tweet, tag: $h);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $tweet.text, ""favorites"": $f };"
202,What are the first 3 tweets by 'Neo4j' that have been retweeted by other users with more than 10000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.text IS NOT NULL
WITH me, tweet
MATCH (tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
WHERE retweeter.followers > 10000
RETURN tweet.text AS tweet_text, count{(tweet)<-[:RETWEETS]-(:Tweet)} AS retweet_count
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$retweet isa tweet;
$retweeter isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
posts (author: $retweeter, content: $retweet);
$f > 10000;
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $tweet.text };"
203,Identify the top 5 hashtags used in tweets that 'Neo4j' has retweeted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweeted_tweet)-[:TAGS]->(hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweeted_tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
tags (tagged_tweet: $retweeted_tweet, tag: $hashtag);
reduce $count = count($retweeted_tweet) groupby $hashtag;
sort $count desc;
limit 5;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
204,List the first 3 users that 'Neo4j' follows with the highest number of tweets.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE exists{ (followed)-[:POSTS]->(:Tweet) }
RETURN followed.screen_name AS user, count{(followed)-[:POSTS]->(:Tweet)} AS num_tweets
ORDER BY num_tweets DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$followed isa user;
$t isa tweet;
follows (follower: $me, followed: $followed);
posts (author: $followed, content: $t);
reduce $num_tweets = count($t) groupby $followed;
sort $num_tweets desc;
limit 3;
fetch { ""user"": $followed.screen_name, ""num_tweets"": $num_tweets };"
205,Which users have mentioned 'Neo4j' in their tweets and have a following of more than 20000? Show the top 5.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
WHERE u.following > 20000
RETURN u.name, u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user, has following $f;
$t isa tweet;
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
$f > 20000;
sort $f desc;
limit 5;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""following"": $f };"
206,What are the top 5 tweets that link to URLs starting with 'https://' and were posted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
WHERE link.url STARTS WITH 'https://'
RETURN tweet.text, link.url
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
$link isa link, has link_url $url;
posts (author: $me, content: $tweet);
contains (containing_tweet: $tweet, contained_link: $link);
$url like ""https://%"";
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""url"": $url };"
207,Identify the first 3 tweets mentioning 'Neo4j' that also tag a hashtag and were created in 2021.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag)
WHERE t.text CONTAINS 'Neo4j' AND t.created_at >= date('2021-01-01') AND t.created_at < date('2022-01-01') 
RETURN t
ORDER BY t.created_at
LIMIT 3","match
$t isa tweet, has text $txt, has created_at $ca;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""text"": $txt, ""created_at"": $ca };"
208,List the top 5 users followed by 'Neo4j' who have a screen_name starting with 'n'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.screen_name STARTS WITH 'n'
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has screen_name $sn, has followers $f;
follows (follower: $me, followed: $u);
$sn like ""n%"";
sort $f desc;
limit 5;
fetch { ""screen_name"": $sn, ""followers"": $f };"
209,Which users follow 'Neo4j' and have tweeted more than 500 times? Show the first 3.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.statuses > 500
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has statuses $s;
follows (follower: $u, followed: $me);
$s > 500;
sort $s desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""statuses"": $s };"
210,What are the first 3 tweets that 'Neo4j' has retweeted and were tagged with 'education'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN retweeted.text AS retweeted_tweet
ORDER BY tweet.created_at DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$retweeted isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
tags (tagged_tweet: $retweeted, tag: $h);
sort $ca desc;
limit 3;
fetch { ""retweeted_tweet"": $retweeted.text };"
211,Identify the top 5 users who interact with 'Neo4j' and have a location specified as 'Graphs Are Everywhere'.,"MATCH (u:User)-[:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL AND u.location = 'Graphs Are Everywhere'
RETURN u.screen_name AS user, u.location AS location
ORDER BY count{(u)-[:INTERACTS_WITH]->(me)} DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has location ""Graphs Are Everywhere"";
interacts_with (interactor: $u, target: $me);
reduce $interactions = count($u) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""location"": $u.location };"
212,List the top 5 tweets that include a link and were posted by users following 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$neo4j isa user, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $neo4j);
$t isa tweet, has text $txt, has favorites $fav;
posts (author: $u, content: $t);
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
sort $fav desc;
limit 5;
fetch { ""tweet_text"": $txt, ""favorites"": $fav };"
213,What are the first 3 tweets posted by 'Neo4j' that include a source named 'Buffer'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$source isa source, has source_name ""Buffer"";
posts (author: $me, content: $tweet);
using (tweet_content: $tweet, platform: $source);
sort $ca asc;
limit 3;
fetch { ""text"": $tweet.text };"
215,List the first 3 users who follow 'Neo4j' and have a betweenness score of exactly 349332601.0.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.betweenness = 349332601.0
RETURN u.screen_name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has betweenness 349332601.0;
follows (follower: $u, followed: $me);
limit 3;
fetch { ""screen_name"": $u.screen_name };"
216,Which users followed by 'Neo4j' have posted tweets mentioning 'Neo4j'? Show the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(me)
RETURN u.screen_name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$t isa tweet;
follows (follower: $me, followed: $u);
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
reduce $mentions = count($t) groupby $u;
sort $mentions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""mentions"": $mentions };"
217,What are the top 5 tweets by 'Neo4j' that contain the hashtag 'education' and were created in 2021?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE tweet.created_at >= date('2021-01-01') AND tweet.created_at < date('2022-01-01') 
RETURN tweet.text AS tweet_text, tweet.created_at AS created_at, tweet.favorites AS favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca, has favorites $f;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $h);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $f desc;
limit 5;
fetch { ""tweet_text"": $tweet.text, ""created_at"": $ca, ""favorites"": $f };"
219,List the top 5 users that 'Neo4j' retweeted and who have a following of more than 10000.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)
WHERE u.following > 10000
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $orig);
$u isa user, has screen_name $sn, has following $fg;
posts (author: $u, content: $orig);
$fg > 10000;
sort $fg desc;
limit 5;
fetch { ""screen_name"": $sn, ""following"": $fg };"
220,Which users have a profile image URL and follow 'Neo4j'? Show the first 3.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.profile_image_url IS NOT NULL
RETURN u.screen_name, u.profile_image_url
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has profile_image_url $purl;
follows (follower: $u, followed: $me);
limit 3;
fetch { ""screen_name"": $u.screen_name, ""profile_image_url"": $purl };"
221,List the first 3 tweets that include a link to 'https://twitter.com' and were favorited more than 100 times.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com' AND t.favorites > 100
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link, has link_url $url;
contains (containing_tweet: $t, contained_link: $l);
$url like ""https://twitter.com%"";
$f > 100;
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""favorites"": $f };"
223,Identify the first 3 tweets that 'Neo4j' has retweeted and were posted by users with a profile image URL ending in 'normal.jpg'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)<-[:POSTS]-(user:User)
WHERE user.profile_image_url ENDS WITH 'normal.jpg'
RETURN retweeted_tweet, user
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$retweeted_tweet isa tweet;
$user isa user, has profile_image_url $purl;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
posts (author: $user, content: $retweeted_tweet);
$purl like ""%normal.jpg"";
sort $ca asc;
limit 3;
fetch { ""retweeted_text"": $retweeted_tweet.text, ""user_screen_name"": $user.screen_name };"
224,List the top 5 tweets that 'Neo4j' has mentioned and were created after January 2021.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.created_at >= date('2021-01-01')
RETURN tweet.text AS tweet_text, tweet.created_at
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca, has favorites $f;
posts (author: $me, content: $tweet);
$ca >= 2021-01-01T00:00:00;
sort $f desc;
limit 5;
fetch { ""tweet_text"": $tweet.text, ""created_at"": $ca };"
225,Who are the top 5 users with the highest betweenness?,"MATCH (u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
226,List the first 3 users with the lowest number of followers.,"MATCH (u:User)
WHERE u.followers IS NOT NULL
RETURN u.screen_name, u.followers
ORDER BY u.followers
LIMIT 3","match
$u isa user, has followers $f;
sort $f asc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
227,What are the names of the top 5 users with the most following?,"MATCH (u:User)
RETURN u.name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$u isa user, has following $f;
sort $f desc;
limit 5;
fetch { ""name"": $u.name, ""following"": $f };"
228,Identify the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""favorites"": $f };"
229,Which users follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS follower","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $me);
fetch { ""follower"": $u.screen_name };"
230,What are the first 3 tweets containing the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN t.text AS tweet_text
ORDER BY t.created_at
LIMIT 3","match
$t isa tweet, has created_at $ca;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $t.text };"
231,Who are the first 3 users mentioned in tweets on '2021-03-16'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WHERE t.created_at >= datetime('2021-03-16') AND t.created_at < datetime('2021-03-17') 
RETURN u.name
LIMIT 3","match
$t isa tweet, has created_at $ca;
$u isa user;
mentions (source_tweet: $t, mentioned_user: $u);
$ca >= 2021-03-16T00:00:00;
$ca < 2021-03-17T00:00:00;
limit 3;
fetch { ""name"": $u.name };"
232,List the top 5 tweets by 'Neo4j' based on favorites.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
233,What are the first 3 sources used by the most popular tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, max(t.favorites) AS max_favorites
ORDER BY max_favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$s isa source;
using (tweet_content: $t, platform: $s);
reduce $max_favorites = max($f) groupby $s;
sort $max_favorites desc;
limit 3;
fetch { ""source"": $s.source_name, ""max_favorites"": $max_favorites };"
234,Who are the top 5 users most similar to 'Neo4j' based on the SIMILAR_TO score?,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user;
$sim (source_user: $me, similar_user: $u) isa similar_to, has score $score;
sort $score desc;
limit 5;
fetch { ""user"": $u.name, ""similarity"": $score };"
235,What are the urls for the top 3 links contained in the most retweeted tweets?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WITH l, count{(t)-[:RETWEETS]->(:Tweet)} AS retweets
ORDER BY retweets DESC
LIMIT 3
RETURN l.url","match
$t isa tweet;
$l isa link;
$rt isa tweet;
contains (containing_tweet: $t, contained_link: $l);
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $retweets = count($rt) groupby $l;
sort $retweets desc;
limit 3;
fetch { ""url"": $l.link_url };"
236,Which users are followed by 'neo4j' and have more than 500 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.followers > 500
RETURN u.screen_name, u.followers","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
$f > 500;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
237,List the first 3 tweets retweeted by users located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt.text AS retweeted_tweet
ORDER BY rt.created_at DESC
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$t isa tweet;
$rt isa tweet, has created_at $ca;
posts (author: $u, content: $t);
retweets (retweeting_tweet: $t, original_tweet: $rt);
sort $ca desc;
limit 3;
fetch { ""retweeted_tweet"": $rt.text };"
238,Who are the top 5 users interacting with 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
interacts_with (interactor: $u, target: $me);
reduce $interactions = count($u) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
239,Which tweets mention 'Neo4j' and were created after '2021-01-01'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WHERE t.created_at > date('2021-01-01')
RETURN t","match
$t isa tweet, has created_at $ca;
$u isa user, has name ""Neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
$ca > 2021-01-01T00:00:00;
fetch { ""text"": $t.text, ""created_at"": $ca };"
240,List the first 3 users that 'Neo4j' amplifies.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user.screen_name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$user isa user;
amplifies (amplifier: $me, amplified_user: $user);
limit 3;
fetch { ""screen_name"": $user.screen_name };"
241,What are the first 3 tweets replied to by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN repliedTo.text AS replied_to_tweet
ORDER BY tweet.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $replied_to);
  $tweet has created_at $created_at;
  $replied_to has text $text;
sort $created_at asc;
limit 3;
fetch { ""replied_to_tweet"": $text };"
242,Identify the top 5 hashtags used in tweets from '2020-12-06'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.created_at >= datetime('2020-12-06') AND t.created_at < datetime('2020-12-07') 
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $t isa tweet, has created_at $created_at;
  $created_at >= 2020-12-06T00:00:00;
  $created_at < 2020-12-07T00:00:00;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
243,List the first 3 tweets that link to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text AS tweet_text
LIMIT 3","match
  $t isa tweet, has text $text;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
  $url like ""^https://twitter\\.com.*"";
limit 3;
fetch { ""tweet_text"": $text };"
244,What are the profile images of the top 5 users by followers?,"MATCH (u:User)
WHERE u.profile_image_url IS NOT NULL
RETURN u.profile_image_url AS profile_image
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has profile_image_url $profile_image, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""profile_image"": $profile_image };"
246,List the first 3 tweets with a creation date on '2021-03-16'.,"MATCH (t:Tweet)
WHERE t.created_at >= datetime('2021-03-16') AND t.created_at < datetime('2021-03-17') 
RETURN t
LIMIT 3","match
  $t isa tweet, has created_at $created_at, has tweet_id $id, has text $text;
  $created_at >= 2021-03-16T00:00:00;
  $created_at < 2021-03-17T00:00:00;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text, ""created_at"": $created_at };"
247,Identify the top 5 users by betweenness and name starting with 'N'.,"MATCH (u:User)
WHERE u.name STARTS WITH 'N'
RETURN u.name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has name $name, has betweenness $betweenness;
  $name like ""^N.*"";
sort $betweenness desc;
limit 5;
fetch { ""name"": $name, ""betweenness"": $betweenness };"
248,What are the top 5 links contained in the tweets posted by users with fewer than 100 followers?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE u.followers < 100
RETURN l.url, count(*) as count
ORDER BY count DESC
LIMIT 5","match
  $u isa user, has followers $followers;
  $followers < 100;
  posts (author: $u, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
reduce $count = count($t) groupby $url;
sort $count desc;
limit 5;
fetch { ""url"": $url, ""count"": $count };"
249,Which tweets by 'Neo4j' mention at least one other user?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {(tweet)-[:MENTIONS]->(:User)}
RETURN tweet.text","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $u);
  $tweet has text $text;
fetch { ""text"": $text };"
250,List the first 3 tweets that retweet tweets created on '2020-12-06'.,"MATCH (t1:Tweet)-[:RETWEETS]->(t2:Tweet)
WHERE t2.created_at >= date('2020-12-06') AND t2.created_at < date('2020-12-07') 
RETURN t1
LIMIT 3","match
  $t1 isa tweet, has tweet_id $id, has text $text;
  retweets (retweeting_tweet: $t1, original_tweet: $t2);
  $t2 has created_at $created_at;
  $created_at >= 2020-12-06T00:00:00;
  $created_at < 2020-12-07T00:00:00;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text };"
251,Who are the users that 'Neo4j' mentions in tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
RETURN user.name AS mentioned_user","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $user);
  $user has name $name;
fetch { ""mentioned_user"": $name };"
252,Identify the top 5 tweets with text containing 'critical service'.,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'critical service'
RETURN t
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites, has tweet_id $id;
  $text like "".*critical service.*"";
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
253,List the profile URLs of the top 3 users by betweenness.,"MATCH (u:User)
WHERE u.profile_image_url IS NOT NULL
RETURN u.profile_image_url
ORDER BY u.betweenness DESC
LIMIT 3","match
  $u isa user, has profile_image_url $profile_image_url, has betweenness $betweenness;
sort $betweenness desc;
limit 3;
fetch { ""profile_image_url"": $profile_image_url };"
254,What are the top 5 hashtags in tweets containing the word 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'education'
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $t isa tweet, has text $text;
  $text like "".*education.*"";
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
255,Which users with over 10000 followers are located in 'Graphs Are Everywhere'?,"MATCH (u:User)
WHERE u.followers > 10000 AND u.location = 'Graphs Are Everywhere'
RETURN u.name, u.screen_name, u.followers","match
  $u isa user, has followers $followers, has location ""Graphs Are Everywhere"", has name $name, has screen_name $sn;
  $followers > 10000;
fetch { ""name"": $name, ""screen_name"": $sn, ""followers"": $followers };"
256,List the first 3 tweets posted by 'Neo4j' using the source 'Buffer'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name ""Buffer"";
  $tweet has text $text;
limit 3;
fetch { ""text"": $text };"
257,Identify the top 5 users who have exactly 663 followers.,"MATCH (u:User)
WHERE u.followers = 663
RETURN u.screen_name, u.name
ORDER BY u.screen_name
LIMIT 5","match
  $u isa user, has followers 663, has screen_name $sn, has name $name;
sort $sn asc;
limit 5;
fetch { ""screen_name"": $sn, ""name"": $name };"
258,What are the top 3 tweets by favorites posted from 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $u isa user, has location ""Graphs Are Everywhere"";
  posts (author: $u, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
259,Which users with a profile image URL containing 'horned_reaper' follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.profile_image_url CONTAINS 'horned_reaper'
RETURN u","match
  $u isa user, has profile_image_url $profile_url, has screen_name $sn, has name $name;
  $profile_url like "".*horned_reaper.*"";
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
260,List the first 3 hashtags used in tweets mentioning 'Neo4j'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'Neo4j'
RETURN h.name
LIMIT 3","match
  $t isa tweet, has text $text;
  $text like "".*Neo4j.*"";
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
limit 3;
fetch { ""name"": $name };"
261,Who are the top 5 users followed by 'Neo4j' based on betweenness score?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.betweenness AS betweenness
ORDER BY followed.betweenness DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""user"": $sn, ""betweenness"": $betweenness };"
262,Identify the top 3 tweets that contain links to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text AS tweet_text, l.url AS link_url
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
  $url like ""^https://twitter\\.com.*"";
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""link_url"": $url };"
263,List the first 3 tweets that 'Neo4j' retweets on '2021-03-16'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweet:Tweet)
WHERE tweet.created_at >= datetime('2021-03-16') AND tweet.created_at < datetime('2021-03-17') 
RETURN retweet
ORDER BY retweet.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  $tweet has created_at $created_at;
  $created_at >= 2021-03-16T00:00:00;
  $created_at < 2021-03-17T00:00:00;
  retweets (retweeting_tweet: $tweet, original_tweet: $retweet);
  $retweet has tweet_id $id, has text $text, has created_at $rt_created;
sort $rt_created asc;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text };"
264,What are the top 5 sources used in tweets by users located in 'Sweden'?,"MATCH (u:User {location: 'Sweden'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $u isa user, has location ""Sweden"";
  posts (author: $u, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""source"": $name, ""count"": $count };"
265,List the top 5 users with the highest betweenness.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
266,Find all tweets posted by 'Neo4j' containing a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN t, h","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $t has text $text, has tweet_id $id;
  $h has hashtag_name $hashtag;
fetch { ""tweet_id"": $id, ""text"": $text, ""hashtag"": $hashtag };"
267,Display the first 3 users followed by 'Neo4j' who have more than 10000 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.followers > 10000
RETURN followed.screen_name, followed.followers
ORDER BY followed.followers DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has followers $followers;
  $followers > 10000;
sort $followers desc;
limit 3;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
268,Show the top 5 tweets with the most favorites that were posted using 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  using (tweet_content: $t, platform: $s);
  $s has source_name ""Buffer"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""num_favorites"": $favorites };"
269,Identify the first 3 hashtags used in tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'Neo4j'
RETURN h.name AS hashtag
LIMIT 3","match
  $t isa tweet, has text $text;
  $text like "".*Neo4j.*"";
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
limit 3;
fetch { ""hashtag"": $name };"
270,List all tweets by 'Neo4j' that reply to another tweet.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(replied_to:Tweet)
RETURN t, replied_to","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  reply_to (replying_tweet: $t, original_tweet: $replied_to);
  $t has text $text1, has tweet_id $id1;
  $replied_to has text $text2, has tweet_id $id2;
fetch { ""tweet_id"": $id1, ""tweet_text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
271,Show the top 5 users that 'Neo4j' interacts with based on the number of interactions.,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $me, target: $u) isa interacts_with;
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
272,List the first 3 links contained in tweets posted by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
limit 3;
fetch { ""url"": $url };"
273,Find the top 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
274,Who are the top 3 users most similar to 'Neo4j' based on similarity score?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $u has screen_name $sn;
sort $score desc;
limit 3;
fetch { ""user"": $sn, ""similarity"": $score };"
275,Identify the first 3 tweets by 'Neo4j' that retweet another user's tweets.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(retweeted:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  retweets (retweeting_tweet: $t, original_tweet: $retweeted);
  $t has text $text, has created_at $created_at;
sort $created_at asc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
276,Show all tweets that mention 'Neo4j' and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE exists{ (t)-[:CONTAINS]->(:Link) }
RETURN t","match
  $t isa tweet, has text $text, has tweet_id $id;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  contains (containing_tweet: $t, contained_link: $l);
fetch { ""tweet_id"": $id, ""text"": $text };"
277,List the first 3 users who follow 'Neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
  $u isa user, has location ""Graphs Are Everywhere"", has name $name, has screen_name $sn;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn, ""location"": ""Graphs Are Everywhere"" };"
278,Display the top 5 most recent tweets by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at desc;
limit 5;
fetch { ""text"": $text, ""created_at"": $created_at };"
279,Who are the top 3 users followed by 'Me' with the highest betweenness?,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
  $me isa me;
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 3;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
280,Identify all tweets by 'Neo4j' that mention a user with at least 5000 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
WHERE user.followers >= 5000
RETURN tweet, user","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $user);
  $user has followers $followers, has screen_name $usn, has name $uname;
  $followers >= 5000;
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text, ""mentioned_user"": $usn, ""mentioned_name"": $uname };"
281,Show the first 3 hashtags tagged in tweets that have been retweeted more than 100 times.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 100
RETURN h.name
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
tags (tagged_tweet: $tweet, tag: $hashtag);
limit 3;
fetch {
  ""hashtag"": $hashtag.hashtag_name
};"
282,List the top 5 sources used in tweets posted by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 5;
fetch { ""source"": $name, ""tweet_count"": $count };"
283,Find all tweets by 'Neo4j' that mention 'Me'.,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(me:Me)
RETURN tweet","match
  $neo4j isa me, has screen_name ""neo4j"";
  posts (author: $neo4j, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned isa me;
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
286,Show the first 3 tweets that 'Me' has retweeted.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)
RETURN retweetedTweet.text AS RetweetedTweet
ORDER BY tweet.created_at DESC
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  $tweet has created_at $created_at;
  $retweetedTweet has text $text;
sort $created_at desc;
limit 3;
fetch { ""RetweetedTweet"": $text };"
288,Identify the first 3 users who interact with 'Neo4j' and have a similar location.,"MATCH (me:Me {name: 'Neo4j'})<-[:INTERACTS_WITH]-(u:User)
WHERE u.location IS NOT NULL AND u.location = me.location
WITH u
ORDER BY u.screen_name
LIMIT 3
RETURN u.screen_name AS user, u.location AS location","match
  $me isa me, has name ""Neo4j"", has location $loc;
  interacts_with (interactor: $u, target: $me);
  $u isa user, has screen_name $sn, has location $loc;
sort $sn asc;
limit 3;
fetch { ""user"": $sn, ""location"": $loc };"
289,Show the top 5 tweets by 'Neo4j' that were posted from a location outside 'Graphs Are Everywhere'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE me.location <> 'Graphs Are Everywhere'
RETURN tweet.text, tweet.created_at
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"", has location $loc;
  not { $me has location ""Graphs Are Everywhere""; };
  posts (author: $me, content: $tweet);
  $tweet has text $text, has created_at $created_at, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""created_at"": $created_at };"
290,Who are the top 3 users that 'Neo4j' amplifies the most?,"MATCH (me:Me {screen_name: 'neo4j'})-[a:AMPLIFIES]->(u:User)
RETURN u.screen_name AS user, count(a) AS amplifications
ORDER BY amplifications DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $a (amplifier: $me, amplified_user: $u) isa amplifies;
  $u has screen_name $sn;
reduce $count = count($a) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""amplifications"": $count };"
291,List the first 3 tweets by 'Me' that contain a link.,"MATCH (m:Me)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text, l.url
ORDER BY t.created_at
LIMIT 3","match
  $m isa me;
  posts (author: $m, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $t has text $text, has created_at $created_at;
  $l has link_url $url;
sort $created_at asc;
limit 3;
fetch { ""text"": $text, ""url"": $url };"
292,Find all tweets by 'Neo4j' that were posted on or after '2021-01-01'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= date('2021-01-01')
RETURN t","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has created_at $created_at, has text $text, has tweet_id $id;
  $created_at >= 2021-01-01T00:00:00;
fetch { ""tweet_id"": $id, ""text"": $text, ""created_at"": $created_at };"
293,Display the top 5 users who follow both 'Neo4j' and 'Me'.,"MATCH (u:User)-[:FOLLOWS]->(:User {screen_name: 'neo4j'})
WHERE (u)-[:FOLLOWS]->(:Me)
RETURN u.screen_name, u.name
ORDER BY u.followers DESC
LIMIT 5","match
  $neo4j isa user, has screen_name ""neo4j"";
  $me isa me;
  follows (follower: $u, followed: $neo4j);
  follows (follower: $u, followed: $me);
  $u has screen_name $sn, has name $name, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""name"": $name };"
295,Show all hashtags that have appeared in more than 5 tweets mentioning 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(h:Hashtag)
WITH h, count(tweet) AS tweet_count
WHERE tweet_count > 5
RETURN h.name AS hashtag, tweet_count
ORDER BY tweet_count DESC","match
  $tweet isa tweet, has text $text;
  $text like "".*Neo4j.*"";
  tags (tagged_tweet: $tweet, tag: $tag);
reduce $count = count groupby $tag;
match
  $count > 5;
fetch {
  ""tag"": $tag.hashtag_name,
  ""appearances_with_neo4j"": $count
};"
296,List the top 5 users who have a similar betweenness to 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'}), (u:User)
WHERE u.betweenness IS NOT NULL
WITH me, u
ORDER BY abs(me.betweenness - u.betweenness) 
LIMIT 5
RETURN u.name AS user, u.betweenness AS betweenness","match
$neo4j isa me, has name ""Neo4j"", has betweenness $neo4j_betweenness;
$user isa user, has betweenness $betweenness;
not { $neo4j is $user; };
let $difference = abs($betweenness - $neo4j_betweenness);
sort $difference asc;
limit 5;
fetch {
  ""user"": $user.name
};"
297,Find the first 3 tweets by 'Neo4j' that were favorited more than 300 times.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 300
RETURN t
ORDER BY t.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has favorites $favorites, has created_at $created_at, has text $text, has tweet_id $id;
  $favorites > 300;
sort $created_at asc;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
298,Display all tweets by 'Neo4j' that mention at least two different users.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE size([(tweet)-[:MENTIONS]->(u:User) | u]) >= 2
RETURN tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $u1);
  mentions (source_tweet: $tweet, mentioned_user: $u2);
  not { $u1 is $u2; };
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
299,Identify the first 3 users followed by 'Me' who are located in the same location as 'Me'.,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
WHERE u.location = me.location
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
  $me isa me, has location $loc;
  follows (follower: $me, followed: $u);
  $u has name $name, has screen_name $sn, has location $loc;
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn, ""location"": $loc };"
300,Show the top 5 tweets that 'Me' has replied to.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN repliedTo, tweet
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me;
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has favorites $favorites, has text $text1, has tweet_id $id1;
  $repliedTo has text $text2, has tweet_id $id2;
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id1, ""tweet_text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
302,Find the top 5 tweets by 'Neo4j' that contain the hashtag '#education'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name ""education"";
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
303,Display the first 3 users who mention 'Neo4j' in their tweets and have a similar profile image.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
WHERE u.profile_image_url IS NOT NULL
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.name, u.screen_name, u.profile_image_url, mentions","match
  $u isa user, has name $name, has screen_name $sn, has profile_image_url $img;
  posts (author: $u, content: $t);
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
reduce $count = count($t) groupby $name, $sn, $img;
sort $count desc;
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn, ""profile_image_url"": $img, ""mentions"": $count };"
304,Identify all tweets by 'Neo4j' that were posted using a source other than 'Buffer'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
WHERE source.name <> 'Buffer'
RETURN tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
  not { $source has source_name ""Buffer""; };
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
306,Find all tweets by 'Neo4j' that tag a hashtag and mention a user.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE (t)-[:TAGS]->(:Hashtag) AND (t)-[:MENTIONS]->(:User)
RETURN t","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  mentions (source_tweet: $t, mentioned_user: $u);
  $t has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
307,Display the first 3 users with the highest following who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $following desc;
limit 3;
fetch { ""screen_name"": $sn, ""following"": $following };"
309,Identify the first 3 tweets by 'Neo4j' that contain a link to an external website.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text, l.url
ORDER BY t.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $t has text $text, has created_at $created_at;
  $l has link_url $url;
sort $created_at asc;
limit 3;
fetch { ""text"": $text, ""url"": $url };"
310,Show all tweets that 'Me' has amplified.,"MATCH (me:Me)-[:AMPLIFIES]->(u:User)<-[:POSTS]-(t:Tweet)
RETURN t","match
  $me isa me;
  amplifies (amplifier: $me, amplified_user: $u);
  posts (author: $u, content: $t);
  $t has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
311,List the first 3 hashtags appearing in the latest tweets by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name
ORDER BY t.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $t has created_at $created_at;
  $h has hashtag_name $name;
sort $created_at desc;
limit 3;
fetch { ""name"": $name };"
312,Find the top 5 tweets mentioning 'Neo4j' with the most favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $text like "".*Neo4j.*"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""num_favorites"": $favorites };"
313,Display all tweets by 'Neo4j' that mention a user and contain a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {(tweet)-[:MENTIONS]->(:User)} 
  AND exists {(tweet)-[:TAGS]->(:Hashtag)}
RETURN tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $u);
  tags (tagged_tweet: $tweet, tag: $h);
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
314,Who are the top 3 users with the most statuses who follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has statuses $statuses;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $statuses desc;
limit 3;
fetch { ""screen_name"": $sn, ""statuses"": $statuses };"
315,What are the top 5 users with the highest number of followers?,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
316,Which users follow 'Neo4j' and have more than 500 followers?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.followers > 500
RETURN u.screen_name, u.followers","match
  $u isa user, has screen_name $sn, has followers $followers;
  $followers > 500;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""followers"": $followers };"
317,List the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
318,What are the top 5 tweets by 'Neo4j' based on favorites count?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
319,Who are the top 3 users that 'Neo4j' follows?,"MATCH (me:Me {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.name AS user, followed.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $me isa me, has name ""Neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has name $name, has followers $followers;
sort $followers desc;
limit 3;
fetch { ""user"": $name, ""followers"": $followers };"
320,What are the names of the top 3 hashtags used in tweets?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $t isa tweet;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
321,Which tweets contain links and have more than 100 favorites?,"MATCH (t:Tweet)-[:CONTAINS]->(:Link)
WHERE t.favorites > 100
RETURN t","match
  $t isa tweet, has favorites $favorites, has text $text, has tweet_id $id;
  $favorites > 100;
  contains (containing_tweet: $t, contained_link: $l);
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
322,Who are the top 5 users most similar to 'Neo4j' based on the similarity score?,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $u has name $name;
sort $score desc;
limit 5;
fetch { ""user"": $name, ""similarity"": $score };"
323,What are the top 3 sources used in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""source"": $name, ""tweet_count"": $count };"
324,Which users have a betweenness higher than 1000000?,"MATCH (u:User)
WHERE u.betweenness > 1000000
RETURN u","match
  $u isa user, has screen_name $sn, has name $name, has betweenness $betweenness;
  $betweenness > 1000000;
fetch { ""screen_name"": $sn, ""name"": $name, ""betweenness"": $betweenness };"
325,Find the top 3 users based on the number of statuses they have posted.,"MATCH (u:User)
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has statuses $statuses;
sort $statuses desc;
limit 3;
fetch { ""screen_name"": $sn, ""statuses"": $statuses };"
326,What are the 3 most recent tweets posted by any user?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.created_at AS created_at
ORDER BY t.created_at DESC
LIMIT 3","match
  $u isa user;
  posts (author: $u, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""tweet_text"": $text, ""created_at"": $created_at };"
327,List the top 3 tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
328,Who are the top 5 followers of 'Neo4j' based on the number of statuses they have?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
RETURN follower.screen_name AS follower, follower.statuses AS num_statuses
ORDER BY follower.statuses DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  $follower has screen_name $sn, has statuses $statuses;
sort $statuses desc;
limit 5;
fetch { ""follower"": $sn, ""num_statuses"": $statuses };"
329,What are the top 3 tweets retweeted by other users?,"MATCH (t:Tweet)<-[:RETWEETS]-(retweeted:Tweet)
RETURN t, count(retweeted) AS retweets
ORDER BY retweets DESC
LIMIT 3","match
  $t isa tweet, has text $text, has tweet_id $id;
  retweets (original_tweet: $t, retweeting_tweet: $retweeted);
reduce $count = count($retweeted) groupby $id, $text;
sort $count desc;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text, ""retweets"": $count };"
330,Which users have the highest following to follower ratio?,"MATCH (u:User)
WHERE u.followers IS NOT NULL AND u.following IS NOT NULL
RETURN u.screen_name AS user, 
       toFloat(u.following) / u.followers AS followingToFollowerRatio
ORDER BY followingToFollowerRatio DESC
LIMIT 10","with fun follower_count($user: user) -> integer:
  match follows (followed: $user);
  return count;
with fun follows_count($user: user) -> integer:
  match follows (follower: $user);
  return count;
match
$user isa user;
let $followers = follower_count($user);
let $follows = follows_count($user);
$followers > 0;
$follows > 0;
let $ratio = $follows / $followers;
sort $ratio desc;
limit 10;
fetch {
  ""user"": $user.name,
  ""ratio"": $ratio
};"
331,List the top 5 users based on betweenness centrality.,"MATCH (u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
332,What are the top 3 locations from where the most tweets originate?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL
RETURN u.location, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $u isa user, has location $location;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $location;
sort $count desc;
limit 3;
fetch { ""location"": $location, ""tweet_count"": $count };"
333,Which tweets from 'Neo4j' mention other users and what are these users' screen names?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN tweet.text AS tweet, mentioned.screen_name AS mentioned_user","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $tweet has text $text;
  $mentioned has screen_name $sn;
fetch { ""tweet"": $text, ""mentioned_user"": $sn };"
334,Who are the top 3 users that have interacted with 'Neo4j' the most?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $u, target: $me) isa interacts_with;
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""interactions"": $count };"
336,What are the top 3 hashtags associated with tweets that have been retweeted more than 50 times?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 50
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 50;
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $hashtag_count = count groupby $hashtag;
sort $hashtag_count desc;
limit 3;
fetch {
  ""hashtag"": $hashtag.hashtag_name,
  ""count"": $hashtag_count
};"
338,List the top 3 users with the lowest number of followers who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.followers IS NOT NULL
RETURN u.screen_name, u.followers
ORDER BY u.followers
LIMIT 3","match
  $u isa user, has screen_name $sn, has followers $followers;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $followers asc;
limit 3;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
339,What are the top 3 tweets with the least favorites posted by 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites asc;
limit 3;
fetch { ""tweet_text"": $text, ""num_favorites"": $favorites };"
340,Who are the top 3 users based on the number of users they interact with?,"MATCH (u:User)-[:INTERACTS_WITH]->(other:User)
WITH u, count(other) AS num_interactions
ORDER BY num_interactions DESC
LIMIT 3
RETURN u.name AS user, num_interactions","match
  $u isa user, has name $name;
  interacts_with (interactor: $u, target: $other);
reduce $count = count($other) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""num_interactions"": $count };"
341,What are the top 5 tweets containing the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
342,Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score","match
  $me isa me, has screen_name ""neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $score > 0.5;
  $u has screen_name $sn;
fetch { ""screen_name"": $sn, ""score"": $score };"
343,Who are the top 3 users that 'Neo4j' has amplified?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user.screen_name, user.name
ORDER BY user.followers DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  amplifies (amplifier: $me, amplified_user: $user);
  $user has screen_name $sn, has name $name, has followers $followers;
sort $followers desc;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
344,List the top 5 tweets that contain links and are posted by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  contains (containing_tweet: $tweet, contained_link: $link);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
345,What are the top 3 tweets that 'Neo4j' has retweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)
RETURN retweetedTweet.text AS RetweetedTweet, retweetedTweet.favorites AS Favorites
ORDER BY retweetedTweet.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  $retweetedTweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""RetweetedTweet"": $text, ""Favorites"": $favorites };"
346,Which users have 'Neo4j' mentioned in its tweets the most?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
RETURN u.name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 10","match
  $u isa user, has name $name;
  posts (author: $u, content: $t);
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
reduce $count = count($t) groupby $name;
sort $count desc;
limit 10;
fetch { ""user"": $name, ""mentions"": $count };"
347,List the top 3 tweets from users located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $u isa user, has location ""Graphs Are Everywhere"";
  posts (author: $u, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
348,What are the top 5 tweets by favorites that contain the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
349,Which users follow 'Neo4j' and are from 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
351,Who are the top 3 users that 'Neo4j' retweets mentions from?,"MATCH (me:Me {screen_name: 'neo4j'})-[:RT_MENTIONS]->(user:User)
RETURN user.screen_name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $rt (mentioner: $me, mentioned_user: $user) isa rt_mentions;
  $user has screen_name $sn;
reduce $count = count($rt) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""mentions"": $count };"
352,What are the top 3 tweets by 'Neo4j' that reply to other tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet.text AS tweet, repliedTo.id_str AS in_reply_to
ORDER BY tweet.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has text $text, has favorites $favorites;
  $repliedTo has id_str $id_str;
sort $favorites desc;
limit 3;
fetch { ""tweet"": $text, ""in_reply_to"": $id_str };"
354,What are the names of the top 3 sources from tweets retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  using (tweet_content: $retweetedTweet, platform: $source);
  $source has source_name $name;
reduce $count = count($retweetedTweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""source"": $name, ""count"": $count };"
355,Who are the 3 users with the most tweets that contain the hashtag 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3
RETURN u.name AS user, tweet_count","match
  $u isa user, has name $name;
  posts (author: $u, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""tweet_count"": $count };"
356,List the top 5 tweets that 'Neo4j' has replied to.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN repliedTo, tweet
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has text $text1, has tweet_id $id1, has favorites $favorites;
  $repliedTo has text $text2, has tweet_id $id2;
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id1, ""tweet_text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
357,What are the top 3 tweets tagged with 'education' that have been retweeted by others?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE exists{ (t)<-[:RETWEETS]-(:Tweet) }
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
  retweets (original_tweet: $t, retweeting_tweet: $rt);
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
358,Which users from 'Graphs Are Everywhere' have posted the most tweets?,"MATCH (u:User {location: 'Graphs Are Everywhere'})
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN u.screen_name AS user, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 10","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 10;
fetch { ""user"": $sn, ""num_tweets"": $count };"
359,Which users have a betweenness greater than 300 million?,"MATCH (u:User)
WHERE u.betweenness > 3.0E8
RETURN u.screen_name, u.betweenness","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
  $betweenness > 300000000.0;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
360,List the top 5 users by number of followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
361,Who are the first 3 users that a specific user identified by screen name 'neo4j' follows?,"MATCH (me:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name, followed.name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has name $name;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
362,Find all tweets containing the hashtag 'education' and show the first 5.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text
LIMIT 5","match
  $t isa tweet, has text $text;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
limit 5;
fetch { ""text"": $text };"
363,Which users are mentioned in the tweets posted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN DISTINCT mentioned","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn, has name $name;
fetch { ""screen_name"": $sn, ""name"": $name };"
364,Show the top 3 most recent tweets by date.,"MATCH (t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 3","match
  $t isa tweet, has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
365,Which users have posted tweets with more than 100 favorites?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE t.favorites > 100
RETURN u.screen_name AS user, t.text AS tweet, t.favorites AS favorites","match
  $u isa user, has screen_name $sn;
  posts (author: $u, content: $t);
  $t has favorites $favorites, has text $text;
  $favorites > 100;
fetch { ""user"": $sn, ""tweet"": $text, ""favorites"": $favorites };"
366,List all sources used for tweets and show the first 5.,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN DISTINCT s.name
LIMIT 5","match
  $t isa tweet;
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
limit 5;
fetch { ""name"": $name };"
367,Who are the users that have been retweeted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name AS retweeted_user, retweetedTweet.text AS retweeted_tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  posts (author: $retweetedUser, content: $retweetedTweet);
  $retweetedUser has screen_name $sn;
  $retweetedTweet has text $text;
fetch { ""retweeted_user"": $sn, ""retweeted_tweet"": $text };"
368,Find the top 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
369,What are the top 3 hashtags used in tweets posted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:TAGS]->(hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
370,Which users have the highest betweenness and list the top 5.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
371,Display the first 3 tweets that mention 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
RETURN t.text AS tweet_text
LIMIT 3","match
  $t isa tweet, has text $text;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
limit 3;
fetch { ""tweet_text"": $text };"
372,What are the top 5 locations from where users have tweeted?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL
RETURN u.location, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 5","match
  $u isa user, has location $location;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $location;
sort $count desc;
limit 5;
fetch { ""location"": $location, ""num_tweets"": $count };"
373,List all the tweets that link to a URL containing 'twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'twitter.com'
RETURN t","match
  $t isa tweet, has text $text, has tweet_id $id;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
  $url like "".*twitter\\.com.*"";
fetch { ""tweet_id"": $id, ""text"": $text };"
374,Which users interact most frequently with 'neo4j' and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})<-[i:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $u, target: $me) isa interacts_with;
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
375,Show the tweets that replied to a tweet by 'neo4j' and list the first 3.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:REPLY_TO]-(reply:Tweet)
RETURN reply.text, reply.created_at
ORDER BY reply.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $reply, original_tweet: $tweet);
  $reply has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
376,What are the top 3 tweets by number of retweets?,"MATCH (t:Tweet)
RETURN t.text AS tweet_text, count{(t)<-[:RETWEETS]-(:Tweet)} AS retweets
ORDER BY retweets DESC
LIMIT 3","match
  $t isa tweet, has text $text;
  retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $count = count($rt) groupby $text;
sort $count desc;
limit 3;
fetch { ""tweet_text"": $text, ""retweets"": $count };"
377,Find all tweets from users located in 'Graphs Are Everywhere' and show the first 5.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t
LIMIT 5","match
  $u isa user, has location ""Graphs Are Everywhere"";
  posts (author: $u, content: $t);
  $t has text $text, has tweet_id $id;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text };"
378,Who are the top 5 users similar to 'neo4j' based on the similarity score?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $u has screen_name $sn;
sort $score desc;
limit 5;
fetch { ""similar_user"": $sn, ""similarity"": $score };"
379,List all the links contained in tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
fetch { ""url"": $url };"
380,Find tweets mentioning any user and list the top 5.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
RETURN t.text AS tweet_text, u.screen_name AS mentioned_user
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  mentions (source_tweet: $t, mentioned_user: $u);
  $u has screen_name $sn;
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""mentioned_user"": $sn };"
381,What are the top 3 sources from which 'neo4j' has tweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""source"": $name, ""tweet_count"": $count };"
382,Display the first 3 tweets from 'neo4j' that contain a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag)
RETURN t.text AS tweet_text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $t has text $text;
limit 3;
fetch { ""tweet_text"": $text };"
383,Who are the first 3 users that 'neo4j' has retweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  posts (author: $retweetedUser, content: $retweetedTweet);
  $retweetedUser has screen_name $sn;
limit 3;
fetch { ""screen_name"": $sn };"
384,Find the top 5 users by number of statuses posted.,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses AS status_count
ORDER BY status_count DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has statuses $statuses;
sort $statuses desc;
limit 5;
fetch { ""screen_name"": $sn, ""status_count"": $statuses };"
385,Which tweets from 'neo4j' contain a link to an external website?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN tweet.text, link.url","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  contains (containing_tweet: $tweet, contained_link: $link);
  $tweet has text $text;
  $link has link_url $url;
fetch { ""text"": $text, ""url"": $url };"
386,List the first 3 users followed by 'neo4j' with a betweenness of zero.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.betweenness = 0
RETURN followed.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has betweenness 0.0;
limit 3;
fetch { ""screen_name"": $sn };"
387,Show the tweets with a favorite count between 50 and 100 and list the first 5.,"MATCH (t:Tweet)
WHERE t.favorites >= 50 AND t.favorites <= 100
RETURN t
LIMIT 5","match
  $t isa tweet, has favorites $favorites, has text $text, has tweet_id $id;
  $favorites >= 50;
  $favorites <= 100;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
388,What are the top 5 most active users in terms of tweeting from 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN u.screen_name AS user, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 5","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""num_tweets"": $count };"
389,Which users mentioned by 'neo4j' in tweets have more followers than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.followers > me.followers
RETURN mentioned.screen_name, mentioned.followers","match
  $me isa me, has screen_name ""neo4j"", has followers $me_followers;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn, has followers $m_followers;
  $m_followers > $me_followers;
fetch { ""screen_name"": $sn, ""followers"": $m_followers };"
391,Find the first 3 tweets where 'neo4j' is mentioned and the tweet is a retweet.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE exists{ (t)-[:RETWEETS]->(:Tweet) }
RETURN t
LIMIT 3","match
  $t isa tweet, has text $text, has tweet_id $id;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  retweets (retweeting_tweet: $t, original_tweet: $rt);
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text };"
392,Which users does 'neo4j' interact with the most and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $me, target: $u) isa interacts_with;
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
393,List the first 3 users similar to 'neo4j' with a similarity score above 0.5.,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score
ORDER BY s.score DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $score > 0.5;
  $u has screen_name $sn;
sort $score desc;
limit 3;
fetch { ""screen_name"": $sn, ""score"": $score };"
394,Show the top 5 users that have posted tweets using the source 'Buffer'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN u.screen_name AS user, count(t) AS tweets
ORDER BY tweets DESC
LIMIT 5","match
  $u isa user, has screen_name $sn;
  posts (author: $u, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name ""Buffer"";
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""tweets"": $count };"
395,Which tweets have been retweeted by 'neo4j' and contain a hashtag?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)-[:TAGS]->(:Hashtag)
RETURN retweetedTweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  tags (tagged_tweet: $retweetedTweet, tag: $h);
  $retweetedTweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
396,"List the first 3 tweets from users who follow more than 10,000 users.","MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.following > 10000
RETURN u.screen_name, t.text
ORDER BY t.created_at
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $following > 10000;
  posts (author: $u, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at asc;
limit 3;
fetch { ""screen_name"": $sn, ""text"": $text };"
397,Show the first 3 users followed by 'neo4j' who also follow 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)-[:FOLLOWS]->(me)
RETURN follower
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  follows (follower: $me, followed: $follower);
  $follower has screen_name $sn, has name $name;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
398,What are the top 5 tweets by 'neo4j' with the most replies?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {(tweet)<-[:REPLY_TO]-(:Tweet)}
WITH tweet, count{(tweet)<-[:REPLY_TO]-(:Tweet)} AS replies
RETURN tweet.text AS tweet, replies
ORDER BY replies DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $reply, original_tweet: $tweet);
  $tweet has text $text;
reduce $count = count($reply) groupby $text;
sort $count desc;
limit 5;
fetch { ""tweet"": $text, ""replies"": $count };"
399,Find all users who follow 'neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
400,Which tweets posted by 'neo4j' have been retweeted by other users?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)<-[:RETWEETS]-(:Tweet) }
RETURN tweet.text, tweet.created_at
ORDER BY tweet.created_at DESC","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  $tweet has text $text, has created_at $created_at;
sort $created_at desc;
fetch { ""text"": $text, ""created_at"": $created_at };"
401,Show the top 5 tweets that reply to another tweet and contain a link.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE exists{ (t)-[:CONTAINS]->(:Link) }
RETURN t.text AS tweet_text, t.created_at AS created_at
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has created_at $created_at, has favorites $favorites;
  reply_to (replying_tweet: $t, original_tweet: $orig);
  contains (containing_tweet: $t, contained_link: $l);
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""created_at"": $created_at };"
402,Find the first 3 users who follow 'neo4j' and have a betweenness greater than 100 million.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.betweenness > 1E8
RETURN u
LIMIT 3","match
  $u isa user, has screen_name $sn, has name $name, has betweenness $betweenness;
  $betweenness > 100000000.0;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
403,List the first 3 tweets by 'neo4j' that have been tagged with a hashtag and mention another user.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:TAGS]->(:Hashtag) } 
  AND exists{ (tweet)-[:MENTIONS]->(:User) }
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $h);
  mentions (source_tweet: $tweet, mentioned_user: $u);
  $tweet has text $text;
limit 3;
fetch { ""text"": $text };"
404,Which users followed by 'neo4j' have posted tweets mentioning 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(follower:User)-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(me) 
RETURN follower.screen_name AS follower, tweet.text AS tweet","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $follower);
  posts (author: $follower, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $me);
  $follower has screen_name $sn;
  $tweet has text $text;
fetch { ""follower"": $sn, ""tweet"": $text };"
405,Show the tweets that 'neo4j' has retweeted from users with a lower follower count.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)<-[:POSTS]-(user:User)
WHERE user.followers < me.followers
RETURN user.screen_name, retweeted.text","match
  $me isa me, has screen_name ""neo4j"", has followers $me_followers;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
  posts (author: $user, content: $retweeted);
  $user has screen_name $sn, has followers $u_followers;
  $u_followers < $me_followers;
  $retweeted has text $text;
fetch { ""screen_name"": $sn, ""text"": $text };"
406,What are the top 5 locations of users who interact with 'neo4j'?,"MATCH (u:User)-[:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL
RETURN u.location, count(*) AS num_users
ORDER BY num_users DESC
LIMIT 5","match
  $u isa user, has location $location;
  $me isa me, has screen_name ""neo4j"";
  interacts_with (interactor: $u, target: $me);
reduce $count = count($u) groupby $location;
sort $count desc;
limit 5;
fetch { ""location"": $location, ""num_users"": $count };"
408,Find the first 3 users who have retweeted tweets posted by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
RETURN DISTINCT retweeter.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
  posts (author: $retweeter, content: $retweet);
  $retweeter has screen_name $sn;
limit 3;
fetch { ""screen_name"": $sn };"
409,Which tweets posted by 'neo4j' mention a user with a follower count greater than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.followers > me.followers
RETURN tweet.text, mentioned.screen_name, mentioned.followers","match
  $me isa me, has screen_name ""neo4j"", has followers $me_followers;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn, has followers $m_followers;
  $m_followers > $me_followers;
  $tweet has text $text;
fetch { ""text"": $text, ""screen_name"": $sn, ""followers"": $m_followers };"
410,Display the first 3 tweets by 'neo4j' that use the source 'Buffer'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name ""Buffer"";
  $tweet has text $text;
limit 3;
fetch { ""text"": $text };"
411,Who are the top 5 users followed by 'neo4j' with the highest betweenness?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.betweenness AS betweenness
ORDER BY followed.betweenness DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""user"": $sn, ""betweenness"": $betweenness };"
412,List the first 3 tweets where 'neo4j' is mentioned and the tweet has been favorited more than 50 times.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.favorites > 50
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $favorites > 50;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
413,What are the top 5 hashtags in tweets retweeted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  tags (tagged_tweet: $retweetedTweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($retweetedTweet) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
414,Find all tweets from users who follow 'neo4j' and list the top 5.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$neo4j isa user, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $neo4j);
$t isa tweet, has text $txt, has favorites $fav;
posts (author: $u, content: $t);
sort $fav desc;
limit 5;
fetch { ""text"": $txt, ""favorites"": $fav };"
415,Which users followed by 'neo4j' have a higher status count than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > me.statuses
RETURN u.screen_name, u.statuses","match
  $me isa me, has screen_name ""neo4j"", has statuses $me_statuses;
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has statuses $u_statuses;
  $u_statuses > $me_statuses;
fetch { ""screen_name"": $sn, ""statuses"": $u_statuses };"
416,Show the first 3 tweets from users who have interacted with 'neo4j'.,"MATCH (u:User)-[:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN u.screen_name, t.text
ORDER BY t.created_at
LIMIT 3","match
  $u isa user, has screen_name $sn;
  $me isa me, has screen_name ""neo4j"";
  interacts_with (interactor: $u, target: $me);
  posts (author: $u, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at asc;
limit 3;
fetch { ""screen_name"": $sn, ""text"": $text };"
417,List the first 3 users similar to 'neo4j' with a similarity score below 0.5.,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score < 0.5
RETURN u.screen_name, s.score
ORDER BY s.score
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $score < 0.5;
  $u has screen_name $sn;
sort $score asc;
limit 3;
fetch { ""screen_name"": $sn, ""score"": $score };"
418,Which tweets posted by 'neo4j' have been tagged with 'education'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet.text","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name ""education"";
  $tweet has text $text;
fetch { ""text"": $text };"
420,Find the first 3 tweets by 'neo4j' that reply to another tweet.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(replied_to:Tweet)
RETURN t, replied_to
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  reply_to (replying_tweet: $t, original_tweet: $replied_to);
  $t has text $text1, has tweet_id $id1;
  $replied_to has text $text2, has tweet_id $id2;
limit 3;
fetch { ""tweet_id"": $id1, ""text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
421,Who are the top 5 users that 'neo4j' mentions the most in tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.screen_name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn;
reduce $count = count($tweet) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""mentions"": $count };"
422,List all tweets by 'neo4j' that have more than 200 favorites and show the first 5.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 200
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has favorites $favorites;
  $favorites > 200;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
423,Which users does 'neo4j' amplify the most and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})-[a:AMPLIFIES]->(u:User)
RETURN u.screen_name AS user, count(a) AS amplifications
ORDER BY amplifications DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $a (amplifier: $me, amplified_user: $u) isa amplifies;
  $u has screen_name $sn;
reduce $count = count($a) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""amplifications"": $count };"
424,Find the first 3 users who have mentioned 'neo4j' in tweets and follow 'neo4j'.,"MATCH (u:User)-[:MENTIONS]->(:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(u)
RETURN u.name, u.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $u isa user, has name $name, has screen_name $sn;
  mentions (source_tweet: $t, mentioned_user: $me);
  posts (author: $u, content: $t);
  follows (follower: $u, followed: $me);
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn };"
426,Who are the top 5 users that 'neo4j' retweets the most?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name AS retweeted_user, count(*) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  posts (author: $retweetedUser, content: $retweetedTweet);
  $retweetedUser has screen_name $sn;
reduce $count = count($tweet) groupby $sn;
sort $count desc;
limit 5;
fetch { ""retweeted_user"": $sn, ""retweet_count"": $count };"
427,Show the tweets where 'neo4j' is mentioned and the tweet has a favorite count over 100.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'}) 
WHERE t.favorites > 100
RETURN t","match
  $t isa tweet, has text $text, has tweet_id $id, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $favorites > 100;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
428,Find all users who mention 'neo4j' in their tweets and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
  posts (author: $u, content: $t);
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
429,Which tweets by 'neo4j' have been retweeted more than 50 times?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.favorites > 50
RETURN tweet.text, tweet.favorites","match
$me isa me, has screen_name ""neo4j"";
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 50;
fetch {
  ""tweet"": $tweet.text,
  ""retweets"": $count
};"
430,List the first 3 users followed by 'neo4j' who have posted a tweet with more than 50 favorites.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)-[:POSTS]->(tweet:Tweet)
WHERE tweet.favorites > 50
RETURN followed.screen_name, tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  posts (author: $followed, content: $tweet);
  $tweet has favorites $favorites, has text $text;
  $favorites > 50;
  $followed has screen_name $sn;
sort $favorites desc;
limit 3;
fetch { ""screen_name"": $sn, ""text"": $text, ""favorites"": $favorites };"
432,Find the first 3 users who have amplified tweets posted by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:AMPLIFIES]-(user:User)
RETURN user.screen_name, user.name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $rt);
$user isa user, has screen_name $sn, has name $n;
posts (author: $user, content: $rt);
limit 3;
fetch { ""screen_name"": $sn, ""name"": $n };"
433,What are the top 5 sources used in tweets that mention 'neo4j'?,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'}), 
      (t)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
  $t isa tweet;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""source"": $name, ""tweet_count"": $count };"
434,List all tweets by 'neo4j' that reply to another tweet and contain a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE EXISTS {(t)-[:REPLY_TO]->(:Tweet)}
  AND EXISTS {(t)-[:TAGS]->(:Hashtag)}
RETURN t","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  reply_to (replying_tweet: $t, original_tweet: $rt);
  tags (tagged_tweet: $t, tag: $h);
  $t has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
436,Show the first 3 tweets from 'neo4j' that have been amplified by other users.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)<-[:RETWEETS]-(:Tweet) }
RETURN tweet.text, tweet.created_at
ORDER BY tweet.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  $tweet has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
438,Which users followed by 'neo4j' have a location of 'Graphs Are Everywhere' and list the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.screen_name, u.location
ORDER BY u.followers DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  $u has location ""Graphs Are Everywhere"", has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""location"": ""Graphs Are Everywhere"" };"
439,List the first 3 users who follow 'neo4j' and have been mentioned in tweets by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
WHERE EXISTS {
  (me)-[:POSTS]->(:Tweet)-[:MENTIONS]->(follower)
}
RETURN follower.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $follower);
  $follower has screen_name $sn;
limit 3;
fetch { ""screen_name"": $sn };"
441,Find all tweets that 'neo4j' has retweeted from users located in 'Graphs Are Everywhere' and show the first 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)<-[:POSTS]-(user:User {location: 'Graphs Are Everywhere'})
RETURN retweeted_tweet.text, user.screen_name
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
  posts (author: $user, content: $retweeted_tweet);
  $user has location ""Graphs Are Everywhere"", has screen_name $sn;
  $retweeted_tweet has text $text;
limit 5;
fetch { ""text"": $text, ""screen_name"": $sn };"
442,Which users followed by 'neo4j' have tweeted using the source 'Buffer' and list the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN u.screen_name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  posts (author: $u, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name ""Buffer"";
  $u has screen_name $sn;
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 5;
fetch { ""screen_name"": $sn, ""tweet_count"": $count };"
443,List the first 3 tweets from 'neo4j' that contain links to external websites.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text, l.url
ORDER BY t.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $t has text $text, has created_at $created_at;
  $l has link_url $url;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""url"": $url };"
444,What are the names of the top 5 users with the highest number of followers?,"MATCH (u:User)
RETURN u.name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has name $name, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""name"": $name, ""followers"": $followers };"
445,List the top 3 tweets with the most favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
446,Which users are followed by 'Neo4j' and have more than 1000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.followers > 1000
RETURN u.screen_name, u.followers","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has followers $followers;
  $followers > 1000;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
447,Find the top 5 users with the highest betweenness centrality.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
448,Who are the top 3 users that 'Neo4j' interacts with most frequently?,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $me, target: $u) isa interacts_with;
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""interactions"": $count };"
449,What are the names of the top 3 hashtags used in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
450,Which sources are used in the top 5 most favorited tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
WITH t, s
ORDER BY t.favorites DESC
LIMIT 5
RETURN DISTINCT s.name AS source","match
  $t isa tweet, has favorites $favorites;
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
sort $favorites desc;
limit 5;
fetch { ""source"": $name };"
451,List the top 3 tweets that mention 'Neo4j' and have more than 100 favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.favorites > 100
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $favorites > 100;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
452,What are the locations of the top 5 users by number of statuses posted?,"MATCH (u:User)
WHERE u.location IS NOT NULL
RETURN u.location, u.statuses
ORDER BY u.statuses DESC
LIMIT 5","match
  $u isa user, has location $location, has statuses $statuses;
sort $statuses desc;
limit 5;
fetch { ""location"": $location, ""statuses"": $statuses };"
453,Who has 'Neo4j' retweeted the most? List the top 3 users.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweet:Tweet)<-[:POSTS]-(user:User)
RETURN user.screen_name AS retweeted_user, count(*) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweet);
  posts (author: $user, content: $retweet);
  $user has screen_name $sn;
reduce $count = count($tweet) groupby $sn;
sort $count desc;
limit 3;
fetch { ""retweeted_user"": $sn, ""retweet_count"": $count };"
454,Find the top 5 tweets with links and sort them by number of favorites.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has tweet_id $id, has favorites $favorites;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text, ""url"": $url, ""favorites"": $favorites };"
455,What are the screen names of the top 3 users who have posted the most tweets?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3
RETURN u.screen_name AS screen_name, tweet_count","match
  $u isa user, has screen_name $sn;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 3;
fetch { ""screen_name"": $sn, ""tweet_count"": $count };"
456,Which hashtags have been tagged in tweets that have more than 200 favorites? List the top 3.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 200
RETURN h.name AS hashtag, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $t isa tweet, has favorites $favorites;
  $favorites > 200;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""tweet_count"": $count };"
457,List the top 3 users with the lowest following counts who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.following IS NOT NULL
RETURN u.screen_name, u.following
ORDER BY u.following
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $following asc;
limit 3;
fetch { ""screen_name"": $sn, ""following"": $following };"
458,Which users have a similar score greater than 0.5 with 'Neo4j'? List the top 3.,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.name, s.score
ORDER BY s.score DESC
LIMIT 3","match
  $me isa me, has name ""Neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $score > 0.5;
  $u has name $name;
sort $score desc;
limit 3;
fetch { ""name"": $name, ""score"": $score };"
459,Who are the top 5 most followed users that 'Neo4j' amplifies?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)
RETURN u.screen_name AS user, u.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  amplifies (amplifier: $me, amplified_user: $u);
  $u has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""user"": $sn, ""followerCount"": $followers };"
460,List the profile image URLs of the top 3 users who have mentioned 'Neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.profile_image_url","match
  $u isa user, has profile_image_url $img;
  posts (author: $u, content: $t);
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
reduce $count = count($t) groupby $img;
sort $count desc;
limit 3;
fetch { ""profile_image_url"": $img };"
461,What are the URLs of the top 3 most favorited tweets containing links?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS url, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has favorites $favorites;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
sort $favorites desc;
limit 3;
fetch { ""url"": $url, ""favorites"": $favorites };"
462,Who are the top 3 followers of 'Neo4j' based on betweenness centrality?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
WHERE follower.betweenness IS NOT NULL
RETURN follower.screen_name AS follower, follower.betweenness AS betweenness
ORDER BY follower.betweenness DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  $follower has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 3;
fetch { ""follower"": $sn, ""betweenness"": $betweenness };"
463,List the names of the top 5 tweets that reply to another tweet and have more than 50 favorites.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE t.favorites > 50
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  $favorites > 50;
  reply_to (replying_tweet: $t, original_tweet: $rt);
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text };"
464,What are the top 3 locations where users who interact with 'Neo4j' are based?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
WHERE u.location IS NOT NULL
RETURN u.location, count(*) AS num_users
ORDER BY num_users DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  interacts_with (interactor: $u, target: $me);
  $u has location $location;
reduce $count = count($u) groupby $location;
sort $count desc;
limit 3;
fetch { ""location"": $location, ""num_users"": $count };"
465,Which users followed by 'Neo4j' have posted the most about a specific hashtag? List the top 3.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE h.name = 'education'
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3
RETURN u.screen_name AS user, tweet_count","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  posts (author: $u, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
  $u has screen_name $sn;
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""tweet_count"": $count };"
466,Find the top 5 tweets by 'Neo4j' using a specific source.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN tweet.text AS tweet, source.name AS source
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $tweet has text $text, has favorites $favorites;
  $source has source_name $name;
sort $favorites desc;
limit 5;
fetch { ""tweet"": $text, ""source"": $name };"
467,What are the top 3 hashtags used in the tweets that have been retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  tags (tagged_tweet: $retweetedTweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($retweetedTweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
468,List the top 3 tweets from 'Neo4j' that have been retweeted more than 100 times.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.favorites > 100
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
sort $count desc;
limit 3;
fetch {
  ""tweet"": $tweet.text,
  ""retweets"": $count
};"
469,Which users have 'Neo4j' mentioned the most in tweets? List the top 3.,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)<-[:POSTS]-(:Me {name: 'Neo4j'})
RETURN u.name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $me isa me, has name ""Neo4j"";
  posts (author: $me, content: $t);
  mentions (source_tweet: $t, mentioned_user: $u);
  $u has name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""mentions"": $count };"
470,Find the top 5 users who follow 'Neo4j' and are from the same location as 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL AND u.location = 'Graphs Are Everywhere'
RETURN u.screen_name, u.name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name, has followers $followers;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""name"": $name, ""followers"": $followers };"
471,List the names of the top 5 users who have the highest scores of being similar to 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.name AS name, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  $s (source_user: $u, similar_user: $me) isa similar_to, has score $score;
  $u has name $name;
sort $score desc;
limit 5;
fetch { ""name"": $name, ""similarity"": $score };"
472,Who are the top 3 users that 'Neo4j' follows and have tweeted more than 500 times?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > 500
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has statuses $statuses;
  $statuses > 500;
sort $statuses desc;
limit 3;
fetch { ""screen_name"": $sn, ""statuses"": $statuses };"
473,Who are the top 5 users that a specific user named 'Neo4j' follows?,"MATCH (me:User {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.name, followed.screen_name, followed.followers
ORDER BY followed.followers DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has name $name, has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""name"": $name, ""screen_name"": $sn, ""followers"": $followers };"
474,List the first 3 users followed by a user with the screen name 'thobe'.,"MATCH (u:User {screen_name: 'thobe'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name, followed.name
LIMIT 3","match
  $u isa user, has screen_name ""thobe"";
  follows (follower: $u, followed: $followed);
  $followed has screen_name $sn, has name $name;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
475,What are the top 3 tweets posted by the user with the screen name 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
476,Which users have a betweenness greater than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u","match
  $u isa user, has screen_name $sn, has name $name, has betweenness $betweenness;
  $betweenness > 300000000;
fetch { ""screen_name"": $sn, ""name"": $name, ""betweenness"": $betweenness };"
477,Identify the first 3 users followed by 'Neo4j' who have more than 500 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.followers > 500
RETURN followed.screen_name, followed.followers
ORDER BY followed.followers DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has followers $followers;
  $followers > 500;
sort $followers desc;
limit 3;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
478,List the top 5 tweets that mention the user with the screen name 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
479,What are the top 5 hashtags used in tweets by the user named 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
480,List the first 3 sources used in tweets posted by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN DISTINCT s.name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
limit 3;
fetch { ""name"": $name };"
481,Who are the top 5 users interacting with 'Neo4j' via the INTERACTS_WITH relationship?,"MATCH (u:User)-[i:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $u, target: $me) isa interacts_with;
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
482,Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score","match
  $me isa me, has screen_name ""neo4j"";
  $s (source_user: $me, similar_user: $u) isa similar_to, has score $score;
  $score > 0.5;
  $u has screen_name $sn;
fetch { ""screen_name"": $sn, ""score"": $score };"
483,Show the first 3 tweets that 'Neo4j' retweets.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)
RETURN retweetedTweet.text AS retweeted_tweet_text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  $retweetedTweet has text $text;
limit 3;
fetch { ""retweeted_tweet_text"": $text };"
484,Which users are amplified by 'Me' according to the AMPLIFIES relationship?,"MATCH (me:Me)-[:AMPLIFIES]->(u:User)
RETURN u.name AS user, u.screen_name AS handle","match
  $me isa me;
  amplifies (amplifier: $me, amplified_user: $u);
  $u has name $name, has screen_name $sn;
fetch { ""user"": $name, ""handle"": $sn };"
485,List the top 3 users who follow 'Me' and also have a following count over 10000.,"MATCH (u:User)-[:FOLLOWS]->(:Me)
WHERE u.following > 10000
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $following > 10000;
  $me isa me;
  follows (follower: $u, followed: $me);
sort $following desc;
limit 3;
fetch { ""screen_name"": $sn, ""following"": $following };"
486,Who are the top 3 users mentioned in tweets posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""mentions"": $count };"
487,What are the first 3 links contained in tweets posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN link.url
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  contains (containing_tweet: $tweet, contained_link: $link);
  $link has link_url $url;
limit 3;
fetch { ""url"": $url };"
488,Identify the first 3 tweets posted by 'Me' that reply to another tweet.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet, repliedTo
ORDER BY tweet.created_at
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has text $text1, has tweet_id $id1, has created_at $created_at;
  $repliedTo has text $text2, has tweet_id $id2;
sort $created_at asc;
limit 3;
fetch { ""tweet_id"": $id1, ""text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
489,List the top 5 tweets by 'Me' using a specific source named 'Buffer'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me;
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name ""Buffer"";
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
490,Which users does 'Neo4j' follow that have a location set to 'Graphs Are Everywhere'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(user:User)
WHERE user.location = 'Graphs Are Everywhere'
RETURN user","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $user);
  $user has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
fetch { ""screen_name"": $sn, ""name"": $name };"
491,List the first 3 tweets containing a hashtag named 'education'.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN t.text AS tweet_text
LIMIT 3","match
  $t isa tweet, has text $text;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
limit 3;
fetch { ""tweet_text"": $text };"
492,Who are the top 5 users that 'Neo4j' interacts with and also follows?,"MATCH (me:Me {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(u:User)
WHERE (me)-[:FOLLOWS]->(u)
RETURN u.screen_name as user, count(u) as interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i (interactor: $me, target: $u) isa interacts_with;
  follows (follower: $me, followed: $u);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
42,List the top 3 tweets that retweet content from Neo4j.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)
WHERE me.screen_name IS NOT NULL
RETURN tweet.text AS tweet_text, retweeted.text AS retweeted_text, tweet.favorites AS favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$original_tweet isa tweet;
$retweeting_tweet isa tweet, has favorites $f;
posts (author: $me, content: $original_tweet);
retweets (original_tweet: $original_tweet, retweeting_tweet: $retweeting_tweet);
sort $f desc;
limit 3;
fetch { ""tweet_text"": $retweeting_tweet.text, ""retweeted_text"": $original_tweet.text, ""favorites"": $f };"
44,Find the top 5 tweets by Neo4j that have been retweeted and mention another user.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:MENTIONS]->(:User) }
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
$mentioned isa user;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
75,Identify the top 3 users who have amplified the most tweets.,"MATCH (u:User)<-[:AMPLIFIES]-(me:Me)
WITH u, count(me) AS amplifications
ORDER BY amplifications DESC
LIMIT 3
RETURN u.name AS user, amplifications","match
$me isa me, has name $n;
amplifies (amplifier: $me, amplified_user: $u);
reduce $count = count($u) groupby $n;
sort $count desc;
limit 3;
fetch { ""user"": $n, ""amplifications"": $count };"
77,List the first 3 tweets that mention the user with the highest betweenness.,"MATCH (u:User)-[:MENTIONS]-(t:Tweet)
WHERE u.betweenness IS NOT NULL
WITH u, t
ORDER BY u.betweenness DESC
LIMIT 1
MATCH (t2:Tweet)-[:MENTIONS]->(u) 
RETURN t2.text
LIMIT 3","with fun max_betweenness() -> double:
  match $u isa user, has betweenness $b;
  return max($b);
match
$u isa user, has betweenness $b;
$b == max_betweenness();
$t isa tweet;
mentions (source_tweet: $t, mentioned_user: $u);
limit 3;
fetch { ""text"": $t.text };"
101,Which users have retweeted 'neo4j''s tweets the most?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
RETURN retweeter.screen_name AS retweeter, count(*) AS retweets
ORDER BY retweets DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
reduce $retweets = count($retweet) groupby $retweeter;
sort $retweets desc;
limit 10;
fetch { ""retweeter"": $retweeter.screen_name, ""retweets"": $retweets };"
106,What are the profile URLs of the top 3 users followed by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.profile_image_url
ORDER BY followed.followers DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 3;
fetch { ""url"": $followed.url };"
114,Find the top 3 tweets with the most retweets made by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists{ (t)-[:RETWEETS]->(:Tweet) }
RETURN t.text AS tweet_text, count{(t)-[:RETWEETS]->(:Tweet)} AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$rt isa tweet;
posts (author: $u, content: $t);
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $retweet_count = count($rt) groupby $t;
sort $retweet_count desc;
limit 3;
fetch { ""tweet_text"": $t.text, ""retweet_count"": $retweet_count };"
118,What are the locations of the top 3 users who interact with 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
WHERE u.location IS NOT NULL
RETURN u.location AS location, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has location $loc;
$i isa interacts_with (interactor: $u, target: $me);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""location"": $u.location, ""interactions"": $interactions };"
129,Which tweets by 'neo4j' have been retweeted and also contain a link?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:CONTAINS]->(:Link) }
RETURN tweet.text, tweet.created_at","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$l isa link;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet);
contains (containing_tweet: $tweet, contained_link: $l);
fetch { ""text"": $tweet.text, ""created_at"": $tweet.created_at };"
136,List the tweets by 'neo4j' that have been retweeted by more than 5 different users.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE count{(tweet)<-[:RETWEETS]-(:Tweet)<-[:POSTS]-(:User)} > 5
RETURN tweet.text, count{(tweet)<-[:RETWEETS]-(:Tweet)<-[:POSTS]-(:User)} AS retweets","with fun retweeting_users($tweet: tweet) -> integer:
  match
    retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
    posts (author: $retweeter, content: $retweet);
  select $retweeter;
  distinct;
  return count;
match
$me isa user, has screen_name ""neo4j"";
posts (author: $me, content: $tweet);
let $count = retweeting_users($tweet);
$count > 5;
fetch {
  ""tweet_text"": $tweet.text,
  ""retweets"": $count
};"
138,Find the top 3 tweets that mention 'neo4j' and are tagged with 'education'.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE t.text CONTAINS 'neo4j'
RETURN t
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
163,Identify the top 5 tweets linking to the most popular external sources.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WITH t, l.url AS url, count(*) AS link_count
ORDER BY link_count DESC
LIMIT 5
RETURN t.text AS tweet_text, url, link_count","with fun link_popularity($link: link) -> integer:
  match contains (contained_link: $link);
  return count;
match
$t isa tweet;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
let $link_count = link_popularity($l);
sort $link_count desc;
limit 5;
fetch { ""tweet_text"": $t.text, ""url"": $l.link_url, ""link_count"": $link_count };"
174,Which users are most similar to 'Neo4j' based on the SIMILAR_TO relationship score? Show the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 5;
fetch { ""similar_user"": $u.screen_name, ""similarity"": $sc };"
181,What are the top 5 sources used in tweets that have been retweeted more than 50 times?,"MATCH (t:Tweet)-[:USING]->(s:Source)
WHERE t.favorites > 50
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
$t isa tweet;
$s isa source;
using (tweet_content: $t, platform: $s);
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $retweet_count = count($rt) groupby $t, $s;
match $retweet_count > 50;
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 5;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
200,Which users have retweeted 'Neo4j' and have a profile image URL? List the first 3.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)<-[:RETWEETS]-(retweeter:User)
WHERE retweeter.profile_image_url IS NOT NULL
RETURN retweeter.screen_name, retweeter.profile_image_url
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$original_tweet isa tweet;
$rt isa tweet;
$retweeter isa user, has profile_image_url $purl;
posts (author: $me, content: $original_tweet);
retweets (original_tweet: $original_tweet, retweeting_tweet: $rt);
posts (author: $retweeter, content: $rt);
limit 3;
fetch { ""screen_name"": $retweeter.screen_name, ""profile_image_url"": $purl };"
214,Identify the top 5 hashtags used in tweets that mention 'Neo4j' and were created in 2021.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'Neo4j' AND date(t.created_at) >= date('2021-01-01')
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$t isa tweet, has text $txt, has created_at $ca;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
reduce $count = count($t) groupby $h;
sort $count desc;
limit 5;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
218,Identify the first 3 tweets that 'Neo4j' has amplified and were posted in 2021.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:MENTIONS]-(t:Tweet)
WHERE t.created_at >= date('2021-01-01') AND t.created_at < date('2022-01-01') 
RETURN t
ORDER BY t.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$original isa tweet, has created_at $ca;
$retweet isa tweet;
posts (author: $me, content: $retweet);
retweets (retweeting_tweet: $retweet, original_tweet: $original);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""text"": $original.text, ""created_at"": $ca };"
245,Which users with a location of 'Sweden' follow more than 10 users?,"MATCH (u:User)
WHERE u.location = 'Sweden' AND count{(u)-[:FOLLOWS]->(:User)} > 10
RETURN u","match
  $u isa user, has location ""Sweden"";
  follows (follower: $u, followed: $f);
reduce $count = count($f) groupby $u;
match $count > 10;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""following_count"": $count };"
284,Display the first 3 tweets by 'Neo4j' that were amplified by 'Me'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User {screen_name: 'Neo4j'})<-[:POSTS]-(t:Tweet)
RETURN t.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $u isa user, has screen_name ""Neo4j"";
  amplifies (amplifier: $me, amplified_user: $u);
  posts (author: $u, content: $t);
limit 3;
fetch { ""text"": $t.text };"
287,List all users who have both posted a tweet mentioning 'Neo4j' and have been mentioned by 'Neo4j' in a tweet.,"MATCH (u:User)
WHERE exists{ (u)-[:POSTS]->(:Tweet)-[:TAGS]->(:Hashtag {name: 'Neo4j'}) } 
  AND exists{ (:Tweet)-[:MENTIONS]->(u)<-[:POSTS]-(:Me {screen_name: 'neo4j'}) }
RETURN u","match
  $u isa user, has screen_name $sn, has name $name;
  $neo4j isa user, has screen_name ""neo4j"";
  posts (author: $u, content: $ut);
  mentions (source_tweet: $ut, mentioned_user: $neo4j);
  posts (author: $neo4j, content: $nt);
  mentions (source_tweet: $nt, mentioned_user: $u);
fetch { ""screen_name"": $sn, ""name"": $name };"
301,List all users who have been retweeted by 'Neo4j' at least twice.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)<-[:POSTS]-(user:User)
WITH user, count(retweeted) AS retweet_count
WHERE retweet_count >= 2
RETURN user.screen_name, retweet_count","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
  posts (author: $user, content: $retweeted);
  $user has screen_name $sn;
reduce $count = count($retweeted) groupby $user, $sn;
match $count >= 2;
fetch { ""screen_name"": $sn, ""retweet_count"": $count };"
305,Show the first 3 tweets mentioning 'Neo4j' that have been retweeted by 'Me'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)
WHERE retweetedTweet.text CONTAINS 'Neo4j'
RETURN retweetedTweet.text AS tweet_text
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  mentions (source_tweet: $retweetedTweet, mentioned_user: $neo4j);
  $neo4j has screen_name ""Neo4j"";
  $retweetedTweet has text $text;
limit 3;
fetch { ""tweet_text"": $text };"
337,Which tweets have been replied to and have more than 50 favorites?,"MATCH (t:Tweet)-[:REPLY_TO]->(replied_to_tweet:Tweet)
WHERE t.favorites > 50
RETURN t, replied_to_tweet","match
  $t isa tweet, has favorites $favorites, has text $text, has tweet_id $id;
  $favorites > 50;
  reply_to (original_tweet: $t, replying_tweet: $reply);
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
350,List the 3 most recent tweets that mention 'Neo4j' and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'}), (t)-[:CONTAINS]->(:Link)
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text, t.created_at
ORDER BY t.created_at DESC
LIMIT 3","match
  $t isa tweet, has text $text, has created_at $created_at;
  $u isa user, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $u);
  contains (containing_tweet: $t, contained_link: $l);
sort $created_at desc;
limit 3;
fetch { ""tweet_text"": $text, ""created_at"": $created_at };"
390,Show the first 3 tweets that 'neo4j' has amplified.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:POSTS]-(t:Tweet)
RETURN t.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  amplifies (amplifier: $me, amplified_user: $u);
  posts (author: $u, content: $t);
  $t has text $text;
limit 3;
fetch { ""text"": $text };"
407,List all tweets from 'neo4j' that have been amplified and show the first 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (me)-[:AMPLIFIES]->(:User) }
RETURN tweet.text
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet);
  $tweet has text $text;
limit 5;
fetch { ""text"": $text };"
419,Show the top 5 tweets that contain links and are retweeted by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
WHERE exists{ (tweet)<-[:RETWEETS]-(:Tweet) }
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $rt);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  contains (containing_tweet: $tweet, contained_link: $link);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
425,List the first 3 tweets from 'neo4j' that have been retweeted and mention another user.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:MENTIONS]->(:User) }
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  mentions (source_tweet: $tweet, mentioned_user: $u);
limit 3;
fetch { ""text"": $tweet.text };"
431,Show the top 5 tweets by 'neo4j' that have been retweeted and contain a link.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:CONTAINS]->(:Link) }
RETURN tweet.text AS text, tweet.favorites AS favorites
ORDER BY favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  contains (containing_tweet: $tweet, contained_link: $l);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
435,Which users mentioned in 'neo4j' tweets have more following than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)<-[:POSTS]-(user:User)
WHERE user.following > me.following
RETURN user.screen_name, user.following","match
  $me isa me, has screen_name ""neo4j"", has following $me_following;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $user);
  $user has screen_name $sn, has following $u_following;
  $u_following > $me_following;
fetch { ""screen_name"": $sn, ""following"": $u_following };"
437,Find the top 5 tweets by 'neo4j' that mention another user and have been retweeted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) }
RETURN tweet.text AS tweet_text, mentioned.screen_name AS mentioned_user
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  $tweet has text $text, has favorites $favorites;
  $mentioned has screen_name $sn;
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""mentioned_user"": $sn };"
440,Show the top 5 tweets by 'neo4j' that have been retweeted and tag a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:TAGS]->(:Hashtag) }
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  tags (tagged_tweet: $tweet, tag: $h);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
