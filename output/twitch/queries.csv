original_index,question,cypher,typeql
0,What are the first 3 games played by the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:PLAYS]->(g:Game)
RETURN g.name AS game
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"", has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""game"": $gn };"
1,List the top 5 streams that have a total view count greater than 5000000.,"MATCH (s:Stream)
WHERE s.total_view_count > 5000000
RETURN s.name AS stream_name, s.total_view_count AS view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 5000000;
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""view_count"": $tvc };"
2,Which users are moderators for the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:MODERATOR]-(u:User)
RETURN u.name AS user","match
  $s isa stream, has name ""9linda"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
fetch { ""user"": $un };"
3,Find the top 3 languages used by streams with more than 1000000 followers.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 1000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 1000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
4,What are the first 3 streams that have a follower count between 20000 and 50000?,"MATCH (s:Stream)
WHERE s.followers >= 20000 AND s.followers <= 50000
RETURN s.name, s.followers
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 20000;
  $f <= 50000;
sort $f desc;
limit 3;
fetch { ""name"": $sn, ""followers"": $f };"
5,List the names of the first 5 streams that were created before 2015.,"MATCH (s:Stream)
WHERE s.createdAt < date(""2015-01-01"")
RETURN s.name
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca < 2015-01-01;
sort $ca asc;
limit 5;
fetch { ""name"": $sn };"
6,Who are the top 3 VIPs in the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:VIP]-(vip:User)
RETURN vip.name AS vip, vip.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $s isa stream, has name ""summit1g"";
  vip_status (channel_with_vips: $s, vip_user: $vip);
  $vip has name $vn;
limit 3;
fetch { ""vip"": $vn };"
7,What are the first 3 teams associated with the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:HAS_TEAM]->(t:Team)
RETURN t.name
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"";
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
limit 3;
fetch { ""name"": $tn };"
8,Which streams are chatters in the stream with the name '9linda'?,"MATCH (s:Stream)<-[:CHATTER]-(chatter:Stream)
WHERE s.name = '9linda'
RETURN chatter","match
  $s isa stream, has name ""9linda"";
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
fetch { ""name"": $chatter.name };"
9,List the first 5 users who are chatters in more than one stream.,"MATCH (u:User)-[:CHATTER]->(:Stream)
WITH u, count(DISTINCT u) AS num_streams
WHERE num_streams > 1
RETURN u.name, u.id
LIMIT 5","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $count = count($s) groupby $un;
sort $count desc;
limit 5;"
10,Which game is the most commonly played among the top 5 streams by follower count?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, s
ORDER BY s.followers DESC
LIMIT 5
RETURN g.name AS game, count(*) AS count
ORDER BY count DESC
LIMIT 1","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $f desc;
limit 5;
fetch { ""game"": $gn };"
11,What are the names of the first 3 users who are both moderators and VIPs for any stream?,"MATCH (u:User)
WHERE exists{ (u)-[:MODERATOR]->(:Stream) } 
  AND exists{ (u)-[:VIP]->(:Stream) }
RETURN u.name
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s1);
  vip_status (vip_user: $u, channel_with_vips: $s2);
limit 3;
fetch { ""name"": $un };"
12,List the first 5 streams that have the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name, s.url
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
limit 5;
fetch { ""name"": $s.name, ""url"": $s.url };"
13,Who are the top 3 moderators for the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name AS moderator, m.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
sort $f desc;
limit 3;
fetch { ""moderator"": $mn };"
14,What are the first 5 streams created in 2021?,"MATCH (s:Stream)
WHERE s.createdAt >= date(""2021-01-01"") AND s.createdAt < date(""2022-01-01"")
RETURN s.name AS streamName, s.createdAt
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca >= 2021-01-01;
  $ca < 2022-01-01;
sort $ca asc;
limit 5;
fetch { ""streamName"": $sn, ""createdAt"": $ca };"
15,List the first 3 users who are VIPs in the stream 'itsbigchase'.,"MATCH (u:User)-[:VIP]->(s:Stream {name: 'itsbigchase'})
RETURN u.name AS user
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""user"": $un };"
16,Which user has moderated the most streams?,"MATCH (u:User)-[m:MODERATOR]->(s:Stream)
WITH u, count(m) AS num_moderated
ORDER BY num_moderated DESC
LIMIT 1
RETURN u.name AS user, num_moderated","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated = count($s) groupby $un;
sort $num_moderated desc;
limit 1;"
17,What are the first 3 streams that have a description containing the word 'hilarious'?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'hilarious'
RETURN s
LIMIT 3","match
  $s isa stream, has description $d;
  $d like ""%hilarious%"";
limit 3;
fetch { ""name"": $s.name, ""description"": $d };"
18,List the top 5 streams with the highest total view count.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
19,What are the names of the first 3 languages spoken in streams with a total view count over 10000000?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN l.name AS language
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
sort $tvc desc;
limit 3;
fetch { ""language"": $ln };"
20,How many unique games are played by streams with more than 500000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 500000
RETURN count(DISTINCT g.name) AS unique_games_played","match
  $s isa stream, has followers $f;
  $f > 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $unique_games_played = count($gn);"
21,List the first 3 games played on streams that were created in 2019.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt >= date(""2019-01-01"") AND s.createdAt < date(""2020-01-01"")
RETURN g.name AS game
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca >= 2019-01-01;
  $ca < 2020-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""game"": $gn };"
22,What are the first 5 streams that a user named 'itsbigchase' moderates?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s.name AS stream_name
LIMIT 5","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderating_user: $u, moderated_channel: $s);
  $s has name $sn;
limit 5;
fetch { ""stream_name"": $sn };"
23,Who are the top 3 chatters in the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:CHATTER]-(chatter)
RETURN chatter.name AS chatter, chatter.id AS chatter_id
ORDER BY chatter.total_view_count DESC
LIMIT 3","match
  $s isa stream, has name ""summit1g"";
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
  $chatter has name $cn, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""chatter"": $cn };"
24,List the first 3 games played by streams that have a follower count under 1000.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers < 1000
RETURN g.name AS game
ORDER BY s.followers
LIMIT 3","match
  $s isa stream, has followers $f;
  $f < 1000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $f asc;
limit 3;
fetch { ""game"": $gn };"
25,Which streams are part of the team 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
fetch { ""stream_name"": $sn };"
26,What are the first 5 streams that have been played by more than 5 different users?,"MATCH (s:Stream)<-[:PLAYS]-(u:User)
WITH s, count(distinct u) as userCount
WHERE userCount > 5
RETURN s.name as streamName, s.url as streamUrl, userCount
ORDER BY userCount DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  game_play (streaming_channel: $s, played_game: $g);
reduce $gameCount = count($g) groupby $sn, $su;
sort $gameCount desc;
limit 5;"
27,Who are the top 3 users who chatter in the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
MATCH (u:User)-[:CHATTER]->(s)
RETURN u.name AS user, s.name AS stream
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
sort $tvc desc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
28,List the first 3 games played by streams that have a URL containing 'twitch.tv'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.url CONTAINS 'twitch.tv'
RETURN DISTINCT g.name
LIMIT 3","match
  $s isa stream, has url $u;
  $u like ""%twitch.tv%"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""name"": $gn };"
29,What are the names of the first 5 users who are moderators in the stream '9linda'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream {name: '9linda'})
RETURN u.name
LIMIT 5","match
  $s isa stream, has name ""9linda"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
30,How many streams have a follower count between 10000 and 50000?,"MATCH (s:Stream)
WHERE s.followers >= 10000 AND s.followers <= 50000
RETURN count(s)","match
  $s isa stream, has followers $f;
  $f >= 10000;
  $f <= 50000;
reduce $count = count($s);"
31,List the first 3 streams that have a description mentioning 'game'.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'game'
RETURN s.name, s.description
LIMIT 3","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%game%"";
limit 3;
fetch { ""name"": $sn, ""description"": $d };"
32,Which streams have the user 'itsbigchase' as a VIP?,"MATCH (u:User {name: 'itsbigchase'})-[:VIP]->(s:Stream)
RETURN s.name AS stream_name, s.url AS stream_url","match
  $u isa user, has name ""itsbigchase"";
  vip_status (vip_user: $u, channel_with_vips: $s);
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
33,List the top 5 games played by the streams created in the first half of 2020.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt >= datetime(""2020-01-01"") AND s.createdAt < datetime(""2020-07-01"") 
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 5","match
  $s isa stream, has created_at $ca;
  $ca >= 2020-01-01;
  $ca < 2020-07-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 5;"
34,What are the first 3 languages used by streams with a follower count of exactly 33366?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers = 33366
RETURN l.name
LIMIT 3","match
  $s isa stream, has followers 33366;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""name"": $ln };"
35,Who are the top 3 VIPs in the streams that were created in 2018?,"MATCH (s:Stream)-[:VIP]->(vip:User)
WHERE s.createdAt >= date(""2018-01-01"") AND s.createdAt < date(""2019-01-01"")
RETURN vip.name AS vip, count(*) AS vipCount
ORDER BY vipCount DESC
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca >= 2018-01-01;
  $ca < 2019-01-01;
  vip_status (channel_with_vips: $s, vip_user: $vip);
  $vip has name $vn;
reduce $vipCount = count($s) groupby $vn;
sort $vipCount desc;
limit 3;"
36,List the first 5 streams that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
limit 5;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
37,Which teams are associated with the top 3 streams by total view count?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, t
ORDER BY s.total_view_count DESC
LIMIT 3
RETURN t.name AS team_name, s.name AS stream_name, s.total_view_count","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
sort $tvc desc;
limit 3;
fetch { ""team_name"": $tn, ""stream_name"": $sn, ""total_view_count"": $tvc };"
38,What are the first 3 streams that have a user named 'itsbigchase' as a chatter?,"MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
limit 3;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
39,List the names of the first 5 users who are chatters in the stream 'summit1g'.,"MATCH (u:User)-[:CHATTER]->(s:Stream {name: 'summit1g'})
RETURN u.name
LIMIT 5","match
  $s isa stream, has name ""summit1g"";
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
40,Which streams are chatters in the stream with the most followers?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (chatter:Stream)-[:CHATTER]->(s)
RETURN chatter","match
  $s isa stream, has followers $f;
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
sort $f desc;
limit 1;
fetch { ""name"": $chatter.name };"
41,List the first 5 users who are moderators in streams that play 'Grand Theft Auto V'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(:Game {name: 'Grand Theft Auto V'})
RETURN u.name AS user
LIMIT 5","match
  $g isa game, has name ""Grand Theft Auto V"";
  game_play (streaming_channel: $s, played_game: $g);
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 5;
fetch { ""user"": $un };"
42,What are the names of the first 3 games played by streams that have a URL ending in 'itsbigchase'?,"MATCH (s:Stream {url: 'https://www.twitch.tv/itsbigchase'})-[:PLAYS]->(g:Game)
RETURN g.name
LIMIT 3","match
  $s isa stream, has url ""https://www.twitch.tv/itsbigchase"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""name"": $gn };"
43,Who are the top 3 users who are VIPs in the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:VIP]-(u:User)
RETURN u.name AS user, u.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $s isa stream, has name ""9linda"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""user"": $un };"
44,List the first 5 streams that have been VIP in more than one stream.,"MATCH (s:Stream)-[:VIP]->(:Stream)
WITH s, count(s) AS vip_count
WHERE vip_count > 1
RETURN s.name AS stream_name, s.url AS stream_url
ORDER BY vip_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  vip_status (vip_channel: $s, channel_with_vips: $target);
reduce $vip_count = count($target) groupby $sn, $su;
sort $vip_count desc;
limit 5;"
45,Which streams have a language named after a country code 'en'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
fetch { ""name"": $s.name, ""url"": $s.url };"
46,"List the first 3 streams that were created on or before January 1, 2010.","MATCH (s:Stream)
WHERE s.createdAt <= datetime(""2010-01-01"")
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca <= 2010-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""created_at"": $ca };"
47,What are the first 5 streams that have the most chatters?,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $c);
reduce $chatter_count = count($c) groupby $sn;
sort $chatter_count desc;
limit 5;"
48,Who are the top 3 moderators in the stream with the lowest follower count?,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WITH s, m
ORDER BY s.followers ASC, count{(m)-[:MODERATOR]->(s)} DESC
LIMIT 1
WITH s
MATCH (s)<-[:MODERATOR]-(moderator:User)
RETURN moderator.name AS moderator, moderator.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
sort $f asc;
limit 3;
fetch { ""moderator"": $mn };"
49,List the first 5 streams that have a follower count exactly 5898590.,"MATCH (s:Stream)
WHERE s.followers = 5898590
RETURN s
LIMIT 5","match
  $s isa stream, has followers 5898590;
limit 5;
fetch { ""name"": $s.name, ""followers"": $s.followers };"
50,What are the names of the first 3 languages spoken by the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"";
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""name"": $ln };"
51,Which streams have more than 5000000 followers?,"MATCH (s:Stream)
WHERE s.followers > 5000000
RETURN s.name AS stream_name, s.followers","match
  $s isa stream, has name $sn, has followers $f;
  $f > 5000000;
fetch { ""stream_name"": $sn, ""followers"": $f };"
52,List the top 5 streams by total view count.,"MATCH (s:Stream)
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
53,What are the names of games played by streams with more than 1 million total views?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN DISTINCT g.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
54,Which streams have moderators who are also users?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
RETURN s, u","match
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""stream"": $s.name, ""user"": $u.name };"
55,Identify the streams that are part of the 'ESO Stream Team'.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
fetch { ""name"": $s.name, ""url"": $s.url };"
56,Which users are VIPs in more than one stream?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS num_vip_streams
WHERE num_vip_streams > 1
RETURN u.name AS user, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_vip_streams = count($s) groupby $un;
sort $num_vip_streams desc;"
57,What languages are used by streams that have over 10000 followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN DISTINCT l.name","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""name"": $ln };"
58,Find streams that were created after 2015 and have at least one chatter who is a user.,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2015-01-01')
AND exists{ (s)<-[:CHATTER]-(:User) }
RETURN s","match
  $s isa stream, has created_at $ca;
  $ca > 2015-01-01;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""name"": $s.name, ""created_at"": $ca };"
59,Can you list streams that have a follower count between 1000 and 5000?,"MATCH (s:Stream)
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s.name AS stream_name, s.followers","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 1000;
  $f <= 5000;
fetch { ""stream_name"": $sn, ""followers"": $f };"
60,What are the names of teams associated with streams created before 2018?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt < date(""2018-01-01"")
RETURN t.name","match
  $s isa stream, has created_at $ca;
  $ca < 2018-01-01;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
61,Which games are played by the top 3 streams based on followers count?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, g
ORDER BY s.followers DESC
LIMIT 3
RETURN g.name AS game","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $f desc;
limit 3;
fetch { ""game"": $gn };"
62,Which users are moderators in at least two different streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams >= 2
RETURN u.name as user, num_streams as streams_moderated","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;"
63,What are the names of streams that play 'Rust' and have more than 5000 followers?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 5000
RETURN s.name","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
  $f > 5000;
fetch { ""name"": $sn };"
64,How many streams have a moderator who is also a stream?,"MATCH (s:Stream)-[:MODERATOR]->(m:Stream)
RETURN count(s) AS num_streams_with_stream_moderator","match
  moderation (moderating_channel: $m, moderated_channel: $s);
reduce $num_streams_with_stream_moderator = count($s);"
65,List all streams that have a VIP who is a user.,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s","match
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""name"": $s.name, ""url"": $s.url };"
66,Name the languages spoken in streams with a total view count exceeding 10 million.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN DISTINCT l.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""name"": $ln };"
67,Who are the moderators of the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:MODERATOR]-(m:User)
RETURN m.name AS moderator","match
  $s isa stream, has name ""summit1g"";
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
fetch { ""moderator"": $mn };"
68,Identify streams that have more than one language associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 1
RETURN s","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;"
69,Which users are chatters in more than three streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS num_streams
WHERE num_streams > 3
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;"
70,List the streams that have the most followers who also play 'Grand Theft Auto V'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Grand Theft Auto V'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 10","match
  $g isa game, has name ""Grand Theft Auto V"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
sort $f desc;
limit 10;
fetch { ""stream"": $sn, ""followers"": $f };"
71,Which streams were created in 2019 and have a description longer than 50 characters?,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2019-01-01') AND s.createdAt < datetime('2020-01-01')
  AND s.description IS NOT NULL AND size(s.description) > 50
RETURN s","match
  $s isa stream, has created_at $ca, has description $d;
  $ca >= 2019-01-01;
  $ca < 2020-01-01;
fetch { ""name"": $s.name, ""description"": $d };"
72,Find the streams that are moderated by users named 'itsbigchase'.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderating_user: $u, moderated_channel: $s);
fetch { ""name"": $s.name, ""url"": $s.url };"
73,What are the top 3 games played by streams with a total view count less than 500000?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count < 500000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc < 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 3;"
74,Who are the VIP users in streams that have over 1000000 followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE s.followers > 1000000
RETURN u.name AS vip_user, s.name AS stream","match
  $s isa stream, has followers $f, has name $sn;
  $f > 1000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""vip_user"": $un, ""stream"": $sn };"
75,List the names of streams that have both English and Russian languages associated.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l1:Language {name: 'en'})
WHERE exists{ (s)-[:HAS_LANGUAGE]->(:Language {name: 'ru'}) }
RETURN s.name","match
  $l1 isa language, has name ""en"";
  $l2 isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  $s has name $sn;
fetch { ""name"": $sn };"
76,List the top 5 streams with the highest follower count.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
77,Which 3 games are the most played by streams with over 1 million followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 1000000
WITH g, count(*) as playCount
RETURN g.name as game, playCount
ORDER BY playCount DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $playCount = count($s) groupby $gn;
sort $playCount desc;
limit 3;"
78,Find the top 5 streams with the most total view count that use English language.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
79,Which 3 users are moderators for the most streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;"
80,What are the top 3 most common games played by streams created before 2010?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt < datetime('2010-01-01')
RETURN g.name AS game, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca < 2010-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $count = count($s) groupby $gn;
sort $count desc;
limit 3;"
81,List the 3 teams with the most associated streams.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $stream_count = count($s) groupby $tn;
sort $stream_count desc;
limit 3;"
82,Which 3 streams have the highest number of VIP users?,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 3;"
83,What are the names of the top 5 oldest teams in the graph?,"MATCH (t:Team)
RETURN t.name
ORDER BY t.createdAt
LIMIT 5","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $tn };"
84,"List the top 3 languages used by streams with over 10,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
85,Who are the top 3 users who chatter the most with other users?,"MATCH (u:User)-[c:CHATTER]->(u2:User)
WITH u, count(c) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3
RETURN u.name AS user, chatter_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, user_with_chatters: $u2);
reduce $chatter_count = count($u2) groupby $un;
sort $chatter_count desc;
limit 3;"
86,List the 3 streams with the lowest follower count but with over 1 million total views.,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
  $tvc > 1000000;
sort $f asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
87,What are the top 3 games played by streams that also have a moderator relationship with a user?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:MODERATOR]->(u:User)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  moderation (moderated_channel: $s, moderating_user: $u);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;"
88,Which 3 users have VIP status on the most streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
ORDER BY vip_count DESC
LIMIT 3
RETURN u.name AS user, vip_count","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $vip_count = count($s) groupby $un;
sort $vip_count desc;
limit 3;"
89,List the top 5 streams that have created the most chatter relationships.,"MATCH (s:Stream)
RETURN s.name AS stream, count{(s)-[:CHATTER]->(:User)} AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;"
90,Which 3 games are mostly played by streams with a total view count exceeding 100 million?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 100000000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 100000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 3;"
91,Find the top 5 users who moderate the highest number of other users.,"MATCH (u:User)-[:MODERATOR]->(otherUser:User)
WITH u, count(otherUser) AS num_moderated_users
ORDER BY num_moderated_users DESC
LIMIT 5
RETURN u.name AS user, num_moderated_users","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_user: $other);
reduce $num_moderated_users = count($other) groupby $un;
sort $num_moderated_users desc;
limit 5;"
92,What are the 3 most common languages for streams that have been created after 2015?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.createdAt > datetime('2015-01-01')
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca > 2015-01-01;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
93,List the top 5 streams with the most chatter interactions.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, s.url AS url, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn, $su;
sort $chatter_count desc;
limit 5;"
94,Which 3 teams were created most recently?,"MATCH (t:Team)
RETURN t.name AS team, t.createdAt AS created
ORDER BY t.createdAt DESC
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""team"": $tn, ""created"": $ca };"
95,Find the 3 streams that play the least common games based on follower count.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count(s) AS streamCount, max(s.followers) AS maxFollowers
ORDER BY streamCount ASC
LIMIT 3
MATCH (s:Stream)-[:PLAYS]->(g)
RETURN s.name AS streamName, s.followers, g.name AS gameName
ORDER BY s.followers DESC","match
  $s isa stream, has name $sn, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streamCount = count($s) groupby $gn;
sort $streamCount asc;
limit 3;"
96,List the top 5 oldest streams in the graph.,"MATCH (s:Stream)
RETURN s.name, s.createdAt
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca };"
97,What are the top 3 most viewed games by streams that have a team?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_TEAM]->(:Team)
WITH g.name AS game, sum(s.total_view_count) AS total_views
RETURN game, total_views
ORDER BY total_views DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  team_membership (member_stream: $s, organization: $t);
  $s has total_view_count $tvc;
  $g has name $gn;
reduce $total_views = sum($tvc) groupby $gn;
sort $total_views desc;
limit 3;"
98,List the 3 languages spoken by the least number of streams.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(s) AS stream_count
ORDER BY stream_count
LIMIT 3","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $stream_count = count($s) groupby $ln;
sort $stream_count asc;
limit 3;"
99,Which 3 users have moderated the most streams and users combined?,"MATCH (u:User)-[:MODERATOR]->(s)
WHERE s:Stream OR s:User
WITH u, count(s) AS moderations
RETURN u.name AS user, moderations
ORDER BY moderations DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $moderations = count($s) groupby $un;
sort $moderations desc;
limit 3;"
100,Find the top 5 games played by streams that also chatter with other streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:CHATTER]->(:Stream)
WITH g, count(*) AS count
RETURN g.name AS game, count
ORDER BY count DESC
LIMIT 5","match
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (chatting_channel: $s, channel_with_chatters: $s2);
  $g has name $gn;
reduce $count = count($s) groupby $gn;
sort $count desc;
limit 5;"
101,What are the top 3 most recent streams to reach over 1 million followers?,"MATCH (s:Stream)
WHERE s.followers > 1000000
RETURN s.name AS stream_name, s.createdAt AS created_at, s.followers
ORDER BY s.createdAt DESC
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca, has followers $f;
  $f > 1000000;
sort $ca desc;
limit 3;
fetch { ""stream_name"": $sn, ""created_at"": $ca, ""followers"": $f };"
102,Which 3 users are VIPs on the most diverse set of streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_streams
RETURN u.name, num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 3;"
103,Which streams have a total view count over 1 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000
RETURN s.name, s.total_view_count","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
104,List the games that have been played by more than five different streams.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
WITH g, count(distinct s) as numStreams
WHERE numStreams > 5
RETURN g.name as game, numStreams
ORDER BY numStreams DESC","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $numStreams = count($s) groupby $gn;
sort $numStreams desc;"
105,What are the names of users who are moderators for more than three streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 3
RETURN u.name AS user_name","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;"
106,Identify streams that have moderators who are also VIPs.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)-[:VIP]->(s)
RETURN s.name AS stream, m.name AS moderator_and_vip","match
  moderation (moderated_channel: $s, moderating_user: $m);
  vip_status (channel_with_vips: $s, vip_user: $m);
  $s has name $sn;
  $m has name $mn;
fetch { ""stream"": $sn, ""moderator_and_vip"": $mn };"
107,Which streams are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, t.name AS team","match
  $t isa team, has name $tn, has created_at $ca;
  $ca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
fetch { ""stream"": $sn, ""team"": $tn };"
108,What are the top 5 languages used by streams with more than 10000 followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 5;"
109,Which streams have chatters who are also moderators?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(s)
RETURN DISTINCT s","match
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $s.name };"
110,How many streams have played the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN count(s) AS num_streams_playing_rust","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_streams_playing_rust = count($s);"
111,List all teams associated with streams having more than 50000 followers.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.followers > 50000
RETURN DISTINCT t.name","match
  $s isa stream, has followers $f;
  $f > 50000;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
112,What are the descriptions of streams that play 'Call of Duty: Warzone'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Call of Duty: Warzone'})
WHERE s.description IS NOT NULL
RETURN s.description","match
  $g isa game, has name ""Call of Duty: Warzone"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has description $d;
fetch { ""description"": $d };"
113,Which users are VIPs on at least two different streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_vip_streams
WHERE num_vip_streams >= 2
RETURN u.name as user, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_vip_streams = count($s) groupby $un;
sort $num_vip_streams desc;"
114,Find streams that have a follower count between 1000 and 5000.,"MATCH (s:Stream)
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s","match
  $s isa stream, has followers $f;
  $f >= 1000;
  $f <= 5000;
fetch { ""name"": $s.name, ""followers"": $f };"
115,List the top 5 streams with the highest follower counts.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
116,Which games are played by streams that also have an 'en' language setting?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN DISTINCT g.name","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
117,Find streams that are moderated by users who are also chatters.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)-[:CHATTER]->(s)
RETURN s, u","match
  moderation (moderated_channel: $s, moderating_user: $u);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $s has name $sn;
  $u has name $un;
fetch { ""stream"": $sn, ""user"": $un };"
118,What is the URL of the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
RETURN s.url","match
  $s isa stream, has total_view_count $tvc, has url $u;
sort $tvc desc;
limit 1;
fetch { ""url"": $u };"
119,List all languages spoken on streams with a total view count over 500000.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 500000
RETURN DISTINCT l.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""name"": $ln };"
120,Which users are chatters on more than five different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) AS num_streams
WHERE num_streams > 5
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;"
121,What are the names of teams associated with streams created after 2018?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt > date(""2018-01-01"")
RETURN t.name","match
  $s isa stream, has created_at $ca;
  $ca > 2018-01-01;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
122,How many streams have a description containing the word 'strategy'?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'strategy'
RETURN count(s)","match
  $s isa stream, has description $d;
  $d like ""%strategy%"";
reduce $count = count($s);"
124,List the games played by streams with the lowest follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers IS NOT NULL
WITH g, min(s.followers) AS minFollowers
MATCH (s2:Stream)-[:PLAYS]->(g)
WHERE s2.followers = minFollowers
RETURN g.name AS game, minFollowers AS lowestFollowerCount","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $minFollowers = min($f) groupby $gn;
sort $minFollowers asc;
limit 10;"
125,Which streams are part of the team 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name, s.url AS stream_url","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
126,List the top 5 users who are chatters in the most streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 5;"
127,Identify streams where the same user is both a chatter and a moderator.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(s)
RETURN s.name AS stream, u.name AS user","match
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has name $sn;
  $u has name $un;
fetch { ""stream"": $sn, ""user"": $un };"
128,Which streams have chatters who have less than 1000 followers?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE u.followers < 1000
RETURN s, u","match
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""stream"": $s.name, ""user"": $u.name };"
129,How many users have VIP status in more than one stream?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
WHERE vip_count > 1
RETURN count(u) AS user_count","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $vip_count = count($s) groupby $un;
sort $vip_count desc;"
130,Find streams that play 'Rust' and have more than 10000 followers.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 10000
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 10000;
fetch { ""name"": $s.name, ""followers"": $f };"
131,List the top 5 streams with the highest number of followers.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
132,Which 3 games have the most streams associated with them?,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
RETURN g.name AS game, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streamCount = count($s) groupby $gn;
sort $streamCount desc;
limit 3;"
133,"What are the top 5 languages used by streams with more than 100,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 100000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 100000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 5;"
134,Identify the first 3 teams that were created in the database.,"MATCH (t:Team)
RETURN t.name AS team, t.createdAt AS created_at
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca asc;
limit 3;
fetch { ""team"": $tn, ""created_at"": $ca };"
135,Which 3 users are moderators for the most number of streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;"
136,Find the top 5 streams with the highest total view count.,"MATCH (s:Stream)
RETURN s.name, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
137,What are the names of the top 3 streams that have a VIP user?,"MATCH (s:Stream)<-[:VIP]-(:User)
RETURN s.name AS stream_name
ORDER BY s.total_view_count DESC
LIMIT 3","match
  vip_status (channel_with_vips: $s, vip_user: $u);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream_name"": $sn };"
138,List the top 5 streams that play 'Rust' and have more than 5000 followers.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 5000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
  $f > 5000;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
139,Which 3 users have VIP status in the most streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
ORDER BY vip_count DESC
LIMIT 3
RETURN u.name AS user, vip_count","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $vip_count = count($s) groupby $un;
sort $vip_count desc;
limit 3;"
140,What are the top 5 oldest streams based on the 'createdAt' property?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.createdAt AS created_at
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""stream_name"": $sn, ""created_at"": $ca };"
141,Find the first 3 languages that are most frequently associated with streams.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $frequency = count($s) groupby $ln;
sort $frequency desc;
limit 3;"
142,What are the top 5 streams with the longest descriptions?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s.name, s.description
ORDER BY size(s.description) DESC
LIMIT 5","match
  $s isa stream, has name $sn, has description $d;
limit 5;
fetch { ""name"": $sn, ""description"": $d };"
143,List the top 5 games played by streams with over 1 million total views.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 5","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 5;"
144,Which 3 users are chatters in the most number of different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
RETURN u.name AS user, count(distinct s) AS num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 3;"
145,What are the top 5 teams by the number of streams they are associated with?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 5;"
146,List the top 5 streams that have a 'createdAt' date after 2019.,"MATCH (s:Stream)
WHERE s.createdAt > date('2019-01-01')
RETURN s.name, s.createdAt, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca, has total_view_count $tvc;
  $ca > 2019-01-01;
sort $tvc desc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca, ""total_view_count"": $tvc };"
147,What are the top 3 most common games played by streams with a 'ru' language setup?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'ru'})
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;"
148,Which 3 streams have the highest follower count but the lowest total view count?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count, s.total_view_count AS view_count
ORDER BY s.followers DESC, s.total_view_count ASC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
sort $f desc, $tvc asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f, ""view_count"": $tvc };"
149,Identify the top 5 streams that have users as VIPs.,"MATCH (s:Stream)<-[:VIP]-(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 5;"
150,What are the names of the first 3 streams moderated by 'itsbigchase'?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s.name
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderating_user: $u, moderated_channel: $s);
  $s has name $sn;
limit 3;
fetch { ""name"": $sn };"
151,List the 3 games most commonly played by streams with an English language setup.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;"
152,Which 3 streams have the highest ratio of followers to total view count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL AND s.total_view_count IS NOT NULL
RETURN s.name AS stream, toFloat(s.followers) / s.total_view_count AS follower_to_view_ratio
ORDER BY follower_to_view_ratio DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
sort $f desc;
limit 3;
fetch { ""stream"": $sn, ""followers"": $f, ""total_view_count"": $tvc };"
153,Find the top 5 streams by oldest to newest based on the 'createdAt' property.,"MATCH (s:Stream)
WHERE s.createdAt IS NOT NULL
RETURN s
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca };"
154,"Which 3 languages are least common among streams with more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
WITH l, count(*) as count
ORDER BY count
LIMIT 3
RETURN l.name as language, count","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count asc;
limit 3;"
155,List the top 5 users who have the role of chatter in the highest number of other user's streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)<-[:CHATTER]-(other:User)
WHERE u <> other
WITH u, count(distinct s) as chatter_count
ORDER BY chatter_count DESC
LIMIT 5
RETURN u.name as user, chatter_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  chat_activity (chatting_user: $other, channel_with_chatters: $s);
  not { $u is $other; };
reduce $chatter_count = count($s) groupby $un;
sort $chatter_count desc;
limit 5;"
156,What are the three most common teams that streams belong to?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN t.name AS team, count(*) AS num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 3;"
157,Which streams have a VIP relationship with more than three different users?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vip_count
WHERE vip_count > 3
RETURN s.name AS stream_name, vip_count","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;"
158,List the top 5 streams that have been added to the most teams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN s.name AS stream, count(t) AS team_count
ORDER BY team_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
reduce $team_count = count($t) groupby $sn;
sort $team_count desc;
limit 5;"
159,"What are the first 3 streams to play 'Rust' with more than 100,000 total views?","MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.total_view_count > 100000
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.createdAt
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has total_view_count $tvc, has created_at $ca;
  $tvc > 100000;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
160,Which 3 users have served as moderators for the oldest streams in the database?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
WITH s, u
ORDER BY s.createdAt
LIMIT 3
RETURN u.name AS user, s.name AS stream, s.createdAt AS streamCreatedAt","match
  $s isa stream, has name $sn, has created_at $ca;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
sort $ca asc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn, ""streamCreatedAt"": $ca };"
161,List the top 5 streams that are part of a team created before 2015.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $t isa team, has created_at $ca;
  $ca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
163,Which 3 streams have the most unique games played?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as uniqueGames
RETURN s.name as streamName, uniqueGames
ORDER BY uniqueGames DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $uniqueGames = count($g) groupby $sn;
sort $uniqueGames desc;
limit 3;"
164,List the top 5 streams that have had more than three different languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(distinct l) as languageCount
WHERE languageCount > 3
RETURN s.name as streamName, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;
limit 5;"
165,"What are the first 3 users who are VIPs in streams with more than 10,000 total views?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 10000
RETURN u.name AS user, s.name AS stream
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc, has name $sn;
  $tvc > 10000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $tvc desc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
166,List the top 5 oldest teams based on the 'createdAt' property.,"MATCH (t:Team)
RETURN t.name AS team, t.createdAt
ORDER BY t.createdAt
LIMIT 5","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""team"": $tn, ""createdAt"": $ca };"
167,Which 3 streams have the most users as chatters?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 3;"
168,List the first 3 games played by streams with the highest follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS game, max(s.followers) AS max_followers
ORDER BY max_followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $max_followers = max($f) groupby $gn;
sort $max_followers desc;
limit 3;"
169,What are the top 5 streams that have VIP relationships with other streams?,"MATCH (s:Stream)-[:VIP]->(otherStream:Stream)
RETURN s.name AS stream, count(otherStream) AS vip_count
ORDER BY vip_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  vip_status (vip_channel: $s, channel_with_vips: $other);
reduce $vip_count = count($other) groupby $sn;
sort $vip_count desc;
limit 5;"
170,Which 3 users have the most moderator relationships with other users?,"MATCH (u:User)-[r:MODERATOR]->(otherUser:User)
RETURN u.name AS user, count(r) AS num_moderator_relationships
ORDER BY num_moderator_relationships DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_user: $other);
reduce $num_moderator_relationships = count($other) groupby $un;
sort $num_moderator_relationships desc;
limit 3;"
172,What are the first 3 streams that have a language setup other than 'en' or 'ru'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name <> 'en' AND l.name <> 'ru'
RETURN s.name AS stream, l.name AS language
LIMIT 3","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
  not { $ln == ""en""; };
  not { $ln == ""ru""; };
limit 3;
fetch { ""stream"": $sn, ""language"": $ln };"
174,"List the top 5 games associated with streams that have more than 10,000 total views.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 10000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 5","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 5;"
175,Which 3 users are VIPs in the most number of different users' streams?,"MATCH (u:User)-[:VIP]->(s:Stream)<-[:VIP]-(other:User)
WITH u, count(DISTINCT other) AS num_vip_streams
RETURN u.name AS user, num_vip_streams
ORDER BY num_vip_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
  vip_status (vip_user: $other, channel_with_vips: $s);
  not { $u is $other; };
reduce $num_vip_streams = count($other) groupby $un;
sort $num_vip_streams desc;
limit 3;"
176,List the first 3 streams that were created after 2020.,"MATCH (s:Stream)
WHERE s.createdAt > date(""2020-01-01"")
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca > 2020-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""createdAt"": $ca };"
177,"What are the top 5 teams by number of associated streams with over 10,000 followers?","MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WHERE s.followers > 10000
WITH t, count(s) as numStreams
ORDER BY numStreams DESC
LIMIT 5
RETURN t.name as team, numStreams","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
  $s has followers $f;
  $f > 10000;
reduce $numStreams = count($s) groupby $tn;
sort $numStreams desc;
limit 5;"
178,Which 3 languages are associated with the streams that have the least followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH l, min(s.followers) AS minFollowers
RETURN l.name AS language, minFollowers
ORDER BY minFollowers
LIMIT 3","match
  $s isa stream, has followers $f;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $minFollowers = min($f) groupby $ln;
sort $minFollowers asc;
limit 3;"
179,List the top 5 streams that have the most number of languages associated.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN s.name AS stream, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $num_languages = count($l) groupby $sn;
sort $num_languages desc;
limit 5;"
181,"Which 3 streams have the least followers but are associated with a game with more than 100,000 total views?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE g.name IS NOT NULL
WITH s, sum(s.total_view_count) AS game_views
WHERE game_views > 100000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
  game_play (streaming_channel: $s, played_game: $g);
  $tvc > 100000;
sort $f asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
183,What are the first 3 streams to have a team relationship with 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name, s.createdAt AS created_at
ORDER BY s.createdAt
LIMIT 3","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has created_at $ca;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""created_at"": $ca };"
185,List the top 5 users who are moderators in the most number of streams with an 'en' language setup.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5
RETURN u.name AS user, num_moderated_streams","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;"
186,What are the top 5 oldest streams by the 'createdAt' property that are still active?,"MATCH (s:Stream)
WHERE s.createdAt IS NOT NULL
RETURN s
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $s.name, ""createdAt"": $ca };"
188,List the first 3 streams that were created in 2018.,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2018-01-01') AND s.createdAt < datetime('2019-01-01')
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca >= 2018-01-01;
  $ca < 2019-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""createdAt"": $ca };"
189,Which 3 streams have the most users as VIPs?,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 3;"
190,List the top 5 streams that are associated with teams and have more than 10000 followers.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.followers > 10000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f > 10000;
  team_membership (member_stream: $s, organization: $t);
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
191,What are the first 3 streams that have a chatter who is also a moderator?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE exists{ (u)-[:MODERATOR]->(s) }
RETURN s.name AS stream, s.url AS url
LIMIT 3","match
  $s isa stream, has name $sn, has url $su;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
limit 3;
fetch { ""stream"": $sn, ""url"": $su };"
192,List the first 3 streams that have a language set to 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
limit 3;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
193,What are the top 5 games played by streams with more than 5000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 5000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 5000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 5;"
194,Which streams have a total view count above 1 million and are associated with the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.total_view_count > 1000000
RETURN s.name AS stream_name, s.total_view_count AS view_count","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
fetch { ""stream_name"": $sn, ""view_count"": $tvc };"
195,Identify the first 3 users who are moderators for streams with a description containing 'Belarus'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.description CONTAINS 'Belarus'
RETURN u.name, u.id
LIMIT 3","match
  $s isa stream, has description $d;
  $d like ""%Belarus%"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 3;
fetch { ""name"": $un };"
196,Find the top 5 streams that are playing the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
197,List the first 3 streams that have at least one VIP who is also a user.,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS stream, u.name AS vip_user
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""stream"": $sn, ""vip_user"": $un };"
198,What are the first 3 streams that have a language set to 'ru'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN s.name, s.url
LIMIT 3","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
limit 3;
fetch { ""name"": $s.name, ""url"": $s.url };"
199,"Which users are VIPs in streams with a total view count exceeding 500,000?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u.name AS user, s.name AS stream","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 500000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn };"
200,"What are the top 5 games played by streams created after January 1, 2015?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt > datetime(""2015-01-01"")
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 5","match
  $s isa stream, has created_at $ca;
  $ca > 2015-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 5;"
202,List the top 5 most followed streams that are linked to the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
203,Which streams have a follower count between 1000 and 5000 and play the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s.name AS stream, s.followers AS followerCount","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
  $f >= 1000;
  $f <= 5000;
fetch { ""stream"": $sn, ""followerCount"": $f };"
204,Find the first 3 users who are moderators of more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name, u.id
ORDER BY num_moderated_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;"
205,What are the top 5 streams with the highest total view count and are associated with the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
206,Identify the first 3 languages associated with streams that have a description containing 'coverage'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.description CONTAINS 'coverage'
RETURN l.name AS language
LIMIT 3","match
  $s isa stream, has description $d;
  $d like ""%coverage%"";
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""language"": $ln };"
208,"Which streams have a total view count below 50,000 and are associated with the language 'ru'?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.total_view_count < 50000
RETURN s","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  $s has total_view_count $tvc;
  $tvc < 50000;
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
209,"Identify the first 3 teams that are linked to streams with over 10,000 followers.","MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WHERE s.followers > 10000
RETURN t.name AS team_name
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
  $s has followers $f;
  $f > 10000;
sort $ca asc;
limit 3;
fetch { ""team_name"": $tn };"
210,What are the top 5 streams created before 2010?,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s.name AS stream, s.createdAt AS created
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca < 2010-01-01;
sort $ca asc;
limit 5;
fetch { ""stream"": $sn, ""created"": $ca };"
211,List the first 3 streams that have VIPs who are users with a name containing 'chase'.,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.name CONTAINS 'chase'
RETURN s.name AS stream, u.name AS vip
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
  $un like ""%chase%"";
limit 3;
fetch { ""stream"": $sn, ""vip"": $un };"
212,Which users are chatters in streams with a description containing 'inclusive'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.description CONTAINS 'inclusive'
RETURN u","match
  $s isa stream, has description $d;
  $d like ""%inclusive%"";
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""name"": $u.name };"
213,Identify the first 3 streams that have moderators named 'itsbigchase'.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User {name: 'itsbigchase'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 3","match
  $m isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $m);
limit 3;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
214,List the top 5 streams with the lowest follower count that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers IS NOT NULL
RETURN s.name AS stream, s.followers AS followerCount
ORDER BY followerCount ASC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
sort $f asc;
limit 5;
fetch { ""stream"": $sn, ""followerCount"": $f };"
215,What are the first 3 streams with the most VIPs linked to them?,"MATCH (s:Stream)<-[:VIP]-()
RETURN s.name AS stream, count(*) AS vipCount
ORDER BY vipCount DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $v);
reduce $vipCount = count($v) groupby $sn;
sort $vipCount desc;
limit 3;"
216,Which streams have at least one user named 'itsbigchase' as a chatter?,"MATCH (s:Stream)
WHERE exists{ (u:User {name: 'itsbigchase'})-[:CHATTER]->(s) }
RETURN s","match
  $u isa user, has name ""itsbigchase"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
fetch { ""name"": $s.name };"
217,Identify the first 3 users who are VIPs in streams with a name containing 'big'.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.name CONTAINS 'big'
RETURN u.name AS user, s.name AS stream
LIMIT 3","match
  $s isa stream, has name $sn;
  $sn like ""%big%"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
219,"Which streams have a follower count above 10,000 and are associated with a game named 'Rust'?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 10000
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 10000;
fetch { ""name"": $s.name, ""followers"": $f };"
220,Identify the first 3 streams that play a game and have a VIP who is a user.,"MATCH (s:Stream)-[:PLAYS]->(:Game), (s)-[:VIP]->(u:User)
RETURN s, u
LIMIT 3","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""stream"": $sn, ""user"": $un };"
221,List the first 3 streams that are linked to the game 'Rust' and have been created after 2018.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.createdAt > date('2018-01-01')
RETURN s
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has created_at $ca;
  $ca > 2018-01-01;
limit 3;
fetch { ""name"": $s.name, ""created_at"": $ca };"
222,What are the top 5 most viewed streams that have a language set to 'en'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
223,Which streams have a description containing 'premiere' and have at least 5000 followers?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'premiere' AND s.followers >= 5000
RETURN s","match
  $s isa stream, has description $d, has followers $f;
  $d like ""%premiere%"";
  $f >= 5000;
fetch { ""name"": $s.name, ""description"": $d, ""followers"": $f };"
225,List the top 5 streams that are linked to teams created before 2015.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $t isa team, has created_at $ca;
  $ca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
226,What are the first 3 streams with a moderator named 'itsbigchase'?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has name $sn;
limit 3;
fetch { ""stream_name"": $sn };"
229,List the top 5 streams that have at least one user as a chatter and are associated with the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE exists{ (s)<-[:CHATTER]-(:User) }
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
230,What are the first 3 streams that have a team with a creation date after 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01')
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $tca;
  $tca > 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
sort $tca asc;
limit 3;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $tca };"
231,Which streams have a total view count above 1 million and a moderator named 'creightonolsen'?,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000 AND
      exists{ (s)-[:MODERATOR]->(:User {name: 'creightonolsen'}) }
RETURN s","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  $u isa user, has name ""creightonolsen"";
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
232,Identify the first 3 streams that have chatters who are streams created before 2017.,"MATCH (s:Stream)<-[:CHATTER]-(chatter:Stream)
WHERE chatter.createdAt < date(""2017-01-01"")
RETURN s.name as stream, s.createdAt as streamCreated
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $sca;
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
  $chatter has created_at $cca;
  $cca < 2017-01-01;
sort $sca asc;
limit 3;
fetch { ""stream"": $sn, ""streamCreated"": $sca };"
234,What are the first 3 streams that have a VIP named 'itsbigchase'?,"MATCH (s:Stream)<-[:VIP]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $s has name $sn;
limit 3;
fetch { ""stream_name"": $sn };"
235,"Which streams have a total view count below 10,000 and are linked to a language named 'en'?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count < 10000
RETURN s","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has total_view_count $tvc;
  $tvc < 10000;
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
236,Identify the first 3 streams that play a game named 'Rust' and have a VIP who is a user.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE exists{ (s)-[:VIP]->(:User) }
RETURN s
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $u);
limit 3;
fetch { ""name"": $s.name };"
237,List the top 5 streams that have chatters named 'itsbigchase'.,"MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream, s.url AS url
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $u isa user, has name ""itsbigchase"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  $s has name $sn, has url $su, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""url"": $su };"
238,What are the first 3 streams that were created after 2015 and have a follower count above 1000?,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2015-01-01') AND s.followers > 1000
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca, has followers $f;
  $ca > 2015-01-01;
  $f > 1000;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""created_at"": $ca, ""followers"": $f };"
239,Which streams have a follower count exceeding 2000 and are playing a game named 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 2000
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 2000;
fetch { ""name"": $s.name, ""followers"": $f };"
240,"Identify the first 3 users who are moderators for streams with a total view count exceeding 500,000.","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u.name, u.id
ORDER BY u.createdAt
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 3;
fetch { ""name"": $un };"
241,List the top 5 streams with the most chatters who are users.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;"
242,What are the first 3 streams that have a language set to 'en' and a VIP who is a user?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WHERE EXISTS {
  (s)-[:VIP]->(:User)
}
RETURN s
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  vip_status (channel_with_vips: $s, vip_user: $u);
limit 3;
fetch { ""name"": $s.name };"
243,"Which streams have a description containing 'casual play' and a total view count above 100,000?","MATCH (s:Stream)
WHERE s.description CONTAINS 'casual play' AND s.total_view_count > 100000
RETURN s","match
  $s isa stream, has description $d, has total_view_count $tvc;
  $d like ""%casual play%"";
  $tvc > 100000;
fetch { ""name"": $s.name, ""description"": $d, ""total_view_count"": $tvc };"
244,Identify the first 3 streams that have a team named 'ESO Stream Team' and a follower count below 5000.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.followers < 5000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.createdAt
LIMIT 3","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has followers $f, has created_at $ca;
  $f < 5000;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
245,List the top 5 streams that have a moderator named 'itsbigchase' and were created before 2018.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
WHERE s.createdAt < date('2018-01-01')
RETURN s.name AS stream, s.createdAt AS createdAt
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has name $sn, has created_at $ca, has total_view_count $tvc;
  $ca < 2018-01-01;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""createdAt"": $ca };"
246,"What are the first 3 streams with a language named 'ru' and a total view count below 10,000?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.total_view_count < 10000
RETURN s.name, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
  $tvc < 10000;
sort $tvc desc;
limit 3;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
247,What are the names of the first 5 streams created before 2010?,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s.name
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca < 2010-01-01;
sort $ca asc;
limit 5;
fetch { ""name"": $sn };"
248,List the top 3 games with the most streams playing them.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
RETURN g.name AS game, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 3;"
249,Which 5 streams have the highest total view count?,"MATCH (s:Stream)
RETURN s.name, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
250,Name the top 5 users who are moderators for more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;"
251,What are the first 3 languages spoken by streams with over 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN l.name AS language
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
sort $tvc desc;
limit 3;
fetch { ""language"": $ln };"
252,Which streams are part of a team created after 2015 and list the first 5.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01')
RETURN s.name AS stream, t.name AS team
LIMIT 5","match
  $t isa team, has name $tn, has created_at $ca;
  $ca > 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
limit 5;
fetch { ""stream"": $sn, ""team"": $tn };"
253,"What are the descriptions of the first 3 streams with fewer than 100,000 followers?","MATCH (s:Stream)
WHERE s.followers < 100000
RETURN s.description
LIMIT 3","match
  $s isa stream, has followers $f, has description $d;
  $f < 100000;
limit 3;
fetch { ""description"": $d };"
254,List the top 5 teams by the number of streams they have.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 5;"
255,Which users are VIPs for the first 5 streams with the most followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, u
ORDER BY s.followers DESC
LIMIT 5
RETURN s.name AS stream, collect(u.name) AS vips","match
  $s isa stream, has name $sn, has followers $f;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""vip"": $un };"
256,Identify the top 3 streams that have the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream"": $sn, ""views"": $tvc };"
257,What are the top 5 streams by followers that play the game 'Dota 2'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Dota 2'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $g isa game, has name ""Dota 2"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
258,"List all the games that have been played by streams with more than 5 million total views, showing the first 3.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 5000000
RETURN g.name AS game
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 5000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""game"": $gn };"
259,Who are the first 5 moderators for the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name AS moderator
LIMIT 5","match
  $s isa stream, has total_view_count $tvc;
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
sort $tvc desc;
limit 5;
fetch { ""moderator"": $mn };"
260,What are the URLs of the first 3 streams that have no chatters?,"MATCH (s:Stream)
WHERE NOT exists{ (s)<-[:CHATTER]-() }
RETURN s.url
LIMIT 3","match
  $s isa stream, has url $u;
  not { chat_activity (channel_with_chatters: $s); };
limit 3;
fetch { ""url"": $u };"
261,Name the first 5 streams that have no moderators and no VIPs.,"MATCH (s:Stream)
WHERE NOT exists{ (s)<-[:MODERATOR]-() } 
  AND NOT exists{ (s)<-[:VIP]-() }
RETURN s.name
LIMIT 5","match
  $s isa stream, has name $sn;
  not { moderation (moderated_channel: $s); };
  not { vip_status (channel_with_vips: $s); };
limit 5;
fetch { ""name"": $sn };"
262,"Which users have moderated the most streams, and list the top 3.","MATCH (u:User)-[m:MODERATOR]->(s:Stream)
WITH u, count(m) AS num_moderated
ORDER BY num_moderated DESC
LIMIT 3
RETURN u.name AS user, num_moderated","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated = count($s) groupby $un;
sort $num_moderated desc;
limit 3;"
263,List the first 3 users who are both moderators and VIPs in different streams.,"MATCH (u:User)-[:MODERATOR]->(s1:Stream), (u)-[:VIP]->(s2:Stream)
WHERE s1 <> s2
RETURN DISTINCT u.name AS user
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s1);
  vip_status (vip_user: $u, channel_with_vips: $s2);
  not { $s1 is $s2; };
limit 3;
fetch { ""user"": $un };"
264,What are the first 5 streams that have a language not listed in 'en' or 'ja'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name <> 'en' AND l.name <> 'ja'
RETURN s.name, l.name
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
  not { $ln == ""en""; };
  not { $ln == ""ja""; };
limit 5;
fetch { ""stream"": $sn, ""language"": $ln };"
266,"Name the first 5 users who are chatters in streams with more than 500,000 followers.","MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.followers > 500000
RETURN u.name
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 500000;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
267,List the top 5 games by the number of languages they are streamed in.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH g, count(distinct l) as languageCount
RETURN g.name as game, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $g has name $gn;
reduce $languageCount = count($l) groupby $gn;
sort $languageCount desc;
limit 5;"
268,Which 3 teams were created most recently and have at least one stream associated with them?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS stream_count
WHERE stream_count > 0
RETURN t.name AS team_name, t.createdAt AS created_at
ORDER BY t.createdAt DESC
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
sort $ca desc;
limit 3;
fetch { ""team_name"": $tn, ""created_at"": $ca };"
270,"Which streams have a follower count between 10,000 and 50,000, listing the first 5?","MATCH (s:Stream)
WHERE s.followers >= 10000 AND s.followers <= 50000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 10000;
  $f <= 50000;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
271,Name the top 3 users who are VIPs in the stream with the most followers.,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, u
ORDER BY s.followers DESC
LIMIT 1
RETURN u.name AS user
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $f desc;
limit 3;
fetch { ""user"": $un };"
272,"List the first 3 streams that have VIP relationships only with other streams, not users.","MATCH (s:Stream)
WHERE exists {(s)-[:VIP]->(:Stream)}
  AND NOT exists {(s)-[:VIP]->(:User)}
RETURN s
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (vip_channel: $s, channel_with_vips: $other);
  not { vip_status (channel_with_vips: $s, vip_user: $u); };
limit 3;
fetch { ""name"": $sn };"
273,Who are the first 5 users chatting in streams labeled with the game 'Rust'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""user"": $un };"
274,What are the first 3 streams that have a team with a creation date before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $tca;
  $tca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
sort $tca asc;
limit 3;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $tca };"
275,"Which streams play 'VALORANT' and have over one million total views, listing the first 5?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'VALORANT'})
WHERE s.total_view_count > 1000000
RETURN s.name AS stream, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $g isa game, has name ""VALORANT"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""total_views"": $tvc };"
277,List the first 5 streams that have changed their primary game at least once.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) AS num_games
WHERE num_games > 1
RETURN s.name AS stream_name, s.url AS stream_url
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has url $su, has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g1);
  game_play (streaming_channel: $s, played_game: $g2);
  not { $g1 is $g2; };
sort $ca asc;
limit 5;
fetch { ""stream_name"": $sn, ""stream_url"": $su };"
278,What are the names of the first 3 teams with streams playing 'Rust' and having over a million followers?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 1000000
RETURN t.name
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 1000000;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
limit 3;
fetch { ""name"": $tn };"
279,Which streams have the description mentioning 'professional' and list the first 3.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'professional'
RETURN s.name, s.description
LIMIT 3","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%professional%"";
limit 3;
fetch { ""name"": $sn, ""description"": $d };"
280,What are the first 5 user names who are chatters in streams playing 'Dota 2'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(:Game {name: 'Dota 2'})
RETURN u.name
LIMIT 5","match
  $g isa game, has name ""Dota 2"";
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
281,"How many languages are used by streams with a total view count over 10 million, listing the first 3?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN l.name AS language
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""language"": $ln };"
283,List the first 3 games played by streams with a language 'ja'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ja'})
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game
LIMIT 3","match
  $l isa language, has name ""ja"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""game"": $gn };"
284,"List the first 5 streams with a follower count exactly at 100,000.","MATCH (s:Stream)
WHERE s.followers = 100000
RETURN s.name, s.url, s.followers
LIMIT 5","match
  $s isa stream, has name $sn, has url $u, has followers 100000;
limit 5;
fetch { ""name"": $sn, ""url"": $u, ""followers"": 100000 };"
285,What are the first 3 streams that have been in the same team since their creation and still active?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt = t.createdAt
RETURN s.name AS stream_name, t.name AS team_name
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $sca;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn, has created_at $sca;
sort $sca asc;
limit 3;
fetch { ""stream_name"": $sn, ""team_name"": $tn };"
290,What are the first 5 streams that have a user who is both a moderator and a VIP?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)-[:VIP]->(s)
RETURN s.name AS stream, u.name AS user
LIMIT 5","match
  moderation (moderated_channel: $s, moderating_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
  $s has name $sn;
  $u has name $un;
limit 5;
fetch { ""stream"": $sn, ""user"": $un };"
292,Who are the first 5 chatters in the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)<-[:CHATTER]-(chatter:User)
RETURN chatter.name
LIMIT 5","match
  $s isa stream, has followers $f;
  chat_activity (channel_with_chatters: $s, chatting_user: $chatter);
  $chatter has name $cn;
sort $f desc;
limit 5;
fetch { ""name"": $cn };"
293,List the first 3 streams with the oldest teams associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt
ORDER BY t.createdAt
LIMIT 3","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn, has created_at $tca;
sort $tca asc;
limit 3;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $tca };"
294,Which 3 users have chatted in the most streams and what are their names?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3
RETURN u.name AS user_name, stream_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $stream_count = count($s) groupby $un;
sort $stream_count desc;
limit 3;"
295,What are the URLs of the first 3 streams with the most languages spoken?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 3
RETURN s.url AS streamURL","match
  $s isa stream, has url $u;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $u;
sort $languageCount desc;
limit 3;"
297,Who are the first 3 VIPs in streams with a total view count exceeding 10 million?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE s.total_view_count > 10000000
RETURN u.name AS vip_name
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $tvc desc;
limit 3;
fetch { ""vip_name"": $un };"
298,"Which streams with a description mentioning 'streaming' have the most followers, listing the first 5?","MATCH (s:Stream)
WHERE s.description CONTAINS 'streaming'
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has description $d, has followers $f;
  $d like ""%streaming%"";
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
299,Name the first 5 streams with the lowest follower count and still active.,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers ASC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f asc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
302,Who are the first 3 users who have VIP status in streams playing 'Rust'?,"MATCH (u:User)-[:VIP]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user, s.name AS stream
ORDER BY s.createdAt
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has created_at $ca;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $ca asc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
303,Which are the first 5 streams that have more than one language associated with them?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 1
RETURN s.name as streamName, s.url as streamUrl, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  not { $l1 is $l2; };
limit 5;
fetch { ""streamName"": $sn, ""streamUrl"": $su };"
305,What are the top 3 streams by total view count that also have a team associated with them?,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
sort $tvc desc;
limit 3;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
307,List the first 3 teams with the most streams playing 'Dota 2'.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)-[:PLAYS]->(:Game {name: 'Dota 2'})
RETURN t.name AS team, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $g isa game, has name ""Dota 2"";
  game_play (streaming_channel: $s, played_game: $g);
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
reduce $stream_count = count($s) groupby $tn;
sort $stream_count desc;
limit 3;"
308,"Which users are chatters in the most streams, listing the first 5.","MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5
RETURN u.name AS user, stream_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $stream_count = count($s) groupby $un;
sort $stream_count desc;
limit 5;"
309,Name the first 3 streams that have had the same game since creation and more than 5 million total views.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 5000000
WITH s, g, s.createdAt AS createdAt
ORDER BY createdAt
LIMIT 3
RETURN s.name AS stream, g.name AS game","match
  $s isa stream, has name $sn, has total_view_count $tvc, has created_at $ca;
  $tvc > 5000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""stream"": $sn, ""game"": $gn };"
310,List the first 5 streams that have a description mentioning 'channel'.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'channel'
RETURN s.name, s.description
LIMIT 5","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%channel%"";
limit 5;
fetch { ""name"": $sn, ""description"": $d };"
311,Who are the first 5 users who are moderators in streams with over a million followers?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.followers > 1000000
RETURN u.name AS user, s.name AS stream
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f > 1000000;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
sort $f desc;
limit 5;
fetch { ""user"": $un, ""stream"": $sn };"
312,What are the top 3 streams that have changed their language at least once?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 1
RETURN s.name as streamName, s.url as streamUrl, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $s isa stream, has name $sn, has url $su;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  not { $l1 is $l2; };
limit 3;
fetch { ""streamName"": $sn, ""streamUrl"": $su };"
313,Which streams have no team associated and list the first 5.,"MATCH (s:Stream)
WHERE NOT exists((s)-[:HAS_TEAM]->(:Team))
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  not { team_membership (member_stream: $s); };
limit 5;
fetch { ""stream_name"": $sn, ""stream_url"": $su };"
315,Name the first 5 users who are VIPs in streams with descriptions mentioning 'fun'.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.description CONTAINS 'fun'
RETURN u.name
LIMIT 5","match
  $s isa stream, has description $d;
  $d like ""%fun%"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
317,List the first 5 streams where the game name and the stream name are the same.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.name = g.name
RETURN s.name AS stream_name, g.name AS game_name
LIMIT 5","match
  $s isa stream, has name $n;
  $g isa game, has name $n;
  game_play (streaming_channel: $s, played_game: $g);
limit 5;
fetch { ""stream_name"": $n, ""game_name"": $n };"
318,"Who are the first 5 users who have been VIPs in streams with fewer than 10,000 followers?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.followers < 10000
RETURN u.name AS user, s.name AS stream
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f, has created_at $ca;
  $f < 10000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $ca asc;
limit 5;
fetch { ""user"": $un, ""stream"": $sn };"
319,What are the first 3 streams that have a user chatter who also has a moderator role in another stream?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(otherStream:Stream)
RETURN s.name AS stream, u.name AS chatter
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderating_user: $u, moderated_channel: $other);
  $u has name $un;
sort $ca asc;
limit 3;
fetch { ""stream"": $sn, ""chatter"": $un };"
324,What are the URLs of the first 3 streams with the most chatters?,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.url AS stream_url, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has url $u;
  chat_activity (channel_with_chatters: $s, chatting_user: $c);
reduce $chatter_count = count($c) groupby $u;
sort $chatter_count desc;
limit 3;"
325,Who are the first 5 moderators in streams that play 'VALORANT'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'VALORANT'})
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name AS moderator
ORDER BY m.name
LIMIT 5","match
  $g isa game, has name ""VALORANT"";
  game_play (streaming_channel: $s, played_game: $g);
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
limit 5;
fetch { ""moderator"": $mn };"
327,Which streams have the description mentioning 'enjoy' and list the first 3.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'enjoy'
RETURN s.name, s.description
LIMIT 3","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%enjoy%"";
limit 3;
fetch { ""name"": $sn, ""description"": $d };"
328,What are the first 5 streams that have a moderator with the same name as the stream's user?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE s.name = u.name
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 5","match
  $s isa stream, has name $n, has url $u;
  moderation (moderated_channel: $s, moderating_user: $usr);
  $usr has name $n;
limit 5;
fetch { ""stream_name"": $n, ""stream_url"": $u };"
329,Name the first 3 users who are chatters in the most streams with different games.,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(g:Game)
WITH u, count(DISTINCT g) AS num_games
ORDER BY num_games DESC
LIMIT 3
RETURN u.name AS user, num_games","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_games = count($g) groupby $un;
sort $num_games desc;
limit 3;"
330,List the first 5 streams that have a team and a game that both have the letter 'E' in them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team), (s)-[:PLAYS]->(g:Game)
WHERE t.name CONTAINS 'E' AND g.name CONTAINS 'E'
RETURN s.name AS stream, t.name AS team, g.name AS game
LIMIT 5","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
  $tn like ""%E%"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
  $gn like ""%E%"";
limit 5;
fetch { ""stream"": $sn, ""team"": $tn, ""game"": $gn };"
333,"Which streams have a follower count between 200,000 and 500,000, listing the first 5?","MATCH (s:Stream)
WHERE s.followers >= 200000 AND s.followers <= 500000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 200000;
  $f <= 500000;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
334,Who are the first 5 users who are chatters and VIPs in the same streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)<-[:VIP]-(u)
RETURN DISTINCT u.name AS user
LIMIT 5","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  vip_status (vip_user: $u, channel_with_vips: $s);
limit 5;
fetch { ""user"": $un };"
336,Who are the first 5 users who have moderated streams with descriptions mentioning 'professional'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.description CONTAINS 'professional'
RETURN u.name AS user, s.name AS stream
ORDER BY u.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%professional%"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 5;
fetch { ""user"": $un, ""stream"": $sn };"
337,List the first 5 streams where the user and moderator have the same name.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE s.name = u.name
RETURN s.name, s.url
LIMIT 5","match
  $s isa stream, has name $n, has url $u;
  moderation (moderated_channel: $s, moderating_user: $usr);
  $usr has name $n;
limit 5;
fetch { ""name"": $n, ""url"": $u };"
338,Which streams have a total view count of over 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 10000000
RETURN s.name, s.total_view_count","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 10000000;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
339,List the top 5 streams by follower count.,"MATCH (s:Stream)
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
340,"What are the names of games played by streams with more than 100,000 followers?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 100000
RETURN DISTINCT g.name","match
  $s isa stream, has followers $f;
  $f > 100000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
341,"Which users are moderators for streams with more than 500,000 total views?","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u.name AS user, s.name AS stream, s.total_view_count AS views","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 500000;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn, ""views"": $tvc };"
342,What are the descriptions of streams that play the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.description IS NOT NULL
RETURN s.description","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has description $d;
fetch { ""description"": $d };"
343,Which streams have 'en' as their language and more than 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count > 1000000
RETURN s.name AS stream_name, s.total_view_count AS total_views","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
344,List the names of all teams created before 2015.,"MATCH (t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN t.name","match
  $t isa team, has name $tn, has created_at $ca;
  $ca < 2015-01-01;
fetch { ""name"": $tn };"
345,Which streams are part of the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
fetch { ""stream_name"": $sn };"
346,What are the URLs of the top 3 streams by total view count?,"MATCH (s:Stream)
RETURN s.url AS stream_url
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has url $u, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream_url"": $u };"
347,Which users have chatted with more than 5 different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams > 5
RETURN u.name as user, num_streams as streams_chatted_with","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;"
348,List all users who are VIPs in at least two different streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_vip_streams
WHERE num_vip_streams >= 2
RETURN u.name as user, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_vip_streams = count($s) groupby $un;
sort $num_vip_streams desc;"
349,Find streams that have both 'MODERATOR' and 'VIP' relationships.,"MATCH (s:Stream)
WHERE exists{ (s)-[:MODERATOR]->(:User) } AND exists{ (s)-[:VIP]->(:User) }
RETURN s","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $m);
  vip_status (channel_with_vips: $s, vip_user: $v);
fetch { ""name"": $sn };"
350,"Which games are played by streams that have a total view count greater than 500,000?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 500000
RETURN DISTINCT g.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
351,How many users are moderators for the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})<-[:MODERATOR]-(u:User)
RETURN count(u) AS num_moderators","match
  $s isa stream, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderators = count($u);"
352,"What are the first 3 languages spoken in streams with more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
353,"Which streams were created between 2015 and 2020 and have more than 100,000 followers?","MATCH (s:Stream)
WHERE s.createdAt >= datetime('2015-01-01') AND s.createdAt < datetime('2021-01-01')
  AND s.followers > 100000
RETURN s","match
  $s isa stream, has created_at $ca, has followers $f;
  $ca >= 2015-01-01;
  $ca < 2021-01-01;
  $f > 100000;
fetch { ""name"": $s.name, ""created_at"": $ca, ""followers"": $f };"
354,Identify streams that were created on or after 2018 and are part of teams.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.createdAt >= date(""2018-01-01"")
RETURN s","match
  $s isa stream, has created_at $ca;
  $ca >= 2018-01-01;
  team_membership (member_stream: $s, organization: $t);
fetch { ""name"": $s.name, ""created_at"": $ca };"
355,What are the follower counts of streams that play 'Rust' and have 'en' as their language?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'}), 
      (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WHERE s.followers IS NOT NULL
RETURN s.name AS stream, s.followers AS followerCount","match
  $g isa game, has name ""Rust"";
  $l isa language, has name ""en"";
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has followers $f;
fetch { ""stream"": $sn, ""followerCount"": $f };"
356,Which users are VIPs for the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)<-[:VIP]-(u:User)
RETURN u.name AS user, s.name AS stream","match
  $s isa stream, has name $sn, has followers $f;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $f desc;
limit 1;
fetch { ""user"": $un, ""stream"": $sn };"
357,What are the names of users who have moderated other users?,"MATCH (u:User)-[:MODERATOR]->(otherUser:User)
RETURN DISTINCT u.name","match
  moderation (moderating_user: $u, moderated_user: $other);
  $u has name $un;
fetch { ""name"": $un };"
358,Which streams have no team associations?,"MATCH (s:Stream)
WHERE NOT exists{ (s)-[:HAS_TEAM]->(:Team) }
RETURN s","match
  $s isa stream, has name $sn;
  not { team_membership (member_stream: $s); };
fetch { ""name"": $sn };"
359,Find the descriptions of streams that have chatted with the user '9linda'.,"MATCH (s:Stream)-[:CHATTER]->(:User {name: '9linda'})
WHERE s.description IS NOT NULL
RETURN s.description","match
  $u isa user, has name ""9linda"";
  chat_activity (chatting_channel: $s, chatting_user: $u);
  $s has description $d;
fetch { ""description"": $d };"
360,Which teams were formed in 2020?,"MATCH (t:Team)
WHERE t.createdAt >= date(""2020-01-01"") AND t.createdAt < date(""2021-01-01"")
RETURN t.name AS team","match
  $t isa team, has name $tn, has created_at $ca;
  $ca >= 2020-01-01;
  $ca < 2021-01-01;
fetch { ""team"": $tn };"
361,How many languages are associated with streams that have over 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN count(distinct l) as num_languages","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  language_usage (channel: $s, used_language: $l);
reduce $num_languages = count($l);"
362,What is the total view count of streams that are moderated by 'itsbigchase'?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN sum(s.total_view_count) AS total_views","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has total_view_count $tvc;
reduce $total_views = sum($tvc);"
363,"Which streams have the user 'creightonolsen' as a chatter and have more than 100,000 views?","MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'creightonolsen'})
WHERE s.total_view_count > 100000
RETURN s","match
  $u isa user, has name ""creightonolsen"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  $s has total_view_count $tvc;
  $tvc > 100000;
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
364,List the streams where 'romandoduik' is a chatter.,"MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'romandoduik'})
RETURN s.name AS stream_name, s.url AS stream_url","match
  $u isa user, has name ""romandoduik"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
365,Which users are moderators in streams that play 'Rust'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user, s.name AS stream","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn };"
366,How many streams has each team associated with them?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;"
367,What are the properties of the stream with the highest number of followers?,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 1","match
  $s isa stream, has followers $f;
sort $f desc;
limit 1;
fetch { ""name"": $s.name, ""followers"": $f, ""total_view_count"": $s.total_view_count };"
368,List all games that have been played by streams associated with the 'ESO Stream Team'.,"MATCH (team:Team {name: 'ESO Stream Team'})<-[:HAS_TEAM]-(stream:Stream)-[:PLAYS]->(game:Game)
RETURN DISTINCT game.name","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
369,"Which language is most commonly associated with streams that have more than 500,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 500000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 1","match
  $s isa stream, has followers $f;
  $f > 500000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 1;"
370,Identify streams that have a creation date before 2010.,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s","match
  $s isa stream, has created_at $ca;
  $ca < 2010-01-01;
fetch { ""name"": $s.name, ""created_at"": $ca };"
371,Which streams have users with the role of both VIP and moderator?,"MATCH (s:Stream)
WHERE exists{ (s)<-[:VIP]-(:User)-[:MODERATOR]->(s) }
RETURN s","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $sn };"
372,List the top 5 users by the number of streams they moderate.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;"
373,What are the descriptions of the streams with the oldest creation dates?,"MATCH (s:Stream)
WITH s
ORDER BY s.createdAt
LIMIT 5
RETURN s.description","match
  $s isa stream, has description $d, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""description"": $d };"
374,Which games are played by streams that are part of teams created after 2017?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2017-01-01')
WITH s
MATCH (s)-[:PLAYS]->(g:Game)
RETURN DISTINCT g.name","match
  $t isa team, has created_at $ca;
  $ca > 2017-01-01;
  team_membership (member_stream: $s, organization: $t);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
375,How many streams are associated with each language?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(s) AS streamCount
ORDER BY streamCount DESC","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $streamCount = count($s) groupby $ln;
sort $streamCount desc;"
376,List the top 3 streams that have the most chatters.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $c);
reduce $chatter_count = count($c) groupby $sn;
sort $chatter_count desc;
limit 3;"
377,Which users have been VIPs in streams with a total view count over 5 million?,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 5000000
RETURN u.name AS user, s.name AS stream, s.total_view_count AS views","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 5000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn, ""views"": $tvc };"
378,Find streams where 'itsbigchase' is a moderator.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $s.name, ""url"": $s.url };"
379,What are the follower counts for streams that have 'ru' as their language?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN s.name AS stream_name, s.followers AS follower_count","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has followers $f;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
380,List all users who have chatted with the stream 'itsbigchase'.,"MATCH (u:User)-[:CHATTER]->(s:Stream {name: 'itsbigchase'})
RETURN u","match
  $s isa stream, has name ""itsbigchase"";
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""name"": $u.name };"
381,Which streams are connected to the game 'Rust' and have at least one VIP?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE exists{ (s)<-[:VIP]-() }
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $v);
fetch { ""name"": $s.name };"
382,What are the URLs of streams where 'itsbigchase' is a moderator?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s.url","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""url"": $s.url };"
383,What are the properties of the streams where '9linda' is a VIP?,"MATCH (s:Stream)<-[:VIP]-(:User {name: '9linda'})
RETURN s.createdAt, s.id, s.description, s.url, s.name, s.followers, s.total_view_count","match
  $u isa user, has name ""9linda"";
  vip_status (vip_user: $u, channel_with_vips: $s);
fetch { ""name"": $s.name, ""url"": $s.url, ""description"": $s.description, ""followers"": $s.followers, ""total_view_count"": $s.total_view_count };"
384,What are the names of the top 5 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
385,Which games have been played by streams with more than 1 million total views?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN DISTINCT g.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
386,List the names of 3 streams that are conducted in the English language.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn;
limit 3;
fetch { ""name"": $sn };"
387,Which streams have moderators who are also users?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
RETURN s, u","match
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""stream"": $s.name, ""user"": $u.name };"
388,What are the names of the 3 newest teams in the database?,"MATCH (t:Team)
RETURN t.name
ORDER BY t.createdAt DESC
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""name"": $tn };"
389,How many streams are associated with the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN count(s) AS num_streams","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_streams = count($s);"
390,What are the URLs of the top 3 streams by total view count?,"MATCH (s:Stream)
RETURN s.url AS stream_url
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has url $u, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream_url"": $u };"
391,Which users are moderators in more than one stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;"
392,List the streams that have more than 5 million followers.,"MATCH (s:Stream)
WHERE s.followers > 5000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers DESC","match
  $s isa stream, has name $sn, has followers $f;
  $f > 5000000;
sort $f desc;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
393,What are the names of streams that play 'Grand Theft Auto V' and have English as their language?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Grand Theft Auto V'})
WHERE (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
RETURN s.name","match
  $g isa game, has name ""Grand Theft Auto V"";
  $l isa language, has name ""en"";
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $s has name $sn;
fetch { ""name"": $sn };"
394,Which users are VIPs in the stream named 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})<-[:VIP]-(u:User)
RETURN u.name AS user","match
  $s isa stream, has name ""itsbigchase"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un };"
395,How many streams are part of the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN count(s)","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
reduce $count = count($s);"
396,Which games are played by the oldest streams in the database?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, g
ORDER BY s.createdAt
LIMIT 1
RETURN g.name AS game","match
  $s isa stream, has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 1;
fetch { ""game"": $gn };"
397,Find 3 languages spoken in streams with the highest number of followers.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, max(s.followers) AS max_followers
ORDER BY max_followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $max_followers = max($f) groupby $ln;
sort $max_followers desc;
limit 3;"
398,What are the names of users who are both moderators and VIPs in any stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)<-[:VIP]-(u)
RETURN DISTINCT u.name","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s, moderating_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""name"": $un };"
399,List the top 5 streams based on their creation date.,"MATCH (s:Stream)
RETURN s.name, s.createdAt
ORDER BY s.createdAt DESC
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca };"
400,What are the descriptions of the streams with the least followers?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s.description
ORDER BY s.followers
LIMIT 1","match
  $s isa stream, has description $d, has followers $f;
sort $f asc;
limit 1;
fetch { ""description"": $d };"
