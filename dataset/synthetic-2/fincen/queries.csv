original_index,question,cypher,typeql
0,Which 3 entities have the most relationships with filings where the originator bank country is 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'United Kingdom'
WITH e, count(f) as num_filings
RETURN e.name, num_filings
ORDER BY num_filings DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""United Kingdom"";
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""name"": $e.name, ""num_filings"": $count };"
1,List the top 3 filings by amount where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""originator_bank"": $f.originator_bank,
  ""beneficiary_bank"": $f.beneficiary_bank
};"
2,What are the first 3 filings where the originator bank's country is 'Angola'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'})
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name ""Angola"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$f has period_begin $begin;
sort $begin;
limit 3;
fetch {
  ""filing"": $f
};"
3,Which 3 filings involve entities that are both the originator and beneficiary of the filing?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)<-[:BENEFITS]-(f)
RETURN f
LIMIT 3","match
$f isa filing;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
limit 3;
fetch { ""filing"": $f.filing_id };"
4,List the top 3 filings where the beneficiary bank is 'Barclays Bank Plc' with the amount specified.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
RETURN f.sar_id, f.amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""sar_id"": $f.sar_id,
  ""amount"": $a
};"
5,What are the first 3 entities linked to countries with the top-level domain '.sg'?,"MATCH (c:Country {tld: 'SG'})<-[:COUNTRY]-(e:Entity)
RETURN e.name, e.id
LIMIT 3","match
$c isa country, has tld ""SG"";
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
limit 3;
fetch {
  ""name"": $e.name,
  ""id"": $e.entity_id
};"
7,Which 3 entities have filed the most transactions where the amount is greater than 1 million USD?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
WITH e, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 3
RETURN e.name AS entity_name, transaction_count","match
$e isa fincen_entity, has name $name;
$f isa filing, has amount $a;
$a > 1000000;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $name,
  ""transaction_count"": $count
};"
8,List the top 3 filings with the smallest amounts.,"MATCH (f:Filing)
RETURN f.sar_id, f.amount
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has sar_id $sid, has amount $a;
sort $a asc;
limit 3;
fetch {
  ""sar_id"": $sid,
  ""amount"": $a
};"
9,Identify the top 5 entities based on the number of filings where they have acted as both originator and beneficiary.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(e)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $name;
$f isa filing;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
reduce $num_filings = count($f) groupby $e, $name;
sort $num_filings desc;
limit 5;
fetch {
  ""entity_name"": $name,
  ""num_filings"": $num_filings
};"
10,List the top 3 countries based on the number of beneficiary banks.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, count(DISTINCT e) AS beneficiary_count
ORDER BY beneficiary_count DESC
LIMIT 3
RETURN country, beneficiary_count","match
$c isa country, has name $country;
$e isa fincen_entity;
benefits (beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
select $c, $country, $e;
distinct;
reduce $beneficiary_count = count($e) groupby $c, $country;
sort $beneficiary_count desc;
limit 3;
fetch { ""country"": $country, ""beneficiary_count"": $beneficiary_count };"
11,What are the first 3 filings with a beneficiary bank located in 'United Kingdom' that involve an amount greater than 1 million USD?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing,
  has beneficiary_bank_country ""United Kingdom"",
  has amount $a,
  has begin_date $bd;
$a > 1000000;
benefits (filing: $f, beneficiary: $e);
sort $bd;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""begin_date"": $f.begin_date
};"
12,List the top 3 countries by the number of filings where the originator bank is located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 3;
fetch { ""country"": $country, ""filings_count"": $filings_count };"
13,Which 3 entities have the most filings that concern entities based in 'China'?,"MATCH (c:Country {name: 'China'})<-[:COUNTRY]-(e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$c isa country, has name ""China"";
entity_country (fincen_entity: $e, country: $c);
$e has name $entity_name;
concerns (filing: $f, concerned_entity: $e);
reduce $num_filings = count($f) groupby $e, $entity_name;
sort $num_filings desc;
limit 3;
fetch { ""entity_name"": $entity_name, ""num_filings"": $num_filings };"
14,Identify the top 5 filings where the beneficiary bank is 'United Overseas Bank Ltd' and the amount specified.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'United Overseas Bank Ltd'
RETURN f.sar_id AS SAR_ID, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank ""United Overseas Bank Ltd"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""SAR_ID"": $f.sar_id,
  ""Amount"": $a
};"
15,List the top 3 filings involving entities from 'Singapore' based on the amount.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$c isa country, has name ""Singapore"";
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has amount $a;
filed (filer: $e, filing: $f);
sort $a desc;
limit 3;
fetch {
  ""filing"": $f
};"
16,Which 3 countries have the most entities involved as beneficiaries in filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c.name AS country, COUNT(e) AS entityCount
RETURN country, entityCount
ORDER BY entityCount DESC
LIMIT 3","match
$c isa country, has name $country_name;
$e isa fincen_entity;
entity_country (country: $c, fincen_entity: $e);
benefits (beneficiary: $e, filing: $f);
reduce $entity_count = count($e) groupby $c, $country_name;
sort $entity_count desc;
limit 3;
fetch { ""country"": $country_name, ""entityCount"": $entity_count };"
17,"Find the top 5 filings where the originator bank's country is 'Angola' and the amount is over 100,000 USD.","MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'})
WHERE f.amount > 100000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a > 100000;
$e isa fincen_entity;
$c isa country, has name ""Angola"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 5;
fetch {
  ""filing"": $f
};"
19,List the top 3 entities based on the number of relationships they have with countries.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH e, count(c) as countryCount
ORDER BY countryCount DESC
LIMIT 3
RETURN e.name as entityName, countryCount","match
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($c) groupby $e;
sort $count desc;
limit 3;
fetch { ""entityName"": $e.name, ""countryCount"": $count };"
21,What are the first 3 countries that have the most entities with filings in the database?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(DISTINCT e.id) AS entity_count
ORDER BY entity_count DESC
LIMIT 3
RETURN country, entity_count","match
$c isa country, has name $country;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
select $c, $country, $e;
distinct;
reduce $entity_count = count($e) groupby $c, $country;
sort $entity_count desc;
limit 3;
fetch {
  ""country"": $country,
  ""entity_count"": $entity_count
};"
22,"Find the top 5 filings where the beneficiary bank country is 'Singapore' and the amount is over 500,000 USD.","MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 500000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing,
    has beneficiary_bank_country ""Singapore"",
    has amount $a;
$a > 500000;
sort $a desc;
limit 5;
fetch {
    ""filing"": { $f.* }
};"
24,List the top 5 countries by the number of entities based on the [:COUNTRY] relationship.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 5
RETURN country, entity_count","match
$e isa fincen_entity;
$c isa country, has name $country_name;
entity_country (fincen_entity: $e, country: $c);
reduce $entity_count = count($e) groupby $c, $country_name;
sort $entity_count desc;
limit 5;
fetch {
  ""country"": $country_name,
  ""entity_count"": $entity_count
};"
25,List the first 3 entities that have filed the most transactions with a beneficiary in 'China'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WITH e, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 3
RETURN e.name AS entity_name, transaction_count","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""China"";
filed (filer: $e, filing: $f);
benefits (filing: $f, beneficiary: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""transaction_count"": $count };"
26,Which 5 entities have their locations in countries with the top-level domain '.cn'?,"MATCH (c:Country {tld: 'CN'})<-[:COUNTRY]-(e:Entity)
RETURN e.name, e.location
LIMIT 5","match
$c isa country, has tld ""CN"";
$e isa fincen_entity, has name $n;
entity_country (fincen_entity: $e, country: $c);
limit 5;
fetch {
  ""name"": $n,
  ""country_code"": $e.country_code
};"
27,Find the top 3 filings with the earliest begin dates and amounts over 100000.,"MATCH (f:Filing)
WHERE f.amount > 100000
RETURN f
ORDER BY f.begin ASC
LIMIT 3","match
$f isa filing, has amount $a, has begin_date $bd;
$a > 100000;
sort $bd asc;
limit 3;
fetch {
  ""filing"": $f
};"
28,Which 5 filings ended the latest and concern entities in 'China'?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
RETURN f
ORDER BY f.end DESC
LIMIT 5","match
$f isa filing, has period_end $end;
$c isa country, has name ""China"";
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $end desc;
limit 5;
fetch {
  ""filing"": $f
};"
29,List the top 3 filings with originator banks in 'Singapore' and amounts exceeding 1500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.originator_bank_country = 'Singapore' AND f.amount > 1500000
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""Singapore"", has amount $a;
$a > 1500000;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
30,What are the top 5 entities linked to the most filings where the beneficiary bank country is 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
$e isa fincen_entity, has name $name;
benefits (filing: $f, beneficiary: $e);
reduce $num_filings = count($f) groupby $e, $name;
sort $num_filings desc;
limit 5;
fetch {
  ""entity_name"": $name,
  ""num_filings"": $num_filings
};"
31,Which 3 countries have entities that have filed the most filings with beneficiary banks in 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = 'Singapore'
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing, has beneficiary_bank_country ""Singapore"";
$e isa fincen_entity;
$c isa country, has name $country_name;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $filings_count = count($f) groupby $country_name;
sort $filings_count desc;
limit 3;
fetch {
  ""country"": $country_name,
  ""filings_count"": $filings_count
};"
32,List the top 5 filings where the originator bank country is 'Singapore' and the amount is between 500000 and 2000000.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.amount >= 500000 AND f.amount <= 2000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing,
    has originator_bank_country ""Singapore"",
    has amount $a;
$a >= 500000;
$a <= 2000000;
sort $a desc;
limit 5;
fetch {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""originator_bank_country"": $f.originator_bank_country,
    ""originator_bank"": $f.originator_bank,
    ""beneficiary_bank"": $f.beneficiary_bank
};"
33,What are the top 3 entities with the most filings that benefit entities in 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
WITH f.filer_org_name_id AS entity_id, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
MATCH (e:Entity {id: entity_id})
RETURN e.name AS entity_name, filing_count","match
$f isa filing, has filer_org_name $name;
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $name;
sort $count desc;
limit 3;
fetch { ""entity_name"": $name, ""filing_count"": $count };"
34,Which 5 countries have entities that are beneficiaries in filings where the amount is over 2500000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2500000
RETURN c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a > 2500000;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $entity_count = count($e) groupby $c;
sort $entity_count desc;
limit 5;
fetch {
  ""country"": $c.name,
  ""entity_count"": $entity_count
};"
35,List the top 3 filings where the originator bank is 'CIMB Bank Berhad' and the beneficiary bank country is 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity),
      (f)-[:BENEFITS]->(b:Entity),
      (b)-[:COUNTRY]->(c:Country)
WHERE f.originator_bank = 'CIMB Bank Berhad'
  AND f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing,
  has originator_bank ""CIMB Bank Berhad"",
  has beneficiary_bank_country ""United Kingdom"",
  has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""originator_bank"": $f.originator_bank,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""amount"": $a
};"
36,What are the top 5 countries with entities that have originated filings with the highest average amounts?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:ORIGINATOR]->(e)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, AVG(f.amount) AS avg_amount
ORDER BY avg_amount DESC
LIMIT 5
RETURN country, avg_amount","match
$e isa fincen_entity;
$f isa filing, has amount $a;
originator (originating_entity: $e, filing: $f);
entity_country (fincen_entity: $e, country: $c);
reduce $avg_amount = mean($a) groupby $c;
sort $avg_amount desc;
limit 5;
fetch {
  ""country"": $c.name,
  ""avg_amount"": $avg_amount
};"
37,Identify the top 5 filings where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $f.amount,
    ""originator_bank"": $f.originator_bank
  }
};"
38,Find the first 3 filings that originated from entities in Singapore.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$e isa fincen_entity;
$c isa country, has name ""Singapore"";
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e, filing: $f);
$f has period_begin $pb;
sort $pb asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""period_begin"": $f.period_begin,
  ""period_end"": $f.period_end,
  ""amount"": $f.amount
};"
39,What are the top 5 entities that have filed the most transactions with a beneficiary in the United Kingdom?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(:Entity)-[:COUNTRY]->(c:Country {name: ""United Kingdom""})
WITH e, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 5
RETURN e.name AS entity_name, transaction_count","match
$e isa fincen_entity, has name $ename;
$f isa filing;
filed (filer: $e, filing: $f);
$b isa fincen_entity;
benefits (filing: $f, beneficiary: $b);
$c isa country, has name ""United Kingdom"";
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""transaction_count"": $count };"
40,Which 3 filings involved the highest amounts between March 2015 and September 2015?,"MATCH (f:Filing)
WHERE f.begin_date_format >= ""2015-03-01T00:00:00Z"" AND f.end_date_format <= ""2015-09-30T23:59:59Z""
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has begin_date_format $bdf, has end_date_format $edf, has amount $a;
$bdf >= ""2015-03-01T00:00:00Z"";
$edf <= ""2015-09-30T23:59:59Z"";
sort $a desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a,
  ""begin_date"": $bdf,
  ""end_date"": $edf
};"
41,Identify the top 3 countries where the originator banks of filings are located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $country_name;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $filings_count = count($f) groupby $country_name;
sort $filings_count desc;
limit 3;
fetch { ""country"": $country_name, ""filings_count"": $filings_count };"
42,"What are the first 5 filings with an amount greater than 500,000 USD?","MATCH (f:Filing)
WHERE f.amount > 500000
RETURN f
ORDER BY f.begin
LIMIT 5","match
$f isa filing, has amount $a, has period_begin $b;
$a > 500000;
sort $b;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount,
  ""period_begin"": $f.period_begin
};"
43,List the top 3 originator banks that have initiated filings with beneficiary banks located in Singapore.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})
RETURN f.originator_bank AS OriginatorBank, COUNT(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3","match
$f isa filing, has originator_bank $ob;
originator ($f, $e);
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $b);
$b isa fincen_entity;
entity_country (fincen_entity: $b, country: $c);
$c isa country, has name ""Singapore"";
reduce $count = count($f) groupby $ob;
sort $count desc;
limit 3;
fetch { ""OriginatorBank"": $ob, ""NumberOfFilings"": $count };"
44,Which 3 entities have been involved as beneficiaries in the most filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $n;
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""entity_name"": $n, ""num_filings"": $count };"
45,Find the top 5 filings by amount where the beneficiary bank's country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country
};"
46,What are the first 3 entities that have filed a transaction where the originator and beneficiary banks are from different countries?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country <> f.beneficiary_bank_country
WITH e, f
ORDER BY f.begin
LIMIT 3
RETURN e.name AS entity_name, f.sar_id AS transaction_id, f.begin AS transaction_begin_date","match
$e isa fincen_entity;
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc, has begin_date $bd;
originator (filing: $f, originating_entity: $e);
not { $obc == $bbc; };
sort $bd;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""transaction_id"": $f.sar_id,
  ""transaction_begin_date"": $bd
};"
47,Identify the top 5 filings where the originator bank's country is 'Singapore' and the beneficiary bank's country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing,
    has originator_bank_country ""Singapore"",
    has beneficiary_bank_country ""United Kingdom"",
    has amount $a;
sort $a desc;
limit 5;
fetch {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""originator_bank_country"": $f.originator_bank_country,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country
};"
49,Identify the top 5 filings by amount where the beneficiary bank's country is 'Singapore'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country
  }
};"
50,What are the first 3 filings with a beneficiary bank located in 'Singapore' that have the smallest amounts?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a;
sort $a asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country
};"
51,Which 3 entities have the most relationships with filings where the beneficiary bank country is 'Angola'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'Angola'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""Angola"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
53,Which 3 entities have the most filings as originators and are located in 'China'?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE e.country = 'CHN'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has country_code ""CHN"";
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
54,What are the names of the top 3 originator banks that have initiated the most filings with a beneficiary in 'USA'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(c:Country {code: 'USA'})
RETURN e.name AS originator_bank, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $b);
entity_country (fincen_entity: $b, country: $c);
$c has code ""USA"";
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $e.name, ""filings_count"": $count };"
55,Identify the top 5 beneficiary banks that have received the highest amounts from filings where the originator bank country is 'Germany'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Germany'
RETURN f.beneficiary_bank AS BeneficiaryBank, SUM(f.amount) AS TotalAmount
ORDER BY TotalAmount DESC
LIMIT 5","match
$f isa filing, has originator_bank_country ""Germany"", has beneficiary_bank $bb, has amount $a;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $bb;
sort $total desc;
limit 5;"
56,Which 3 countries have the most filings where the originator bank is based in their territory?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WHERE f.originator_bank_country = c.name
RETURN c.name AS country, COUNT(f) AS filings
ORDER BY filings DESC
LIMIT 3","match
$c isa country, has name $cn;
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e, filing: $f);
$f isa filing, has originator_bank_country $obc;
$obc == $cn;
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""filings"": $count };"
57,List the top 3 filings by amount that involve an originator bank from 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
RETURN f.sar_id, f.amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has sar_id $sid, has amount $amt;
$e isa fincen_entity;
$c isa country, has name ""Singapore"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $amt desc;
limit 3;
fetch {
  ""sar_id"": $sid,
  ""amount"": $amt
};"
58,What are the top 3 countries by the number of entities that have filed filings with a beneficiary bank in 'France'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = 'France'
WITH c.name AS country, COUNT(DISTINCT e.id) AS entity_count
RETURN country, entity_count
ORDER BY entity_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""France"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
select $e, $c, $country;
distinct;
reduce $entity_count = count($e) groupby $c, $country;
sort $entity_count desc;
limit 3;
fetch { ""country"": $country, ""entity_count"": $entity_count };"
59,Identify the top 5 countries by the number of filings where the beneficiary bank is located.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 5;
fetch { ""country"": $country, ""filings_count"": $filings_count };"
60,Which 3 entities have originated the most filings with a beneficiary bank in 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN e.name AS entity_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
originator (filing: $f, originating_entity: $e);
$e has name $n;
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""entity_name"": $n, ""filings_count"": $count };"
61,List the first 3 filings where the beneficiary bank country is 'Spain' and the amount is over 5 million USD.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Spain' AND f.amount > 5000000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Spain"", has amount $a;
$a > 5000000;
$f has period_begin $pb;
sort $pb asc;
limit 3;
fetch {
  ""filing"": $f
};"
62,What are the top 3 countries by the number of filings where they are the beneficiary bank country?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = c.name
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country $bbc;
reduce $count = count($f) groupby $bbc;
sort $count desc;
limit 3;
fetch { ""country"": $bbc, ""filings_count"": $count };"
63,List the first 3 entities that have been beneficiaries in filings with an amount over 50 million USD.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 50000000
RETURN e.name AS beneficiary_entity
LIMIT 3","match
$f isa filing, has amount $a;
$a > 50000000;
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity;
limit 3;
fetch {
  ""beneficiary_entity"": $e.name
};"
64,Identify the top 5 entities by number of filings where the originator bank is 'HSBC'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank = 'HSBC'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $name;
$f isa filing, has originator_bank ""HSBC"";
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e, $name;
sort $num_filings desc;
limit 5;
fetch { ""entity_name"": $name, ""num_filings"": $num_filings };"
65,List the first 3 filings with the highest number of transactions that involve a beneficiary bank from 'Japan'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Japan'})
RETURN f
ORDER BY f.number DESC
LIMIT 3","match
$f isa filing, has number $n;
$e isa fincen_entity;
$c isa country, has name ""Japan"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
sort $n desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""number"": $n
};"
66,What are the top 3 countries by the number of filings where they appear as the originator bank country?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country_name;
reduce $filings_count = count($f) groupby $c, $country_name;
sort $filings_count desc;
limit 3;
fetch { ""country"": $country_name, ""filings_count"": $filings_count };"
67,Identify the top 5 filings by amount where the originator bank is 'The Bank of New York Mellon Corp.'.,"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
WHERE f.originator_bank = ""The Bank of New York Mellon Corp.""
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has originator_bank ""The Bank of New York Mellon Corp."", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_bank"": $f.originator_bank,
    ""amount"": $a
  }
};"
68,Which 3 entities have filed the most number of filings concerning banks in 'Australia'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(b:Entity)-[:COUNTRY]->(c:Country {name: 'Australia'})
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""Australia"";
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
69,List the first 3 filings where the originator bank's country is 'Italy' and the amount transferred is over 10 million USD.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'Italy' AND f.amount > 10000000
RETURN f
ORDER BY f.begin
LIMIT 3","match
  $f isa filing, has amount $amt, has period_begin $begin;
  $amt > 10000000;
  originator (filing: $f, originating_entity: $e);
  entity_country (fincen_entity: $e, country: $c);
  $c has name ""Italy"";
sort $begin asc;
limit 3;
fetch {
  ""filing"": $f
};"
70,What are the top 5 entities by amount received in filings where they are the beneficiary?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
WITH e, SUM(f.amount) AS total_received
ORDER BY total_received DESC
LIMIT 5
RETURN e.name AS entity_name, total_received","match
$e isa fincen_entity, has name $name;
$f isa filing, has amount $a;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $e, $name;
sort $total desc;
limit 5;
fetch { ""entity_name"": $name, ""total_received"": $total };"
71,Which 3 filings involve an entity from 'Mexico' as the beneficiary and the amount is over 500000 USD?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Mexico'})
MATCH (f:Filing)-[:BENEFITS]->(e)
WHERE f.amount > 500000
RETURN f
LIMIT 3","match
$c isa country, has name ""Mexico"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has amount $a;
$a > 500000;
benefits (filing: $f, beneficiary: $e);
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount
};"
72,Identify the top 5 countries where the originator banks of the filings are based.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $country;
sort $filings_count desc;
limit 5;
fetch { ""country"": $country, ""filings_count"": $filings_count };"
73,List the top 3 entities by the number of filings they are concerned in.,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
74,Which 3 countries have the most entities linked as beneficiaries in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3
RETURN country, entityCount","match
$c isa country, has name $cn;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""entityCount"": $count };"
76,Identify the top 5 filings by number that involve 'CIMB Bank Berhad' as the originator.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has number $n;
sort $n desc;
limit 5;
fetch {
  ""number"": $n,
  ""filing_id"": $f.filing_id
};"
77,What are the top 3 countries by the number of filings where they appear as the originator bank country?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $country;
sort $filings_count desc;
limit 3;
fetch { ""country"": $country, ""filings_count"": $filings_count };"
78,List the top 3 countries by the number of filings that have a beneficiary bank based in their territory.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = c.name
WITH c.name AS country, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN country, num_filings","match
$f isa filing, has beneficiary_bank_country $bbc;
$c isa country, has name $cn;
$bbc == $cn;
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.name,
  ""num_filings"": $count
};"
79,Find the top 5 filings by number where the originator bank's country is 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has number $n;
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $n desc;
limit 5;
fetch {
  ""filing"": $f
};"
80,What are the first 3 entities that have filed transactions where the originator bank is located in 'Angola'?,MATCH (c:Country {name: 'Angola'})<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing {originator_bank_country: 'Angola'})\nRETURN e.name AS entity_name\nORDER BY f.begin\nLIMIT 3,"match\n$c isa country, has name ""Angola"";\n$e isa fincen_entity;\nentity_country (fincen_entity: $e, country: $c);\n$f isa filing, has originator_bank_country ""Angola"";\nfiled (filer: $e, filing: $f);\n$f has begin_date $bd;\nsort $bd asc;\nlimit 3;\nfetch {\n  ""entity_name"": $e.name\n};"
81,List the top 3 countries by the number of originator banks located there based on the filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(DISTINCT e.id) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN country, originator_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $country_name;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
select $e, $c, $country_name;
distinct;
reduce $count = count($e) groupby $c, $country_name;
sort $count desc;
limit 3;
fetch { ""country"": $country_name, ""originator_count"": $count };"
82,Which 3 filings involve the highest amounts where the beneficiary bank's country is 'United Kingdom' and the originator bank's country is 'Singapore'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has originator_bank_country ""Singapore"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country,
    ""originator_bank_country"": $f.originator_bank_country
  }
};"
83,Identify the top 5 entities based on the total amount of their filings where the beneficiary bank's country is 'Singapore'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
WITH e, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 5
RETURN e.name AS entityName, totalAmount","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
$f has beneficiary_bank_country ""Singapore"", has amount $a;
reduce $total = sum($a) groupby $e;
sort $total desc;
limit 5;
fetch { ""entityName"": $e.name, ""totalAmount"": $total };"
84,What are the first 3 countries that are linked to the most entities based on the [:COUNTRY] relationship?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3
RETURN c.name AS countryName, entityCount","match
$e isa fincen_entity;
$c isa country;
entity_country (fincen_entity: $e, country: $c);
reduce $entityCount = count($e) groupby $c;
sort $entityCount desc;
limit 3;
fetch {
  ""countryName"": $c.name,
  ""entityCount"": $entityCount
};"
85,List the top 3 filings where the originator bank is from a country with a top-level domain '.uk'.,"MATCH (c:Country {tld: 'uk'})<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$c isa country, has tld ""uk"";
entity_country (fincen_entity: $e, country: $c);
originator (filing: $f, originating_entity: $e);
$f has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount
};"
86,Which 3 entities have filed the most transactions where the beneficiary bank is located in 'United Kingdom'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 3
RETURN e.name AS entity_name, transaction_count","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""transaction_count"": $count };"
88,What are the first 3 filings with a beneficiary bank located in 'Angola' that involves the smallest amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'})
WHERE f.beneficiary_bank_country = 'Angola'
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Angola"", has amount $a;
sort $a asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""beneficiary_bank"": $f.beneficiary_bank,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country
};"
89,List the top 3 originator banks based on the number of filings where the beneficiary bank is located in 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f.originator_bank AS originator_bank, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has originator_bank $ob;
reduce $count = count($f) groupby $ob;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $ob, ""num_filings"": $count };"
90,List the top 3 countries connected to entities that have originated filings with amounts over 2000000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2000000
RETURN c.name AS country, COUNT(*) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 2000000;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""filings_count"": $count };"
91,Identify the top 5 countries based on the number of filings where the beneficiary bank is located.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = c.name
RETURN c.name AS country, COUNT(f) AS number_of_filings
ORDER BY number_of_filings DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country $bbc;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
$bbc == $cn;
reduce $count = count($f) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.name, ""number_of_filings"": $count };"
92,What are the first 3 entities that have filed transactions where the beneficiary bank is located in 'Singapore'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN e.name AS entity_name
ORDER BY f.begin
LIMIT 3","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""Singapore"", has period_begin $begin;
filed (filer: $e, filing: $f);
sort $begin asc;
limit 3;
fetch {
  ""entity_name"": $e.name
};"
93,Which 3 countries have beneficiary banks that received the highest total amounts in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN country, totalAmount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c;
sort $total desc;
limit 3;
fetch { ""country"": $c.name, ""totalAmount"": $total };"
94,What are the top 3 entities that have originated filings concerning banks in 'China'?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:CONCERNS]->(b:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""China"";
originator (originating_entity: $e, filing: $f);
concerns (filing: $f, concerned_entity: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
95,Identify the top 5 filings that ended in the year 2014 and involve an originator bank from 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.end >= datetime('2014-01-01T00:00:00Z') AND f.end < datetime('2015-01-01T00:00:00Z')
  AND c.name = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has period_end $pe, has amount $a;
$pe >= 2014-01-01T00:00:00Z;
$pe < 2015-01-01T00:00:00Z;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
$c isa country, has name ""United Kingdom"";
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 5;
fetch {
  ""filing"": $f.filing_id
};"
96,List the top 3 filings by amount where the beneficiary bank is from 'USA'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {code: 'USA'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has code ""USA"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
97,Which 3 entities have the most filings as beneficiaries and are located in 'India'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'India'})
MATCH (f:Filing)-[:BENEFITS]->(e)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c isa country, has name ""India"";
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
98,What are the top 5 filings by amount that involve an originator bank from 'Australia'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Australia'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c isa country, has name ""Australia"";
sort $a desc;
limit 5;
fetch {
  ""filing"": $f
};"
99,List the first 3 entities that have originated filings with an end date after '2016-01-01'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.end > datetime('2016-01-01T00:00:00Z')
RETURN e.name AS entity_name, f.end AS filing_end_date
ORDER BY f.end
LIMIT 3","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
$f has period_end $pe;
$pe > 2016-01-01T00:00:00;
sort $pe;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filing_end_date"": $pe
};"
100,Which 3 countries have the most entities linked as originators in the filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 3
RETURN country, entity_count","match
$c isa country;
entity_country (country: $c, fincen_entity: $e);
originator (originating_entity: $e, filing: $f);
reduce $count = count($e) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""entity_count"": $count };"
101,Identify the top 5 entities by number of filings where the beneficiary bank is 'Barclays Bank Plc'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $name;
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 5;
fetch { ""entity_name"": $name, ""num_filings"": $count };"
102,"List the top 3 entities that have filed the most transactions involving an amount greater than 500,000 USD.","MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 500000
RETURN e.name AS entity, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing, has amount $a;
$a > 500000;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity"": $e.name,
  ""transaction_count"": $count
};"
103,What are the top 5 filings from originators in 'Singapore' concerning entities in 'United Kingdom'?,"MATCH (originator:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(beneficiary:Entity)-[:COUNTRY]->(beneficiaryCountry:Country {name: 'United Kingdom'}),
      (originator)-[:COUNTRY]->(originatorCountry:Country {name: 'Singapore'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
  $originator isa fincen_entity;
  entity_country (fincen_entity: $originator, country: $orig_country);
  $orig_country isa country, has name ""Singapore"";
  $f isa filing;
  originator (filing: $f, originating_entity: $originator);
  $beneficiary isa fincen_entity;
  concerns (filing: $f, concerned_entity: $beneficiary);
  entity_country (fincen_entity: $beneficiary, country: $ben_country);
  $ben_country isa country, has name ""United Kingdom"";
  $f has amount $amt;
sort $amt desc;
limit 5;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $f.amount
};"
104,Show the top 3 Filings where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_bank"": $f.originator_bank,
    ""amount"": $a
  }
};"
105,List the top 5 entities that have originated filings with amounts greater than 500000.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 500000
RETURN e.name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$e isa fincen_entity, has name $name;
$f isa filing, has amount $a;
$a > 500000;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 5;
fetch { ""name"": $name, ""filings_count"": $count };"
106,What are the names of the top 3 beneficiary banks based on the number of different originator banks they have interacted with in filings?,"MATCH (f:Filing)-[:BENEFITS]->(b:Entity), (f)-[:ORIGINATOR]->(o:Entity)
WITH b.name AS beneficiary_bank, o.name AS originator_bank
ORDER BY beneficiary_bank
WITH beneficiary_bank, collect(DISTINCT originator_bank) AS originator_banks
RETURN beneficiary_bank, size(originator_banks) AS num_originator_banks
ORDER BY num_originator_banks DESC
LIMIT 3","match
  $b isa fincen_entity, has name $bname;
  $o isa fincen_entity, has name $oname;
  $f isa filing;
  benefits (filing: $f, beneficiary: $b);
  originator (filing: $f, originating_entity: $o);
select $b, $bname, $o;
distinct;
reduce $count = count($o) groupby $b, $bname;
sort $count desc;
limit 3;
fetch { ""beneficiary_bank"": $bname, ""num_originator_banks"": $count };"
107,Which 3 countries have the largest number of entities that are originators in filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c.name AS country, COUNT(DISTINCT e.id) AS num_originators
ORDER BY num_originators DESC
LIMIT 3
RETURN country, num_originators","match
$c isa country, has name $country_name;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e, filing: $f);
select $c, $e, $country_name;
distinct;
reduce $num_originators = count($e) groupby $c, $country_name;
sort $num_originators desc;
limit 3;
fetch { ""country"": $country_name, ""num_originators"": $num_originators };"
108,List the top 5 filings where the originator bank's country is 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name ""Singapore"";
sort $a desc;
limit 5;
fetch {
  ""filing"": $f
};"
109,"What are the top 5 countries where the beneficiary banks are located, based on the total number of filings?","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, count(f) AS total_filings
ORDER BY total_filings DESC
LIMIT 5
RETURN country, total_filings","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $total_filings = count($f) groupby $c, $country;
sort $total_filings desc;
limit 5;
fetch {
  ""country"": $country,
  ""total_filings"": $total_filings
};"
110,Which 3 entities have the largest number of incoming [:BENEFITS] relationships?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
WITH e, COUNT(f) AS benefitsCount
ORDER BY benefitsCount DESC
LIMIT 3
RETURN e.name AS entityName, benefitsCount","match
$e isa fincen_entity;
$f isa filing;
benefits (beneficiary: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entityName"": $e.name, ""benefitsCount"": $count };"
111,List the top 3 countries where the originator banks have originated the smallest total amounts in filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
ORDER BY total_amount ASC
LIMIT 3
RETURN country, total_amount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name $cn;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c, $cn;
sort $total asc;
limit 3;
fetch { ""country"": $cn, ""total_amount"": $total };"
112,What are the top 5 filings by amount where the filing year is 2017?,"MATCH (f:Filing)
WHERE f.begin >= datetime(""2017-01-01T00:00:00Z"") AND f.begin < datetime(""2018-01-01T00:00:00Z"")
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has amount $a;
$pb >= 2017-01-01T00:00:00;
$pb < 2018-01-01T00:00:00;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
113,Which 3 countries have the highest number of filings where the beneficiary bank's country is 'Germany'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = 'Germany'
WITH c.name AS countryName, COUNT(f) AS filingCount
ORDER BY filingCount DESC
LIMIT 3
RETURN countryName, filingCount","match
$f isa filing, has beneficiary_bank_country ""Germany"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""countryName"": $cn, ""filingCount"": $count };"
114,List the top 5 filings where the originator bank's country and beneficiary bank's country are the same but not 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country AND f.originator_bank_country <> 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing,
    has originator_bank_country $obc,
    has beneficiary_bank_country $bbc,
    has amount $amt;
$obc == $bbc;
not { $obc == ""United Kingdom""; };
sort $amt desc;
limit 5;
fetch {
    ""filing"": {
        ""filing_id"": $f.filing_id,
        ""originator_bank_country"": $obc,
        ""beneficiary_bank_country"": $bbc,
        ""amount"": $amt
    }
};"
115,"What are the top 5 countries by the number of filings where the amount is between 100,000 and 1,000,000?","MATCH (f:Filing)-[:ORIGINATOR|:BENEFITS|:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount >= 100000 AND f.amount <= 1000000
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a >= 100000; $a <= 1000000;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c;
sort $filings_count desc;
limit 5;
fetch { ""country"": $c.name, ""filings_count"": $filings_count };"
117,List the top 5 entities based on the number of [:CONCERNS] relationships they are involved in.,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
RETURN e.name AS entity_name, COUNT(f) AS concerns_count
ORDER BY concerns_count DESC
LIMIT 5","match
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""concerns_count"": $count };"
118,Identify the top 5 filings with the most distinct beneficiary banks involved.,"MATCH (f:Filing)
WITH f, COUNT(DISTINCT f.beneficiary_bank) AS distinct_beneficiary_banks
ORDER BY distinct_beneficiary_banks DESC
LIMIT 5
RETURN f.sar_id AS FilingID, distinct_beneficiary_banks","match
$f isa filing, has beneficiary_bank $bb;
select $f, $bb;
distinct;
reduce $count = count($bb) groupby $f;
sort $count desc;
limit 5;
fetch {
  ""FilingID"": $f.sar_id,
  ""distinct_beneficiary_banks"": $count
};"
119,Which 3 countries have the most filings where the originator bank's country is 'United States'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.originator_bank_country = 'United States'
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""United States"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""filings_count"": $count };"
120,List the top 5 originator banks that have originated filings with the highest average amounts.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, avg(f.amount) AS avg_amount
RETURN originator_bank, avg_amount
ORDER BY avg_amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
reduce $avg = mean($a) groupby $e;
sort $avg desc;
limit 5;
fetch { ""originator_bank"": $e.name, ""avg_amount"": $avg };"
121,What are the names of the top 3 entities based on the number of [:FILED] relationships?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN e.name AS entity_name, filings_count","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filings_count"": $count
};"
122,Which 3 beneficiary banks have been involved in filings with the smallest total amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e.name AS beneficiary_bank, SUM(f.amount) AS total_amount
ORDER BY total_amount ASC
LIMIT 3
RETURN beneficiary_bank, total_amount","match
$f isa filing, has amount $a;
$e isa fincen_entity, has name $name;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $e;
sort $total asc;
limit 3;
fetch {
  ""beneficiary_bank"": $e.name,
  ""total_amount"": $total
};"
123,List the top 5 countries by the number of filings where the originator bank is located in 'China'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE e.country = 'CHN'
WITH c.name AS country, count(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN country, num_filings","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
$e isa fincen_entity, has country_code ""CHN"";
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $num_filings = count($f) groupby $c, $country;
sort $num_filings desc;
limit 5;
fetch {
  ""country"": $country,
  ""num_filings"": $num_filings
};"
124,What are the top 5 countries by the number of beneficiary banks involved in filings with amounts over 2 million?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2000000
WITH c.name AS country, COUNT(DISTINCT e.id) AS beneficiary_bank_count
ORDER BY beneficiary_bank_count DESC
LIMIT 5
RETURN country, beneficiary_bank_count","match
$f isa filing, has amount $a;
$a > 2000000;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
select $e, $c, $country;
distinct;
reduce $beneficiary_bank_count = count($e) groupby $c, $country;
sort $beneficiary_bank_count desc;
limit 5;
fetch {
  ""country"": $country,
  ""beneficiary_bank_count"": $beneficiary_bank_count
};"
125,Which 3 filings have the smallest amounts where the beneficiary bank's country is 'Japan'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Japan'
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Japan"", has amount $a;
sort $a asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country
};"
126,Who are the beneficiaries in the filings from originator country 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN DISTINCT e.name AS Beneficiary","match
$f isa filing, has originator_bank_country ""Singapore"";
benefits (filing: $f, beneficiary: $e);
$e has name $n;
select $n;
distinct;
fetch { ""Beneficiary"": $n };"
127,List the top 5 filings where the beneficiary bank's country and originator bank's country are different and the amount is above 1 million.,"MATCH (f:Filing)
WHERE f.amount > 1000000 AND f.originator_bank_country <> f.beneficiary_bank_country
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing,
    has originator_bank_country $obc,
    has beneficiary_bank_country $bbc,
    has amount $a;
not { $obc == $bbc; };
$a > 1000000;
sort $a desc;
limit 5;
fetch {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""originator_bank_country"": $obc,
    ""beneficiary_bank_country"": $bbc
};"
128,List the top 5 Filings with the highest amounts.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": { $f.* }
};"
129,List the top 5 originator banks based on the total number of filings they have originated.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, COUNT(f) AS total_filings
ORDER BY total_filings DESC
LIMIT 5
RETURN originator_bank, total_filings","match
$e isa fincen_entity, has name $name;
$f isa filing;
originator (filing: $f, originating_entity: $e);
reduce $total_filings = count($f) groupby $e, $name;
sort $total_filings desc;
limit 5;
fetch {
  ""originator_bank"": $name,
  ""total_filings"": $total_filings
};"
130,Which Entities have filed more than 3 Filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings
WHERE num_filings > 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
match $num_filings > 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
131,Which 3 filings have the largest amounts where the beneficiary bank's country is 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a
};"
132,List the top 3 filings with the largest number of transactions where the originator bank's country and beneficiary bank's country are different.,"MATCH (f:Filing)
WHERE f.originator_bank_country <> f.beneficiary_bank_country
RETURN f
ORDER BY f.number DESC
LIMIT 3","match
$f isa filing,
    has originator_bank_country $obc,
    has beneficiary_bank_country $bbc,
    has number $n;
not { $obc == $bbc; };
sort $n desc;
limit 3;
fetch {
    ""filing_id"": $f.filing_id,
    ""originator_bank_country"": $obc,
    ""beneficiary_bank_country"": $bbc,
    ""number"": $n
};"
133,What are the top 5 filings by amount in 2015?,"MATCH (f:Filing)
WHERE f.begin >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2015-01-01T00:00:00;
$pe <= 2015-12-31T23:59:59;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""period_begin"": $pb,
  ""period_end"": $pe
};"
134,Which 3 countries have the most filings where the originator bank is not in the same country as the beneficiary bank?,"MATCH (f:Filing)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(oc:Country),
      (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(bc:Country)
WHERE oc.code <> bc.code
WITH bc.name AS beneficiaryCountry, COUNT(f) AS filingCount
RETURN beneficiaryCountry
ORDER BY filingCount DESC
LIMIT 3","match
$f isa filing;
originator (filing: $f, originating_entity: $o);
entity_country (fincen_entity: $o, country: $oc);
$oc has code $oc_code;
benefits (filing: $f, beneficiary: $b);
entity_country (fincen_entity: $b, country: $bc);
$bc has code $bc_code;
$oc_code != $bc_code;
reduce $count = count($f) groupby $bc;
sort $count desc;
limit 3;
fetch { ""beneficiaryCountry"": $bc.name };"
135,Identify the top 5 entities by the number of filings they filed.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
136,What are the names of the top 3 originator banks that have originated the highest amounts in filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, SUM(f.amount) AS total_amount
RETURN originator_bank
ORDER BY total_amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
reduce $total = sum($a) groupby $e;
sort $total desc;
limit 3;
fetch {
  ""originator_bank"": $e.name
};"
137,Which 3 beneficiary banks have been involved in filings with the highest total amounts?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e.name AS beneficiary_bank, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 3
RETURN beneficiary_bank, total_amount","match
$f isa filing, has amount $a;
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $e, $n;
sort $total desc;
limit 3;
fetch { ""beneficiary_bank"": $n, ""total_amount"": $total };"
138,List the top 3 filings with the highest number of transactions in a single filing.,"MATCH (f:Filing)
RETURN f.sar_id, f.number
ORDER BY f.number DESC
LIMIT 3","match
$f isa filing, has sar_id $sid, has number $n;
sort $n desc;
limit 3;
fetch {
  ""sar_id"": $sid,
  ""number"": $n
};"
139,What are the top 5 countries in terms of total amount received by beneficiary banks?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 5
RETURN country, total_amount","match
$f isa filing, has amount $a;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
reduce $total = sum($a) groupby $c, $n;
sort $total desc;
limit 5;
fetch { ""country"": $n, ""total_amount"": $total };"
140,Which 3 entities have been filed against the most in terms of number of filings?,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $n;
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;"
141,List the top 5 countries where most originator banks are located based on filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $country_name;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $filings_count = count($f) groupby $country_name;
sort $filings_count desc;
limit 5;
fetch { ""country"": $country_name, ""filings_count"": $filings_count };"
142,What are the top 3 filings in terms of amount that occurred in 2016?,"MATCH (f:Filing)
WHERE f.begin >= datetime(""2016-01-01T00:00:00Z"") AND f.end <= datetime(""2016-12-31T23:59:59Z"")
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2016-01-01T00:00:00;
$pe <= 2016-12-31T23:59:59;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""period_begin"": $pb,
  ""period_end"": $pe
};"
143,Which 3 countries have the highest average amounts in filings where they are listed as originator?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c.name AS country, AVG(f.amount) AS avg_amount
ORDER BY avg_amount DESC
LIMIT 3
RETURN country, avg_amount","match
$c isa country, has name $country_name;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has amount $amt;
originator (originating_entity: $e, filing: $f);
reduce $avg_amount = mean($amt) groupby $c;
sort $avg_amount desc;
limit 3;
fetch { ""country"": $c.name, ""avg_amount"": $avg_amount };"
144,Identify the top 5 entities that have originated the most filings.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e.name AS entity_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$e isa fincen_entity;
$f isa filing;
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""filings_count"": $count
};"
146,Which 3 countries have beneficiary banks that have been involved in the highest number of filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 3;
fetch {
  ""country"": $country,
  ""filings_count"": $filings_count
};"
147,List the top 5 entities that have been concerned in filings the most.,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 5;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
148,Which 3 countries have the most filings where the amount is above 1 million?,"MATCH (f:Filing)-[:ORIGINATOR|:BENEFITS|:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 1000000
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 1000000;
$e isa fincen_entity;
$c isa country;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""filings_count"": $count };"
150,What are the names of the top 3 originator banks that have initiated filings with the most distinct beneficiary banks?,"MATCH (f:Filing)-[:ORIGINATOR]->(o:Entity), (f)-[:BENEFITS]->(b:Entity)
WITH o.name AS originator_bank, COUNT(DISTINCT b.name) AS distinct_beneficiary_count
ORDER BY distinct_beneficiary_count DESC
LIMIT 3
RETURN originator_bank, distinct_beneficiary_count","match
$f isa filing;
originator (filing: $f, originating_entity: $o);
benefits (filing: $f, beneficiary: $b);
$o has name $oname;
$b has name $bname;
select $oname, $bname;
distinct;
reduce $count = count($bname) groupby $oname;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $oname, ""distinct_beneficiary_count"": $count };"
151,Identify the top 5 countries by the number of entities filed against.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 5
RETURN country, entity_count","match
$c isa country;
$e isa fincen_entity;
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $entity_count = count($e) groupby $c;
sort $entity_count desc;
limit 5;
fetch { ""country"": $c.name, ""entity_count"": $entity_count };"
152,Which 3 originator banks have the most filings associated with them?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
RETURN f.originator_bank AS OriginatorBank, COUNT(f) AS FilingsCount
ORDER BY FilingsCount DESC
LIMIT 3","match
$f isa filing, has originator_bank $ob;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $ob;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $ob, ""filings_count"": $count };"
153,List the top 5 filings where the originator and beneficiary banks are in the same country.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc, has amount $a;
$obc == $bbc;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""country"": $obc
};"
154,What are the top 5 countries in terms of total amount sent by originator banks?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 5
RETURN country, total_amount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name $cn;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c, $cn;
sort $total desc;
limit 5;
fetch { ""country"": $cn, ""total_amount"": $total };"
155,Which 3 entities have benefited from the most filings?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
RETURN e.name AS entity, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$e isa fincen_entity, has name $name;
$f isa filing;
benefits (beneficiary: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 3;
fetch { ""entity"": $name, ""filings_count"": $count };"
156,Identify the top 5 entities that have the most connections to countries through the relationship [:COUNTRY].,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH e, count(c) AS countryConnections
ORDER BY countryConnections DESC
LIMIT 5
RETURN e.name AS entityName, countryConnections","match
$e isa fincen_entity;
$c isa country;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($c) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entityName"": $e.name,
  ""countryConnections"": $count
};"
157,Which 3 countries have the most entities with filings related to 'Barclays Bank Plc' as the beneficiary bank?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
WITH c.name AS country, COUNT(DISTINCT e.id) AS entity_count
ORDER BY entity_count DESC
LIMIT 3
RETURN country, entity_count","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"";
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
$c isa country, has name $cn;
entity_country (fincen_entity: $e, country: $c);
select $e, $c, $cn;
distinct;
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""entity_count"": $count };"
158,Find the top 3 Countries based on the number of originating Filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN c.name AS country_name, num_filings","match
$c isa country;
$e isa fincen_entity;
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch { ""country_name"": $c.name, ""num_filings"": $count };"
159,Who are the beneficiaries in Filings that originated from entities in 'Singapore'?,"MATCH (c:Country {name: 'Singapore'})<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(beneficiary:Entity)
RETURN DISTINCT beneficiary.name AS BeneficiaryName","match
$c isa country, has name ""Singapore"";
entity_country (country: $c, fincen_entity: $e);
filed (filer: $e, filing: $f);
benefits (filing: $f, beneficiary: $b);
$b has name $bn;
select $bn;
distinct;
fetch { ""BeneficiaryName"": $bn };"
160,Show the top 3 Entities that have filed the most number of Filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $num_filings
};"
161,"List the Entities that have benefited from Filings with an amount over $2,000,000.","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e.name AS BeneficiaryEntity","match
$f isa filing, has amount $a;
$a > 2000000;
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity;
fetch {
  ""BeneficiaryEntity"": $e.name
};"
162,Which Filings have an originator bank with a country code of 'SGP'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {code: 'SGP'})
RETURN f","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has code ""SGP"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""filing_id"": $f.filing_id
};"
163,Display the top 5 Entities by the number of Filings they have originated.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_id = e.id
RETURN e.name AS EntityName, COUNT(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 5","match
$e isa fincen_entity;
$rel isa originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""number_of_filings"": $count
};"
164,What are the names of the top 3 Countries that have beneficiary banks in Filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS countryName, COUNT(f) AS filingsCount
ORDER BY filingsCount DESC
LIMIT 3
RETURN countryName, filingsCount","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""countryName"": $cn, ""filingsCount"": $count };"
165,Which Filings are concerned by Entities located in 'Singapore'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
MATCH (f:Filing)-[:CONCERNS]->(e)
RETURN f","match
$c isa country, has name ""Singapore"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
fetch {
  ""filing"": $f.filing_id
};"
166,"List the Filings where the amount is greater than $1,500,000.","MATCH (f:Filing)
WHERE f.amount > 1500000
RETURN f","match
$f isa filing, has amount $a;
$a > 1500000;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
168,"Who are the beneficiaries in Filings that involved an amount over $2,000,000?","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e.name AS beneficiary_name, f.amount AS amount","match
$f isa filing, has amount $a;
$a > 2000000;
$e isa fincen_entity, has name $beneficiary_name;
benefits (filing: $f, beneficiary: $e);
fetch {
  ""beneficiary_name"": $beneficiary_name,
  ""amount"": $a
};"
169,Display all Filings where the originator and beneficiary banks are from 'Singapore'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'Singapore'
RETURN f","match
$f isa filing,
  has originator_bank_country ""Singapore"",
  has beneficiary_bank_country ""Singapore"";
fetch {
  ""f"": $f
};"
170,What are the top 5 Filings where the beneficiary bank is located in the 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country
};"
171,Which Filings have a beneficiary bank in 'China'?,"MATCH (c:Country {name: 'China'})<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
RETURN f","match
$c isa country, has name ""China"";
entity_country (fincen_entity: $e, country: $c);
benefits (filing: $f, beneficiary: $e);
fetch {
  ""filing"": $f.filing_id
};"
172,What are the top 5 filings by amount that involved 'Bank of Baku' as the originator?,"MATCH (e:Entity {name: 'Bank of Baku'})-[:FILED]->(f:Filing)
WHERE f.originator_bank = 'Bank of Baku'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$e isa fincen_entity, has name ""Bank of Baku"";
originator (originating_entity: $e, filing: $f);
$f has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""originator_bank"": $f.originator_bank,
  ""beneficiary_bank"": $f.beneficiary_bank,
  ""filer_org_name"": $f.filer_org_name
};"
173,List the Entities that are concerned by Filings where the originator bank is in 'Angola'.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN e.name AS ConcernedEntities","match
$f isa filing, has originator_bank_country ""Angola"";
concerns (filing: $f, concerned_entity: $e);
$e isa fincen_entity;
fetch {
  ""ConcernedEntities"": $e.name
};"
174,Find the top 5 Filings with the lowest number of transactions.,"MATCH (f:Filing)
WITH f
ORDER BY f.number ASC
LIMIT 5
RETURN f","match
$f isa filing, has number $n;
sort $n asc;
limit 5;
fetch {
  ""filing"": { $f.* }
};"
175,Which Countries have the most beneficiary banks in Filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 1","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 1;
fetch { ""country"": $cn, ""filings_count"": $count };"
176,Show the top 3 Filings with the latest end dates.,"MATCH (f:Filing)
WITH f
ORDER BY f.end DESC
LIMIT 3
RETURN f","match
$f isa filing, has period_end $pe;
sort $pe desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""period_end"": $pe
};"
178,What are the top 3 filings by amount where the originator bank country is 'Singapore'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
WHERE f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""Singapore"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""originator_bank_country"": $f.originator_bank_country
};"
179,List the top 5 countries by the number of entities located there.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 5
RETURN country, entity_count","match
$e isa fincen_entity;
$c isa country, has name $country;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $c, $country;
sort $count desc;
limit 5;
fetch { ""country"": $country, ""entity_count"": $count };"
180,Which 3 entities filed the most filings between 2010 and 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN e.name AS entity_name, filings_count","match
$e isa fincen_entity;
$f isa filing, has period_begin $pb, has period_end $pe;
filed (filer: $e, filing: $f);
$pb >= 2010-01-01T00:00:00;
$pe <= 2015-12-31T23:59:59;
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filings_count"": $count
};"
181,Find the top 5 filings with the largest amounts that concern entities in 'China'.,"MATCH (c:Country {name: 'China'})<-[:COUNTRY]-(e:Entity)<-[:CONCERNS]-(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$c isa country, has name ""China"";
entity_country (country: $c, fincen_entity: $e);
concerns (filing: $f, concerned_entity: $e);
$f has amount $amt;
sort $amt desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $amt
};"
182,What are the top 3 filings where the beneficiary bank is 'Barclays Bank Plc' and the amount is over 1000000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc' AND f.amount > 1000000
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has amount $a;
$a > 1000000;
sort $a desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""beneficiary_bank"": $f.beneficiary_bank,
    ""amount"": $a
  }
};"
183,Which Filings have a beneficiary bank in 'Angola'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'})
RETURN f","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name ""Angola"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""filing"": $f.filing_id
};"
184,"What are the names of Entities that are concerned by Filings involving more than $1,000,000?","MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name","match
$f isa filing, has amount $a;
$a > 1000000;
concerns (filing: $f, concerned_entity: $e);
$e isa fincen_entity;
fetch {
  ""name"": $e.name
};"
185,Find the top 5 Filings by amount where the originator is from 'United Kingdom'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 5;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a
};"
186,Show the top 3 Filings where the beneficiary bank country is 'Singapore'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""amount"": $a
};"
188,What are the names of the top 3 Entities by the total amount of Filings they have benefited from?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
WITH e, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN e.name AS entityName, totalAmount","match
$e isa fincen_entity, has name $n;
$f isa filing, has amount $a;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $e, $n;
sort $total desc;
limit 3;
fetch { ""entityName"": $n, ""totalAmount"": $total };"
189,Which Country has the most Entities registered with it?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c, count(e) AS entityCount
RETURN c.name AS country, entityCount
ORDER BY entityCount DESC
LIMIT 1","match
$e isa fincen_entity;
$c isa country;
entity_country (fincen_entity: $e, country: $c);
$c has name $country_name;
reduce $entity_count = count($e) groupby $c, $country_name;
sort $entity_count desc;
limit 1;
fetch {
  ""country"": $country_name,
  ""entityCount"": $entity_count
};"
190,"Show the top 5 Filings where the amount is between $500,000 and $1,000,000.","MATCH (f:Filing)
WHERE f.amount >= 500000 AND f.amount <= 1000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a >= 500000;
$a <= 1000000;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
191,List Entities that originated Filings to more than two different countries.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, collect(DISTINCT f.beneficiary_bank_country) AS countries
WHERE size(countries) > 2
RETURN e.name AS EntityName, countries","match
$e isa fincen_entity;
originator (originating_entity: $e, filing: $f);
$f has beneficiary_bank_country $c;
select $e, $c;
distinct;
reduce $count = count($c) groupby $e;
match $count > 2;
fetch { ""entity_name"": $e.name };"
192,Which Filings have a beneficiary bank located in the 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
fetch {
  ""filing_id"": $f.filing_id
};"
193,Show the top 3 Filings with the earliest begin dates.,"MATCH (f:Filing)
RETURN f
ORDER BY f.begin ASC
LIMIT 3","match
$f isa filing, has period_begin $b;
sort $b asc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""period_begin"": $b
  }
};"
194,Which Entities are associated with Filings that have the originator bank country as 'Angola'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN DISTINCT e.name AS EntityName, e.id AS EntityID","match
$f isa filing, has originator_bank_country ""Angola"";
originator (filing: $f, originating_entity: $e);
$e has name $name, has entity_id $eid;
select $name, $eid;
distinct;
fetch {
  ""EntityName"": $name,
  ""EntityID"": $eid
};"
195,List the Filings where the beneficiary bank and originator bank are from the same country.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country
RETURN f","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc;
$obc == $bbc;
fetch {
  ""filing"": $f.filing_id
};"
196,Find the top 3 Filings with the smallest amount.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has amount $a;
sort $a asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
197,Display the Entities that are associated with the most number of Filings as a beneficiary.,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 1
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 1;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $num_filings
};"
198,What are the top 5 Countries where the Filings' beneficiary banks are located?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 5;
fetch {
  ""country"": $country,
  ""filings_count"": $filings_count
};"
199,Which Filings involve Entities that are linked to the 'CHN' country code?,"MATCH (c:Country {code: 'CHN'})<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
RETURN f","match
$c isa country, has code ""CHN"";
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
fetch {
  ""filing"": $f.filing_id
};"
200,"List the top 3 Filings where the amount is exactly $1,000,000.","MATCH (f:Filing)
WHERE f.amount = 1000000
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a == 1000000;
sort $a desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
201,Who are the Entities that filed the Filings with a begin date in 'March 2015'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date STARTS WITH 'Mar 2015'
RETURN e.name AS EntityName, f.sar_id AS FilingSARID","match
$e isa fincen_entity, has name $en;
$f isa filing, has begin_date $bd, has sar_id $sid;
filed (filer: $e, filing: $f);
$bd like ""Mar 2015.*"";
fetch {
  ""EntityName"": $en,
  ""FilingSARID"": $sid
};"
202,Find the top 5 Filings by number of transactions.,"MATCH (f:Filing)
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has number $n;
sort $n desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""number"": $n
};"
203,Show the names of Entities that have originator banks in 'Singapore'.,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_bank_country: 'Singapore'})
RETURN DISTINCT e.name AS EntityName","match
$e isa fincen_entity, has name $name;
$f isa filing, has originator_bank_country ""Singapore"";
filed (filer: $e, filing: $f);
select $name;
distinct;"
204,Which Filings have an end date later than 'September 2015'?,"MATCH (f:Filing)
WHERE f.end > datetime('2015-09-30T23:59:59Z')
RETURN f","match
$f isa filing, has period_end $pe;
$pe > 2015-09-30T23:59:59;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""period_end"": $pe
  }
};"
206,Who are the beneficiaries in Filings that have an originator bank from 'Angola'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Angola'
RETURN e.name AS beneficiary","match
$f isa filing, has originator_bank_country ""Angola"";
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity;
fetch {
  ""beneficiary"": $e.name
};"
207,Display all Filings where the originator and beneficiary banks are different.,"MATCH (f:Filing)
WHERE f.originator_bank <> f.beneficiary_bank
RETURN f","match
$f isa filing, has originator_bank $ob, has beneficiary_bank $bb;
$ob != $bb;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_bank"": $ob,
    ""beneficiary_bank"": $bb
  }
};"
208,What are the top 5 Filings with the highest number of transactions?,"MATCH (f:Filing)
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has number $n;
sort $n desc;
limit 5;
fetch {
  ""filing"": { ""filing_id"": $f.filing_id, ""number"": $n }
};"
209,Which Countries have the most Entities as originators in Filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c, count(e) AS entity_count
RETURN c.name AS country, entity_count
ORDER BY entity_count DESC
LIMIT 10","match
$c isa country;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e, filing: $f);
reduce $count = count($e) groupby $c;
sort $count desc;
limit 10;
fetch { ""country"": $c.name, ""entity_count"": $count };"
210,List the Filings where the originator bank country and beneficiary bank country are the same.,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country
RETURN f","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc;
$obc == $bbc;
fetch {
  ""filing"": $f.filing_id
};"
211,List the first 3 entities that have been beneficiaries in filings originating from 'United Arab Emirates'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'United Arab Emirates'
RETURN e.name
LIMIT 3","match
$f isa filing, has originator_bank_country ""United Arab Emirates"";
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity;
limit 3;
fetch {
  ""name"": $e.name
};"
212,What are the top 5 filings by number where 'Deutsche Bank AG' is the beneficiary bank?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE e.name = 'Deutsche Bank AG'
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has number $n;
$e isa fincen_entity, has name ""Deutsche Bank AG"";
benefits (filing: $f, beneficiary: $e);
sort $n desc;
limit 5;
fetch {
  ""filing"": $f
};"
213,Which 3 entities have been the originator in filings with the highest total amounts transferred?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN e.name AS entityName, totalAmount","match
$e isa fincen_entity, has name $name;
originator (originating_entity: $e, filing: $f);
$f has amount $a;
reduce $total = sum($a) groupby $e, $name;
sort $total desc;
limit 3;
fetch { ""entityName"": $name, ""totalAmount"": $total };"
214,Which countries have entities that have filed more than 5 filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c, e, count(f) AS filings_count
WHERE filings_count > 5
RETURN c.name AS country_name, filings_count","match
$c isa country;
$e isa fincen_entity;
$f isa filing;
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
reduce $filings_count = count($f) groupby $c, $e;
match $filings_count > 5;
$c has name $country_name;
fetch { ""country_name"": $country_name, ""filings_count"": $filings_count };"
215,Find the top 5 entities that have originated the most filings with a beneficiary bank in Germany.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(c:Country {name: ""Germany""})
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS EntityName, num_filings AS NumberOfFilings","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""Germany"";
originator (originating_entity: $e, filing: $f);
benefits (filing: $f, beneficiary: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""EntityName"": $e.name, ""NumberOfFilings"": $count };"
216,What are the top 3 filings in terms of number involving entities from China as the beneficiaries in 2001?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {code: ""CHN""})
MATCH (f:Filing)-[:BENEFITS]->(e)
WHERE f.begin >= datetime(""2001-01-01T00:00:00Z"") AND f.end <= datetime(""2001-12-31T23:59:59Z"")
RETURN f.sar_id, f.number
ORDER BY f.number DESC
LIMIT 3","match
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has code ""CHN"";
benefits (filing: $f, beneficiary: $e);
$f has period_begin $pb;
$pb >= 2001-01-01T00:00:00;
$f has period_end $pe;
$pe <= 2001-12-31T23:59:59;
$f has number $n;
sort $n desc;
limit 3;
fetch {
  ""sar_id"": $f.sar_id,
  ""number"": $n
};"
217,Which five filings involved a beneficiary bank from the United Kingdom with amounts over 2 million USD?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = ""United Kingdom"" AND f.amount > 2000000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$a > 2000000;
sort $a desc;
limit 5;
fetch {
  ""filing"": $f
};"
218,List the three entities with the most filings where the originator bank is located in Singapore.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country = ""Singapore""
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has originator_bank_country ""Singapore"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
219,Which three countries have entities that were the originators in the most filings in 2002?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin >= datetime(""2002-01-01T00:00:00Z"") AND f.begin < datetime(""2003-01-01T00:00:00Z"")
WITH c.name AS country, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing, has period_begin $pb;
$pb >= 2002-01-01T00:00:00Z;
$pb < 2003-01-01T00:00:00Z;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $filings_count = count($f) groupby $cn;
sort $filings_count desc;
limit 3;
fetch { ""country"": $cn, ""filings_count"": $filings_count };"
220,Find the top 5 entities that benefited from filings in 2003.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.begin >= datetime('2003-01-01T00:00:00Z') AND f.end <= datetime('2003-12-31T23:59:59Z')
RETURN e.name AS entity, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has period_end $pe;
$pb >= 2003-01-01T00:00:00;
$pe <= 2003-12-31T23:59:59;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity"": $e.name, ""filings_count"": $count };"
221,"What are the top 3 originator bank countries in filings involving an amount greater than 500,000 USD in 2004?","MATCH (f:Filing)
WHERE f.amount > 500000 AND f.begin >= datetime('2004-01-01T00:00:00Z') AND f.end <= datetime('2004-12-31T23:59:59Z')
WITH f.originator_bank_country AS country, COUNT(f) AS filings_count
RETURN country
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has amount $a, has originator_bank_country $country, has period_begin $begin, has period_end $end;
$a > 500000;
$begin >= 2004-01-01T00:00:00;
$end <= 2004-12-31T23:59:59;
reduce $count = count($f) groupby $country;
sort $count desc;
limit 3;
fetch { ""country"": $country };"
223,List the top 5 countries by the number of entities they host.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 5
RETURN country, entity_count","match
$c isa country, has name $country;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
reduce $entity_count = count($e) groupby $c, $country;
sort $entity_count desc;
limit 5;
fetch { ""country"": $country, ""entity_count"": $entity_count };"
224,Which three beneficiary banks were involved in filings with the highest amounts in 2006?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.begin >= datetime('2006-01-01T00:00:00Z') AND f.end <= datetime('2006-12-31T23:59:59Z')
WITH f, e
ORDER BY f.amount DESC
LIMIT 3
RETURN e.name AS beneficiary_bank, f.amount","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2006-01-01T00:00:00;
$pe <= 2006-12-31T23:59:59;
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity, has name $n;
sort $a desc;
limit 3;
fetch { ""beneficiary_bank"": $n, ""amount"": $a };"
225,Find the top 5 countries where entities are located that filed filings with an amount over 1 million USD in 2008.,"MATCH (f:Filing)-[:FILED]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 1000000 AND f.begin >= datetime('2008-01-01T00:00:00Z') AND f.end <= datetime('2008-12-31T23:59:59Z')
RETURN c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 5","match
$f isa filing, has amount $a, has period_begin $pb, has period_end $pe;
$a > 1000000;
$pb >= 2008-01-01T00:00:00;
$pe <= 2008-12-31T23:59:59;
$e isa fincen_entity;
filed (filer: $e, filing: $f);
$c isa country, has name $cn;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.name, ""entity_count"": $count };"
227,List the top 5 entities that have filed the most filings where the beneficiary bank is located in the United States.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = ""United States""
WITH e, count(f) as filing_count
ORDER BY filing_count DESC
LIMIT 5
RETURN e.name as entity_name, filing_count","match
$f isa filing, has beneficiary_bank_country ""United States"";
benefits (filing: $f, beneficiary: $e);
$e has name $name;
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 5;
fetch { ""entity_name"": $name, ""filing_count"": $count };"
228,Which three countries are most frequently listed as the originator bank country in filings during 2010?,"MATCH (f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2010-12-31T23:59:59Z')
WITH f.originator_bank_country AS country, COUNT(f) AS frequency
RETURN country
ORDER BY frequency DESC
LIMIT 3","match
$f isa filing, has originator_bank_country $country, has period_begin $begin, has period_end $end;
$begin >= 2010-01-01T00:00:00;
$end <= 2010-12-31T23:59:59;
reduce $frequency = count($f) groupby $country;
sort $frequency desc;
limit 3;
fetch { ""country"": $country };"
229,Find the top 5 filings with the largest amount transferred in 2011.,"MATCH (f:Filing)
WHERE f.begin >= datetime(""2011-01-01T00:00:00Z"") AND f.end <= datetime(""2011-12-31T23:59:59Z"")
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2011-01-01T00:00:00;
$pe <= 2011-12-31T23:59:59;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""period_begin"": $pb,
  ""period_end"": $pe
};"
230,What are the top 3 originator banks by the number of filings with an end date in 2012?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.end_date_format CONTAINS ""2012""
RETURN f.originator_bank AS OriginatorBank, COUNT(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3","match
$f isa filing, has end_date_format $edf, has originator_bank $ob;
$edf like "".*2012.*"";
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $ob;
sort $count desc;
limit 3;"
231,Which three filings have the highest amount transferred and involve a UK beneficiary bank?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {code: ""GBR""})
RETURN f.sar_id, f.amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has sar_id $sid, has amount $a;
$e isa fincen_entity;
$c isa country, has code ""GBR"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 3;
fetch {
  ""sar_id"": $sid,
  ""amount"": $a
};"
232,List the top 5 entities by the number of filings concerning them in 2013.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.begin >= datetime('2013-01-01T00:00:00Z') AND f.end <= datetime('2013-12-31T23:59:59Z')
WITH e, count(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$f isa filing, has period_begin $pb, has period_end $pe;
$pb >= 2013-01-01T00:00:00;
$pe <= 2013-12-31T23:59:59;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
233,Which three countries have entities that benefited from the highest amount in filings in 2014?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin >= datetime('2014-01-01T00:00:00Z') AND f.end <= datetime('2014-12-31T23:59:59Z')
WITH c.name AS country, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN country, totalAmount","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2014-01-01T00:00:00;
$pe <= 2014-12-31T23:59:59;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $total = sum($a) groupby $c, $cn;
sort $total desc;
limit 3;
fetch { ""country"": $cn, ""totalAmount"": $total };"
234,What are the top 5 beneficiary banks in terms of the total amount transferred in filings during 2016?,"MATCH (f:Filing)
WHERE f.begin >= datetime(""2016-01-01T00:00:00Z"") AND f.end <= datetime(""2016-12-31T23:59:59Z"")
WITH f.beneficiary_bank AS bank, SUM(f.amount) AS total_amount
RETURN bank, total_amount
ORDER BY total_amount DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has period_end $pe, has beneficiary_bank $bank, has amount $amt;
$pb >= 2016-01-01T00:00:00;
$pe <= 2016-12-31T23:59:59;
reduce $total = sum($amt) groupby $bank;
sort $total desc;
limit 5;"
235,What are the top 3 entities by the number of filings they originated in 2007?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2007-01-01T00:00:00Z') AND f.end <= datetime('2007-12-31T23:59:59Z')
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN e.name AS entity_name, filings_count","match
$e isa fincen_entity;
$f isa filing, has period_begin $pb, has period_end $pe;
originator (originating_entity: $e, filing: $f);
$pb >= 2007-01-01T00:00:00;
$pe <= 2007-12-31T23:59:59;
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""filings_count"": $count };"
236,What are the names of all entities in 'United Kingdom'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN e.name AS entity_name","match
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""entity_name"": $e.name
};"
237,How many filings were ended in the year 2015?,"MATCH (f:Filing)
WHERE f.end >= datetime('2015-01-01T00:00:00Z') AND f.end < datetime('2016-01-01T00:00:00Z')
RETURN count(f) AS filings_ended_in_2015","match
$f isa filing, has period_end $pe;
$pe >= 2015-01-01T00:00:00;
$pe < 2016-01-01T00:00:00;
reduce $count = count($f);"
238,What are the top 3 originator banks by the number of filings they initiated?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN originator_bank, num_filings","match
$e isa fincen_entity, has name $n;
$f isa filing;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $n, ""num_filings"": $count };"
239,Which 5 entities are most frequently listed as originators in filings from 2010 to 2015?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN e.name AS entity_name, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 5","match
$e isa fincen_entity, has name $name;
$f isa filing, has period_begin $begin, has period_end $end;
originator (originating_entity: $e, filing: $f);
$begin >= 2010-01-01T00:00:00;
$end <= 2015-12-31T23:59:59;
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 5;"
240,Show the first 3 originator countries by the total amount sent in transactions.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS originator_country, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 3
RETURN originator_country, total_amount","match
$f isa filing, has amount $amt;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $total = sum($amt) groupby $cn;
sort $total desc;
limit 3;
fetch { ""originator_country"": $cn, ""total_amount"": $total };"
241,List the top 5 beneficiary banks by the total amount received from filings.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e.name AS beneficiary_bank, SUM(f.amount) AS total_amount
RETURN beneficiary_bank, total_amount
ORDER BY total_amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity, has name $n;
reduce $total = sum($a) groupby $e;
sort $total desc;
limit 5;
fetch {
  ""beneficiary_bank"": $e.name,
  ""total_amount"": $total
};"
243,What are the 3 most frequent beneficiary banks in transactions over $1 million?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS beneficiary_bank, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 1000000;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""beneficiary_bank"": $e.name,
  ""transaction_count"": $count
};"
244,List the first 5 countries by the number of filings where they are the beneficiary.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN country, num_filings","match
$f isa filing;
$c isa country, has name $country;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $num_filings = count($f) groupby $c, $country;
sort $num_filings desc;
limit 5;
fetch {
  ""country"": $country,
  ""num_filings"": $num_filings
};"
245,Show the top 3 originator banks by the total number of transactions in 2014.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.begin >= datetime('2014-01-01T00:00:00Z') AND f.end <= datetime('2014-12-31T23:59:59Z')
RETURN e.name AS originator_bank, COUNT(f) AS total_transactions
ORDER BY total_transactions DESC
LIMIT 3","match
$f isa filing, has period_begin $pb, has period_end $pe;
$pb >= 2014-01-01T00:00:00Z;
$pe <= 2014-12-31T23:59:59Z;
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $e.name, ""total_transactions"": $count };"
246,Which 5 filings involved the highest number of entities as beneficiaries?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, COUNT(e) AS beneficiary_count
ORDER BY beneficiary_count DESC
LIMIT 5
RETURN f.sar_id AS filing_id, beneficiary_count","match
$f isa filing, has sar_id $sid;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($e) groupby $f, $sid;
sort $count desc;
limit 5;
fetch { ""filing_id"": $sid, ""beneficiary_count"": $count };"
247,List the first 3 entities that have filed the most number of transactions in 2015.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format CONTAINS ""2015""
WITH e, COUNT(f) AS num_transactions
ORDER BY num_transactions DESC
LIMIT 3
RETURN e.name AS entity_name, num_transactions","match
$e isa fincen_entity;
$f isa filing, has begin_date_format $bdf;
$bdf like "".*2015.*"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_transactions"": $count };"
248,What are the top 5 countries based on the number of originator entities they have?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
MATCH (f:Filing)-[:ORIGINATOR]->(e)
WITH c.name AS country, COUNT(DISTINCT e.id) AS originator_count
RETURN country, originator_count
ORDER BY originator_count DESC
LIMIT 5","match
$c isa country, has name $cn;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e);
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""originator_count"": $count };"
249,Show the first 5 entities that have been beneficiaries the most times.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e, count(f) as benefit_count
ORDER BY benefit_count DESC
LIMIT 5
RETURN e.name as EntityName, benefit_count","match
$e isa fincen_entity;
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""EntityName"": $e.name,
  ""benefit_count"": $count
};"
250,List the top 3 filings with the highest amount.,"MATCH (f:Filing)
RETURN f.sar_id, f.amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
sort $a desc;
limit 3;
fetch {
  ""sar_id"": $f.sar_id,
  ""amount"": $a
};"
251,Which 3 countries have the highest number of beneficiary entities?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c.name AS country, COUNT(e) AS beneficiary_count
RETURN country, beneficiary_count
ORDER BY beneficiary_count DESC
LIMIT 3","match
$c isa country, has name $cn;
entity_country (country: $c, fincen_entity: $e);
benefits (beneficiary: $e);
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""beneficiary_count"": $count };"
252,Show the top 5 originator banks by the total amount of transactions.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, SUM(f.amount) AS total_amount
RETURN originator_bank, total_amount
ORDER BY total_amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $total = sum($a) groupby $e, $n;
sort $total desc;
limit 5;
fetch { ""originator_bank"": $n, ""total_amount"": $total };"
253,Which 5 entities have been concerned the most in filings?,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, COUNT(f) AS concernCount
ORDER BY concernCount DESC
LIMIT 5
RETURN e.name AS entityName, concernCount","match
$e isa fincen_entity, has name $name;
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 5;
fetch {
  ""entityName"": $name,
  ""concernCount"": $count
};"
254,What are the first 3 banks that have filed the most filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e.name AS bank_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN bank_name, filings_count","match
$e isa fincen_entity, has name $bank_name;
filed (filer: $e, filing: $f);
reduce $filings_count = count($f) groupby $e, $bank_name;
sort $filings_count desc;
limit 3;
fetch {
  ""bank_name"": $bank_name,
  ""filings_count"": $filings_count
};"
255,List the top 5 countries by the number of filings where they are the originator.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$c isa country, has name $country_name;
$e isa fincen_entity;
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c, $country_name;
sort $count desc;
limit 5;
fetch { ""country"": $country_name, ""filings_count"": $count };"
256,What is the average amount of filings that ended in 2017?,"MATCH (f:Filing)
WHERE f.end >= datetime(""2017-01-01T00:00:00Z"") AND f.end < datetime(""2018-01-01T00:00:00Z"")
RETURN avg(f.amount) AS average_amount","match
$f isa filing, has period_end $pe, has amount $a;
$pe >= 2017-01-01T00:00:00;
$pe < 2018-01-01T00:00:00;
reduce $avg = mean($a);"
257,How many countries are represented by the beneficiary banks in the filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN count(DISTINCT c.code) AS numberOfCountries","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has code $code;
select $code;
distinct;
reduce $count = count;"
258,What are the entities concerned in the top 5 filings by amount?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, e
ORDER BY f.amount DESC
LIMIT 5
RETURN e.name AS entity_name, f.amount AS filing_amount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
sort $a desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""filing_amount"": $a
};"
259,List the 3 most recent filings in the database.,"MATCH (f:Filing)
RETURN f
ORDER BY f.end DESC
LIMIT 3","match
$f isa filing, has period_end $end;
sort $end desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""period_begin"": $f.period_begin,
    ""period_end"": $f.period_end,
    ""amount"": $f.amount
  }
};"
260,Which entities are associated with originator bank 'CIMB Bank Berhad'?,"MATCH (e:Entity)-[:FILED]->(f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN e.name AS entity_name, e.id AS entity_id","match
$e isa fincen_entity;
$f isa filing, has originator_bank ""CIMB Bank Berhad"";
filed (filer: $e, filing: $f);
fetch {
  ""entity_name"": $e.name,
  ""entity_id"": $e.entity_id
};"
261,Find all entities that are beneficiaries in filings where the amount is greater than 1000000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS beneficiary_entity, e.id AS beneficiary_entity_id","match
$f isa filing, has amount $a;
$a > 1000000;
$e isa fincen_entity, has name $name, has entity_id $eid;
benefits (filing: $f, beneficiary: $e);
fetch {
  ""beneficiary_entity"": $name,
  ""beneficiary_entity_id"": $eid
};"
262,Who are the top 3 originator banks with the most filings in 2015?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.begin_date_format CONTAINS ""2015""
RETURN e.name AS originator_bank, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has begin_date_format $bdf;
$bdf like "".*2015.*"";
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $n, ""filings_count"": $count };"
263,Find the top 3 countries where entities have filed the most number of filings in 2017.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(c:Country)
WHERE f.begin >= datetime('2017-01-01T00:00:00Z') AND f.end <= datetime('2017-12-31T23:59:59Z')
WITH c.name AS country, count(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing, has period_begin $pb, has period_end $pe;
$c isa country, has name $cn;
filed (filer: $e, filing: $f);
entity_country (fincen_entity: $e, country: $c);
$pb >= 2017-01-01T00:00:00;
$pe <= 2017-12-31T23:59:59;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""filings_count"": $count };"
264,Which three entities have filed the most number of filings between 2010 and 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
WITH e, count(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN e.name AS entity_name, filings_count","match
$e isa fincen_entity, has name $name;
$f isa filing, has period_begin $begin, has period_end $end;
filed (filer: $e, filing: $f);
$begin >= 2010-01-01T00:00:00;
$end <= 2015-12-31T23:59:59;
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 3;
fetch { ""entity_name"": $name, ""filings_count"": $count };"
265,List the top 5 countries by the number of filings originating from them.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 5;
fetch {
  ""country"": $country,
  ""filings_count"": $filings_count
};"
266,Retrieve the first 3 filings where the originator bank country is 'Singapore' and the beneficiary bank country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has originator_bank_country ""Singapore"", has beneficiary_bank_country ""United Kingdom"";
$f has period_begin $begin;
sort $begin;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""originator_bank_country"": $f.originator_bank_country,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""begin"": $f.period_begin,
  ""amount"": $f.amount
};"
267,What are the names of the top 5 originator banks in filings that ended in the year 2014?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.end_date_format STARTS WITH ""2014""
RETURN e.name AS originator_bank, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has end_date_format $edf;
$edf like ""^2014.*"";
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""originator_bank"": $e.name, ""filings_count"": $count };"
268,List the first 3 countries where the filings have originated from entities based in 'Angola'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Angola'})-[:FILED]->(f:Filing)-[:ORIGINATOR]->(originEntity:Entity)-[:COUNTRY]->(originCountry:Country)
RETURN DISTINCT originCountry.name
LIMIT 3","match
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has name ""Angola"";
filed (filer: $e, filing: $f);
originator (filing: $f, originating_entity: $oe);
entity_country (fincen_entity: $oe, country: $oc);
$oc has name $ocn;
select $ocn;
distinct;
limit 3;
fetch { ""country"": $ocn };"
269,What are the names of the top 5 beneficiary banks in filings that have an amount greater than 200000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 200000
RETURN e.name AS beneficiary_bank, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a > 200000;
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $n;
sort $count desc;
limit 5;
fetch {
  ""beneficiary_bank"": $n,
  ""filings_count"": $count
};"
270,List the first 3 entities that have filed the most number of filings concerning banks in 'Singapore'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(b:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""Singapore"";
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
271,Retrieve the first 3 filings where the beneficiary bank country is 'United Kingdom' and the amount is above 100000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 100000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$a > 100000;
$f has period_begin $b;
sort $b asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""amount"": $a,
  ""period_begin"": $b
};"
272,What are the names of the top 3 banks that served as beneficiary banks in the most filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e.name AS bank_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN bank_name, filings_count","match
$e isa fincen_entity, has name $n;
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch {
  ""bank_name"": $n,
  ""filings_count"": $count
};"
273,List the origin countries of the first 5 filings by 'The Bank of New York Mellon Corp.',"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
WITH f
ORDER BY f.begin ASC
LIMIT 5
MATCH (f)-[:ORIGINATOR]->(originator:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS origin_country","match
$e isa fincen_entity, has name ""The Bank of New York Mellon Corp."";
filed (filer: $e, filing: $f);
$f has period_begin $pb;
originator (filing: $f, originating_entity: $orig);
entity_country (fincen_entity: $orig, country: $c);
sort $pb asc;
limit 5;
fetch {
  ""origin_country"": $c.name
};"
274,Find the top 3 entities that have filed the most number of filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
RETURN e.name AS entity_name, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filing_count"": $count
};"
275,Which 5 filings have the earliest begin dates?,"MATCH (f:Filing)
RETURN f
ORDER BY f.begin ASC
LIMIT 5","match
$f isa filing, has period_begin $pb;
sort $pb asc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""period_begin"": $pb
  }
};"
276,Retrieve the first 5 countries with a top-level domain of 'AO'.,"MATCH (c:Country)
WHERE c.tld = 'AO'
RETURN c.name, c.code, c.tld
LIMIT 5","match
$c isa country, has tld ""AO"";
limit 5;
fetch {
  ""name"": $c.name,
  ""code"": $c.code,
  ""tld"": $c.tld
};"
277,What are the names of the top 3 entities that originated filings with amounts over 1000000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has amount $a;
$a > 1000000;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
278,List the first 3 filings where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing {originator_bank: 'CIMB Bank Berhad'})
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has period_begin $begin;
sort $begin;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_bank"": $f.originator_bank,
    ""period_begin"": $f.period_begin,
    ""period_end"": $f.period_end,
    ""amount"": $f.amount
  }
};"
279,What are the names of the first 5 entities that are beneficiaries in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name
ORDER BY f.begin
LIMIT 5","match
$f isa filing, has begin_date $bd;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
sort $bd asc;
limit 5;
fetch {
  ""name"": $e.name
};"
280,Find the top 3 countries that have entities with the most filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
$c isa country;
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 3;
fetch { ""country"": $country, ""filings_count"": $filings_count };"
281,Which 5 filings have a beneficiary bank country of 'Singapore' and amount greater than 500000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 500000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a;
$a > 500000;
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country,
    ""amount"": $a
  }
};"
282,List all entities that are the originator for filings involving banks in 'Singapore'.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE f.originator_bank_country = 'Singapore'
RETURN DISTINCT e.name AS OriginatorEntity","match
$e isa fincen_entity;
$f isa filing, has originator_bank_country ""Singapore"";
originator (originating_entity: $e, filing: $f);
select $e;
distinct;
fetch { ""OriginatorEntity"": $e.name };"
283,Retrieve the first 3 beneficiary banks located in 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN e.name AS beneficiary_bank
LIMIT 3","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name ""United Kingdom"";
limit 3;
fetch {
  ""beneficiary_bank"": $e.name
};"
284,What are the names of the entities that have filed between '2015-01-01' and '2015-12-31'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime('2015-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN DISTINCT e.name AS entity_name","match
$e isa fincen_entity, has name $n;
$f isa filing, has period_begin $pb, has period_end $pe;
filed (filer: $e, filing: $f);
$pb >= 2015-01-01T00:00:00;
$pe <= 2015-12-31T23:59:59;
select $n;
distinct;
fetch { ""entity_name"": $n };"
285,Find the top 5 filings with the highest amounts.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
286,Which entities are connected to the country with the code 'SGP'?,"MATCH (c:Country {code: 'SGP'})<-[:COUNTRY]-(e:Entity)
RETURN e.name AS entity_name, e.id AS entity_id","match
$c isa country, has code ""SGP"";
$e isa fincen_entity, has name $name, has entity_id $eid;
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""entity_name"": $name,
  ""entity_id"": $eid
};"
287,List the first 3 filings made by 'The Bank of New York Mellon Corp.',"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$e isa fincen_entity, has name ""The Bank of New York Mellon Corp."";
filed (filer: $e, filing: $f);
$f has period_begin $begin;
sort $begin asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""period_begin"": $f.period_begin,
  ""period_end"": $f.period_end,
  ""amount"": $f.amount,
  ""number"": $f.number
};"
288,What are the names of the top 5 countries by number of filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country_name, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN country_name, num_filings","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
reduce $count = count($f) groupby $c, $n;
sort $count desc;
limit 5;
fetch { ""country_name"": $n, ""num_filings"": $count };"
289,Find the top 3 entities that are concerned in filings where the amount is above 500000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 500000
RETURN e.name AS entity_name, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 500000;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filing_count"": $count
};"
290,List the first 3 entities by the number of concerns they have in filings.,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, COUNT(f) AS concernCount
ORDER BY concernCount DESC
LIMIT 3
RETURN e.name AS entityName, concernCount","match
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entityName"": $e.name, ""concernCount"": $count };"
291,List the first 5 countries connected to entities that have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS filingsCount
WHERE filingsCount > 10
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS countryName
LIMIT 5","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
match
$count > 10;
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
limit 5;
fetch { ""countryName"": $cn };"
292,Retrieve the top 5 filings with beneficiary banks located in 'Singapore' and amounts less than 300000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
WHERE f.amount < 300000
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a < 300000;
$e isa fincen_entity;
$c isa country, has name ""Singapore"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount
};"
293,List the first 3 entities that have filed the most number of filings with a beneficiary bank country of 'United Kingdom'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
294,Retrieve the first 3 filings where the beneficiary bank country is 'Singapore' and the amount is above 200000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 200000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a;
$a > 200000;
$f has period_begin $b;
sort $b;
limit 3;
fetch {
  ""filing"": $f
};"
295,What are the names of the top 5 entities that are originators in filings with an originator bank country of 'Singapore'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e.name AS entity_name, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 5","match
$f isa filing, has originator_bank_country ""Singapore"";
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 5;"
296,List the first 3 entities that are concerned in filings with a beneficiary bank country of 'United Kingdom' and an amount greater than 1000000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN e.name AS entity_name
ORDER BY e.name
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$a > 1000000;
concerns (filing: $f, concerned_entity: $e);
$e has name $n;
sort $n asc;
limit 3;
fetch {
  ""entity_name"": $n
};"
297,Retrieve the first 3 filings with a beneficiary bank country of 'United Kingdom' and an amount less than 500000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount < 500000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a, has begin_date $bd;
$a < 500000;
sort $bd asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""begin_date"": $f.begin_date
};"
298,What are the names of the top 5 entities that have the most filings with a beneficiary bank country of 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'Singapore'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$f isa filing, has beneficiary_bank_country ""Singapore"";
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
299,List the first 3 entities that are originators in filings where the originator bank is 'CIMB Bank Berhad' and the amount is above 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad' AND f.amount > 500000
RETURN e.name AS originator_entity_name
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a, has begin_date $bd;
$a > 500000;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
sort $bd asc;
limit 3;
fetch {
  ""originator_entity_name"": $e.name
};"
300,Retrieve the first 3 filings where the originator bank country is 'United Kingdom' and the amount is above 200000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'United Kingdom' AND f.amount > 200000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has originator_bank_country ""United Kingdom"", has amount $a;
$a > 200000;
$f has period_begin $pb;
sort $pb asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount,
  ""originator_bank_country"": $f.originator_bank_country,
  ""period_begin"": $f.period_begin
};"
301,What are the names of the top 5 entities that have originator banks in 'Angola'?,"MATCH (c:Country {name: 'Angola'})<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$c isa country, has name ""Angola"";
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
302,List the first 3 entities that have filed the most number of filings with a beneficiary bank in 'Barclays Bank Plc'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
$f has beneficiary_bank ""Barclays Bank Plc"";
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
303,Retrieve the first 3 countries connected to entities that are beneficiaries in filings with amounts over 1000000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 1000000
RETURN DISTINCT c.name
LIMIT 3","match
$f isa filing, has amount $a;
$a > 1000000;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
select $n;
distinct;
limit 3;
fetch { ""name"": $n };"
304,What are the names of the top 5 filings in terms of amount where the originator bank is 'CIMB Bank Berhad'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f.sar_id AS filing_id, f.amount AS amount
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.sar_id,
  ""amount"": $a
};"
305,List the first 3 entities that are originators in filings with a beneficiary bank country of 'United Kingdom' and amount less than 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount < 500000
RETURN e.name AS OriginatorEntity
ORDER BY e.name
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$a < 500000;
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
sort $n;
limit 3;
fetch {
  ""OriginatorEntity"": $n
};"
306,Retrieve the first 3 filings with a beneficiary bank country of 'Singapore' and an amount greater than 200000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 200000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a, has begin_date $bd;
$a > 200000;
sort $bd;
limit 3;
fetch {
  ""filing"": $f
};"
307,What are the names of the top 5 originator banks for filings that started in the year 2015?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.begin_date_format STARTS WITH ""2015""
RETURN e.name AS originator_bank, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has begin_date_format $bdf;
$bdf like ""2015.*"";
originator (filing: $f, originating_entity: $e);
$e has name $n;
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""originator_bank"": $e.name, ""filings_count"": $count };"
308,List the first 3 entities that are concerned in filings with an amount greater than 1000000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS entity_name
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has amount $a, has begin_date $bd;
$a > 1000000;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
sort $bd asc;
limit 3;
fetch {
  ""entity_name"": $e.name
};"
309,Retrieve the first 3 filings where the beneficiary bank country is 'United Kingdom' and the beneficiary iso is 'GBR'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.beneficiary_iso = 'GBR'
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has beneficiary_iso ""GBR"", has period_begin $begin;
sort $begin;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""beneficiary_bank_country"": $f.beneficiary_bank_country,
  ""beneficiary_iso"": $f.beneficiary_iso,
  ""period_begin"": $f.period_begin,
  ""period_end"": $f.period_end,
  ""amount"": $f.amount,
  ""number"": $f.number,
  ""sar_id"": $f.sar_id,
  ""filer_org_name"": $f.filer_org_name,
  ""originator_bank"": $f.originator_bank,
  ""beneficiary_bank"": $f.beneficiary_bank
};"
310,What are the names of the top 5 entities that have benefited from filings originated by banks in 'Singapore'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN e.name AS entity_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has originator_bank_country ""Singapore"";
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 5;"
311,List the first 3 entities that originated filings with a beneficiary bank country of 'United Kingdom' and amount over 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 500000
RETURN e.name AS entity_name
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has begin_date $bd;
$f has amount $a;
$a > 500000;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
sort $bd asc;
limit 3;
fetch {
  ""entity_name"": $e.name
};"
312,Retrieve the first 3 filings with an originator bank country of 'Angola' and a beneficiary bank country of 'Singapore'.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Angola' AND f.beneficiary_bank_country = 'Singapore'
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing,
    has originator_bank_country ""Angola"",
    has beneficiary_bank_country ""Singapore"",
    has period_begin $begin;
sort $begin asc;
limit 3;
fetch {
    ""filing"": {
        ""filing_id"": $f.filing_id,
        ""originator_bank_country"": $f.originator_bank_country,
        ""beneficiary_bank_country"": $f.beneficiary_bank_country,
        ""period_begin"": $f.period_begin,
        ""amount"": $f.amount
    }
};"
313,What are the names of the top 3 entities that have filings with an originator iso code of 'SGP'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_iso = 'SGP'
RETURN e.name, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3","match
$e isa fincen_entity, has name $n;
$f isa filing, has originator_iso ""SGP"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""name"": $n, ""filing_count"": $count };"
314,Find the top 5 countries where the entities have filed the least number of filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count ASC
LIMIT 5
RETURN country, filings_count","match
$e isa fincen_entity;
$f isa filing;
$c isa country, has name $country_name;
filed (filer: $e, filing: $f);
entity_country (fincen_entity: $e, country: $c);
reduce $filings_count = count($f) groupby $c, $country_name;
sort $filings_count asc;
limit 5;
fetch { ""country"": $country_name, ""filings_count"": $filings_count };"
315,List the first 3 entities that benefit from filings where the originator bank is 'The Bank of New York Mellon Corp.',"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'The Bank of New York Mellon Corp.'
RETURN e.name
LIMIT 3","match
$f isa filing, has originator_bank ""The Bank of New York Mellon Corp."";
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
limit 3;
fetch {
  ""name"": $n
};"
316,What are the names of the first 3 entities that originated filings with a beneficiary bank in 'Barclays Bank Plc'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
RETURN e.name
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has begin_date $bd;
originator (filing: $f, originating_entity: $e);
$e has name $n;
sort $bd asc;
limit 3;
fetch {
  ""name"": $n
};"
317,Show the top 5 beneficiary entities based on the total amount received.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH e, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 5
RETURN e.name AS BeneficiaryEntity, totalAmount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $e;
sort $total desc;
limit 5;
fetch {
  ""BeneficiaryEntity"": $e.name,
  ""totalAmount"": $total
};"
318,What are the first 3 filings with the most number of concerns?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(e) AS concern_count
ORDER BY concern_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, concern_count","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 3;
fetch {
  ""filing_id"": $f.sar_id,
  ""concern_count"": $count
};"
320,Which 5 filings have the highest amount transferred between 2015 and 2017?,"MATCH (f:Filing)
WHERE f.begin >= datetime(""2015-01-01T00:00:00Z"") AND f.end <= datetime(""2017-12-31T23:59:59Z"")
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2015-01-01T00:00:00;
$pe <= 2017-12-31T23:59:59;
sort $a desc;
limit 5;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a,
  ""period_begin"": $pb,
  ""period_end"": $pe
};"
321,What are the names of the top 3 countries by the number of originator banks based on filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country_name, count(DISTINCT e.id) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN country_name, originator_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
select $e, $c, $cn;
distinct;
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country_name"": $cn, ""originator_count"": $count };"
322,Show the first 5 filings with the most entities involved as concerns from different sectors.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(DISTINCT e) AS entityCount
ORDER BY entityCount DESC
LIMIT 5
MATCH (f)-[:CONCERNS]->(e:Entity)
RETURN f.sar_id AS FilingID, f.begin AS BeginDate, f.end AS EndDate, f.amount AS Amount, COLLECT(e.name) AS ConcernedEntities","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch {
  ""sar_id"": $f.sar_id,
  ""begin_date"": $f.begin_date,
  ""end_date"": $f.end_date,
  ""amount"": $f.amount,
  ""entity_count"": $count
};"
323,List the top 3 entities by the number of filings they are involved in as originators in the technology sector.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WHERE e.name CONTAINS ""technology""
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $n;
$n like "".*technology.*"";
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
324,Which 5 countries have the highest number of filings involving transactions below $1 million?,"MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount < 1000000
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a < 1000000;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c;
sort $filings_count desc;
limit 5;
fetch { ""country"": $c.name, ""filings_count"": $filings_count };"
325,What are the top 3 filings with the most entities involved as concerns from the same country?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, c.name AS country_name, entity_count","match
$f isa filing, has sar_id $sid;
$e isa fincen_entity;
$c isa country, has name $cn;
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $sid, $cn;
sort $count desc;
limit 3;
fetch {
  ""filing_id"": $sid,
  ""country_name"": $cn,
  ""entity_count"": $count
};"
326,Show the first 5 countries with the highest number of filings involving transactions involving multiple countries.,"MATCH (f:Filing)
WHERE f.originator_bank_country <> f.beneficiary_bank_country
WITH f
MATCH (f)-[:ORIGINATOR]->(e1:Entity)-[:COUNTRY]->(c1:Country), 
      (f)-[:BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c1 <> c2
WITH c1, count(f) AS num_filings
RETURN c1.name AS country, num_filings
ORDER BY num_filings DESC
LIMIT 5","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc;
$obc != $bbc;
originator (filing: $f, originating_entity: $e1);
entity_country (fincen_entity: $e1, country: $c1);
benefits (filing: $f, beneficiary: $e2);
entity_country (fincen_entity: $e2, country: $c2);
$c1 has name $cn1;
$c2 has name $cn2;
$cn1 != $cn2;
reduce $num_filings = count($f) groupby $c1, $cn1;
sort $num_filings desc;
limit 5;
fetch { ""country"": $cn1, ""num_filings"": $num_filings };"
327,List the top 3 filings with the highest number of entities involved as originators from different sectors.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, COUNT(DISTINCT e) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, originator_count","match
$f isa filing, has sar_id $sid;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f, $sid;
sort $count desc;
limit 3;
fetch { ""filing_id"": $sid, ""originator_count"": $count };"
328,Which 5 countries have the highest number of filings where they are both originator and beneficiary in transactions involving multiple currencies?,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity)-[:COUNTRY]->(c1:Country),
      (f)-[:BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c1.code = c2.code
WITH c1.name AS country, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN country, num_filings","match
$f isa filing;
originator (filing: $f, originating_entity: $e1);
entity_country (fincen_entity: $e1, country: $c);
benefits (filing: $f, beneficiary: $e2);
entity_country (fincen_entity: $e2, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.name, ""num_filings"": $count };"
329,What are the top 3 filings with the highest number of entities involved as originators from the same sector?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, COUNT(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, originator_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 3;
fetch { ""filing_id"": $f.sar_id, ""originator_count"": $count };"
330,List the top 3 beneficiary banks by the number of filings involving transactions over $2 million.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 2000000
RETURN f.beneficiary_bank AS BeneficiaryBank, COUNT(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3","match
$f isa filing, has amount $a, has beneficiary_bank $bb;
$a > 2000000;
reduce $count = count($f) groupby $bb;
sort $count desc;
limit 3;
fetch { ""beneficiary_bank"": $bb, ""number_of_filings"": $count };"
331,Which 5 countries have the most filings involving entities from more than two different sectors?,"MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c, e, COUNT(DISTINCT e.id) AS sector_count, COUNT(f) AS filing_count
WHERE sector_count > 2
RETURN c.name AS country, filing_count
ORDER BY filing_count DESC
LIMIT 5","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $cn;
$rel isa $t ($f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
entity_country (fincen_entity: $e, country: $c);
reduce $fc = count($f) groupby $c, $cn, $e;
reduce $entity_count = count($fc), $filing_count = sum($fc) groupby $c, $cn;
match $entity_count > 2;
sort $filing_count desc;
limit 5;
fetch { ""country"": $cn, ""filing_count"": $filing_count };"
332,What are the top 3 filings with the most number of different beneficiary banks involved?,"MATCH (f:Filing)
WITH f, COUNT(DISTINCT f.beneficiary_bank) AS beneficiary_bank_count
ORDER BY beneficiary_bank_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, beneficiary_bank_count","match
$f isa filing, has sar_id $sid, has beneficiary_bank $bb;
reduce $count = count($bb) groupby $f, $sid;
sort $count desc;
limit 3;"
333,Show the first 5 filings with the most entities involved as benefits from the same country.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, COUNT(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 5
RETURN f.sar_id AS FilingID, c.name AS Country, entityCount","match
$f isa filing;
$e isa fincen_entity;
$c isa country;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $f, $c;
sort $count desc;
limit 5;
match
$f has sar_id $sid;
$c has name $cn;
fetch {
  ""FilingID"": $sid,
  ""Country"": $cn,
  ""entityCount"": $count
};"
334,List the top 3 entities by the number of filings they are involved in as concerns in the financial sector.,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $n;
concerns (concerned_entity: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""entity_name"": $n, ""num_filings"": $count };"
335,Which 5 countries have the highest total amount of transactions where they are the originator?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 5
RETURN country, total_amount","match
$f isa filing, has amount $a;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $total = sum($a) groupby $c, $country;
sort $total desc;
limit 5;
fetch { ""country"": $country, ""total_amount"": $total };"
336,What are the first 3 filings with the highest number of entities listed as benefits from different countries?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c.code) AS country_count
ORDER BY country_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, country_count","match
$f isa filing, has sar_id $sid;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has code $cc;
select $f, $sid, $cc;
distinct;
reduce $country_count = count($cc) groupby $f, $sid;
sort $country_count desc;
limit 3;
fetch { ""filing_id"": $sid, ""country_count"": $country_count };"
337,Show the top 5 filings with the most entities involved as originators from different sectors.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, COUNT(DISTINCT e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN f.sar_id AS FilingID, originator_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
$e isa fincen_entity;
select $f, $e;
distinct;
reduce $originator_count = count($e) groupby $f;
sort $originator_count desc;
limit 5;
fetch {
  ""FilingID"": $f.sar_id,
  ""originator_count"": $originator_count
};"
338,List the first 3 filings with the highest number of entities involved as originators from the same country.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, COUNT(DISTINCT e) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN f.sar_id AS FilingID, originator_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $f, $c;
sort $count desc;
limit 3;
fetch { ""FilingID"": $f.sar_id, ""originator_count"": $count };"
339,Which 5 countries have the most filings as beneficiaries in the first half of any year?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin_date_format =~ '.*-01-.*' OR f.begin_date_format =~ '.*-02-.*' OR f.begin_date_format =~ '.*-03-.*' OR f.begin_date_format =~ '.*-04-.*' OR f.begin_date_format =~ '.*-05-.*' OR f.begin_date_format =~ '.*-06-.*'
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has begin_date_format $bdf;
$e isa fincen_entity;
$c isa country, has name $cn;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
{ $bdf like "".*-01-.*""; } or { $bdf like "".*-02-.*""; } or { $bdf like "".*-03-.*""; } or { $bdf like "".*-04-.*""; } or { $bdf like "".*-05-.*""; } or { $bdf like "".*-06-.*""; };
reduce $filings_count = count($f) groupby $c, $cn;
sort $filings_count desc;
limit 5;
fetch { ""country"": $cn, ""filings_count"": $filings_count };"
340,What are the top 3 beneficiary banks by the number of filings involving transactions from Europe?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name IN [""Albania"", ""Andorra"", ""Armenia"", ""Austria"", ""Azerbaijan"", ""Belarus"", ""Belgium"", ""Bosnia and Herzegovina"", ""Bulgaria"", ""Croatia"", ""Cyprus"", ""Czech Republic"", ""Denmark"", ""Estonia"", ""Finland"", ""France"", ""Georgia"", ""Germany"", ""Greece"", ""Hungary"", ""Iceland"", ""Ireland"", ""Italy"", ""Kazakhstan"", ""Kosovo"", ""Latvia"", ""Liechtenstein"", ""Lithuania"", ""Luxembourg"", ""Malta"", ""Moldova"", ""Monaco"", ""Montenegro"", ""Netherlands"", ""North Macedonia"", ""Norway"", ""Poland"", ""Portugal"", ""Romania"", ""Russia"", ""San Marino"", ""Serbia"", ""Slovakia"", ""Slovenia"", ""Spain"", ""Sweden"", ""Switzerland"", ""Turkey"", ""Ukraine"", ""United Kingdom"", ""Vatican City""]
RETURN f.beneficiary_bank AS BeneficiaryBank, COUNT(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank $bb;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
{ $cn == ""Albania""; } or { $cn == ""Andorra""; } or { $cn == ""Armenia""; } or { $cn == ""Austria""; } or { $cn == ""Azerbaijan""; } or { $cn == ""Belarus""; } or { $cn == ""Belgium""; } or { $cn == ""Bosnia and Herzegovina""; } or { $cn == ""Bulgaria""; } or { $cn == ""Croatia""; } or { $cn == ""Cyprus""; } or { $cn == ""Czech Republic""; } or { $cn == ""Denmark""; } or { $cn == ""Estonia""; } or { $cn == ""Finland""; } or { $cn == ""France""; } or { $cn == ""Georgia""; } or { $cn == ""Germany""; } or { $cn == ""Greece""; } or { $cn == ""Hungary""; } or { $cn == ""Iceland""; } or { $cn == ""Ireland""; } or { $cn == ""Italy""; } or { $cn == ""Kazakhstan""; } or { $cn == ""Kosovo""; } or { $cn == ""Latvia""; } or { $cn == ""Liechtenstein""; } or { $cn == ""Lithuania""; } or { $cn == ""Luxembourg""; } or { $cn == ""Malta""; } or { $cn == ""Moldova""; } or { $cn == ""Monaco""; } or { $cn == ""Montenegro""; } or { $cn == ""Netherlands""; } or { $cn == ""North Macedonia""; } or { $cn == ""Norway""; } or { $cn == ""Poland""; } or { $cn == ""Portugal""; } or { $cn == ""Romania""; } or { $cn == ""Russia""; } or { $cn == ""San Marino""; } or { $cn == ""Serbia""; } or { $cn == ""Slovakia""; } or { $cn == ""Slovenia""; } or { $cn == ""Spain""; } or { $cn == ""Sweden""; } or { $cn == ""Switzerland""; } or { $cn == ""Turkey""; } or { $cn == ""Ukraine""; } or { $cn == ""United Kingdom""; } or { $cn == ""Vatican City""; };
reduce $count = count($f) groupby $bb;
sort $count desc;
limit 3;"
341,"Show the first 5 countries with the highest number of filings involving transactions under $500,000.","MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount < 500000
WITH c, count(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN c.name AS country_name, num_filings","match
$f isa filing, has amount $a;
$a < 500000;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $num_filings = count($f) groupby $c, $cn;
sort $num_filings desc;
limit 5;
fetch { ""country_name"": $cn, ""num_filings"": $num_filings };"
342,List the first 3 originator banks located in 'Australia'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Australia'})
MATCH (f:Filing)-[:ORIGINATOR]->(e)
RETURN DISTINCT f.originator_bank
LIMIT 3","match
$c isa country, has name ""Australia"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has originator_bank $ob;
originator (filing: $f, originating_entity: $e);
select $ob;
distinct;
limit 3;
fetch { ""originator_bank"": $ob };"
343,List the top 3 entities by the number of filings they are involved in as beneficiary in the healthcare sector.,"MATCH (e:Entity)-[:BENEFITS]->(f:Filing)
WHERE f.filer_org_name CONTAINS ""healthcare""
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has filer_org_name $fon;
$fon like "".*healthcare.*"";
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
344,What are the top 5 beneficiary banks that have received funds from 'CIMB Bank Berhad'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f.beneficiary_bank, COUNT(*) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 5","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has beneficiary_bank $bb;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $bb;
sort $count desc;
limit 5;"
345,Which 3 filings have an end date later than '2017-01-01'?,"MATCH (f:Filing)
WHERE f.end > datetime('2017-01-01T00:00:00Z')
RETURN f
ORDER BY f.end DESC
LIMIT 3","match
$f isa filing, has period_end $pe;
$pe > 2017-01-01T00:00:00;
sort $pe desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""period_end"": $pe
  }
};"
346,What are the names of the top 3 originator banks that have initiated filings with an end date before '2005-01-01'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.end < datetime('2005-01-01T00:00:00Z')
RETURN e.name AS originator_bank, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has period_end $pe;
$pe < 2005-01-01T00:00:00;
originator (filing: $f, originating_entity: $e);
$e has name $n;
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $n };"
347,List the first 3 filings where the beneficiary bank's country is 'Brazil' and the amount is over 1 million USD.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Brazil' AND f.amount > 1000000
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing,
    has beneficiary_bank_country ""Brazil"",
    has amount $a;
$a > 1000000;
$f has period_begin $pb;
sort $pb asc;
limit 3;
fetch {
    ""filing_id"": $f.filing_id,
    ""amount"": $f.amount,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country,
    ""period_begin"": $f.period_begin,
    ""period_end"": $f.period_end,
    ""originator_bank"": $f.originator_bank,
    ""beneficiary_bank"": $f.beneficiary_bank,
    ""filer_org_name"": $f.filer_org_name,
    ""sar_id"": $f.sar_id,
    ""number"": $f.number
};"
348,Which 3 countries have beneficiary banks that received the highest total amounts in filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 3
RETURN country, totalAmount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c;
sort $total desc;
limit 3;
fetch {
  ""country"": $c.name,
  ""totalAmount"": $total
};"
349,What are the top 3 entities that have originated filings concerning banks in 'Russia'?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:CONCERNS]->(b:Entity)-[:COUNTRY]->(c:Country {name: 'Russia'})
WITH e, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
RETURN e.name AS entity_name, filing_count","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""Russia"";
originator (originating_entity: $e, filing: $f);
concerns (filing: $f, concerned_entity: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""filing_count"": $count };"
350,Identify the top 5 filings that ended in the year 2016 and involve an originator bank from 'Canada'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.end >= datetime('2016-01-01T00:00:00Z') AND f.end < datetime('2017-01-01T00:00:00Z')
  AND c.name = 'Canada'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
  $f isa filing, has period_end $pe, has amount $a;
  $pe >= 2016-01-01T00:00:00;
  $pe < 2017-01-01T00:00:00;
  $e isa fincen_entity;
  originator (filing: $f, originating_entity: $e);
  $c isa country, has name ""Canada"";
  entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 5;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a
};"
351,List the top 3 filings by amount where the beneficiary bank is from 'Switzerland'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'Switzerland'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name ""Switzerland"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a
};"
352,Which 3 filings have the smallest number of transactions but involve a beneficiary bank from 'India'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'India'
RETURN f
ORDER BY f.number ASC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""India"", has number $n;
sort $n asc;
limit 3;
fetch {
  ""filing"": { $f.* }
};"
353,What are the top 5 entities by number of filings where the beneficiary bank is 'HSBC'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank = 'HSBC'
RETURN e.name AS entity_name, COUNT(f) AS number_of_filings
ORDER BY number_of_filings DESC
LIMIT 5","match
$e isa fincen_entity, has name $n;
$f isa filing, has beneficiary_bank ""HSBC"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 5;
fetch { ""entity_name"": $n, ""number_of_filings"": $count };"
355,List the top 3 countries by the number of entities that have filed more than 30 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS filingsCount
WHERE filingsCount > 30
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
reduce $filing_count = count($f) groupby $e;
match
$filing_count > 30;
entity_country (fincen_entity: $e, country: $c);
$c has name $country_name;
reduce $entity_count = count($e) groupby $c, $country_name;
sort $entity_count desc;
limit 3;
fetch {
  ""country"": $country_name,
  ""entityCount"": $entity_count
};"
356,Identify the top 3 beneficiary banks that have received funds in filings where the originator bank is 'Barclays Bank Plc'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity),
      (f)-[:ORIGINATOR]->(o:Entity)
WHERE o.name = 'Barclays Bank Plc'
RETURN f.beneficiary_bank AS BeneficiaryBank, COUNT(f) AS NumberOfFilings
ORDER BY NumberOfFilings DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank $bb;
$o isa fincen_entity, has name ""Barclays Bank Plc"";
originator (filing: $f, originating_entity: $o);
reduce $count = count($f) groupby $bb;
sort $count desc;
limit 3;"
357,Which 3 entities have the most filings as beneficiaries and are located in 'Germany'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Germany'})
MATCH (f:Filing)-[:BENEFITS]->(e)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$c isa country, has name ""Germany"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
358,List the first 3 entities that originated filings with an amount over 100 million USD.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 100000000
RETURN e.name AS EntityName, f.amount AS Amount
ORDER BY f.amount DESC
LIMIT 3","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
$f has amount $a;
$a > 100000000;
sort $a desc;
limit 3;
fetch {
  ""EntityName"": $e.name,
  ""Amount"": $a
};"
359,Which 3 filings have the smallest amount and involve an entity from 'France' as the originator?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'France'})
MATCH (f:Filing)-[:ORIGINATOR]->(e)
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$c isa country, has name ""France"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has amount $a;
originator (filing: $f, originating_entity: $e);
sort $a asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
360,What are the top 3 countries by the number of filings where they appear as the beneficiary bank country?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = c.name
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country $bbc;
reduce $count = count($f) groupby $bbc;
sort $count desc;
limit 3;
fetch { ""country"": $bbc, ""filings_count"": $count };"
361,Identify the top 5 beneficiary banks that received funds from filings where the originator bank country is 'China'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.originator_bank_country = 'China'
RETURN e.name AS beneficiary_bank, COUNT(f) AS number_of_filings
ORDER BY number_of_filings DESC
LIMIT 5","match
$f isa filing, has originator_bank_country ""China"";
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $n;
sort $count desc;
limit 5;"
362,List the first 3 filings where the originator bank is from 'Japan'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'Japan'
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has period_begin $begin;
$e isa fincen_entity;
$c isa country, has name ""Japan"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $begin;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""begin"": $begin
};"
363,What are the names of the top 3 entities by number of filings they have originated?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(e)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $n;
filed (filer: $e, filing: $f);
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""entity_name"": $n, ""num_filings"": $count };"
364,Which 3 countries have the most entities linked as originators in the filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c.name AS country, COUNT(e) AS entity_count
RETURN country, entity_count
ORDER BY entity_count DESC
LIMIT 3","match
$c isa country, has name $cn;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e, filing: $f);
reduce $entity_count = count($e) groupby $c, $cn;
sort $entity_count desc;
limit 3;
fetch {
  ""country"": $cn,
  ""entity_count"": $entity_count
};"
365,What are the top 5 filings by amount that involve 'The Bank of New York Mellon Corp.' as the filer?,"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$e isa fincen_entity, has name ""The Bank of New York Mellon Corp."";
filed (filer: $e, filing: $f);
$f has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""filer_org_name"": $f.filer_org_name
};"
366,Which 3 beneficiary banks received the highest total amount in transactions from filings originated in 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country = 'United Kingdom'
WITH e.name AS beneficiary_bank, SUM(f.amount) AS total_amount
RETURN beneficiary_bank, total_amount
ORDER BY total_amount DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""United Kingdom"", has amount $a;
benefits (filing: $f, beneficiary: $e);
$e isa fincen_entity, has name $n;
reduce $total = sum($a) groupby $n;
sort $total desc;
limit 3;
fetch { ""beneficiary_bank"": $n, ""total_amount"": $total };"
367,List the first 3 originator banks from 'Singapore'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
RETURN DISTINCT f.originator_bank
LIMIT 3","match
$f isa filing, has originator_bank_country ""Singapore"", has originator_bank $ob;
select $ob;
distinct;
limit 3;"
368,What are the names of the top 3 entities that have been concerned in filings more than 20 times?,"MATCH (e:Entity)-[:CONCERNS]->(f:Filing)
WITH e, COUNT(f) AS concernCount
WHERE concernCount > 20
RETURN e.name AS entityName
ORDER BY concernCount DESC
LIMIT 3","match
$e isa fincen_entity;
concerns (concerned_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
match
$count > 20;
sort $count desc;
limit 3;
fetch {
  ""entityName"": $e.name
};"
369,"Identify the top 3 countries where the beneficiary banks are located, based on the total amount transferred.","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
RETURN country, total_amount
ORDER BY total_amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c;
sort $total desc;
limit 3;
fetch { ""country"": $c.name, ""total_amount"": $total };"
370,Identify the top 5 countries by the number of filings where the originator bank is located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country_name;
reduce $count = count($f) groupby $c, $country_name;
sort $count desc;
limit 5;
fetch {
  ""country"": $country_name,
  ""filings_count"": $count
};"
371,Which 5 countries have the most filings involving transactions above $10 million?,"MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 10000000
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a > 10000000;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.name, ""filings_count"": $count };"
372,Show the top 5 countries with the most filings where they are both originator and beneficiary in transactions involving multiple currencies.,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity)-[:COUNTRY]->(c1:Country),
      (f)-[:BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c1.code = c2.code
WITH c1.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e1);
entity_country (fincen_entity: $e1, country: $c);
benefits (filing: $f, beneficiary: $e2);
entity_country (fincen_entity: $e2, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.name, ""filings_count"": $count };"
373,Show the top 5 entities with the most filings as a beneficiary in the financial sector.,"MATCH (e:Entity)-[:BENEFITS]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
benefits (beneficiary: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
375,Which 5 filings involve the most number of different originator iso codes?,"MATCH (f:Filing)
WITH f, COUNT(DISTINCT f.originator_iso) AS originator_iso_count
ORDER BY originator_iso_count DESC
LIMIT 5
RETURN f.sar_id AS filing_id, originator_iso_count","match
$f isa filing, has sar_id $sid, has originator_iso $oi;
reduce $count = count($oi) groupby $f, $sid;
sort $count desc;
limit 5;
fetch { ""filing_id"": $sid, ""originator_iso_count"": $count };"
376,What are the top 3 countries with the most filings as an originator in 2012?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin >= datetime(""2012-01-01T00:00:00Z"") AND f.end <= datetime(""2012-12-31T23:59:59Z"")
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing, has period_begin $pb, has period_end $pe;
$pb >= 2012-01-01T00:00:00;
$pe <= 2012-12-31T23:59:59;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
$c isa country;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""filings_count"": $count };"
377,Show the first 5 filings that involved a change in beneficiary bank during the transaction.,"MATCH (f:Filing)
WHERE f.originator_bank_id <> f.beneficiary_bank_id
RETURN f
ORDER BY f.begin
LIMIT 5","match
$f isa filing, has originator_bank_id $ob, has beneficiary_bank_id $bb, has begin_date $bd;
not { $ob == $bb; };
sort $bd asc;
limit 5;
fetch {
  ""filing"": { $f.* }
};"
378,"List the top 3 countries by the number of filings with transactions over $500,000.","MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 500000
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 500000;
$rel isa $t (filing: $f, $e);
$e isa fincen_entity;
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 3;
fetch { ""country"": $country, ""filings_count"": $filings_count };"
379,Which 5 countries have the highest total amount of transactions where they are the beneficiary?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c.name AS country, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 5
RETURN country, totalAmount","match
$c isa country, has name $cn;
entity_country (country: $c, fincen_entity: $e);
benefits (beneficiary: $e, filing: $f);
$f has amount $amt;
reduce $total = sum($amt) groupby $c;
sort $total desc;
limit 5;
fetch { ""country"": $c.name, ""totalAmount"": $total };"
380,What are the first 3 filings with entities from three different continents as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, e, c
ORDER BY f.begin
WITH f, COLLECT(DISTINCT c.code) AS continents
WHERE SIZE(continents) >= 3
RETURN f
LIMIT 3","match
$f isa filing, has period_begin $begin;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
select $f, $c, $begin;
distinct;
reduce $count = count($c) groupby $f, $begin;
match $count >= 3;
sort $begin;
limit 3;
fetch { ""filing"": $f.filing_id };"
381,Show the top 5 countries by the number of filings they are involved in as both originator and beneficiary.,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity)-[:COUNTRY]->(c1:Country),
      (f)-[:BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c1 = c2
WITH c1 AS country, COUNT(f) AS filings_count
RETURN country.name AS country_name, filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing;
originator (filing: $f, originating_entity: $e1);
entity_country (fincen_entity: $e1, country: $c);
benefits (filing: $f, beneficiary: $e2);
entity_country (fincen_entity: $e2, country: $c);
$c has name $country_name;
reduce $filings_count = count($f) groupby $c, $country_name;
sort $filings_count desc;
limit 5;
fetch { ""country_name"": $country_name, ""filings_count"": $filings_count };"
382,List the first 3 filings that involved entities from both Europe and Asia as originators.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name IN [""Europe"", ""Asia""]
WITH f, e, c
MATCH (f)-[:ORIGINATOR]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c2.name IN [""Europe"", ""Asia""] AND c.name <> c2.name
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has period_begin $pb;
originator (filing: $f, originating_entity: $e1);
originator (filing: $f, originating_entity: $e2);
entity_country (fincen_entity: $e1, country: $c1);
entity_country (fincen_entity: $e2, country: $c2);
$c1 has name ""Europe"";
$c2 has name ""Asia"";
sort $pb;
limit 3;
fetch {
  ""filing"": $f.filing_id
};"
383,Which 5 filings involved the most distinct banks as beneficiaries?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, count(DISTINCT e.id) AS distinct_banks
ORDER BY distinct_banks DESC
LIMIT 5
RETURN f.sar_id AS filing_id, distinct_banks","match
$f isa filing, has sar_id $sid;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
select $e, $f, $sid;
distinct;
reduce $count = count($e) groupby $f, $sid;
sort $count desc;
limit 5;
fetch { ""filing_id"": $sid, ""distinct_banks"": $count };"
384,What are the top 3 beneficiary entities in transactions from Asia?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank_country IN [""Singapore"", ""China"", ""Japan"", ""South Korea"", ""India"", ""Indonesia"", ""Malaysia"", ""Philippines"", ""Thailand"", ""Vietnam""]
RETURN e.name AS BeneficiaryEntity, COUNT(f) AS TransactionCount
ORDER BY TransactionCount DESC
LIMIT 3","match
$f isa filing, has originator_bank_country $obc;
{ $obc == ""Singapore""; } or { $obc == ""China""; } or { $obc == ""Japan""; } or { $obc == ""South Korea""; } or { $obc == ""India""; } or { $obc == ""Indonesia""; } or { $obc == ""Malaysia""; } or { $obc == ""Philippines""; } or { $obc == ""Thailand""; } or { $obc == ""Vietnam""; };
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""BeneficiaryEntity"": $e.name, ""TransactionCount"": $count };"
385,Show the first 5 originator entities by the total number of transactions they initiated.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(e)
WITH e, COUNT(f) AS transaction_count
ORDER BY transaction_count DESC
LIMIT 5
RETURN e.name AS originator_entity, transaction_count","match
$e isa fincen_entity, has name $n;
filed (filer: $e, filing: $f);
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 5;
fetch {
  ""originator_entity"": $n,
  ""transaction_count"": $count
};"
386,List the top 3 countries based on the number of beneficiary banks they have.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c.name AS country, COUNT(DISTINCT e) AS beneficiary_bank_count
ORDER BY beneficiary_bank_count DESC
LIMIT 3
RETURN country, beneficiary_bank_count","match
$c isa country, has name $country;
entity_country (country: $c, fincen_entity: $e);
benefits (beneficiary: $e);
select $c, $country, $e;
distinct;
reduce $count = count($e) groupby $c, $country;
sort $count desc;
limit 3;
fetch { ""country"": $country, ""beneficiary_bank_count"": $count };"
387,Which 5 filings have entities from more than one country as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, collect(DISTINCT c.code) AS countries
WHERE size(countries) > 1
RETURN f.id AS filing_id, countries
ORDER BY f.begin
LIMIT 5","match
  $f isa filing;
  originator (filing: $f, originating_entity: $e);
  entity_country (fincen_entity: $e, country: $c);
select $f, $c;
distinct;
reduce $count = count($c) groupby $f;
match
  $count > 1;
  $f has period_begin $pb;
sort $pb;
limit 5;
fetch {
  ""filing_id"": $f.filing_id
};"
388,What are the first 3 filings with the smallest amount transferred?,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has amount $a;
sort $a asc;
limit 3;
fetch {
  ""filing"": { $f.* }
};"
389,Show the top 5 beneficiary countries by the total amount received in transactions.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 5
RETURN country, total_amount","match
$f isa filing, has amount $amt;
$e isa fincen_entity;
$c isa country;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($amt) groupby $c;
sort $total desc;
limit 5;
fetch {
  ""country"": $c.name,
  ""total_amount"": $total
};"
390,List the first 3 countries by the number of originator banks they have.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:ORIGINATOR]-(f:Filing)
WITH c.name AS country, COUNT(DISTINCT e.id) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN country, originator_count","match
$c isa country, has name $cn;
entity_country (country: $c, fincen_entity: $e);
originator (originating_entity: $e, filing: $f);
select $c, $cn, $e;
distinct;
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""originator_count"": $count };"
391,Which 5 entities have the most filings concerning them from Germany?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.originator_bank_country = ""Germany""
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$f isa filing, has originator_bank_country ""Germany"";
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
392,What are the top 3 originator banks in filings from the United Kingdom?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""United Kingdom""})
WITH f.originator_bank AS bank, COUNT(f) AS filings_count
RETURN bank
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has originator_bank $bank;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
$c isa country, has name ""United Kingdom"";
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $bank;
sort $count desc;
limit 3;
fetch { ""bank"": $bank };"
393,Show the first 5 filings with the largest amount of money transferred.,"MATCH (f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
394,List the filings where the beneficiary bank country is 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country
  }
};"
395,List the top 3 countries with the most filings as a beneficiary in 2013.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.begin >= datetime('2013-01-01T00:00:00Z') AND f.end <= datetime('2013-12-31T23:59:59Z')
RETURN c.name AS country, COUNT(f) AS filings
ORDER BY filings DESC
LIMIT 3","match
$f isa filing, has period_begin $pb, has period_end $pe;
$pb >= 2013-01-01T00:00:00;
$pe <= 2013-12-31T23:59:59;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;"
396,What are the first 3 countries with entities that have filed the most in the technology sector?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(tech:Entity {name: ""Technology""})
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings
ORDER BY filings DESC
LIMIT 3
RETURN country, filings","match
$tech isa fincen_entity, has name ""Technology"";
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $tech);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $filings = count($f) groupby $c, $country;
sort $filings desc;
limit 3;
fetch { ""country"": $country, ""filings"": $filings };"
397,What are the first 3 filings with the highest number of entities listed as concerns from different countries?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c.code) AS country_count
ORDER BY country_count DESC, f.begin ASC
LIMIT 3
RETURN f.sar_id AS filing_id, country_count","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
select $f, $c;
distinct;
reduce $count = count($c) groupby $f;
match $f has period_begin $b;
sort $count desc, $b asc;
limit 3;
fetch { ""filing_id"": $f.sar_id, ""country_count"": $count };"
398,Which 5 filings had the most entities listed as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, COUNT(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN f.sar_id AS filing_id, originator_count","match
$f isa filing, has sar_id $sid;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f, $sid;
sort $count desc;
limit 5;
fetch {
  ""filing_id"": $sid,
  ""originator_count"": $count
};"
399,Show the top 5 filings with the largest number of concerns.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(e) AS concernCount
ORDER BY concernCount DESC
LIMIT 5
RETURN f.sar_id AS FilingID, concernCount","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch {
  ""FilingID"": $f.sar_id,
  ""concernCount"": $count
};"
400,List the first 3 filings with entities from more than three different countries as beneficiaries.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, COUNT(DISTINCT c.code) AS countryCount
WHERE countryCount > 3
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has begin_date $bd;
$e isa fincen_entity;
$c isa country;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
select $f, $c, $bd;
distinct;
reduce $count = count($c) groupby $f, $bd;
match $count > 3;
sort $bd asc;
limit 3;
fetch { ""filing"": $f.filing_id };"
401,Which 5 filings have the most distinct beneficiary iso codes involved?,"MATCH (f:Filing)
WITH f, f.beneficiary_iso AS iso
ORDER BY iso
WITH f, collect(DISTINCT iso) AS distinct_isos
ORDER BY size(distinct_isos) DESC
LIMIT 5
RETURN f.sar_id AS filing_id, size(distinct_isos) AS distinct_beneficiary_iso_count","match
$f isa filing, has beneficiary_iso $iso;
reduce $count = count($iso) groupby $f;
sort $count desc;
limit 5;
fetch {
  ""filing_id"": $f.sar_id,
  ""distinct_beneficiary_iso_count"": $count
};"
402,What are the top 3 beneficiary banks in transactions involving multiple currencies?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f.beneficiary_bank AS bank, COUNT(DISTINCT f.originator_iso) AS currency_count
WHERE currency_count > 1
RETURN bank, currency_count
ORDER BY currency_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank $bank, has originator_iso $iso;
select $bank, $iso;
distinct;
reduce $currency_count = count groupby $bank;
match
$currency_count > 1;
sort $currency_count desc;
limit 3;
fetch {
  ""bank"": $bank,
  ""currency_count"": $currency_count
};"
403,Show the first 5 filings with the most entities involved as concerns from the same sector.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 5
MATCH (f)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN f.sar_id AS FilingID, f.begin AS BeginDate, f.end AS EndDate, COLLECT(e.name) AS ConcernedEntities, c.name AS Country","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
match
concerns (filing: $f, concerned_entity: $e2);
entity_country (fincen_entity: $e2, country: $c);
fetch {
  ""FilingID"": $f.sar_id,
  ""BeginDate"": $f.begin_date,
  ""EndDate"": $f.end_date,
  ""ConcernedEntities"": [ $e2.name ],
  ""Country"": $c.name
};"
404,"List the top 3 originator banks by the number of filings involving transactions below $50,000.","MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.amount < 50000
RETURN e.name AS originator_bank, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a < 50000;
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $n, ""num_filings"": $count };"
406,What are the top 3 filings with the highest number of entities involved as concerns from different sectors?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(DISTINCT e) AS num_entities
ORDER BY num_entities DESC
LIMIT 3
RETURN f.sar_id AS filing_id, num_entities","match
$f isa filing, has sar_id $sid;
concerns (filing: $f, concerned_entity: $e);
reduce $num_entities = count($e) groupby $f, $sid;
sort $num_entities desc;
limit 3;
fetch {
  ""filing_id"": $sid,
  ""num_entities"": $num_entities
};"
407,Show the top 5 entities by the number of filings they are involved in as both originator and beneficiary.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, 
     COUNT(CASE WHEN (f)-[:ORIGINATOR]->(e) THEN 1 END) AS originator_count,
     COUNT(CASE WHEN (f)-[:BENEFITS]->(e) THEN 1 END) AS beneficiary_count
WITH e, (originator_count + beneficiary_count) AS total_count
ORDER BY total_count DESC
LIMIT 5
RETURN e.name AS entity_name, total_count","match
$e isa fincen_entity;
$rel isa $t (filing: $f, $e);
{ $t label originator; } or { $t label benefits; };
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""total_count"": $count };"
408,Which 5 countries have the highest number of filings with entities as both originator and beneficiary?,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity)-[:COUNTRY]->(c1:Country),
      (f)-[:BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE c1.code = c2.code
WITH c1.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN country, filings_count","match
$f isa filing;
$e1 isa fincen_entity;
$e2 isa fincen_entity;
originator (filing: $f, originating_entity: $e1);
benefits (filing: $f, beneficiary: $e2);
entity_country (fincen_entity: $e1, country: $c);
entity_country (fincen_entity: $e2, country: $c);
$c has name $country_name;
reduce $count = count($f) groupby $c, $country_name;
sort $count desc;
limit 5;
fetch { ""country"": $country_name, ""filings_count"": $count };"
409,What are the first 3 filings with the highest total number of concerns?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(e) AS concern_count
ORDER BY concern_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, concern_count","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 3;
fetch {
  ""filing_id"": $f.sar_id,
  ""concern_count"": $count
};"
410,Show the top 5 filings with the most entities involved as originators from the same country.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, COUNT(DISTINCT e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN f.sar_id AS FilingID, originator_count AS OriginatorCount, c.name AS Country","match
$f isa filing;
$e isa fincen_entity;
$c isa country;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
select $f, $e, $c;
distinct;
reduce $count = count($e) groupby $f, $c;
sort $count desc;
limit 5;
fetch {
  ""FilingID"": $f.sar_id,
  ""OriginatorCount"": $count,
  ""Country"": $c.name
};"
411,List the first 3 countries by the number of filings they have as a beneficiary in transactions involving multiple currencies.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country IS NOT NULL AND f.originator_bank_country IS NOT NULL AND f.beneficiary_bank_country <> f.originator_bank_country
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country $bbc, has originator_bank_country $obc;
$bbc != $obc;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
$c isa country, has name $cn;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""filings_count"": $count };"
412,Which 5 countries have the highest total number of filings as an originator?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS total_filings
ORDER BY total_filings DESC
LIMIT 5
RETURN country, total_filings","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $country_name;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total_filings = count($f) groupby $c, $country_name;
sort $total_filings desc;
limit 5;
fetch { ""country"": $country_name, ""total_filings"": $total_filings };"
413,What are the top 3 filings with the most entities listed as originators from different countries?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, count(DISTINCT c.code) AS originator_countries_count
ORDER BY originator_countries_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, originator_countries_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
select $f, $c;
distinct;
reduce $count = count($c) groupby $f;
sort $count desc;
limit 3;
fetch { ""filing_id"": $f.sar_id, ""originator_countries_count"": $count };"
414,Show the first 5 entities that have filed the most number of transactions involving multiple countries.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_iso <> f.beneficiary_iso
WITH e, COUNT(f) AS num_transactions
ORDER BY num_transactions DESC
LIMIT 5
RETURN e.name AS entity_name, num_transactions","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
$f has originator_iso $oi;
$f has beneficiary_iso $bi;
$oi != $bi;
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $e.name,
  ""num_transactions"": $count
};"
415,List the top 3 originator banks with the most filings involving transactions above $1 million.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS originator_bank, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 1000000;
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""originator_bank"": $n, ""num_filings"": $count };"
416,Which 5 countries have the least number of filings as a beneficiary?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c, COUNT(f) AS num_filings
ORDER BY num_filings ASC
LIMIT 5
RETURN c.name AS country, num_filings","match
$c isa country;
entity_country (country: $c, fincen_entity: $e);
benefits (beneficiary: $e, filing: $f);
reduce $count = count($f) groupby $c;
sort $count asc;
limit 5;
fetch { ""country"": $c.name, ""num_filings"": $count };"
417,What are the first 3 filings with the highest number of entities concerned from the same country?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, f.begin AS filing_begin, f.end AS filing_end, entity_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country;
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $f, $c;
sort $count desc;
limit 3;
fetch {
  ""filing_id"": $f.sar_id,
  ""filing_begin"": $f.begin_date,
  ""filing_end"": $f.end_date,
  ""entity_count"": $count
};"
418,"Show the first 5 countries with the most filings involving transactions below $100,000.","MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount < 100000
WITH c.name AS country, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 5
RETURN country, filing_count","match
$f isa filing, has amount $a;
$a < 100000;
$e isa fincen_entity;
$rel isa $t ($f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
entity_country (fincen_entity: $e, country: $c);
reduce $filing_count = count($f) groupby $c;
sort $filing_count desc;
limit 5;
fetch { ""country"": $c.name, ""filing_count"": $filing_count };"
419,List the top 3 filings with the most entities involved as beneficiaries from the same country.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c, COUNT(DISTINCT e) AS beneficiary_count
ORDER BY beneficiary_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, beneficiary_count, COLLECT(c.name) AS countries","match
$f isa filing, has sar_id $sid;
$e isa fincen_entity;
$c isa country, has name $cn;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $f, $c, $sid, $cn;
sort $count desc;
limit 3;
fetch {
  ""filing_id"": $sid,
  ""beneficiary_count"": $count,
  ""country"": $cn
};"
420,Which 5 countries have the highest number of filings involving transactions above $2 million?,"MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.amount > 2000000
WITH c.name AS country, COUNT(f) AS filings_count
RETURN country, filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has amount $a;
$a > 2000000;
$e isa fincen_entity;
{ benefits (filing: $f, beneficiary: $e); } or { concerns (filing: $f, concerned_entity: $e); } or { originator (filing: $f, originating_entity: $e); };
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.name, ""filings_count"": $count };"
421,What are the first 3 filings where the originator and beneficiary are the same entity?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity), (f)-[:BENEFITS]->(e)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
$f has begin_date $bd;
sort $bd asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""begin_date"": $f.begin_date,
  ""end_date"": $f.end_date,
  ""amount"": $f.amount
};"
422,List the first 3 filings with entities that are both originator and beneficiary.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)<-[:BENEFITS]-(f)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$f isa filing, has period_begin $b;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
sort $b asc;
limit 3;
fetch {
  ""filing"": $f
};"
423,Which 3 entities have filed the most number of filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
424,Which entities have filed a filing with an amount over 500000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 500000
RETURN e.name AS EntityName, f.amount AS FilingAmount","match
$e isa fincen_entity, has name $n;
$f isa filing, has amount $a;
filed (filer: $e, filing: $f);
$a > 500000;
fetch {
  ""EntityName"": $n,
  ""FilingAmount"": $a
};"
425,What are the names of the top 5 countries by the number of originating banks?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country_name, COUNT(DISTINCT e.id) AS originating_banks_count
ORDER BY originating_banks_count DESC
LIMIT 5
RETURN country_name, originating_banks_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country_name"": $cn, ""originating_banks_count"": $count };"
426,Display the country codes for the top 3 countries where the originator entities of filings are located.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.code AS country_code, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
RETURN country_code","match
$f isa filing;
$e isa fincen_entity;
$c isa country;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country_code"": $c.code
};"
428,What are the names of the top 5 entities that originated the most filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
RETURN e.name AS entity_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$e isa fincen_entity;
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
match $e has name $n;
fetch { ""entity_name"": $n, ""filings_count"": $count };"
429,Which 3 countries have entities that filed the most filings with an end date in 2016?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(c:Country)
WHERE f.end_date_format CONTAINS ""2016""
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$e isa fincen_entity;
$f isa filing, has end_date_format $edf;
$edf like "".*2016.*"";
$c isa country, has name $cn;
filed (filer: $e, filing: $f);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""filings_count"": $count };"
430,List the top 5 filings by number that had a beneficiary bank in 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has number $n;
sort $n desc;
limit 5;
fetch {
  ""filing"": { ""number"": $f.number, ""filing_id"": $f.filing_id, ""beneficiary_bank_country"": $f.beneficiary_bank_country }
};"
431,"What are the names and locations of the top 3 entities that benefited from filings where the amount exceeded 500,000?","MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.amount > 500000
RETURN e.name AS entity_name, e.location AS entity_location, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 500000;
$e isa fincen_entity;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""entity_location"": $e.country_code,
  ""filing_count"": $count
};"
432,How many entities are connected to a filing where the originator bank country is 'Singapore'? Limit to top 3 results.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
WITH e, COUNT(f) AS num_filings
RETURN e.name AS entity_name, num_filings
ORDER BY num_filings DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""Singapore"";
$e isa fincen_entity, has name $ename;
originator (filing: $f, originating_entity: $e);
reduce $num_filings = count($f) groupby $e, $ename;
sort $num_filings desc;
limit 3;
fetch { ""entity_name"": $ename, ""num_filings"": $num_filings };"
433,List the countries of origin for the top 5 filings with the highest amounts.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH f, c
ORDER BY f.amount DESC
LIMIT 5
RETURN c.name AS country_of_origin, f.amount","match
$f isa filing, has amount $a;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 5;
fetch {
  ""country_of_origin"": $c.name,
  ""amount"": $a
};"
435,Name the top 3 entities that filed the most filings with a beneficiary bank in 'United Kingdom'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN e.name AS entity_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filings_count"": $count
};"
436,What are the top 3 filings with the highest amounts that involve an entity based in 'China'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e)
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$e isa fincen_entity;
$c isa country, has name ""China"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has amount $amt;
$rel isa $t ($role_f: $f, $role_e: $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
sort $amt desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $amt
};"
437,List the last 3 filings by end date that concerned entities based in 'China'.,"MATCH (c:Country {name: 'China'})<-[:COUNTRY]-(e:Entity)<-[:CONCERNS]-(f:Filing)
RETURN f
ORDER BY f.end DESC
LIMIT 3","match
$c isa country, has name ""China"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
$f has end_date $ed;
sort $ed desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""end_date"": $f.end_date,
  ""begin_date"": $f.begin_date,
  ""amount"": $f.amount,
  ""number"": $f.number,
  ""filer_org_name"": $f.filer_org_name
};"
438,Which top 5 countries are most frequently listed as the beneficiary bank country in filings?,"MATCH (f:Filing)
WITH f.beneficiary_bank_country AS country, COUNT(f) AS filings_count
RETURN country
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank_country $country;
reduce $count = count($f) groupby $country;
sort $count desc;
limit 5;
fetch {
  ""country"": $country
};"
439,"List the top 3 entities based on the number of filings they originated with an amount over 2,000,000.","MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 2000000
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has amount $a;
$a > 2000000;
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
440,List the top 3 countries by the number of entities registered there.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC
LIMIT 3
RETURN country, entity_count","match
$e isa fincen_entity;
$c isa country, has name $country_name;
entity_country (fincen_entity: $e, country: $c);
reduce $entity_count = count($e) groupby $c, $country_name;
sort $entity_count desc;
limit 3;
fetch {
  ""country"": $country_name,
  ""entity_count"": $entity_count
};"
441,Identify the top 5 filer organizations by the total amount of filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e.name AS filer_org_name, SUM(f.amount) AS total_amount
RETURN filer_org_name, total_amount
ORDER BY total_amount DESC
LIMIT 5","match
$e isa fincen_entity, has name $n;
filed (filer: $e, filing: $f);
$f has amount $a;
reduce $total = sum($a) groupby $e, $n;
sort $total desc;
limit 5;
fetch { ""filer_org_name"": $n, ""total_amount"": $total };"
442,Which 3 countries have the most originator banks associated with filings?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(DISTINCT e.id) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN country, originator_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
select $e, $c, $country;
distinct;
reduce $count = count($e) groupby $c, $country;
sort $count desc;
limit 3;
fetch { ""country"": $country, ""originator_count"": $count };"
443,Find the 3 highest amounts of filings that originated from the United Kingdom.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""United Kingdom""})
RETURN f.amount AS amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 3;
fetch { ""amount"": $a };"
444,What are the top 5 filings based on the number of beneficiaries they concern?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, count(e) as beneficiary_count
ORDER BY beneficiary_count DESC
LIMIT 5
RETURN f.sar_id AS filing_id, beneficiary_count","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch {
  ""filing_id"": $f.sar_id,
  ""beneficiary_count"": $count
};"
445,"What are the top 5 filings by amount that were filed between January 1, 2015, and December 31, 2015?","MATCH (f:Filing)
WHERE f.begin >= datetime(""2015-01-01T00:00:00Z"") AND f.end <= datetime(""2015-12-31T23:59:59Z"")
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2015-01-01T00:00:00;
$pe <= 2015-12-31T23:59:59;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""period_begin"": $pb,
  ""period_end"": $pe
};"
446,How many filings are associated with the entity 'The Bank of New York Mellon Corp.' as both originator and beneficiary?,"MATCH (e:Entity {name: 'The Bank of New York Mellon Corp.'})-[:FILED]->(f:Filing)
WHERE (f)-[:ORIGINATOR]->(e) AND (f)-[:BENEFITS]->(e)
RETURN COUNT(f) AS numberOfFilings","match
$e isa fincen_entity, has name ""The Bank of New York Mellon Corp."";
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f);"
447,Which entities benefited from filings where the originator bank was 'CIMB Bank Berhad'? Limit to top 3 results.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN e.name AS BeneficiaryEntity, COUNT(f) AS FilingCount
ORDER BY FilingCount DESC
LIMIT 3","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"";
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch {
  ""BeneficiaryEntity"": $n,
  ""FilingCount"": $count
};"
448,List the names of countries where the beneficiary bank of the filing is located. Limit to top 5 results.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c.name AS country_name
ORDER BY country_name
LIMIT 5","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
select $n;
distinct;
sort $n asc;
limit 5;
fetch { ""country_name"": $n };"
449,What are the top 5 filings where the beneficiary bank country is 'United Kingdom' and the originator bank country is 'Singapore'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.originator_bank_country = 'Singapore'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing,
  has beneficiary_bank_country ""United Kingdom"",
  has originator_bank_country ""Singapore"",
  has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country,
    ""originator_bank_country"": $f.originator_bank_country
  }
};"
450,Which entities are connected to a country with the code 'AFG' via the COUNTRY relationship?,"MATCH (c:Country {code: 'AFG'})<-[:COUNTRY]-(e:Entity)
RETURN e.name AS entity_name, e.id AS entity_id","match
$c isa country, has code ""AFG"";
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""entity_name"": $e.name,
  ""entity_id"": $e.entity_id
};"
451,List the top 5 entities by the number of filings where the originator bank's country code is 'SGP'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_iso = 'SGP'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 5
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $name;
$f isa filing, has originator_iso ""SGP"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 5;
fetch {
  ""entity_name"": $name,
  ""num_filings"": $count
};"
452,What are the three highest amounts filed by entities located in 'China'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})-[:FILED]->(f:Filing)
RETURN f.amount AS amount
ORDER BY f.amount DESC
LIMIT 3","match
  $e isa fincen_entity;
  $c isa country, has name ""China"";
  entity_country (fincen_entity: $e, country: $c);
  filed (filer: $e, filing: $f);
  $f has amount $a;
sort $a desc;
limit 3;
fetch {
  ""amount"": $a
};"
453,Identify the top 3 filings where the beneficiary bank's country is 'United Kingdom' and the amount is over 500000.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'United Kingdom' AND f.amount > 500000
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$a > 500000;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name ""United Kingdom"";
sort $a desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a
};"
454,List the three entities with the most filings where the originator bank's ISO code is 'SGP'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_iso = 'SGP'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $n;
$f isa filing, has originator_iso ""SGP"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""entity_name"": $n, ""num_filings"": $count };"
455,What are the top 5 filings with the largest amounts where the beneficiary bank's ISO code is 'GBR'?,"MATCH (f:Filing)
WHERE f.beneficiary_iso = 'GBR'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_iso ""GBR"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": { $f.* }
};"
456,Which filings have a beneficiary bank in 'United Kingdom' and an amount greater than 1000000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN f","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$a > 1000000;
fetch {
  ""filing"": { $f.* }
};"
457,Find the first 3 entities with filings that involve a country with the top-level domain '.AF'.,"MATCH (c:Country {tld: 'AF'})<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
RETURN e.name AS entity_name, f.sar_id AS filing_id
ORDER BY f.begin
LIMIT 3","match
$c isa country, has tld ""AF"";
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
$f has begin_date $bd;
sort $bd;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filing_id"": $f.sar_id
};"
458,List the first 3 entities that have filed something concerning a beneficiary in Afghanistan.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""Afghanistan""})
MATCH (e)-[:FILED]->(f)
RETURN DISTINCT e.name
LIMIT 3","match
$e isa fincen_entity;
$b isa fincen_entity;
$f isa filing;
$c isa country, has name ""Afghanistan"";
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $b);
entity_country (fincen_entity: $b, country: $c);
$e has name $n;
select $n;
distinct;
limit 3;
fetch {
  ""name"": $n
};"
459,Which three entities have the most filings where the originator bank is 'Barclays Bank Plc'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank = 'Barclays Bank Plc'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $name;
$f isa filing, has originator_bank ""Barclays Bank Plc"";
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e, $name;
sort $num_filings desc;
limit 3;
fetch { ""entity_name"": $name, ""num_filings"": $num_filings };"
460,What are the three entities with the highest total filing amounts where the originator bank country is 'Singapore'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank_country = 'Singapore'
WITH e, SUM(f.amount) AS totalAmount
RETURN e.name AS entityName, totalAmount
ORDER BY totalAmount DESC
LIMIT 3","match
$f isa filing, has originator_bank_country ""Singapore"", has amount $a;
originator (filing: $f, originating_entity: $e);
$e has name $n;
reduce $total = sum($a) groupby $e, $n;
sort $total desc;
limit 3;
fetch { ""entityName"": $n, ""totalAmount"": $total };"
461,Identify the top 3 entities based on the total amount of filings where the beneficiary bank's country is 'United Kingdom'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, SUM(f.amount) AS totalAmount
RETURN e.name AS entityName, totalAmount
ORDER BY totalAmount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
reduce $total = sum($a) groupby $e, $n;
sort $total desc;
limit 3;
fetch { ""entityName"": $n, ""totalAmount"": $total };"
462,List the top 5 filings by number where the filing began in 2015.,"MATCH (f:Filing)
WHERE f.begin_date_format STARTS WITH ""2015""
RETURN f
ORDER BY f.number DESC
LIMIT 5","match
$f isa filing, has begin_date_format $bdf, has number $n;
$bdf like ""^2015.*"";
sort $n desc;
limit 5;
fetch {
  ""filing"": { $f.* }
};"
463,Which three entities have the most filings ending in the year 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.end_date_format STARTS WITH ""2015""
RETURN e.name AS entity_name, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing, has end_date_format $edf;
$edf like ""2015.*"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filings_count"": $count
};"
464,Find the first 3 countries associated with entities that have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 10
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c.name
LIMIT 3","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
match $count > 10;
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
select $n;
distinct;
limit 3;
fetch { ""name"": $n };"
465,What are the top 5 countries by the number of filings where the beneficiary bank country code is 'GBR'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_iso = 'GBR'
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has beneficiary_iso ""GBR"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""filings_count"": $count };"
466,List the three entities with the most filings involving a beneficiary bank in 'United Kingdom' and an originator bank in 'Singapore'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.originator_bank_country = 'Singapore'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has originator_bank_country ""Singapore"";
benefits (filing: $f, beneficiary: $e);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $num_filings
};"
467,Which filings originated from entities in 'Singapore' and ended in 2015? Limit to top 5 results.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
MATCH (e)-[:FILED]->(f:Filing)
WHERE f.end_date_format CONTAINS '2015'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$c isa country, has name ""Singapore"";
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
$f has end_date_format $edf;
$edf like "".*2015.*"";
$f has amount $amt;
sort $amt desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $f.amount,
  ""end_date_format"": $f.end_date_format,
  ""filer_org_name"": $f.filer_org_name
};"
468,"What are the names of entities that filed a filing with an amount greater than 1,000,000? Limit to first 3 results.","MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
RETURN e.name
LIMIT 3","match
$e isa fincen_entity, has name $n;
$f isa filing, has amount $a;
$a > 1000000;
filed (filer: $e, filing: $f);
limit 3;
fetch {
  ""name"": $n
};"
469,List the top 5 filings by amount where the beneficiary bank is 'Barclays Bank Plc'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a,
  ""beneficiary_bank"": $f.beneficiary_bank,
  ""originator_bank"": $f.originator_bank,
  ""filer_org_name"": $f.filer_org_name,
  ""sar_id"": $f.sar_id,
  ""number"": $f.number,
  ""begin_date"": $f.begin_date,
  ""end_date"": $f.end_date
};"
470,Which 3 filings have the highest number of originator entities involved?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, count(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN f.sar_id AS filing_id, originator_count","match
$f isa filing, has sar_id $sid;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f, $sid;
sort $count desc;
limit 3;
fetch { ""filing_id"": $sid, ""originator_count"": $count };"
471,Identify the top 5 originator banks by the total number of filings they initiated.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE e.id = f.originator_bank_id
RETURN e.name AS originator_bank, COUNT(f) AS total_filings
ORDER BY total_filings DESC
LIMIT 5","match
$e isa fincen_entity;
$f isa filing;
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""originator_bank"": $e.name, ""total_filings"": $count };"
472,What are the first 3 filings made by 'The Bank of New York Mellon Corp.'?,"MATCH (e:Entity {name: ""The Bank of New York Mellon Corp.""})-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$e isa fincen_entity, has name ""The Bank of New York Mellon Corp."";
filed (filer: $e, filing: $f);
$f has period_begin $begin;
sort $begin asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""period_begin"": $f.period_begin,
  ""period_end"": $f.period_end,
  ""amount"": $f.amount,
  ""number"": $f.number
};"
473,Which 3 filings have beneficiary banks located at a longitude less than 0?,"MATCH (f:Filing)
WHERE toFloat(f.beneficiary_lng) < 0
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_lng $lng, has amount $a;
$lng like ""^-.*"";
sort $a desc;
limit 3;
fetch {
  ""filing"": $f
};"
474,Identify the top 3 entities that have filed the least amount of filings but have the highest amounts in those filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings, SUM(f.amount) AS total_amount
ORDER BY num_filings ASC, total_amount DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings, total_amount","with fun filing_count($e: fincen_entity) -> integer:
  match
    filed (filer: $e, filing: $f);
  return count;
with fun total_filing_amount($e: fincen_entity) -> integer:
  match
    filed (filer: $e, filing: $f);
    $f has amount $a;
  return sum($a);
match
  $e isa fincen_entity;
  filed (filer: $e);
let $num_filings = filing_count($e);
let $total_amount = total_filing_amount($e);
sort $num_filings asc, $total_amount desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings, ""total_amount"": $total_amount };"
475,List the first 3 countries where the most filings have ended.,"MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.end IS NOT NULL
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$f isa filing, has period_end $pe;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""filings_count"": $count };"
476,What are the top 5 filings with the most entities involved as originators?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, COUNT(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN f.sar_id AS filing_id, originator_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch { ""filing_id"": $f.sar_id, ""originator_count"": $count };"
478,List the first 3 countries that have the most filings where the originator bank's country is different from the beneficiary bank's country.,"MATCH (f:Filing)
WHERE f.originator_bank_country <> f.beneficiary_bank_country
WITH f.originator_bank_country AS origin_country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
MATCH (c:Country {name: origin_country})
RETURN c.name AS country, filings_count","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc;
$obc != $bbc;
$c isa country, has name $cn;
$cn == $obc;
reduce $count = count($f) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.name, ""filings_count"": $count };"
479,Identify the top 5 filings with the most entities involved as beneficiaries.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WITH f, COUNT(e) AS beneficiaryCount
ORDER BY beneficiaryCount DESC
LIMIT 5
RETURN f.sar_id AS filing_id, beneficiaryCount","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch { ""filing_id"": $f.sar_id, ""beneficiaryCount"": $count };"
480,Which 3 countries have entities that have filed the most concerning filings?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(:Entity)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
RETURN country, filing_count","match
$e isa fincen_entity;
$f isa filing;
$c isa country, has name $country_name;
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $ce);
entity_country (fincen_entity: $e, country: $c);
reduce $filing_count = count($f) groupby $c, $country_name;
sort $filing_count desc;
limit 3;
fetch {
  ""country"": $country_name,
  ""filing_count"": $filing_count
};"
481,List the first 3 filings made by entities located in countries with the top-level domain '.de'.,"MATCH (c:Country {tld: 'DE'})<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$c isa country, has tld ""DE"";
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
$f has period_begin $begin;
sort $begin asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""begin_date"": $f.begin_date,
  ""end_date"": $f.end_date,
  ""amount"": $f.amount
};"
482,Find the top 5 countries where entities have filed the most filings that began in 2017.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(e)
WHERE f.begin >= datetime('2017-01-01T00:00:00Z') AND f.begin < datetime('2018-01-01T00:00:00Z')
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 5","match
$f isa filing, has period_begin $pb;
$pb >= 2017-01-01T00:00:00;
$pb < 2018-01-01T00:00:00;
$e isa fincen_entity;
filed (filer: $e, filing: $f);
originator (originating_entity: $e, filing: $f);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $count = count($f) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""filings_count"": $count };"
483,Find the top 5 entities that have the most filings concerning entities in their own country.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(c:Entity)
MATCH (e)-[:COUNTRY]->(ec:Country)
MATCH (c)-[:COUNTRY]->(cc:Country)
WHERE ec.code = cc.code
WITH e, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 5
RETURN e.name AS entity_name, filing_count","match
$e isa fincen_entity;
$c isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $c);
entity_country (fincen_entity: $e, country: $country);
entity_country (fincen_entity: $c, country: $country);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""filing_count"": $count };"
484,Identify the top 3 filings with the latest end dates.,"MATCH (f:Filing)
WITH f
ORDER BY f.end DESC
LIMIT 3
RETURN f","match
$f isa filing, has period_end $pe;
sort $pe desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""period_end"": $pe
  }
};"
485,List the first 3 entities based in 'Singapore' that have filed something concerning a beneficiary in 'Malaysia'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Singapore'})
MATCH (e)-[:FILED]->(f:Filing)-[:CONCERNS]->(b:Entity)-[:COUNTRY]->(bc:Country {name: 'Malaysia'})
RETURN e.name AS EntityName
LIMIT 3","match
$e isa fincen_entity;
$c1 isa country, has name ""Singapore"";
entity_country (fincen_entity: $e, country: $c1);
$f isa filing;
filed (filer: $e, filing: $f);
$b isa fincen_entity;
concerns (filing: $f, concerned_entity: $b);
$c2 isa country, has name ""Malaysia"";
entity_country (fincen_entity: $b, country: $c2);
limit 3;
fetch {
  ""EntityName"": $e.name
};"
486,What are the top 5 filings by the amount that originated from entities in 'Germany'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'Germany'})
MATCH (e)-[:FILED]->(f:Filing)
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$c isa country, has name ""Germany"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
originator (originating_entity: $e, filing: $f);
$f has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
487,Which 3 entities have filed the most filings that originated from a country other than their own?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(o:Entity)
WHERE e.country <> f.originator_iso
WITH e, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
RETURN e.name AS entity_name, filing_count","match
$e isa fincen_entity, has country_code $cc;
$f isa filing, has originator_iso $oi;
filed (filer: $e, filing: $f);
originator (originating_entity: $o, filing: $f);
$o isa fincen_entity;
not { $cc == $oi; };
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""filing_count"": $count };"
488,List the first 3 entities that have filed the most filings where the beneficiary bank's country is the same as the originator bank's country.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = f.originator_bank_country
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country $bbc, has originator_bank_country $obc;
$bbc == $obc;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
489,Identify the top 3 filings where the originator bank and the beneficiary bank are located at the same latitude.,"MATCH (f:Filing)
WHERE f.origin_lat = f.beneficiary_lat
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has origin_lat $olat, has beneficiary_lat $blat, has amount $a;
$olat == $blat;
sort $a desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""origin_lat"": $olat,
  ""beneficiary_lat"": $blat,
  ""amount"": $a
};"
490,Which 3 countries have the most filings where the originator bank's country is the same as the beneficiary bank's country?,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country
WITH f.originator_bank_country AS country, COUNT(f) AS filings_count
RETURN country
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc;
$obc == $bbc;
reduce $count = count($f) groupby $obc;
sort $count desc;
limit 3;
fetch { ""country"": $obc };"
491,List the first 3 countries with the most filings where the beneficiary bank's country is different from the filer organization's country.,"MATCH (f:Filing)-[:BENEFITS]->(beneficiary:Entity)-[:COUNTRY]->(beneficiaryCountry:Country),
      (f)-[:ORIGINATOR]->(originator:Entity)-[:COUNTRY]->(originatorCountry:Country)
WHERE beneficiaryCountry.code <> originatorCountry.code
WITH beneficiaryCountry, COUNT(f) AS filingCount
ORDER BY filingCount DESC
LIMIT 3
RETURN beneficiaryCountry.name AS Country, filingCount","match
$f isa filing;
benefits (filing: $f, beneficiary: $beneficiary);
entity_country (fincen_entity: $beneficiary, country: $bc);
originator (filing: $f, originating_entity: $orig);
entity_country (fincen_entity: $orig, country: $oc);
$bc has code $bc_code;
$oc has code $oc_code;
$bc_code != $oc_code;
reduce $filing_count = count($f) groupby $bc;
sort $filing_count desc;
limit 3;
fetch { ""Country"": $bc.name, ""filingCount"": $filing_count };"
492,What are the top 5 countries by the total number of filings that have entities as both originators and beneficiaries?,"MATCH (f:Filing)-[:ORIGINATOR]->(e1:Entity)-[:COUNTRY]->(c1:Country),
      (f)-[:BENEFITS]->(e2:Entity)-[:COUNTRY]->(c2:Country)
WHERE e1.id = e2.id
WITH c1.name AS country, COUNT(f) AS total_filings
RETURN country, total_filings
ORDER BY total_filings DESC
LIMIT 5","match
$f isa filing;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $total_filings = count($f) groupby $c, $country;
sort $total_filings desc;
limit 5;
fetch { ""country"": $country, ""total_filings"": $total_filings };"
493,Which 3 countries have the most entities involved as beneficiaries in filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c.name AS country, COUNT(DISTINCT e.id) AS entityCount
ORDER BY entityCount DESC
LIMIT 3
RETURN country, entityCount","match
$c isa country, has name $cn;
$e isa fincen_entity;
entity_country (country: $c, fincen_entity: $e);
benefits (beneficiary: $e, filing: $f);
select $c, $cn, $e;
distinct;
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""entity_count"": $count };"
494,Find the first 3 countries where the total amount of filings exceeds 1000000.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c, SUM(f.amount) AS totalAmount
WHERE totalAmount > 1000000
RETURN c.name AS country, totalAmount
ORDER BY totalAmount DESC
LIMIT 3","match
$c isa country, has name $cn;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$f isa filing, has amount $a;
filed (filer: $e, filing: $f);
reduce $total = sum($a) groupby $c, $cn;
match $total > 1000000;
sort $total desc;
limit 3;
fetch { ""country"": $cn, ""totalAmount"": $total };"
497,Identify the top 3 entities that have been the originator in the most filings.,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
originator (originating_entity: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $num_filings
};"
498,"Which 3 filings have the largest amounts and were filed between January 1, 2010, and December 31, 2015?","MATCH (f:Filing)
WHERE f.begin >= datetime('2010-01-01T00:00:00Z') AND f.end <= datetime('2015-12-31T23:59:59Z')
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has period_begin $pb, has period_end $pe, has amount $a;
$pb >= 2010-01-01T00:00:00;
$pe <= 2015-12-31T23:59:59;
sort $a desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""period_begin"": $pb,
    ""period_end"": $pe
  }
};"
499,List the first 3 countries where the beneficiary latitude is greater than 50 degrees.,"MATCH (f:Filing)
WHERE toFloat(f.beneficiary_lat) > 50
MATCH (f)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c.name
LIMIT 3","match
$f isa filing, has beneficiary_lat $lat;
$lat > ""50"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
select $n;
distinct;
limit 3;
fetch { ""name"": $n };"
500,What are the top 5 filings that ended in the year 2015?,"MATCH (f:Filing)
WHERE f.end_date_format >= ""2015-01-01T00:00:00Z"" AND f.end_date_format < ""2016-01-01T00:00:00Z""
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has end_date_format $edf, has amount $a;
$edf like ""^2015.*"";
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""end_date_format"": $f.end_date_format,
    ""amount"": $f.amount,
    ""filing_id"": $f.filing_id
  }
};"
501,Which 3 entities have filed the most filings that benefit entities in Germany?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(c:Country {name: ""Germany""})
WITH e, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
RETURN e.name AS entity_name, filing_count","match
$e isa fincen_entity;
$f isa filing;
$b isa fincen_entity;
$c isa country, has name ""Germany"";
filed (filer: $e, filing: $f);
benefits (filing: $f, beneficiary: $b);
entity_country (fincen_entity: $b, country: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""filing_count"": $count };"
502,Identify the top 3 filings in terms of amount that concern entities in Singapore.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})
RETURN f.sar_id AS filing_id, f.amount AS amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has sar_id $sid, has amount $amt;
$e isa fincen_entity;
$c isa country, has name ""Singapore"";
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
sort $amt desc;
limit 3;
fetch {
  ""filing_id"": $sid,
  ""amount"": $amt
};"
503,List the first 3 entities based in countries with a '.uk' top-level domain.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.tld = 'uk'
RETURN e.name AS entity_name, c.name AS country_name
LIMIT 3","match
$e isa fincen_entity, has name $en;
$c isa country, has tld ""uk"", has name $cn;
entity_country (fincen_entity: $e, country: $c);
limit 3;
fetch {
  ""entity_name"": $en,
  ""country_name"": $cn
};"
504,What are the top 5 filings with the earliest begin dates?,"MATCH (f:Filing)
WITH f
ORDER BY f.begin ASC
LIMIT 5
RETURN f.sar_id AS SAR_ID, f.begin AS BeginDate, f.end AS EndDate, f.amount AS Amount, f.originator_bank AS OriginatorBank, f.beneficiary_bank AS BeneficiaryBank","match
$f isa filing, has begin_date $bd;
sort $bd asc;
limit 5;
fetch {
  ""SAR_ID"": $f.sar_id,
  ""BeginDate"": $bd,
  ""EndDate"": $f.end_date,
  ""Amount"": $f.amount,
  ""OriginatorBank"": $f.originator_bank,
  ""BeneficiaryBank"": $f.beneficiary_bank
};"
505,Which 3 filings involve the most entities either as originators or beneficiaries?,"MATCH (f:Filing)-[:ORIGINATOR|:BENEFITS]->(e:Entity)
WITH f, COUNT(DISTINCT e) AS entityCount
ORDER BY entityCount DESC
LIMIT 3
RETURN f.sar_id AS filing_id, entityCount","match
$f isa filing, has sar_id $sid;
$e isa fincen_entity;
{ originator (filing: $f, originating_entity: $e); } or { benefits (filing: $f, beneficiary: $e); };
select $f, $e, $sid;
distinct;
reduce $count = count($e) groupby $f, $sid;
sort $count desc;
limit 3;
fetch { ""filing_id"": $sid, ""entity_count"": $count };"
506,Which 3 countries have entities that have been beneficiaries in the most filings?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 3
RETURN country, filings_count","match
$c isa country, has name $country;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
benefits (filing: $f, beneficiary: $e);
reduce $filings_count = count($f) groupby $c, $country;
sort $filings_count desc;
limit 3;
fetch {
  ""country"": $country,
  ""filings_count"": $filings_count
};"
507,List the first 3 filings that originated from an entity in China.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {code: ""CHN""})
MATCH (f:Filing)-[:ORIGINATOR]->(e)
RETURN f
ORDER BY f.begin
LIMIT 3","match
$e isa fincen_entity;
$c isa country, has code ""CHN"";
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
originator (filing: $f, originating_entity: $e);
$f has period_begin $begin;
sort $begin asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""period_begin"": $f.period_begin,
  ""period_end"": $f.period_end,
  ""amount"": $f.amount,
  ""number"": $f.number
};"
509,List the first 3 entities that have filed the most concerning filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:CONCERNS]->(:Entity)
WITH e, COUNT(f) AS concern_count
ORDER BY concern_count DESC
LIMIT 3
RETURN e.name AS entity_name, concern_count","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
concerns (filing: $f, concerned_entity: $c);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""concern_count"": $count };"
510,Find the top 5 filings based on the number of different countries involved as either originator or beneficiary.,"MATCH (f:Filing)
OPTIONAL MATCH (f)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(oc:Country)
OPTIONAL MATCH (f)-[:BENEFITS]->(b:Entity)-[:COUNTRY]->(bc:Country)
WITH f, collect(DISTINCT oc.code) + collect(DISTINCT bc.code) AS countries
WITH f, size(apoc.coll.toSet(countries)) AS country_count
RETURN f.sar_id AS filing_id, country_count
ORDER BY country_count DESC
LIMIT 5","match
$f isa filing, has sar_id $sid;
$rel isa $t (filing: $f, $e);
{ $t label originator; } or { $t label benefits; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has code $cc;
select $f, $sid, $c;
distinct;
reduce $country_count = count($c) groupby $f, $sid;
sort $country_count desc;
limit 5;
fetch { ""filing_id"": $sid, ""country_count"": $country_count };"
511,Which 3 countries have the least number of filings ending in them?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count ASC
LIMIT 3
RETURN country, filings_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $country_name;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $filings_count = count($f) groupby $c, $country_name;
sort $filings_count asc;
limit 3;
fetch {
  ""country"": $country_name,
  ""filings_count"": $filings_count
};"
512,Identify the top 3 filings with the smallest amounts that were filed in 2015.,"MATCH (f:Filing)
WHERE f.begin_date_format CONTAINS ""2015"" OR f.end_date_format CONTAINS ""2015""
RETURN f
ORDER BY f.amount ASC
LIMIT 3","match
$f isa filing, has begin_date_format $bdf, has end_date_format $edf, has amount $a;
{ $bdf like "".*2015.*""; } or { $edf like "".*2015.*""; };
sort $a asc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a,
  ""begin_date_format"": $bdf,
  ""end_date_format"": $edf
};"
513,List the first 3 entities based in 'United Kingdom' that have filed something concerning a beneficiary in 'United States'.,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
MATCH (e)-[:FILED]->(f:Filing)-[:CONCERNS]->(b:Entity)-[:COUNTRY]->(bc:Country {name: 'United States'})
RETURN e.name AS EntityName
LIMIT 3","match
$e isa fincen_entity, has name $en;
$c1 isa country, has name ""United Kingdom"";
entity_country (fincen_entity: $e, country: $c1);
$f isa filing;
filed (filer: $e, filing: $f);
$b isa fincen_entity;
concerns (filing: $f, concerned_entity: $b);
$c2 isa country, has name ""United States"";
entity_country (fincen_entity: $b, country: $c2);
limit 3;
fetch { ""EntityName"": $en };"
514,What are the top 5 filings concerning entities that are located at a latitude higher than 40 degrees?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE e.location.latitude > 40
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has origin_lat $lat, has amount $amt;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
$lat like ""^(4[1-9]|[5-9][0-9]|[1-9][0-9]{2,}).*"";
sort $amt desc;
limit 5;
fetch {
  ""filing"": $f
};"
515,Which 3 entities have the most filings where they are both the originator and the beneficiary?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(e)
MATCH (f)-[:BENEFITS]->(e)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity, has name $name;
$f isa filing;
filed (filer: $e, filing: $f);
originator (originating_entity: $e, filing: $f);
benefits (beneficiary: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 3;
fetch { ""entity_name"": $name, ""num_filings"": $count };"
516,List the first 3 countries that have entities which have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) AS filingsCount
WHERE filingsCount > 10
MATCH (e)-[:COUNTRY]->(c:Country)
RETURN c.name AS country, filingsCount
ORDER BY filingsCount DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
entity_country (fincen_entity: $e, country: $c);
reduce $filingsCount = count($f) groupby $e, $c;
match $filingsCount > 10;
sort $filingsCount desc;
limit 3;
fetch { ""country"": $c.name, ""filingsCount"": $filingsCount };"
517,Identify the top 5 countries by the total amount of filings originating from them.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 5
RETURN country, totalAmount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name $cn;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c, $cn;
sort $total desc;
limit 5;
fetch { ""country"": $cn, ""totalAmount"": $total };"
518,Which filings involve an entity with the id 'the-bank-of-new-york-mellon-corp' as both originator and beneficiary?,"MATCH (e:Entity {id: 'the-bank-of-new-york-mellon-corp'})-[:FILED]->(f:Filing)
WHERE (f)-[:ORIGINATOR]->(e) AND (f)-[:BENEFITS]->(e)
RETURN f","match
$e isa fincen_entity, has entity_id ""the-bank-of-new-york-mellon-corp"";
$f isa filing;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
fetch {
  ""filing_id"": $f.filing_id
};"
519,Which 3 countries are most frequently listed as the beneficiary bank country in filings?,"MATCH (f:Filing)
WITH f.beneficiary_bank_country AS country, COUNT(f) AS filings_count
RETURN country
ORDER BY filings_count DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country $country;
reduce $count = count($f) groupby $country;
sort $count desc;
limit 3;
fetch {
  ""country"": $country,
  ""filings_count"": $count
};"
520,What are the top 5 filings with the largest amounts where the originator bank country is 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has originator_bank_country ""United Kingdom"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing_id"": $f.filing_id,
  ""amount"": $a
};"
521,"Which filings have an end date in 'Sep 25, 2015'?","MATCH (f:Filing)
WHERE f.end_date = 'Sep 25, 2015'
RETURN f","match
$f isa filing, has end_date ""Sep 25, 2015"";
fetch {
  ""filing"": { $f.* }
};"
522,List the filings that have an originator bank country as 'Singapore' and an amount over 1000000.,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.amount > 1000000
RETURN f","match
$f isa filing, has originator_bank_country ""Singapore"", has amount $a;
$a > 1000000;
fetch {
  ""filing_id"": $f.filing_id,
  ""originator_bank_country"": $f.originator_bank_country,
  ""amount"": $f.amount
};"
523,What are the entities that have both originated and been a beneficiary in filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)-[:BENEFITS]->(e)
RETURN DISTINCT e.name AS entityName, e.id AS entityId","match
$e isa fincen_entity;
originator (originating_entity: $e, filing: $f);
benefits (beneficiary: $e, filing: $f);
select $e;
distinct;
fetch {
  ""entityName"": $e.name,
  ""entityId"": $e.entity_id
};"
524,Which country hosts the most entities that are originators in filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(:Filing)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(e) AS entity_count
RETURN country
ORDER BY entity_count DESC
LIMIT 1","match
$e isa fincen_entity;
$f isa filing;
originator (originating_entity: $e, filing: $f);
$c isa country, has name $cn;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $c, $cn;
sort $count desc;
limit 1;
fetch { ""country"": $cn };"
525,List the top 5 filings by the number of concerned entities.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(e) AS concernedEntitiesCount
ORDER BY concernedEntitiesCount DESC
LIMIT 5
RETURN f.sar_id AS FilingID, concernedEntitiesCount","match
$f isa filing;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch {
  ""FilingID"": $f.sar_id,
  ""concernedEntitiesCount"": $count
};"
526,How many entities are there in 'United Kingdom'?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN count(e) AS numberOfEntities","match
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e);"
527,Which filings have a beneficiary bank with an ISO code of 'GBR' and an amount greater than 250000?,"MATCH (f:Filing)
WHERE f.beneficiary_iso = 'GBR' AND f.amount > 250000
RETURN f","match
$f isa filing, has beneficiary_iso ""GBR"", has amount $a;
$a > 250000;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""beneficiary_iso"": $f.beneficiary_iso,
    ""amount"": $a
  }
};"
528,What is the total amount filed by entities in 'China'?,"MATCH (c:Country {name: 'China'})<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
RETURN SUM(f.amount) AS total_amount","match
$c isa country, has name ""China"";
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
$f has amount $a;
reduce $total = sum($a);"
529,List the 3 oldest filings based on the begin date.,"MATCH (f:Filing)
WITH f
ORDER BY f.begin ASC
LIMIT 3
RETURN f","match
$f isa filing, has period_begin $b;
sort $b asc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""begin_date"": $b,
  ""end_date"": $f.end_date,
  ""amount"": $f.amount
};"
530,List the 3 most recent filings involving 'Barclays Bank Plc' as the beneficiary bank.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
RETURN f
ORDER BY f.end DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has period_end $pe;
sort $pe desc;
limit 3;
fetch {
  ""filing_id"": $f.filing_id,
  ""period_end"": $f.period_end,
  ""beneficiary_bank"": $f.beneficiary_bank,
  ""amount"": $f.amount,
  ""number"": $f.number
};"
531,What are the filings where the amount is the minimum in the database?,"// First, find the minimum amount in the database
MATCH (f:Filing)
WITH min(f.amount) AS minAmount

// Then, find the filings with that minimum amount
MATCH (f:Filing {amount: minAmount})
RETURN f","match
$f isa filing, has amount $a;
reduce $min_amount = min($a);
match
$f2 isa filing, has amount $a2;
$a2 == $min_amount;
fetch { ""filing_id"": $f2.filing_id, ""amount"": $a2 };"
532,How many countries have at least one entity that has filed a filing?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(:Filing)
RETURN count(DISTINCT c) AS numberOfCountries","match
$c isa country;
entity_country (country: $c, fincen_entity: $e);
filed (filer: $e, filing: $f);
select $c;
distinct;
reduce $count = count;"
533,List the top 5 entities by the number of filings they have filed.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) as filings_count
ORDER BY filings_count DESC
LIMIT 5
RETURN e.name as entity_name, filings_count","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 5;
fetch { ""entity_name"": $e.name, ""filings_count"": $count };"
534,Which country's entities have filed the most filings with an amount over 1000000?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount > 1000000
RETURN c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 1","match
$c isa country;
$e isa fincen_entity;
$f isa filing, has amount $a;
$a > 1000000;
entity_country (fincen_entity: $e, country: $c);
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $c;
sort $count desc;
limit 1;
fetch {
  ""country"": $c.name,
  ""filings_count"": $count
};"
535,Find all filings where the beneficiary bank country is 'United States'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United States'
RETURN f","match
$f isa filing, has beneficiary_bank_country ""United States"";
fetch {
  ""filing_id"": $f.filing_id
};"
536,What are the entities that have filed the most filings with a begin date in 2015?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format STARTS WITH ""2015""
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 1
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has begin_date_format $bdf;
$bdf like ""^2015.*"";
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
sort $num_filings desc;
limit 1;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
537,How many filings have a beneficiary bank in 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN count(f) AS number_of_filings","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
reduce $count = count($f);"
538,List the filings with the highest number of originators.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, COUNT(e) AS originator_count
ORDER BY originator_count DESC
RETURN f, originator_count
LIMIT 1","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 1;
fetch { ""filing_id"": $f.filing_id, ""originator_count"": $count };"
539,Which entities are concerned in filings with an amount greater than 750000?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 750000
RETURN e.name AS concerned_entity, f.amount AS filing_amount","match
$f isa filing, has amount $a;
$a > 750000;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
fetch {
  ""concerned_entity"": $e.name,
  ""filing_amount"": $a
};"
540,List entities that have filed more than 20 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings
WHERE num_filings > 20
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
match $num_filings > 20;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
541,Which entities are originators in the filings involving the highest amounts?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, e
ORDER BY f.amount DESC
LIMIT 1
RETURN e.name AS OriginatorEntity, f.amount AS Amount","match
$f isa filing, has amount $a;
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
sort $a desc;
limit 1;
fetch {
  ""OriginatorEntity"": $e.name,
  ""Amount"": $a
};"
543,Which entities have been concerned by filings with an amount over 1500000?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1500000
RETURN e.name AS concerned_entity, e.id AS entity_id","match
$f isa filing, has amount $a;
$a > 1500000;
$e isa fincen_entity, has name $n, has entity_id $eid;
concerns (filing: $f, concerned_entity: $e);
fetch {
  ""concerned_entity"": $n,
  ""entity_id"": $eid
};"
544,List the filings where the beneficiary ISO is 'GBR'.,"MATCH (f:Filing)
WHERE f.beneficiary_iso = 'GBR'
RETURN f","match
$f isa filing, has beneficiary_iso ""GBR"";
fetch {
  ""f"": { $f.* }
};"
545,List the three entities with the most filings where the originator and beneficiary banks are the same.,"MATCH (f:Filing)
WHERE f.originator_bank_id = f.beneficiary_bank_id
WITH f.filer_org_name_id AS entity_id, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
MATCH (e:Entity {id: entity_id})
RETURN e.name AS entity_name, filing_count","match
$f isa filing, has originator_bank_id $ob, has beneficiary_bank_id $bb;
$ob == $bb;
$e isa fincen_entity, has name $n;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;
fetch { ""entity_name"": $n, ""filing_count"": $count };"
546,How many filings were made by 'The Bank of New York Mellon Corp.'?,"MATCH (e:Entity {name: 'The Bank of New York Mellon Corp.'})-[:FILED]->(f:Filing)
RETURN count(f) AS number_of_filings","match
$e isa fincen_entity, has name ""The Bank of New York Mellon Corp."";
filed (filer: $e, filing: $f);
reduce $count = count($f);"
547,What are the top 3 filings by amount?,"MATCH (f:Filing)
RETURN f.sar_id, f.amount
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
sort $a desc;
limit 3;
fetch {
  ""sar_id"": $f.sar_id,
  ""amount"": $a
};"
548,List the 3 countries with the lowest number of filings.,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)-[:FILED]->(f:Filing)
WITH c.name AS country, COUNT(f) AS filings_count
ORDER BY filings_count ASC
LIMIT 3
RETURN country, filings_count","match
$c isa country;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$f isa filing;
filed (filer: $e, filing: $f);
reduce $filings_count = count($f) groupby $c;
sort $filings_count asc;
limit 3;
fetch {
  ""country"": $c.name,
  ""filings_count"": $filings_count
};"
549,Which entity has filed the most filings with the originator country as 'United Kingdom'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country = 'United Kingdom'
RETURN e.name AS entity, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 1","match
$e isa fincen_entity, has name $name;
$f isa filing, has originator_bank_country ""United Kingdom"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $name;
sort $count desc;
limit 1;"
551,What are the most common beneficiary bank countries in the filings?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS beneficiary_country, count(f) AS filings_count
RETURN beneficiary_country, filings_count
ORDER BY filings_count DESC
LIMIT 10","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
reduce $filings_count = count($f) groupby $c, $cn;
sort $filings_count desc;
limit 10;
fetch {
  ""beneficiary_country"": $cn,
  ""filings_count"": $filings_count
};"
552,How many entities are there in each country?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(e) AS entity_count
ORDER BY entity_count DESC","match
$e isa fincen_entity;
$c isa country;
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($e) groupby $c;
sort $count desc;
fetch { ""country"": $c.name, ""entity_count"": $count };"
553,Which filings have an originator ISO of 'SGP'?,"MATCH (f:Filing)
WHERE f.originator_iso = 'SGP'
RETURN f","match
$f isa filing, has originator_iso ""SGP"";
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_iso"": $f.originator_iso,
    ""originator_bank"": $f.originator_bank,
    ""originator_bank_id"": $f.originator_bank_id,
    ""originator_bank_country"": $f.originator_bank_country,
    ""beneficiary_bank"": $f.beneficiary_bank,
    ""beneficiary_bank_id"": $f.beneficiary_bank_id,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country,
    ""beneficiary_iso"": $f.beneficiary_iso,
    ""amount"": $f.amount,
    ""number"": $f.number,
    ""sar_id"": $f.sar_id,
    ""filer_org_name"": $f.filer_org_name,
    ""filer_org_name_id"": $f.filer_org_name_id
  }
};"
554,What are the top 3 countries by the average amount of filings?,"MATCH (f:Filing)-[:BENEFITS|:CONCERNS|:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, f.amount AS amount
RETURN country, AVG(amount) AS average_amount
ORDER BY average_amount DESC
LIMIT 3","match
$f isa filing, has amount $amt;
$rel isa $t (filing: $f, $e);
{ $t label benefits; } or { $t label concerns; } or { $t label originator; };
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
$c has name $country;
reduce $avg = mean($amt) groupby $c, $country;
sort $avg desc;
limit 3;
fetch { ""country"": $country, ""average_amount"": $avg };"
555,List all entities that have filed more than 10 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, count(f) as filingCount
WHERE filingCount > 10
RETURN e.name as EntityName, filingCount","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
match $count > 10;
$e has name $n;
fetch { ""EntityName"": $n, ""filingCount"": $count };"
556,What are the top 5 largest amounts filed by 'Barclays Bank Plc' as the beneficiary bank?,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc'
RETURN f.amount, f.sar_id
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has amount $a, has sar_id $s;
sort $a desc;
limit 5;
fetch {
  ""amount"": $a,
  ""sar_id"": $s
};"
557,Which filings involve a beneficiary bank and originator bank from the same country?,"MATCH (f:Filing)
WHERE f.originator_bank_country = f.beneficiary_bank_country
RETURN f","match
$f isa filing, has originator_bank_country $obc, has beneficiary_bank_country $bbc;
$obc == $bbc;
fetch {
  ""filing"": $f.filing_id
};"
558,List the top 5 filings based on the number of entities concerned.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WITH f, COUNT(e) AS entityCount
ORDER BY entityCount DESC
LIMIT 5
RETURN f.sar_id AS FilingID, entityCount","match
$f isa filing;
concerns (filing: $f, concerned_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch { ""FilingID"": $f.sar_id, ""entityCount"": $count };"
559,How many filings have a beneficiary bank in 'United Kingdom' and an amount greater than 200000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 200000
RETURN count(f) AS number_of_filings","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$a > 200000;
reduce $count = count($f);"
560,Which entities act as originators in the most number of filings?,"MATCH (e:Entity)-[:ORIGINATOR]->(f:Filing)
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 1
RETURN e.name AS originator_entity, num_filings","match
$e isa fincen_entity;
originator (originating_entity: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 1;
fetch {
  ""originator_entity"": $e.name,
  ""num_filings"": $count
};"
561,List the filings where the originator bank is 'CIMB Bank Berhad' and the amount is over 500000.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad' AND f.amount > 500000
RETURN f","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a;
$a > 500000;
originator (filing: $f, originating_entity: $e);
$e isa fincen_entity;
fetch {
  ""filing_id"": $f.filing_id,
  ""originator_bank"": $f.originator_bank,
  ""amount"": $a
};"
562,How many entities have filed filings where the amount was under 10000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.amount < 10000
RETURN COUNT(DISTINCT e) AS numberOfEntities","match
$e isa fincen_entity;
$f isa filing, has amount $a;
$a < 10000;
filed (filer: $e, filing: $f);
reduce $count = count($e);"
563,What are the top 3 beneficiary ISO codes in the filings?,"MATCH (f:Filing)
WITH f.beneficiary_iso AS iso_code, COUNT(f) AS count
RETURN iso_code
ORDER BY count DESC
LIMIT 3","match
$f isa filing, has beneficiary_iso $iso;
reduce $count = count($f) groupby $iso;
sort $count desc;
limit 3;
fetch {
  ""beneficiary_iso"": $iso,
  ""count"": $count
};"
564,Which entity has benefited from the highest amount in a single filing?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS entity_name, f.amount AS amount
ORDER BY f.amount DESC
LIMIT 1","match
$f isa filing, has amount $a;
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
sort $a desc;
limit 1;
fetch {
  ""entity_name"": $n,
  ""amount"": $a
};"
565,Which filings concern entities with a location in 'CHN'?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country {code: 'CHN'})
RETURN f","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has code ""CHN"";
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""filing_id"": $f.filing_id
};"
567,What is the average number of filings per originator bank?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, COUNT(f) AS filings_count
RETURN originator_bank, AVG(filings_count) AS average_filings_per_originator","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
$e has name $n;
reduce $count = count($f) groupby $e;
reduce $avg = mean($count);"
568,Which filings concern entities located at a latitude greater than 50?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.location.latitude > 50
RETURN f","match
$f isa filing, has origin_lat $lat;
$e isa fincen_entity;
concerns (filing: $f, concerned_entity: $e);
$c isa country;
entity_country (fincen_entity: $e, country: $c);
$lat > ""50"";
fetch {
  ""filing"": $f.filing_id
};"
569,How many filings are there with an originator bank from 'Singapore' and a beneficiary bank from 'United Kingdom'?,"MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN count(f) AS number_of_filings","match
$f isa filing,
  has originator_bank_country ""Singapore"",
  has beneficiary_bank_country ""United Kingdom"";
reduce $count = count($f);"
570,Which entities have filings that originated from Singapore?,"MATCH (e:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(o:Entity)-[:COUNTRY]->(c:Country {name: ""Singapore""})
RETURN DISTINCT e.name AS EntityName","match
$e isa fincen_entity, has name $n;
$f isa filing;
$o isa fincen_entity;
$c isa country, has name ""Singapore"";
filed (filer: $e, filing: $f);
originator (filing: $f, originating_entity: $o);
entity_country (fincen_entity: $o, country: $c);
select $n;
distinct;
fetch { ""EntityName"": $n };"
571,List the top 5 countries by the number of entities associated via the FILED relationship.,"MATCH (e:Entity)-[:FILED]->(:Filing)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(DISTINCT e.id) AS entity_count
RETURN country, entity_count
ORDER BY entity_count DESC
LIMIT 5","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
$c isa country, has name $country_name;
entity_country (fincen_entity: $e, country: $c);
select $e, $c;
distinct;
reduce $entity_count = count($e) groupby $c;
sort $entity_count desc;
limit 5;
fetch {
  ""country"": $c.name,
  ""entity_count"": $entity_count
};"
572,What are the three entities that benefitted the most in terms of the amount from filings?,"MATCH (e:Entity)<-[:BENEFITS]-(f:Filing)
RETURN e.name AS entity, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 3","match
$e isa fincen_entity;
$f isa filing, has amount $a;
benefits (beneficiary: $e, filing: $f);
reduce $total = sum($a) groupby $e;
sort $total desc;
limit 3;
fetch {
  ""entity"": $e.name,
  ""total_amount"": $total
};"
573,Find the first 3 countries connected to entities that have a filing with a beneficiary bank in the United Kingdom.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE f.beneficiary_bank_country = ""United Kingdom""
RETURN DISTINCT c.name
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $name;
select $name;
distinct;
limit 3;
fetch {
  ""name"": $name
};"
574,Who are the originators in filings where the beneficiary bank country is 'United Kingdom' and the amount is over 1000000?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom' AND f.amount > 1000000
RETURN e.name AS originator_name","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
$a > 1000000;
originator (filing: $f, originating_entity: $e);
$e has name $n;
fetch {
  ""originator_name"": $n
};"
575,List the top 5 filings by amount where the originator bank is 'CIMB Bank Berhad'.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.originator_bank = 'CIMB Bank Berhad'
RETURN f
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has originator_bank ""CIMB Bank Berhad"", has amount $a;
sort $a desc;
limit 5;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""originator_bank"": $f.originator_bank
  }
};"
576,List the three entities with the most filings during 2015.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin >= datetime(""2015-01-01T00:00:00Z"") AND f.end <= datetime(""2015-12-31T23:59:59Z"")
WITH e, count(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3
RETURN e.name AS entity_name, filing_count","match
$e isa fincen_entity;
$f isa filing, has period_begin $pb, has period_end $pe;
filed (filer: $e, filing: $f);
$pb >= 2015-01-01T00:00:00;
$pe <= 2015-12-31T23:59:59;
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""filing_count"": $count
};"
578,Which countries have entities that are both originators and beneficiaries in filings with an amount over 1000000?,"MATCH (originator:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(originator)
MATCH (beneficiary:Entity)-[:FILED]->(f)-[:BENEFITS]->(beneficiary)
WHERE f.amount > 1000000
MATCH (originator)-[:COUNTRY]->(country:Country)
MATCH (beneficiary)-[:COUNTRY]->(country)
RETURN DISTINCT country.name AS Country","match
$f isa filing, has amount $a;
$a > 1000000;
originator (filing: $f, originating_entity: $e);
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $cn;
select $cn;
distinct;
fetch { ""Country"": $cn };"
579,Find the three countries with the most originator banks in the filings.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(DISTINCT e.id) AS originator_count
ORDER BY originator_count DESC
LIMIT 3
RETURN country, originator_count","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name $country_name;
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
select $e, $c, $country_name;
distinct;
reduce $originator_count = count($e) groupby $c, $country_name;
sort $originator_count desc;
limit 3;
fetch { ""country"": $country_name, ""originator_count"": $originator_count };"
580,List the first 3 countries where the beneficiary bank of the filing is located.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
RETURN DISTINCT c.name
ORDER BY c.name
LIMIT 3","match
$f isa filing;
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
select $n;
distinct;
sort $n asc;
limit 3;
fetch { ""name"": $n };"
581,What are the top 5 countries by the total amount of filings concerning their entities?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)-[:COUNTRY]->(c:Country)
WITH c.name AS country, SUM(f.amount) AS totalAmount
RETURN country, totalAmount
ORDER BY totalAmount DESC
LIMIT 5","match
$f isa filing, has amount $a;
concerns (filing: $f, concerned_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $total = sum($a) groupby $c;
sort $total desc;
limit 5;
fetch { ""country"": $c.name, ""total_amount"": $total };"
582,Identify the top 3 filings with the largest number of transactions.,"MATCH (f:Filing)
RETURN f.sar_id, f.number
ORDER BY f.number DESC
LIMIT 3","match
$f isa filing, has number $n;
sort $n desc;
limit 3;
fetch {
  ""sar_id"": $f.sar_id,
  ""number"": $n
};"
583,Who are the beneficiaries in the top 5 largest filings by amount?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
RETURN e.name AS beneficiary, f.amount AS amount
ORDER BY f.amount DESC
LIMIT 5","match
$f isa filing, has amount $a;
$e isa fincen_entity, has name $n;
benefits (filing: $f, beneficiary: $e);
sort $a desc;
limit 5;
fetch {
  ""beneficiary"": $n,
  ""amount"": $a
};"
584,Find the top 3 entities that have the most filings where the originator bank country is 'Singapore'.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country = 'Singapore'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has originator_bank_country ""Singapore"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch {
  ""entity_name"": $e.name,
  ""num_filings"": $count
};"
585,Which are the three entities with filings originating from banks in 'Singapore' and concerned with banks in 'United Kingdom'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.beneficiary_bank_country = 'United Kingdom'
RETURN e.name AS entity_name, COUNT(f) AS filing_count
ORDER BY filing_count DESC
LIMIT 3","match
$e isa fincen_entity, has name $n;
$f isa filing, has originator_bank_country ""Singapore"", has beneficiary_bank_country ""United Kingdom"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e, $n;
sort $count desc;
limit 3;"
586,List the top 5 countries based on the total number of entities that have filed something.,"MATCH (e:Entity)-[:FILED]->(:Filing)-[:ORIGINATOR]->(e)
MATCH (e)-[:COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(DISTINCT e.id) AS entity_count
RETURN country, entity_count
ORDER BY entity_count DESC
LIMIT 5","match
  $e isa fincen_entity;
  filed (filer: $e, filing: $f);
  entity_country (fincen_entity: $e, country: $c);
  $c has name $country_name;
reduce $entity_count = count($e) groupby $c;
sort $entity_count desc;
limit 5;
fetch {
  ""country"": $c.name,
  ""entity_count"": $entity_count
};"
587,Which country has the least number of entities that are originators?,"MATCH (e:Entity)-[:COUNTRY]->(c:Country)
MATCH (f:Filing)-[:ORIGINATOR]->(e)
WITH c, COUNT(DISTINCT e) AS originator_count
RETURN c.name AS country, originator_count
ORDER BY originator_count ASC
LIMIT 1","match
$e isa fincen_entity;
$c isa country;
entity_country (fincen_entity: $e, country: $c);
originator (originating_entity: $e, filing: $f);
select $e, $c;
distinct;
reduce $count = count($e) groupby $c;
sort $count asc;
limit 1;
fetch {
  ""country"": $c.name,
  ""originator_count"": $count
};"
588,Which three entities have the most filings with a beneficiary bank located in 'United Kingdom'?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
WITH e, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 3
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
benefits (filing: $f, beneficiary: $e);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 3;
fetch { ""entity_name"": $e.name, ""num_filings"": $count };"
589,Which entities filed a report in March 2015 with an amount exceeding 500000?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.begin_date_format STARTS WITH ""2015-03"" AND f.amount > 500000
RETURN e.name AS EntityName, f.sar_id AS ReportID, f.amount AS Amount","match
$e isa fincen_entity, has name $name;
$f isa filing, has begin_date_format $bdf, has amount $amt, has sar_id $sid;
$bdf like ""^2015-03.*"";
$amt > 500000;
filed (filer: $e, filing: $f);
fetch {
  ""EntityName"": $name,
  ""ReportID"": $sid,
  ""Amount"": $amt
};"
590,What are the filings with a beneficiary bank from 'China' and an amount over 150000?,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country)
WHERE c.name = 'China' AND f.amount > 150000
RETURN f","match
$f isa filing, has amount $a;
$a > 150000;
$e isa fincen_entity;
$c isa country, has name ""China"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $f.amount
};"
591,List the top 3 filings by amount where the beneficiary bank is from 'China'.,"MATCH (f:Filing)-[:BENEFITS]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'China'})
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has amount $a;
$e isa fincen_entity;
$c isa country, has name ""China"";
benefits (filing: $f, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
sort $a desc;
limit 3;
fetch {
  ""filing"": $f.filing_id,
  ""amount"": $a
};"
592,Which filings have an originator and beneficiary bank from different countries?,"MATCH (f:Filing)
WHERE f.originator_iso <> f.beneficiary_iso
RETURN f","match
$f isa filing, has originator_iso $oi, has beneficiary_iso $bi;
$oi != $bi;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_iso"": $oi,
    ""beneficiary_iso"": $bi
  }
};"
593,List all entities that are concerned in filings where the amount is over 2000000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 2000000
RETURN e.name AS entity_name, e.id AS entity_id","match
$f isa filing, has amount $a;
$a > 2000000;
concerns (filing: $f, concerned_entity: $e);
$e isa fincen_entity;
fetch {
  ""entity_name"": $e.name,
  ""entity_id"": $e.entity_id
};"
594,What are the filings with a beneficiary bank from 'Singapore' and an amount over 300000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore' AND f.amount > 300000
RETURN f","match
$f isa filing, has beneficiary_bank_country ""Singapore"", has amount $a;
$a > 300000;
fetch {
  ""filing"": $f
};"
595,Which countries have entities that are both originators and beneficiaries in filings?,"MATCH (originator:Entity)-[:FILED]->(f:Filing)-[:ORIGINATOR]->(originator)
MATCH (beneficiary:Entity)<-[:BENEFITS]-(f)
WHERE originator.id = beneficiary.id
MATCH (originator)-[:COUNTRY]->(country:Country)
RETURN DISTINCT country.name AS country_name","match
$e isa fincen_entity;
originator (filing: $f1, originating_entity: $e);
benefits (filing: $f2, beneficiary: $e);
entity_country (fincen_entity: $e, country: $c);
$c has name $n;
select $n;
distinct;
fetch { ""country_name"": $n };"
596,How many filings are there with an originator bank from 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)-[:COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN count(f) AS number_of_filings","match
$f isa filing;
$e isa fincen_entity;
$c isa country, has name ""United Kingdom"";
originator (filing: $f, originating_entity: $e);
entity_country (fincen_entity: $e, country: $c);
reduce $count = count($f);"
597,List the top 3 filings by amount where the beneficiary bank is from 'United Kingdom'.,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN f
ORDER BY f.amount DESC
LIMIT 3","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"", has amount $a;
sort $a desc;
limit 3;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""amount"": $a,
    ""beneficiary_bank_country"": $f.beneficiary_bank_country
  }
};"
598,How many entities are there that have not been a beneficiary in any filings?,"MATCH (e:Entity)
WHERE NOT EXISTS {
  MATCH (e)<-[:BENEFITS]-(:Filing)
}
RETURN count(e) AS numberOfEntities","match
$e isa fincen_entity;
not { benefits (beneficiary: $e); };
reduce $count = count($e);"
599,What are the top 3 originator banks in terms of the total amount of filings they initiated?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH e.name AS originator_bank, SUM(f.amount) AS total_amount
ORDER BY total_amount DESC
LIMIT 3
RETURN originator_bank, total_amount","match
$f isa filing, has amount $a;
$e isa fincen_entity, has name $n;
originator (filing: $f, originating_entity: $e);
reduce $total = sum($a) groupby $e;
sort $total desc;
limit 3;
fetch {
  ""originator_bank"": $e.name,
  ""total_amount"": $total
};"
600,List all filings where the beneficiary bank is 'Barclays Bank Plc' and the amount is greater than 500000.,"MATCH (f:Filing)
WHERE f.beneficiary_bank = 'Barclays Bank Plc' AND f.amount > 500000
RETURN f","match
$f isa filing, has beneficiary_bank ""Barclays Bank Plc"", has amount $a;
$a > 500000;
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""beneficiary_bank"": $f.beneficiary_bank,
    ""amount"": $f.amount
  }
};"
601,List all entities that are concerned in filings where the amount is over 500000.,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 500000
RETURN e.name AS entity_name, e.id AS entity_id","match
$f isa filing, has amount $a;
$a > 500000;
$e isa fincen_entity, has name $en, has entity_id $eid;
concerns (filing: $f, concerned_entity: $e);
fetch {
  ""entity_name"": $en,
  ""entity_id"": $eid
};"
602,List the top 5 entities by the total amount they have been concerned in filings.,"MATCH (e:Entity)<-[:CONCERNS]-(f:Filing)
WITH e, SUM(f.amount) AS totalAmount
ORDER BY totalAmount DESC
LIMIT 5
RETURN e.name AS entityName, totalAmount","match
$e isa fincen_entity;
concerns (concerned_entity: $e, filing: $f);
$f has amount $a;
reduce $totalAmount = sum($a) groupby $e;
sort $totalAmount desc;
limit 5;
fetch {
  ""entityName"": $e.name,
  ""totalAmount"": $totalAmount
};"
603,How many filings have a beneficiary bank from 'United States' and an amount less than 500000?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'United States' AND f.amount < 500000
RETURN count(f) AS number_of_filings","match
$f isa filing, has beneficiary_bank_country ""United States"", has amount $a;
$a < 500000;
reduce $count = count($f);"
604,Which entities are originators in the most number of filings involving a beneficiary bank from 'United Kingdom'?,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WHERE f.beneficiary_bank_country = 'United Kingdom'
RETURN e.name AS originator, COUNT(f) AS num_filings
ORDER BY num_filings DESC
LIMIT 1","match
$f isa filing, has beneficiary_bank_country ""United Kingdom"";
$e isa fincen_entity;
originator (filing: $f, originating_entity: $e);
$e has name $name;
reduce $num_filings = count($f) groupby $e, $name;
sort $num_filings desc;
limit 1;
fetch {
  ""originator"": $name,
  ""num_filings"": $num_filings
};"
605,"List the filings where the originator bank country is 'Singapore' and the end_date is 'Sep 25, 2015'.","MATCH (f:Filing)
WHERE f.originator_bank_country = 'Singapore' AND f.end_date = 'Sep 25, 2015'
RETURN f","match
$f isa filing, has originator_bank_country ""Singapore"", has end_date ""Sep 25, 2015"";
fetch {
  ""filing"": {
    ""filing_id"": $f.filing_id,
    ""originator_bank_country"": $f.originator_bank_country,
    ""end_date"": $f.end_date
  }
};"
606,What are the entities that have filed the most filings with a beneficiary bank from 'United States'?,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WHERE f.beneficiary_bank_country = 'United States'
RETURN e.name AS entity, COUNT(f) AS filings_count
ORDER BY filings_count DESC
LIMIT 1","match
$e isa fincen_entity;
$f isa filing, has beneficiary_bank_country ""United States"";
filed (filer: $e, filing: $f);
reduce $count = count($f) groupby $e;
sort $count desc;
limit 1;
fetch {
  ""entity"": $e.name,
  ""filings_count"": $count
};"
607,How many filings have a beneficiary bank in 'Singapore'?,"MATCH (f:Filing)
WHERE f.beneficiary_bank_country = 'Singapore'
RETURN count(f) AS number_of_filings","match
$f isa filing, has beneficiary_bank_country ""Singapore"";
reduce $count = count($f);"
608,List the top 5 filings by the number of originators.,"MATCH (f:Filing)-[:ORIGINATOR]->(e:Entity)
WITH f, count(e) AS originator_count
ORDER BY originator_count DESC
LIMIT 5
RETURN f.sar_id AS filing_id, originator_count","match
$f isa filing;
originator (filing: $f, originating_entity: $e);
reduce $count = count($e) groupby $f;
sort $count desc;
limit 5;
fetch { ""filing_id"": $f.sar_id, ""originator_count"": $count };"
609,Which entities are concerned in filings with an amount greater than 1000000?,"MATCH (f:Filing)-[:CONCERNS]->(e:Entity)
WHERE f.amount > 1000000
RETURN e.name AS concerned_entity, f.amount AS filing_amount","match
$f isa filing, has amount $a;
$a > 1000000;
$e isa fincen_entity, has name $n;
concerns (filing: $f, concerned_entity: $e);
fetch {
  ""concerned_entity"": $n,
  ""filing_amount"": $a
};"
610,List entities that have filed more than 30 filings.,"MATCH (e:Entity)-[:FILED]->(f:Filing)
WITH e, COUNT(f) AS num_filings
WHERE num_filings > 30
RETURN e.name AS entity_name, num_filings","match
$e isa fincen_entity;
$f isa filing;
filed (filer: $e, filing: $f);
reduce $num_filings = count($f) groupby $e;
match $num_filings > 30;
fetch { ""entity_name"": $e.name, ""num_filings"": $num_filings };"
613,Which country has the least number of entities that are beneficiaries?,"MATCH (c:Country)<-[:COUNTRY]-(e:Entity)<-[:BENEFITS]-(f:Filing)
WITH c, COUNT(e) AS entityCount
RETURN c.name AS country, entityCount
ORDER BY entityCount ASC
LIMIT 1","match
$c isa country, has name $country_name;
$e isa fincen_entity;
entity_country (fincen_entity: $e, country: $c);
benefits (beneficiary: $e);
reduce $entity_count = count($e) groupby $c, $country_name;
sort $entity_count asc;
limit 1;
fetch { ""country"": $country_name, ""entityCount"": $entity_count };"
