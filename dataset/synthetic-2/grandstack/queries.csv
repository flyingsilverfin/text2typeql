original_index,question,cypher,typeql
0,What are the names of businesses located in Missoula?,"MATCH (b:Business)
WHERE b.city = 'Missoula'
RETURN b.name","match
$b isa business, has city ""Missoula"";
fetch {
  ""name"": $b.name
};"
1,How many businesses in 'San Mateo' have been reviewed in September of any year?,"MATCH (b:Business {city: 'San Mateo'})<-[:REVIEWS]-(r:Review)
WHERE r.date STARTS WITH '2015-09' OR r.date STARTS WITH '2016-09' OR r.date STARTS WITH '2017-09' OR r.date STARTS WITH '2018-09'
RETURN COUNT(DISTINCT b) AS numberOfBusinesses","match
$b isa business, has city ""San Mateo"";
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
{
  $d >= 2015-09-01T00:00:00; $d < 2015-10-01T00:00:00;
} or {
  $d >= 2016-09-01T00:00:00; $d < 2016-10-01T00:00:00;
} or {
  $d >= 2017-09-01T00:00:00; $d < 2017-10-01T00:00:00;
} or {
  $d >= 2018-09-01T00:00:00; $d < 2018-10-01T00:00:00;
};
select $b;
distinct;
reduce $count = count;"
2,Which user has the highest average star rating for their reviews and what businesses have they reviewed?,"// Step 1: Calculate the average star rating for each user
MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, avg(r.stars) AS avgStars
ORDER BY avgStars DESC
LIMIT 1

// Step 2: Find the businesses reviewed by the user with the highest average star rating
MATCH (u)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN u.name AS userName, avgStars, collect(b.name) AS reviewedBusinesses","match
$u isa user;
wrote (author: $u, review: $r);
$r has stars $s;
reduce $avg = mean($s) groupby $u;
sort $avg desc;
limit 1;
match
wrote (author: $u, review: $r2);
reviews (review: $r2, reviewed_business: $b);
fetch {
  ""userName"": $u.name,
  ""avgStars"": $avg,
  ""reviewedBusinesses"": [ $b.name ]
};"
3,"List the reviews, including text and stars, for businesses owned by 'Neo4j'.","MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)
RETURN r.text, r.stars","match
$b isa business, has name ""Neo4j"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""text"": $r.text,
  ""stars"": $r.stars
};"
4,Which businesses in 'Missoula' have received reviews with less than 4 stars?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula' AND r.stars < 4.0
RETURN b.name AS BusinessName, b.address AS Address, r.stars AS ReviewStars","match
$b isa business, has city ""Missoula"", has name $name, has address $addr;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
$s < 4.0;
fetch {
  ""BusinessName"": $name,
  ""Address"": $addr,
  ""ReviewStars"": $s
};"
5,What are the business names and categories for locations on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS businessName, c.name AS category","match
  $b isa business, has address $addr, has name $bname;
  $addr like "".*Broadway St.*"";
  $c isa category, has name $cname;
  in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bname,
  ""category"": $cname
};"
6,Identify all users who have reviewed businesses on 'E Front St' and the names of those businesses.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN u.name AS userName, b.name AS businessName","match
$u isa user;
$r isa review;
$b isa business, has address $addr;
$addr like "".*E Front St.*"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""userName"": $u.name,
  ""businessName"": $b.name
};"
7,Which categories include businesses that have been reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name AS Category","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$c has name $cat_name;
select $cat_name;
distinct;
fetch { ""Category"": $cat_name };"
8,List all businesses with a review dated before 2016 and their corresponding review text.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date < date('2016-01-01')
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business;
$r isa review, has date $d, has text $rt;
reviews (reviewed_business: $b, review: $r);
$d < 2016-01-01T00:00:00;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $rt
};"
9,How many different users have reviewed 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN COUNT(DISTINCT u.userId) AS numberOfUsers","match
$b isa business, has name ""KettleHouse Brewing Co."";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u isa user;
reduce $count = count($u);"
10,Which business located in 'Missoula' has the newest review?,"MATCH (b:Business {city: 'Missoula'})&lt;-[:REVIEWS]-(r:Review)
RETURN b.name, b.address, r.date
ORDER BY r.date DESC
LIMIT 1","match
$b isa business, has city ""Missoula"", has name $name, has address $addr;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
sort $d desc;
limit 1;
fetch {
  ""name"": $name,
  ""address"": $addr,
  ""date"": $d
};"
11,List the businesses that have received at least one review with a text mentioning 'great selection'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*great selection.*"";
reviews (review: $r, reviewed_business: $b);
$b has name $n;
select $n;
distinct;
fetch { ""name"": $n };"
12,What businesses are located at '200 W Pine St' and what categories are they in?,"MATCH (b:Business {address: '200 W Pine St'})-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address ""200 W Pine St"", has name $bn;
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
13,Identify businesses that have been reviewed by both 'Jenny' and 'Bob'.,"MATCH (jenny:User {name: 'Jenny'})-[:WROTE]->(review1:Review)-[:REVIEWS]->(business:Business),
      (bob:User {name: 'Bob'})-[:WROTE]->(review2:Review)-[:REVIEWS]->(business)
RETURN DISTINCT business.name","match
$jenny isa user, has name ""Jenny"";
$bob isa user, has name ""Bob"";
$r1 isa review;
$r2 isa review;
$b isa business, has name $bname;
wrote (author: $jenny, review: $r1);
reviews (review: $r1, reviewed_business: $b);
wrote (author: $bob, review: $r2);
reviews (review: $r2, reviewed_business: $b);
fetch {
  ""business_name"": $bname
};"
14,Which user has written the most reviews for businesses in 'Missoula'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH u, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN u.name AS userName, reviewCount","match
$u isa user;
$r isa review;
$b isa business, has city ""Missoula"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 1;
fetch {
  ""userName"": $u.name,
  ""reviewCount"": $count
};"
15,What are the addresses of businesses that have reviews with 4 stars or more and are located in 'Burlingame'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame' AND r.stars >= 4.0
RETURN b.address","match
$b isa business, has city ""Burlingame"";
$r isa review, has stars $s;
$s >= 4.0;
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
fetch {
  ""address"": $b.address
};"
16,List all categories associated with businesses in 'San Mateo'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN DISTINCT c.name AS category","match
$b isa business, has city ""San Mateo"";
$c isa category, has name $name;
in_category (business: $b, category: $c);
select $name;
distinct;
fetch { ""category"": $name };"
17,Which business has received the most reviews in 2018?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
WITH b, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2018-01-01T00:00:00;
$d <= 2018-12-31T23:59:59;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
18,What are the names of all users who have reviewed 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has name ""Neo4j"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
19,Find the top 3 highest-rated businesses in Missoula.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName, AVG(r.stars) AS averageRating
ORDER BY averageRating DESC
LIMIT 3","match
$b isa business, has city ""Missoula"", has name $name;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b, $name;
sort $avg desc;
limit 3;
fetch { ""businessName"": $name, ""averageRating"": $avg };"
20,How many users have written reviews for businesses located at '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN COUNT(DISTINCT u) AS numberOfUsers","match
$b isa business, has address ""301 E Main St"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
reduce $count = count($u);"
21,List the names and addresses of businesses in San Mateo that have 'Car Wash' in their category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo' AND c.name CONTAINS 'Car Wash'
RETURN b.name AS businessName, b.address AS businessAddress","match
  $b isa business, has city ""San Mateo"", has name $bn, has address $ba;
  $c isa category, has name $cn;
  $cn like "".*Car Wash.*"";
  in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba
};"
22,Identify the businesses that have been reviewed exactly three times and list the review dates.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount, COLLECT(r.date) AS reviewDates
WHERE reviewCount = 3
RETURN b.name AS businessName, reviewDates","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match $count == 3;
$r2 isa review;
reviews (reviewed_business: $b, review: $r2);
$r2 has date $d;
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $d
};"
23,What are the names of businesses in 'Burlingame' that are categorized as libraries?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame' AND c.name = 'Library'
RETURN b.name","match
$b isa business, has city ""Burlingame"", has name $n;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""name"": $n
};"
24,Which business has the oldest review and what is the text of that review?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r
ORDER BY r.date ASC
LIMIT 1
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has name $bn;
$r isa review, has date $d, has text $rt;
reviews (reviewed_business: $b, review: $r);
sort $d asc;
limit 1;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
25,List all businesses that have been reviewed by 'Will' and the corresponding categories of these businesses.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS BusinessName, c.name AS CategoryName","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$c has name $cat_name;
fetch {
  ""BusinessName"": $b.name,
  ""CategoryName"": $cat_name
};"
27,List the businesses in 'San Mateo' that have received reviews with exactly 4 stars.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo' AND r.stars = 4.0
RETURN b.name","match
$b isa business, has city ""San Mateo"", has name $n;
$r isa review, has stars 4.0;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $n
};"
28,What are the names of businesses in 'Missoula' with reviews dated on or after '2017-01-01'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula' AND r.date >= date('2017-01-01')
RETURN DISTINCT b.name","match
  $b isa business, has city ""Missoula"", has name $name;
  $r isa review, has date $d;
  $d >= 2017-01-01T00:00:00;
  reviews (review: $r, reviewed_business: $b);
  in_category (business: $b, category: $c);
select $name;
distinct;
fetch { ""name"": $name };"
29,Identify all businesses reviewed by 'Jenny' in '2016' and list the review stars and texts.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN b.name AS businessName, r.stars AS reviewStars, r.text AS reviewText","match
  $u isa user, has name ""Jenny"";
  wrote (author: $u, review: $r);
  $r isa review, has date $d, has stars $s, has text $t;
  $d >= 2016-01-01T00:00:00;
  $d <= 2016-12-31T23:59:59;
  reviews (review: $r, reviewed_business: $b);
  $b isa business, has name $bn;
fetch {
  ""businessName"": $bn,
  ""reviewStars"": $s,
  ""reviewText"": $t
};"
30,Which businesses on 'Broadway St' have been reviewed in 2017 and what are the reviewers' names?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE (b.address CONTAINS 'Broadway St') AND (r.date >= date('2017-01-01') AND r.date <= date('2017-12-31'))
RETURN b.name AS businessName, u.name AS reviewerName","match
$b isa business, has address $addr, has name $bname;
$addr like "".*Broadway St.*"";
$r isa review, has date $d;
$d >= 2017-01-01T00:00:00;
$d <= 2017-12-31T23:59:59;
reviews (review: $r, reviewed_business: $b);
$u isa user, has name $uname;
wrote (author: $u, review: $r);
fetch {
  ""businessName"": $bname,
  ""reviewerName"": $uname
};"
31,List the names of businesses in 'San Mateo' that are categorized as 'Car Wash' along with their reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
WHERE b.city = 'San Mateo'
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has city ""San Mateo"", has name $bn;
$c isa category, has name ""Car Wash"";
in_category (business: $b, category: $c);
$r isa review, has text $rt;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
32,What are the review texts for the highest rated business in 'Burlingame'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Burlingame'
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 1
MATCH (b)-[:REVIEWS]-(r:Review)
RETURN r.text","match
$b isa business, has city ""Burlingame"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 1;
match
$r2 isa review, has text $t;
reviews (reviewed_business: $b, review: $r2);
fetch { ""text"": $t };"
33,Find the top 3 businesses in 'MT' based on the number of reviews they have received.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'MT'
WITH b, count(r) as reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name as businessName, reviewCount","match
$b isa business, has state ""MT"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
34,Which businesses have been reviewed by users named 'Angie' and 'Will' and what are the review texts?,"MATCH (u1:User {name: 'Angie'})-[:WROTE]->(r1:Review)-[:REVIEWS]->(b:Business),
      (u2:User {name: 'Will'})-[:WROTE]->(r2:Review)-[:REVIEWS]->(b)
RETURN b.name AS businessName, r1.text AS angieReviewText, r2.text AS willReviewText","match
  $u1 isa user, has name ""Angie"";
  $u2 isa user, has name ""Will"";
  $r1 isa review, has text $angie_text;
  $r2 isa review, has text $will_text;
  $b isa business, has name $bname;
  wrote (author: $u1, review: $r1);
  reviews (review: $r1, reviewed_business: $b);
  wrote (author: $u2, review: $r2);
  reviews (review: $r2, reviewed_business: $b);
fetch {
  ""businessName"": $bname,
  ""angieReviewText"": $angie_text,
  ""willReviewText"": $will_text
};"
35,List all users who have reviewed 'Zootown Brew' and the text of their reviews.,"MATCH (b:Business {name: 'Zootown Brew'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name AS userName, r.text AS reviewText","match
  $b isa business, has name ""Zootown Brew"";
  reviews (reviewed_business: $b, review: $r);
  wrote (author: $u, review: $r);
fetch {
  ""userName"": $u.name,
  ""reviewText"": $r.text
};"
37,Which businesses in Burlingame have received a 5-star review?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.stars = 5.0
RETURN b.name AS BusinessName","match
  $b isa business, has city ""Burlingame"";
  $r isa review, has stars 5.0;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""BusinessName"": $b.name
};"
38,Identify businesses in 'Burlingame' with reviews mentioning 'love' and list the reviewers.,"MATCH (b:Business {city: 'Burlingame'})<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS 'love'
RETURN b.name AS BusinessName, u.name AS ReviewerName","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has text $t;
$t like "".*love.*"";
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u has name $un;
fetch {
  ""BusinessName"": $bn,
  ""ReviewerName"": $un
};"
39,List the names of users who have reviewed businesses in both 'Missoula' and 'San Mateo'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city IN ['Missoula', 'San Mateo']
WITH u, b.city AS city
ORDER BY u.name, city
WITH u.name AS userName, collect(DISTINCT city) AS cities
WHERE 'Missoula' IN cities AND 'San Mateo' IN cities
RETURN userName","match
$u isa user;
$r1 isa review;
$b1 isa business, has city ""Missoula"";
wrote (author: $u, review: $r1);
reviews (review: $r1, reviewed_business: $b1);
$r2 isa review;
$b2 isa business, has city ""San Mateo"";
wrote (author: $u, review: $r2);
reviews (review: $r2, reviewed_business: $b2);
fetch {
  ""name"": $u.name
};"
40,Find businesses that have been reviewed on 'Pine St' and list their categories and review dates.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.address CONTAINS 'Pine St'
RETURN b.name AS businessName, c.name AS categoryName, r.date AS reviewDate","match
$b isa business, has address $addr, has name $bn;
$addr like "".*Pine St.*"";
$c isa category, has name $cn;
$r isa review, has date $rd;
in_category (business: $b, category: $c);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn,
  ""reviewDate"": $rd
};"
41,Which businesses in 'Missoula' have received reviews only from 'Jenny'?,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User {name: 'Jenny'})
WITH b, collect(distinct u.name) as reviewers
WHERE size(reviewers) = 1 AND reviewers[0] = 'Jenny'
RETURN b.name as BusinessName","match
$b isa business, has city ""Missoula"", has name $bn;
$r1 isa review;
reviews (review: $r1, reviewed_business: $b);
wrote (author: $jenny, review: $r1);
$jenny isa user, has name ""Jenny"";
not {
  $r2 isa review;
  reviews (review: $r2, reviewed_business: $b);
  wrote (author: $other, review: $r2);
  $other isa user, has name $on;
  $on != ""Jenny"";
};
fetch { ""BusinessName"": $bn };"
42,List all businesses that have been reviewed on 'E Front St' and their review stars.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.address CONTAINS 'E Front St'
RETURN b.name AS businessName, r.stars AS reviewStars","match
$b isa business, has address $addr;
$addr like "".*E Front St.*"";
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewStars"": $s
};"
43,Which users have reviewed more than one business in 'San Mateo' and what are those businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'San Mateo'
WITH u, COUNT(DISTINCT b) AS businessCount, COLLECT(DISTINCT b.name) AS businesses
WHERE businessCount > 1
RETURN u.name AS userName, businesses","match
$u isa user;
$r isa review;
$b isa business, has city ""San Mateo"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
select $u, $b; distinct;
reduce $count = count($b) groupby $u;
match $count > 1;
$u isa user;
$r2 isa review;
$b2 isa business, has city ""San Mateo"";
wrote (author: $u, review: $r2);
reviews (review: $r2, reviewed_business: $b2);
fetch { ""userName"": $u.name, ""business"": $b2.name };"
44,What are the names of businesses on 'California Dr' and their corresponding categories?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address = '723 California Dr'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address ""723 California Dr"", has name $bn;
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
45,Identify the business with the most reviews in 'Burlingame' and list its reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.text AS reviewText, r.date AS reviewDate, r.stars AS reviewStars","match
  $b isa business, has city ""Burlingame"";
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
match
  $r2 isa review;
  reviews (review: $r2, reviewed_business: $b);
  $r2 has text $text, has date $date, has stars $stars;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $text,
  ""reviewDate"": $date,
  ""reviewStars"": $stars
};"
46,List the reviews with a star rating of 5 for businesses on 'Main St' and the name of the reviewers.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE r.stars = 5 AND b.address CONTAINS 'Main St'
RETURN r.text AS reviewText, u.name AS reviewerName","match
  $b isa business, has address $addr;
  $addr like "".*Main St.*"";
  $r isa review, has stars 5.0;
  reviews (review: $r, reviewed_business: $b);
  $u isa user;
  wrote (author: $u, review: $r);
fetch {
  ""reviewText"": $r.text,
  ""reviewerName"": $u.name
};"
47,Which businesses have a 'Library' category and are located in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE c.name = 'Library' AND b.state = 'CA'
RETURN b.name, b.address, b.city","match
$b isa business, has state ""CA"";
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city
};"
48,What are the top 3 most frequent categories of businesses in 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN c.name AS category, COUNT(b) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$b isa business, has city ""San Mateo"";
$c isa category, has name $cn;
in_category (business: $b, category: $c);
reduce $count = count($b) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""category"": $cn, ""frequency"": $count };"
49,Find businesses in 'Missoula' that have received exactly two reviews and list the names of the reviewers.,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, COUNT(r) AS reviewCount, COLLECT(u.name) AS reviewers
WHERE reviewCount = 2
RETURN b.name AS businessName, reviewers","with fun review_count($b: business) -> integer:
  match reviews (reviewed_business: $b, review: $r);
  return count;
match
$b isa business, has city ""Missoula"", has name $bn;
let $count = review_count($b);
$count == 2;
reviews (reviewed_business: $b, review: $r);
wrote (review: $r, author: $u);
$u has name $un;
fetch { ""businessName"": $bn, ""reviewerName"": $un };"
50,"What are the names, addresses, and categories of businesses that have been reviewed by 'Bob'?","MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, b.address AS address, c.name AS category","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""address"": $b.address,
  ""category"": $c.name
};"
51,What are the names of businesses in Missoula that are categorized as breweries?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND c.name = 'Brewing'
RETURN b.name","match
$b isa business, has city ""Missoula"", has name $name;
$c isa category, has name ""Brewing"";
in_category (business: $b, category: $c);
fetch {
  ""name"": $name
};"
52,Which businesses have been reviewed on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name AS businessName","match
$b isa business;
$r isa review, has date $d;
$d == 2018-09-10T00:00:00;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
53,What are the review texts for businesses on 'N San Mateo Dr'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'N San Mateo Dr'
RETURN r.text","match
  $b isa business, has address $addr;
  $addr like "".*N San Mateo Dr.*"";
  in_category (business: $b, category: $c);
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""text"": $r.text
};"
54,Which user has the lowest average review stars? Display top 3 users.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, avg(r.stars) AS avgStars
ORDER BY avgStars ASC
LIMIT 3
RETURN u.name AS userName, avgStars","match
$u isa user;
$r isa review, has stars $s;
wrote (author: $u, review: $r);
reduce $avg_stars = mean($s) groupby $u;
sort $avg_stars asc;
limit 3;
fetch {
  ""userName"": $u.name,
  ""avgStars"": $avg_stars
};"
55,What are the names of businesses that have been reviewed at least three times?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount >= 3
RETURN b.name","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match $count >= 3;
fetch { ""name"": $b.name };"
56,Which categories does the business 'Missoula Public Library' belong to?,"MATCH (b:Business {name: 'Missoula Public Library'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category","match
$b isa business, has name ""Missoula Public Library"";
in_category (business: $b, category: $c);
$c isa category;
fetch {
  ""category"": $c.name
};"
57,What is the average number of stars given by each user? Limit the results to top 5 users.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u.name AS userName, avg(r.stars) AS averageStars
RETURN userName, averageStars
ORDER BY averageStars DESC
LIMIT 5","match
$u isa user;
$r isa review, has stars $s;
wrote (author: $u, review: $r);
reduce $avg_stars = mean($s) groupby $u;
sort $avg_stars desc;
limit 5;
fetch {
  ""userName"": $u.name,
  ""averageStars"": $avg_stars
};"
58,List all reviews that have 5 stars and were written in 2018.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5.0 AND r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
RETURN r.reviewId, r.text, r.date, r.stars, u.name, b.name","match
$r isa review, has stars $s, has date $d, has review_id $rid, has text $t;
$s == 5.0;
$d >= 2018-01-01T00:00:00;
$d <= 2018-12-31T23:59:59;
$u isa user, has name $uname;
wrote (author: $u, review: $r);
$b isa business, has name $bname;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""reviewId"": $rid,
  ""text"": $t,
  ""date"": $d,
  ""stars"": $s,
  ""userName"": $uname,
  ""businessName"": $bname
};"
59,Which business has the highest average review rating? Limit the results to top 3 businesses.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN b.name AS businessName, avgRating","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 3;
fetch { ""businessName"": $b.name, ""avgRating"": $avg };"
60,What are the names of businesses that are reviewed by user 'Will'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""name"": $b.name
};"
61,Which business has the most reviews written in 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date < date('2018-01-01')
WITH b, count(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2017-01-01T00:00:00;
$d < 2018-01-01T00:00:00;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
62,What is the average star rating for businesses in the 'Car Wash' category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN avg(r.stars) AS average_star_rating","match
  $b isa business;
  $c isa category, has name ""Car Wash"";
  in_category (business: $b, category: $c);
  $r isa review, has stars $s;
  reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s);"
63,Which users have written more than one review? List their names and the number of reviews they've written.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN u.name AS userName, reviewCount","match
$u isa user;
wrote (author: $u, review: $r);
reduce $reviewCount = count($r) groupby $u;
match $reviewCount > 1;
fetch { ""userName"": $u.name, ""reviewCount"": $reviewCount };"
64,What are the addresses of 'Brewing Co.' businesses in Missoula?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND b.name CONTAINS 'Brewing Co.'
RETURN b.address","match
$b isa business, has city ""Missoula"", has name $n;
$n like "".*Brewing Co[.].*"";
in_category (business: $b, category: $c);
fetch {
  ""address"": $b.address
};"
65,What is the relationship between the business 'Hanabi' and its reviewers?,"MATCH (b:Business {name: 'Hanabi'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS business, u.name AS reviewer, r.text AS review_text, r.stars AS review_stars, r.date AS review_date","match
$b isa business, has name ""Hanabi"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""business"": $b.name,
  ""reviewer"": $u.name,
  ""review_text"": $r.text,
  ""review_stars"": $r.stars,
  ""review_date"": $r.date
};"
66,What are the businesses with the highest review stars in Burlingame?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
WITH b, MAX(r.stars) AS maxStars
MATCH (b)-[:REVIEWS]-(r:Review)
WHERE r.stars = maxStars
RETURN b.name AS businessName, maxStars
ORDER BY maxStars DESC","match
$b isa business, has city ""Burlingame"", has name $name;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $max_stars = max($s) groupby $name;
sort $max_stars desc;"
67,Which businesses are in the category 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name AS businessName","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name
};"
68,What are the recent three reviews for the business named 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.date DESC
LIMIT 3","match
$b isa business, has name ""Neo4j"";
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
sort $d desc;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
69,Which users have written reviews for businesses located on 'W Broadway St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'W Broadway St'
RETURN u.name","match
$u isa user;
$r isa review;
$b isa business, has address $a;
$a like "".*W Broadway St.*"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
70,How many reviews does each business in San Mateo have? Limit the results to top 3 businesses.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo'
WITH b, COUNT(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has city ""San Mateo"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
71,What are the names and addresses of businesses that have a rating of 4.0 or higher?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4.0
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business;
$r isa review, has stars $s;
$s >= 4.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
72,List the top 5 businesses in California based on the number of reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5
RETURN b.name AS businessName, reviewCount","match
$b isa business, has state ""CA"", has name $name;
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $name;
sort $count desc;
limit 5;
fetch {
  ""businessName"": $name,
  ""reviewCount"": $count
};"
73,Which businesses are located in Missoula?,"MATCH (b:Business)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName","match
$b isa business, has city ""Missoula"";
fetch {
  ""businessName"": $b.name
};"
74,List the top 3 recent reviews and the corresponding businesses that received them.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.date AS reviewDate, r.text AS reviewText, b.name AS businessName
ORDER BY r.date DESC
LIMIT 3","match
$r isa review, has date $d, has text $t;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $d desc;
limit 3;
fetch {
  ""reviewDate"": $d,
  ""reviewText"": $t,
  ""businessName"": $bn
};"
75,Identify the businesses with reviews on or after '2018-01-01' and their corresponding users.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE r.date >= date('2018-01-01')
RETURN b.name AS businessName, u.name AS userName","match
$b isa business;
$r isa review, has date $d;
$u isa user;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$d >= 2018-01-01T00:00:00;
fetch {
  ""businessName"": $b.name,
  ""userName"": $u.name
};"
76,Name the businesses with the highest number of reviews in 'Missoula'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewCount","match
$b isa business, has city ""Missoula"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
77,List the businesses that have reviews with text mentioning 'IPA selection'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA selection'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*IPA selection.*"";
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
78,How many businesses are there in each city? Display only for cities with at least two businesses.,"MATCH (b:Business)
WITH b.city AS city, COUNT(b) AS businessCount
WHERE businessCount >= 2
RETURN city, businessCount","match
$b isa business, has city $city;
reduce $count = count($b) groupby $city;
match
$count >= 2;
fetch {
  ""city"": $city,
  ""businessCount"": $count
};"
79,Identify businesses on '1st St W' with reviews mentioning 'selection' and list the review stars.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.address CONTAINS '1st St W' 
  AND r.text CONTAINS 'selection'
RETURN b.name AS businessName, r.stars AS reviewStars","match
  $b isa business, has address $addr, has name $bname;
  $addr like "".*1st St W.*"";
  $r isa review, has text $txt, has stars $rstars;
  $txt like "".*selection.*"";
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bname,
  ""reviewStars"": $rstars
};"
80,How many businesses are there in Missoula with a 5-star review?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula' AND r.stars = 5.0
RETURN COUNT(DISTINCT b) AS numberOfBusinesses","match
$b isa business, has city ""Missoula"";
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
select $b;
distinct;
reduce $count = count($b);"
81,Which category has the fewest businesses?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, COUNT(b) AS businessCount
RETURN c.name AS category, businessCount
ORDER BY businessCount ASC
LIMIT 1","match
$b isa business;
$c isa category, has name $name;
in_category (business: $b, category: $c);
reduce $count = count($b) groupby $c;
sort $count asc;
limit 1;
fetch {
  ""category"": $c.name,
  ""businessCount"": $count
};"
82,What are the cities with the highest number of reviews? Limit to top 3 cities.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH b.city AS city, COUNT(r) AS reviewCount
RETURN city, reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has city $city;
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $city;
sort $count desc;
limit 3;"
83,Which businesses have a user review that includes the word 'great'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great'
RETURN b.name AS businessName","match
$u isa user;
$r isa review, has text $t;
$t like "".*great.*"";
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
84,How many reviews mention 'breakfast'?,"MATCH (r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN count(r) AS numberOfReviews","match
$r isa review, has text $t;
$t like "".*breakfast.*"";
reduce $count = count($r);"
85,What are the names of users who have reviewed the 'Missoula Public Library'?,"MATCH (b:Business {name: 'Missoula Public Library'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has name ""Missoula Public Library"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
86,What are the names of businesses with a review text containing 'IPA'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*IPA.*"";
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
87,List the businesses that have been reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b.name AS businessName","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-09-01T00:00:00;
$d <= 2018-09-30T23:59:59;
fetch {
  ""businessName"": $b.name
};"
88,Which business has the newest review in 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'San Mateo'
RETURN b.name AS businessName, r.date AS reviewDate
ORDER BY r.date DESC
LIMIT 1","match
  $b isa business, has city ""San Mateo"", has name $bn;
  in_category (business: $b, category: $c);
  $r isa review, has date $rd;
  reviews (review: $r, reviewed_business: $b);
sort $rd desc;
limit 1;
fetch {
  ""businessName"": $bn,
  ""reviewDate"": $rd
};"
89,What is the average star rating of businesses in 'Missoula'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula'
RETURN avg(r.stars) AS average_star_rating","match
$b isa business, has city ""Missoula"";
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
reduce $avg = mean($s);"
90,How many reviews does the 'Neo4j' business have?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)
RETURN count(r) AS reviewCount","match
$b isa business, has name ""Neo4j"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r);"
91,What is the text of the most recent review for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})&lt;-[:REVIEWS]-(r:Review)
RETURN r.text
ORDER BY r.date DESC
LIMIT 1","match
$b isa business, has name ""KettleHouse Brewing Co."";
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
sort $d desc;
limit 1;
fetch {
  ""text"": $r.text
};"
92,What are the names and review dates of reviews written by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, r.date AS reviewDate","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $r.date
};"
93,Which businesses have been reviewed both by 'Jenny' and 'Bob'?,"MATCH (u1:User {name: 'Jenny'})-[:WROTE]->(r1:Review)-[:REVIEWS]->(b:Business),
      (u2:User {name: 'Bob'})-[:WROTE]->(r2:Review)-[:REVIEWS]->(b)
RETURN DISTINCT b.name AS BusinessName","match
$u1 isa user, has name ""Jenny"";
$u2 isa user, has name ""Bob"";
$r1 isa review;
$r2 isa review;
$b isa business;
wrote (author: $u1, review: $r1);
reviews (review: $r1, reviewed_business: $b);
wrote (author: $u2, review: $r2);
reviews (review: $r2, reviewed_business: $b);
fetch {
  ""BusinessName"": $b.name
};"
94,What is the text of the review with the lowest stars for the business named 'Market on Front'?,"MATCH (b:Business {name: 'Market on Front'})&lt;-[:REVIEWS]-(r:Review)
RETURN r.text
ORDER BY r.stars ASC
LIMIT 1","match
$b isa business, has name ""Market on Front"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
$r has stars $s;
sort $s asc;
limit 1;
fetch {
  ""text"": $r.text
};"
95,Which business located on 'E Front St' has the highest average star rating?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'E Front St'
WITH b, avg(r.stars) AS avgRating
RETURN b.name AS businessName, avgRating
ORDER BY avgRating DESC
LIMIT 1","match
$b isa business, has address $addr, has name $name;
$addr like "".*E Front St.*"";
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg
};"
96,How many reviews were written in the year 2016?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN count(r) AS numberOfReviews","match
$r isa review, has date $d;
$d >= 2016-01-01T00:00:00;
$d < 2017-01-01T00:00:00;
reduce $count = count($r);"
97,Which user has reviewed the most distinct businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, COUNT(DISTINCT b) AS distinctBusinesses
RETURN u.name AS userName, distinctBusinesses
ORDER BY distinctBusinesses DESC
LIMIT 1","match
$u isa user;
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
select $u, $b;
distinct;
reduce $count = count($b) groupby $u;
sort $count desc;
limit 1;
fetch {
  ""userName"": $u.name,
  ""distinctBusinesses"": $count
};"
98,What is the distribution of businesses by state?,"MATCH (b:Business)
RETURN b.state AS state, COUNT(b) AS business_count
ORDER BY state","match
$b isa business, has state $state;
reduce $business_count = count($b) groupby $state;
sort $state;"
99,Which businesses have reviews with a star rating below 4? List the top 3.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 4.0
RETURN b.name AS businessName, r.stars AS starRating
ORDER BY r.stars ASC
LIMIT 3","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
$s < 4.0;
sort $s asc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""starRating"": $s
};"
100,What is the name and address of the business with the oldest review date?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r
ORDER BY r.date ASC
LIMIT 1
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
sort $d asc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
101,How many categories are there for each business? Limit the results to businesses with more than one category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, COUNT(c) AS categoryCount
WHERE categoryCount > 1
RETURN b.name AS businessName, categoryCount","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
match $count > 1;
fetch { ""businessName"": $b.name, ""categoryCount"": $count };"
102,What are the names of businesses that have a review with exactly 4.5 stars?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 4.5
RETURN b.name","match
$b isa business;
$r isa review, has stars 4.5;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
103,Which users have never written a review?,"MATCH (u:User)
WHERE NOT (u)-[:WROTE]->(:Review)
RETURN u.name AS userName","match
$u isa user, has name $name;
not { wrote (author: $u); };
fetch {
  ""userName"": $name
};"
104,How many businesses are there in each category? Limit the results to top 5 categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c.name AS category, COUNT(b) AS businessCount
RETURN category, businessCount
ORDER BY businessCount DESC
LIMIT 5","match
$b isa business;
$c isa category, has name $category;
in_category (business: $b, category: $c);
reduce $count = count($b) groupby $category;
sort $count desc;
limit 5;
fetch {
  ""category"": $category,
  ""businessCount"": $count
};"
105,List the names of businesses in 'Burlingame' that have received a review from 'Angie' and the review dates.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name AS businessName, r.date AS reviewDate","match
$u isa user, has name ""Angie"";
$r isa review, has date $d;
$b isa business, has city ""Burlingame"", has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""reviewDate"": $d
};"
106,Which business in 'Missoula' has the most reviews from 'Will' and what are the review texts?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH b, count(r) AS reviewCount, collect(r.text) AS reviewTexts
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewTexts","match
$u isa user, has name ""Will"";
$b isa business, has city ""Missoula"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
match
wrote (author: $u2, review: $r2);
$u2 isa user, has name ""Will"";
reviews (review: $r2, reviewed_business: $b);
fetch { ""businessName"": $b.name, ""reviewTexts"": [ $r2.text ] };"
107,Find the top 5 businesses with reviews mentioning 'IPA' and the names of the reviewers.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE r.text CONTAINS 'IPA'
RETURN b.name AS BusinessName, u.name AS ReviewerName, r.text AS ReviewText
ORDER BY r.stars DESC
LIMIT 5","match
$b isa business, has name $bn;
$r isa review, has text $rt, has stars $rs;
$u isa user, has name $un;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$rt like "".*IPA.*"";
sort $rs desc;
limit 5;
fetch {
  ""BusinessName"": $bn,
  ""ReviewerName"": $un,
  ""ReviewText"": $rt
};"
108,List the top 5 reviews that mention 'breakfast' in their text.,"MATCH (r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN r
ORDER BY r.stars DESC
LIMIT 5","match
$r isa review, has text $t, has stars $s;
$t like "".*breakfast.*"";
sort $s desc;
limit 5;
fetch {
  ""text"": $r.text,
  ""stars"": $s,
  ""review_id"": $r.review_id
};"
109,Identify the first 3 businesses that have been reviewed by the user named 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name, b.address, b.city, b.state, b.businessId
ORDER BY r.date
LIMIT 3","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$r has date $d;
sort $d;
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
110,List the business names and review texts for the top 3 highest-rated reviews in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame'
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS rating
ORDER BY r.stars DESC
LIMIT 3","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has stars $s, has text $rt;
reviews (review: $r, reviewed_business: $b);
sort $s desc;
limit 3;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt,
  ""rating"": $s
};"
111,Which reviews have a star rating exactly 3.0 and mention 'wifi'?,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 3.0 AND r.text CONTAINS 'wifi'
RETURN r.reviewId, r.text, r.stars, b.name","match
$r isa review, has review_id $rid, has text $t, has stars $s;
$b isa business, has name $bname;
reviews (review: $r, reviewed_business: $b);
$s == 3.0;
$t like "".*wifi.*"";
fetch {
  ""review_id"": $rid,
  ""text"": $t,
  ""stars"": $s,
  ""business_name"": $bname
};"
112,What are the business names and addresses for businesses that have received a review on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name AS businessName, b.address AS businessAddress","match
  $b isa business, has name $name, has address $addr;
  $r isa review, has date $d;
  $d == 2018-09-10T00:00:00;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $name,
  ""businessAddress"": $addr
};"
113,List the first 5 categories that have been associated with more than three businesses.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, count(b) as businessCount
WHERE businessCount > 3
RETURN c.name AS categoryName
LIMIT 5","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($b) groupby $c;
match
$count > 3;
limit 5;
fetch {
  ""categoryName"": $c.name
};"
114,Which users have written more than one review?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN u.name AS userName, reviewCount","match
$u isa user;
$r isa review;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
match $count > 1;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
115,Which business located in 'Missoula' has the highest rating based on reviews?,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review)
RETURN b.name, AVG(r.stars) AS averageRating
ORDER BY averageRating DESC
LIMIT 1","match
$b isa business, has city ""Missoula"";
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 1;
fetch {
  ""name"": $b.name,
  ""averageRating"": $avg
};"
116,List all the reviews with a text containing 'car wash'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN r","match
$r isa review, has text $t;
$t like "".*car wash.*"";
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
117,Find the first 5 businesses that have a category of 'Brewery'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Brewery'})
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 5","match
$b isa business;
$c isa category, has name ""Brewery"";
in_category (business: $b, category: $c);
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
118,Which businesses in 'San Mateo' have been reviewed in August 2016?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'San Mateo' 
  AND r.date >= date('2016-08-01') 
  AND r.date < date('2016-09-01')
RETURN b.name AS businessName","match
$b isa business, has city ""San Mateo"", has name $name;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2016-08-01T00:00:00;
$d < 2016-09-01T00:00:00;
fetch {
  ""businessName"": $name
};"
119,Which users wrote reviews for businesses located at '111 E 5th Ave'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {address: '111 E 5th Ave'})
RETURN u.name","match
  $u isa user;
  $r isa review;
  $b isa business, has address ""111 E 5th Ave"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
120,What are the addresses of the first 3 businesses named 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})
RETURN b.address
LIMIT 3","match
$b isa business, has name ""Neo4j"";
limit 3;
fetch {
  ""address"": $b.address
};"
121,Retrieve the top 5 reviews with a rating of 4 stars or higher.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars >= 4.0
RETURN r.reviewId, r.text, r.stars, b.name
ORDER BY r.stars DESC
LIMIT 5","match
$r isa review, has stars $s, has review_id $rid, has text $t;
$b isa business, has name $bn;
reviews (review: $r, reviewed_business: $b);
$s >= 4.0;
sort $s desc;
limit 5;
fetch {
  ""reviewId"": $rid,
  ""text"": $t,
  ""stars"": $s,
  ""businessName"": $bn
};"
122,Which businesses have received a review that mentioned 'great selection'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*great selection.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
123,List all reviews written by the user named 'Angie'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
$r isa review;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
124,Which users have written a review for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has name ""KettleHouse Brewing Co."";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
fetch {
  ""name"": $u.name
};"
125,What are the names of the first 3 businesses categorized as a 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name
LIMIT 3","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
limit 3;
fetch {
  ""name"": $b.name
};"
126,Find the first 5 users who wrote a review with a rating of 5 stars.,"MATCH (u:User)-[:WROTE]->(r:Review)
WHERE r.stars = 5.0
RETURN u.name, r.reviewId
ORDER BY r.date
LIMIT 5","match
$u isa user;
$r isa review, has stars 5.0, has date $d;
wrote (author: $u, review: $r);
sort $d asc;
limit 5;
fetch {
  ""name"": $u.name,
  ""review_id"": $r.review_id
};"
127,Identify the top 3 businesses by name that are in the city of San Mateo.,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name
ORDER BY b.name
LIMIT 3","match
$b isa business, has city ""San Mateo"", has name $n;
sort $n asc;
limit 3;
fetch {
  ""name"": $n
};"
128,Which businesses in Burlingame have an address on California Dr?,"MATCH (b:Business)
WHERE b.city = 'Burlingame' AND b.address CONTAINS 'California Dr'
RETURN b.name, b.address","match
$b isa business, has city ""Burlingame"", has address $addr;
$addr like "".*California Dr.*"";
fetch {
  ""name"": $b.name,
  ""address"": $addr
};"
129,List all businesses located in Missoula.,"MATCH (b:Business)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has city ""Missoula"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
130,Find the top 5 businesses with the highest average ratings and their addresses.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN b.name AS businessName, b.address AS address, avgRating","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 5;
fetch {
  ""businessName"": $b.name,
  ""address"": $b.address,
  ""avgRating"": $avg
};"
131,List the cities and states for the businesses that have a name starting with 'Z'.,"MATCH (b:Business)
WHERE b.name STARTS WITH 'Z'
RETURN b.city, b.state","match
$b isa business, has name $n;
$n like ""Z.*"";
fetch {
  ""city"": $b.city,
  ""state"": $b.state
};"
132,List the users who have reviewed 'Ducky's Car Wash'.,"MATCH (b:Business {name: ""Ducky's Car Wash""})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has name ""Ducky's Car Wash"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
fetch {
  ""name"": $u.name
};"
133,Retrieve the names of businesses that have been categorized under both 'Brewery' and 'Restaurant'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c1:Category {name: 'Brewery'}),
      (b)-[:IN_CATEGORY]->(c2:Category {name: 'Restaurant'})
RETURN b.name","match
$b isa business;
$c1 isa category, has name ""Brewery"";
$c2 isa category, has name ""Restaurant"";
in_category (business: $b, category: $c1);
in_category (business: $b, category: $c2);
fetch {
  ""name"": $b.name
};"
134,Which businesses have received reviews with a text mentioning 'books'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'books'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*books.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
135,Which businesses in 'Burlingame' have received reviews with a star rating of 3.5 or higher?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Burlingame' AND r.stars >= 3.5
RETURN b.name AS BusinessName, b.address AS Address, r.stars AS StarRating","match
  $b isa business, has city ""Burlingame"", has name $bn, has address $ba;
  $r isa review, has stars $s;
  $s >= 3.5;
  reviews (reviewed_business: $b, review: $r);
fetch {
  ""BusinessName"": $bn,
  ""Address"": $ba,
  ""StarRating"": $s
};"
136,List the first 5 businesses that have received a review mentioning 'service'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'service'
RETURN b.name
LIMIT 5","match
$b isa business;
$r isa review, has text $t;
$t like "".*service.*"";
reviews (review: $r, reviewed_business: $b);
limit 5;
fetch { ""name"": $b.name };"
137,Retrieve the names of the first 3 businesses that have been reviewed in December 2017.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-12-01') AND r.date <= date('2017-12-31')
RETURN b.name
ORDER BY r.date
LIMIT 3","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2017-12-01T00:00:00;
$d <= 2017-12-31T23:59:59;
sort $d asc;
limit 3;
fetch {
  ""name"": $b.name
};"
138,Which businesses located on '1st St' have received a review with a star rating of 4.0 or higher?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS '1st St' AND r.stars >= 4.0
RETURN b.name AS BusinessName, b.address AS Address, r.stars AS StarRating","match
  $b isa business, has address $addr, has name $bname;
  $addr like "".*1st St.*"";
  $r isa review, has stars $s;
  $s >= 4.0;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""BusinessName"": $bname,
  ""Address"": $addr,
  ""StarRating"": $s
};"
139,List the first 5 reviews with a text mentioning 'sandwich'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN r
LIMIT 5","match
$r isa review, has text $t;
$t like "".*sandwich.*"";
limit 5;
fetch {
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
140,Find the first 3 businesses that have been reviewed with a mention of 'library'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'library'
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*library.*"";
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
141,Which businesses have been reviewed by all users?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, collect(DISTINCT u.userId) AS reviewers
MATCH (u:User)
WITH b, reviewers, collect(DISTINCT u.userId) AS allUsers
WHERE reviewers = allUsers
RETURN b.name AS businessName","match
$b isa business;
not {
  $u isa user;
  not {
    wrote (author: $u, review: $r);
    reviews (review: $r, reviewed_business: $b);
  };
};
fetch {
  ""businessName"": $b.name
};"
142,List the user names and review texts for reviews written in January 2016.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date < date('2016-02-01')
RETURN u.name AS userName, r.text AS reviewText","match
$u isa user, has name $uname;
$r isa review, has date $d, has text $rt;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$d >= 2016-01-01T00:00:00;
$d < 2016-02-01T00:00:00;
fetch {
  ""userName"": $uname,
  ""reviewText"": $rt
};"
143,Which business in 'San Mateo' has been reviewed most frequently?,"MATCH (b:Business {city: 'San Mateo'})<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$b isa business, has city ""San Mateo"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
144,What are the names of the first 3 businesses located in 'MT'?,"MATCH (b:Business)
WHERE b.state = 'MT'
RETURN b.name
ORDER BY b.name
LIMIT 3","match
$b isa business, has state ""MT"", has name $n;
sort $n;
limit 3;
fetch {
  ""name"": $n
};"
145,List the first 5 businesses that have not been reviewed yet.,"MATCH (b:Business)
WHERE NOT (b)<-[:REVIEWS]-(:Review)
RETURN b.name AS businessName, b.address AS address, b.city AS city, b.state AS state
LIMIT 5","match
$b isa business;
not { reviews (reviewed_business: $b); };
limit 5;
fetch {
  ""businessName"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
146,List all reviews written in 2017 for businesses located on 'Broadway St'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
  AND b.address CONTAINS 'Broadway St'
RETURN r","match
$u isa user;
$r isa review, has date $d, has review_id $rid;
$b isa business, has address $addr;
$addr like "".*Broadway St.*"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$d >= 2017-01-01T00:00:00;
$d <= 2017-12-31T23:59:59;
fetch {
  ""review_id"": $r.review_id,
  ""date"": $d,
  ""text"": $r.text,
  ""stars"": $r.stars
};"
147,Retrieve the top 5 businesses that have been reviewed by users named 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b has name $bn;
reduce $count = count($r) groupby $b, $bn;
sort $count desc;
limit 5;
fetch {
  ""business_name"": $bn,
  ""review_count"": $count
};"
148,Which users wrote reviews for businesses located on 'Main St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'Main St'
RETURN u.name","match
  $u isa user;
  $b isa business, has address $addr;
  $addr like "".*Main St.*"";
  $r isa review;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
149,List the business names and address for the top 3 businesses with the most reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""businessAddress"": $b.address };"
150,Find the first 3 reviews with the lowest star ratings.,"MATCH (r:Review)
WITH r
ORDER BY r.stars ASC, r.date ASC
LIMIT 3
RETURN r.reviewId, r.text, r.stars, r.date","match
$r isa review, has stars $s, has date $d;
sort $s asc, $d asc;
limit 3;
fetch {
  ""reviewId"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $s,
  ""date"": $d
};"
151,Which businesses have received reviews with texts containing the word 'IPA'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*IPA.*"";
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
152,What are the names of the businesses that are located at '200 W Pine St'?,"MATCH (b:Business {address: '200 W Pine St'})
RETURN b.name","match
$b isa business, has address ""200 W Pine St"";
fetch {
  ""name"": $b.name
};"
153,List the first 5 users who have written a review for a business in the category 'Car Wash'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
MATCH (r:Review)-[:REVIEWS]->(b)
MATCH (u:User)-[:WROTE]->(r)
RETURN u.name AS userName
LIMIT 5","match
$b isa business;
$c isa category, has name ""Car Wash"";
in_category (business: $b, category: $c);
$r isa review;
reviews (review: $r, reviewed_business: $b);
$u isa user;
wrote (author: $u, review: $r);
limit 5;
fetch {
  ""userName"": $u.name
};"
154,Retrieve the names and locations of the first 3 businesses that have received at least one review with a star rating of 5.0.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name AS businessName, b.location AS businessLocation
LIMIT 3","match
$b isa business;
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""businessName"": $b.name,
  ""businessLocation"": $b.location
};"
155,Which users have written a review for businesses located in 'CA'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN u.name","match
$u isa user;
$b isa business, has state ""CA"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
156,List the business names and user names for reviews written in September 2015.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2015-09-01') AND r.date < date('2015-10-01')
RETURN b.name AS businessName, u.name AS userName","match
  $u isa user, has name $uname;
  $r isa review, has date $d;
  $b isa business, has name $bname;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $d >= 2015-09-01T00:00:00;
  $d < 2015-10-01T00:00:00;
fetch {
  ""businessName"": $bname,
  ""userName"": $uname
};"
157,Find the first 5 businesses located on 'Pine St' in any city.,"MATCH (b:Business)
WHERE b.address CONTAINS 'Pine St'
RETURN b.name, b.address, b.city, b.state
LIMIT 5","match
$b isa business, has address $addr, has name $name, has city $city, has state $state;
$addr like "".*Pine St.*"";
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $addr,
  ""city"": $city,
  ""state"": $state
};"
158,List all reviews with a star rating above 4.5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS starRating, u.name AS userName, b.name AS businessName","match
  $u isa user;
  $r isa review, has stars $s;
  $b isa business;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $s > 4.5;
fetch {
  ""reviewId"": $r.review_id,
  ""reviewText"": $r.text,
  ""starRating"": $s,
  ""userName"": $u.name,
  ""businessName"": $b.name
};"
159,Which users have written reviews for businesses in 'Burlingame'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'Burlingame'
RETURN DISTINCT u.name","match
$u isa user;
$r isa review;
$b isa business, has city ""Burlingame"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$u has name $name;
select $name;
distinct;
fetch { ""name"": $name };"
160,Which business has the most reviews in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
RETURN b.name AS business, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 1","match
$b isa business, has city ""Missoula"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch { ""business"": $b.name, ""review_count"": $count };"
161,Find all businesses and their categories in the state of 'CA'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN b.name AS businessName, c.name AS categoryName","match
  $b isa business, has state ""CA"";
  $c isa category;
  in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
162,Which businesses on '1st St W' have been reviewed by 'Will' and what are the review texts?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {address: '313 N 1st St W'})
RETURN b.name AS businessName, r.text AS reviewText","match
  $u isa user, has name ""Will"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $b has address $addr;
  $addr like "".*1st St W.*"";
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
163,List all businesses in 'CA' that have been reviewed in '2017' and their corresponding categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.state = 'CA' AND r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has state ""CA"", has name $bn;
$c isa category, has name $cn;
$r isa review, has date $d;
in_category (business: $b, category: $c);
reviews (review: $r, reviewed_business: $b);
$d >= 2017-01-01T00:00:00;
$d <= 2017-12-31T23:59:59;
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
164,What are the names of businesses in 'Missoula' that are categorized as 'Breweries' and their review texts?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Breweries'}),
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has city ""Missoula"", has name $bn;
$c isa category, has name ""Breweries"";
in_category (business: $b, category: $c);
$r isa review, has text $rt;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
165,Find the businesses in 'San Mateo' that have been reviewed by 'Angie' and list the review dates.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS businessName, r.date AS reviewDate","match
  $u isa user, has name ""Angie"";
  $b isa business, has city ""San Mateo"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $r.date
};"
166,Which businesses in 'Burlingame' have been reviewed in '2015' and what are the review texts?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.date >= date('2015-01-01') AND r.date < date('2016-01-01')
RETURN b.name AS businessName, r.text AS reviewText","match
  $b isa business, has city ""Burlingame"", has name $bn;
  $r isa review, has text $rt, has date $d;
  $d >= 2015-01-01T00:00:00;
  $d < 2016-01-01T00:00:00;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
167,List the names and categories of businesses on 'Broadway St' that have received a 5-star review.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'Broadway St' AND r.stars = 5.0
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address $addr;
$addr like "".*Broadway St.*"";
$c isa category;
in_category (business: $b, category: $c);
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
168,What are the names of businesses in 'Missoula' that have been reviewed by users named 'Jenny' and 'Bob'?,"MATCH (b:Business {city: 'Missoula'})
MATCH (u1:User {name: 'Jenny'})-[:WROTE]->(r1:Review)-[:REVIEWS]->(b)
MATCH (u2:User {name: 'Bob'})-[:WROTE]->(r2:Review)-[:REVIEWS]->(b)
RETURN DISTINCT b.name","match
$b isa business, has city ""Missoula"";
$u1 isa user, has name ""Jenny"";
$r1 isa review;
wrote (author: $u1, review: $r1);
reviews (review: $r1, reviewed_business: $b);
$u2 isa user, has name ""Bob"";
$r2 isa review;
wrote (author: $u2, review: $r2);
reviews (review: $r2, reviewed_business: $b);
fetch { ""name"": $b.name };"
169,Identify the businesses on 'Pine St' that have been reviewed in '2017' and list the reviewers' names.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE b.address CONTAINS 'Pine St' AND r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN b.name AS businessName, u.name AS reviewerName","match
  $b isa business, has address $addr, has name $bn;
  $addr like "".*Pine St.*"";
  $r isa review, has date $d;
  $d >= 2017-01-01T00:00:00;
  $d <= 2017-12-31T23:59:59;
  reviews (reviewed_business: $b, review: $r);
  wrote (author: $u, review: $r);
  $u isa user, has name $un;
fetch {
  ""businessName"": $bn,
  ""reviewerName"": $un
};"
170,Which businesses in 'San Mateo' have been reviewed more than twice and what are the review stars?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo'
WITH b, count(r) as reviewCount, collect(r.stars) as reviewStars
WHERE reviewCount > 2
RETURN b.name AS businessName, reviewStars","match
$b isa business, has city ""San Mateo"", has name $name;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
match
$count > 2;
$b has name $name;
$r2 isa review, has stars $stars;
reviews (review: $r2, reviewed_business: $b);
fetch {
  ""businessName"": $name,
  ""reviewStars"": $stars
};"
171,List the businesses on 'Main St' that have been reviewed by 'Angie' and the corresponding review texts.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'Main St'
RETURN b.name AS businessName, r.text AS reviewText","match
  $u isa user, has name ""Angie"";
  $b isa business, has address $addr;
  $addr like "".*Main St.*"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
172,What are the names of businesses in 'Burlingame' with reviews dated in '2016' and the names of the reviewers?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN b.name AS businessName, u.name AS reviewerName","match
  $b isa business, has city ""Burlingame"", has name $bn;
  $r isa review, has date $d;
  $d >= 2016-01-01T00:00:00;
  $d < 2017-01-01T00:00:00;
  $u isa user, has name $un;
  reviews (review: $r, reviewed_business: $b);
  wrote (author: $u, review: $r);
fetch {
  ""businessName"": $bn,
  ""reviewerName"": $un
};"
173,Identify businesses in 'Burlingame' with reviews mentioning 'awesome' and list the reviewers.,"MATCH (b:Business {city: 'Burlingame'})-[:IN_CATEGORY]->(c:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE r.text CONTAINS 'awesome'
RETURN b.name AS BusinessName, u.name AS ReviewerName","match
  $b isa business, has city ""Burlingame"", has name $bn;
  $r isa review, has text $t;
  $t like "".*awesome.*"";
  reviews (review: $r, reviewed_business: $b);
  wrote (author: $u, review: $r);
  $u has name $un;
fetch {
  ""BusinessName"": $bn,
  ""ReviewerName"": $un
};"
175,List all businesses that have been reviewed by 'Bob' in 'CA' and the corresponding stars of those reviews.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS businessName, r.stars AS reviewStars","match
$u isa user, has name ""Bob"";
$r isa review, has stars $s;
$b isa business, has state ""CA"", has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""reviewStars"": $s
};"
176,Identify the businesses in 'San Mateo' that have been reviewed by 'Will' and list the review texts.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS businessName, r.text AS reviewText","match
  $u isa user, has name ""Will"";
  $b isa business, has city ""San Mateo"";
  $r isa review;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
177,What are the names of businesses on '5th Ave' and their corresponding reviewers?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (r:Review)-[:REVIEWS]->(b), (u:User)-[:WROTE]->(r)
WHERE b.address CONTAINS '5th Ave'
RETURN b.name AS businessName, u.name AS reviewerName","match
$b isa business, has address $addr, has name $bname;
$addr like "".*5th Ave.*"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u isa user, has name $uname;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bname,
  ""reviewerName"": $uname
};"
178,Find businesses in 'Burlingame' that have been reviewed by 'Jenny' and list the categories of these businesses.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
  $u isa user, has name ""Jenny"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $b isa business, has city ""Burlingame"", has name $bn;
  in_category (business: $b, category: $c);
  $c has name $cn;
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
180,List the names and categories of businesses on 'California Dr' that have received a 3-star review.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address = '723 California Dr' AND r.stars = 3.0
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address ""723 California Dr"", has name $bn;
$c isa category, has name $cn;
in_category (business: $b, category: $c);
$r isa review, has stars $s;
$s == 3.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
181,Which business has reviews with the text mentioning 'car wash' and what are the review dates?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN b.name AS businessName, r.date AS reviewDate","match
$b isa business;
$r isa review, has text $t;
reviews (reviewed_business: $b, review: $r);
$t like "".*car wash.*"";
$r has date $d;
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $d
};"
182,List the names of businesses in 'San Mateo' that have been reviewed in '2018' and their review texts.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'San Mateo' AND r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has city ""San Mateo"", has name $bn;
$r isa review, has date $d, has text $rt;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-01-01T00:00:00;
$d <= 2018-12-31T23:59:59;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
183,Identify all businesses on 'Front St' with reviews from 'Jenny' and list the review dates.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE b.address CONTAINS 'Front St' AND u.name = 'Jenny'
RETURN b.name AS BusinessName, r.date AS ReviewDate","match
$b isa business, has address $addr, has name $bname;
$addr like "".*Front St.*"";
$r isa review, has date $d;
$u isa user, has name ""Jenny"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""BusinessName"": $bname,
  ""ReviewDate"": $d
};"
184,Which businesses in 'CA' have been reviewed by 'Bob' and list the review stars.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS businessName, r.stars AS reviewStars","match
$u isa user, has name ""Bob"";
$b isa business, has state ""CA"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$r has stars $s;
fetch {
  ""businessName"": $b.name,
  ""reviewStars"": $s
};"
185,What are the names of businesses with reviews mentioning 'breakfast' and their corresponding categories?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.text CONTAINS 'breakfast'
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
  $b isa business;
  $r isa review, has text $t;
  $t like "".*breakfast.*"";
  reviews (review: $r, reviewed_business: $b);
  $c isa category;
  in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
186,Which business on 'Broadway St' has the lowest average review star rating and what are the review texts?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'Broadway St'
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating ASC
LIMIT 1
MATCH (b)-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, avgRating, collect(r.text) AS reviewTexts","match
$b isa business, has address $addr;
$addr like "".*Broadway St.*"";
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg asc;
limit 1;
match
$r2 isa review, has text $t;
reviews (reviewed_business: $b, review: $r2);
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg,
  ""reviewTexts"": [ $r2.text ]
};"
187,What are the recent 3 reviews for 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.date DESC
LIMIT 3","match
$b isa business, has name ""Neo4j"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
$r has date $d;
sort $d desc;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
188,What are the names of businesses on 'California Dr' that have been reviewed in '2016' and their review texts?,"MATCH (b:Business {address: '723 California Dr'})-[:IN_CATEGORY]->(c:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has address $addr, has name $bname;
$addr like "".*California Dr.*"";
$r isa review, has date $d, has text $rt;
reviews (review: $r, reviewed_business: $b);
$d >= 2016-01-01T00:00:00;
$d < 2017-01-01T00:00:00;
fetch {
  ""businessName"": $bname,
  ""reviewText"": $rt
};"
189,Which business in 'Missoula' has the most diverse range of review stars and what are the review texts?,"// Step 1: Find all businesses in Missoula
MATCH (b:Business {city: 'Missoula'})-[:REVIEWS]-(r:Review)

// Step 2: Collect the stars for each business
WITH b, collect(r.stars) as stars, collect(r.text) as review_texts

// Step 3: Calculate the range of stars for each business
WITH b, review_texts, apoc.coll.max(stars) - apoc.coll.min(stars) as star_range

// Step 4: Find the business with the maximum range of stars
ORDER BY star_range DESC
LIMIT 1

// Step 5: Return the business name and review texts
RETURN b.name as business_name, review_texts","match
$b isa business, has city ""Missoula"";
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
reduce $max_s = max($s), $min_s = min($s) groupby $b;
match
let $range = $max_s - $min_s;
sort $range desc;
limit 1;
match
reviews (reviewed_business: $b, review: $r2);
$r2 has text $t;
fetch {
  ""business_name"": $b.name,
  ""review_text"": $t
};"
190,What are the names of businesses that have been reviewed with a rating less than 4.0?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 4.0
RETURN b.name","match
$b isa business;
$r isa review, has stars $s;
$s < 4.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
191,List the top 3 businesses by the number of reviews they received.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
192,Which users have reviewed businesses in 'Burlingame'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'Burlingame'
RETURN DISTINCT u.name","match
$u isa user;
$r isa review;
$b isa business, has city ""Burlingame"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
select $u;
distinct;
fetch { ""name"": $u.name };"
193,What are the business names that have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
194,Which businesses are located in California and have more than one review?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA'
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN b.name AS businessName, b.address AS businessAddress, reviewCount","match
$b isa business, has state ""CA"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $reviewCount = count($r) groupby $b;
match $reviewCount > 1;
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""reviewCount"": $reviewCount
};"
195,What is the name of the business reviewed on '2018-09-10'?,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2018-09-10')
RETURN b.name","match
$r isa review, has date 2018-09-10T00:00:00;
$b isa business;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
196,List all the reviews written by the user 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
$r isa review;
fetch {
  ""review_id"": $r.review_id,
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars
};"
197,What are the names of businesses located at '200 W Pine St' and '313 N 1st St W'?,"MATCH (b:Business)
WHERE b.address IN ['200 W Pine St', '313 N 1st St W']
RETURN b.name","match
$b isa business, has address $a;
{ $a == ""200 W Pine St""; } or { $a == ""313 N 1st St W""; };
fetch {
  ""name"": $b.name
};"
198,Which businesses have the highest average review stars? Only list the top 5.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgStars
ORDER BY avgStars DESC
LIMIT 5
RETURN b.name AS businessName, avgStars","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 5;
fetch {
  ""businessName"": $b.name,
  ""avgStars"": $avg
};"
199,Find the top 3 users who have written the most reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS userName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$u isa user;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
200,What are the addresses of the businesses categorized as 'Coffee'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN b.address","match
$b isa business;
$c isa category, has name ""Coffee"";
in_category (business: $b, category: $c);
fetch {
  ""address"": $b.address
};"
201,List the businesses in 'San Mateo' that have received reviews mentioning 'graph database' and the reviewers' names.,"MATCH (b:Business {city: 'San Mateo'})-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE r.text CONTAINS 'graph database'
RETURN b.name AS BusinessName, u.name AS ReviewerName","match
$b isa business, has city ""San Mateo"", has name $bn;
in_category (business: $b, category: $c);
$r isa review, has text $t;
$t like "".*graph database.*"";
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u has name $un;
fetch {
  ""BusinessName"": $bn,
  ""ReviewerName"": $un
};"
203,List the names of the businesses that have a review with 5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name","match
$b isa business;
$r isa review, has stars 5.0;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
204,What are the names of the top 5 businesses located in Missoula?,"MATCH (b:Business {city: 'Missoula'})
OPTIONAL MATCH (b)<-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN b.name","match
$b isa business, has city ""Missoula"", has name $n;
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
reduce $avg = mean($s) groupby $b, $n;
sort $avg desc;
limit 5;
fetch { ""name"": $n };"
205,Find the businesses in 'San Mateo' that have been reviewed by 'Jenny' and list the categories of these businesses.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business, has city ""San Mateo"", has name $bn;
in_category (business: $b, category: $c);
$c has name $cn;
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
206,Which businesses in 'Burlingame' have reviews mentioning 'love' and list the review dates.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.text CONTAINS 'love'
RETURN b.name AS BusinessName, r.date AS ReviewDate","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has text $t, has date $d;
$t like "".*love.*"";
reviews (review: $r, reviewed_business: $b);
fetch {
  ""BusinessName"": $bn,
  ""ReviewDate"": $d
};"
207,What are the names of businesses on '5th Ave' and their corresponding review stars?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS '5th Ave'
RETURN b.name AS businessName, r.stars AS reviewStars","match
  $b isa business, has address $addr, has name $bname;
  $addr like "".*5th Ave.*"";
  in_category (business: $b, category: $cat);
  $r isa review, has stars $stars;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bname,
  ""reviewStars"": $stars
};"
208,List the businesses in 'CA' that have been reviewed in '2018' and their corresponding categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA' AND r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
RETURN b.name AS businessName, c.name AS categoryName","match
  $b isa business, has state ""CA"", has name $bn;
  $c isa category, has name $cn;
  in_category (business: $b, category: $c);
  $r isa review, has date $d;
  reviews (review: $r, reviewed_business: $b);
  $d >= 2018-01-01T00:00:00;
  $d <= 2018-12-31T23:59:59;
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
209,Identify the business in 'Missoula' with the highest number of 5-star reviews and list the review texts.,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review {stars: 5.0})
WITH b, count(r) AS reviewCount, collect(r.text) AS reviewTexts
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewTexts","match
  $b isa business, has city ""Missoula"";
  reviews (reviewed_business: $b, review: $r);
  $r isa review, has stars $s;
  $s == 5.0;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
match
  reviews (reviewed_business: $b, review: $r2);
  $r2 isa review, has stars 5.0;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r2.text
};"
210,Which businesses in 'San Mateo' have been reviewed by more than one user and what are the review texts?,"MATCH (b:Business {city: 'San Mateo'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, COUNT(DISTINCT u) AS userCount, COLLECT(r.text) AS reviewTexts
WHERE userCount > 1
RETURN b.name AS businessName, reviewTexts","match
$b isa business, has city ""San Mateo"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
select $b, $u;
distinct;
reduce $user_count = count($u) groupby $b;
match
$user_count > 1;
$r2 isa review;
reviews (review: $r2, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewTexts"": [ $r2.text ]
};"
211,List the businesses on 'Broadway St' that have been reviewed by 'Angie' and the review dates.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS businessName, r.date AS reviewDate","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b has address $addr;
$addr like "".*Broadway St.*"";
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $r.date
};"
212,What are the names of businesses in 'Burlingame' that have been reviewed by 'Will' and the corresponding review texts.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name AS businessName, r.text AS reviewText","match
$u isa user, has name ""Will"";
$r isa review;
$b isa business, has city ""Burlingame"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
213,Find the top 5 businesses in 'CA' based on the number of reviews they have received.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA'
WITH b, count(r) as reviewCount
ORDER BY reviewCount DESC
LIMIT 5
RETURN b.name AS businessName, reviewCount","match
$b isa business, has state ""CA"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
214,Which users have written a review for 'KettleHouse Brewing Co.'?,MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'KettleHouse Brewing Co.'})\nRETURN u.name,"match\n  $u isa user, has name $n;\n  $b isa business, has name ""KettleHouse Brewing Co."";\n  $r isa review;\n  wrote (author: $u, review: $r);\n  reviews (review: $r, reviewed_business: $b);\nfetch {\n  ""name"": $n\n};"
215,Find the businesses with addresses starting with '301' and list their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address STARTS WITH '301'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address $addr;
$addr like ""301.*"";
in_category (business: $b, category: $c);
$c isa category;
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
216,Which businesses located in 'MT' are categorized under 'Brewery'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'MT' AND c.name = 'Brewery'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has state ""MT"", has name $bn, has address $ba;
$c isa category, has name ""Brewery"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba
};"
217,List the review dates for businesses named 'Neo4j'.,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)
RETURN r.date","match
$b isa business, has name ""Neo4j"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""date"": $r.date
};"
218,Which 3 businesses have reviews that mention both 'world' and 'leading'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'world' AND r.text CONTAINS 'leading'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review, has text $t;
reviews (review: $r, reviewed_business: $b);
$t like "".*world.*"";
$t like "".*leading.*"";
reduce $reviewCount = count($r) groupby $b;
sort $reviewCount desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $reviewCount
};"
220,What are the top 3 businesses with reviews that have a star rating of exactly 4.5?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 4.5
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business;
$r isa review, has stars 4.5;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""name"": $b.name,
  ""reviewCount"": $count
};"
221,Can you display the top 5 businesses that have reviews with 'awesome' in their text?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE toLower(r.text) CONTAINS 'awesome'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5","match
  $b isa business;
  $r isa review, has text $t;
  reviews (review: $r, reviewed_business: $b);
  $t like ""(?i).*awesome.*"";
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch {
  ""name"": $b.name,
  ""reviewCount"": $count
};"
222,Show the first 3 businesses that have reviews mentioning 'Ninja Mike's'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""Ninja Mike's""
RETURN b.name AS businessName
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*Ninja Mike's.*"";
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""businessName"": $b.name
};"
223,Find the top 3 businesses with reviews mentioning 'IPA' and having a star rating greater than 4.5.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA' AND r.stars > 4.5
RETURN b.name, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$b isa business;
$r isa review, has text $t, has stars $s;
reviews (reviewed_business: $b, review: $r);
$t like "".*IPA.*"";
$s > 4.5;
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 3;
fetch { ""name"": $b.name, ""avgRating"": $avg };"
224,Which 3 businesses have reviews mentioning 'full-service'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'full-service'
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*full-service.*"";
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $b.name
};"
225,List the top 3 businesses that have been reviewed by users from California.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business, has state ""CA"", has name $name;
$r isa review;
$u isa user;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $name;
sort $count desc;
limit 3;
fetch { ""businessName"": $name, ""reviewCount"": $count };"
226,What are the top 3 businesses with reviews mentioning 'breakfast' and located in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Missoula' AND r.text CONTAINS 'breakfast'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has city ""Missoula"", has name $name;
$r isa review, has text $t;
$t like "".*breakfast.*"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name };"
227,Can you find the top 3 businesses with reviews mentioning 'beer'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'beer'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has name $n;
$r isa review, has text $t;
$t like "".*beer.*"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name, ""reviewCount"": $count };"
228,Show the top 5 reviews that mention 'best'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'best'
RETURN r
ORDER BY r.stars DESC
LIMIT 5","match
$r isa review, has text $t, has stars $s;
$t like "".*best.*"";
sort $s desc;
limit 5;
fetch {
  ""review"": $r.text,
  ""stars"": $r.stars
};"
230,Find the top 3 reviews for businesses located at '313 N 1st St W'.,"MATCH (b:Business {address: '313 N 1st St W'})<-[:REVIEWS]-(r:Review)
RETURN r.text, r.stars
ORDER BY r.stars DESC
LIMIT 3","match
$b isa business, has address ""313 N 1st St W"";
reviews (review: $r, reviewed_business: $b);
$r has stars $s;
sort $s desc;
limit 3;
fetch {
  ""text"": $r.text,
  ""stars"": $s
};"
231,List the top 3 businesses with reviews mentioning 'farmer's market'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""farmer's market""
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*farmer's market.*"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name, ""reviewCount"": $count };"
232,What are the top 3 businesses with reviews mentioning 'car'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'car'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*car.*"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name, ""reviewCount"": $count };"
233,Can you display the top 5 businesses with reviews that mention 'love'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'love'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review, has text $t;
$t like "".*love.*"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
234,Show the first 3 businesses that have reviews mentioning 'sandwich'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*sandwich.*"";
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
235,Find the top 3 businesses that have received reviews only from users named 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH b, COUNT(r) AS reviewCount, COLLECT(DISTINCT u.name) AS reviewers
WHERE SIZE(reviewers) = 1 AND reviewers[0] = 'Will'
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has name $bn;
$u isa user, has name ""Will"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
not {
  $u2 isa user, has name $n2;
  not { $n2 == ""Will""; };
  $r2 isa review;
  wrote (author: $u2, review: $r2);
  reviews (review: $r2, reviewed_business: $b);
};
reduce $count = count($r) groupby $b, $bn;
sort $count desc;
limit 3;
fetch { ""businessName"": $bn };"
236,Which 3 reviews mention both 'great' and 'selection' in their text?,"MATCH (r:Review)
WHERE r.text CONTAINS 'great' AND r.text CONTAINS 'selection'
RETURN r
LIMIT 3","match
$r isa review, has text $t;
$t like "".*great.*"";
$t like "".*selection.*"";
limit 3;
fetch {
  ""review"": $r.text
};"
237,List the top 3 businesses with reviews that have a star rating of 5 and mention 'awesome'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0 AND r.text CONTAINS 'awesome'
RETURN b.name, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 3","match
$b isa business, has name $n;
$r isa review, has stars $s, has text $t;
reviews (reviewed_business: $b, review: $r);
$s == 5.0;
$t like "".*awesome.*"";
reduce $count = count($r) groupby $b, $n;
sort $count desc;
limit 3;
fetch {
  ""name"": $n,
  ""review_count"": $count
};"
239,Can you find the top 3 businesses that have been reviewed by 'Jenny' and 'Bob'?,"MATCH (u1:User {name: 'Jenny'})-[:WROTE]->(r1:Review)-[:REVIEWS]->(b:Business),
      (u2:User {name: 'Bob'})-[:WROTE]->(r2:Review)-[:REVIEWS]->(b)
WITH b, COUNT(DISTINCT r1) + COUNT(DISTINCT r2) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$u1 isa user, has name ""Jenny"";
$u2 isa user, has name ""Bob"";
$b isa business;
$r1 isa review;
wrote (author: $u1, review: $r1);
reviews (review: $r1, reviewed_business: $b);
$r2 isa review;
wrote (author: $u2, review: $r2);
reviews (review: $r2, reviewed_business: $b);
$r isa review;
$u isa user;
{ $r is $r1; $u is $u1; } or { $r is $r2; $u is $u2; };
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""business_name"": $b.name, ""review_count"": $count };"
240,Show the top 5 reviews for businesses with addresses on '1st St'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.address CONTAINS '1st St'
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS stars, b.name AS businessName, u.name AS userName
ORDER BY r.stars DESC
LIMIT 5","match
$b isa business, has address $addr;
$addr like "".*1st St.*"";
$r isa review, has stars $s;
$u isa user;
in_category (business: $b, category: $cat);
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
sort $s desc;
limit 5;
fetch {
  ""reviewId"": $r.review_id,
  ""reviewText"": $r.text,
  ""stars"": $s,
  ""businessName"": $b.name,
  ""userName"": $u.name
};"
241,Find the top 3 businesses with the most reviews in 'Missoula'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business, has city ""Missoula"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
242,Which 3 businesses have reviews that mention 'books'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'books'
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*books.*"";
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
243,Which 3 businesses have reviews that mention 'Ducky's'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""Ducky's""
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*Ducky's.*"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
244,Show the first 3 businesses that have reviews mentioning 'sandwich' and 'farmer's market'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich' AND r.text CONTAINS ""farmer's market""
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
reviews (reviewed_business: $b, review: $r);
$t like "".*sandwich.*"";
$t like "".*farmer's market.*"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
245,What are the top 3 businesses with the most recent reviews mentioning 'car wash'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WHERE r.text CONTAINS 'car wash'
RETURN b.name, r.date
ORDER BY r.date DESC
LIMIT 3","match
$b isa business;
$r isa review, has text $t, has date $d;
$t like "".*car wash.*"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
sort $d desc;
limit 3;
fetch {
  ""name"": $b.name,
  ""date"": $d
};"
246,List the top 5 reviews with a star rating above 4.5.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS stars, u.name AS userName, b.name AS businessName
ORDER BY r.stars DESC
LIMIT 5","match
$u isa user, has name $un;
$r isa review, has stars $s, has review_id $rid, has text $rt;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$s > 4.5;
sort $s desc;
limit 5;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $rt,
  ""stars"": $s,
  ""userName"": $un,
  ""businessName"": $bn
};"
247,What are the names of 3 businesses located on 'E Main St' or 'W Broadway St'?,"MATCH (b:Business)
WHERE b.address CONTAINS 'E Main St' OR b.address CONTAINS 'W Broadway St'
RETURN b.name
LIMIT 3","match
$b isa business, has address $addr;
{ $addr like "".*E Main St.*""; } or { $addr like "".*W Broadway St.*""; };
limit 3;
fetch {
  ""name"": $b.name
};"
248,Show the first 3 reviews with text containing 'great selection'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN r
LIMIT 3","match
$r isa review, has text $t;
$t like "".*great selection.*"";
limit 3;
fetch {
  ""review"": {
    ""text"": $r.text,
    ""stars"": $r.stars,
    ""review_id"": $r.review_id,
    ""date"": $r.date
  }
};"
249,List the names of 5 businesses that have a review with at least 4.0 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4.0
RETURN DISTINCT b.name
LIMIT 5","match
$b isa business;
$r isa review, has stars $s;
$s >= 4.0;
reviews (review: $r, reviewed_business: $b);
select $b;
distinct;
limit 5;
fetch {
  ""name"": $b.name
};"
250,Which 3 users have written a review on 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name
LIMIT 3","match
$b isa business, has name ""Neo4j"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
limit 3;
fetch { ""name"": $u.name };"
251,Show the first 3 review texts for businesses in 'Missoula'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
RETURN r.text
ORDER BY r.date
LIMIT 3","match
$b isa business, has city ""Missoula"";
in_category (business: $b, category: $c);
$r isa review, has text $t;
reviews (review: $r, reviewed_business: $b);
$r has date $d;
sort $d;
limit 3;
fetch { ""text"": $t };"
252,What are the top 3 categories available for businesses?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category, COUNT(b) AS businessCount
ORDER BY businessCount DESC
LIMIT 3","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
$c has name $cat_name;
reduce $count = count($b) groupby $cat_name;
sort $count desc;
limit 3;
fetch { ""category"": $cat_name, ""businessCount"": $count };"
253,Which 3 businesses are located in the state 'CA'?,"MATCH (b:Business)
WHERE b.state = 'CA'
RETURN b.name, b.address, b.city
LIMIT 3","match
$b isa business, has state ""CA"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city
};"
254,Show the first 3 reviews written by 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)
RETURN r
ORDER BY r.date
LIMIT 3","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
$r has date $d;
sort $d asc;
limit 3;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $d
};"
255,What are the names of 3 businesses categorized as 'Beer'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
RETURN b.name
LIMIT 3","match
$b isa business;
$c isa category, has name ""Beer"";
in_category (business: $b, category: $c);
limit 3;
fetch {
  ""name"": $b.name
};"
256,Can you show the top 5 businesses with reviews mentioning 'book'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'book'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5","match
$b isa business;
$r isa review, has text $t;
$t like "".*book.*"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch {
  ""name"": $b.name,
  ""reviewCount"": $count
};"
257,List the top 5 business names in 'Burlingame'.,"MATCH (b:Business {city: 'Burlingame'})
RETURN b.name
ORDER BY b.name
LIMIT 5","match
$b isa business, has city ""Burlingame"", has name $n;
sort $n asc;
limit 5;
fetch {
  ""name"": $n
};"
258,Which 3 users wrote reviews?,"MATCH (u:User)-[:WROTE]->(:Review)
RETURN DISTINCT u.name
LIMIT 3","match
$u isa user;
wrote (author: $u, review: $r);
select $u;
distinct;
limit 3;
fetch {
  ""name"": $u.name
};"
259,Show the names of 3 businesses located on '200 W Pine St'.,"MATCH (b:Business {address: '200 W Pine St'})
RETURN b.name
LIMIT 3","match
$b isa business, has address ""200 W Pine St"";
limit 3;
fetch {
  ""name"": $b.name
};"
260,List the first 5 businesses in 'San Mateo'.,"MATCH (b:Business {city: 'San Mateo'})
RETURN b.name, b.address, b.businessId
LIMIT 5","match
$b isa business, has city ""San Mateo"";
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""business_id"": $b.business_id
};"
261,What are the top 3 businesses in 'Missoula'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula'
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN b.name AS businessName, avgRating","match
$b isa business, has city ""Missoula"";
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg_rating = mean($s) groupby $b;
sort $avg_rating desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg_rating
};"
262,List the first 3 businesses that have reviews from 'Burlingame' with a star rating above 4.5.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.stars > 4.5
RETURN b.name AS business_name, r.stars AS star_rating
ORDER BY r.date ASC
LIMIT 3","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has stars $s, has date $d;
$s > 4.5;
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
wrote (author: $u, review: $r);
sort $d asc;
limit 3;
fetch {
  ""business_name"": $bn,
  ""star_rating"": $s
};"
263,What are the top 3 businesses that have been reviewed on '2017-11-13'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2017-11-13')
RETURN b.name, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 3","match
$b isa business;
$r isa review, has date $d;
$d == 2017-11-13;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""name"": $b.name,
  ""review_count"": $count
};"
264,Can you find the top 3 businesses with reviews from users named 'Jenny' and 'Will'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name IN ['Jenny', 'Will']
WITH b, COUNT(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$u isa user, has name $uname;
{ $uname == ""Jenny""; } or { $uname == ""Will""; };
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b has name $bname;
reduce $reviewCount = count($r) groupby $bname;
sort $reviewCount desc;
limit 3;
fetch { ""businessName"": $bname, ""reviewCount"": $reviewCount };"
265,Show the top 5 businesses with reviews that have a star rating greater than 4 and mention 'awesome'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars > 4 AND r.text CONTAINS 'awesome'
RETURN b.name, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 5","match
$b isa business;
$r isa review, has stars $s, has text $t;
reviews (reviewed_business: $b, review: $r);
$s > 4.0;
$t like "".*awesome.*"";
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch { ""name"": $b.name, ""review_count"": $count };"
266,Find the top 3 businesses that have reviews mentioning 'library'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE c.name = 'Library' AND r.text CONTAINS 'library'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
$r isa review, has text $t;
$t like "".*library.*"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name, ""review_count"": $count };"
267,Which 3 businesses have reviews written by users named 'Angie' in 2017?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2017-01-01') AND r.date < date('2018-01-01')
RETURN b.name AS businessName
LIMIT 3","match
$u isa user, has name ""Angie"";
$r isa review, has date $d;
$d >= 2017-01-01T00:00:00;
$d < 2018-01-01T00:00:00;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""businessName"": $b.name
};"
268,List the top 3 businesses with reviews having the exact text 'Great IPA selection!'.,"MATCH (r:Review {text: 'Great IPA selection!'})-[:REVIEWS]->(b:Business)
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$r isa review, has text ""Great IPA selection!"";
reviews (review: $r, reviewed_business: $b);
$b isa business;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name, ""review_count"": $count };"
269,Name the 3 businesses that have been reviewed with 5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
270,Which 3 businesses have the most reviews in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business, has city ""Missoula"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
271,List the first 3 businesses that have reviews with text mentioning 'world's leading'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""world's leading""
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*world's leading.*"";
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $b.name
};"
272,Can you display the top 5 businesses that have reviews with a text mentioning 'IPA'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5","match
$b isa business;
$r isa review, has text $t;
$t like "".*IPA.*"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch { ""name"": $b.name, ""review_count"": $count };"
273,Show the first 3 businesses with names starting with 'Z'.,"MATCH (b:Business)
WHERE b.name STARTS WITH 'Z'
RETURN b.name, b.address, b.city, b.state, b.businessId
ORDER BY b.name
LIMIT 3","match
$b isa business, has name $n;
$n like ""Z.*"";
sort $n asc;
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
274,What are the top 5 reviews written in the year 2016?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN r.reviewId AS reviewId, r.text AS text, r.stars AS stars, r.date AS date, u.name AS userName, b.name AS businessName
ORDER BY r.stars DESC
LIMIT 5","match
$u isa user, has name $uname;
$r isa review, has review_id $rid, has text $txt, has stars $s, has date $d;
$b isa business, has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$d >= 2016-01-01T00:00:00;
$d <= 2016-12-31T23:59:59;
sort $s desc;
limit 5;
fetch {
  ""reviewId"": $rid,
  ""text"": $txt,
  ""stars"": $s,
  ""date"": $d,
  ""userName"": $uname,
  ""businessName"": $bname
};"
275,List the first 3 businesses that have a review with exactly 5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business;
$r isa review, has stars 5.0;
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
276,What are the top 3 businesses by the number of categories they belong to?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, COUNT(c) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3
RETURN b.name AS businessName, categoryCount","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""categoryCount"": $count };"
277,Which 3 businesses have the oldest reviews?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r
ORDER BY r.date ASC
RETURN b.name, r.date
LIMIT 3","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
sort $d asc;
limit 3;
fetch {
  ""name"": $b.name,
  ""date"": $d
};"
278,Can you find the top 5 most recent reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.date AS reviewDate, r.text AS reviewText, r.stars AS reviewStars, u.name AS userName, b.name AS businessName
ORDER BY r.date DESC
LIMIT 5","match
$u isa user, has name $userName;
$r isa review, has date $reviewDate, has text $reviewText, has stars $reviewStars;
$b isa business, has name $businessName;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $reviewDate desc;
limit 5;
fetch {
  ""reviewDate"": $reviewDate,
  ""reviewText"": $reviewText,
  ""reviewStars"": $reviewStars,
  ""userName"": $userName,
  ""businessName"": $businessName
};"
279,Show the first 3 businesses with addresses on 'Broadway St'.,"MATCH (b:Business)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name, b.address
LIMIT 3","match
$b isa business, has address $addr;
$addr like "".*Broadway St.*"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $addr
};"
280,List the top 5 businesses located in the state of CA.,"MATCH (b:Business)
WHERE b.state = 'CA'
RETURN b.name, b.address, b.city, b.state
ORDER BY b.name
LIMIT 5","match
$b isa business, has state ""CA"", has name $n;
sort $n;
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
281,Find the first 3 reviews that contain the text 'great selection'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN r
ORDER BY r.date ASC
LIMIT 3","match
$r isa review, has text $t, has date $d;
$t like "".*great selection.*"";
sort $d asc;
limit 3;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
282,Find the top 3 users who have written reviews for 'Imagine Nation Brewing'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Imagine Nation Brewing'})
RETURN u.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$u isa user, has name $uname;
$r isa review;
$b isa business, has name ""Imagine Nation Brewing"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $u, $uname;
sort $count desc;
limit 3;
fetch { ""name"": $uname, ""reviewCount"": $count };"
283,Which 3 businesses have reviews dated after 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date > date('2017-01-01')
RETURN b.name AS businessName, r.date AS reviewDate
ORDER BY r.date DESC
LIMIT 3","match
$b isa business, has name $name;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d > 2017-01-01T00:00:00;
sort $d desc;
limit 3;
fetch {
  ""businessName"": $name,
  ""reviewDate"": $d
};"
284,What are the first 3 reviews with a star rating above 4.5?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.5
RETURN r.reviewId, r.text, r.stars, u.name, b.name
ORDER BY r.date ASC
LIMIT 3","match
$u isa user, has name $uname;
$r isa review, has stars $s, has review_id $rid, has text $rtxt, has date $d;
$b isa business, has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$s > 4.5;
sort $d asc;
limit 3;
fetch {
  ""reviewId"": $rid,
  ""text"": $rtxt,
  ""stars"": $s,
  ""userName"": $uname,
  ""businessName"": $bname
};"
285,Can you display the top 5 businesses based on their addresses alphabetically?,"MATCH (b:Business)
RETURN b.name, b.address
ORDER BY b.address
LIMIT 5","match
$b isa business, has address $addr;
sort $addr asc;
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $addr
};"
286,Show the first 3 reviews written by the user named 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)
RETURN r
ORDER BY r.date
LIMIT 3","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
$r isa review, has date $d;
sort $d;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
287,Which 3 businesses have the most reviews written about them?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
288,List the top 3 highest scoring reviews for 'Ninja Mike's'.,"MATCH (b:Business {name: ""Ninja Mike's""})<-[:REVIEWS]-(r:Review)
RETURN r.text, r.stars
ORDER BY r.stars DESC
LIMIT 3","match
$b isa business, has name ""Ninja Mike's"";
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
sort $s desc;
limit 3;
fetch {
  ""text"": $r.text,
  ""stars"": $s
};"
289,What are the top 5 businesses in the 'Beer' category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
MATCH (r:Review)-[:REVIEWS]->(b)
WITH b, AVG(r.stars) AS avgRating
RETURN b.name AS businessName, avgRating
ORDER BY avgRating DESC
LIMIT 5","match
$b isa business;
$c isa category, has name ""Beer"";
in_category (business: $b, category: $c);
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 5;
fetch { ""businessName"": $b.name, ""avgRating"": $avg };"
290,Identify the first 3 businesses in the 'Library' category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$b isa business, has name $bn, has address $ba, has city $bc, has state $bs, has business_id $bid;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
limit 3;
fetch {
  ""name"": $bn,
  ""address"": $ba,
  ""city"": $bc,
  ""state"": $bs,
  ""businessId"": $bid
};"
291,Which 3 users have written the most reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS userName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$u isa user, has name $n;
$r isa review;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u, $n;
sort $count desc;
limit 3;"
292,Can you retrieve the top 5 highest-rated reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.text AS reviewText, r.stars AS rating, u.name AS userName, b.name AS businessName
ORDER BY r.stars DESC
LIMIT 5","match
$u isa user, has name $un;
$r isa review, has text $rt, has stars $rating;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $rating desc;
limit 5;
fetch {
  ""reviewText"": $rt,
  ""rating"": $rating,
  ""userName"": $un,
  ""businessName"": $bn
};"
293,Find the first 3 businesses located in San Mateo.,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$b isa business, has city ""San Mateo"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
294,What are the top 3 businesses located in Burlingame?,"MATCH (b:Business)
WHERE b.city = 'Burlingame'
RETURN b.name, b.address, b.businessId
ORDER BY b.name
LIMIT 3","match
$b isa business, has city ""Burlingame"";
$b has name $name;
sort $name asc;
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""businessId"": $b.business_id
};"
295,List the top 3 users by the number of reviews they have written.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN u.name AS userName, reviewCount","match
$u isa user;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
296,What are the top 3 businesses that have been reviewed in both 2016 and 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
WITH b, count(r) AS reviews_2016
WHERE reviews_2016 > 0

MATCH (b)<-[:REVIEWS]-(r2:Review)
WHERE r2.date >= date('2017-01-01') AND r2.date <= date('2017-12-31')
WITH b, reviews_2016, count(r2) AS reviews_2017
WHERE reviews_2017 > 0

RETURN b.name AS business_name, reviews_2016, reviews_2017
ORDER BY (reviews_2016 + reviews_2017) DESC
LIMIT 3","with fun reviews_2016($b: business) -> integer:
  match
    $r isa review, has date $d;
    reviews (review: $r, reviewed_business: $b);
    $d >= 2016-01-01T00:00:00;
    $d <= 2016-12-31T23:59:59;
  return count;

with fun reviews_2017($b: business) -> integer:
  match
    $r isa review, has date $d;
    reviews (review: $r, reviewed_business: $b);
    $d >= 2017-01-01T00:00:00;
    $d <= 2017-12-31T23:59:59;
  return count;

match
  $b isa business;
let $c2016 = reviews_2016($b);
let $c2017 = reviews_2017($b);
$c2016 > 0;
$c2017 > 0;
let $total = $c2016 + $c2017;
sort $total desc;
limit 3;
fetch { ""business_name"": $b.name, ""reviews_2016"": $c2016, ""reviews_2017"": $c2017 };"
297,List the top 3 users who have written reviews for businesses in 'Missoula'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
WITH u, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN u.name AS userName, reviewCount","match
$u isa user;
$r isa review;
$b isa business, has city ""Missoula"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
298,Show the first 3 reviews for businesses located at '301 E Main St'.,"MATCH (b:Business {address: '301 E Main St'})<-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.date
LIMIT 3","match
$b isa business, has address ""301 E Main St"";
reviews (reviewed_business: $b, review: $r);
$r has date $d;
sort $d;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
299,Show the first 3 businesses that have reviews mentioning both 'great' and 'IPA'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great' AND r.text CONTAINS 'IPA'
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
reviews (review: $r, reviewed_business: $b);
$t like "".*great.*"";
$t like "".*IPA.*"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
300,Find the top 3 reviews for businesses located at '200 W Pine St'.,"MATCH (b:Business {address: '200 W Pine St'})<-[:REVIEWS]-(r:Review)
RETURN r
ORDER BY r.stars DESC
LIMIT 3","match
$b isa business, has address ""200 W Pine St"";
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
sort $s desc;
limit 3;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $s,
  ""date"": $r.date
};"
301,Which 3 businesses have reviews that mention 'Ninja'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'Ninja'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has name $n;
$r isa review, has text $t;
$t like "".*Ninja.*"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b, $n;
sort $count desc;
limit 3;
fetch { ""businessName"": $n, ""reviewCount"": $count };"
302,List the top 3 businesses that are categorized under both 'Library' and 'Beer'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c1:Category {name: 'Library'}),
      (b)-[:IN_CATEGORY]->(c2:Category {name: 'Beer'})
WITH b, COUNT(*) AS categoryCount
WHERE categoryCount = 2
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$b isa business;
$c1 isa category, has name ""Library"";
$c2 isa category, has name ""Beer"";
in_category (business: $b, category: $c1);
in_category (business: $b, category: $c2);
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 3;
fetch { ""name"": $b.name, ""avgRating"": $avg };"
303,What are the top 3 reviews that mention 'awesome'?,"MATCH (r:Review)
WHERE r.text CONTAINS 'awesome'
RETURN r
ORDER BY r.stars DESC
LIMIT 3","match
$r isa review, has text $t, has stars $s;
$t like "".*awesome.*"";
sort $s desc;
limit 3;
fetch {
  ""text"": $r.text,
  ""stars"": $s,
  ""review_id"": $r.review_id
};"
304,Can you display the top 5 reviews that mention 'selection'?,"MATCH (r:Review)
WHERE r.text CONTAINS 'selection'
RETURN r
ORDER BY r.stars DESC
LIMIT 5","match
$r isa review, has text $t, has stars $s;
$t like "".*selection.*"";
sort $s desc;
limit 5;
fetch {
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id,
  ""date"": $r.date
};"
305,Show the first 3 businesses with reviews from users whose name starts with 'W'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name STARTS WITH 'W'
RETURN DISTINCT b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$u isa user, has name $un;
$un like ""W.*"";
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
select $b;
distinct;
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
306,Find the top 3 businesses with reviews on or after '2017-01-01'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01')
RETURN b.name, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 3","match
$b isa business;
$r isa review, has date $d;
$d >= 2017-01-01T00:00:00;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name, ""review_count"": $count };"
307,Which 3 businesses have reviews that give them a star rating below 3.5?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 3.5
RETURN b.name AS businessName, AVG(r.stars) AS averageRating
ORDER BY averageRating ASC
LIMIT 3","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
$s < 3.5;
reduce $avg = mean($s) groupby $b;
sort $avg asc;
limit 3;
fetch { ""businessName"": $b.name, ""averageRating"": $avg };"
308,List the first 3 businesses with reviews from users named 'Angie'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
309,What are the top 3 businesses with the most recent review dates?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r
ORDER BY r.date DESC
RETURN b.name AS businessName, r.date AS reviewDate
LIMIT 3","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
sort $d desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $d
};"
310,Which 3 users have written reviews for businesses in 'San Mateo'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'San Mateo'
RETURN DISTINCT u.name
LIMIT 3","match
  $u isa user;
  $r isa review;
  $b isa business, has city ""San Mateo"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
select $u;
distinct;
limit 3;
fetch {
  ""name"": $u.name
};"
311,Find the top 5 users who have written reviews for businesses in 'CA'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN u.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5","match
$u isa user;
$r isa review;
$b isa business, has state ""CA"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $reviewCount = count($r) groupby $u;
sort $reviewCount desc;
limit 5;
fetch {
  ""name"": $u.name,
  ""reviewCount"": $reviewCount
};"
312,Which 3 businesses have the lowest average review score?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
ORDER BY avgRating ASC
LIMIT 3
RETURN b.name AS businessName, avgRating","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg asc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg
};"
313,List the top 3 businesses with the highest average review score.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN b.name AS businessName, avgRating","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 3;
fetch { ""businessName"": $b.name, ""avgRating"": $avg };"
314,What are the first 3 businesses that have been reviewed by more than one user?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, COUNT(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b.name AS businessName, userCount
ORDER BY businessName
LIMIT 3","match
$b isa business;
$rev isa review;
$u isa user;
reviews (review: $rev, reviewed_business: $b);
wrote (author: $u, review: $rev);
select $u, $b;
distinct;
reduce $count = count groupby $b;
match $count > 1;
$b has name $name;
sort $name;
limit 3;
fetch {
  ""businessName"": $name,
  ""userCount"": $count
};"
315,Can you list the top 3 businesses that have a user named 'Bob' writing a review for them?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $reviewCount = count($r) groupby $b;
sort $reviewCount desc;
limit 3;
fetch { ""name"": $b.name, ""reviewCount"": $reviewCount };"
316,Show the top 5 businesses with reviews written in September.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2018-09-01') AND r.date < date('2018-10-01')
RETURN b.name, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 5","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-09-01T00:00:00;
$d < 2018-10-01T00:00:00;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch { ""name"": $b.name, ""review_count"": $count };"
317,Find the top 3 reviews that mention 'car wash'.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'car wash'
RETURN r.text, r.stars, b.name
ORDER BY r.stars DESC
LIMIT 3","match
$r isa review, has text $t, has stars $s;
$t like "".*car wash.*"";
$b isa business;
reviews (review: $r, reviewed_business: $b);
sort $s desc;
limit 3;
fetch {
  ""text"": $t,
  ""stars"": $s,
  ""business_name"": $b.name
};"
318,Which 3 businesses have reviews mentioning 'breakfast'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has name $n;
$r isa review, has text $t;
$t like "".*breakfast.*"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $n;
sort $count desc;
limit 3;
fetch { ""businessName"": $n, ""reviewCount"": $count };"
319,List the first 3 reviews for businesses in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN r
ORDER BY r.date
LIMIT 3","match
  $b isa business, has city ""Burlingame"";
  in_category (business: $b, category: $cat);
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
  $r has date $d;
sort $d asc;
limit 3;
fetch {
  ""review_id"": $r.review_id,
  ""date"": $r.date,
  ""stars"": $r.stars,
  ""text"": $r.text
};"
320,Show the first 3 reviews that resulted in an exact star rating of 4.0.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 4.0
RETURN r.reviewId, r.text, r.date, r.stars, u.name, b.name
ORDER BY r.date
LIMIT 3","match
  $u isa user, has name $uname;
  $r isa review, has stars $s, has review_id $rid, has text $rtxt, has date $rdate;
  $b isa business, has name $bname;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $s == 4.0;
sort $rdate asc;
limit 3;
fetch {
  ""reviewId"": $rid,
  ""text"": $rtxt,
  ""date"": $rdate,
  ""stars"": $s,
  ""userName"": $uname,
  ""businessName"": $bname
};"
321,List all the users who have written at least one review.,"MATCH (u:User)-[:WROTE]->(:Review)
RETURN DISTINCT u.name","match
$u isa user;
wrote (author: $u, review: $r);
select $u;
distinct;
fetch {
  ""name"": $u.name
};"
322,Name the top 3 users based on the number of reviews written.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN u.name AS userName, reviewCount","match
$u isa user, has name $name;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u, $name;
sort $count desc;
limit 3;
fetch { ""userName"": $name, ""reviewCount"": $count };"
323,What are the top 3 most recent reviews for businesses in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA'
RETURN r.date AS reviewDate, r.text AS reviewText, r.stars AS reviewStars, b.name AS businessName
ORDER BY r.date DESC
LIMIT 3","match
  $b isa business, has state ""CA"", has name $bn;
  in_category (business: $b, category: $c);
  $r isa review, has date $d, has text $rt, has stars $rs;
  reviews (review: $r, reviewed_business: $b);
sort $d desc;
limit 3;
fetch {
  ""reviewDate"": $d,
  ""reviewText"": $rt,
  ""reviewStars"": $rs,
  ""businessName"": $bn
};"
324,Which 3 businesses have been reviewed by 'Will' in 'San Mateo'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Will"";
$r isa review;
$b isa business, has city ""San Mateo"", has name $n;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch { ""name"": $n };"
325,List the names of 3 businesses with reviews on 'W Pine St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'W Pine St'
RETURN b.name
LIMIT 3","match
$b isa business, has address $addr, has name $n;
$addr like "".*W Pine St.*"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $n
};"
326,Show the first 3 businesses in 'Burlingame' with reviews mentioning 'awesome'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.text CONTAINS 'awesome'
RETURN b.name AS businessName, r.text AS reviewText
ORDER BY b.name
LIMIT 3","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has text $rt;
reviews (review: $r, reviewed_business: $b);
$rt like "".*awesome.*"";
sort $bn;
limit 3;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
327,What are the names of the top 3 businesses in 'Missoula' based on the number of reviews?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business, has city ""Missoula"", has name $name;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b, $name;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $name,
  ""reviewCount"": $count
};"
328,List the names of 3 businesses reviewed by 'Angie' in 'CA'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Angie"";
$r isa review;
$b isa business, has state ""CA"", has name $n;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch { ""name"": $n };"
329,Show the first 3 businesses with reviews mentioning 'IPA selection'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA selection'
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*IPA selection.*"";
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
330,Which 3 businesses have reviews from 'Jenny' with a star rating above 4.5?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)
WHERE r.stars > 4.5
MATCH (r)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName
LIMIT 3","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
$r has stars $s;
$s > 4.5;
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""businessName"": $b.name
};"
331,List the first 3 businesses in 'Missoula' with a review date in 2018.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula' AND r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
RETURN b.name, b.address, r.date
ORDER BY r.date
LIMIT 3","match
$b isa business, has city ""Missoula"", has name $bn, has address $ba;
$r isa review, has date $rd;
reviews (reviewed_business: $b, review: $r);
$rd >= 2018-01-01T00:00:00;
$rd <= 2018-12-31T23:59:59;
sort $rd;
limit 3;
fetch {
  ""name"": $bn,
  ""address"": $ba,
  ""date"": $rd
};"
332,What are the names of 3 businesses with the most reviews in 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
WITH b, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2017-01-01T00:00:00;
$d <= 2017-12-31T23:59:59;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""name"": $b.name };"
333,Show the first 5 businesses in 'San Mateo' that have been reviewed.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'San Mateo'
RETURN DISTINCT b.name, b.address, b.city, b.state, b.businessId
LIMIT 5","match
$b isa business, has city ""San Mateo"", has name $name, has address $addr, has city $c, has state $s, has business_id $bid;
reviews (review: $r, reviewed_business: $b);
select $b, $name, $addr, $c, $s, $bid;
distinct;
limit 5;
fetch {
  ""name"": $name,
  ""address"": $addr,
  ""city"": $c,
  ""state"": $s,
  ""businessId"": $bid
};"
334,List the names of 3 businesses in 'CA' with the highest star ratings in reviews.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA'
RETURN b.name, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$b isa business, has state ""CA"", has name $name;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b, $name;
sort $avg desc;
limit 3;
fetch { ""name"": $name };"
335,Show the names of 3 businesses with reviews from 'Bob' with a star rating below 4.5.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 4.5
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Bob"";
$r isa review, has stars $s;
$s < 4.5;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
336,Which 3 businesses have reviews mentioning 'sandwich' at 'Farmer's Market'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich' AND r.text CONTAINS ""Farmer's Market""
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
reviews (reviewed_business: $b, review: $r);
$t like "".*sandwich.*"";
$t like "".*Farmer's Market.*"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""business_id"": $b.business_id
};"
337,What are the names of 3 businesses in 'Missoula' with reviews mentioning 'selection'?,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'selection'
RETURN DISTINCT b.name
LIMIT 3","match
  $b isa business, has city ""Missoula"";
  $r isa review, has text $t;
  $t like "".*selection.*"";
  reviews (review: $r, reviewed_business: $b);
select $b;
distinct;
limit 3;
fetch {
  ""name"": $b.name
};"
338,List the first 5 businesses that have been reviewed and are located in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN DISTINCT b.name, b.address, b.city, b.state, b.businessId
LIMIT 5","match
  $b isa business, has city ""Burlingame"";
  in_category (business: $b, category: $cat);
  reviews (review: $rev, reviewed_business: $b);
select $b;
distinct;
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
339,Show the first 3 businesses in 'CA' reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business, has state ""CA"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
340,List the names of 3 businesses with reviews mentioning 'not great'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'not great'
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
reviews (reviewed_business: $b, review: $r);
$t like "".*not great.*"";
limit 3;
fetch { ""name"": $b.name };"
341,Which 3 businesses have been reviewed by 'Bob' and are located in 'San Mateo'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$u isa user, has name ""Bob"";
$b isa business, has city ""San Mateo"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
342,Show the first 3 reviews for businesses with a review date in 2016.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN r.reviewId, r.text, r.date, r.stars, b.name, u.name
ORDER BY r.date
LIMIT 3","match
$u isa user, has name $un;
$r isa review, has review_id $rid, has text $rt, has date $rd, has stars $rs;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$rd >= 2016-01-01T00:00:00;
$rd < 2017-01-01T00:00:00;
sort $rd;
limit 3;
fetch {
  ""reviewId"": $rid,
  ""text"": $rt,
  ""date"": $rd,
  ""stars"": $rs,
  ""businessName"": $bn,
  ""userName"": $un
};"
343,What are the names of 3 businesses in 'CA' that have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name
LIMIT 3","match
  $u isa user, has name ""Jenny"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $b isa business, has state ""CA"";
limit 3;
fetch {
  ""name"": $b.name
};"
344,List the first 5 reviews for businesses on 'Broadway St'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'Broadway St'
RETURN r.reviewId, r.date, r.text, r.stars, b.name
ORDER BY r.date
LIMIT 5","match
$b isa business, has address $addr, has name $bname;
$addr like "".*Broadway St.*"";
$r isa review, has review_id $rid, has date $d, has text $t, has stars $s;
reviews (review: $r, reviewed_business: $b);
sort $d;
limit 5;
fetch {
  ""reviewId"": $rid,
  ""date"": $d,
  ""text"": $t,
  ""stars"": $s,
  ""businessName"": $bname
};"
345,Show the names of 3 businesses with reviews containing the word 'world's leading'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS ""world's leading""
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*world's leading.*"";
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
346,Which 3 businesses have reviews from 'Will' with a star rating of 5.0?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review {stars: 5.0})-[:REVIEWS]->(b:Business)
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Will"";
$r isa review, has stars 5.0;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""name"": $b.name
};"
347,List the first 5 businesses that have been categorized under 'Car Wash'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
RETURN b.name
LIMIT 5","match
$b isa business;
$c isa category, has name ""Car Wash"";
in_category (business: $b, category: $c);
limit 5;
fetch {
  ""name"": $b.name
};"
348,Show the first 3 reviews for businesses with addresses on 'E Main St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'E Main St'
RETURN r
ORDER BY r.date
LIMIT 3","match
$b isa business, has address $addr;
$addr like "".*E Main St.*"";
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
sort $d;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
349,Show the first 3 businesses in 'Missoula' that have been reviewed by 'Angie'.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business, has city ""Missoula"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
350,List the first 5 businesses with reviews mentioning 'car wash' in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.text CONTAINS 'car wash'
RETURN b.name AS businessName, r.text AS reviewText
LIMIT 5","match
  $b isa business, has city ""Burlingame"", has name $bn;
  $r isa review, has text $rt;
  $rt like "".*car wash.*"";
  reviews (review: $r, reviewed_business: $b);
sort $bn;
limit 5;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
351,Show the names of the first 3 businesses reviewed by 'Jenny' with texts mentioning 'great selection'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'great selection'
RETURN b.name
ORDER BY r.date
LIMIT 3","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
$r isa review, has text $t;
$t like "".*great selection.*"";
$r has date $d;
reviews (review: $r, reviewed_business: $b);
$b isa business;
sort $d;
limit 3;
fetch {
  ""name"": $b.name
};"
352,Which businesses have a state code 'CA' and have received a review rating below 4 stars?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA' AND r.stars < 4.0
RETURN b.name AS businessName, b.address AS businessAddress, r.stars AS reviewRating","match
  $b isa business, has state ""CA"", has name $name, has address $addr;
  $r isa review, has stars $stars;
  reviews (review: $r, reviewed_business: $b);
  $stars < 4.0;
fetch {
  ""businessName"": $name,
  ""businessAddress"": $addr,
  ""reviewRating"": $stars
};"
353,Identify the business categories in 'San Mateo' with reviews written by Bob.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name AS category","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business, has city ""San Mateo"";
in_category (business: $b, category: $c);
fetch {
  ""category"": $c.name
};"
354,List the businesses with addresses on 'Broadway St' and their corresponding review texts.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS businessName, b.address AS businessAddress, r.text AS reviewText","match
  $b isa business, has address $addr, has name $bname;
  $addr like "".*Broadway St.*"";
  $r isa review, has text $rt;
  in_category (business: $b, category: $c);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bname,
  ""businessAddress"": $addr,
  ""reviewText"": $rt
};"
355,Which businesses have reviews written in August 2016?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2016-08-01') AND r.date <= date('2016-08-31')
RETURN b.name AS businessName","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2016-08-01T00:00:00;
$d <= 2016-08-31T23:59:59;
fetch {
  ""businessName"": $b.name
};"
357,List all businesses reviewed by users with a userId 'u2'.,"MATCH (u:User {userId: 'u2'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, b.address AS address, b.city AS city, b.state AS state, r.date AS reviewDate, r.stars AS stars, r.text AS reviewText","match
$u isa user, has user_id ""u2"";
wrote (author: $u, review: $r);
$r isa review;
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""businessName"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""reviewDate"": $r.date,
  ""stars"": $r.stars,
  ""reviewText"": $r.text
};"
358,Name the categories of businesses that are located on 'E Main St'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'E Main St'
RETURN DISTINCT c.name AS category","match
  $b isa business, has address $addr;
  $addr like "".*E Main St.*"";
  $c isa category, has name $cat;
  in_category (business: $b, category: $c);
fetch {
  ""category"": $cat
};"
359,Which businesses in 'Missoula' have a review with a rating of at least 4 stars?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula' AND r.stars >= 4.0
RETURN b.name AS businessName","match
$b isa business, has city ""Missoula"", has name $name;
$r isa review, has stars $s;
$s >= 4.0;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $name
};"
360,Find the businesses in 'CA' that have reviews with text containing 'graph database'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.state = 'CA' AND r.text CONTAINS 'graph database'
RETURN b.name AS businessName, b.address AS businessAddress, r.text AS reviewText","match
  $b isa business, has state ""CA"", has name $bn, has address $ba;
  $r isa review, has text $rt;
  $rt like "".*graph database.*"";
  reviews (review: $r, reviewed_business: $b);
  wrote (author: $u, review: $r);
  in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba,
  ""reviewText"": $rt
};"
361,Name the businesses that have been reviewed on '2017-11-13'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review {date: date('2017-11-13')})
RETURN b.name","match
$b isa business;
$r isa review, has date 2017-11-13T00:00:00;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
362,What are the categories of businesses that have a review with exactly 4.5 stars?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)-[:WROTE]->(u:User)
WHERE r.stars = 4.5
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name AS category","match
$b isa business;
$r isa review, has stars 4.5;
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$c has name $cat;
select $cat;
distinct;
fetch { ""category"": $cat };"
363,What are the names of 3 businesses in 'CA' reviewed by 'Angie' with a star rating of 5.0?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review {stars: 5.0})-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Angie"";
$r isa review, has stars 5.0;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business, has state ""CA"";
limit 3;
fetch {
  ""name"": $b.name
};"
364,Which businesses are categorized under 'Library' and are located in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.state = 'CA'
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity","match
$b isa business, has state ""CA"", has name $bn, has address $ba, has city $bc;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba,
  ""businessCity"": $bc
};"
365,Identify businesses in 'Burlingame' that have a review text mentioning 'car wash'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.text CONTAINS 'car wash'
RETURN b.name AS BusinessName, b.address AS Address, r.text AS ReviewText","match
$b isa business, has city ""Burlingame"", has name $bn, has address $ba;
$r isa review, has text $rt;
$rt like "".*car wash.*"";
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
in_category (business: $b, category: $c);
fetch {
  ""BusinessName"": $bn,
  ""Address"": $ba,
  ""ReviewText"": $rt
};"
366,Display the names of businesses with at least two reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount >= 2
RETURN b.name","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match $count >= 2;
fetch { ""name"": $b.name };"
367,Which users have written reviews for businesses located at '200 W Pine St'?,"MATCH (b:Business {address: '200 W Pine St'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has address ""200 W Pine St"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
fetch {
  ""name"": $u.name
};"
368,Name the businesses that have been reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b.name","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2018-09-01T00:00:00;
$d <= 2018-09-30T23:59:59;
fetch {
  ""name"": $b.name
};"
369,What are the top 3 highest-rated reviews and which businesses do they correspond to?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH r, b
ORDER BY r.stars DESC
LIMIT 3
RETURN r.text AS reviewText, r.stars AS rating, b.name AS businessName","match
$r isa review, has stars $s, has text $t;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b has name $bn;
sort $s desc;
limit 3;
fetch {
  ""reviewText"": $t,
  ""rating"": $s,
  ""businessName"": $bn
};"
370,List the businesses reviewed by Jenny.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""businessName"": $b.name
};"
371,Find the names of all users who wrote a review with 5 stars.,"MATCH (u:User)-[:WROTE]->(r:Review {stars: 5.0})
RETURN u.name","match
$u isa user;
$r isa review, has stars 5.0;
wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
372,What are the names of businesses in San Mateo that are categorized as 'Coffee'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo' AND c.name = 'Coffee'
RETURN b.name","match
$b isa business, has city ""San Mateo"";
$c isa category, has name ""Coffee"";
in_category (business: $b, category: $c);
fetch {
  ""name"": $b.name
};"
373,Which businesses are located in Missoula and have a businessId starting with 'b3'?,"MATCH (b:Business)
WHERE b.city = 'Missoula' AND b.businessId STARTS WITH 'b3'
RETURN b.name, b.address, b.businessId","match
$b isa business, has city ""Missoula"", has business_id $bid;
$bid like ""^b3.*"";
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""businessId"": $bid
};"
374,Which 3 businesses have reviews mentioning 'love'?,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'love'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$r isa review, has text $t;
$t like "".*love.*"";
$b isa business;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
375,List the first 5 businesses in 'Missoula' that have been reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 5","match
  $u isa user, has name ""Will"";
  $b isa business, has city ""Missoula"";
  $r isa review;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""business_id"": $b.business_id
};"
376,List the business names and locations that have been reviewed by users named Angie.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, b.location AS businessLocation","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""businessLocation"": $b.location
};"
377,Show the business addresses for 'KettleHouse Brewing Co.' and 'Imagine Nation Brewing'.,"MATCH (b:Business)
WHERE b.name IN ['KettleHouse Brewing Co.', 'Imagine Nation Brewing']
RETURN b.name, b.address","match
$b isa business, has name $n, has address $a;
{ $n == ""KettleHouse Brewing Co.""; } or { $n == ""Imagine Nation Brewing""; };
fetch {
  ""name"": $n,
  ""address"": $a
};"
378,What are the names of 3 businesses with reviews written on '2018-09-10'?,"MATCH (u:User)-[:WROTE]->(r:Review {date: date('2018-09-10')})-[:REVIEWS]->(b:Business)
RETURN b.name
LIMIT 3","match
$u isa user;
$r isa review, has date 2018-09-10T00:00:00;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
379,Show the first 5 businesses with reviews mentioning 'awesome'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'awesome'
RETURN b.name, b.address, b.city, b.state, r.text
LIMIT 5","match
$b isa business;
$r isa review, has text $t;
$t like "".*awesome.*"";
reviews (reviewed_business: $b, review: $r);
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""text"": $t
};"
380,List the first 5 reviews for businesses in 'Missoula' with a star rating of 5.0.,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review {stars: 5.0})
RETURN r
ORDER BY r.date
LIMIT 5","match
  $b isa business, has city ""Missoula"";
  $r isa review, has stars 5.0;
  reviews (review: $r, reviewed_business: $b);
  $r has date $d;
sort $d asc;
limit 5;
fetch {
  ""review_id"": $r.review_id,
  ""stars"": $r.stars,
  ""date"": $r.date,
  ""text"": $r.text
};"
381,Show the names of 3 businesses where 'Bob' wrote a review.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""name"": $b.name
};"
382,Which 3 businesses are categorized under 'Car Wash' in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Car Wash'})
WHERE b.city = 'Missoula'
RETURN b.name
LIMIT 3","match
$b isa business, has city ""Missoula"";
$c isa category, has name ""Car Wash"";
in_category (business: $b, category: $c);
limit 3;
fetch {
  ""name"": $b.name
};"
383,List the first 3 categories for businesses in 'San Mateo'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN DISTINCT c.name
LIMIT 3","match
$b isa business, has city ""San Mateo"";
$c isa category, has name $n;
in_category (business: $b, category: $c);
select $n;
distinct;
limit 3;
fetch {
  ""category"": $n
};"
385,Show the first 3 reviews that mention 'IPA'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN r
ORDER BY r.date
LIMIT 3","match
$r isa review, has text $t, has date $d;
$t like "".*IPA.*"";
sort $d;
limit 3;
fetch {
  ""review"": {
    ""text"": $r.text,
    ""stars"": $r.stars,
    ""date"": $r.date,
    ""review_id"": $r.review_id
  }
};"
386,List the first 5 businesses that Jenny reviewed.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name
LIMIT 5","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 5;
fetch {
  ""name"": $b.name
};"
387,Which 3 users wrote the most recent reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, r.date
ORDER BY r.date DESC
LIMIT 3","match
$u isa user;
$r isa review, has date $d;
wrote (author: $u, review: $r);
sort $d desc;
limit 3;
fetch {
  ""name"": $u.name,
  ""date"": $d
};"
388,Show the first 3 reviews for businesses categorized under 'Beer'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN r
ORDER BY r.date
LIMIT 3","match
  $c isa category, has name ""Beer"";
  in_category (business: $b, category: $c);
  $r isa review, has date $d;
  reviews (review: $r, reviewed_business: $b);
sort $d;
limit 3;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $d
};"
389,What are the names of 3 businesses in 'Burlingame' with reviews?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN DISTINCT b.name
LIMIT 3","match
$b isa business, has city ""Burlingame"", has name $n;
reviews (review: $r, reviewed_business: $b);
select $n;
distinct;
limit 3;
fetch {
  ""name"": $n
};"
390,List the first 5 business names with a review containing the word 'Love'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'Love'
RETURN b.name
LIMIT 5","match
$b isa business;
$r isa review, has text $t;
$t like "".*Love.*"";
reviews (reviewed_business: $b, review: $r);
limit 5;
fetch { ""name"": $b.name };"
391,What are the names of 3 businesses in 'CA' with reviews mentioning 'great'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA' AND r.text CONTAINS 'great'
RETURN DISTINCT b.name
LIMIT 3","match
$b isa business, has state ""CA"";
in_category (business: $b, category: $c);
$r isa review, has text $t;
$t like "".*great.*"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count groupby $b;
limit 3;
fetch { ""name"": $b.name };"
392,Show the names of 3 businesses that have been reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date(""2018-09-01"") AND r.date <= date(""2018-09-30"")
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-09-01T00:00:00;
$d <= 2018-09-30T23:59:59;
limit 3;
fetch {
  ""name"": $b.name
};"
393,List the names of 3 businesses located at '313 N 1st St W' or '111 E 5th Ave'.,"MATCH (b:Business)
WHERE b.address IN ['313 N 1st St W', '111 E 5th Ave']
RETURN b.name
LIMIT 3","match
$b isa business, has address $a;
{ $a == ""313 N 1st St W""; } or { $a == ""111 E 5th Ave""; };
limit 3;
fetch { ""name"": $b.name };"
394,What are the first 3 business names that have been reviewed with a text mentioning 'breakfast'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*breakfast.*"";
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch { ""name"": $b.name };"
395,Show the top 5 reviews with the earliest review dates.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.date, r.text, r.stars, u.name, b.name
ORDER BY r.date ASC
LIMIT 5","match
$u isa user, has name $uname;
$r isa review, has review_id $rid, has date $d, has text $t, has stars $s;
$b isa business, has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $d asc;
limit 5;
fetch {
  ""reviewId"": $rid,
  ""date"": $d,
  ""text"": $t,
  ""stars"": $s,
  ""userName"": $uname,
  ""businessName"": $bname
};"
396,List the first 3 businesses with a state property of 'MT'.,"MATCH (b:Business)
WHERE b.state = 'MT'
RETURN b.name, b.address, b.city, b.state
LIMIT 3","match
$b isa business, has state ""MT"";
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
397,Which 3 businesses have been reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""name"": $b.name
};"
398,Show the names of businesses that have a 'Library' category in 'Missoula'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.city = 'Missoula'
RETURN b.name","match
$b isa business, has city ""Missoula"", has name $n;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""name"": $n
};"
399,What are the names of 3 businesses that have an address in 'San Mateo'?,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name
LIMIT 3","match
$b isa business, has city ""San Mateo"";
limit 3;
fetch {
  ""name"": $b.name
};"
400,List the first 5 business names along 'California Dr'.,"MATCH (b:Business)
WHERE b.address CONTAINS 'California Dr'
RETURN b.name
LIMIT 5","match
$b isa business, has address $a;
$a like "".*California Dr.*"";
limit 5;
fetch {
  ""name"": $b.name
};"
401,Show the first 3 users who have written a review on 'Ducky's Car Wash'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: ""Ducky's Car Wash""})
RETURN u.name
LIMIT 3","match
$u isa user;
$r isa review;
$b isa business, has name ""Ducky's Car Wash"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $u.name
};"
402,Which 3 businesses have been reviewed on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has date 2018-09-10T00:00:00;
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
403,List the names of businesses reviewed by 'Will' with more than 4 stars.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4.0
RETURN b.name","match
$u isa user, has name ""Will"";
$r isa review, has stars $s;
$s > 4.0;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""name"": $b.name
};"
404,Which 3 users have reviewed businesses on 'E Front St'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN u.name
LIMIT 3","match
$u isa user;
$b isa business, has address $a;
$a like "".*E Front St.*"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $u.name
};"
405,List the first 3 reviews for businesses on 'California Dr'.,"MATCH (b:Business {address: '723 California Dr'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN r.reviewId, r.date, r.text, r.stars, u.name
ORDER BY r.date
LIMIT 3","match
$b isa business, has address $addr;
$addr like "".*California Dr.*"";
$r isa review, has date $d, has text $t, has stars $s, has review_id $rid;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user, has name $uname;
sort $d asc;
limit 3;
fetch {
  ""reviewId"": $rid,
  ""date"": $d,
  ""text"": $t,
  ""stars"": $s,
  ""userName"": $uname
};"
406,Show the top 3 reviews for 'Zootown Brew'.,"MATCH (b:Business {name: 'Zootown Brew'})<-[:REVIEWS]-(r:Review)
RETURN r.text, r.stars, r.date
ORDER BY r.stars DESC, r.date DESC
LIMIT 3","match
$b isa business, has name ""Zootown Brew"";
$r isa review, has stars $s, has date $d;
reviews (review: $r, reviewed_business: $b);
sort $s desc, $d desc;
limit 3;
fetch {
  ""text"": $r.text,
  ""stars"": $s,
  ""date"": $d
};"
407,List the names of 3 users who wrote a review in 2016.,"MATCH (u:User)-[:WROTE]->(r:Review)
WHERE r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN u.name
LIMIT 3","match
$u isa user, has name $n;
$r isa review, has date $d;
wrote (author: $u, review: $r);
$d >= 2016-01-01T00:00:00;
$d <= 2016-12-31T23:59:59;
limit 3;
fetch {
  ""name"": $n
};"
408,Which 3 businesses have been reviewed by users from 'MT'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'MT'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$u isa user;
$r isa review;
$b isa business, has state ""MT"", has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $bn;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $bn,
  ""reviewCount"": $count
};"
409,List the first 3 businesses in 'Missoula' with reviews mentioning 'great IPA'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Missoula' AND r.text CONTAINS 'great IPA'
RETURN b.name AS businessName, r.text AS reviewText
ORDER BY b.name
LIMIT 3","match
$b isa business, has city ""Missoula"", has name $bn;
$r isa review, has text $rt;
reviews (review: $r, reviewed_business: $b);
$rt like "".*great IPA.*"";
sort $bn;
limit 3;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
410,What are the names of 3 businesses in 'Burlingame' that have been reviewed by 'Bob'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name
LIMIT 3","match
  $u isa user, has name ""Bob"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $b isa business, has city ""Burlingame"";
limit 3;
fetch {
  ""name"": $b.name
};"
411,Show the first 3 businesses that have been reviewed and are located on 'W Broadway St'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'W Broadway St'
RETURN DISTINCT b.name, b.address
LIMIT 3","match
$b isa business, has address $addr, has name $name;
$addr like "".*W Broadway St.*"";
reviews (review: $r, reviewed_business: $b);
select $name, $addr;
distinct;
limit 3;
fetch { ""name"": $name, ""address"": $addr };"
412,List the names of 3 businesses in 'CA' that have been reviewed.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA'
RETURN DISTINCT b.name
LIMIT 3","match
$b isa business, has state ""CA"", has name $name;
reviews (reviewed_business: $b);
select $b, $name;
distinct;
limit 3;
fetch {
  ""name"": $name
};"
413,Which 3 businesses have the most recent reviews?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name, b.businessId, MAX(r.date) AS latestReviewDate
ORDER BY latestReviewDate DESC
LIMIT 3","match
$b isa business, has name $name, has business_id $bid;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
reduce $latest = max($d) groupby $b, $name, $bid;
sort $latest desc;
limit 3;
fetch {
  ""name"": $name,
  ""businessId"": $bid,
  ""latestReviewDate"": $latest
};"
414,Show the first 3 businesses in 'San Mateo' categorized under 'Brewery'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo' AND c.name = 'Brewery'
RETURN b.name, b.address, b.businessId
LIMIT 3","match
$b isa business, has city ""San Mateo"", has name $bn, has address $ba, has business_id $bid;
$c isa category, has name ""Brewery"";
in_category (business: $b, category: $c);
limit 3;
fetch {
  ""name"": $bn,
  ""address"": $ba,
  ""businessId"": $bid
};"
415,What are the names of 3 businesses with reviews written by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""name"": $b.name
};"
416,List the first 5 reviews for businesses located on 'E Front St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'E Front St'
RETURN r
ORDER BY r.date
LIMIT 5","match
$b isa business, has address $addr;
$addr like "".*E Front St.*"";
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
sort $d;
limit 5;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
417,Show the names of 3 businesses in 'Missoula' reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN b.name
LIMIT 3","match
  $u isa user, has name ""Will"";
  $b isa business, has city ""Missoula"";
  $r isa review;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
418,Which 3 businesses have been reviewed by 'Bob' in 'Burlingame'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Bob"";
$b isa business, has city ""Burlingame"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
limit 3;
fetch {
  ""name"": $b.name
};"
419,Which 3 businesses have the address '723 California Dr'?,"MATCH (b:Business {address: '723 California Dr'})
RETURN b.name, b.businessId, b.city, b.state
LIMIT 3","match
$b isa business, has address ""723 California Dr"";
limit 3;
fetch {
  ""name"": $b.name,
  ""businessId"": $b.business_id,
  ""city"": $b.city,
  ""state"": $b.state
};"
420,List the names of 3 businesses located at '716 N San Mateo Dr'.,"MATCH (b:Business {address: '716 N San Mateo Dr'})
RETURN b.name
LIMIT 3","match
$b isa business, has address ""716 N San Mateo Dr"";
limit 3;
fetch {
  ""name"": $b.name
};"
421,Show the first 3 businesses categorized under 'Public Library'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Public Library'})
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
$b isa business, has name $bn, has address $addr, has city $city, has state $st, has business_id $bid;
$c isa category, has name ""Public Library"";
in_category (business: $b, category: $c);
limit 3;
fetch {
  ""name"": $bn,
  ""address"": $addr,
  ""city"": $city,
  ""state"": $st,
  ""businessId"": $bid
};"
422,List the first 5 reviews mentioning 'car wash'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN r
LIMIT 5","match
$r isa review, has text $t;
$t like "".*car wash.*"";
limit 5;
fetch {
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date,
  ""review_id"": $r.review_id
};"
423,Which 3 businesses have a review mentioning 'selection of books'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'selection of books'
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*selection of books.*"";
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $b.name
};"
424,Show the first 3 businesses reviewed by 'Jenny' in 2017.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2017-01-01') AND r.date < date('2018-01-01')
RETURN b.name, b.address, r.date
ORDER BY r.date
LIMIT 3","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
$r has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2017-01-01T00:00:00;
$d < 2018-01-01T00:00:00;
sort $d;
limit 3;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""date"": $d
};"
425,What are the names of 3 businesses with reviews from 'Angie' with at least 4 stars?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars >= 4.0
RETURN b.name
LIMIT 3","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
$r isa review, has stars $s;
$s >= 4.0;
reviews (review: $r, reviewed_business: $b);
$b isa business;
limit 3;
fetch {
  ""name"": $b.name
};"
426,List the top 5 businesses by the number of reviews they received in 2017.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
WITH b, count(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 5
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2017-01-01T00:00:00;
$d <= 2017-12-31T23:59:59;
reduce $count = count($r) groupby $b;
sort $count desc;
limit 5;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
427,Show the names of 3 businesses where reviews mention 'sandwich'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN b.name
LIMIT 3","match
$b isa business;
$r isa review, has text $t;
$t like "".*sandwich.*"";
reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $b.name
};"
428,Which 3 businesses have reviews mentioning 'Awesome service'?,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'Awesome service'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$r isa review, has text $t;
$t like "".*Awesome service.*"";
$b isa business;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
429,List the first 3 businesses in 'San Mateo' that have been reviewed.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo'
RETURN b.name, b.address, b.city, b.state, b.businessId
LIMIT 3","match
  $b isa business, has city ""San Mateo"", has name $name, has address $addr, has city $c, has state $s, has business_id $bid;
  reviews (reviewed_business: $b, review: $r);
limit 3;
fetch {
  ""name"": $name,
  ""address"": $addr,
  ""city"": $c,
  ""state"": $s,
  ""businessId"": $bid
};"
431,Show the first 5 reviews with a star rating below 4.0.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 4.0
RETURN r.reviewId, r.text, r.stars, b.name
ORDER BY r.date
LIMIT 5","match
$r isa review, has stars $s, has date $d;
$s < 4.0;
reviews (review: $r, reviewed_business: $b);
$b isa business;
sort $d;
limit 5;
fetch {
  ""reviewId"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $s,
  ""businessName"": $b.name
};"
432,What are the first 3 reviews mentioning 'Farmer's Market'?,"MATCH (r:Review)
WHERE r.text CONTAINS ""Farmer's Market""
RETURN r
ORDER BY r.date
LIMIT 3","match
$r isa review, has text $t, has date $d;
$t like "".*Farmer's Market.*"";
sort $d;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
433,Which businesses have reviews written in September of any year?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date STARTS WITH '2015-09' OR r.date STARTS WITH '2016-09' OR r.date STARTS WITH '2017-09' OR r.date STARTS WITH '2018-09'
RETURN DISTINCT b.name","match
$b isa business, has name $n;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
{ $d >= 2015-09-01T00:00:00 ; $d < 2015-10-01T00:00:00; }
or { $d >= 2016-09-01T00:00:00 ; $d < 2016-10-01T00:00:00; }
or { $d >= 2017-09-01T00:00:00 ; $d < 2017-10-01T00:00:00; }
or { $d >= 2018-09-01T00:00:00 ; $d < 2018-10-01T00:00:00; };
select $n;
distinct;
fetch { ""name"": $n };"
434,List the top 5 businesses located in Missoula.,"MATCH (b:Business {city: 'Missoula'})
RETURN b.name, b.address, b.city, b.state
ORDER BY b.name
LIMIT 5","match
$b isa business, has city ""Missoula"", has name $n;
sort $n asc;
limit 5;
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
435,List all business names and their categories located in 'CA'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN b.name AS businessName, c.name AS category","match
$b isa business, has state ""CA"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""category"": $c.name
};"
436,What are the exact addresses of businesses categorized as 'Coffee' in 'Burlingame'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE c.name = 'Coffee' AND b.city = 'Burlingame'
RETURN b.address","match
$b isa business, has city ""Burlingame"";
$c isa category, has name ""Coffee"";
in_category (business: $b, category: $c);
fetch {
  ""address"": $b.address
};"
437,Which businesses have reviews from more than one user?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, COUNT(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b.name AS businessName","match
$b isa business;
$r isa review;
$u isa user;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
select $b, $u;
distinct;
reduce $count = count($u) groupby $b;
match
$count > 1;
fetch {
  ""businessName"": $b.name
};"
438,List the reviews mentioning 'selection' and their corresponding businesses.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'selection'
RETURN r.text AS reviewText, b.name AS businessName","match
$r isa review, has text $t;
$t like "".*selection.*"";
$b isa business;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""reviewText"": $r.text,
  ""businessName"": $b.name
};"
439,What are the names of businesses in 'San Mateo' and their addresses?,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has city ""San Mateo"", has name $name, has address $addr;
fetch {
  ""businessName"": $name,
  ""businessAddress"": $addr
};"
440,Give the review texts for businesses reviewed on '2017-05-03'.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2017-05-03')
RETURN r.text","match
$r isa review, has date 2017-05-03T00:00:00, has text $t;
$b isa business;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""text"": $t
};"
441,Which businesses in 'CA' have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS businessName","match
$u isa user, has name ""Jenny"";
$r isa review;
$b isa business, has state ""CA"", has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch { ""businessName"": $bn };"
442,What are the names of businesses and their states for those located on '1st St W'?,"MATCH (b:Business)
WHERE b.address CONTAINS '1st St W'
RETURN b.name AS businessName, b.state AS state","match
$b isa business, has address $addr;
$addr like "".*1st St W.*"";
fetch {
  ""businessName"": $b.name,
  ""state"": $b.state
};"
443,List all the business names and review dates for businesses in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN b.name AS businessName, r.date AS reviewDate","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has date $rd;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn,
  ""reviewDate"": $rd
};"
444,Which businesses have reviews mentioning 'sandwich'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*sandwich.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
445,What are the categories of businesses at '200 W Pine St'?,"MATCH (b:Business {address: '200 W Pine St'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category","match
  $b isa business, has address ""200 W Pine St"";
  in_category (business: $b, category: $c);
fetch {
  ""category"": $c.name
};"
446,Who wrote the review for 'Hanabi' and what was the star rating?,"MATCH (b:Business {name: 'Hanabi'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name AS reviewer, r.stars AS starRating","match
$b isa business, has name ""Hanabi"";
reviews (reviewed_business: $b, review: $r);
$r isa review, has stars $s;
wrote (author: $u, review: $r);
$u isa user, has name $n;
fetch {
  ""reviewer"": $n,
  ""starRating"": $s
};"
447,Which businesses in 'MT' have reviews written in 2016?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'MT' AND r.date >= date('2016-01-01') AND r.date <= date('2016-12-31')
RETURN b.name","match
$b isa business, has state ""MT"", has name $n;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2016-01-01T00:00:00;
$d <= 2016-12-31T23:59:59;
fetch {
  ""name"": $n
};"
448,List the businesses on 'E 5th Ave' and their review texts.,"MATCH (b:Business {address: '111 E 5th Ave'})&lt;-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has address $addr, has name $bname;
$addr like "".*E 5th Ave.*"";
$r isa review, has text $rt;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $bname,
  ""reviewText"": $rt
};"
449,What are the business names in 'Missoula' categorized under 'Brewery'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND c.name = 'Brewery'
RETURN b.name","match
$b isa business, has city ""Missoula"", has name $n;
$c isa category, has name ""Brewery"";
in_category (business: $b, category: $c);
fetch {
  ""name"": $n
};"
450,Which business on 'California Dr' has the highest number of reviews?,"MATCH (b:Business {address: '723 California Dr'})<-[:REVIEWS]-(r:Review)
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$b isa business, has address $addr, has name $name;
$addr like "".*California Dr.*"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $name;
sort $count desc;
limit 1;
fetch { ""name"": $name, ""reviewCount"": $count };"
451,List the businesses located at '716 N San Mateo Dr' and their categories.,"MATCH (b:Business {address: '716 N San Mateo Dr'})-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address ""716 N San Mateo Dr"", has name $bn;
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
452,What are the review texts for businesses rated exactly 3 stars?,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 3.0
RETURN r.text","match
$r isa review, has stars 3.0, has text $t;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""text"": $t
};"
453,Which reviews were written by 'Will'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
$r isa review;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
454,What are the businesses reviewed on '2018-09-10' and who wrote the reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date = date('2018-09-10')
RETURN b.name AS businessName, u.name AS userName","match
  $u isa user;
  $r isa review, has date $d;
  $d == 2018-09-10T00:00:00;
  $b isa business;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""userName"": $u.name
};"
455,List the businesses in 'San Mateo' along with their review stars.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo'
RETURN b.name AS businessName, r.stars AS reviewStars","match
$b isa business, has city ""San Mateo"", has name $name;
$r isa review, has stars $stars;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $name,
  ""reviewStars"": $stars
};"
456,What are the names of users who wrote reviews in '2016'?,"MATCH (u:User)-[:WROTE]->(r:Review)
WHERE r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN u.name","match
$u isa user;
$r isa review, has date $d;
wrote (author: $u, review: $r);
$d >= 2016-01-01T00:00:00;
$d < 2017-01-01T00:00:00;
fetch {
  ""name"": $u.name
};"
457,Which businesses have a library category and are located in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE c.name = 'Library' AND b.state = 'CA'
RETURN b.name AS BusinessName, b.address AS Address, b.city AS City","match
$b isa business, has state ""CA"";
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""BusinessName"": $b.name,
  ""Address"": $b.address,
  ""City"": $b.city
};"
458,List the business addresses and their user reviews in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b), (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame'
RETURN b.address AS businessAddress, r.text AS reviewText, u.name AS userName","match
$b isa business, has city ""Burlingame"", has address $addr;
$r isa review, has text $rt;
$u isa user, has name $un;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
fetch {
  ""businessAddress"": $addr,
  ""reviewText"": $rt,
  ""userName"": $un
};"
459,What categories does 'Zootown Brew' belong to and what are the reviews?,"MATCH (b:Business {name: 'Zootown Brew'})-[:IN_CATEGORY]->(c:Category)
OPTIONAL MATCH (r:Review)-[:REVIEWS]->(b)
RETURN c.name AS Category, r.text AS Review","match
$b isa business, has name ""Zootown Brew"";
in_category (business: $b, category: $c);
try {
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
  $r has text $review_text;
};
fetch {
  ""Category"": $c.name,
  ""Review"": $review_text
};"
461,Who are the users that have reviewed 'Imagine Nation Brewing'?,"MATCH (b:Business {name: 'Imagine Nation Brewing'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN u.name AS userName","match
$b isa business, has name ""Imagine Nation Brewing"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u isa user;
fetch {
  ""userName"": $u.name
};"
462,Which businesses in 'Missoula' have reviews mentioning 'IPA'?,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name","match
$b isa business, has city ""Missoula"";
reviews (reviewed_business: $b, review: $r);
$r isa review, has text $t;
$t like "".*IPA.*"";
fetch {
  ""name"": $b.name
};"
463,List the business names and their review stars for businesses on 'Main St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'Main St'
RETURN b.name AS businessName, r.stars AS reviewStars","match
$b isa business, has address $addr, has name $bname;
$addr like "".*Main St.*"";
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bname,
  ""reviewStars"": $s
};"
464,What is the category of the business located at '1151 W Broadway St'?,"MATCH (b:Business {address: '1151 W Broadway St'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category","match
$b isa business, has address ""1151 W Broadway St"";
in_category (business: $b, category: $c);
fetch {
  ""category"": $c.name
};"
465,How many reviews have been written for businesses in 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'San Mateo'
RETURN count(r) AS numberOfReviews","match
  $b isa business, has city ""San Mateo"";
  reviews (review: $r, reviewed_business: $b);
reduce $count = count($r);"
466,Which business located at '723 California Dr' has been reviewed?,"MATCH (b:Business {address: '723 California Dr'})<-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName","match
$b isa business, has address ""723 California Dr"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $b.name
};"
467,What are the names and addresses of businesses located in 'MT'?,"MATCH (b:Business)
WHERE b.state = 'MT'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has state ""MT"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
468,List all users who have written a review in September 2018.,"MATCH (u:User)-[:WROTE]->(r:Review)
WHERE r.date >= date(""2018-09-01"") AND r.date <= date(""2018-09-30"")
RETURN u.name","match
$u isa user;
$r isa review, has date $d;
wrote (author: $u, review: $r);
$d >= 2018-09-01T00:00:00;
$d <= 2018-09-30T23:59:59;
fetch {
  ""name"": $u.name
};"
469,What are the business names and categories for businesses on 'Pine St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Pine St'
RETURN b.name AS businessName, c.name AS category","match
$b isa business, has address $addr;
$addr like "".*Pine St.*"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""category"": $c.name
};"
470,Which reviews were written before 2017?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date < date('2017-01-01')
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.date AS reviewDate, r.stars AS stars, u.name AS userName, b.name AS businessName","match
$u isa user, has name $uname;
$r isa review, has review_id $rid, has text $rtext, has date $rdate, has stars $rstars;
$b isa business, has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$rdate < 2017-01-01T00:00:00;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $rtext,
  ""reviewDate"": $rdate,
  ""stars"": $rstars,
  ""userName"": $uname,
  ""businessName"": $bname
};"
471,What are the names of businesses with a review that mentions 'breakfast'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*breakfast.*"";
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
472,What is the state of the business named 'Market on Front'?,"MATCH (b:Business {name: 'Market on Front'})
RETURN b.state AS state","match
$b isa business, has name ""Market on Front"";
fetch {
  ""state"": $b.state
};"
473,How many businesses are there in each city listed in the schema?,"MATCH (b:Business)
RETURN b.city AS city, COUNT(b) AS numberOfBusinesses
ORDER BY city","match
$b isa business, has city $city;
reduce $count = count($b) groupby $city;
sort $city asc;"
474,Which user wrote a review for 'Missoula Public Library'?,"MATCH (b:Business {name: 'Missoula Public Library'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN u.name AS userName","match
$b isa business, has name ""Missoula Public Library"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""userName"": $u.name
};"
475,Name all businesses that have a review mentioning 'IPA'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*IPA.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
476,Which businesses have been reviewed by users named 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
477,Which businesses are located at '716 N San Mateo Dr'?,"MATCH (b:Business {address: '716 N San Mateo Dr'})
RETURN b.name","match
$b isa business, has address ""716 N San Mateo Dr"";
fetch {
  ""name"": $b.name
};"
478,List the businesses and their review text for reviews with more than 4.5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars > 4.5
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business;
$r isa review, has stars $s, has text $t;
reviews (reviewed_business: $b, review: $r);
$s > 4.5;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $t
};"
479,What is the location point of 'Ninja Mike's'?,"MATCH (b:Business {name: ""Ninja Mike's""})
RETURN b.location","match
$b isa business, has name ""Ninja Mike's"";
fetch {
  ""location"": $b.location
};"
480,Who wrote the review with the highest star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, r
ORDER BY r.stars DESC
LIMIT 1
RETURN u.name AS reviewer","match
$u isa user, has name $name;
$r isa review, has stars $s;
wrote (author: $u, review: $r);
sort $s desc;
limit 1;
fetch { ""reviewer"": $name };"
481,List the reviews written by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
$r isa review;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
482,What are the names of businesses located on 'Broadway St' and their categories?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address $addr, has name $bn;
$addr like "".*Broadway St.*"";
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
483,Which businesses in 'Missoula' have a review with exactly 5 stars?,"MATCH (b:Business {city: 'Missoula'})&lt;-[:REVIEWS]-(r:Review {stars: 5.0})
RETURN b.name","match
  $b isa business, has city ""Missoula"";
  $r isa review, has stars 5.0;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
484,Which reviews discuss 'car wash'?,"MATCH (r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN r","match
$r isa review, has text $t;
$t like "".*car wash.*"";
fetch {
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id,
  ""date"": $r.date
};"
485,How many different categories are there for businesses in 'CA'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN COUNT(DISTINCT c.name) AS numberOfCategories","match
$b isa business, has state ""CA"";
$c isa category, has name $cn;
in_category (business: $b, category: $c);
select $cn;
distinct;
reduce $count = count;"
486,What are the names of businesses with reviews written in August 2018?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2018-08-01') AND r.date < date('2018-09-01')
RETURN b.name","match
$u isa user;
$r isa review, has date $d;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$d >= 2018-08-01T00:00:00;
$d < 2018-09-01T00:00:00;
fetch {
  ""name"": $b.name
};"
487,What are the names of businesses located at '301 E Main St' and their review dates?,"MATCH (b:Business {address: '301 E Main St'})<-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.date AS reviewDate","match
$b isa business, has address ""301 E Main St"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $r.date
};"
488,Which user has reviewed businesses in both 'Missoula' and 'San Mateo'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city IN ['Missoula', 'San Mateo']
WITH u, COLLECT(DISTINCT b.city) AS cities
WHERE 'Missoula' IN cities AND 'San Mateo' IN cities
RETURN u.name","match
$u isa user;
$r1 isa review;
$r2 isa review;
$b1 isa business, has city ""Missoula"";
$b2 isa business, has city ""San Mateo"";
wrote (author: $u, review: $r1);
reviews (review: $r1, reviewed_business: $b1);
wrote (author: $u, review: $r2);
reviews (review: $r2, reviewed_business: $b2);
fetch {
  ""name"": $u.name
};"
489,List the reviews mentioning 'world leading' and the businesses they review.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS ""world leading""
RETURN r.text AS reviewText, b.name AS businessName","match
$r isa review, has text $t;
$t like "".*world leading.*"";
$b isa business, has name $bn;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""reviewText"": $t,
  ""businessName"": $bn
};"
490,Which categories have more than one business in Missoula?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
WITH c, COUNT(b) AS businessCount
WHERE businessCount > 1
RETURN c.name AS category, businessCount","match
$b isa business, has city ""Missoula"";
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($b) groupby $c;
match $count > 1;
fetch { ""category"": $c.name, ""businessCount"": $count };"
491,List the names of businesses and their cities with reviews rating exactly 4.0.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 4.0
RETURN b.name AS businessName, b.city AS city","match
$b isa business;
$r isa review, has stars 4.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""city"": $b.city
};"
492,List the reviews and their business names for businesses on 'Pine St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'Pine St'
RETURN r.text AS review, b.name AS business_name","match
$b isa business, has address $addr, has name $bn;
$addr like "".*Pine St.*"";
$r isa review, has text $rt;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""review"": $rt,
  ""business_name"": $bn
};"
493,Who wrote the most recent review and for which business?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN u.name AS userName, b.name AS businessName, r.date AS reviewDate
ORDER BY r.date DESC
LIMIT 1","match
$u isa user, has name $un;
$r isa review, has date $d;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $d desc;
limit 1;
fetch {
  ""userName"": $un,
  ""businessName"": $bn,
  ""reviewDate"": $d
};"
494,List the users who have written reviews for businesses in 'San Mateo'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'San Mateo'
RETURN DISTINCT u.name","match
$u isa user;
$r isa review;
$b isa business, has city ""San Mateo"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$u has name $name;
select $name;
distinct;
fetch { ""name"": $name };"
495,Find all reviews for 'Imagine Nation Brewing' and their corresponding stars.,"MATCH (b:Business {name: 'Imagine Nation Brewing'})&lt;-[:REVIEWS]-(r:Review)
RETURN r.text AS reviewText, r.stars AS reviewStars","match
$b isa business, has name ""Imagine Nation Brewing"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""reviewText"": $r.text,
  ""reviewStars"": $r.stars
};"
496,Which user has reviewed 'Zootown Brew' and what was the star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {name: 'Zootown Brew'})
RETURN u.name AS userName, r.stars AS starRating","match
$u isa user;
$r isa review;
$b isa business, has name ""Zootown Brew"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""userName"": $u.name,
  ""starRating"": $r.stars
};"
497,Display all businesses reviewed by 'Will' and their locations.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, b.address AS address, b.city AS city, b.state AS state","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
498,List all categories available for businesses in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN DISTINCT c.name AS category","match
$b isa business, has city ""Burlingame"";
$c isa category;
in_category (business: $b, category: $c);
select $c;
distinct;
fetch {
  ""category"": $c.name
};"
499,Show the reviews and their dates for businesses located on 'W Broadway St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'W Broadway St'
RETURN r.text AS review, r.date AS date","match
$b isa business, has address $addr;
$addr like "".*W Broadway St.*"";
$r isa review, has text $text, has date $d;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""review"": $text,
  ""date"": $d
};"
500,What are the business names and addresses for all businesses in 'CA'?,"MATCH (b:Business)
WHERE b.state = 'CA'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has state ""CA"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
501,Find the names and review texts of businesses with a rating less than 4.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 4.0
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
$s < 4.0;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
502,Which businesses have reviews written in 2016 and are located in 'CA'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA' AND r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN DISTINCT b.name","match
  $b isa business, has state ""CA"", has name $name;
  $r isa review, has date $d;
  reviews (reviewed_business: $b, review: $r);
  $d >= 2016-01-01T00:00:00;
  $d < 2017-01-01T00:00:00;
select $b, $name;
distinct;
fetch {
  ""name"": $name
};"
503,List the businesses named 'Neo4j' and their reviews.,"MATCH (b:Business {name: 'Neo4j'})-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
$b isa business, has name ""Neo4j"";
$r isa review, has text $text, has stars $stars, has date $date;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $text,
  ""reviewStars"": $stars,
  ""reviewDate"": $date
};"
504,Display the names of users who have written reviews for 'Coffee' category businesses.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'}),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
RETURN DISTINCT u.name","match
  $b isa business;
  $c isa category, has name ""Coffee"";
  in_category (business: $b, category: $c);
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
  $u isa user;
  wrote (author: $u, review: $r);
select $u;
distinct;
fetch {
  ""name"": $u.name
};"
505,Which businesses in 'Burlingame' have been reviewed by users with names starting with 'A'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'Burlingame' AND u.name STARTS WITH 'A'
RETURN b.name AS BusinessName","match
$u isa user, has name $un;
$un like ""A.*"";
$r isa review;
$b isa business, has city ""Burlingame"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""BusinessName"": $b.name
};"
506,Show the reviews and stars for businesses located on 'E Front St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'E Front St'
RETURN r.text AS review, r.stars AS stars","match
$b isa business, has address $addr;
$addr like "".*E Front St.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""review"": $r.text,
  ""stars"": $r.stars
};"
507,Find businesses with names containing 'Brew' and their review texts.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.name CONTAINS 'Brew'
RETURN b.name AS businessName, r.text AS reviewText","match
  $b isa business, has name $bn;
  $bn like "".*Brew.*"";
  $r isa review, has text $rt;
  reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt
};"
508,List all the reviews with a date in 2017 for businesses in 'Missoula'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Missoula' AND r.date >= date('2017-01-01') AND r.date < date('2018-01-01')
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.date AS reviewDate, r.stars AS reviewStars, b.name AS businessName, u.name AS userName","match
$b isa business, has city ""Missoula"", has name $bn;
$r isa review, has review_id $rid, has text $rt, has date $rd, has stars $rs;
$u isa user, has name $un;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$rd >= 2017-01-01T00:00:00 ; $rd < 2018-01-01T00:00:00 ;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $rt,
  ""reviewDate"": $rd,
  ""reviewStars"": $rs,
  ""businessName"": $bn,
  ""userName"": $un
};"
509,Which businesses are located at '716 N San Mateo Dr' and what are their categories?,"MATCH (b:Business {address: '716 N San Mateo Dr'})-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address ""716 N San Mateo Dr"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
510,Display all businesses in 'CA' that have been reviewed by 'Jenny' and show their review texts.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS businessName, r.text AS reviewText","match
  $u isa user, has name ""Jenny"";
  $b isa business, has state ""CA"";
  $r isa review;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
511,What are the names of all businesses that have been reviewed and are located in 'MT'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category)
WHERE b.state = 'MT'
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN DISTINCT b.name AS businessName","match
$b isa business, has state ""MT"", has name $n;
reviews (review: $r, reviewed_business: $b);
select $n;
distinct;
fetch { ""businessName"": $n };"
512,Find businesses with the name 'KettleHouse Brewing Co.' and their categories.,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has name ""KettleHouse Brewing Co."";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
514,Which users have written reviews for businesses in the 'Library' category?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN u.name AS userName","match
  $u isa user;
  $r isa review;
  $b isa business;
  $c isa category, has name ""Library"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  in_category (business: $b, category: $c);
fetch {
  ""userName"": $u.name
};"
515,Find the businesses in 'San Mateo' with reviews mentioning 'car wash'.,"MATCH (b:Business {city: 'San Mateo'})<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN b.name, b.address","match
  $b isa business, has city ""San Mateo"";
  reviews (reviewed_business: $b, review: $r);
  $r has text $t;
  $t like "".*car wash.*"";
fetch {
  ""name"": $b.name,
  ""address"": $b.address
};"
516,List all businesses in 'Missoula' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has city ""Missoula"", has name $bn;
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
517,Which businesses have been reviewed by 'Will' and are located in 'CA'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'CA'})
RETURN b.name AS businessName","match
$u isa user, has name ""Will"";
$b isa business, has state ""CA"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
518,Display the reviews and their texts for businesses on '1st St W'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS '1st St W'
RETURN r.reviewId, r.text","match
  $b isa business, has address $addr;
  $addr like "".*1st St W.*"";
  $r isa review, has review_id $rid, has text $t;
  reviews (reviewed_business: $b, review: $r);
fetch {
  ""reviewId"": $rid,
  ""text"": $t
};"
519,Which businesses in 'Missoula' have an address starting with '2'?,"MATCH (b:Business)
WHERE b.city = 'Missoula' AND b.address STARTS WITH '2'
RETURN b.name, b.address","match
$b isa business, has city ""Missoula"", has address $addr;
$addr like ""^2.*"";
fetch {
  ""name"": $b.name,
  ""address"": $addr
};"
520,What are the business names and their locations for businesses reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, b.location AS businessLocation","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""businessLocation"": $b.location
};"
521,Show businesses that are both in 'Beer' and 'Coffee' categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c1:Category {name: 'Beer'}),
      (b)-[:IN_CATEGORY]->(c2:Category {name: 'Coffee'})
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState","match
$b isa business;
$c1 isa category, has name ""Beer"";
$c2 isa category, has name ""Coffee"";
in_category (business: $b, category: $c1);
in_category (business: $b, category: $c2);
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
522,Display the top 5 businesses with the highest average review rating.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN b.name AS businessName, avgRating","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 5;
fetch { ""businessName"": $b.name, ""avgRating"": $avg };"
523,What are the review texts and dates for businesses on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'Broadway St'
RETURN r.text AS reviewText, r.date AS reviewDate","match
  $b isa business, has address $addr;
  $addr like "".*Broadway St.*"";
  $r isa review, has text $text, has date $d;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""reviewText"": $text,
  ""reviewDate"": $d
};"
524,Who wrote reviews for businesses with addresses on 'Main St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.address CONTAINS 'Main St'
RETURN DISTINCT u.name","match
$b isa business, has address $addr;
$addr like "".*Main St.*"";
in_category (business: $b, category: $c);
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u isa user;
select $u;
distinct;
fetch {
  ""name"": $u.name
};"
525,What are the businesses in 'MT' reviewed by users named 'Bob'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {state: 'MT'})
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity","match
  $u isa user, has name ""Bob"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $b isa business, has state ""MT"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city
};"
526,What are the names of businesses and their review stars located on '1st St W'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS '1st St W'
RETURN b.name AS businessName, r.stars AS reviewStars","match
$b isa business, has address $addr, has name $name;
$addr like "".*1st St W.*"";
$r isa review, has stars $stars;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $name,
  ""reviewStars"": $stars
};"
527,Which businesses in 'CA' have reviews mentioning 'great'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.state = 'CA' AND r.text CONTAINS 'great'
RETURN b.name AS businessName, b.address AS businessAddress, r.text AS reviewText","match
$b isa business, has state ""CA"", has name $bn, has address $ba;
$r isa review, has text $rt;
$rt like "".*great.*"";
in_category (business: $b, category: $c);
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba,
  ""reviewText"": $rt
};"
528,What are the names and categories of businesses at '313 N 1st St W'?,"MATCH (b:Business {address: '313 N 1st St W'})-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address ""313 N 1st St W"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
529,Who wrote the review for 'Neo4j' and what was the star rating?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name AS reviewer, r.stars AS starRating","match
$b isa business, has name ""Neo4j"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u has name $reviewer;
$r has stars $star_rating;
fetch {
  ""reviewer"": $reviewer,
  ""starRating"": $star_rating
};"
530,What are the review texts for the businesses with the lowest star ratings?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r
ORDER BY r.stars ASC
LIMIT 1
RETURN r.text AS reviewText","match
$b isa business;
$r isa review, has stars $s, has text $t;
reviews (reviewed_business: $b, review: $r);
sort $s asc;
limit 1;
fetch {
  ""reviewText"": $t
};"
531,List the businesses on 'Front St' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Front St'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has address $a;
$a like "".*Front St.*"";
in_category (business: $b, category: $c);
$c isa category;
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
533,List the names of all businesses located in 'Missoula'.,"MATCH (b:Business {city: 'Missoula'})
RETURN b.name","match
$b isa business, has city ""Missoula"";
fetch {
  ""name"": $b.name
};"
534,Which businesses have a 'Beer' category in their classification?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
RETURN b.name AS businessName","match
$b isa business;
$c isa category, has name ""Beer"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name
};"
535,Find all users who have written a review with a 5-star rating.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5.0
RETURN u.name","match
$u isa user;
$r isa review, has stars 5.0;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""name"": $u.name
};"
536,Show all businesses located at '301 E Main St'.,"MATCH (b:Business {address: '301 E Main St'})
RETURN b.name, b.address, b.city, b.state, b.businessId","match
$b isa business, has address ""301 E Main St"";
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state,
  ""businessId"": $b.business_id
};"
537,What are the names of businesses that have received reviews with a rating of 4 or higher?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4.0
RETURN DISTINCT b.name AS businessName","match
$b isa business;
$r isa review, has stars $s;
$s >= 4.0;
reviews (review: $r, reviewed_business: $b);
select $b;
distinct;
fetch {
  ""businessName"": $b.name
};"
538,Display the names and cities of businesses that are in the 'Library' category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name AS businessName, b.city AS city","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""city"": $b.city
};"
539,Which businesses in 'San Mateo' are reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name","match
  $u isa user, has name ""Jenny"";
  $b isa business, has city ""San Mateo"";
  $r isa review;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
540,Identify all reviews written by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
$r isa review;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
541,Find the names of businesses that are located in 'CA' and have been reviewed.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'CA'
RETURN DISTINCT b.name","match
$b isa business, has state ""CA"", has name $n;
reviews (review: $r, reviewed_business: $b);
select $n;
distinct;
fetch { ""name"": $n };"
542,List the names of businesses along with their categories located in 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has city ""Burlingame"", has name $bn;
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""categoryName"": $cn
};"
543,Which users have reviewed businesses located at '1151 W Broadway St'?,"MATCH (b:Business {address: '1151 W Broadway St'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has address ""1151 W Broadway St"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
fetch {
  ""name"": $u.name
};"
544,Show the businesses that have the highest number of reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
545,Find businesses in 'Missoula' with reviews dated after 2017-01-01.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula' AND r.date > date('2017-01-01')
RETURN b.name AS businessName, b.address AS businessAddress, r.date AS reviewDate","match
$b isa business, has city ""Missoula"", has name $bn, has address $ba;
$r isa review, has date $rd;
reviews (review: $r, reviewed_business: $b);
$rd > 2017-01-01T00:00:00;
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba,
  ""reviewDate"": $rd
};"
546,List the names of businesses along with their reviews and ratings.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS rating","match
$b isa business;
$r isa review;
$u isa user;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text,
  ""rating"": $r.stars
};"
547,Which businesses are categorized under 'Coffee' and have reviews with text mentioning 'best'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'}),
      (r:Review)-[:REVIEWS]->(b)
WHERE r.text CONTAINS 'best'
RETURN b.name","match
  $b isa business;
  $c isa category, has name ""Coffee"";
  in_category (business: $b, category: $c);
  $r isa review, has text $t;
  $t like "".*best.*"";
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
548,Identify the businesses reviewed by 'Angie' and list the corresponding review texts.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, r.text AS reviewText","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$r has text $rt;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $rt
};"
549,What are the business names and categories for all businesses in 'Missoula' that are located on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND b.address CONTAINS 'Broadway St'
RETURN b.name AS businessName, c.name AS category","match
$b isa business, has city ""Missoula"", has address $addr, has name $bn;
$addr like "".*Broadway St.*"";
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""category"": $cn
};"
550,Which reviews mention 'great selection'?,"MATCH (r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN r.reviewId, r.text","match
$r isa review, has text $t, has review_id $rid;
$t like "".*great selection.*"";
fetch {
  ""reviewId"": $r.review_id,
  ""text"": $r.text
};"
551,Which businesses have reviews written on '2016-11-21'?,"MATCH (u:User)-[:WROTE]->(r:Review {date: date('2016-11-21')})-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$b isa business, has name $bn;
$r isa review, has date 2016-11-21T00:00:00;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bn
};"
552,List businesses that have been reviewed in the last quarter of 2017.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date(""2017-10-01"") AND r.date <= date(""2017-12-31"")
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2017-10-01T00:00:00;
$d <= 2017-12-31T23:59:59;
select $b;
distinct;
fetch { ""name"": $b.name };"
553,What is the average number of reviews per user?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviews_per_user
RETURN AVG(reviews_per_user) AS average_reviews_per_user","match
$u isa user;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
reduce $avg = mean($count);"
554,Which reviews contain the word 'selection' in their text?,"MATCH (r:Review)
WHERE r.text CONTAINS 'selection'
RETURN r.reviewId, r.text","match
$r isa review, has review_id $rid, has text $t;
$t like "".*selection.*"";
fetch {
  ""reviewId"": $rid,
  ""text"": $t
};"
555,Find the business with the highest number of categories in 'San Mateo'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
WITH b, count(c) as categoryCount
ORDER BY categoryCount DESC
LIMIT 1
RETURN b.name as businessName, categoryCount","match
$b isa business, has city ""San Mateo"";
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
sort $count desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""categoryCount"": $count
};"
556,List the businesses along with their review dates that have been reviewed by 'Will'.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, r.date AS reviewDate","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$r has date $d;
fetch {
  ""businessName"": $b.name,
  ""reviewDate"": $d
};"
557,What are the different categories of businesses that 'Angie' has reviewed?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name AS categories","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$c has name $cat_name;
select $cat_name;
distinct;
fetch { ""categories"": $cat_name };"
558,How many users have reviewed businesses in 'Burlingame'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Burlingame'})
RETURN COUNT(DISTINCT u) AS numberOfUsers","match
$u isa user;
$r isa review;
$b isa business, has city ""Burlingame"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($u);"
559,Which business in 'Missoula' has received the most 5-star reviews?,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review {stars: 5.0})
RETURN b.name, COUNT(r) AS five_star_reviews
ORDER BY five_star_reviews DESC
LIMIT 1","match
$b isa business, has city ""Missoula"", has name $n;
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $n;
sort $count desc;
limit 1;
fetch { ""name"": $n, ""five_star_reviews"": $count };"
560,List the businesses that have been reviewed by exactly two different users.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, COUNT(DISTINCT u) AS userCount
WHERE userCount = 2
RETURN b.name AS businessName","match
$b isa business;
$r isa review;
$u isa user;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
select $b, $u;
distinct;
reduce $count = count($u) groupby $b;
match
$count == 2;
fetch {
  ""businessName"": $b.name
};"
561,Which users have reviewed the business located at '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})&lt;-[:REVIEWS]-(r:Review)&lt;-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has address ""301 E Main St"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
$u isa user;
fetch {
  ""name"": $u.name
};"
562,What are the review texts for 'Zootown Brew' and who wrote them?,"MATCH (b:Business {name: 'Zootown Brew'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN r.text AS reviewText, u.name AS userName","match
$b isa business, has name ""Zootown Brew"";
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""reviewText"": $r.text,
  ""userName"": $u.name
};"
563,Which business has the earliest review date in the database?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
RETURN b.name AS business, r.date AS reviewDate
ORDER BY r.date ASC
LIMIT 1","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
sort $d asc;
limit 1;
fetch {
  ""business"": $b.name,
  ""reviewDate"": $d
};"
564,List the businesses reviewed by 'Bob' and the corresponding categories of these businesses.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN b.name AS BusinessName, c.name AS CategoryName","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$b has name $bn;
$c has name $cn;
fetch {
  ""BusinessName"": $bn,
  ""CategoryName"": $cn
};"
565,Which businesses have a review with stars greater than the average stars of all reviews?,"// First, calculate the average stars of all reviews
MATCH (r:Review)
WITH avg(r.stars) AS avgStars

// Then, find businesses that have reviews with stars greater than the average
MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars > avgStars
RETURN DISTINCT b.name AS businessName","with fun avg_stars() -> double:
  match $r isa review, has stars $s;
  return mean($s);
match
  $b isa business;
  $rev isa review, has stars $s;
  reviews (review: $rev, reviewed_business: $b);
let $avg = avg_stars();
match $s > $avg;
select $b;
distinct;
fetch { ""businessName"": $b.name };"
566,Show businesses that have been reviewed only once and the reviewers' names.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, COUNT(r) AS reviewCount, COLLECT(u.name) AS reviewers
WHERE reviewCount = 1
RETURN b.name AS businessName, reviewers[0] AS reviewerName","match
$b isa business;
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
match $count == 1;
match
$r2 isa review;
reviews (review: $r2, reviewed_business: $b);
wrote (author: $u, review: $r2);
fetch { ""businessName"": $b.name, ""reviewerName"": $u.name };"
567,Who reviewed 'Imagine Nation Brewing' and what was the star rating?,"MATCH (b:Business {name: 'Imagine Nation Brewing'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name AS reviewer, r.stars AS star_rating","match
$b isa business, has name ""Imagine Nation Brewing"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""reviewer"": $u.name,
  ""star_rating"": $r.stars
};"
568,List the top 3 businesses in 'Missoula' based on the number of reviews.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","match
$b isa business, has city ""Missoula"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
569,List the businesses and their review counts in descending order of reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, count(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
570,Which businesses have reviews that mention 'breakfast'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*breakfast.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
571,Can you find reviews that were written on '2017-05-21'?,"MATCH (u:User)-[:WROTE]->(r:Review {date: date('2017-05-21')})-[:REVIEWS]->(b:Business)
RETURN u.name AS userName, r.text AS reviewText, r.stars AS reviewStars, b.name AS businessName","match
$u isa user, has name $uname;
$r isa review, has date $d, has text $rtext, has stars $rstars;
$d == 2017-05-21T00:00:00;
$b isa business, has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""userName"": $uname,
  ""reviewText"": $rtext,
  ""reviewStars"": $rstars,
  ""businessName"": $bname
};"
572,Which user has given the highest average rating in their reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 1
RETURN u.name AS userName, avgRating","match
$u isa user;
wrote (author: $u, review: $r);
$r has stars $s;
reduce $avg = mean($s) groupby $u;
sort $avg desc;
limit 1;
fetch {
  ""userName"": $u.name,
  ""avgRating"": $avg
};"
573,List all businesses that have at least two different categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, COUNT(DISTINCT c) AS categoryCount
WHERE categoryCount >= 2
RETURN b.name AS businessName, categoryCount","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
match $count >= 2;
fetch { ""businessName"": $b.name, ""categoryCount"": $count };"
574,Which businesses have the most categories associated with them?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, count(c) as categoryCount
ORDER BY categoryCount DESC
RETURN b.name AS businessName, categoryCount
LIMIT 1","match
$b isa business;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
sort $count desc;
limit 1;
fetch { ""businessName"": $b.name, ""categoryCount"": $count };"
575,Show the locations and names of businesses in 'Burlingame' with reviews rating exactly 4 stars.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category),
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'Burlingame' AND r.stars = 4.0
RETURN b.name AS businessName, b.location AS businessLocation","match
$b isa business, has city ""Burlingame"", has name $name, has location $loc;
$r isa review, has stars $s;
$s == 4.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $name,
  ""businessLocation"": $loc
};"
576,Find businesses that have been reviewed by users whose name starts with 'J'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE u.name STARTS WITH 'J'
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState","match
$u isa user, has name $uname;
$uname like ""J.*"";
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
577,Which business in 'Burlingame' has reviews mentioning 'great'?,"MATCH (b:Business {city: 'Burlingame'})<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'great'
RETURN b.name","match
$b isa business, has city ""Burlingame"";
$r isa review, has text $t;
$t like "".*great.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
578,Which categories have businesses in both 'Missoula' and 'San Mateo'?,"MATCH (b1:Business)-[:IN_CATEGORY]->(c:Category)<-[:IN_CATEGORY]-(b2:Business)
WHERE b1.city = 'Missoula' AND b2.city = 'San Mateo'
RETURN DISTINCT c.name AS category","match
$c isa category, has name $name;
$b1 isa business, has city ""Missoula"";
$b2 isa business, has city ""San Mateo"";
in_category (business: $b1, category: $c);
in_category (business: $b2, category: $c);
select $name;
distinct;
fetch { ""category"": $name };"
579,How many reviews have been written for businesses categorized under 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN count(r) AS numberOfReviews","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r);"
580,List the names of businesses that have only 4-star reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 4.0
WITH b, COUNT(r) AS reviewCount, COLLECT(r.stars) AS starRatings
WHERE ALL(star IN starRatings WHERE star = 4.0)
RETURN b.name AS businessName","match
$b isa business;
$r isa review, has stars 4.0;
reviews (review: $r, reviewed_business: $b);
not {
  $r2 isa review, has stars $s2;
  reviews (review: $r2, reviewed_business: $b);
  $s2 != 4.0;
};
fetch {
  ""businessName"": $b.name
};"
581,Which businesses have categories associated with more than one location?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH c, collect(DISTINCT b.city) AS cities, count(DISTINCT b.city) AS cityCount
WHERE cityCount > 1
MATCH (b:Business)-[:IN_CATEGORY]->(c)
RETURN DISTINCT b.name AS businessName","match
$b isa business, has city $c;
in_category (business: $b, category: $cat);
select $c, $cat;
distinct;
reduce $city_count = count($c) groupby $cat;
match $city_count > 1;
in_category (business: $b2, category: $cat);
$b2 has name $bname;
select $bname;
distinct;
fetch { ""businessName"": $bname };"
582,What are the names of businesses that have received reviews from 'Bob' and 'Angie'?,"MATCH (u1:User {name: 'Bob'})-[:WROTE]->(r1:Review)-[:REVIEWS]->(b:Business),
      (u2:User {name: 'Angie'})-[:WROTE]->(r2:Review)-[:REVIEWS]->(b)
RETURN DISTINCT b.name AS businessName","match
$u1 isa user, has name ""Bob"";
$u2 isa user, has name ""Angie"";
$b isa business, has name $bn;
$r1 isa review;
$r2 isa review;
wrote (author: $u1, review: $r1);
reviews (review: $r1, reviewed_business: $b);
wrote (author: $u2, review: $r2);
reviews (review: $r2, reviewed_business: $b);
select $b;
distinct;
fetch { ""businessName"": $b.name };"
583,List all businesses and their review stars where the review text includes 'love'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'love'
RETURN b.name AS businessName, r.stars AS reviewStars","match
$b isa business;
$r isa review, has text $t;
$t like "".*love.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $b.name,
  ""reviewStars"": $r.stars
};"
584,Which businesses in 'Missoula' have reviews mentioning 'library'?,"MATCH (b:Business {city: 'Missoula'})-[:IN_CATEGORY]->(c:Category {name: 'Library'}),
      (r:Review)-[:REVIEWS]->(b)
RETURN b.name AS businessName","match
$b isa business, has city ""Missoula"", has name $name;
in_category (business: $b, category: $c);
$c isa category, has name ""Library"";
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $name
};"
585,What is the highest number of reviews a single business has received and which business is it?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
586,List the businesses that have only received 5-star reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
WITH b, COLLECT(r) AS reviews
WHERE ALL(review IN reviews WHERE review.stars = 5.0)
RETURN b.name AS businessName","match
$b isa business;
reviews (review: $r, reviewed_business: $b);
not {
  $r2 isa review, has stars $s2;
  reviews (review: $r2, reviewed_business: $b);
  $s2 != 5.0;
};
fetch {
  ""businessName"": $b.name
};"
587,Which businesses in 'San Mateo' have reviews with text mentioning 'world'?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo' AND r.text CONTAINS 'world'
RETURN b.name","match
  $b isa business, has city ""San Mateo"", has name $n;
  $r isa review, has text $t;
  $t like "".*world.*"";
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $n
};"
588,What are the names of businesses in 'CA' that have not received any reviews?,"MATCH (b:Business {state: 'CA'})
WHERE NOT (b)<-[:REVIEWS]-(:Review)
RETURN b.name","match
$b isa business, has state ""CA"";
not { reviews (reviewed_business: $b); };
fetch { ""name"": $b.name };"
589,Which businesses have been reviewed more than once by the same user?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, b, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN b.name AS businessName, u.name AS userName, reviewCount","match
$u isa user;
$b isa business;
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $reviewCount = count($r) groupby $u, $b;
match $reviewCount > 1;
fetch {
  ""businessName"": $b.name,
  ""userName"": $u.name,
  ""reviewCount"": $reviewCount
};"
590,List the categories of businesses that have the most reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
MATCH (b)-[:IN_CATEGORY]->(c:Category)
WITH c.name AS category, COUNT(r) AS reviewCount
RETURN category, reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$b isa business;
$r isa review;
$c isa category;
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$c has name $category;
reduce $reviewCount = count($r) groupby $category;
sort $reviewCount desc;
limit 1;
fetch { ""category"": $category, ""reviewCount"": $reviewCount };"
592,Which businesses have reviews with star ratings between 3 and 4?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 3 AND r.stars <= 4
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
$s >= 3.0;
$s <= 4.0;
select $b;
distinct;
fetch {
  ""name"": $b.name
};"
593,List all the businesses in 'Burlingame' and the reviews written for them.,"MATCH (b:Business {city: 'Burlingame'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS BusinessName, r.text AS ReviewText, u.name AS UserName","match
$b isa business, has city ""Burlingame"", has name $bn;
$r isa review, has text $rt;
$u isa user, has name $un;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
fetch {
  ""BusinessName"": $bn,
  ""ReviewText"": $rt,
  ""UserName"": $un
};"
594,Which businesses have reviews mentioning 'ipa' in their text?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE toLower(r.text) CONTAINS 'ipa'
RETURN b.name","match
  $b isa business;
  $r isa review, has text $t;
  reviews (review: $r, reviewed_business: $b);
  $t like "".*[iI][pP][aA].*"";
fetch {
  ""name"": $b.name
};"
595,List the review texts and their corresponding business names for reviews with exactly 3 stars.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 3.0
RETURN r.text AS reviewText, b.name AS businessName","match
  $r isa review, has stars 3.0, has text $text;
  reviews (review: $r, reviewed_business: $b);
  $b isa business, has name $bname;
fetch {
  ""reviewText"": $text,
  ""businessName"": $bname
};"
596,What are the names of businesses that have been reviewed by all users listed in the schema?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH b, collect(u.userId) AS reviewers
WHERE reviewers = ['u1', 'u2', 'u3', 'u4']
RETURN b.name","match
$b isa business;
$u1 isa user, has user_id ""u1"";
$u2 isa user, has user_id ""u2"";
$u3 isa user, has user_id ""u3"";
$u4 isa user, has user_id ""u4"";
$r1 isa review;
$r2 isa review;
$r3 isa review;
$r4 isa review;
wrote (author: $u1, review: $r1);
reviews (review: $r1, reviewed_business: $b);
wrote (author: $u2, review: $r2);
reviews (review: $r2, reviewed_business: $b);
wrote (author: $u3, review: $r3);
reviews (review: $r3, reviewed_business: $b);
wrote (author: $u4, review: $r4);
reviews (review: $r4, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
597,Which businesses have a review written on '2018-09-10'?,"MATCH (u:User)-[:WROTE]->(r:Review {date: date('2018-09-10')})-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
  $u isa user;
  $r isa review, has date $d;
  $d == 2018-09-10;
  $b isa business;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
598,Find the business with the most reviews in 'San Mateo' and list its reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'San Mateo'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
$b isa business, has city ""San Mateo"";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
match
reviews (reviewed_business: $b, review: $r2);
$r2 has text $text, has stars $stars, has date $date;
$b has name $bname;
fetch {
  ""businessName"": $bname,
  ""reviewText"": $text,
  ""reviewStars"": $stars,
  ""reviewDate"": $date
};"
599,List the businesses that have been reviewed by each user more than once.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, b, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN u.name AS userName, COLLECT(b.name) AS businessesReviewedMoreThanOnce","match
$u isa user;
$b isa business;
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $u, $b;
match $count > 1;
$u has name $un;
$b has name $bn;
fetch { ""userName"": $un, ""businessName"": $bn };"
600,Which business categories do not have any reviews mentioning 'awesome'?,"MATCH (c:Category)<-[:IN_CATEGORY]-(b:Business)
WHERE NOT EXISTS {
  MATCH (b)<-[:REVIEWS]-(r:Review)
  WHERE r.text CONTAINS 'awesome'
}
RETURN c.name AS CategoryWithoutAwesomeReviews","match
$c isa category, has name $cn;
in_category (business: $b, category: $c);
not {
  reviews (review: $r, reviewed_business: $b);
  $r has text $t;
  $t like "".*awesome.*"";
};
fetch {
  ""CategoryWithoutAwesomeReviews"": $cn
};"
601,What are the review texts for reviews written in 2016 and who wrote them?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN u.name AS userName, r.text AS reviewText","match
$u isa user;
$r isa review, has date $d, has text $rt;
$d >= 2016-01-01T00:00:00;
$d < 2017-01-01T00:00:00;
wrote (author: $u, review: $r);
fetch {
  ""userName"": $u.name,
  ""reviewText"": $rt
};"
602,Show the names of businesses located at '313 N 1st St W' and their review texts.,"MATCH (b:Business {address: '313 N 1st St W'})&lt;-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.text AS reviewText","match
$b isa business, has address ""313 N 1st St W"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text
};"
603,Which businesses have the most number of reviews in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
WITH b, COUNT(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$b isa business, has city ""Missoula"", has name $n;
in_category (business: $b, category: $c);
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b, $n;
sort $count desc;
limit 1;
fetch {
  ""businessName"": $n,
  ""reviewCount"": $count
};"
604,Which reviews are written by users from 'CA' state businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN r","match
$u isa user;
$r isa review;
$b isa business, has state ""CA"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
605,What are the business names and their categories on 'E Front St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'E Front St'
RETURN b.name AS businessName, c.name AS category","match
$b isa business, has address $addr, has name $bn;
$addr like "".*E Front St.*"";
$c isa category, has name $cn;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""category"": $cn
};"
606,List the user names and their corresponding review texts.,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS userName, r.text AS reviewText","match
$u isa user;
$r isa review;
wrote (author: $u, review: $r);
fetch {
  ""userName"": $u.name,
  ""reviewText"": $r.text
};"
607,Which business has the review with the lowest star rating?,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WITH b, r
ORDER BY r.stars ASC
LIMIT 1
RETURN b.name AS businessName, r.stars AS lowestRating","match
$r isa review, has stars $s;
$b isa business, has name $bn;
reviews (review: $r, reviewed_business: $b);
sort $s asc;
limit 1;
fetch {
  ""businessName"": $bn,
  ""lowestRating"": $s
};"
608,List all reviews written by the user named 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
$r isa review;
fetch {
  ""review"": {
    ""text"": $r.text,
    ""stars"": $r.stars,
    ""date"": $r.date,
    ""review_id"": $r.review_id
  }
};"
609,What are the names of businesses located in 'CA' state?,"MATCH (b:Business)
WHERE b.state = 'CA'
RETURN b.name","match
$b isa business, has state ""CA"";
fetch {
  ""name"": $b.name
};"
610,Who wrote the review with the text 'Great IPA selection!'?,"MATCH (u:User)-[:WROTE]->(r:Review {text: 'Great IPA selection!'})
RETURN u.name","match
$u isa user;
$r isa review, has text ""Great IPA selection!"";
wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
611,Find all reviews that have a star rating of 5.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5.0
RETURN r.reviewId, r.text, r.date, r.stars, b.name","match
$r isa review, has review_id $rid, has text $txt, has date $d, has stars $s;
$s == 5.0;
reviews (review: $r, reviewed_business: $b);
$b has name $bn;
fetch {
  ""review_id"": $rid,
  ""text"": $txt,
  ""date"": $d,
  ""stars"": $s,
  ""business_name"": $bn
};"
612,Which businesses are categorized under 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name AS BusinessName","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""BusinessName"": $b.name
};"
613,What are the addresses of the first 3 businesses in Missoula?,"MATCH (b:Business {city: 'Missoula'})
RETURN b.address
ORDER BY b.businessId
LIMIT 3","match
$b isa business, has city ""Missoula"", has business_id $bid;
sort $bid;
limit 3;
fetch {
  ""address"": $b.address
};"
614,Which users wrote reviews with a rating of 5 stars?,"MATCH (u:User)-[:WROTE]->(r:Review)
WHERE r.stars = 5.0
RETURN u.name","match
$u isa user;
$r isa review, has stars 5.0;
wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
615,List the names of businesses located in 'San Mateo'.,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name","match
$b isa business, has city ""San Mateo"";
fetch {
  ""name"": $b.name
};"
616,Which business has the address '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})
RETURN b.name","match
$b isa business, has address ""301 E Main St"";
fetch {
  ""name"": $b.name
};"
617,How many businesses are located in Burlingame?,"MATCH (b:Business)
WHERE b.city = 'Burlingame'
RETURN count(b) AS numberOfBusinesses","match $b isa business, has city ""Burlingame"";
reduce $count = count($b);"
618,Find the top 5 most recent reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.date AS reviewDate, r.text AS reviewText, r.stars AS reviewStars, u.name AS userName, b.name AS businessName
ORDER BY r.date DESC
LIMIT 5","match
$u isa user;
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$r has date $d;
sort $d desc;
limit 5;
fetch {
  ""reviewDate"": $r.date,
  ""reviewText"": $r.text,
  ""reviewStars"": $r.stars,
  ""userName"": $u.name,
  ""businessName"": $b.name
};"
619,Who wrote the earliest review in the dataset?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name, r.date
ORDER BY r.date ASC
LIMIT 1","match
$u isa user, has name $n;
$r isa review, has date $d;
wrote (author: $u, review: $r);
sort $d asc;
limit 1;
fetch {
  ""name"": $n,
  ""date"": $d
};"
620,What is the name of the business reviewed by user with userId 'u1'?,"MATCH (u:User {userId: 'u1'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
  $u isa user, has user_id ""u1"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
621,What are the categories of the businesses on 'W Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'W Broadway St'
RETURN DISTINCT c.name AS category","match
$b isa business, has address $a;
$a like "".*W Broadway St.*"";
in_category (business: $b, category: $c);
select $c;
distinct;
fetch {
  ""category"": $c.name
};"
622,Which businesses have a rating of 3.5 or higher?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 3.5
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has stars $s;
$s >= 3.5;
reviews (review: $r, reviewed_business: $b);
select $b;
distinct;
fetch {
  ""name"": $b.name
};"
623,List all businesses that have been reviewed by 'Jenny'.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""businessName"": $b.name
};"
624,What are the names of the businesses that serve as libraries?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: ""Library""})
RETURN b.name AS libraryNames","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""libraryNames"": $b.name
};"
625,Which businesses are categorized under 'Coffee'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN b.name AS businessName","match
  $b isa business;
  $c isa category, has name ""Coffee"";
  in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name
};"
626,What are the first 3 businesses reviewed in 2018?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-01-01') AND r.date < date('2019-01-01')
RETURN b.name, r.date
ORDER BY r.date ASC
LIMIT 3","match
$b isa business, has name $bn;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-01-01T00:00:00;
$d < 2019-01-01T00:00:00;
sort $d asc;
limit 3;
fetch {
  ""business_name"": $bn,
  ""date"": $d
};"
627,What are the names of users who reviewed businesses in 'CA'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN u.name","match
$u isa user;
$b isa business, has state ""CA"";
$r isa review;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
628,Which user has reviewed 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name AS userName","match
$b isa business, has name ""Zootown Brew"";
$r isa review;
$u isa user;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""userName"": $u.name
};"
629,What are the addresses of businesses in state 'MT'?,"MATCH (b:Business)
WHERE b.state = 'MT'
RETURN b.address","match
$b isa business, has state ""MT"";
fetch {
  ""address"": $b.address
};"
630,List the businesses that have been reviewed more than once.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $reviewCount = count($r) groupby $b;
match
$reviewCount > 1;
$b has name $name;
sort $reviewCount desc;
fetch {
  ""businessName"": $name,
  ""reviewCount"": $reviewCount
};"
631,What are the names of all categories associated with 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name","match
$b isa business, has name ""Neo4j"";
in_category (business: $b, category: $c);
$c isa category;
fetch {
  ""name"": $c.name
};"
632,What are the names of businesses that have reviews with a star rating above 4.5?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars > 4.5
RETURN b.name","match
$b isa business;
$r isa review, has stars $s;
$s > 4.5;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
633,What are the names of businesses that have reviews with text mentioning 'car wash'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*car wash.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
634,How many categories are associated with the business named 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})-[:IN_CATEGORY]->(c:Category)
RETURN count(c) AS numberOfCategories","match
$b isa business, has name ""Neo4j"";
in_category (business: $b, category: $c);
reduce $count = count($c);"
635,What are the names of the users who have written a review for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name","match
  $b isa business, has name ""KettleHouse Brewing Co."";
  reviews (reviewed_business: $b, review: $r);
  wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
636,Which business has the most reviews in 'Burlingame'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN b.name AS business, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 1","match
$b isa business, has city ""Burlingame"";
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch { ""business"": $b.name, ""review_count"": $count };"
637,List all businesses that have not been reviewed.,"MATCH (b:Business)
WHERE NOT EXISTS {
  MATCH (b)<-[:REVIEWS]-(:Review)
}
RETURN b.name","match
$b isa business;
not { reviews (reviewed_business: $b); };
fetch {
  ""name"": $b.name
};"
638,What are the business names and their corresponding city that have been reviewed by 'Jenny'?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, b.city AS city","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""city"": $b.city
};"
639,How many reviews have been written for each category of business?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)<-[:REVIEWS]-(r:Review)
RETURN c.name AS category, COUNT(r) AS review_count
ORDER BY review_count DESC","match
$b isa business;
$c isa category, has name $cname;
$r isa review;
in_category (business: $b, category: $c);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $cname;
sort $count desc;"
640,Which user has reviewed the most number of unique businesses?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, COUNT(DISTINCT b.businessId) AS uniqueBusinessCount
RETURN u.name AS userName, uniqueBusinessCount
ORDER BY uniqueBusinessCount DESC
LIMIT 1","match
$u isa user;
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
select $u, $b;
distinct;
reduce $count = count($b) groupby $u;
sort $count desc;
limit 1;
fetch {
  ""userName"": $u.name,
  ""uniqueBusinessCount"": $count
};"
641,List the categories of businesses that have been reviewed in 2018.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
MATCH (r:Review)-[:REVIEWS]->(b)
WHERE r.date >= date('2018-01-01') AND r.date <= date('2018-12-31')
RETURN DISTINCT c.name AS category","match
  $b isa business;
  $c isa category;
  in_category (business: $b, category: $c);
  $r isa review, has date $d;
  reviews (review: $r, reviewed_business: $b);
  $d >= 2018-01-01T00:00:00;
  $d <= 2018-12-31T23:59:59;
  $c has name $cn;
select $cn;
distinct;
fetch { ""category"": $cn };"
642,What are the names of the businesses that 'Will' has reviewed?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""businessName"": $b.name
};"
643,Find businesses that have reviews both above and below 4 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, 
     COLLECT(CASE WHEN r.stars > 4 THEN 'above' ELSE 'below' END) AS star_ratings
WHERE 'above' IN star_ratings AND 'below' IN star_ratings
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState","match
$b isa business;
$r1 isa review, has stars $s1;
reviews (reviewed_business: $b, review: $r1);
$s1 > 4.0;
$r2 isa review, has stars $s2;
reviews (reviewed_business: $b, review: $r2);
$s2 <= 4.0;
select $b;
distinct;
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
644,Which business in 'San Mateo' has the highest average star rating based on reviews?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.city = 'San Mateo'
WITH b, avg(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 1
RETURN b.name AS businessName, avgRating","match
$b isa business, has city ""San Mateo"";
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg
};"
645,List all the reviews with a star rating below 3.5.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 3.5
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS starRating, b.name AS businessName","match
$r isa review, has stars $s, has review_id $rid, has text $txt;
$b isa business, has name $bname;
reviews (review: $r, reviewed_business: $b);
$s < 3.5;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $txt,
  ""starRating"": $s,
  ""businessName"": $bname
};"
646,What are the complete addresses of businesses named 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})
RETURN b.address","match
$b isa business, has name ""Zootown Brew"";
fetch {
  ""address"": $b.address
};"
647,How many businesses are there in each state listed in the database?,"MATCH (b:Business)
RETURN b.state AS state, COUNT(b) AS numberOfBusinesses
ORDER BY state","match
$b isa business, has state $s;
reduce $count = count($b) groupby $s;
sort $s;"
648,What are the names of businesses that have received a review from 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name","match
  $u isa user, has name ""Angie"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $b isa business;
fetch {
  ""name"": $b.name
};"
649,Which businesses have a review dated earlier than 2016?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date < date(""2016-01-01"")
RETURN b.name AS businessName, b.address AS businessAddress, r.date AS reviewDate","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d < 2016-01-01T00:00:00;
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""reviewDate"": $d
};"
650,List the top 5 highest-rated businesses based on average review stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS averageRating
ORDER BY averageRating DESC
LIMIT 5
RETURN b.name AS businessName, averageRating","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 5;
fetch { ""businessName"": $b.name, ""averageRating"": $avg };"
651,Identify businesses that have received exactly three reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount = 3
RETURN b.name AS businessName, b.businessId AS businessId","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match $count == 3;
fetch {
  ""businessName"": $b.name,
  ""businessId"": $b.business_id
};"
652,What categories are available for businesses in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN DISTINCT c.name AS categories","match
$b isa business, has city ""Missoula"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""categories"": $c.name
};"
653,How many businesses are there in each city within the database?,"MATCH (b:Business)
RETURN b.city AS city, COUNT(b) AS numberOfBusinesses
ORDER BY city","match
$b isa business, has city $city;
reduce $count = count($b) groupby $city;
sort $city asc;"
654,Which reviews mention 'sandwich' in their text?,"MATCH (r:Review)
WHERE r.text CONTAINS 'sandwich'
RETURN r.reviewId, r.text","match
$r isa review, has text $t, has review_id $rid;
$t like "".*sandwich.*"";
fetch {
  ""reviewId"": $rid,
  ""text"": $t
};"
655,List the businesses reviewed by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name
};"
656,Which user has written the most reviews?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS user, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$u isa user, has name $name;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u, $name;
sort $count desc;
limit 1;
fetch { ""user"": $name, ""reviewCount"": $count };"
657,Find the top 3 most recent reviews.,"MATCH (r:Review)
RETURN r
ORDER BY r.date DESC
LIMIT 3","match
$r isa review, has date $d;
sort $d desc;
limit 3;
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $d
};"
658,What is the average star rating of reviews for 'Missoula Public Library'?,"MATCH (b:Business {name: 'Missoula Public Library'})<-[:REVIEWS]-(r:Review)
RETURN avg(r.stars) AS average_star_rating","match
$b isa business, has name ""Missoula Public Library"";
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
reduce $avg = mean($s);"
659,How many reviews does each user have?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS userName, COUNT(r) AS reviewCount","match
$u isa user;
$r isa review;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
660,List the names and addresses of all businesses in 'San Mateo'.,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has city ""San Mateo"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
661,List all businesses along with their categories in the city of 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has city ""Burlingame"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
662,Find the categories and addresses of businesses that have been reviewed by 'Bob'.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
MATCH (b)-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category, b.address AS address","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
fetch {
  ""category"": $c.name,
  ""address"": $b.address
};"
663,Show the reviews for 'Market on Front' along with the review dates and stars.,"MATCH (b:Business {name: 'Market on Front'})<-[:REVIEWS]-(r:Review)
RETURN r.text AS review, r.date AS date, r.stars AS stars","match
$b isa business, has name ""Market on Front"";
$r isa review, has text $review, has date $d, has stars $s;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""review"": $review,
  ""date"": $d,
  ""stars"": $s
};"
664,Which businesses in 'San Mateo' have been reviewed by 'Angie' and what were the ratings?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'San Mateo'})
RETURN b.name AS businessName, r.stars AS rating","match
  $u isa user, has name ""Angie"";
  $r isa review, has stars $s;
  $b isa business, has city ""San Mateo"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""rating"": $s
};"
665,Which business in 'CA' has the most reviews?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA'
RETURN b.name, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1","match
$b isa business, has state ""CA"", has name $n;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b, $n;
sort $count desc;
limit 1;
fetch { ""name"": $n, ""review_count"": $count };"
666,Find the reviews made for businesses in 'MT'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'MT'
RETURN r","match
  $b isa business, has state ""MT"";
  in_category (business: $b, category: $c);
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
667,What are the business names in 'San Mateo'?,"MATCH (b:Business)
WHERE b.city = 'San Mateo'
RETURN b.name","match
$b isa business, has city ""San Mateo"";
fetch {
  ""name"": $b.name
};"
668,Which businesses are located on 'E Front St'?,"MATCH (b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN b.name AS businessName, b.address AS address","match
$b isa business, has address $a;
$a like "".*E Front St.*"";
fetch {
  ""businessName"": $b.name,
  ""address"": $a
};"
669,Show all users who have written a review for a business in 'Missoula'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business {city: 'Missoula'})
RETURN u.name","match
  $u isa user;
  $r isa review;
  $b isa business, has city ""Missoula"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
670,Which businesses have reviews with stars between 4 and 5?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars >= 4 AND r.stars <= 5
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has stars $s;
$s >= 4.0;
$s <= 5.0;
reviews (reviewed_business: $b, review: $r);
select $b;
distinct;
fetch {
  ""name"": $b.name
};"
671,List all reviews made by Angie.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
$r has review_id $rid, has text $txt, has stars $s, has date $d;
fetch {
  ""review_id"": $rid,
  ""text"": $txt,
  ""stars"": $s,
  ""date"": $d
};"
672,How many businesses have been reviewed by Bob?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN COUNT(DISTINCT b) AS numberOfReviewedBusinesses","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
reduce $count = count($b);"
673,Find businesses with reviews mentioning 'graph database'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'graph database'
RETURN b.name, b.address, b.city, b.state","match
$b isa business;
$r isa review, has text $t;
$t like "".*graph database.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city,
  ""state"": $b.state
};"
674,What is the state of businesses that have been reviewed by Jenny?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.state","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b has state $s;
select $s;
distinct;
fetch { ""state"": $s };"
675,Which category does 'Ducky's Car Wash' belong to?,"MATCH (b:Business {name: ""Ducky's Car Wash""})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category","match
$b isa business, has name ""Ducky's Car Wash"";
in_category (business: $b, category: $c);
fetch {
  ""category"": $c.name
};"
676,List top 3 businesses by the number of reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
677,Show businesses that have been reviewed with exactly 5 stars.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState","match
$b isa business;
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
678,Which businesses have been reviewed by all users?,"MATCH (u:User)
WITH collect(u.userId) AS allUserIds
MATCH (b:Business)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, collect(DISTINCT u.userId) AS reviewedByUserIds, allUserIds
WHERE allUserIds = reviewedByUserIds
RETURN b.name AS businessName","match
$b isa business;
not {
  $u isa user;
  not {
    wrote (author: $u, review: $r);
    reviews (review: $r, reviewed_business: $b);
  };
};
fetch { ""businessName"": $b.name };"
679,List the categories of businesses reviewed by Will.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
RETURN DISTINCT c.name AS categories","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
in_category (business: $b, category: $c);
$c has name $n;
select $n;
distinct;
fetch { ""categories"": $n };"
680,Which businesses have been reviewed on '2018-09-10'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date = date('2018-09-10')
RETURN b.name","match
$b isa business;
$r isa review, has date 2018-09-10T00:00:00;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
681,Find the first 3 reviews in the database.,"MATCH (r:Review)
RETURN r
ORDER BY r.date ASC
LIMIT 3","match
$r isa review, has date $d;
sort $d asc;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
682,List the businesses that are in the same category as 'Neo4j'.,"MATCH (b:Business {name: 'Neo4j'})-[:IN_CATEGORY]->(c:Category)<-[:IN_CATEGORY]-(other:Business)
RETURN other.name AS businessName","match
$b isa business, has name ""Neo4j"";
in_category (business: $b, category: $c);
in_category (business: $other, category: $c);
not { $other is $b; };
fetch {
  ""businessName"": $other.name
};"
683,Find the top 5 earliest reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.date, r.text, r.stars, u.name, b.name
ORDER BY r.date ASC
LIMIT 5","match
$u isa user, has name $uname;
$r isa review, has review_id $rid, has date $d, has text $t, has stars $s;
$b isa business, has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $d asc;
limit 5;
fetch {
  ""reviewId"": $rid,
  ""date"": $d,
  ""text"": $t,
  ""stars"": $s,
  ""userName"": $uname,
  ""businessName"": $bname
};"
685,List the businesses that have been reviewed by both Will and Jenny.,"MATCH (will:User {name: 'Will'})-[:WROTE]->(review1:Review)-[:REVIEWS]->(business:Business),
      (jenny:User {name: 'Jenny'})-[:WROTE]->(review2:Review)-[:REVIEWS]->(business)
RETURN DISTINCT business.name AS BusinessName","match
$will isa user, has name ""Will"";
$jenny isa user, has name ""Jenny"";
$r1 isa review;
$r2 isa review;
$b isa business;
wrote (author: $will, review: $r1);
reviews (review: $r1, reviewed_business: $b);
wrote (author: $jenny, review: $r2);
reviews (review: $r2, reviewed_business: $b);
fetch {
  ""BusinessName"": $b.name
};"
686,Which business reviewed by Jenny has the lowest star rating?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS business, r.stars AS rating
ORDER BY r.stars ASC
LIMIT 1","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$r has stars $s;
sort $s asc;
limit 1;
fetch {
  ""business"": $b.name,
  ""rating"": $s
};"
687,Find the reviews for the business with the highest number of stars.,"// Step 1: Find the business with the highest number of stars
MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgStars
ORDER BY avgStars DESC
LIMIT 1

// Step 2: Find the reviews for that business
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN r.reviewId, r.text, r.stars, r.date","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
$r has stars $s;
reduce $avg_stars = mean($s) groupby $b;
sort $avg_stars desc;
limit 1;
match
$r2 isa review;
reviews (reviewed_business: $b, review: $r2);
$r2 has review_id $rid;
$r2 has text $txt;
$r2 has stars $st;
$r2 has date $dt;
fetch {
  ""reviewId"": $rid,
  ""text"": $txt,
  ""stars"": $st,
  ""date"": $dt
};"
688,What are the addresses of businesses with reviews mentioning 'selection of books'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'selection of books'
RETURN b.address","match
$b isa business;
$r isa review, has text $t;
$t like "".*selection of books.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""address"": $b.address
};"
689,Show all the businesses reviewed in September 2018.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2018-09-01') AND r.date <= date('2018-09-30')
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-09-01T00:00:00;
$d <= 2018-09-30T23:59:59;
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
690,Which reviews are for businesses in the same state as 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})-[:IN_CATEGORY]->(c:Category)<-[:IN_CATEGORY]-(otherBusiness:Business {state: b.state})
MATCH (review:Review)-[:REVIEWS]->(otherBusiness)
RETURN review.text, review.date, review.stars, otherBusiness.name","match
$b isa business, has name ""Zootown Brew"", has state $s;
$otherBusiness isa business, has state $s, has name $otherName;
in_category (business: $b, category: $c);
in_category (business: $otherBusiness, category: $c);
$rev isa review;
reviews (review: $rev, reviewed_business: $otherBusiness);
$rev has text $text, has date $date, has stars $stars;
fetch {
  ""review_text"": $text,
  ""review_date"": $date,
  ""review_stars"": $stars,
  ""business_name"": $otherName
};"
691,Show the reviews for businesses with addresses on 'California Dr'.,"MATCH (b:Business {address: '723 California Dr'})<-[:REVIEWS]-(r:Review)
RETURN r","match
$b isa business, has address $addr;
$addr like "".*California Dr.*"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
692,List the reviews for businesses on 'N San Mateo Dr'.,"MATCH (b:Business {address: '716 N San Mateo Dr'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate, u.name AS userName","match
  $b isa business, has address $addr;
  $addr like "".*N San Mateo Dr.*"";
  reviews (reviewed_business: $b, review: $r);
  wrote (author: $u, review: $r);
  $r has text $text, has stars $stars, has date $date;
  $u has name $uname;
fetch {
  ""reviewText"": $text,
  ""reviewStars"": $stars,
  ""reviewDate"": $date,
  ""userName"": $uname
};"
694,How many businesses have a review mentioning 'Wifi'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'Wifi'
RETURN COUNT(DISTINCT b) AS numberOfBusinesses","match
$b isa business;
$r isa review, has text $t;
$t like "".*Wifi.*"";
reviews (reviewed_business: $b, review: $r);
select $b;
distinct;
reduce $count = count;"
695,What are the categories for businesses in 'Burlingame'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame'
RETURN DISTINCT c.name AS category","match
$b isa business, has city ""Burlingame"";
$c isa category;
in_category (business: $b, category: $c);
select $c;
distinct;
fetch {
  ""category"": $c.name
};"
696,List the reviews from the latest to the earliest.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.reviewId, r.text, r.date, r.stars, u.name, b.name
ORDER BY r.date DESC","match
$u isa user, has name $un;
$r isa review, has review_id $rid, has text $rt, has date $rd, has stars $rs;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $rd desc;
fetch {
  ""reviewId"": $rid,
  ""text"": $rt,
  ""date"": $rd,
  ""stars"": $rs,
  ""userName"": $un,
  ""businessName"": $bn
};"
697,Which users have reviewed more than one business?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, COUNT(DISTINCT b) AS businessCount
WHERE businessCount > 1
RETURN u.name AS userName","match
$u isa user;
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
select $u, $b;
distinct;
reduce $count = count($b) groupby $u;
match $count > 1;
fetch { ""userName"": $u.name };"
698,What are the reviews for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})<-[:REVIEWS]-(r:Review)
RETURN r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
$b isa business, has name ""KettleHouse Brewing Co."";
$r isa review;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""reviewText"": $r.text,
  ""reviewStars"": $r.stars,
  ""reviewDate"": $r.date
};"
699,Which businesses have reviews that mention 'IPA'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'IPA'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
reviews (reviewed_business: $b, review: $r);
$t like "".*IPA.*"";
fetch {
  ""name"": $b.name
};"
700,What categories have businesses with a location in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN DISTINCT c.name AS category","match
$b isa business, has city ""Missoula"";
$c isa category, has name $name;
in_category (business: $b, category: $c);
select $name;
distinct;
fetch {
  ""category"": $name
};"
701,Which businesses have reviews that mention 'car wash'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'car wash'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*car wash.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
702,What are the categories of businesses on 'Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Broadway St'
RETURN DISTINCT c.name AS category","match
$b isa business, has address $a;
$a like "".*Broadway St.*"";
in_category (business: $b, category: $c);
$c isa category, has name $cn;
select $cn;
distinct;
fetch { ""category"": $cn };"
703,List all reviews for businesses on 'W Pine St'.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'W Pine St'
RETURN r","match
$b isa business, has address $addr;
$addr like "".*W Pine St.*"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
fetch {
  ""review_id"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""date"": $r.date
};"
704,Which users have written a review for 'Ninja Mike's'?,"MATCH (b:Business {name: ""Ninja Mike's""})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name AS userName","match
$b isa business, has name ""Ninja Mike's"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
fetch {
  ""userName"": $u.name
};"
705,Find all reviews with a star rating of 5.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars = 5.0
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.date AS reviewDate, b.name AS businessName","match
$r isa review, has stars 5.0, has review_id $rid, has text $rt, has date $rd;
reviews (review: $r, reviewed_business: $b);
$b has name $bn;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $rt,
  ""reviewDate"": $rd,
  ""businessName"": $bn
};"
706,Which business has the address '301 E Main St'?,"MATCH (b:Business {address: '301 E Main St'})
RETURN b.name","match
$b isa business, has address ""301 E Main St"";
fetch {
  ""name"": $b.name
};"
707,What are the names of businesses that have been reviewed by Jenny?,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name","match
$u isa user, has name ""Jenny"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
708,How many businesses are categorized as 'Library'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN count(b) AS numberOfLibraries","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
reduce $count = count($b);"
709,What are the reviews for businesses located on 'W Broadway St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.address CONTAINS 'W Broadway St'
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
  $b isa business, has address $addr, has name $bname;
  $addr like "".*W Broadway St.*"";
  in_category (business: $b, category: $c);
  $r isa review, has text $rt, has stars $rs, has date $rd;
  reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $bname,
  ""reviewText"": $rt,
  ""reviewStars"": $rs,
  ""reviewDate"": $rd
};"
710,Which businesses have more than one review?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match $count > 1;
fetch {
  ""businessName"": $b.name,
  ""reviewCount"": $count
};"
711,List all businesses in the state of California.,"MATCH (b:Business)
WHERE b.state = 'CA'
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity","match
$b isa business, has state ""CA"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city
};"
712,List the reviews made by Will.,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)
RETURN r","match
$u isa user, has name ""Will"";
$r isa review;
wrote (author: $u, review: $r);
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
713,Which users have written reviews for businesses in San Mateo?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'San Mateo'
RETURN DISTINCT u.name","match
$u isa user;
$r isa review;
$b isa business, has city ""San Mateo"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$u has name $name;
select $name;
distinct;
fetch { ""name"": $name };"
714,Find users who have rated a business in 'Burlingame'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'Burlingame'
RETURN u.name","match
$u isa user;
$r isa review;
$b isa business, has city ""Burlingame"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
715,What categories include businesses from 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN DISTINCT c.name AS category","match
$b isa business, has city ""Missoula"";
$c isa category;
in_category (business: $b, category: $c);
select $c;
distinct;
fetch {
  ""category"": $c.name
};"
716,How many different categories are represented in businesses in California?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.state = 'CA'
RETURN COUNT(DISTINCT c.name) AS numberOfCategories","match
$b isa business, has state ""CA"";
$c isa category, has name $cn;
in_category (business: $b, category: $c);
select $cn;
distinct;
reduce $count = count;"
717,Which business has the highest average star rating?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating
RETURN b.name AS businessName, avgRating
ORDER BY avgRating DESC
LIMIT 1","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
sort $avg desc;
limit 1;
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg
};"
718,List the top 3 most recent reviews.,"MATCH (r:Review)
WITH r
ORDER BY r.date DESC
LIMIT 3
RETURN r.date, r.text, r.stars, r.reviewId","match
$r isa review, has date $d;
sort $d desc;
limit 3;
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""reviewId"": $r.review_id
};"
719,What is the address of 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})
RETURN b.address","match
$b isa business, has name ""Neo4j"";
fetch {
  ""address"": $b.address
};"
720,Which businesses are located in Missoula?,"MATCH (b:Business)
WHERE b.city = 'Missoula'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has city ""Missoula"";
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address
};"
721,Find the businesses reviewed by users named Angie.,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName, b.address AS businessAddress, b.city AS businessCity, b.state AS businessState","match
$u isa user, has name ""Angie"";
$r isa review;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""businessName"": $b.name,
  ""businessAddress"": $b.address,
  ""businessCity"": $b.city,
  ""businessState"": $b.state
};"
722,Show all business addresses on 'E Front St'.,"MATCH (b:Business)
WHERE b.address CONTAINS 'E Front St'
RETURN b.address","match
$b isa business, has address $a;
$a like "".*E Front St.*"";
fetch {
  ""address"": $a
};"
723,List the businesses with a 'Library' category and their reviews.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
OPTIONAL MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
$b isa business;
in_category (business: $b, category: $c);
$c isa category, has name ""Library"";
try {
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
};
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text,
  ""reviewStars"": $r.stars,
  ""reviewDate"": $r.date
};"
724,Which businesses in 'Burlingame' have been reviewed by more than one user?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
WITH b, COUNT(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN b.name AS businessName","match
$b isa business, has city ""Burlingame"";
$u isa user;
$rev isa review;
wrote (author: $u, review: $rev);
reviews (review: $rev, reviewed_business: $b);
select $u, $b;
distinct;
reduce $count = count groupby $b;
match $count > 1;
fetch { ""businessName"": $b.name };"
725,What are the reviews for businesses that have more than one category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, COUNT(c) AS categoryCount
WHERE categoryCount > 1
MATCH (b)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, u.name AS userName","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
reduce $cat_count = count($c) groupby $b;
match
$cat_count > 1;
$r isa review;
$u isa user;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $r.text,
  ""reviewStars"": $r.stars,
  ""userName"": $u.name
};"
726,List the businesses that have been categorized as 'Library' in California.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
WHERE b.state = 'CA'
RETURN b.name AS businessName, b.address AS address, b.city AS city","match
$b isa business, has state ""CA"";
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""address"": $b.address,
  ""city"": $b.city
};"
727,Which reviews were written by users from 'CA'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'CA'
RETURN u.name AS userName, r.text AS reviewText, r.date AS reviewDate, r.stars AS reviewStars","match
$u isa user;
$r isa review;
$b isa business, has state ""CA"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""userName"": $u.name,
  ""reviewText"": $r.text,
  ""reviewDate"": $r.date,
  ""reviewStars"": $r.stars
};"
728,Find the first 3 reviews with the highest star ratings.,"MATCH (r:Review)
WITH r
ORDER BY r.stars DESC, r.date ASC
LIMIT 3
RETURN r.reviewId, r.text, r.stars, r.date","match
$r isa review, has stars $s, has date $d;
sort $s desc, $d asc;
limit 3;
fetch {
  ""reviewId"": $r.review_id,
  ""text"": $r.text,
  ""stars"": $s,
  ""date"": $d
};"
729,Which business has the lowest number of reviews?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
RETURN b.name AS businessName, reviewCount
ORDER BY reviewCount ASC
LIMIT 1","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count asc;
limit 1;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
730,What are the names of all businesses reviewed by Bob?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.name AS businessName","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
fetch {
  ""businessName"": $b.name
};"
731,How many categories have businesses in 'San Mateo'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN COUNT(DISTINCT c.name) AS numberOfCategories","match
$b isa business, has city ""San Mateo"";
$c isa category, has name $n;
in_category (business: $b, category: $c);
select $n;
distinct;
reduce $count = count;"
732,Which businesses have been reviewed in 2017?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d >= 2017-01-01T00:00:00;
$d <= 2017-12-31T23:59:59;
select $b;
distinct;
fetch {
  ""name"": $b.name
};"
733,List all reviews with a rating less than 4 stars.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars < 4.0
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS rating, b.name AS businessName","match
$r isa review, has review_id $rid, has text $txt, has stars $s;
$b isa business, has name $bn;
reviews (review: $r, reviewed_business: $b);
$s < 4.0;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $txt,
  ""rating"": $s,
  ""businessName"": $bn
};"
734,Which businesses are in the same city as 'Zootown Brew'?,"MATCH (b1:Business {name: 'Zootown Brew'})-[:IN_CATEGORY]->(:Category)<-[:IN_CATEGORY]-(b2:Business)
WHERE b1.city = b2.city AND b1.name <> b2.name
RETURN b2.name AS BusinessName","match
$b1 isa business, has name ""Zootown Brew"", has city $c;
$b2 isa business, has name $n2, has city $c;
not { $n2 == ""Zootown Brew""; };
fetch {
  ""BusinessName"": $n2
};"
735,How many users have written reviews for 'Missoula Public Library'?,"MATCH (b:Business {name: 'Missoula Public Library'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN COUNT(DISTINCT u) AS numberOfUsers","match
$b isa business, has name ""Missoula Public Library"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
wrote (author: $u, review: $r);
$u isa user;
reduce $count = count($u);"
736,What is the text of the first review written in 2018?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date(""2018-01-01"") AND r.date < date(""2019-01-01"")
RETURN r.text
ORDER BY r.date ASC
LIMIT 1","match
$u isa user;
$r isa review, has date $d, has text $t;
wrote (author: $u, review: $r);
$b isa business;
reviews (review: $r, reviewed_business: $b);
$d >= 2018-01-01T00:00:00;
$d < 2019-01-01T00:00:00;
sort $d asc;
limit 1;
fetch {
  ""text"": $t
};"
737,List the businesses that have a review mentioning 'breakfast'.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'breakfast'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*breakfast.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
738,Which category does 'KettleHouse Brewing Co.' belong to?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS category","match
$b isa business, has name ""KettleHouse Brewing Co."";
$c isa category, has name $cat_name;
in_category (business: $b, category: $c);
fetch {
  ""category"": $cat_name
};"
739,What is the address of the business with the most recent review?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.address
ORDER BY r.date DESC
LIMIT 1","match
$u isa user;
$r isa review, has date $d;
$b isa business;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $d desc;
limit 1;
fetch {
  ""address"": $b.address
};"
740,"What are the business names of 'b1', 'b2', and 'b3'?","MATCH (b:Business)
WHERE b.businessId IN ['b1', 'b2', 'b3']
RETURN b.name","match
$b isa business, has business_id $bid;
{ $bid == ""b1""; } or { $bid == ""b2""; } or { $bid == ""b3""; };
fetch {
  ""name"": $b.name
};"
741,Show the reviews that mention 'full-service'.,"MATCH (r:Review)
WHERE r.text CONTAINS 'full-service'
RETURN r","match
$r isa review, has text $t;
$t like "".*full-service.*"";
fetch {
  ""review"": {
    ""text"": $r.text,
    ""stars"": $r.stars,
    ""review_id"": $r.review_id,
    ""date"": $r.date
  }
};"
742,Which businesses have a review written on '2017-11-13'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review {date: date('2017-11-13')})
RETURN b.name","match
$b isa business;
$r isa review, has date $d;
$d == 2017-11-13;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
743,What are the names of businesses that have reviews with exactly 5 stars?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars = 5.0
RETURN b.name","match
$b isa business;
$r isa review, has stars 5.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $b.name
};"
744,Which users have reviewed businesses in 'San Mateo'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.city = 'San Mateo'
RETURN u.name","match
$u isa user;
$r isa review;
$b isa business, has city ""San Mateo"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""name"": $u.name
};"
746,How many categories are there for businesses in 'Missoula'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula'
RETURN COUNT(DISTINCT c.name) AS numberOfCategories","match
$b isa business, has city ""Missoula"";
in_category (business: $b, category: $c);
$c has name $n;
select $n;
distinct;
reduce $count = count;"
747,List the top 3 most recent reviews.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN r.date AS reviewDate, r.text AS reviewText, r.stars AS reviewStars, u.name AS userName, b.name AS businessName
ORDER BY r.date DESC
LIMIT 3","match
$u isa user, has name $userName;
$r isa review, has date $reviewDate, has text $reviewText, has stars $reviewStars;
$b isa business, has name $businessName;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
sort $reviewDate desc;
limit 3;
fetch {
  ""reviewDate"": $reviewDate,
  ""reviewText"": $reviewText,
  ""reviewStars"": $reviewStars,
  ""userName"": $userName,
  ""businessName"": $businessName
};"
748,What is the average number of stars given by each user?,"MATCH (u:User)-[:WROTE]->(r:Review)
RETURN u.name AS userName, AVG(r.stars) AS averageStars","match
$u isa user, has name $name;
$r isa review, has stars $stars;
wrote (author: $u, review: $r);
reduce $avg_stars = mean($stars) groupby $name;
fetch { ""userName"": $name, ""averageStars"": $avg_stars };"
749,How many businesses are there in each city?,"MATCH (b:Business)
RETURN b.city AS city, COUNT(b) AS numberOfBusinesses
ORDER BY city","match
$b isa business, has city $city;
reduce $count = count($b) groupby $city;
sort $city asc;"
750,Which business has the most diverse range of review star ratings?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, collect(r.stars) AS starRatings
RETURN b.name AS businessName, size(apoc.coll.toSet(starRatings)) AS uniqueStarRatingsCount
ORDER BY uniqueStarRatingsCount DESC
LIMIT 1","match
$b isa business;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
select $b, $s;
distinct;
reduce $count = count groupby $b;
sort $count desc;
limit 1;
fetch { ""businessName"": $b.name };"
751,How many businesses are reviewed by users named 'Bob'?,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN COUNT(DISTINCT b) AS numberOfBusinessesReviewed","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b isa business;
select $b;
distinct;
reduce $count = count;"
753,Find the top 5 businesses with the lowest average stars rating.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, AVG(r.stars) AS avgRating
ORDER BY avgRating ASC
LIMIT 5
RETURN b.name AS businessName, avgRating","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
reduce $avg = mean($s) groupby $b;
sort $avg asc;
limit 5;
fetch { ""businessName"": $b.name, ""avgRating"": $avg };"
754,Which categories contain exactly three businesses?,"MATCH (c:Category)<-[:IN_CATEGORY]-(b:Business)
WITH c, COUNT(b) AS businessCount
WHERE businessCount = 3
RETURN c.name AS categoryName","match
$c isa category;
$b isa business;
in_category (business: $b, category: $c);
reduce $count = count($b) groupby $c;
match $count == 3;
fetch { ""categoryName"": $c.name };"
755,List all businesses and their corresponding reviews from 'Burlingame'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
$b isa business, has city ""Burlingame"", has name $bn;
in_category (business: $b, category: $c);
reviews (review: $r, reviewed_business: $b);
$r has text $rt, has stars $rs, has date $rd;
fetch {
  ""businessName"": $bn,
  ""reviewText"": $rt,
  ""reviewStars"": $rs,
  ""reviewDate"": $rd
};"
756,Which user has reviewed the most businesses in 'Beer' category?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Beer'})
WITH u, COUNT(DISTINCT b) AS businessCount
RETURN u.name AS userName, businessCount
ORDER BY businessCount DESC
LIMIT 1","match
  $u isa user;
  $r isa review;
  $b isa business;
  $c isa category, has name ""Beer"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  in_category (business: $b, category: $c);
select $u, $b;
distinct;
reduce $count = count($b) groupby $u;
sort $count desc;
limit 1;
fetch {
  ""userName"": $u.name,
  ""businessCount"": $count
};"
757,What are the names of users who have reviewed 'Neo4j'?,"MATCH (b:Business {name: 'Neo4j'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN u.name","match
$b isa business, has name ""Neo4j"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
wrote (author: $u, review: $r);
fetch {
  ""name"": $u.name
};"
758,List all reviews written in 2017.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS stars, r.date AS reviewDate, u.name AS userName, b.name AS businessName","match
$u isa user, has name $un;
$r isa review, has review_id $rid, has text $rt, has stars $s, has date $d;
$b isa business, has name $bn;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$d >= 2017-01-01T00:00:00 ;
$d <= 2017-12-31T23:59:59 ;
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $rt,
  ""stars"": $s,
  ""reviewDate"": $d,
  ""userName"": $un,
  ""businessName"": $bn
};"
759,List the addresses of businesses that have no reviews.,"MATCH (b:Business)
WHERE NOT (b)<-[:REVIEWS]-(:Review)
RETURN b.address","match
$b isa business;
not { reviews (reviewed_business: $b); };
fetch {
  ""address"": $b.address
};"
760,List the names of all businesses in the 'Library' category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Library'})
RETURN b.name AS businessName","match
$b isa business;
$c isa category, has name ""Library"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name
};"
761,Which business in 'Missoula' has the highest star rating based on reviews?,"MATCH (b:Business {city: 'Missoula'})&lt;-[:REVIEWS]-(r:Review)
RETURN b.name, AVG(r.stars) AS avgRating
ORDER BY avgRating DESC
LIMIT 1","match
$b isa business, has city ""Missoula"", has name $name;
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b, $name;
sort $avg desc;
limit 1;
fetch {
  ""name"": $name,
  ""avgRating"": $avg
};"
762,Show all reviews written by 'Jenny' for businesses in 'Coffee' category.,"MATCH (u:User {name: 'Jenny'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
RETURN r","match
  $u isa user, has name ""Jenny"";
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  in_category (business: $b, category: $c);
  $c isa category, has name ""Coffee"";
fetch {
  ""review_id"": $r.review_id,
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars
};"
763,Find the businesses in 'Burlingame' that are located on 'California Dr' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Burlingame' AND b.address CONTAINS 'California Dr'
RETURN b.name AS businessName, c.name AS categoryName","match
$b isa business, has city ""Burlingame"", has address $addr;
$addr like "".*California Dr.*"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $b.name,
  ""categoryName"": $c.name
};"
764,List all reviews for businesses in 'San Mateo' with a review text containing 'leading'.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b), 
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'San Mateo' AND r.text CONTAINS 'leading'
RETURN r.reviewId AS reviewId, r.text AS reviewText, r.stars AS stars, r.date AS reviewDate, b.name AS businessName, u.name AS userName","match
$b isa business, has city ""San Mateo"", has name $bn;
$r isa review, has review_id $rid, has text $rt, has stars $rs, has date $rd;
$rt like "".*leading.*"";
reviews (reviewed_business: $b, review: $r);
$u isa user, has name $un;
wrote (author: $u, review: $r);
fetch {
  ""reviewId"": $rid,
  ""reviewText"": $rt,
  ""stars"": $rs,
  ""reviewDate"": $rd,
  ""businessName"": $bn,
  ""userName"": $un
};"
765,Display the names and addresses of businesses in 'MT' with reviews dated before 2017.,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'MT' AND r.date < date('2017-01-01')
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has state ""MT"", has name $name, has address $addr;
$r isa review, has date $d;
reviews (review: $r, reviewed_business: $b);
$d < 2017-01-01T00:00:00;
fetch {
  ""businessName"": $name,
  ""businessAddress"": $addr
};"
767,Which businesses in 'CA' have a 'Coffee' category and what are their review ratings?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category {name: 'Coffee'})
WHERE b.state = 'CA'
MATCH (r:Review)-[:REVIEWS]->(b)
RETURN b.name AS BusinessName, r.stars AS ReviewRating","match
$b isa business, has state ""CA"", has name $bn;
$c isa category, has name ""Coffee"";
in_category (business: $b, category: $c);
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""BusinessName"": $bn,
  ""ReviewRating"": $s
};"
768,Which businesses are located in Missoula and in the 'Beer' category?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'Missoula' AND c.name = 'Beer'
RETURN b.name AS businessName, b.address AS businessAddress","match
$b isa business, has city ""Missoula"", has name $bn, has address $ba;
$c isa category, has name ""Beer"";
in_category (business: $b, category: $c);
fetch {
  ""businessName"": $bn,
  ""businessAddress"": $ba
};"
769,What is the text of the review with the lowest stars rating?,"MATCH (r:Review)
WITH r
ORDER BY r.stars ASC
LIMIT 1
RETURN r.text","match
$r isa review, has stars $s, has text $t;
sort $s asc;
limit 1;
fetch {
  ""text"": $t
};"
770,List the top 5 reviews with the highest stars rating.,"MATCH (r:Review)-[:REVIEWS]->(b:Business)
RETURN r.text AS reviewText, r.stars AS rating, b.name AS businessName
ORDER BY r.stars DESC
LIMIT 5","match
$r isa review, has text $text, has stars $stars;
$b isa business, has name $bname;
reviews (review: $r, reviewed_business: $b);
sort $stars desc;
limit 5;
fetch {
  ""reviewText"": $text,
  ""rating"": $stars,
  ""businessName"": $bname
};"
771,What are the addresses of businesses reviewed by user 'Will'?,"MATCH (u:User {name: 'Will'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN b.address","match
$u isa user, has name ""Will"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""address"": $b.address
};"
772,Find the top 3 businesses with the highest number of reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN b.name AS businessName, reviewCount","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 3;
fetch { ""businessName"": $b.name, ""reviewCount"": $count };"
773,Which business has the most reviews in San Mateo?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'San Mateo'
RETURN b.name AS business, COUNT(r) AS review_count
ORDER BY review_count DESC
LIMIT 1","match
$b isa business, has city ""San Mateo"";
$r isa review;
reviews (review: $r, reviewed_business: $b);
reduce $count = count($r) groupby $b;
sort $count desc;
limit 1;
fetch { ""business"": $b.name, ""review_count"": $count };"
774,List all the businesses along 'W Broadway St' and their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'W Broadway St'
RETURN b.name AS BusinessName, c.name AS Category","match
$b isa business, has address $addr;
$addr like "".*W Broadway St.*"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""BusinessName"": $b.name,
  ""Category"": $c.name
};"
775,What is the average stars rating for businesses in Burlingame?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN avg(r.stars) AS average_rating","match
$b isa business, has city ""Burlingame"";
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
in_category (business: $b);
reduce $avg = mean($s);"
776,How many reviews have been written for 'KettleHouse Brewing Co.'?,"MATCH (b:Business {name: 'KettleHouse Brewing Co.'})&lt;-[:REVIEWS]-(r:Review)
RETURN count(r) AS numberOfReviews","match
$b isa business, has name ""KettleHouse Brewing Co."";
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r);"
777,List the top 3 users by the number of reviews they have written.,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3
RETURN u.name AS userName, reviewCount","match
$u isa user;
$r isa review;
wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
778,Which users have written more than one review?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN u.name AS userName, reviewCount","match $u isa user; $r isa review; wrote (author: $u, review: $r);
reduce $count = count($r) groupby $u;
match $count > 1;
fetch { ""userName"": $u.name, ""reviewCount"": $count };"
779,List all the categories represented by businesses in 'San Mateo'.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN DISTINCT c.name AS category","match
$b isa business, has city ""San Mateo"";
$c isa category, has name $cat_name;
in_category (business: $b, category: $c);
select $cat_name;
distinct;
fetch { ""category"": $cat_name };"
780,Which business in 'San Mateo' has reviews with an average star rating above 4.5?,"MATCH (b:Business {city: 'San Mateo'})<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating
WHERE avgRating > 4.5
RETURN b.name AS businessName, avgRating","match
$b isa business, has city ""San Mateo"";
$r isa review, has stars $s;
reviews (review: $r, reviewed_business: $b);
reduce $avg = mean($s) groupby $b;
match $avg > 4.5;
fetch {
  ""businessName"": $b.name,
  ""avgRating"": $avg
};"
781,What is the total number of reviews written in 2016?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2016-01-01') AND r.date < date('2017-01-01')
RETURN count(r) AS total_reviews_2016","match
$r isa review, has date $d;
wrote (author: $u, review: $r);
$d >= 2016-01-01T00:00:00;
$d < 2017-01-01T00:00:00;
reduce $count = count($r);"
782,What are the reviews mentioning 'farmer's market'?,"MATCH (r:Review)
WHERE r.text CONTAINS ""farmer's market""
RETURN r","match
$r isa review, has text $t;
$t like "".*farmer's market.*"";
fetch {
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars,
  ""review_id"": $r.review_id
};"
783,Which business has the most categories associated with it?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, COUNT(c) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 1
RETURN b.name AS businessName, categoryCount","match
$b isa business;
$c isa category;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
sort $count desc;
limit 1;
fetch { ""businessName"": $b.name, ""categoryCount"": $count };"
784,List the reviews written by users in 'MT'.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE b.state = 'MT'
RETURN u.name AS userName, r.text AS reviewText, r.date AS reviewDate, r.stars AS reviewStars, b.name AS businessName","match
$u isa user, has name $uname;
$r isa review, has text $rtext, has date $rdate, has stars $rstars;
$b isa business, has state ""MT"", has name $bname;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
fetch {
  ""userName"": $uname,
  ""reviewText"": $rtext,
  ""reviewDate"": $rdate,
  ""reviewStars"": $rstars,
  ""businessName"": $bname
};"
785,Show the businesses that have been reviewed by users named Bob and have a star rating above 4.,"MATCH (u:User {name: 'Bob'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.stars > 4
RETURN b.name AS BusinessName, b.address AS Address, b.city AS City, b.state AS State","match
$u isa user, has name ""Bob"";
wrote (author: $u, review: $r);
$r has stars $s;
$s > 4.0;
reviews (review: $r, reviewed_business: $b);
fetch {
  ""BusinessName"": $b.name,
  ""Address"": $b.address,
  ""City"": $b.city,
  ""State"": $b.state
};"
786,List the reviews for businesses that have been reviewed exactly twice.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount = 2
MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN b.name AS businessName, r.text AS reviewText, r.stars AS reviewStars, r.date AS reviewDate","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match
$count == 2;
$r2 isa review;
reviews (reviewed_business: $b, review: $r2);
$r2 has text $text;
$r2 has stars $stars;
$r2 has date $date;
fetch {
  ""businessName"": $b.name,
  ""reviewText"": $text,
  ""reviewStars"": $stars,
  ""reviewDate"": $date
};"
787,Which businesses have reviews mentioning 'world leading'?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.text CONTAINS 'world leading'
RETURN b.name","match
$b isa business;
$r isa review, has text $t;
$t like "".*world leading.*"";
reviews (reviewed_business: $b, review: $r);
fetch {
  ""name"": $b.name
};"
788,What is the city of the business named 'Zootown Brew'?,"MATCH (b:Business {name: 'Zootown Brew'})
RETURN b.city AS city","match
$b isa business, has name ""Zootown Brew"";
fetch {
  ""city"": $b.city
};"
789,Which businesses have a user review mentioning 'comfortable places'?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.text CONTAINS 'comfortable places'
RETURN b.name AS businessName","match
  $u isa user;
  $r isa review, has text $t;
  $b isa business;
  wrote (author: $u, review: $r);
  reviews (review: $r, reviewed_business: $b);
  $t like "".*comfortable places.*"";
fetch {
  ""businessName"": $b.name
};"
790,How many businesses in 'MT' have been reviewed more than once?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b)
WHERE b.state = 'MT'
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount > 1
RETURN COUNT(b) AS numberOfBusinesses","match
  $b isa business, has state ""MT"";
  $r isa review;
  reviews (review: $r, reviewed_business: $b);
reduce $reviewCount = count($r) groupby $b;
match $reviewCount > 1;
reduce $count = count($b);"
791,What are the cities with businesses that have been reviewed exactly twice?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, COUNT(r) AS reviewCount
WHERE reviewCount = 2
RETURN DISTINCT b.city","match
$b isa business;
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $count = count($r) groupby $b;
match $count == 2;
$b has city $c;
select $c;
distinct;
fetch { ""city"": $c };"
792,Which user's reviews have the highest average stars rating?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, avg(r.stars) AS avgStars
ORDER BY avgStars DESC
LIMIT 1
RETURN u.name AS userName, avgStars","match
$u isa user;
$r isa review, has stars $s;
wrote (author: $u, review: $r);
reduce $avg = mean($s) groupby $u;
sort $avg desc;
limit 1;
fetch { ""userName"": $u.name, ""avgStars"": $avg };"
793,How many reviews are there with a stars rating exactly 3.5?,"MATCH (r:Review)
WHERE r.stars = 3.5
RETURN count(r) AS numberOfReviews","match
$r isa review, has stars $s;
$s == 3.5;
reduce $count = count($r);"
794,Which reviews mention 'great selection'?,"MATCH (r:Review)
WHERE r.text CONTAINS 'great selection'
RETURN r.reviewId, r.text","match
$r isa review, has text $t, has review_id $rid;
$t like "".*great selection.*"";
fetch {
  ""reviewId"": $r.review_id,
  ""text"": $r.text
};"
795,List all businesses with more than one category.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WITH b, COUNT(c) AS categoryCount
WHERE categoryCount > 1
RETURN b.name AS businessName, categoryCount","match
$b isa business;
in_category (business: $b, category: $c);
reduce $count = count($c) groupby $b;
match
$count > 1;
fetch {
  ""businessName"": $b.name,
  ""categoryCount"": $count
};"
796,Which users have not written any reviews?,"MATCH (u:User)
WHERE NOT (u)-[:WROTE]->(:Review)
RETURN u.name AS userName","match
$u isa user, has name $n;
not { wrote (author: $u); };
fetch {
  ""userName"": $n
};"
797,Find the top 3 businesses with the most diverse range of star ratings in their reviews.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, collect(r.stars) AS starRatings
RETURN b.name, b.businessId, size(apoc.coll.toSet(starRatings)) AS uniqueStarCount
ORDER BY uniqueStarCount DESC
LIMIT 3","match
$b isa business;
$r isa review, has stars $s;
reviews (reviewed_business: $b, review: $r);
select $b, $s;
distinct;
reduce $count = count groupby $b;
sort $count desc;
limit 3;
fetch {
  ""name"": $b.name,
  ""business_id"": $b.business_id,
  ""unique_star_count"": $count
};"
798,Which user has given the lowest average star rating?,"MATCH (u:User)-[:WROTE]->(r:Review)
WITH u, avg(r.stars) AS avgStars
ORDER BY avgStars ASC
LIMIT 1
RETURN u.name AS userName, avgStars","match
$u isa user;
wrote (author: $u, review: $r);
$r has stars $s;
reduce $avg = mean($s) groupby $u;
sort $avg asc;
limit 1;
fetch {
  ""userName"": $u.name,
  ""avgStars"": $avg
};"
799,List all reviews that have exactly 4.0 stars.,"MATCH (r:Review)
WHERE r.stars = 4.0
RETURN r","match
$r isa review, has stars 4.0;
fetch {
  ""review_id"": $r.review_id,
  ""date"": $r.date,
  ""text"": $r.text,
  ""stars"": $r.stars
};"
800,Which business located on 'E Front St' has the highest number of reviews?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.address CONTAINS 'E Front St'
WITH b, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 1
RETURN b.name AS businessName, reviewCount","match
$b isa business, has address $addr, has name $bname;
$addr like "".*E Front St.*"";
$r isa review;
reviews (reviewed_business: $b, review: $r);
reduce $reviewCount = count($r) groupby $b, $bname;
sort $reviewCount desc;
limit 1;
fetch {
  ""businessName"": $bname,
  ""reviewCount"": $reviewCount
};"
801,How many businesses are there in 'CA' with a perfect 5-star review?,"MATCH (b:Business)-[:REVIEWS]-(r:Review)
WHERE b.state = 'CA' AND r.stars = 5.0
RETURN count(DISTINCT b) AS numberOfBusinesses","match
$b isa business, has state ""CA"";
$r isa review, has stars 5.0;
reviews (reviewed_business: $b, review: $r);
select $b;
distinct;
reduce $count = count($b);"
802,What are the categories of businesses located on 'Main St'?,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.address CONTAINS 'Main St'
RETURN DISTINCT c.name AS category","match
$b isa business, has address $addr;
$addr like "".*Main St.*"";
$c isa category;
in_category (business: $b, category: $c);
fetch {
  ""category"": $c.name
};"
803,Which reviews mention 'selection' in their text?,"MATCH (r:Review)
WHERE r.text CONTAINS 'selection'
RETURN r.reviewId, r.text","match
$r isa review, has text $t, has review_id $rid;
$t like "".*selection.*"";
fetch {
  ""review_id"": $rid,
  ""text"": $t
};"
804,What are the names of all categories a business in '200 W Pine St' belongs to?,"MATCH (b:Business {address: '200 W Pine St'})-[:IN_CATEGORY]->(c:Category)
RETURN c.name AS categoryName","match
$b isa business, has address ""200 W Pine St"";
in_category (business: $b, category: $c);
$c isa category;
fetch {
  ""categoryName"": $c.name
};"
805,What is the city with the least number of businesses?,"MATCH (b:Business)
WITH b.city AS city, COUNT(b) AS business_count
RETURN city
ORDER BY business_count ASC
LIMIT 1","match
$b isa business, has city $city;
reduce $count = count($b) groupby $city;
sort $count asc;
limit 1;
fetch { ""city"": $city };"
806,How many businesses have reviews with stars rating less than 4.0?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.stars < 4.0
RETURN COUNT(DISTINCT b) AS numberOfBusinesses","match
$b isa business;
$r isa review, has stars $s;
$s < 4.0;
reviews (reviewed_business: $b, review: $r);
select $b;
distinct;
reduce $count = count;"
384,What are the names of businesses with addresses in 'Burlingame' and have been reviewed?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Burlingame'
RETURN DISTINCT b.name","match
$b isa business, has city ""Burlingame"", has name $n;
in_category (business: $b, category: $c);
reviews (review: $r, reviewed_business: $b);
select $n;
distinct;
fetch { ""name"": $n };"
430,What are the names of 3 businesses with reviews written in August 2015?,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WHERE r.date >= date('2015-08-01') AND r.date < date('2015-09-01')
RETURN DISTINCT b.name
LIMIT 3","match
$u isa user;
$r isa review, has date $d;
$b isa business, has name $n;
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$d >= 2015-08-01T00:00:00;
$d < 2015-09-01T00:00:00;
select $n;
distinct;
limit 3;
fetch { ""name"": $n };"
532,Which businesses in 'San Mateo' have been reviewed in 2017?,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), 
      (r:Review)-[:REVIEWS]->(b),
      (u:User)-[:WROTE]->(r)
WHERE b.city = 'San Mateo' AND r.date >= date('2017-01-01') AND r.date <= date('2017-12-31')
RETURN b.name AS BusinessName","match
  $b isa business, has city ""San Mateo"", has name $n;
  $c isa category;
  in_category (business: $b, category: $c);
  $r isa review, has date $d;
  reviews (review: $r, reviewed_business: $b);
  $u isa user;
  wrote (author: $u, review: $r);
  $d >= 2017-01-01T00:00:00;
  $d <= 2017-12-31T23:59:59;
fetch {
  ""BusinessName"": $n
};"
591,Show all businesses that have been reviewed in January of any year.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date('2015-01-01') AND r.date < date('2015-02-01')
   OR r.date >= date('2016-01-01') AND r.date < date('2016-02-01')
   OR r.date >= date('2017-01-01') AND r.date < date('2017-02-01')
   OR r.date >= date('2018-01-01') AND r.date < date('2018-02-01')
RETURN DISTINCT b.name","match
  $b isa business;
  $r isa review, has date $d;
  reviews (review: $r, reviewed_business: $b);
  {
    $d >= 2015-01-01T00:00:00; $d < 2015-02-01T00:00:00;
  } or {
    $d >= 2016-01-01T00:00:00; $d < 2016-02-01T00:00:00;
  } or {
    $d >= 2017-01-01T00:00:00; $d < 2017-02-01T00:00:00;
  } or {
    $d >= 2018-01-01T00:00:00; $d < 2018-02-01T00:00:00;
  };
select $b;
distinct;
fetch {
  ""name"": $b.name
};"
684,Which businesses have reviews written in 2016?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE r.date >= date(2016-01-01) AND r.date < date(2017-01-01)
RETURN DISTINCT b.name","match
$b isa business;
$r isa review, has date $d;
reviews (reviewed_business: $b, review: $r);
$d >= 2016-01-01T00:00:00;
$d < 2017-01-01T00:00:00;
select $b;
distinct;
fetch {
  ""name"": $b.name
};"
752,What are the cities of the businesses reviewed by 'Angie'?,"MATCH (u:User {name: 'Angie'})-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
RETURN DISTINCT b.city AS city","match
$u isa user, has name ""Angie"";
wrote (author: $u, review: $r);
reviews (review: $r, reviewed_business: $b);
$b has city $c;
select $c;
distinct;
fetch { ""city"": $c };"
