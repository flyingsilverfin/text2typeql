original_index,question,cypher,error
26,Which user has reviewed the most categories of businesses and what are those categories?,"// Step 1: Find the number of unique categories each user has reviewed
MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)-[:IN_CATEGORY]->(c:Category)
WITH u, collect(DISTINCT c.name) AS categories
RETURN u.name AS user, categories, size(categories) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 1",Unsupported: collect() and size() have no TypeQL equivalent. Query requires collecting distinct category names into a list and computing its size.
36,Which business in 'San Mateo' has the highest average review star rating and what are its reviews?,"MATCH (b:Business {city: 'San Mateo'})<-[:REVIEWS]-(r:Review)
WITH b, avg(r.stars) AS avgRating, collect(r) AS reviews
ORDER BY avgRating DESC
LIMIT 1
RETURN b.name AS businessName, avgRating, reviews","Cypher uses collect(r) to aggregate review objects into a list. TypeQL has no collect() equivalent. Additionally, returning both an aggregation (avg stars) and individual review details requires re-matching after reduce, which is not supported."
174,Find the top 3 longest reviews for businesses in 'Missoula' and the corresponding businesses names.,"MATCH (b:Business)-[:IN_CATEGORY]->(:Category), (r:Review)-[:REVIEWS]->(b)
WHERE b.city = 'Missoula'
WITH r, b
ORDER BY size(r.text) DESC
LIMIT 3
RETURN r.text AS reviewText, b.name AS businessName",Unsupported feature: size() string length function has no TypeQL equivalent. Cannot sort by string length.
179,Which businesses in 'Missoula' have been reviewed by all listed users and what are the review texts?,"MATCH (b:Business {city: 'Missoula'})<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
WITH b, collect(u.userId) AS reviewers, collect(r.text) AS review_texts
WHERE reviewers = ['u1', 'u2', 'u3', 'u4']
RETURN b.name AS business_name, review_texts",Cypher uses collect() to gather user IDs into a list and compare against a fixed array. collect() is not supported in TypeQL 3.0.
202,Show the top 3 business names in San Mateo along with their categories.,"MATCH (b:Business)-[:IN_CATEGORY]->(c:Category)
WHERE b.city = 'San Mateo'
RETURN b.name AS businessName, collect(c.name) AS categories
ORDER BY b.name
LIMIT 3",Cypher uses collect() to aggregate categories into a list per business. collect() is unsupported in TypeQL.
219,List the top 3 businesses with reviews from the latest three different users.,"MATCH (u:User)-[:WROTE]->(r:Review)-[:REVIEWS]->(b:Business)
WITH u, r, b
ORDER BY r.date DESC
WITH u, r, b, COLLECT(DISTINCT u.userId) AS latestUsers
WHERE SIZE(latestUsers) >= 3
WITH u, r, b, latestUsers[0..3] AS topUsers
WHERE u.userId IN topUsers
RETURN b.name AS businessName, COUNT(r) AS reviewCount
ORDER BY reviewCount DESC
LIMIT 3","Unsupported features: COLLECT(), SIZE(), and array slicing [0..3] have no TypeQL equivalents"
229,Find the top 3 businesses that have reviews from the earliest three different dates.,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WITH b, r
ORDER BY r.date ASC
WITH b, collect(r.date) AS reviewDates
UNWIND reviewDates AS date
WITH b, date
ORDER BY date ASC
WITH b, collect(date)[0..3] AS earliestDates
WHERE size(earliestDates) = 3
RETURN b.name AS businessName, earliestDates
LIMIT 3","Unsupported features: collect(), array slicing [0..3], and size() are not available in TypeQL 3.0. The query requires collecting dates into a list, slicing the first 3, and checking the list size."
238,What are the first 3 businesses with reviews that have a text length greater than 50 characters?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE size(r.text) > 50
RETURN b.name, b.address, b.city, b.state, b.businessId
ORDER BY b.name
LIMIT 3",Unsupported: size() string length function has no TypeQL equivalent
356,What are the names of businesses that have a point location latitude greater than 46.87?,"MATCH (b:Business)
WHERE b.location.latitude > 46.87
RETURN b.name",Neo4j Point type property access (location.latitude) not supported. Schema stores location as string; no numeric latitude attribute available for comparison.
460,Which businesses have a POINT location with a latitude greater than 37 degrees?,"MATCH (b:Business)
WHERE b.location.latitude > 37
RETURN b.name AS businessName, b.location AS location","Cypher uses Neo4j spatial POINT type with .latitude sub-property access. TypeQL schema stores location as string; no way to extract latitude from a string attribute (no split, substring, or point type support)."
513,List all categories for 'Ducky's Car Wash' and its reviews.,"MATCH (b:Business {name: ""Ducky's Car Wash""})-[:IN_CATEGORY]->(c:Category)
OPTIONAL MATCH (b)<-[:REVIEWS]-(r:Review)
RETURN c.name AS category, collect(r) AS reviews",Unsupported feature: collect() aggregation is not available in TypeQL
693,Which businesses have reviews with a text length over 100 characters?,"MATCH (b:Business)<-[:REVIEWS]-(r:Review)
WHERE size(r.text) > 100
RETURN b.name AS businessName",Cypher uses size() for string length which is unsupported in TypeQL
745,Which business has the longest name and what is its location?,"MATCH (b:Business)
WITH b, size(b.name) AS nameLength
ORDER BY nameLength DESC
LIMIT 1
RETURN b.name AS businessName, b.location AS location",Unsupported feature: size() string length function has no TypeQL equivalent
766,What are the businesses located at '200 W Pine St' and their reviews?,"MATCH (b:Business {address: '200 W Pine St'})-[:IN_CATEGORY]->(c:Category)
OPTIONAL MATCH (b)<-[:REVIEWS]-(r:Review)<-[:WROTE]-(u:User)
RETURN b.name AS businessName, b.address AS address, collect({
    reviewText: r.text, 
    reviewStars: r.stars, 
    reviewDate: r.date, 
    reviewerName: u.name
}) AS reviews","Cypher uses collect() with object literal to aggregate review properties into a list of maps, which is unsupported in TypeQL"
