original_index,question,cypher,typeql
0,Which product categories do not have any discontinued items?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.discontinued = false
WITH c, COUNT(p) AS activeProducts
MATCH (c)<-[:PART_OF]-(allProducts:Product)
WITH c, activeProducts, COUNT(allProducts) AS totalProducts
WHERE activeProducts = totalProducts
RETURN c.categoryName","match
$c isa category;
part_of (product: $p, category: $c);
not {
  part_of (product: $d, category: $c);
  $d has discontinued true;
};
fetch {
  ""categoryName"": $c.category_name
};"
1,Which products are supplied by suppliers from the UK?,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has country ""UK"";
supplies (supplier: $s, product: $p);
fetch { ""productName"": $p.product_name };"
2,Find the top 5 most frequently ordered products.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product;
$rel isa orders (order: $o, product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $count };"
3,List three customers who have purchased products ordered on '1996-07-04 00:00:00.000'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.orderDate = '1996-07-04 00:00:00.000'
RETURN DISTINCT c.companyName
LIMIT 3","match
$c isa customer, has company_name $cn;
$o isa order, has order_date ""1996-07-04 00:00:00.000"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $cn;
distinct;
limit 3;
fetch { ""companyName"": $cn };"
4,Which suppliers supply products to more than five different categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 5
RETURN s.companyName","match
$s isa supplier;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $count = count groupby $s;
match $count > 5;
fetch { ""companyName"": $s.company_name };"
5,What are the top 5 suppliers by number of products supplied?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
6,What are the top 3 categories with the most products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
RETURN category, productCount
ORDER BY productCount DESC
LIMIT 3","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $c;
sort $product_count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $product_count
};"
7,List all products that have 'seafood' in their category description.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description CONTAINS 'seafood'
RETURN p.productName AS productName, p.productID AS productID, c.categoryName AS categoryName, c.description AS categoryDescription","match
$p isa product;
$c isa category, has description $desc;
$desc like "".*seafood.*"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""categoryName"": $c.category_name,
  ""categoryDescription"": $desc
};"
8,List the top 5 orders with the highest quantity ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$o isa order;
$rel isa orders (order: $o), has quantity $q;
reduce $total = sum($q) groupby $o;
sort $total desc;
limit 5;
fetch { ""orderID"": $o.order_id, ""totalQuantity"": $total };"
9,Which categories include products with a reorder level of 25?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 25
RETURN DISTINCT c.categoryName","match
$p isa product, has reorder_level 25;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch { ""categoryName"": $c.category_name };"
10,Which products have a reorder level greater than 20 and are not discontinued?,"MATCH (p:Product)
WHERE p.reorderLevel > 20 AND p.discontinued = false
RETURN p.productName, p.reorderLevel, p.discontinued","match
$p isa product, has reorder_level $rl, has discontinued false;
$rl > 20;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl,
  ""discontinued"": $p.discontinued
};"
11,What are the top 3 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
12,Can you find three suppliers who supply 'Chang'?,"MATCH (p:Product {productName: 'Chang'})<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName
LIMIT 3","match
$p isa product, has product_name ""Chang"";
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
13,What are the three products with the highest units on order?,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has product_name $name, has units_on_order $units;
sort $units desc;
limit 3;
fetch {
  ""productName"": $name,
  ""unitsOnOrder"": $units
};"
14,List the top 5 products that have been discontinued.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.productID
ORDER BY p.productName
LIMIT 5","match
$p isa product, has discontinued true, has product_name $name, has product_id $id;
sort $name;
limit 5;
fetch {
  ""productName"": $name,
  ""productID"": $id
};"
15,Who are the top 3 customers by number of orders placed in 1996?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.orderDate STARTS WITH '1996'
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.customerID, c.companyName, orderCount","match
$c isa customer;
$o isa order, has order_date $od;
$od like ""1996.*"";
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customer_id"": $c.customer_id,
  ""company_name"": $c.company_name,
  ""order_count"": $order_count
};"
16,What are the names of the top 3 products with the highest units on order and are part of the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has units_on_order $units;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
sort $units desc;
limit 3;
fetch {
  ""productName"": $p.product_name
};"
17,Which products have a quantity per unit of '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p.productName","match
$p isa product, has quantity_per_unit ""10 boxes x 20 bags"";
fetch {
  ""productName"": $p.product_name
};"
18,List the first 3 products with a discontinued status and a reorder level greater than 15.,"MATCH (p:Product)
WHERE p.discontinued = true AND p.reorderLevel > 15
RETURN p.productName, p.reorderLevel
ORDER BY p.productName
LIMIT 3","match
$p isa product, has discontinued true, has reorder_level $rl, has product_name $pn;
$rl > 15;
sort $pn;
limit 3;
fetch {
  ""productName"": $pn,
  ""reorderLevel"": $rl
};"
19,Which product supplied by 'Exotic Liquids' has the least units in stock?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 1","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has units_in_stock $stock;
sort $stock asc;
limit 1;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
20,Which categories have the least products available in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsInStock > 0
WITH c.categoryName AS category, COUNT(p) AS productCount
RETURN category
ORDER BY productCount ASC
LIMIT 1","match
$p isa product, has units_in_stock $stock;
$stock > 0;
part_of (product: $p, category: $c);
$c has category_name $name;
reduce $count = count($p) groupby $c, $name;
sort $count asc;
limit 1;
fetch { ""category"": $name };"
21,Find the top 3 orders by freight cost.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 3","match
$o isa order, has order_id $oid, has freight $f;
sort $f desc;
limit 3;
fetch {
  ""orderID"": $oid,
  ""freight"": $f
};"
22,Find the top 5 most costly products in terms of unit price supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
23,Which products have been reordered when the stock level was below 5?,"MATCH (p:Product)
WHERE p.unitsInStock < 5 AND p.reorderLevel > 0
RETURN p.productName, p.unitsInStock, p.reorderLevel","match
$p isa product, has units_in_stock $stock, has reorder_level $reorder;
$stock < 5;
$reorder > 0;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock,
  ""reorderLevel"": $reorder
};"
24,Which orders have a required date later than '1997-01-01' and were ordered by customers from 'Berlin'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.city = 'Berlin' AND o.requiredDate > '1997-01-01'
RETURN o.orderID, o.requiredDate, c.companyName, c.contactName","match
$c isa customer, has city ""Berlin"";
$o isa order, has required_date $rd;
$rd > ""1997-01-01"";
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $o.order_id,
  ""requiredDate"": $o.required_date,
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name
};"
25,Which products have a unitsInStock count between 10 and 20?,"MATCH (p:Product)
WHERE p.unitsInStock >= 10 AND p.unitsInStock <= 20
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$stock >= 10;
$stock <= 20;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
26,What are the top 5 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
27,List the first 3 categories that have products with a unit price over $100.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
RETURN DISTINCT c.categoryName
LIMIT 3","match
$p isa product, has unit_price $up;
$up > 100;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
limit 3;
fetch { ""categoryName"": $cn };"
28,Which suppliers have a product named 'Chai' in their product list?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product {productName: 'Chai'})
RETURN s.companyName","match
$s isa supplier;
$p isa product, has product_name ""Chai"";
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
29,List three suppliers based in 'London'.,"MATCH (s:Supplier)
WHERE s.city = 'London'
RETURN s.companyName
LIMIT 3","match $s isa supplier, has city ""London"";
limit 3;
fetch { ""companyName"": $s.company_name };"
30,What are the top 5 products with the highest units in stock in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
$p has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
31,Find all products that are discontinued and supplied by a company in the UK.,"MATCH (p:Product)-[:SUPPLIES]-(s:Supplier)
WHERE p.discontinued = true AND s.country = 'UK'
RETURN p.productName AS productName, s.companyName AS supplierName","match
$p isa product, has discontinued true;
$s isa supplier, has country ""UK"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $s.company_name
};"
32,Which products have been ordered more than 100 times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WHERE o.quantity > 100
RETURN p.productName, SUM(o.quantity) AS totalOrdered
ORDER BY totalOrdered DESC","match
$p isa product;
$rel isa orders (order: $o, product: $p), has quantity $q;
reduce $total = sum($q) groupby $p;
match $total > 100;
sort $total desc;
fetch { ""productName"": $p.product_name, ""totalOrdered"": $total };"
33,What are the three most common product categories ordered in 'Reims'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WHERE o.shipCity = 'Reims'
RETURN c.categoryName, COUNT(p) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_city ""Reims"";
orders (order: $o, product: $p);
part_of (product: $p, category: $c);
$c has category_name $cn;
reduce $count = count($p) groupby $c, $cn;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $cn,
  ""orderCount"": $count
};"
34,Which suppliers provide products with a unit price less than $10?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice < 10
RETURN s.companyName AS SupplierName, p.productName AS ProductName, p.unitPrice AS UnitPrice","match
$s isa supplier;
$p isa product, has unit_price $up;
supplies (supplier: $s, product: $p);
$up < 10;
fetch {
  ""SupplierName"": $s.company_name,
  ""ProductName"": $p.product_name,
  ""UnitPrice"": $up
};"
35,List the top 5 customers based on the number of orders made.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 5;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
36,What is the average discount given on orders during '1996-07-04 00:00:00.000'?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate = '1996-07-04 00:00:00.000'
RETURN avg(toFloat(r.discount)) AS averageDiscount","match
$o isa order, has order_date ""1996-07-04 00:00:00.000"";
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
reduce $avg_discount = mean($d);"
37,Which orders include the product with productID '72'?,"MATCH (o:Order)-[:ORDERS]->(p:Product {productID: '72'})
RETURN o.orderID AS orderID, o.orderDate AS orderDate, o.shipName AS shipName, o.shipCity AS shipCity, o.shipCountry AS shipCountry","match
$o isa order;
$p isa product, has product_id ""72"";
orders (order: $o, product: $p);
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
38,List three products that are in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
limit 3;
fetch {
  ""productName"": $p.product_name
};"
39,Which categories have products with a unit price over $50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN DISTINCT c.categoryName","match
$p isa product, has unit_price $price;
$price > 50;
part_of (product: $p, category: $c);
$c has category_name $name;
select $name;
distinct;
fetch { ""categoryName"": $name };"
40,List the top 5 cities where the most products have been shipped.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WITH o.shipCity AS city, COUNT(p) AS productCount
RETURN city, productCount
ORDER BY productCount DESC
LIMIT 5","match
$o isa order, has ship_city $city;
$rel isa orders (order: $o, product: $p);
reduce $count = count($p) groupby $city;
sort $count desc;
limit 5;"
41,What are the names of the first 3 suppliers with a home page containing 'http'?,"MATCH (s:Supplier)
WHERE s.homePage CONTAINS 'http'
RETURN s.companyName
ORDER BY s.companyName
LIMIT 3","match
$s isa supplier, has home_page $hp, has company_name $cn;
$hp like "".*http.*"";
sort $cn;
limit 3;
fetch {
  ""companyName"": $cn
};"
42,What are the descriptions of categories that have products with a reorder level greater than 15?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 15
RETURN DISTINCT c.description","match
$p isa product, has reorder_level $rl;
$rl > 15;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch {
  ""description"": $c.description
};"
43,Which products are supplied by suppliers with a fax number of 'NULL'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.fax = 'NULL'
RETURN p.productName AS productName","match
$s isa supplier, has fax ""NULL"";
$p isa product;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
44,Which customers from 'Reims' have placed orders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipCity = 'Reims'
RETURN DISTINCT c.companyName AS customerName, c.contactName AS contactName, c.contactTitle AS contactTitle, c.city AS city, c.country AS country","match
$c isa customer,
    has company_name $company_name,
    has contact_name $contact_name,
    has contact_title $contact_title,
    has city $city,
    has country $country;
$o isa order, has ship_city ""Reims"";
purchased (customer: $c, order: $o);
select $c, $company_name, $contact_name, $contact_title, $city, $country;
distinct;
fetch {
    ""customerName"": $company_name,
    ""contactName"": $contact_name,
    ""contactTitle"": $contact_title,
    ""city"": $city,
    ""country"": $country
};"
45,What are the names of products with a reorder level greater than the average reorder level of all products?,"// First, calculate the average reorder level of all products
MATCH (p:Product)
WITH avg(p.reorderLevel) AS avgReorderLevel

// Then, find products with a reorder level greater than the average
MATCH (p:Product)
WHERE p.reorderLevel > avgReorderLevel
RETURN p.productName AS productName","with fun avg_reorder_level() -> double:
  match $p isa product, has reorder_level $rl;
  return mean($rl);
match
$p isa product, has reorder_level $rl;
let $avg = avg_reorder_level();
$rl > $avg;
fetch { ""productName"": $p.product_name };"
46,List the top 3 most reordered products.,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
47,Which suppliers have a contact name starting with 'C'?,"MATCH (s:Supplier)
WHERE s.contactName STARTS WITH 'C'
RETURN s.companyName AS SupplierName, s.contactName AS ContactName","match
$s isa supplier, has contact_name $cn;
$cn like ""C.*"";
fetch {
  ""SupplierName"": $s.company_name,
  ""ContactName"": $cn
};"
48,What are the top 3 products with the smallest discount?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH p.productName AS productName, r.discount AS discount
ORDER BY discount ASC
LIMIT 3
RETURN productName, discount","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
sort $d asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""discount"": $d
};"
49,List the first 3 categories where the average units in stock per product is less than 20.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, avg(p.unitsInStock) AS avgUnitsInStock
WHERE avgUnitsInStock < 20
RETURN c.categoryName, avgUnitsInStock
ORDER BY avgUnitsInStock
LIMIT 3","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $avg = mean($stock) groupby $c, $name;
match $avg < 20;
sort $avg;
limit 3;
fetch { ""categoryName"": $name, ""avgUnitsInStock"": $avg };"
50,Which orders have a ship via option of '3' and were shipped to 'USA'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '3' AND o.shipCountry = 'USA'
RETURN o.orderID AS orderID, o.shipName AS shipName, o.shipCity AS shipCity, o.shipAddress AS shipAddress, o.shipPostalCode AS shipPostalCode, o.shipCountry AS shipCountry, o.shipVia AS shipVia","match
$o isa order, has ship_via ""3"", has ship_country ""USA"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipAddress"": $o.ship_address,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via
};"
51,What are the names of the first 3 products supplied by suppliers from 'Germany'?,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
RETURN p.productName
LIMIT 3","match
$s isa supplier, has country ""Germany"";
supplies (supplier: $s, product: $p);
limit 3;
fetch { ""productName"": $p.product_name };"
52,List the top 3 products that have been ordered the most times.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WITH p.productName AS productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN productName, orderCount","match
$p isa product;
$rel isa orders (product: $p);
reduce $order_count = count($rel) groupby $p;
sort $order_count desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
53,Which suppliers have the most products currently on order?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsOnOrder > 0
RETURN s.companyName, COUNT(p) AS productsOnOrder
ORDER BY productsOnOrder DESC
LIMIT 1","match
$s isa supplier, has company_name $name;
$p isa product, has units_on_order $units;
$units > 0;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s, $name;
sort $count desc;
limit 1;
fetch {
  ""companyName"": $name,
  ""productsOnOrder"": $count
};"
54,Which products have a reorder level above 20 and are currently out of stock?,"MATCH (p:Product)
WHERE p.reorderLevel > 20 AND p.unitsInStock = 0
RETURN p.productName AS productName, p.reorderLevel AS reorderLevel, p.unitsInStock AS unitsInStock","match
$p isa product,
  has reorder_level $rl,
  has units_in_stock $uis;
$rl > 20;
$uis == 0;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl,
  ""unitsInStock"": $uis
};"
55,What are the names of the top 3 categories based on the average unit price of their products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS categoryName, AVG(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN categoryName, avgUnitPrice","match
$p isa product, has unit_price $price;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $avg = mean($price) groupby $c, $name;
sort $avg desc;
limit 3;
fetch { ""categoryName"": $name, ""avgUnitPrice"": $avg };"
56,List the first 3 products with a unit price between 10 and 20.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20
RETURN p.productName, p.unitPrice
ORDER BY p.productName
LIMIT 3","match
$p isa product, has product_name $name, has unit_price $price;
$price >= 10.0;
$price <= 20.0;
sort $name;
limit 3;
fetch {
  ""productName"": $name,
  ""unitPrice"": $price
};"
57,Which products have a 'reorder level' of 10 and are part of the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.reorderLevel = 10
RETURN p.productName","match
$p isa product, has reorder_level 10;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name
};"
58,What are the top 3 most expensive products in the 'Seafood' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
$p has unit_price $price;
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
59,Which suppliers are located in 'London'?,"MATCH (s:Supplier)
WHERE s.city = 'London'
RETURN s.companyName AS SupplierName","match
$s isa supplier, has city ""London"";
fetch {
  ""SupplierName"": $s.company_name
};"
60,"What are the names of products that are part of a category with description 'Sweet and savory sauces, relishes, spreads, and se'?","MATCH (p:Product)-[:PART_OF]->(c:Category {description: 'Sweet and savory sauces, relishes, spreads, and se'})
RETURN p.productName AS productName","match
$p isa product;
$c isa category, has description ""Sweet and savory sauces, relishes, spreads, and se"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name
};"
61,List the top 3 customers by the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
62,"List the first 3 products that are part of the 'Desserts, candies, and sweet breads' category and have a reorder level less than 10.","MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description = 'Desserts, candies, and sweet breads' AND p.reorderLevel < 10
RETURN p.productName, p.reorderLevel
LIMIT 3","match
$p isa product, has product_name $name, has reorder_level $rl;
$c isa category, has description ""Desserts, candies, and sweet breads"";
part_of (product: $p, category: $c);
$rl < 10;
limit 3;
fetch {
  ""productName"": $name,
  ""reorderLevel"": $rl
};"
63,List the first 3 products with a description containing 'sauces' in their category.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description CONTAINS 'sauces'
RETURN p.productName, p.productID, c.categoryName, c.description
LIMIT 3","match
$p isa product;
$c isa category, has description $desc;
$desc like "".*sauces.*"";
part_of (product: $p, category: $c);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""categoryName"": $c.category_name,
  ""description"": $desc
};"
64,What are the names of the first 3 suppliers whose companies have a phone number ending in '8'?,"MATCH (s:Supplier)
WHERE s.phone ENDS WITH '8'
RETURN s.companyName
ORDER BY s.companyName
LIMIT 3","match
$s isa supplier, has phone $p, has company_name $cn;
$p like "".*8"";
sort $cn;
limit 3;
fetch {
  ""companyName"": $cn
};"
65,List the top 3 customers who have ordered products in the 'Meat/Poultry' category.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Meat/Poultry'})
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer, has company_name $name;
$o isa order;
$p isa product;
$cat isa category, has category_name ""Meat/Poultry"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
reduce $order_count = count($o) groupby $c, $name;
sort $order_count desc;
limit 3;
fetch { ""customerName"": $name, ""orderCount"": $order_count };"
67,List the first 3 products with units in stock less than 10.,"MATCH (p:Product)
WHERE p.unitsInStock < 10
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 3","match
$p isa product, has units_in_stock $stock;
$stock < 10;
sort $stock asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
68,Which products have a reorder level of 25 and are supplied by suppliers from 'London'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.city = 'London' AND p.reorderLevel = 25
RETURN p.productName AS productName, p.reorderLevel AS reorderLevel, s.companyName AS supplierName","match
$s isa supplier, has city ""London"", has company_name $supplier_name;
$p isa product, has reorder_level 25, has product_name $product_name;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $product_name,
  ""reorderLevel"": $p.reorder_level,
  ""supplierName"": $supplier_name
};"
69,What are the names of the top 3 most reordered products in the 'Produce' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
WITH p
ORDER BY p.unitsOnOrder DESC
LIMIT 3
RETURN p.productName AS productName","match
$p isa product, has product_name $name, has units_on_order $uoo;
$c isa category, has category_name ""Produce"";
part_of (product: $p, category: $c);
sort $uoo desc;
limit 3;
fetch { ""productName"": $name };"
70,List the first 3 orders with a ship name containing 'Vins et alcools Chevalier'.,"MATCH (o:Order)
WHERE o.shipName CONTAINS 'Vins et alcools Chevalier'
RETURN o.orderID, o.shipName, o.orderDate
ORDER BY o.orderDate
LIMIT 3","match
$o isa order, has ship_name $sn;
$sn like "".*Vins et alcools Chevalier.*"";
$o has order_date $od;
sort $od;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $sn,
  ""orderDate"": $od
};"
71,Which suppliers have a postal code starting with 'EC'?,"MATCH (s:Supplier)
WHERE s.postalCode STARTS WITH 'EC'
RETURN s.companyName AS supplierName, s.postalCode AS postalCode","match
$s isa supplier, has postal_code $pc;
$pc like ""EC.*"";
fetch {
  ""supplierName"": $s.company_name,
  ""postalCode"": $pc
};"
72,What are the names of the top 3 suppliers based on the number of cities they supply to?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, COUNT(DISTINCT o.shipCity) AS cityCount
ORDER BY cityCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, cityCount","match
$s isa supplier;
$p isa product;
$o isa order, has ship_city $city;
supplies (supplier: $s, product: $p);
orders (order: $o, product: $p);
select $s, $city;
distinct;
reduce $city_count = count groupby $s;
sort $city_count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""cityCount"": $city_count
};"
73,List the top 3 products that are part of the 'Beverages' category and have been ordered more than 10 times.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
MATCH (o:Order)-[r:ORDERS]->(p)
WITH p, COUNT(r) AS orderCount
WHERE orderCount > 10
RETURN p.productName AS productName, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($rel) groupby $p;
match $order_count > 10;
sort $order_count desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
74,Which categories have the most products with a units on order greater than 20?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 20
RETURN c.categoryName, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 1","match
$p isa product, has units_on_order $u;
$u > 20;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 1;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $count
};"
75,What are the names of the first 3 products with a quantity per unit of '48 - 6 oz jars'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '48 - 6 oz jars'
RETURN p.productName
ORDER BY p.productName
LIMIT 3","match
$p isa product, has quantity_per_unit ""48 - 6 oz jars"", has product_name $name;
sort $name;
limit 3;
fetch {
  ""productName"": $name
};"
76,List the first 3 orders that have been shipped to a region other than 'NULL'.,"MATCH (o:Order)
WHERE o.shipRegion IS NOT NULL AND o.shipRegion <> 'NULL'
RETURN o.orderID, o.shipName, o.shipCity, o.shipRegion, o.shipCountry, o.shipAddress, o.shipPostalCode, o.shippedDate
ORDER BY o.shippedDate
LIMIT 3","match
$o isa order,
  has ship_region $sr,
  has shipped_date $sd;
not { $sr == ""NULL""; };
sort $sd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipRegion"": $o.ship_region,
  ""shipCountry"": $o.ship_country,
  ""shipAddress"": $o.ship_address,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shippedDate"": $o.shipped_date
};"
77,Which products have a units on order value of 0 and are not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.discontinued = false
RETURN p.productName","match
$p isa product, has units_on_order 0, has discontinued false;
fetch {
  ""productName"": $p.product_name
};"
79,List the first 3 products that have been ordered with a discount of 0 and are from the 'Grains/Cereals' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'}),
      (o:Order)-[r:ORDERS {discount: '0'}]->(p)
RETURN p.productName
LIMIT 3","match
$p isa product, has product_name $pn;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
$o isa order;
$rel isa orders (order: $o, product: $p), has discount 0.0;
limit 3;
fetch { ""productName"": $pn };"
80,Which orders were placed by customers with a 'Sales Representative' contact title?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.contactTitle = 'Sales Representative'
RETURN o.orderID AS orderID, o.orderDate AS orderDate, c.companyName AS customerCompanyName","match
$c isa customer, has contact_title ""Sales Representative"";
$o isa order;
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""customerCompanyName"": $c.company_name
};"
81,What are the names of the top 3 categories based on the number of suppliers providing products to them?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS categoryName, COUNT(DISTINCT s.supplierID) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3
RETURN categoryName, supplierCount","match
$s isa supplier, has supplier_id $sid;
$p isa product;
$c isa category, has category_name $name;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $c, $name, $sid;
distinct;
reduce $count = count groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""categoryName"": $name, ""supplierCount"": $count };"
82,List the first 3 products from suppliers located in 'USA'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.country = 'USA'
RETURN p.productName AS productName, s.companyName AS supplierName
LIMIT 3","match
$s isa supplier, has country ""USA"";
$p isa product;
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $s.company_name
};"
83,Which suppliers supply products to more than two different ships?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, COUNT(DISTINCT o.shipName) AS shipCount
WHERE shipCount > 2
RETURN s.companyName","match
$s isa supplier;
$p isa product;
$o isa order, has ship_name $sn;
supplies (supplier: $s, product: $p);
orders (order: $o, product: $p);
select $s, $sn;
distinct;
reduce $count = count($sn) groupby $s;
match $count > 2;
fetch { ""companyName"": $s.company_name };"
84,What are the names of the first 3 products that have a unit price less than 5 and are discontinued?,"MATCH (p:Product)
WHERE p.unitPrice < 5 AND p.discontinued = true
RETURN p.productName
ORDER BY p.productName
LIMIT 3","match
$p isa product, has unit_price $price, has discontinued true, has product_name $name;
$price < 5;
sort $name;
limit 3;
fetch {
  ""productName"": $name
};"
85,Which products have been ordered more than 100 times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WHERE o.quantity > 100
RETURN p.productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC","match
$p isa product, has product_name $pn;
$o isa order;
$rel isa orders (order: $o, product: $p), has quantity $q;
$q > 100;
reduce $total = sum($q) groupby $p, $pn;
sort $total desc;
fetch { ""productName"": $pn, ""totalQuantity"": $total };"
86,List the first 3 suppliers who supply products in the 'Dairy Products' category.,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName
LIMIT 3","match
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
87,Which suppliers have products in both 'Desserts' and 'Sauces' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p1:Product)-[:PART_OF]->(c1:Category {categoryName: 'Desserts'}),
      (s)-[:SUPPLIES]->(p2:Product)-[:PART_OF]->(c2:Category {categoryName: 'Condiments'})
RETURN DISTINCT s.companyName","match
$s isa supplier;
$p1 isa product;
$p2 isa product;
$c1 isa category, has category_name ""Desserts"";
$c2 isa category, has category_name ""Sauces"";
supplies (supplier: $s, product: $p1);
supplies (supplier: $s, product: $p2);
part_of (product: $p1, category: $c1);
part_of (product: $p2, category: $c2);
select $s;
distinct;
fetch {
  ""companyName"": $s.company_name
};"
88,What are the top 5 most ordered products by quantity from orders shipped to France?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN p.productName, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$o isa order, has ship_country ""France"";
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""totalQuantity"": $total
};"
89,Which categories contain products that are discontinued?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN DISTINCT c.categoryName","match
$p isa product, has discontinued true;
$c isa category;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch {
  ""categoryName"": $c.category_name
};"
90,List the top 5 products with the highest units in stock.,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product, has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
91,Which products have a reorder level of exactly 10?,"MATCH (p:Product)
WHERE p.reorderLevel = 10
RETURN p.productName AS productName, p.reorderLevel AS reorderLevel","match
$p isa product, has reorder_level 10;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $p.reorder_level
};"
92,What are the top 5 most ordered products by customers from 'Portland'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.city = 'Portland'
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has city ""Portland"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $count = count($o) groupby $p;
sort $count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $count };"
93,List the first 3 products with a unit price between $10 and $20 and a discontinued status of true.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20 AND p.discontinued = true
RETURN p.productName, p.unitPrice, p.discontinued
ORDER BY p.productName
LIMIT 3","match
$p isa product, has product_name $name, has unit_price $price, has discontinued true;
$price >= 10.0; $price <= 20.0;
sort $name;
limit 3;
fetch {
  ""productName"": $name,
  ""unitPrice"": $price,
  ""discontinued"": $p.discontinued
};"
94,Which products from 'Mayumi's' have been ordered with a discount of 0?,"MATCH (s:Supplier {companyName: ""Mayumi's (on the World Wide Web)#http://www.micros""})-[:SUPPLIES]->(p:Product)
MATCH (o:Order)-[r:ORDERS {discount: ""0""}]->(p)
RETURN p.productName","match
$s isa supplier, has company_name ""Mayumi's (on the World Wide Web)#http://www.micros"";
supplies (supplier: $s, product: $p);
$rel isa orders (order: $ord, product: $p), has discount 0.0;
fetch { ""productName"": $p.product_name };"
95,Find all suppliers that have a home page listed and supply products in the 'Seafood' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE s.homePage IS NOT NULL AND s.homePage <> 'NULL'
RETURN s.companyName, s.homePage","match
$s isa supplier, has home_page $hp, has company_name $cn;
$p isa product;
$c isa category, has category_name ""Seafood"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
not { $hp == ""NULL""; };
fetch {
  ""companyName"": $cn,
  ""homePage"": $hp
};"
96,What are the top 5 most ordered products by customers from 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
$p has product_name $pn;
reduce $total = sum($q) groupby $p, $pn;
sort $total desc;
limit 5;
fetch { ""productName"": $pn, ""totalQuantity"": $total };"
97,What are the names of suppliers who supply products in the 'Beverages' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN s.companyName AS supplierName","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Beverages"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
fetch {
  ""supplierName"": $s.company_name
};"
99,Find all products that have been shipped to 'London' and have a unit price over $30.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCity = 'London' AND p.unitPrice > 30
RETURN p.productName, p.unitPrice","match
$o isa order, has ship_city ""London"";
$p isa product, has unit_price $price;
$price > 30.0;
orders (order: $o, product: $p);
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
100,What are the top 5 products with the highest number of units on order in the 'Meat/Poultry' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
$p has units_on_order $uoo;
sort $uoo desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $uoo
};"
101,List the first 3 orders that included products from more than three different categories.,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WITH o, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 3
RETURN o.orderID, o.orderDate, o.shipName, o.shipCity, o.shipCountry
ORDER BY o.orderDate
LIMIT 3","match
$o isa order;
orders (order: $o, product: $p);
part_of (product: $p, category: $c);
$c has category_id $cid;
reduce $cat_count = count($cid) groupby $o;
match $cat_count > 3;
$o has order_date $od;
sort $od asc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
102,Which products have a discounted price of less than $15 in any of their orders?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE toFloat(o.unitPrice) < 15 AND toFloat(o.discount) > 0
RETURN DISTINCT p.productName","match
$p isa product;
$rel isa orders (product: $p), has order_unit_price $price, has discount $disc;
$price < 15.0;
$disc > 0.0;
select $p;
distinct;
fetch {
  ""productName"": $p.product_name
};"
103,Find all suppliers who have a product in the 'Grains/Cereals' category with a reorder level above 10.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Grains/Cereals' AND p.reorderLevel > 10
RETURN s.companyName","match
$s isa supplier;
$p isa product, has reorder_level $rl;
$rl > 10;
$c isa category, has category_name ""Grains/Cereals"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
fetch {
  ""companyName"": $s.company_name
};"
104,What are the top 5 most frequently shipped cities for orders?,"MATCH (o:Order)
WITH o.shipCity AS city, COUNT(o) AS orderCount
RETURN city, orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$o isa order, has ship_city $city;
reduce $count = count($o) groupby $city;
sort $count desc;
limit 5;
fetch { ""city"": $city, ""orderCount"": $count };"
105,List the first 3 products in the 'Beverages' category that have a unitsInStock greater than 50.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.unitsInStock > 50
RETURN p.productName, p.unitsInStock
ORDER BY p.productName
LIMIT 3","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$stock > 50;
$p has product_name $name;
sort $name;
limit 3;
fetch {
  ""productName"": $name,
  ""unitsInStock"": $stock
};"
106,Which products from 'Exotic Liquids' have been ordered in quantities of less than 10?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WHERE o.quantity < 10
RETURN p.productName AS productName, o.quantity AS quantity","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$o isa orders (order: $ord, product: $p), has quantity $q;
$q < 10;
fetch {
  ""productName"": $p.product_name,
  ""quantity"": $q
};"
107,Which suppliers provide products to more than one category? List the top 5 based on the number of categories supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 1
RETURN s.companyName AS supplier, categoryCount
ORDER BY categoryCount DESC
LIMIT 5","match
$s isa supplier;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $category_count = count($c) groupby $s;
match $category_count > 1;
sort $category_count desc;
limit 5;
fetch {
  ""supplier"": $s.company_name,
  ""categoryCount"": $category_count
};"
108,How many products does each supplier supply? Limit the results to the top 5 suppliers.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s.companyName AS supplier, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN supplier, productCount","match
$s isa supplier, has company_name $name;
$p isa product;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s, $name;
sort $count desc;
limit 5;
fetch { ""supplier"": $name, ""productCount"": $count };"
109,Which customers have purchased orders that include the product named 'Chai'?,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName AS customerName, c.contactName AS contactName, c.customerID AS customerID","match
$p isa product, has product_name ""Chai"";
orders (order: $o, product: $p);
purchased (customer: $c, order: $o);
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""customerID"": $c.customer_id
};"
110,What are the top 3 orders with the highest quantity of a single product ordered?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, p.productName AS productName, r.quantity AS quantity
ORDER BY r.quantity DESC
LIMIT 3","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
sort $q desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""productName"": $p.product_name,
  ""quantity"": $q
};"
111,List the top 3 categories based on the number of products they contain.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
RETURN category, productCount
ORDER BY productCount DESC
LIMIT 3","match
$c isa category;
$p isa product;
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $c;
sort $product_count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $product_count
};"
112,Which products are supplied by companies located in 'London'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.city = 'London'
RETURN p.productName AS productName","match
$s isa supplier, has city ""London"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
113,Provide the names of all products that have a quantity per unit description containing 'bottles'.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bottles'
RETURN p.productName AS productName","match
$p isa product, has quantity_per_unit $q;
$q like "".*bottles.*"";
fetch {
  ""productName"": $p.product_name
};"
114,Which orders were placed by customers from 'USA' and have a shipped date later than '1997-06-01'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'USA' AND o.shippedDate > '1997-06-01'
RETURN o.orderID AS orderID, c.companyName AS customerName, o.shippedDate AS shippedDate","match
$c isa customer, has country ""USA"", has company_name $cn;
$o isa order, has order_id $oid, has shipped_date $sd;
$sd > ""1997-06-01"";
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $oid,
  ""customerName"": $cn,
  ""shippedDate"": $sd
};"
115,Find products that have never been ordered (units on order = 0) and list the top 5 based on unit price.,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0
AND NOT EXISTS {
    MATCH (o:Order)-[:ORDERS]->(p)
}
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$p isa product, has units_on_order 0, has product_name $name, has unit_price $price;
not { orders (product: $p); };
sort $price desc;
limit 5;
fetch { ""productName"": $name, ""unitPrice"": $price };"
116,Which customers have a contact title of 'Sales Representative' and are located in 'Berlin'?,"MATCH (c:Customer)
WHERE c.contactTitle = 'Sales Representative' AND c.city = 'Berlin'
RETURN c.companyName AS customerName, c.contactName AS contactPerson","match
$c isa customer, has contact_title ""Sales Representative"", has city ""Berlin"";
fetch {
  ""customerName"": $c.company_name,
  ""contactPerson"": $c.contact_name
};"
117,Which products have a unit price greater than 100 and are still active (not discontinued)?,"MATCH (p:Product)
WHERE p.unitPrice > 100 AND p.discontinued = false
RETURN p.productName, p.unitPrice","match
$p isa product, has unit_price $up, has discontinued false;
$up > 100;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
118,Which products are associated with the supplier 'Plutzer'?,"MATCH (s:Supplier {companyName: 'Plutzer'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has company_name ""Plutzer"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
119,Who are the top 3 customers based on the number of orders placed?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, count(o) as orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
120,Which suppliers have a home page listed? Provide names for the first 5.,"MATCH (s:Supplier)
WHERE s.homePage IS NOT NULL AND s.homePage <> 'NULL'
RETURN s.companyName
LIMIT 5","match
$s isa supplier, has home_page $hp, has company_name $name;
not { $hp == ""NULL""; };
limit 5;
fetch { ""companyName"": $name };"
121,What are the names of the categories where the average unit price of products is above 50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS categoryName, avg(p.unitPrice) AS avgUnitPrice
WHERE avgUnitPrice > 50
RETURN categoryName","match
$p isa product, has unit_price $price;
$c isa category;
part_of (product: $p, category: $c);
reduce $avg_price = mean($price) groupby $c;
match $avg_price > 50;
fetch { ""categoryName"": $c.category_name };"
122,List the first 3 products that have been reordered (units on order > 0) and are not discontinued.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 0 AND p.discontinued = false
RETURN p.productName, p.unitsOnOrder
ORDER BY p.productName
LIMIT 3","match
$p isa product, has units_on_order $uo, has discontinued false, has product_name $name;
$uo > 0;
sort $name;
limit 3;
fetch {
  ""productName"": $name,
  ""unitsOnOrder"": $uo
};"
123,Which customers are from 'Germany' and have ordered more than 3 different products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'Germany'
WITH c, COUNT(DISTINCT p.productID) AS productCount
WHERE productCount > 3
RETURN c.companyName AS customerName, productCount","match
$c isa customer, has country ""Germany"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $product_count = count($p) groupby $c;
match $product_count > 3;
fetch {
  ""customerName"": $c.company_name,
  ""productCount"": $product_count
};"
124,What are the names of the products that have been ordered more than 50 times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WHERE o.quantity > 50
RETURN DISTINCT p.productName AS productName","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p), has quantity $q;
$q > 50;
select $p;
distinct;
fetch {
  ""productName"": $p.product_name
};"
125,How many products are in the 'Confections' category and have a unit price greater than 20?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Confections' AND p.unitPrice > 20
RETURN count(p) AS numberOfProducts","match
$p isa product, has unit_price $up;
$up > 20;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
reduce $count = count($p);"
126,Which orders were shipped to 'France' and required before '1997-01-01'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France' AND o.requiredDate < '1997-01-01'
RETURN o.orderID, o.shipName, o.requiredDate, o.shipCity, o.shipAddress, o.shipPostalCode, o.shipCountry","match
$o isa order,
  has ship_country ""France"",
  has required_date $rd;
$rd < ""1997-01-01"";
orders (order: $o, product: $p);
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""requiredDate"": $o.required_date,
  ""shipCity"": $o.ship_city,
  ""shipAddress"": $o.ship_address,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country
};"
127,List the top 5 orders with the greatest freight charges.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 5","match $o isa order, has order_id $oid, has freight $f;
sort $f desc;
limit 5;
fetch { ""orderID"": $oid, ""freight"": $f };"
128,Who are the contact names for suppliers in the 'UK'?,"MATCH (s:Supplier)
WHERE s.country = 'UK'
RETURN s.contactName","match
$s isa supplier, has country ""UK"";
fetch {
  ""contactName"": $s.contact_name
};"
129,Which products are part of the 'Dairy Products' category and have less than 20 units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitsInStock < 20
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$stock < 20;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
130,Find all customers who have ordered products with a unit price less than $10.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.unitPrice < 10
RETURN DISTINCT c.companyName, c.contactName, c.contactTitle, c.phone, c.city, c.country","match
$c isa customer;
$o isa order;
$p isa product, has unit_price $up;
$up < 10.0;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $c;
distinct;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""phone"": $c.phone,
  ""city"": $c.city,
  ""country"": $c.country
};"
131,Which products have been ordered more than 100 times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WHERE o.quantity > 100
RETURN p.productName, SUM(o.quantity) AS totalOrdered
ORDER BY totalOrdered DESC","match
$p isa product;
$o isa orders (order: $ord, product: $p);
reduce $count = count($o) groupby $p;
match $count > 100;
fetch { ""productName"": $p.product_name };"
132,What are the top 5 suppliers based on the number of products they supply with a unit price over $50?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 50
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product, has unit_price $price;
$price > 50;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
133,Which products have a unitsOnOrder greater than 50?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 50
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u;
$u > 50;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
134,List the first 3 customers who have ordered 'Chai' and are from 'Portland'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Chai'})
WHERE c.city = 'Portland'
RETURN c.companyName, c.contactName, c.contactTitle, c.city
LIMIT 3","match
$c isa customer, has city ""Portland"", has company_name $cn, has contact_name $ctn, has contact_title $ct;
$o isa order;
$p isa product, has product_name ""Chai"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
limit 3;
fetch {
  ""companyName"": $cn,
  ""contactName"": $ctn,
  ""contactTitle"": $ct,
  ""city"": $c.city
};"
135,What are the top 5 suppliers based on the number of different cities they have shipped to?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, o.shipCity AS city
WHERE city IS NOT NULL
WITH s, COUNT(DISTINCT city) AS cityCount
RETURN s.companyName AS supplier, cityCount
ORDER BY cityCount DESC
LIMIT 5","match
$s isa supplier, has company_name $name;
supplies (supplier: $s, product: $p);
orders (product: $p, order: $o);
$o has ship_city $city;
select $s, $name, $city;
distinct;
reduce $count = count groupby $s, $name;
sort $count desc;
limit 5;
fetch { ""supplier"": $name, ""cityCount"": $count };"
136,Find all products from suppliers located in 'Germany' that have been ordered in 1998.,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
MATCH (o:Order)-[:ORDERS]->(p)
WHERE o.orderDate STARTS WITH '1998'
RETURN p.productName AS ProductName, s.companyName AS SupplierName, o.orderDate AS OrderDate","match
$s isa supplier, has country ""Germany"", has company_name $supplier_name;
$p isa product, has product_name $product_name;
supplies (supplier: $s, product: $p);
$o isa order, has order_date $order_date;
orders (order: $o, product: $p);
$order_date like ""^1998.*"";
fetch {
  ""ProductName"": $product_name,
  ""SupplierName"": $supplier_name,
  ""OrderDate"": $order_date
};"
137,Which products have a quantity per unit description containing 'bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bags'
RETURN p.productName, p.quantityPerUnit","match
$p isa product, has quantity_per_unit $qpu;
$qpu like "".*bags.*"";
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $qpu
};"
138,List the first 3 orders with the highest quantity of a single product ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, p.productName AS productName, r.quantity AS quantity
ORDER BY r.quantity DESC
LIMIT 3","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
sort $q desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""productName"": $p.product_name,
  ""quantity"": $q
};"
139,Which suppliers have products in both 'Grains/Cereals' and 'Meat/Poultry' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p1:Product)-[:PART_OF]->(c1:Category {categoryName: 'Grains/Cereals'}),
      (s)-[:SUPPLIES]->(p2:Product)-[:PART_OF]->(c2:Category {categoryName: 'Meat/Poultry'})
RETURN DISTINCT s.companyName","match
$s isa supplier;
$p1 isa product;
$p2 isa product;
$c1 isa category, has category_name ""Grains/Cereals"";
$c2 isa category, has category_name ""Meat/Poultry"";
supplies (supplier: $s, product: $p1);
supplies (supplier: $s, product: $p2);
part_of (product: $p1, category: $c1);
part_of (product: $p2, category: $c2);
select $s;
distinct;
fetch { ""companyName"": $s.company_name };"
140,What are the top 5 products with the lowest unit price in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$p has unit_price $price;
sort $price asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
141,List all products with a unit price between $50 and $100.,"MATCH (p:Product)
WHERE p.unitPrice >= 50 AND p.unitPrice <= 100
RETURN p.productName, p.unitPrice","match
$p isa product, has unit_price $price;
$price >= 50.0;
$price <= 100.0;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
142,Which categories have products with a reorder level above 25?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 25
RETURN DISTINCT c.categoryName","match
$p isa product, has reorder_level $rl;
$rl > 25;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
fetch { ""categoryName"": $cn };"
143,Which customers have placed orders that required shipping via method '2'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '2'
RETURN DISTINCT c.companyName AS customerName","match
$c isa customer, has company_name $name;
$o isa order, has ship_via ""2"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $name;
distinct;
fetch { ""customerName"": $name };"
144,What are the top 5 most frequently ordered products in 'Seafood' category?,"MATCH (c:Category {categoryName: 'Seafood'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa category, has category_name ""Seafood"";
$p isa product;
part_of (product: $p, category: $c);
$o isa order;
orders (order: $o, product: $p);
reduce $count = count($o) groupby $p;
sort $count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $count };"
146,Which products have never been on order (unitsOnOrder = 0) and are not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.discontinued = false
RETURN p.productName","match
$p isa product, has units_on_order 0, has discontinued false;
fetch {
  ""productName"": $p.product_name
};"
147,Find all suppliers who do not have a homepage listed.,"MATCH (s:Supplier)
WHERE s.homePage = 'NULL'
RETURN s.companyName, s.contactName, s.phone, s.address, s.city, s.country","match
$s isa supplier;
not { $s has home_page $hp; };
fetch {
  ""companyName"": $s.company_name,
  ""contactName"": $s.contact_name,
  ""phone"": $s.phone,
  ""address"": $s.address,
  ""city"": $s.city,
  ""country"": $s.country
};"
149,List the first 3 products supplied by 'Mayumi's' with a unit price less than $20.,"MATCH (s:Supplier {companyName: ""Mayumi's (on the World Wide Web)#http://www.micros""})-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice < 20
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice
LIMIT 3","match
$s isa supplier, has company_name ""Mayumi's (on the World Wide Web)#http://www.micros"";
$p isa product, has unit_price $price;
$price < 20.0;
supplies (supplier: $s, product: $p);
sort $price;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
150,Which suppliers supply more than 5 different products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(DISTINCT p.productID) AS productCount
WHERE productCount > 5
RETURN s.companyName, productCount","match
$s isa supplier;
$p isa product;
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
match $product_count > 5;
fetch {
  ""companyName"": $s.company_name,
  ""productCount"": $product_count
};"
151,Find the first 3 suppliers with products that have a reorder level of zero.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.reorderLevel = 0
RETURN s.companyName, s.contactName, s.phone
LIMIT 3","match
$s isa supplier;
$p isa product, has reorder_level 0;
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""companyName"": $s.company_name,
  ""contactName"": $s.contact_name,
  ""phone"": $s.phone
};"
152,What are the top 5 products with the highest discount given in an order?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH p.productName AS productName, r.discount AS discount
ORDER BY toFloat(discount) DESC
LIMIT 5
RETURN productName, discount","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
sort $d desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""discount"": $d
};"
153,Find all suppliers that supply discontinued products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
RETURN s.companyName","match
$s isa supplier;
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
154,Which products have been ordered in quantities larger than 50 and have a unit price over $20?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.quantity > 50 AND p.unitPrice > 20
RETURN p.productName, p.unitPrice, o.quantity","match
$p isa product, has product_name $name, has unit_price $price;
$price > 20;
$rel isa orders (order: $o, product: $p), has quantity $qty;
$qty > 50;
fetch {
  ""productName"": $name,
  ""unitPrice"": $price,
  ""quantity"": $qty
};"
155,Find all products that have been ordered in the last quarter of any year.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.orderDate ENDS WITH '-10-01 00:00:00.000' OR o.orderDate ENDS WITH '-11-01 00:00:00.000' OR o.orderDate ENDS WITH '-12-01 00:00:00.000'
RETURN DISTINCT p.productName AS ProductName, p.productID AS ProductID","match
$o isa order, has order_date $od;
{ $od like "".*-10-.*""; } or { $od like "".*-11-.*""; } or { $od like "".*-12-.*""; };
$p isa product, has product_name $pn, has product_id $pid;
orders (order: $o, product: $p);
select $pn, $pid;
distinct;
fetch { ""ProductName"": $pn, ""ProductID"": $pid };"
156,What are the top 5 orders by freight cost for orders shipped to 'Germany'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'Germany'
RETURN o.orderID AS orderID, o.freight AS freight
ORDER BY toFloat(o.freight) DESC
LIMIT 5","match
$o isa order, has ship_country ""Germany"", has freight $f, has order_id $oid;
sort $f desc;
limit 5;
fetch {
  ""orderID"": $oid,
  ""freight"": $f
};"
157,List the first 3 suppliers whose products have never been discontinued and have a unitsInStock less than 20.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false AND p.unitsInStock < 20
WITH s, COUNT(p) AS productCount
WHERE productCount > 0
RETURN s.companyName
ORDER BY s.companyName
LIMIT 3","match
$s isa supplier, has company_name $cn;
$p isa product, has discontinued false, has units_in_stock $stock;
$stock < 20;
supplies (supplier: $s, product: $p);
select $cn;
distinct;
sort $cn;
limit 3;
fetch {
  ""companyName"": $cn
};"
158,Which products have a unit price greater than $75 and are in the 'Confections' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 75 AND c.categoryName = 'Confections'
RETURN p.productName, p.unitPrice","match
$p isa product, has unit_price $up;
$up > 75;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
159,Find all suppliers that are from the 'UK' and supply products to more than one category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE s.country = 'UK'
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 1
RETURN s.companyName AS SupplierName, categoryCount","match
$s isa supplier, has country ""UK"", has company_name $name;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$c has category_id $cid;
select $s, $name, $cid;
distinct;
reduce $categoryCount = count groupby $s, $name;
match $categoryCount > 1;
fetch { ""SupplierName"": $name, ""categoryCount"": $categoryCount };"
160,What are the top 5 most ordered products in December across all years?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate STARTS WITH '12'
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$o isa order, has order_date $d;
$d like ""12%"";
$rel isa orders (order: $o, product: $p);
$p has product_name $name;
reduce $count = count($rel) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""productName"": $name,
  ""orderCount"": $count
};"
162,Which products have been ordered with a discount of 0 and are from the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'}),
      (o:Order)-[r:ORDERS {discount: '0'}]->(p)
RETURN p.productName","match
$p isa product;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$o isa order;
$rel isa orders (order: $o, product: $p);
$rel has discount 0.0;
fetch {
  ""productName"": $p.product_name
};"
163,Find all products supplied by companies with a fax number listed.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.fax IS NOT NULL AND s.fax <> 'NULL'
RETURN p.productName AS productName, s.companyName AS supplierName","match
$s isa supplier, has fax $f, has company_name $sn;
$p isa product, has product_name $pn;
supplies (supplier: $s, product: $p);
not { $f == ""NULL""; };
fetch {
  ""productName"": $pn,
  ""supplierName"": $sn
};"
164,What are the top 5 categories based on the average unit price of their products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, avg(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 5
RETURN category, avgUnitPrice","match
$p isa product, has unit_price $price;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $avg = mean($price) groupby $c, $name;
sort $avg desc;
limit 5;
fetch { ""category"": $name, ""avgUnitPrice"": $avg };"
165,List the first 3 customers who have placed more than 5 orders.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
WHERE orderCount > 5
RETURN c.customerID, c.companyName, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
match $order_count > 5;
sort $order_count desc;
limit 3;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""orderCount"": $order_count
};"
166,Which products have been ordered on dates later than '1997-01-01'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.orderDate > '1997-01-01'
RETURN p.productName AS productName, o.orderDate AS orderDate","match
$o isa order, has order_date $od;
$p isa product;
orders (order: $o, product: $p);
$od > ""1997-01-01"";
fetch {
  ""productName"": $p.product_name,
  ""orderDate"": $od
};"
168,What are the top 5 most frequently ordered products by customers from 'USA'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'USA'
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has country ""USA"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $order_count = count($o) groupby $p;
sort $order_count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
169,List the first 3 products with '20 bags' in their quantity per unit description and a reorder level below 15.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS '20 bags' AND p.reorderLevel < 15
RETURN p.productName, p.quantityPerUnit, p.reorderLevel
LIMIT 3","match
$p isa product,
    has quantity_per_unit $qpu,
    has reorder_level $rl;
$qpu like "".*20 bags.*"";
$rl < 15;
limit 3;
fetch {
    ""productName"": $p.product_name,
    ""quantityPerUnit"": $qpu,
    ""reorderLevel"": $rl
};"
170,Which suppliers have a contact title of 'Purchasing Manager' and supply more than 3 products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.contactTitle = 'Purchasing Manager'
WITH s, COUNT(p) AS productCount
WHERE productCount > 3
RETURN s.companyName AS SupplierName, productCount","match
$s isa supplier, has contact_title ""Purchasing Manager"";
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
match $count > 3;
fetch {
  ""SupplierName"": $s.company_name,
  ""productCount"": $count
};"
171,Find all products that are both in 'Beverages' and 'Condiments' categories.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Condiments']
WITH p, collect(c.categoryName) AS categories
WHERE 'Beverages' IN categories AND 'Condiments' IN categories
RETURN p.productName","match
$p isa product;
$c1 isa category, has category_name ""Beverages"";
$c2 isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c1);
part_of (product: $p, category: $c2);
fetch {
  ""productName"": $p.product_name
};"
172,What are the top 5 orders in terms of quantity for the product 'Chai'?,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)
RETURN o.orderID AS orderID, o.orderDate AS orderDate, o.shipName AS shipName, o.shipCity AS shipCity, o.shipCountry AS shipCountry, o.shipPostalCode AS shipPostalCode, o.shipAddress AS shipAddress, o.shipVia AS shipVia, o.shipRegion AS shipRegion, o.freight AS freight, o.requiredDate AS requiredDate, o.shippedDate AS shippedDate, o.customerID AS customerID, o.employeeID AS employeeID, o.unitPrice AS unitPrice, o.quantity AS quantity, o.discount AS discount
ORDER BY o.quantity DESC
LIMIT 5","match
$p isa product, has product_name ""Chai"";
$rel isa orders (order: $o, product: $p), has quantity $qty;
purchased (customer: $c, order: $o);
sort $qty desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipVia"": $o.ship_via,
  ""shipRegion"": $o.ship_region,
  ""freight"": $o.freight,
  ""requiredDate"": $o.required_date,
  ""shippedDate"": $o.shipped_date,
  ""customerID"": $c.customer_id,
  ""employeeID"": $o.employee_id,
  ""unitPrice"": $rel.order_unit_price,
  ""quantity"": $qty,
  ""discount"": $rel.discount
};"
173,List the first 3 products in the 'Confections' category with the most units on order.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has product_name $name, has units_on_order $units;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
sort $units desc;
limit 3;
fetch {
  ""productName"": $name,
  ""unitsOnOrder"": $units
};"
174,List the first 3 categories with products that have been ordered more than 50 times.,"MATCH (c:Category)<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
WITH c, p, COUNT(o) AS orderCount
WHERE orderCount > 50
RETURN c.categoryName
ORDER BY orderCount DESC
LIMIT 3","match
$c isa category, has category_name $cn;
$p isa product;
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($rel) groupby $c, $p;
match $order_count > 50;
sort $order_count desc;
limit 3;
fetch { ""categoryName"": $c.category_name };"
175,What are the top 3 most stocked products in the 'Grains/Cereals' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
177,Which orders were placed by customers from 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
RETURN o.orderID AS orderID, o.orderDate AS orderDate, o.shipName AS shipName, o.shipCity AS shipCity, o.shipCountry AS shipCountry","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
$o isa order;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
178,Identify the top 3 most stocked products in the 'Dairy Products' category.,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$c isa category, has category_name ""Dairy Products"";
$p isa product, has units_in_stock $stock;
part_of (product: $p, category: $c);
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
179,Which products are discontinued and have less than 10 units in stock?,"MATCH (p:Product)
WHERE p.discontinued = true AND p.unitsInStock < 10
RETURN p.productName, p.unitsInStock","match
$p isa product, has discontinued true, has units_in_stock $stock;
$stock < 10;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
180,List all suppliers that supply products in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN s.companyName","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Beverages"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
fetch {
  ""companyName"": $s.company_name
};"
181,Which products have a reorder level greater than 15?,"MATCH (p:Product)
WHERE p.reorderLevel > 15
RETURN p.productName","match
$p isa product, has reorder_level $rl;
$rl > 15;
fetch {
  ""productName"": $p.product_name
};"
182,What are the top 5 products by unit price?,"MATCH (p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$p isa product, has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
183,What are the top 3 most ordered products in the 'Grains/Cereals' category?,"MATCH (c:Category {categoryName: 'Grains/Cereals'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
WITH p, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3
RETURN p.productName AS productName, totalQuantity","match
$c isa category, has category_name ""Grains/Cereals"";
$p isa product;
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 3;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
184,List the top 5 suppliers based in 'London'.,"MATCH (s:Supplier {city: 'London'})
RETURN s.companyName AS supplierName
ORDER BY s.companyName
LIMIT 5","match
$s isa supplier, has city ""London"", has company_name $cn;
sort $cn;
limit 5;
fetch {
  ""supplierName"": $cn
};"
185,Which 3 customers have ordered the most products from the 'Dairy Products' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Dairy Products'})
WITH c, SUM(o.quantity) AS totalQuantity
RETURN c.companyName, totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3","match
$c isa customer;
$o isa order;
$p isa product;
$cat isa category, has category_name ""Dairy Products"";
purchased (customer: $c, order: $o);
$ord isa orders (order: $o, product: $p), has quantity $q;
part_of (product: $p, category: $cat);
reduce $total = sum($q) groupby $c;
sort $total desc;
limit 3;
fetch {
  ""companyName"": $c.company_name,
  ""totalQuantity"": $total
};"
186,What are the contact details for suppliers in the 'UK'?,"MATCH (s:Supplier)
WHERE s.country = 'UK'
RETURN s.companyName, s.contactName, s.contactTitle, s.phone, s.fax, s.address, s.city, s.postalCode, s.region, s.homePage","match
$s isa supplier, has country ""UK"";
fetch {
  ""companyName"": $s.company_name,
  ""contactName"": $s.contact_name,
  ""contactTitle"": $s.contact_title,
  ""phone"": $s.phone,
  ""fax"": $s.fax,
  ""address"": $s.address,
  ""city"": $s.city,
  ""postalCode"": $s.postal_code,
  ""region"": $s.region,
  ""homePage"": $s.home_page
};"
187,What are the top 3 ship cities for orders placed by 'Ernst Handel'?,"MATCH (c:Customer {companyName: 'Ernst Handel'})-[:PURCHASED]->(o:Order)
WITH o.shipCity AS shipCity, COUNT(o) AS orderCount
RETURN shipCity, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$c isa customer, has company_name ""Ernst Handel"";
purchased (customer: $c, order: $o);
$o has ship_city $city;
reduce $count = count($o) groupby $city;
sort $count desc;
limit 3;
fetch { ""shipCity"": $city, ""orderCount"": $count };"
188,Which 3 products are most often ordered by customers from Germany?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'Germany'
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$c isa customer, has country ""Germany"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$p has product_name $pn;
reduce $order_count = count($o) groupby $p, $pn;
sort $order_count desc;
limit 3;
fetch {
  ""product_name"": $pn,
  ""order_count"": $order_count
};"
189,What are the top 3 products with the lowest units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 3","match
$p isa product, has units_in_stock $u;
sort $u asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $u
};"
190,List the top 5 orders with the latest required dates.,"MATCH (o:Order)
RETURN o.orderID, o.requiredDate
ORDER BY o.requiredDate DESC
LIMIT 5","match
$o isa order, has required_date $rd;
sort $rd desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""requiredDate"": $rd
};"
191,Which 3 products have the highest units on order and are not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = false
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has discontinued false, has units_on_order $u;
sort $u desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
192,What are the top 3 cities where customers are located?,"MATCH (c:Customer)
WITH c.city AS city, COUNT(*) AS customerCount
RETURN city
ORDER BY customerCount DESC
LIMIT 3","match
$c isa customer, has city $city;
reduce $count = count($c) groupby $city;
sort $count desc;
limit 3;
fetch { ""city"": $city };"
193,List the top 5 products with the lowest unit price supplied by 'Plutzer'.,"MATCH (s:Supplier {companyName: 'Plutzer'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 5","match
$s isa supplier, has company_name ""Plutzer"";
$p isa product, has unit_price $price;
supplies (supplier: $s, product: $p);
sort $price asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
194,Which 3 products have the highest average quantity ordered?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, avg(o.quantity) AS avgQuantity
RETURN p.productName, avgQuantity
ORDER BY avgQuantity DESC
LIMIT 3","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $avg = mean($q) groupby $p;
sort $avg desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""avgQuantity"": $avg
};"
195,What are the top 3 most common ship addresses for orders?,"MATCH (o:Order)
WITH o.shipAddress AS address, COUNT(o) AS orderCount
RETURN address
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_address $addr;
reduce $count = count($o) groupby $addr;
sort $count desc;
limit 3;
fetch { ""address"": $addr };"
196,List the top 5 products with the highest average discount in orders.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, o.discount AS discount
WHERE discount IS NOT NULL
RETURN p.productName AS productName, AVG(toFloat(discount)) AS avgDiscount
ORDER BY avgDiscount DESC
LIMIT 5","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
reduce $avg_discount = mean($d) groupby $p;
sort $avg_discount desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""avgDiscount"": $avg_discount
};"
197,Which customers are based in 'Berlin'?,"MATCH (c:Customer)
WHERE c.city = 'Berlin'
RETURN c.companyName AS customerName, c.contactName AS contactPerson","match
$c isa customer, has city ""Berlin"";
fetch {
  ""customerName"": $c.company_name,
  ""contactPerson"": $c.contact_name
};"
198,List the top 5 most frequently ordered products.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product;
$rel isa orders (product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $count
};"
199,Which products have been ordered with a quantity greater than 100?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.quantity > 100
RETURN p.productName AS ProductName, o.quantity AS Quantity","match
$p isa product;
$rel isa orders (product: $p), has quantity $q;
$q > 100;
fetch {
  ""ProductName"": $p.product_name,
  ""Quantity"": $q
};"
200,What are the most expensive products ordered by 'LONESOME PINE RESTAURANT'?,"MATCH (c:Customer {companyName: 'LONESOME PINE RESTAURANT'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$c isa customer, has company_name ""LONESOME PINE RESTAURANT"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$p has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
201,List the products ordered by 'VINET' customer.,"MATCH (c:Customer {customerID: 'VINET'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName AS productName","match
$c isa customer, has customer_id ""VINET"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
fetch {
  ""productName"": $p.product_name
};"
202,Which suppliers have a fax number listed?,"MATCH (s:Supplier)
WHERE s.fax IS NOT NULL AND s.fax <> 'NULL'
RETURN s.companyName, s.fax","match
$s isa supplier, has fax $f;
$f != ""NULL"";
fetch {
  ""companyName"": $s.company_name,
  ""fax"": $f
};"
203,Show all products that have a discount applied in any order.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.discount <> ""0""
RETURN DISTINCT p.productName AS ProductName, p.productID AS ProductID","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
$d != 0.0;
select $p;
distinct;
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id
};"
204,Which orders were placed in the year 1996?,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1996'
RETURN o.orderID AS orderID, o.orderDate AS orderDate","match
$o isa order, has order_id $oid, has order_date $od;
$od like ""1996%"";
fetch {
  ""orderID"": $oid,
  ""orderDate"": $od
};"
205,Find all products with a reorder level of 0 and still in stock.,"MATCH (p:Product)
WHERE p.reorderLevel = 0 AND p.unitsInStock > 0
RETURN p.productName, p.unitsInStock","match
$p isa product, has reorder_level 0, has units_in_stock $stock;
$stock > 0;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
206,List all suppliers who are from cities starting with 'L'.,"MATCH (s:Supplier)
WHERE s.city STARTS WITH 'L'
RETURN s.companyName AS supplierName, s.city AS city","match
$s isa supplier, has city $c;
$c like ""L.*"";
fetch {
  ""supplierName"": $s.company_name,
  ""city"": $c
};"
207,Display all products with 'unitsOnOrder' greater than 20.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 20
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u, has product_name $n;
$u > 20;
fetch {
  ""productName"": $n,
  ""unitsOnOrder"": $u
};"
208,Which categories do not have any discontinued products?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.discontinued = false
WITH c, COUNT(p) AS activeProducts
MATCH (c)<-[:PART_OF]-(allProducts:Product)
WITH c, activeProducts, COUNT(allProducts) AS totalProducts
WHERE activeProducts = totalProducts
RETURN c.categoryName","match
$c isa category;
not {
  $p isa product, has discontinued true;
  part_of (product: $p, category: $c);
};
fetch {
  ""categoryName"": $c.category_name
};"
209,Find all products that have never been reordered (reorder level 0).,"MATCH (p:Product)
WHERE p.reorderLevel = 0
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock","match
$p isa product, has reorder_level 0;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock
};"
210,Show details of customers who have placed more than 5 orders.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
WHERE orderCount > 5
RETURN c.customerID, c.companyName, c.contactName, c.contactTitle, c.phone, c.address, c.city, c.postalCode, c.country, c.region, c.fax","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $count = count($o) groupby $c;
match $count > 5;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""phone"": $c.phone,
  ""address"": $c.address,
  ""city"": $c.city,
  ""postalCode"": $c.postal_code,
  ""country"": $c.country,
  ""region"": $c.region,
  ""fax"": $c.fax
};"
211,List all orders from 'Lonesome Pine Restaurant' in 'Portland'.,"MATCH (c:Customer {companyName: 'Lonesome Pine Restaurant', city: 'Portland'})-[:PURCHASED]->(o:Order)
RETURN o.orderID, o.orderDate, o.shipName, o.shipCity, o.shipCountry, o.freight","match
$c isa customer, has company_name ""Lonesome Pine Restaurant"", has city ""Portland"";
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country,
  ""freight"": $o.freight
};"
212,Identify products with a unit price greater than 50 and are in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50 AND c.categoryName = 'Confections'
RETURN p.productName, p.unitPrice, c.categoryName","match
$p isa product, has unit_price $up, has product_name $pn;
$up > 50;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $pn,
  ""unitPrice"": $up,
  ""categoryName"": $c.category_name
};"
213,Which suppliers supply the 'Chef Anton's Cajun Seasoning'?,"MATCH (p:Product {productName: ""Chef Anton's Cajun Seasoning""})<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName","match
$p isa product, has product_name ""Chef Anton's Cajun Seasoning"";
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
214,Show all products in stock that are part of the 'Condiments' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
WHERE p.unitsInStock > 0
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$stock > 0;
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
215,What are the discontinued products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product {discontinued: true})
RETURN p.productName AS DiscontinuedProduct","match
$s isa supplier, has company_name ""Exotic Liquids"";
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
fetch {
  ""DiscontinuedProduct"": $p.product_name
};"
216,List all products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName, p.productID AS productID, p.unitPrice AS unitPrice, p.unitsInStock AS unitsInStock","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p isa product;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock
};"
217,Which suppliers provide products to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, collect(DISTINCT c.categoryID) AS categories
WHERE size(categories) > 1
RETURN s.companyName AS Supplier, categories","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $cat_count = count($c) groupby $s;
match $cat_count > 1;
fetch { ""Supplier"": $s.company_name };"
218,What are the top 3 categories with the highest number of products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN category, productCount","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $c;
sort $product_count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $product_count
};"
219,List the top 5 suppliers with the most products in category 'Beverages'.,"MATCH (c:Category {categoryName: 'Beverages'})<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
WITH s, count(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$c isa category, has category_name ""Beverages"";
$p isa product;
$s isa supplier;
part_of (product: $p, category: $c);
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
220,Which 3 categories have the highest number of discontinued products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN c.categoryName, COUNT(p) AS discontinuedProductCount
ORDER BY discontinuedProductCount DESC
LIMIT 3","match
$p isa product, has discontinued true;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $c.category_name,
  ""discontinuedProductCount"": $count
};"
221,What are the top 3 products with the highest units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match $p isa product, has units_in_stock $stock;
sort $stock desc;
limit 3;
fetch { ""productName"": $p.product_name, ""unitsInStock"": $stock };"
222,List the top 5 most frequently ordered products by 'VINET'.,"MATCH (c:Customer {customerID: 'VINET'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has customer_id ""VINET"";
purchased (customer: $c, order: $o);
$r isa orders (order: $o, product: $p);
reduce $order_count = count($r) groupby $p;
sort $order_count desc;
limit 5;
fetch {
  ""product_name"": $p.product_name,
  ""order_count"": $order_count
};"
223,What are the top 5 products ordered by 'Alfreds Futterkiste'?,"MATCH (c:Customer {companyName: 'Alfreds Futterkiste'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has company_name ""Alfreds Futterkiste"";
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $count
};"
224,List the top 3 most frequent ship cities for orders.,"MATCH (o:Order)
WITH o.shipCity AS city, COUNT(o) AS orderCount
RETURN city, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_city $city;
reduce $count = count($o) groupby $city;
sort $count desc;
limit 3;
fetch {
  ""city"": $city,
  ""orderCount"": $count
};"
225,Who are the top 3 customers based on the number of orders placed?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
226,List the top 3 products that are in stock and not discontinued.,"MATCH (p:Product)
WHERE p.unitsInStock > 0 AND p.discontinued = false
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$p isa product, has units_in_stock $stock, has discontinued false;
$stock > 0;
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
227,Identify the top 5 products with the lowest reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel ASC
LIMIT 5","match
$p isa product, has reorder_level $rl;
sort $rl asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
228,Which 3 categories contain the most products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN category, productCount","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $c;
sort $product_count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $product_count
};"
229,What are the names of the top 3 discontinued products?,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$p isa product, has discontinued true, has units_in_stock $stock;
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name
};"
230,Find the top 5 most expensive products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
231,Which 3 suppliers supply the most products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
232,List the top 5 products with the most units on order.,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
233,Provide the names of products that are part of the 'Seafood' category and have a reorder level of 0.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Seafood' AND p.reorderLevel = 0
RETURN p.productName AS productName","match
$p isa product, has reorder_level 0;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name
};"
234,List the top 3 customers who have ordered the product 'Chai' the most times.,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName AS customer, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$p isa product, has product_name ""Chai"";
orders (order: $o, product: $p);
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customer"": $c.company_name,
  ""orderCount"": $order_count
};"
235,Which 3 products have the highest average discount applied in their orders?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, o.discount AS discount
WHERE discount IS NOT NULL
RETURN p.productName AS productName, AVG(toFloat(discount)) AS avgDiscount
ORDER BY avgDiscount DESC
LIMIT 3","match
$p isa product;
$rel isa orders (product: $p), has discount $d;
reduce $avg_discount = mean($d) groupby $p;
sort $avg_discount desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""avgDiscount"": $avg_discount
};"
236,Identify the 5 most common employee IDs associated with orders.,"MATCH (o:Order)
WITH o.employeeID AS employeeID, COUNT(o) AS orderCount
RETURN employeeID
ORDER BY orderCount DESC
LIMIT 5","match
$o isa order, has employee_id $eid;
reduce $count = count($o) groupby $eid;
sort $count desc;
limit 5;
fetch { ""employeeID"": $eid };"
237,What are the top 3 most frequently reordered products?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 0
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has units_on_order $u;
$u > 0;
sort $u desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
238,List the top 5 suppliers based on the number of cities they supply to.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, COLLECT(DISTINCT o.shipCity) AS cities
RETURN s.companyName AS supplier, SIZE(cities) AS cityCount
ORDER BY cityCount DESC
LIMIT 5","match
$s isa supplier, has company_name $name;
supplies (supplier: $s, product: $p);
orders (product: $p, order: $o);
$o has ship_city $city;
select $s, $name, $city;
distinct;
reduce $city_count = count groupby $s, $name;
sort $city_count desc;
limit 5;
fetch { ""supplier"": $name, ""cityCount"": $city_count };"
239,Which 3 products have the largest quantity per unit in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3","match
$p isa product, has quantity_per_unit $qty;
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
sort $qty desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $qty
};"
240,What are the first 3 categories in which 'Exotic Liquids' supplies products?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
RETURN DISTINCT c.categoryName
ORDER BY c.categoryName
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
sort $cn;
limit 3;
fetch { ""categoryName"": $cn };"
241,Which 3 products have the highest discount in orders?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, o
ORDER BY o.discount DESC
LIMIT 3
RETURN p.productName AS productName, o.discount AS discount","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
sort $d desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""discount"": $d
};"
242,Find the products with 'unitPrice' between 10 and 20.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20
RETURN p.productName, p.unitPrice","match
$p isa product, has unit_price $price;
$price >= 10.0; $price <= 20.0;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
243,List the top 5 suppliers based on the number of products they supply.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
244,Which 3 employees have processed the most orders?,"MATCH (o:Order)
WITH o.employeeID AS employeeID, COUNT(o) AS orderCount
RETURN employeeID, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has employee_id $eid;
reduce $count = count($o) groupby $eid;
sort $count desc;
limit 3;
fetch { ""employeeID"": $eid, ""orderCount"": $count };"
245,Which 3 suppliers are based in the UK?,"MATCH (s:Supplier)
WHERE s.country = 'UK'
RETURN s.companyName
LIMIT 3","match
$s isa supplier, has country ""UK"";
limit 3;
fetch { ""companyName"": $s.company_name };"
246,What are the top 3 most common supplier countries?,"MATCH (s:Supplier)-[:SUPPLIES]->(:Product)
WITH s.country AS country, COUNT(*) AS supplyCount
RETURN country
ORDER BY supplyCount DESC
LIMIT 3","match
$s isa supplier, has country $c;
supplies (supplier: $s, product: $p);
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c };"
247,List the top 5 customers based on the number of unique products ordered.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, COUNT(DISTINCT p.productID) AS uniqueProductsOrdered
ORDER BY uniqueProductsOrdered DESC
LIMIT 5
RETURN c.companyName AS customerName, uniqueProductsOrdered","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $c, $p;
distinct;
reduce $count = count groupby $c;
sort $count desc;
limit 5;
fetch {
  ""customerName"": $c.company_name,
  ""uniqueProductsOrdered"": $count
};"
248,Which 3 products have the lowest unit price and are still in stock?,"MATCH (p:Product)
WHERE p.unitsInStock > 0
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match
$p isa product, has units_in_stock $stock, has unit_price $price;
$stock > 0;
sort $price asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
249,What are the top 3 categories with the least products available?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN category, productCount","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $c;
sort $product_count asc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $product_count
};"
250,List the top 5 products with the highest reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5","match
$p isa product, has reorder_level $rl;
sort $rl desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
251,Which 3 customers have the highest number of discontinued products ordered?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.discontinued = true
WITH c, COUNT(p) AS discontinuedProductCount
ORDER BY discontinuedProductCount DESC
LIMIT 3
RETURN c.companyName AS customerName, discontinuedProductCount","match
$c isa customer, has company_name $name;
$o isa order;
$p isa product, has discontinued true;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $count = count($p) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""customerName"": $name,
  ""discontinuedProductCount"": $count
};"
252,What are the top 3 most common ship vias used for orders?,"MATCH (o:Order)
WITH o.shipVia AS shipVia, COUNT(o) AS orderCount
RETURN shipVia, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_via $sv;
reduce $count = count($o) groupby $sv;
sort $count desc;
limit 3;
fetch { ""shipVia"": $sv, ""orderCount"": $count };"
253,List the top 5 orders with the most products ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, COUNT(r) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN o.orderID AS orderID, productCount","match
$o isa order;
$rel isa orders (order: $o, product: $p);
reduce $product_count = count($rel) groupby $o;
sort $product_count desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""productCount"": $product_count
};"
254,Which 3 products have the highest unit price among those supplied by 'Mayumi's'?,"MATCH (s:Supplier {companyName: ""Mayumi's (on the World Wide Web)#http://www.micros""})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$s isa supplier, has company_name ""Mayumi's (on the World Wide Web)#http://www.micros"";
$p isa product, has unit_price $price;
supplies (supplier: $s, product: $p);
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
255,What are the top 3 most common ship regions for orders?,"MATCH (o:Order)
WHERE o.shipRegion IS NOT NULL
RETURN o.shipRegion AS region, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_region $r;
reduce $count = count($o) groupby $r;
sort $count desc;
limit 3;
fetch { ""region"": $r, ""orderCount"": $count };"
256,List the top 5 products by number of times they have been ordered.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName AS productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product;
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($rel) groupby $p;
sort $order_count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
257,Which 3 suppliers have supplied products with the most units on order?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
RETURN s.companyName, SUM(p.unitsOnOrder) AS totalUnitsOnOrder
ORDER BY totalUnitsOnOrder DESC
LIMIT 3","match
$s isa supplier;
$p isa product, has units_on_order $uoo;
supplies (supplier: $s, product: $p);
reduce $total = sum($uoo) groupby $s;
sort $total desc;
limit 3;
fetch {
  ""companyName"": $s.company_name,
  ""totalUnitsOnOrder"": $total
};"
258,List the top 3 categories by the average units in stock of their products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, avg(p.unitsInStock) AS avgUnitsInStock
RETURN category, avgUnitsInStock
ORDER BY avgUnitsInStock DESC
LIMIT 3","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $avg_stock = mean($stock) groupby $c, $name;
sort $avg_stock desc;
limit 3;
fetch { ""category"": $name, ""avgUnitsInStock"": $avg_stock };"
259,Which 3 products have the smallest quantity per unit available?,"MATCH (p:Product)
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit ASC
LIMIT 3","match
$p isa product, has quantity_per_unit $qpu, has product_name $name;
sort $qpu asc;
limit 3;
fetch {
  ""productName"": $name,
  ""quantityPerUnit"": $qpu
};"
260,What are the top 3 most common ship countries for orders?,"MATCH (o:Order)
WITH o.shipCountry AS country, COUNT(o) AS orderCount
RETURN country
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_country $country;
reduce $count = count($o) groupby $country;
sort $count desc;
limit 3;
fetch { ""country"": $country };"
263,List the top 3 orders with the highest freight charges.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 3","match
$o isa order, has order_id $id, has freight $f;
sort $f desc;
limit 3;
fetch {
  ""orderID"": $id,
  ""freight"": $f
};"
264,What are the top 3 categories with the highest average unit price of products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, avg(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN category, avgUnitPrice","match
$p isa product, has unit_price $price;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $avg_price = mean($price) groupby $c;
sort $avg_price desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""avgUnitPrice"": $avg_price
};"
265,List the first 3 suppliers whose home page starts with 'http'.,"MATCH (s:Supplier)
WHERE s.homePage STARTS WITH 'http'
RETURN s.companyName, s.homePage
LIMIT 3","match
$s isa supplier, has home_page $hp, has company_name $cn;
$hp like ""http.*"";
limit 3;
fetch {
  ""companyName"": $cn,
  ""homePage"": $hp
};"
266,List all products from suppliers located in 'Germany'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.country = 'Germany'
RETURN p.productName AS ProductName, p.productID AS ProductID, s.companyName AS SupplierName","match
$s isa supplier, has country ""Germany"";
$p isa product;
supplies (supplier: $s, product: $p);
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id,
  ""SupplierName"": $s.company_name
};"
267,Show all orders that required shipping to 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'USA'
RETURN o.orderID AS orderID, o.shipName AS shipName, o.requiredDate AS requiredDate, o.shipCity AS shipCity, o.shipPostalCode AS shipPostalCode, o.shipAddress AS shipAddress, o.shipCountry AS shipCountry, o.shipVia AS shipVia, o.shipRegion AS shipRegion","match
$o isa order, has ship_country ""USA"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""requiredDate"": $o.required_date,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via,
  ""shipRegion"": $o.ship_region
};"
268,Which products have a reorder level of 0 and are still in stock?,"MATCH (p:Product)
WHERE p.reorderLevel = 0 AND p.unitsInStock > 0
RETURN p.productName, p.unitsInStock","match
$p isa product, has reorder_level 0, has units_in_stock $stock;
$stock > 0;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
270,Which products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
271,List the first 3 discontinued products and their categories.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN p.productName AS ProductName, c.categoryName AS CategoryName
LIMIT 3","match
$p isa product, has discontinued true;
$c isa category;
part_of (product: $p, category: $c);
limit 3;
fetch {
  ""ProductName"": $p.product_name,
  ""CategoryName"": $c.category_name
};"
272,What are the company names of customers from Germany?,"MATCH (c:Customer)
WHERE c.country = 'Germany'
RETURN c.companyName","match
$c isa customer, has country ""Germany"";
fetch {
  ""companyName"": $c.company_name
};"
273,Which categories contain more than 5 products?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WITH c, count(p) as productCount
WHERE productCount > 5
RETURN c.categoryName, productCount","match
$c isa category;
$p isa product;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
match $count > 5;
fetch { ""categoryName"": $c.category_name, ""productCount"": $count };"
274,What are the names of the top 3 products with the highest units on order?,"MATCH (p:Product)
RETURN p.productName
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 3;
fetch { ""productName"": $p.product_name };"
275,List the top 3 suppliers based in the UK.,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName AS supplierName
ORDER BY s.companyName
LIMIT 3","match
$s isa supplier, has country ""UK"", has company_name $cn;
sort $cn;
limit 3;
fetch {
  ""supplierName"": $cn
};"
276,List the first 3 categories with the most number of products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, count(p) AS productCount
RETURN c.categoryName AS categoryName, productCount
ORDER BY productCount DESC
LIMIT 3","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $count
};"
277,What are the top 3 cities with the most orders shipped?,"MATCH (o:Order)
WITH o.shipCity AS city, COUNT(o) AS orderCount
RETURN city, orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$o isa order, has ship_city $city;
reduce $count = count($o) groupby $city;
sort $count desc;
limit 3;
fetch { ""city"": $city, ""orderCount"": $count };"
278,List the first 3 categories and their descriptions.,"MATCH (c:Category)
RETURN c.categoryName, c.description
ORDER BY c.categoryName
LIMIT 3","match $c isa category, has category_name $name;
sort $name;
limit 3;
fetch { ""categoryName"": $name, ""description"": $c.description };"
279,What are the product names of the top 5 most expensive products?,"MATCH (p:Product)
RETURN p.productName
ORDER BY p.unitPrice DESC
LIMIT 5","match $p isa product, has unit_price $price;
sort $price desc;
limit 5;
fetch { ""productName"": $p.product_name };"
280,"Which products are part of the 'Desserts, candies, and sweet breads' category and have a 'unitsOnOrder' above 5?","MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description = 'Desserts, candies, and sweet breads' AND p.unitsOnOrder > 5
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u;
$c isa category, has description ""Desserts, candies, and sweet breads"";
part_of (product: $p, category: $c);
$u > 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
281,List all customers from 'Berlin' who have ordered more than three times.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.city = 'Berlin'
WITH c, count(o) as orderCount
WHERE orderCount > 3
RETURN c.companyName, c.contactName, c.contactTitle, c.phone, c.address, c.postalCode, c.country","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
match $order_count > 3;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""phone"": $c.phone,
  ""address"": $c.address,
  ""postalCode"": $c.postal_code,
  ""country"": $c.country
};"
282,Show all products with a 'unitPrice' above 20 and a 'reorderLevel' below 5.,"MATCH (p:Product)
WHERE p.unitPrice > 20 AND p.reorderLevel < 5
RETURN p.productName, p.unitPrice, p.reorderLevel","match
$p isa product, has unit_price $up, has reorder_level $rl, has product_name $pn;
$up > 20;
$rl < 5;
fetch {
  ""productName"": $pn,
  ""unitPrice"": $up,
  ""reorderLevel"": $rl
};"
283,Identify all suppliers from 'Germany' who supply products in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE s.country = 'Germany' AND c.categoryName = 'Beverages'
RETURN s.companyName, s.contactName, s.phone, s.address, s.city, s.postalCode","match
$s isa supplier, has country ""Germany"";
$c isa category, has category_name ""Beverages"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
fetch {
  ""companyName"": $s.company_name,
  ""contactName"": $s.contact_name,
  ""phone"": $s.phone,
  ""address"": $s.address,
  ""city"": $s.city,
  ""postalCode"": $s.postal_code
};"
284,Which products are part of the 'Meat/Poultry' category and have a reorder level above 20?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.reorderLevel > 20
RETURN p.productName AS productName, p.reorderLevel AS reorderLevel","match
$p isa product, has reorder_level $rl;
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
$rl > 20;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
285,List the top 5 orders by quantity of products ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$o isa order;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $o;
sort $total desc;
limit 5;
fetch { ""orderID"": $o.order_id, ""totalQuantity"": $total };"
286,Which suppliers provide products that are not discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false
RETURN DISTINCT s.companyName","match
$s isa supplier;
$p isa product, has discontinued false;
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
287,What are the top 5 products with the least units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 5","match
$p isa product, has units_in_stock $stock;
sort $stock asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
288,Which suppliers have a contact title of 'Purchasing Manager'?,"MATCH (s:Supplier)
WHERE s.contactTitle = 'Purchasing Manager'
RETURN s.companyName AS supplierName","match
$s isa supplier, has contact_title ""Purchasing Manager"";
fetch {
  ""supplierName"": $s.company_name
};"
289,List the top 3 most frequently ordered products.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$p isa product;
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($rel) groupby $p;
sort $order_count desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
290,What are the names of the first 3 products that have never been ordered?,"MATCH (p:Product)
WHERE NOT (p)<-[:ORDERS]-(:Order)
RETURN p.productName
LIMIT 3","match
$p isa product;
not { orders (product: $p); };
limit 3;
fetch { ""productName"": $p.product_name };"
291,List the first 3 categories that have a product with a unit price of less than 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice < 10
RETURN DISTINCT c.categoryName
LIMIT 3","match
$p isa product, has unit_price $up;
$up < 10;
part_of (product: $p, category: $c);
select $c;
distinct;
limit 3;
fetch { ""categoryName"": $c.category_name };"
292,Which products have 'NULL' as the region for their suppliers?,"MATCH (p:Product)<-[:SUPPLIES]-(s:Supplier)
WHERE s.region = 'NULL'
RETURN p.productName AS productName, s.companyName AS supplierName","match
$p isa product;
$s isa supplier, has region ""NULL"", has company_name $supplier_name;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $supplier_name
};"
293,List the first 3 products supplied by 'Mayumi's'.,"MATCH (s:Supplier {companyName: ""Mayumi's (on the World Wide Web)#http://www.micros""})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName
LIMIT 3","match
$s isa supplier, has company_name ""Mayumi's (on the World Wide Web)#http://www.micros"";
supplies (supplier: $s, product: $p);
limit 3;
fetch { ""productName"": $p.product_name };"
294,Which products have a reorder level greater than 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel","match
$p isa product, has reorder_level $rl;
$rl > 20;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
295,What are the names of the top 3 customers who have ordered the most in terms of quantity?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3
RETURN c.companyName AS customerName, totalQuantity","match
$c isa customer;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $c;
sort $total desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""totalQuantity"": $total
};"
296,List the first 3 products that are in the category 'Confections' and have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.discontinued = true
RETURN p.productName, p.productID
LIMIT 3","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
297,Which orders were shipped by ship via option '1'?,"MATCH (o:Order)
WHERE o.shipVia = '1'
RETURN o.orderID AS orderID, o.shipName AS shipName, o.shipCity AS shipCity, o.shipPostalCode AS shipPostalCode, o.shipCountry AS shipCountry, o.shipAddress AS shipAddress, o.shipRegion AS shipRegion, o.shippedDate AS shippedDate","match
$o isa order, has ship_via ""1"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country,
  ""shipAddress"": $o.ship_address,
  ""shipRegion"": $o.ship_region,
  ""shippedDate"": $o.shipped_date
};"
298,What are the first 3 products with a quantity per unit of '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p.productName, p.productID, p.quantityPerUnit
LIMIT 3","match
$p isa product, has quantity_per_unit ""10 boxes x 20 bags"";
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""quantityPerUnit"": $p.quantity_per_unit
};"
299,Which suppliers supply to more than three different categories of products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 3
RETURN s.companyName AS Supplier, categoryCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $categoryCount = count($c) groupby $s;
match $categoryCount > 3;
fetch { ""Supplier"": $s.company_name, ""categoryCount"": $categoryCount };"
300,List the top 3 employees who processed the most orders.,"MATCH (e:Employee)-[:PROCESSED]->(o:Order)
WITH e, count(o) as orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN e.employeeID, e.name, orderCount","match
$o isa order, has employee_id $eid;
reduce $count = count($o) groupby $eid;
sort $count desc;
limit 3;
fetch { ""employee_id"": $eid, ""order_count"": $count };"
301,Which products are in the category 'Beverages' and have more than 30 units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Beverages' AND p.unitsInStock > 30
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$stock > 30;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
302,What are the names of products that have a discount of 0?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.discount = ""0""
RETURN p.productName AS productName","match
$p isa product;
$o isa order;
$rel isa orders (order: $o, product: $p);
$rel has discount 0.0;
fetch { ""productName"": $p.product_name };"
303,List the first 3 orders shipped to France.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry, o.shipRegion, o.shipVia, o.shippedDate
ORDER BY o.shippedDate
LIMIT 3","match
$o isa order, has ship_country ""France"", has shipped_date $sd;
sort $sd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipRegion"": $o.ship_region,
  ""shipVia"": $o.ship_via,
  ""shippedDate"": $o.shipped_date
};"
304,Which products have a unit price greater than 50 and are part of the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitPrice > 50
RETURN p.productName, p.unitPrice","match
$p isa product, has unit_price $up;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$up > 50;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
305,Which categories are associated with products that have more than 50 units on order?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 50
RETURN DISTINCT c.categoryName","match
$p isa product, has units_on_order $u;
$u > 50;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
fetch { ""categoryName"": $cn };"
306,List the first 3 suppliers who do not have a fax number.,"MATCH (s:Supplier)
WHERE s.fax IS NULL
RETURN s.companyName
LIMIT 3","match
$s isa supplier;
not { $s has fax $f; };
limit 3;
fetch { ""companyName"": $s.company_name };"
307,What are the top 3 products with the highest quantity per unit available?,"MATCH (p:Product)
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3","match
$p isa product, has quantity_per_unit $q;
sort $q desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $q
};"
309,Find all products with a 'unitsOnOrder' of 0 and a 'reorderLevel' above 10.,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.reorderLevel > 10
RETURN p.productName, p.unitsOnOrder, p.reorderLevel","match
$p isa product,
  has units_on_order $uo,
  has reorder_level $rl,
  has product_name $pn;
$uo == 0;
$rl > 10;
fetch {
  ""productName"": $pn,
  ""unitsOnOrder"": $uo,
  ""reorderLevel"": $rl
};"
310,Which suppliers have more than 3 products in their supply list?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
WHERE productCount > 3
RETURN s.companyName AS SupplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $productCount = count($p) groupby $s;
match $productCount > 3;
fetch {
  ""SupplierName"": $s.company_name,
  ""productCount"": $productCount
};"
311,List all discontinued products in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.discontinued = true
RETURN p.productName, p.productID, p.quantityPerUnit, p.unitPrice, p.unitsInStock, p.unitsOnOrder, p.reorderLevel","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""quantityPerUnit"": $p.quantity_per_unit,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock,
  ""unitsOnOrder"": $p.units_on_order,
  ""reorderLevel"": $p.reorder_level
};"
312,What is the average unit price of products in the 'Dairy Products' category?,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)
RETURN avg(p.unitPrice) AS averageUnitPrice","match
$c isa category, has category_name ""Dairy Products"";
$p isa product, has unit_price $price;
part_of (product: $p, category: $c);
reduce $avg = mean($price);"
313,Display all products that are not discontinued and have a 'unitPrice' above 35.,"MATCH (p:Product)
WHERE p.discontinued = false AND p.unitPrice > 35
RETURN p.productName, p.unitPrice","match
$p isa product, has discontinued false, has unit_price $up;
$up > 35;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
314,Which orders have a 'shippedDate' on or after '1996-07-16'?,"MATCH (o:Order)
WHERE o.shippedDate >= '1996-07-16'
RETURN o.orderID, o.shippedDate","match
$o isa order, has order_id $oid, has shipped_date $sd;
$sd >= ""1996-07-16"";
fetch {
  ""orderID"": $oid,
  ""shippedDate"": $sd
};"
315,Find all suppliers in the 'NULL' region.,"MATCH (s:Supplier)
WHERE s.region = 'NULL'
RETURN s.companyName, s.contactName, s.phone, s.address, s.city, s.country, s.postalCode","match
$s isa supplier, has region ""NULL"";
fetch {
  ""companyName"": $s.company_name,
  ""contactName"": $s.contact_name,
  ""phone"": $s.phone,
  ""address"": $s.address,
  ""city"": $s.city,
  ""country"": $s.country,
  ""postalCode"": $s.postal_code
};"
316,Show all categories for which there is at least one product with 'unitsOnOrder' above 0.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 0
RETURN DISTINCT c.categoryName","match
$p isa product, has units_on_order $u;
$u > 0;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
fetch { ""categoryName"": $cn };"
317,Which products are supplied by suppliers with a phone number ending in '2222'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone ENDS WITH '2222'
RETURN p.productName AS productName","match
$s isa supplier, has phone $phone;
$phone like "".*2222"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
318,List all suppliers that supply discontinued products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
RETURN s.companyName","match
$s isa supplier;
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
319,What are the products ordered by 'FURIB' customer?,"MATCH (c:Customer {customerID: 'FURIB'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName AS productName","match
$c isa customer, has customer_id ""FURIB"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
fetch {
  ""productName"": $p.product_name
};"
320,Identify suppliers who do not have a home page listed.,"MATCH (s:Supplier)
WHERE s.homePage = 'NULL'
RETURN s.companyName AS SupplierName","match
$s isa supplier;
not { $s has home_page $hp; };
fetch {
  ""SupplierName"": $s.company_name
};"
321,Who are the customers in the 'NULL' region?,"MATCH (c:Customer)
WHERE c.region = 'NULL'
RETURN c.contactName AS customerName, c.companyName AS companyName","match
$c isa customer, has region ""NULL"", has contact_name $cn, has company_name $comp;
fetch {
  ""customerName"": $cn,
  ""companyName"": $comp
};"
323,Which products are supplied by a supplier in 'London'?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.city = 'London'
RETURN p.productName AS productName, p.productID AS productID","match
$s isa supplier, has city ""London"";
$p isa product;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
324,Show all products with a 'reorderLevel' of 25 or higher.,"MATCH (p:Product)
WHERE p.reorderLevel >= 25
RETURN p.productName, p.reorderLevel","match
$p isa product, has reorder_level $rl;
$rl >= 25;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
325,Which orders were required by a date earlier than '1997-01-01'?,"MATCH (o:Order)
WHERE o.requiredDate < '1997-01-01'
RETURN o.orderID, o.requiredDate","match
$o isa order, has required_date $rd, has order_id $oid;
$rd < ""1997-01-01"";
fetch {
  ""orderID"": $oid,
  ""requiredDate"": $rd
};"
326,Find all products that are part of more than one order.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, COUNT(o) AS orderCount
WHERE orderCount > 1
RETURN p.productName, orderCount","match
$p isa product;
orders (product: $p, order: $o);
reduce $orderCount = count($o) groupby $p;
match $orderCount > 1;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $orderCount
};"
327,List the top 3 customers by the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $orderCount = count($o) groupby $c;
sort $orderCount desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $orderCount
};"
328,What are the products with 'unitsInStock' less than 5?,"MATCH (p:Product)
WHERE p.unitsInStock < 5
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$stock < 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
329,Identify all orders shipped by 'shipVia' 3.,"MATCH (o:Order)
WHERE o.shipVia = '3'
RETURN o.orderID, o.shipName, o.shipCity, o.shipCountry, o.shipPostalCode, o.shipAddress, o.shipRegion, o.shippedDate","match
$o isa order, has ship_via ""3"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipRegion"": $o.ship_region,
  ""shippedDate"": $o.shipped_date
};"
330,"Which products are part of the 'Breads, crackers, pasta, and cereal' category and have more than 50 units in stock?","MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Breads, crackers, pasta, and cereal'})
WHERE p.unitsInStock > 50
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Breads, crackers, pasta, and cereal"";
part_of (product: $p, category: $c);
$stock > 50;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
331,List all customers with a fax number ending in '6545'.,"MATCH (c:Customer)
WHERE c.fax ENDS WITH '6545'
RETURN c.companyName AS customerName, c.contactName AS contactName, c.fax AS faxNumber","match
$c isa customer, has fax $fax;
$fax like "".*6545"";
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""faxNumber"": $fax
};"
332,Who are the customers in the 'Sales Representative' role?,"MATCH (c:Customer)
WHERE c.contactTitle = 'Sales Representative'
RETURN c.companyName AS customerName, c.contactName AS contactPerson","match
$c isa customer, has contact_title ""Sales Representative"";
fetch {
  ""customerName"": $c.company_name,
  ""contactPerson"": $c.contact_name
};"
333,Which products have a 'quantityPerUnit' specified as '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p.productName","match
$p isa product, has quantity_per_unit ""10 boxes x 20 bags"";
fetch {
  ""productName"": $p.product_name
};"
334,Show all orders from customers in 'Portland'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.city = 'Portland'
RETURN o","match
$c isa customer, has city ""Portland"";
purchased (customer: $c, order: $o);
fetch {
  ""order_id"": $o.order_id,
  ""order_date"": $o.order_date,
  ""ship_name"": $o.ship_name,
  ""ship_city"": $o.ship_city,
  ""ship_country"": $o.ship_country
};"
335,Show all orders placed in '1996' that were shipped to 'USA'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.orderDate STARTS WITH '1996' AND o.shipCountry = 'USA'
RETURN o.orderID AS OrderID, o.orderDate AS OrderDate, o.shipName AS ShipName, o.shipAddress AS ShipAddress, o.shipCity AS ShipCity, o.shipPostalCode AS ShipPostalCode, o.shipCountry AS ShipCountry","match
$o isa order, has order_date $od, has ship_country ""USA"";
$od like ""1996%"";
fetch {
  ""OrderID"": $o.order_id,
  ""OrderDate"": $od,
  ""ShipName"": $o.ship_name,
  ""ShipAddress"": $o.ship_address,
  ""ShipCity"": $o.ship_city,
  ""ShipPostalCode"": $o.ship_postal_code,
  ""ShipCountry"": $o.ship_country
};"
336,Which products have a 'productName' starting with 'C'?,"MATCH (p:Product)
WHERE p.productName STARTS WITH 'C'
RETURN p.productName","match
$p isa product, has product_name $pn;
$pn like ""C.*"";
fetch {
  ""productName"": $pn
};"
337,List all suppliers that are based outside of 'USA' and 'UK'.,"MATCH (s:Supplier)
WHERE s.country <> 'USA' AND s.country <> 'UK'
RETURN s.companyName AS SupplierName, s.country AS Country","match
$s isa supplier, has country $c;
not { $c == ""USA""; };
not { $c == ""UK""; };
fetch {
  ""SupplierName"": $s.company_name,
  ""Country"": $c
};"
338,What are the products with a 'unitPrice' less than 10 and are discontinued?,"MATCH (p:Product)
WHERE p.unitPrice < 10 AND p.discontinued = true
RETURN p.productName, p.unitPrice, p.discontinued","match
$p isa product, has unit_price $up, has discontinued true;
$up < 10;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up,
  ""discontinued"": $p.discontinued
};"
339,Identify all orders shipped to 'France' and have a 'shipVia' of 1.,"MATCH (o:Order)
WHERE o.shipCountry = 'France' AND o.shipVia = '1'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry, o.shipVia","match
$o isa order, has ship_country ""France"", has ship_via ""1"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via
};"
340,Show all products that are part of the 'Grains/Cereals' category and have 'unitsOnOrder' above 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE p.unitsOnOrder > 10
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $uo;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
$uo > 10;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $uo
};"
341,Which products are supplied by suppliers with no listed fax number?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.fax IS NULL
RETURN p.productName AS productName, s.companyName AS supplierName","match
$s isa supplier;
$p isa product;
supplies (supplier: $s, product: $p);
not { $s has fax $f; };
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $s.company_name
};"
342,List the top 3 products by reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 3","match
$p isa product, has reorder_level $rl;
sort $rl desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
343,Find all suppliers who supply products in both 'Beverages' and 'Condiments' categories.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Condiments']
WITH s, c.categoryName AS categoryName
ORDER BY s.supplierID, categoryName
WITH s, collect(categoryName) AS categories
WHERE 'Beverages' IN categories AND 'Condiments' IN categories
RETURN s.companyName AS supplierName","match
$s isa supplier;
$p1 isa product;
$p2 isa product;
$c1 isa category, has category_name ""Beverages"";
$c2 isa category, has category_name ""Condiments"";
supplies (supplier: $s, product: $p1);
supplies (supplier: $s, product: $p2);
part_of (product: $p1, category: $c1);
part_of (product: $p2, category: $c2);
fetch {
  ""supplierName"": $s.company_name
};"
344,Which customers have ordered products with a total quantity greater than 50?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, SUM(r.quantity) AS totalQuantity
WHERE totalQuantity > 50
RETURN c.companyName AS customerName, totalQuantity","match
$c isa customer;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total_quantity = sum($q) groupby $c;
match $total_quantity > 50;
fetch {
  ""customerName"": $c.company_name,
  ""totalQuantity"": $total_quantity
};"
345,Show all products that are in the 'Seafood' category and have been ordered more than 5 times.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
MATCH (o:Order)-[r:ORDERS]->(p)
WITH p, COUNT(r) AS orderCount
WHERE orderCount > 5
RETURN p.productName, p.productID, orderCount","match
$p isa product;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $orderCount = count($rel) groupby $p;
match $orderCount > 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""orderCount"": $orderCount
};"
346,Identify the top 3 most expensive products supplied by suppliers from 'UK'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.country = 'UK'
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$s isa supplier, has country ""UK"";
$p isa product;
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
347,Which orders were placed by 'Sales Representative' title holders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.contactTitle = 'Sales Representative'
RETURN o.orderID AS orderID, o.orderDate AS orderDate, c.companyName AS customerCompanyName","match
$c isa customer, has contact_title ""Sales Representative"";
$o isa order;
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""customerCompanyName"": $c.company_name
};"
348,Display products with 'unitPrice' higher than the average unit price of their category.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, avg(p.unitPrice) AS avgPrice
MATCH (p:Product)-[:PART_OF]->(c)
WHERE p.unitPrice > avgPrice
RETURN p.productName AS productName, p.unitPrice AS unitPrice, c.categoryName AS categoryName","with fun avg_price_for_category($c: category) -> double:
  match
    $p isa product, has unit_price $price;
    part_of (product: $p, category: $c);
  return mean($price);
match
  $p isa product, has unit_price $up, has product_name $pn;
  part_of (product: $p, category: $c);
  $c has category_name $cn;
let $avg = avg_price_for_category($c);
$up > $avg;
fetch {
  ""productName"": $pn,
  ""unitPrice"": $up,
  ""categoryName"": $cn
};"
349,List all products with 'unitPrice' less than 5.,"MATCH (p:Product)
WHERE p.unitPrice < 5
RETURN p.productName, p.unitPrice","match
$p isa product, has product_name $name, has unit_price $price;
$price < 5;
fetch {
  ""productName"": $name,
  ""unitPrice"": $price
};"
350,Which categories contain products that have been reordered (reorder level > 0)?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 0
RETURN DISTINCT c.categoryName","match
$p isa product, has reorder_level $rl;
$rl > 0;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
fetch { ""categoryName"": $cn };"
351,What are the highest discount rates applied to any products?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, r.discount
ORDER BY r.discount DESC
LIMIT 1","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
sort $d desc;
limit 1;
fetch {
  ""productName"": $p.product_name,
  ""discount"": $d
};"
352,Which products have 'unitsInStock' exactly 0 and are not discontinued?,"MATCH (p:Product)
WHERE p.unitsInStock = 0 AND p.discontinued = false
RETURN p.productName, p.productID","match
$p isa product, has units_in_stock 0, has discontinued false;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
353,List all discontinued products with zero units in stock.,"MATCH (p:Product)
WHERE p.discontinued = true AND p.unitsInStock = 0
RETURN p.productName, p.productID","match
$p isa product, has discontinued true, has units_in_stock 0;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
354,Identify the top 3 suppliers by the number of products supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
355,Which orders have a required date in '1996' and were shipped via '2'?,"MATCH (o:Order)
WHERE o.requiredDate STARTS WITH '1996' AND o.shipVia = '2'
RETURN o.orderID, o.requiredDate, o.shipVia","match
$o isa order, has required_date $rd, has ship_via ""2"";
$rd like ""1996.*"";
fetch {
  ""orderID"": $o.order_id,
  ""requiredDate"": $rd,
  ""shipVia"": $o.ship_via
};"
356,Find the top 3 most expensive products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
357,List the first 3 products that have never been reordered (reorder level = 0).,"MATCH (p:Product)
WHERE p.reorderLevel = 0
RETURN p.productName, p.productID
LIMIT 3","match
$p isa product, has reorder_level 0;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
358,List the first 3 suppliers of products in the 'Confections' category.,MATCH (c:Category {categoryName: 'Confections'})\u003c-[:PART_OF]-(p:Product)\u003c-[:SUPPLIES]-(s:Supplier)\nRETURN s.companyName\nLIMIT 3,"match\n$c isa category, has category_name ""Confections"";\npart_of (product: $p, category: $c);\nsupplies (supplier: $s, product: $p);\nlimit 3;\nfetch {\n  ""companyName"": $s.company_name\n};"
359,Which 3 products have been reordered the most times?,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match $p isa product, has units_on_order $u;
sort $u desc;
limit 3;
fetch { ""productName"": $p.product_name, ""unitsOnOrder"": $u };"
360,List the top 5 orders with the highest freight costs.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 5","match
$o isa order, has order_id $oid, has freight $f;
sort $f desc;
limit 5;
fetch {
  ""orderID"": $oid,
  ""freight"": $f
};"
361,Which 3 customers ordered products on '1996-07-04'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order {orderDate: '1996-07-04'})
RETURN c.companyName
LIMIT 3","match
$c isa customer;
$o isa order, has order_date ""1996-07-04"";
purchased (customer: $c, order: $o);
limit 3;
fetch {
  ""companyName"": $c.company_name
};"
362,What are the top 5 products with a reorder level above 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5","match
$p isa product, has reorder_level $rl;
$rl > 20;
sort $rl desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
363,List the first 3 orders that were required after '1997-01-01'.,"MATCH (o:Order)
WHERE o.requiredDate > '1997-01-01'
RETURN o.orderID, o.requiredDate
ORDER BY o.requiredDate
LIMIT 3","match
$o isa order, has required_date $rd;
$rd > ""1997-01-01"";
sort $rd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""requiredDate"": $rd
};"
364,Which 3 categories contain products with no units on order?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.unitsOnOrder = 0
RETURN DISTINCT c.categoryName
LIMIT 3","match
$p isa product, has units_on_order 0;
part_of (product: $p, category: $c);
$c has category_name $name;
select $name;
distinct;
limit 3;
fetch { ""categoryName"": $name };"
365,List the top 5 customers based in London.,"MATCH (c:Customer {city: ""London""})
RETURN c.companyName, c.contactName, c.contactTitle, c.address, c.postalCode, c.phone, c.fax
LIMIT 5","match
$c isa customer, has city ""London"";
limit 5;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""address"": $c.address,
  ""postalCode"": $c.postal_code,
  ""phone"": $c.phone,
  ""fax"": $c.fax
};"
366,Which 3 suppliers have the most products with a reorder level of 0?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.reorderLevel = 0
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product, has reorder_level 0;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
367,What are the top 5 products with the most units in stock in the category 'Dairy Products'?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$p has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
368,List the first 3 orders shipped to 'France' with a ship via code '1'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France' AND o.shipVia = '1'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry, o.shipVia
ORDER BY o.orderDate
LIMIT 3","match
$o isa order, has ship_country ""France"", has ship_via ""1"", has order_date $od;
orders (order: $o, product: $p);
sort $od;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via
};"
369,Which 3 products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""productName"": $p.product_name
};"
370,List the first 3 customers who have purchased 'Chef Anton's Cajun Seasoning'.,"MATCH (p:Product {productName: ""Chef Anton's Cajun Seasoning""})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName, c.contactName, c.customerID
LIMIT 3","match
$p isa product, has product_name ""Chef Anton's Cajun Seasoning"";
orders (order: $o, product: $p);
purchased (customer: $c, order: $o);
limit 3;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""customerID"": $c.customer_id
};"
371,Which 3 products have the lowest unit price in the category 'Beverages'?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$p has unit_price $up;
sort $up asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
372,List the top 5 suppliers located in the UK.,"MATCH (s:Supplier {country: ""UK""})
RETURN s.companyName AS SupplierName
ORDER BY s.companyName
LIMIT 5","match
$s isa supplier, has country ""UK"", has company_name $cn;
sort $cn;
limit 5;
fetch {
  ""SupplierName"": $cn
};"
373,Which 3 customers have purchased the most products by quantity?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN c.companyName AS customer, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3","match
$c isa customer, has company_name $name;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $c, $name;
sort $total desc;
limit 3;
fetch { ""customer"": $name, ""totalQuantity"": $total };"
374,What are the top 5 products ordered by customers from Germany?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'Germany'
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has country ""Germany"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$p has product_name $name;
reduce $count = count($o) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""productName"": $name, ""orderCount"": $count };"
376,Which 3 categories have the most products with a reorder level above 15?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 15
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN category, productCount","match
$p isa product, has reorder_level $rl;
$rl > 15;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $count
};"
377,Which 3 suppliers supply products to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, collect(DISTINCT c.categoryID) AS categories
WHERE size(categories) > 1
RETURN s.companyName AS Supplier, size(categories) AS NumberOfCategories
ORDER BY NumberOfCategories DESC
LIMIT 3","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $cat_count = count groupby $s;
match $cat_count > 1;
sort $cat_count desc;
limit 3;
fetch { ""Supplier"": $s.company_name, ""NumberOfCategories"": $cat_count };"
378,List the top 5 most frequently ordered products.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product;
$rel isa orders (order: $o, product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $count
};"
379,Which 3 products have the most discounts applied in orders?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WITH p.productName AS productName, COUNT(o.discount) AS discountCount
ORDER BY discountCount DESC
LIMIT 3
RETURN productName, discountCount","match
$p isa product;
$o isa orders (product: $p);
$o has discount $d;
reduce $discount_count = count($o) groupby $p;
sort $discount_count desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""discountCount"": $discount_count
};"
380,List the first 3 orders where the shipped date is before the required date.,"MATCH (o:Order)
WHERE o.shippedDate < o.requiredDate
RETURN o.orderID, o.shippedDate, o.requiredDate
ORDER BY o.shippedDate
LIMIT 3","match
$o isa order, has shipped_date $sd, has required_date $rd;
$sd < $rd;
sort $sd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shippedDate"": $sd,
  ""requiredDate"": $rd
};"
381,What are the top 5 categories based on the average reorder level of their products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, AVG(p.reorderLevel) AS avgReorderLevel
ORDER BY avgReorderLevel DESC
LIMIT 5
RETURN category, avgReorderLevel","match
$p isa product, has reorder_level $rl;
$c isa category;
part_of (product: $p, category: $c);
reduce $avg = mean($rl) groupby $c;
sort $avg desc;
limit 5;
fetch {
  ""category"": $c.category_name,
  ""avgReorderLevel"": $avg
};"
382,List the top 5 products with discontinued status and a reorder level above 5.,"MATCH (p:Product)
WHERE p.discontinued = true AND p.reorderLevel > 5
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5","match
$p isa product, has discontinued true, has reorder_level $rl;
$rl > 5;
sort $rl desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
383,Which 3 suppliers have products listed in both 'Beverages' and 'Condiments' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Condiments']
WITH s, c.categoryName AS categoryName
ORDER BY s.supplierID, categoryName
WITH s, collect(categoryName) AS categories
WHERE 'Beverages' IN categories AND 'Condiments' IN categories
RETURN s.companyName AS supplierName
LIMIT 3","match
$s isa supplier, has company_name $name;
$c1 isa category, has category_name ""Beverages"";
$c2 isa category, has category_name ""Condiments"";
$p1 isa product;
$p2 isa product;
supplies (supplier: $s, product: $p1);
supplies (supplier: $s, product: $p2);
part_of (product: $p1, category: $c1);
part_of (product: $p2, category: $c2);
limit 3;
fetch { ""supplierName"": $name };"
384,List the top 5 products with the lowest units in stock.,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 5","match
$p isa product, has units_in_stock $stock;
sort $stock asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
385,Which 3 customers have ordered the most diverse range of product categories?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH c, collect(DISTINCT cat.categoryID) AS categories
RETURN c.companyName, size(categories) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
select $c, $cat;
distinct;
reduce $category_count = count groupby $c;
sort $category_count desc;
limit 3;
fetch { ""companyName"": $c.company_name, ""categoryCount"": $category_count };"
386,What are the top 5 most frequently shipped products to 'France'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN p.productName, COUNT(*) AS shipmentCount
ORDER BY shipmentCount DESC
LIMIT 5","match
$o isa order, has ship_country ""France"";
orders (order: $o, product: $p);
reduce $count = count groupby $p;
sort $count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""shipmentCount"": $count
};"
387,Which 3 categories have the highest average unit price per product?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, avg(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN category, avgUnitPrice","match
$p isa product, has unit_price $price;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $avg = mean($price) groupby $c;
sort $avg desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""avgUnitPrice"": $avg
};"
388,List the top 5 most expensive products that are not discontinued.,"MATCH (p:Product)
WHERE p.discontinued = false
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$p isa product, has discontinued false, has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
389,List the top 5 orders placed by customers in 'Berlin'.,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)
RETURN o.orderID, o.orderDate, o.shipName, o.shipAddress, o.shipCity, o.shipPostalCode, o.shipCountry
ORDER BY o.orderDate DESC
LIMIT 5","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
$o has order_date $od;
sort $od desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipAddress"": $o.ship_address,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country
};"
390,List the top 5 customers who have ordered the most units of a single product.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, SUM(r.quantity) AS totalUnits
RETURN c.companyName AS customer, totalUnits
ORDER BY totalUnits DESC
LIMIT 5","match
$c isa customer;
$o isa order;
$p isa product;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $c;
sort $total desc;
limit 5;
fetch { ""customer"": $c.company_name, ""totalUnits"": $total };"
391,Which 3 products have the highest units on order in the 'Meat/Poultry' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
$p has units_on_order $uoo;
sort $uoo desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $uoo
};"
392,What are the top 5 most frequently purchased categories by customers in the USA?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WHERE c.country = 'USA'
WITH cat.categoryName AS category, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN category, orderCount","match
$c isa customer, has country ""USA"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
$cat has category_name $name;
reduce $order_count = count($o) groupby $cat, $name;
sort $order_count desc;
limit 5;
fetch {
  ""category"": $name,
  ""orderCount"": $order_count
};"
393,List the top 5 products from 'Exotic Liquids' by units in stock.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
394,Which 3 categories have products that are all discontinued?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.discontinued = true
WITH c, COUNT(p) AS totalProducts
MATCH (c)<-[:PART_OF]-(p:Product)
WITH c, totalProducts, COUNT(p) AS totalProductsInCategory
WHERE totalProducts = totalProductsInCategory
RETURN c.categoryName
ORDER BY c.categoryName
LIMIT 3","match
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
not {
  part_of (product: $p2, category: $c);
  $p2 has discontinued false;
};
sort $name;
limit 3;
fetch { ""categoryName"": $name };"
395,List the first 3 products that are supplied exclusively by 'Mayumi's'.,"MATCH (s:Supplier {companyName: ""Mayumi's (on the World Wide Web)#http://www.micros""})-[:SUPPLIES]->(p:Product)
WITH p, count(s) AS supplierCount
WHERE supplierCount = 1
RETURN p.productName
LIMIT 3","match
$s isa supplier, has company_name ""Mayumi's (on the World Wide Web)#http://www.micros"";
supplies (supplier: $s, product: $p);
reduce $count = count($s) groupby $p;
match $count == 1;
limit 3;
fetch { ""productName"": $p.product_name };"
396,Which 3 orders have the largest quantity of a single product ordered?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, r.quantity AS quantity
ORDER BY r.quantity DESC
LIMIT 3","match
$o isa order;
$rel isa orders (order: $o, product: $p), has quantity $q;
sort $q desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""quantity"": $q
};"
397,What are the top 5 suppliers with the most products listed?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
398,List the first 3 customers who have never ordered a discontinued product.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.discontinued = false
WITH c, COUNT(DISTINCT p) AS productCount
MATCH (c)-[:PURCHASED]->(o)-[:ORDERS]->(p)
WITH c, productCount, COUNT(DISTINCT p) AS totalProductCount
WHERE productCount = totalProductCount
RETURN c.companyName AS customerName, c.contactName AS contactName, c.customerID AS customerID
LIMIT 3","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
not {
  purchased (customer: $c, order: $o2);
  orders (order: $o2, product: $pd);
  $pd has discontinued true;
};
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""customerID"": $c.customer_id
};"
400,Which 3 suppliers supply products with more than 50 units in stock?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock > 50
RETURN s.companyName
LIMIT 3","match
$s isa supplier;
$p isa product, has units_in_stock $stock;
$stock > 50;
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
401,What are the top 5 products with the highest units on order?,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
403,Which products have been ordered more than 100 times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WHERE o.quantity > 100
RETURN p.productName AS productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
$q > 100;
reduce $total = sum($q) groupby $p;
sort $total desc;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
404,What is the average discount given across all orders?,"MATCH (:Order)-[o:ORDERS]->(:Product)
RETURN avg(toFloat(o.discount)) AS averageDiscount","match
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
reduce $avg = mean($d);"
405,Which orders were required by '1998-06-02'?,"MATCH (o:Order)
WHERE o.requiredDate <= '1998-06-02'
RETURN o.orderID, o.requiredDate, o.customerID, o.shipName, o.shipCity, o.shipCountry","match
$o isa order, has required_date $rd;
$rd <= ""1998-06-02"";
purchased (customer: $c, order: $o);
$c has customer_id $cid;
fetch {
  ""orderID"": $o.order_id,
  ""requiredDate"": $rd,
  ""customerID"": $cid,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
406,List the products that are part of the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName AS ProductName","match
$p isa product;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
fetch {
  ""ProductName"": $p.product_name
};"
407,What are the three highest freight values in orders?,"MATCH (o:Order)
RETURN o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 3","match
$o isa order, has freight $f;
sort $f desc;
limit 3;
fetch {
  ""freight"": $f
};"
408,Which customers have a contactTitle of 'Sales Representative'?,"MATCH (c:Customer)
WHERE c.contactTitle = 'Sales Representative'
RETURN c.companyName AS customerName, c.contactName AS contactName","match
$c isa customer, has contact_title ""Sales Representative"";
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name
};"
409,How many products are supplied by each supplier?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
RETURN s.companyName AS Supplier, COUNT(p) AS NumberOfProducts
ORDER BY NumberOfProducts DESC","match
$s isa supplier;
$p isa product;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
fetch { ""Supplier"": $s.company_name, ""NumberOfProducts"": $count };"
410,Which products have a discount of 0 in their orders?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.discount = ""0""
RETURN DISTINCT p.productName","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
$d == 0.0;
select $p;
distinct;
fetch {
  ""productName"": $p.product_name
};"
411,What are the names of suppliers based in the UK?,"MATCH (s:Supplier)
WHERE s.country = 'UK'
RETURN s.companyName AS supplierName","match
$s isa supplier, has country ""UK"";
fetch {
  ""supplierName"": $s.company_name
};"
412,What are the names of the products that have a quantityPerUnit of '10 boxes x 20 bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit = '10 boxes x 20 bags'
RETURN p.productName AS productName","match
$p isa product, has quantity_per_unit ""10 boxes x 20 bags"";
fetch {
  ""productName"": $p.product_name
};"
413,Which category has the least number of products on order?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.unitsOnOrder > 0
RETURN c.categoryName, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 1","match
$c isa category;
$p isa product, has units_on_order $uoo;
$uoo > 0;
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $c;
sort $product_count asc;
limit 1;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $product_count
};"
414,List three customers who have purchased orders shipped to France.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN DISTINCT c.companyName
LIMIT 3","match
$c isa customer, has company_name $name;
$o isa order, has ship_country ""France"";
purchased (customer: $c, order: $o);
select $name;
distinct;
limit 3;
fetch { ""companyName"": $name };"
415,Which suppliers have a contactTitle of 'Purchasing Manager'?,"MATCH (s:Supplier)
WHERE s.contactTitle = 'Purchasing Manager'
RETURN s.companyName AS supplierName","match
$s isa supplier, has contact_title ""Purchasing Manager"";
fetch {
  ""supplierName"": $s.company_name
};"
416,What are the three most common product categories based on the number of products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
RETURN c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3","match
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch { ""category"": $c.category_name, ""productCount"": $count };"
417,Which categories include products that have been discontinued?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN DISTINCT c.categoryName","match
$p isa product, has discontinued true;
part_of (product: $p, category: $c);
$c has category_name $name;
select $name;
distinct;
fetch { ""categoryName"": $name };"
418,What is the average unitPrice of products in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN avg(p.unitPrice) AS averageUnitPrice","match
$p isa product, has unit_price $price;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
reduce $avg = mean($price);"
419,List the products with unitsOnOrder greater than 30.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 30
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u;
$u > 30;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
420,Which products have a reorderLevel of 25 or higher?,"MATCH (p:Product)
WHERE p.reorderLevel >= 25
RETURN p.productName, p.reorderLevel","match
$p isa product, has reorder_level $rl;
$rl >= 25;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
421,"What are the three most recent orders, based on orderDate?","MATCH (o:Order)
WITH o
ORDER BY o.orderDate DESC
LIMIT 3
RETURN o.orderID, o.orderDate, o.customerID, o.shipName, o.shipCity, o.shipCountry","match
$o isa order, has order_date $od;
purchased (customer: $c, order: $o);
sort $od desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""customerID"": $c.customer_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
422,Name three customers from Berlin.,"MATCH (c:Customer)
WHERE c.city = 'Berlin'
RETURN c.companyName
LIMIT 3","match $c isa customer, has city ""Berlin"";
limit 3;
fetch { ""companyName"": $c.company_name };"
423,What are the top 5 products by quantity ordered in the most recent orders?,"// First, find the most recent order date
MATCH (o:Order)
WITH max(o.orderDate) AS mostRecentOrderDate

// Then, find the top 5 products by quantity ordered in the most recent orders
MATCH (o:Order {orderDate: mostRecentOrderDate})-[:ORDERS]->(p:Product)
RETURN p.productName, SUM(o.quantity) AS totalQuantityOrdered
ORDER BY totalQuantityOrdered DESC
LIMIT 5","match
$o isa order, has order_date $od;
reduce $max_date = max($od);
match
$o2 isa order, has order_date $od2;
$od2 == $max_date;
$rel isa orders (order: $o2, product: $p), has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 5;
fetch { ""productName"": $p.product_name, ""totalQuantityOrdered"": $total };"
424,What are the top 5 products with the lowest unit price in the 'Seafood' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 5","match
$p isa product, has unit_price $price;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
sort $price asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
425,Name the top three most frequently ordered products.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$p isa product;
$o isa orders (order: $ord, product: $p);
reduce $order_count = count($o) groupby $p;
sort $order_count desc;
limit 3;
fetch {
  ""product_name"": $p.product_name,
  ""order_count"": $order_count
};"
426,What is the maximum unitsOnOrder for products within the 'Confections' category?,"MATCH (c:Category {categoryName: 'Confections'})<-[:PART_OF]-(p:Product)
RETURN MAX(p.unitsOnOrder) AS maxUnitsOnOrder","match
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
$p has units_on_order $u;
reduce $max = max($u);"
427,What are the top 5 categories by total unitsInStock?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, SUM(p.unitsInStock) AS totalUnitsInStock
ORDER BY totalUnitsInStock DESC
LIMIT 5
RETURN category, totalUnitsInStock","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $total = sum($stock) groupby $c, $name;
sort $total desc;
limit 5;
fetch { ""category"": $name, ""totalUnitsInStock"": $total };"
428,List the products supplied by suppliers with a phone number starting with '(171)'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone STARTS WITH '(171)'
RETURN p.productName AS productName, s.companyName AS supplierName","match
$s isa supplier, has phone $phone;
$phone like ""\\(171\\).*"";
$p isa product;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $s.company_name
};"
429,Name three suppliers from Germany.,"MATCH (s:Supplier {country: ""Germany""})
RETURN s.companyName
LIMIT 3","match
$s isa supplier, has country ""Germany"";
limit 3;
fetch { ""companyName"": $s.company_name };"
430,Which products have a unitsOnOrder of zero and are discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.discontinued = true
RETURN p.productName, p.productID","match
$p isa product, has units_on_order 0, has discontinued true;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
431,What are the three least expensive products in terms of unitPrice?,"MATCH (p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match $p isa product, has unit_price $price;
sort $price asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
432,What are the names of customers who have ordered products in the 'Beverages' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WHERE cat.categoryName = 'Beverages'
RETURN DISTINCT c.companyName AS customerName","match
$c isa customer;
$o isa order;
$p isa product;
$cat isa category, has category_name ""Beverages"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
select $c;
distinct;
fetch {
  ""customerName"": $c.company_name
};"
433,Which products have been reordered (unitsOnOrder greater than 0) but not discontinued?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 0 AND p.discontinued = false
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u, has discontinued false;
$u > 0;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
434,List the top three categories by average unitPrice of products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, avg(p.unitPrice) AS avgPrice
ORDER BY avgPrice DESC
LIMIT 3
RETURN category, avgPrice","match
$p isa product, has unit_price $price;
$c isa category;
part_of (product: $p, category: $c);
reduce $avg_price = mean($price) groupby $c;
sort $avg_price desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""avgPrice"": $avg_price
};"
435,Which suppliers are located in cities starting with 'L'?,"MATCH (s:Supplier)
WHERE s.city STARTS WITH 'L'
RETURN s.companyName AS supplierName, s.city AS city","match
$s isa supplier, has city $c;
$c like ""L.*"";
fetch {
  ""supplierName"": $s.company_name,
  ""city"": $c
};"
436,Which suppliers do not have a homePage listed?,"MATCH (s:Supplier)
WHERE s.homePage = 'NULL'
RETURN s.companyName AS supplierName","match
$s isa supplier;
not { $s has home_page $hp; };
fetch {
  ""supplierName"": $s.company_name
};"
437,Which categories have products with a unitPrice greater than 50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN DISTINCT c.categoryName","match
$p isa product, has unit_price $up;
$up > 50;
$c isa category;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch { ""categoryName"": $c.category_name };"
438,What are the names of products that have been ordered with a quantity greater than 50?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.quantity > 50
RETURN p.productName AS productName","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
$q > 50;
fetch {
  ""productName"": $p.product_name
};"
439,Which orders have a shipVia of '1' and were shipped to 'France'?,"MATCH (o:Order)
WHERE o.shipVia = '1' AND o.shipCountry = 'France'
RETURN o.orderID, o.shipName, o.shipCity, o.shipAddress, o.shipPostalCode, o.shipCountry, o.shipVia","match
$o isa order, has ship_via ""1"", has ship_country ""France"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipAddress"": $o.ship_address,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via
};"
440,List the products with a unitsInStock less than 15.,"MATCH (p:Product)
WHERE p.unitsInStock < 15
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$stock < 15;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
441,What is the minimum reorder level for products in the 'Seafood' category?,"MATCH (c:Category {categoryName: 'Seafood'})<-[:PART_OF]-(p:Product)
RETURN MIN(p.reorderLevel) AS minReorderLevel","match
$c isa category, has category_name ""Seafood"";
$p isa product, has reorder_level $rl;
part_of (product: $p, category: $c);
reduce $min_reorder = min($rl);"
442,How many different categories of products do we have?,"MATCH (c:Category)
RETURN count(DISTINCT c.categoryID) AS numberOfCategories","match $c isa category;
reduce $count = count($c);"
443,Which products have the lowest unitsInStock in the 'Grains/Cereals' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WITH p
ORDER BY p.unitsInStock ASC
LIMIT 1
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
sort $stock asc;
limit 1;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
444,What are the names of suppliers who supply products to orders with a shipCountry of 'Denmark'?,"MATCH (o:Order)-[:ORDERS]->(p:Product)<-[:SUPPLIES]-(s:Supplier)
WHERE o.shipCountry = 'Denmark'
RETURN DISTINCT s.companyName AS supplierName","match
$o isa order, has ship_country ""Denmark"";
orders (order: $o, product: $p);
supplies (supplier: $s, product: $p);
select $s;
distinct;
fetch {
  ""supplierName"": $s.company_name
};"
445,List the names of three customers who ordered products shipped via '3'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '3'
RETURN DISTINCT c.companyName
LIMIT 3","match
$c isa customer, has company_name $name;
$o isa order, has ship_via ""3"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $name;
distinct;
limit 3;
fetch { ""companyName"": $name };"
446,Which suppliers supply more than five different products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(DISTINCT p.productID) AS productCount
WHERE productCount > 5
RETURN s.companyName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $productCount = count($p) groupby $s;
match $productCount > 5;
fetch {
  ""companyName"": $s.company_name,
  ""productCount"": $productCount
};"
447,What is the total number of units ordered for products by 'Vins et alcools Chevalier'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipName = 'Vins et alcools Chevalier'
RETURN SUM(o.quantity) AS totalUnitsOrdered","match
$c isa customer;
$o isa order, has ship_name ""Vins et alcools Chevalier"";
$p isa product;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p), has quantity $q;
reduce $total = sum($q);
fetch { ""totalUnitsOrdered"": $total };"
448,Which suppliers provide products that are not discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = false
RETURN DISTINCT s.companyName","match
$s isa supplier;
$p isa product, has discontinued false;
supplies (supplier: $s, product: $p);
select $s;
distinct;
fetch { ""companyName"": $s.company_name };"
449,Which 3 suppliers have the most products with zero units on order?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsOnOrder = 0
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product, has units_on_order 0;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
450,Which 3 products have been purchased the most times in the 'Dairy Products' category?,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
WITH p, COUNT(o) AS purchaseCount
ORDER BY purchaseCount DESC
LIMIT 3
RETURN p.productName, purchaseCount","match
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $count = count($o) groupby $p;
sort $count desc;
limit 3;
fetch { ""productName"": $p.product_name, ""purchaseCount"": $count };"
451,Which customers have ordered 'Chai'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productName: 'Chai'})
RETURN c.companyName AS customerName","match
$c isa customer;
$o isa order;
$p isa product, has product_name ""Chai"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
fetch {
  ""customerName"": $c.company_name
};"
452,Show all products that are in stock but have a reorder level above 20.,"MATCH (p:Product)
WHERE p.unitsInStock > 0 AND p.reorderLevel > 20
RETURN p.productName, p.unitsInStock, p.reorderLevel","match
$p isa product, has units_in_stock $stock, has reorder_level $reorder;
$stock > 0;
$reorder > 20;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock,
  ""reorderLevel"": $reorder
};"
453,Which products are supplied by suppliers from the UK?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.country = 'UK'
RETURN p.productName AS ProductName, s.companyName AS SupplierName","match
$s isa supplier, has country ""UK"";
$p isa product;
supplies (supplier: $s, product: $p);
fetch {
  ""ProductName"": $p.product_name,
  ""SupplierName"": $s.company_name
};"
454,List the top 5 suppliers based on the number of products they supply.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
455,Which categories contain products that have never been reordered (reorder level is 0)?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 0
RETURN DISTINCT c.categoryName","match
$p isa product, has reorder_level 0;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch {
  ""categoryName"": $c.category_name
};"
456,List the first 3 products with the highest discount in orders.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH p.productName AS productName, r.discount AS discount
ORDER BY discount DESC
LIMIT 3
RETURN productName, discount","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
sort $d desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""discount"": $d
};"
457,Which supplier supplies the most products to 'Alfreds Futterkiste'?,"MATCH (c:Customer {companyName: 'Alfreds Futterkiste'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 1","match
$c isa customer, has company_name ""Alfreds Futterkiste"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 1;
fetch { ""companyName"": $s.company_name, ""productCount"": $count };"
458,What are the first 3 most frequently ordered products?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WITH p.productName AS productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN productName, orderCount","match
$p isa product, has product_name $name;
$rel isa orders (product: $p);
reduce $count = count($rel) groupby $name;
sort $count desc;
limit 3;
fetch { ""productName"": $name, ""orderCount"": $count };"
459,List all customers who have purchased products with a unit price greater than 50.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WHERE toFloat(r.unitPrice) > 50
RETURN DISTINCT c.companyName AS customerName, c.contactName AS contactName, c.contactTitle AS contactTitle, c.phone AS phone, c.city AS city, c.country AS country","match
$c isa customer;
$o isa order;
$p isa product;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has order_unit_price $price;
$price > 50;
select $c;
distinct;
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""phone"": $c.phone,
  ""city"": $c.city,
  ""country"": $c.country
};"
460,Which products have been ordered by 'Alfreds Futterkiste'?,"MATCH (c:Customer {companyName: 'Alfreds Futterkiste'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName","match
$c isa customer, has company_name ""Alfreds Futterkiste"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
fetch {
  ""productName"": $p.product_name
};"
461,What are the top 5 most stocked products in the 'Dairy Products' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product, has product_name $name, has units_in_stock $stock;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
sort $stock desc;
limit 5;
fetch {
  ""productName"": $name,
  ""unitsInStock"": $stock
};"
462,List all products that have more than 50 units on order.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 50
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u;
$u > 50;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
463,Which suppliers provide products with a reorder level above 25?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.reorderLevel > 25
RETURN s.companyName AS SupplierName","match
$s isa supplier;
$p isa product, has reorder_level $rl;
$rl > 25;
supplies (supplier: $s, product: $p);
fetch {
  ""SupplierName"": $s.company_name
};"
464,Show the first 3 products that have been discontinued.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.productID
LIMIT 3","match
$p isa product, has discontinued true;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
465,What are the top 5 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
466,List all products that are part of the 'Beverages' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName AS ProductName, p.productID AS ProductID, p.unitPrice AS UnitPrice, p.unitsInStock AS UnitsInStock","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id,
  ""UnitPrice"": $p.unit_price,
  ""UnitsInStock"": $p.units_in_stock
};"
467,Which products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has company_name ""Exotic Liquids"";
$p isa product;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
468,Which 3 products have been ordered by the most distinct customers?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH p, COUNT(DISTINCT c) AS customerCount
RETURN p.productName, customerCount
ORDER BY customerCount DESC
LIMIT 3","match
$c isa customer;
$o isa order;
$p isa product;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $c, $p;
distinct;
reduce $count = count groupby $p;
sort $count desc;
limit 3;
fetch { ""productName"": $p.product_name, ""customerCount"": $count };"
469,List the top 5 products by units on order in the 'Seafood' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
$p has units_on_order $u;
sort $u desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
471,What are the top 5 most ordered products in terms of quantity?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName AS productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 5;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
472,List all categories that have products with units in stock less than 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsInStock < 10
RETURN DISTINCT c.categoryName","match
$p isa product, has units_in_stock $stock;
$stock < 10;
$c isa category;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch {
  ""categoryName"": $c.category_name
};"
473,Which suppliers have all their products with a unit price above 20?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COLLECT(p.unitPrice > 20) AS prices
WHERE ALL(price IN prices WHERE price = true)
RETURN s.companyName","match
$s isa supplier;
supplies (supplier: $s, product: $p);
$p has unit_price $price;
$price > 20;
not {
  supplies (supplier: $s, product: $p2);
  $p2 has unit_price $price2;
  $price2 <= 20;
};
fetch {
  ""companyName"": $s.company_name
};"
474,Which suppliers have products listed in more than three categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 3
RETURN s.companyName","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $cat_count = count($c) groupby $s;
match $cat_count > 3;
fetch { ""companyName"": $s.company_name };"
475,List the first 3 products from the 'Grains/Cereals' category that have been reordered (reorder level > 0).,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WHERE p.reorderLevel > 0
RETURN p.productName, p.reorderLevel
LIMIT 3","match
$p isa product, has reorder_level $rl;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
$rl > 0;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
476,Which products have a discount greater than 0 in their orders?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE toFloat(o.discount) > 0
RETURN DISTINCT p.productName","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
$d > 0;
select $p;
distinct;
fetch { ""productName"": $p.product_name };"
477,Show the first 3 products with the highest units on order.,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
478,Which products have been ordered by customers from Berlin?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.city = 'Berlin'
RETURN DISTINCT p.productName","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $p;
distinct;
fetch { ""productName"": $p.product_name };"
479,List all suppliers that provide products to the 'Dairy Products' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN s.companyName","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Dairy Products"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
fetch {
  ""companyName"": $s.company_name
};"
480,What are the top 5 products by quantity ordered in the 'Condiments' category?,"MATCH (c:Category {categoryName: 'Condiments'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p), has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 5;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
481,Show the first 3 orders from 'Lonesome Pine Restaurant' with a freight cost less than 1.,"MATCH (c:Customer {companyName: 'Lonesome Pine Restaurant'})-[:PURCHASED]->(o:Order)
WHERE toFloat(o.freight) < 1
RETURN o.orderID, o.orderDate, o.freight
ORDER BY o.orderDate
LIMIT 3","match
$c isa customer, has company_name ""Lonesome Pine Restaurant"";
purchased (customer: $c, order: $o);
$o has order_date $od, has freight $f;
$f < ""1"";
sort $od;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $od,
  ""freight"": $f
};"
482,Which customers have ordered the product with productID '1'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product {productID: '1'})
RETURN c.companyName AS customerName, c.contactName AS contactName, c.customerID AS customerID","match
$c isa customer;
$o isa order;
$p isa product, has product_id ""1"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""customerID"": $c.customer_id
};"
483,List all products supplied by 'Exotic Liquids' that have a unit price above 10.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 10
RETURN p.productName, p.unitPrice","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
$price > 10;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
484,Which suppliers provide products to the 'Meat/Poultry' category with a unit price less than 20?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.unitPrice < 20
RETURN s.companyName","match
$s isa supplier;
$p isa product, has unit_price $up;
$c isa category, has category_name ""Meat/Poultry"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$up < 20;
fetch {
  ""companyName"": $s.company_name
};"
485,List the top 5 customers based on the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 5;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
486,Show all products that are both in the 'Seafood' category and have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Seafood' AND p.discontinued = true
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock
};"
487,Which categories have products with a unit price greater than 100?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
RETURN DISTINCT c.categoryName","match
$p isa product, has unit_price $price;
$price > 100;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch { ""categoryName"": $c.category_name };"
488,List the first 3 products that have been ordered by customers from France.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'France'
RETURN p.productName AS productName, p.productID AS productID
LIMIT 3","match
$c isa customer, has country ""France"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
489,Which suppliers supply to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, collect(DISTINCT c.categoryID) AS categories
WHERE size(categories) > 1
RETURN s.companyName AS Supplier, categories","match
$s isa supplier, has company_name $name;
$p isa product;
$c isa category, has category_id $cid;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $name, $c;
distinct;
reduce $cat_count = count groupby $s, $name;
match $cat_count > 1;
fetch { ""Supplier"": $name };"
490,List all products that have been ordered in the month of July 1996.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.orderDate STARTS WITH '1996-07'
RETURN p.productName AS ProductName, p.productID AS ProductID","match
$p isa product;
$o isa order, has order_date $od;
orders (order: $o, product: $p);
$od like ""1996-07.*"";
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id
};"
491,Which products have been ordered more than 100 times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WHERE o.quantity > 100
RETURN p.productName, SUM(o.quantity) AS totalOrdered
ORDER BY totalOrdered DESC","match
$p isa product;
$rel isa orders (order: $o, product: $p), has quantity $q;
$q > 100;
reduce $total = sum($q) groupby $p;
sort $total desc;
fetch {
  ""productName"": $p.product_name,
  ""totalOrdered"": $total
};"
492,Show the first 3 products with the lowest units in stock in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
$p has units_in_stock $stock;
sort $stock asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
493,What are the first 3 products with the highest units on order in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$p has units_on_order $uoo;
sort $uoo desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $uoo
};"
494,What are the top 5 most frequently ordered products in the 'Produce' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
MATCH (o:Order)-[r:ORDERS]->(p)
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Produce"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $count
};"
495,List the first 3 products from suppliers in 'UK'.,"MATCH (s:Supplier {country: 'UK'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName, s.companyName AS supplierName
LIMIT 3","match
$s isa supplier, has country ""UK"", has company_name $sn;
supplies (supplier: $s, product: $p);
$p has product_name $pn;
limit 3;
fetch {
  ""productName"": $pn,
  ""supplierName"": $sn
};"
496,Which 3 suppliers have the least discontinued products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
WITH s, COUNT(p) AS discontinuedProducts
ORDER BY discontinuedProducts ASC
LIMIT 3
RETURN s.companyName, discontinuedProducts","match
$s isa supplier;
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count asc;
limit 3;
fetch {
  ""companyName"": $s.company_name,
  ""discontinuedProducts"": $count
};"
497,Which 3 products have the highest average discount in orders?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, o.discount AS discount
WHERE discount IS NOT NULL
RETURN p.productName AS productName, AVG(toFloat(discount)) AS avgDiscount
ORDER BY avgDiscount DESC
LIMIT 3","match
$p isa product;
$rel isa orders (product: $p), has discount $d;
reduce $avg = mean($d) groupby $p;
sort $avg desc;
limit 3;
fetch { ""productName"": $p.product_name };"
498,List the top 5 products that have been ordered more than 50 times.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WITH p, SUM(o.quantity) AS totalQuantity
WHERE totalQuantity > 50
RETURN p.productName, totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$p isa product;
$o isa orders (product: $p);
$o has quantity $q;
reduce $total = sum($q) groupby $p;
match $total > 50;
sort $total desc;
limit 5;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
499,Which 3 suppliers have the most products discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
WITH s, COUNT(p) AS discontinuedProducts
ORDER BY discontinuedProducts DESC
LIMIT 3
RETURN s.companyName AS Supplier, discontinuedProducts","match
$s isa supplier;
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""discontinuedProducts"": $count
};"
500,List the top 5 products that have the highest reorder levels.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5","match
$p isa product, has reorder_level $rl;
sort $rl desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
501,Which 3 customers have the most orders with a ship via code '3'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipVia = '3'
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
$o isa order, has ship_via ""3"";
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
502,What are the top 5 products in the 'Grains/Cereals' category by units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
$p has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
503,List the top 5 most frequently ordered products by customers in 'London'.,"MATCH (c:Customer {city: 'London'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has city ""London"";
purchased (customer: $c, order: $o);
$r isa orders (order: $o, product: $p);
reduce $order_count = count($r) groupby $p;
sort $order_count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
504,Which 3 categories have the least discontinued products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
WITH c.categoryName AS category, COUNT(p) AS discontinuedCount
ORDER BY discontinuedCount ASC
LIMIT 3
RETURN category, discontinuedCount","match
$p isa product, has discontinued true;
part_of (product: $p, category: $c);
$c has category_name $name;
reduce $count = count($p) groupby $c, $name;
sort $count asc;
limit 3;
fetch {
  ""category"": $name,
  ""discontinuedCount"": $count
};"
505,List the first 3 products that have been ordered with a discount of more than 5%.,"MATCH (o:Order)-[ord:ORDERS]->(p:Product)
WHERE toFloat(ord.discount) > 0.05
RETURN p.productName AS ProductName, ord.discount AS Discount
ORDER BY ord.discount DESC
LIMIT 3","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
$d > 0.05;
sort $d desc;
limit 3;
fetch {
  ""ProductName"": $p.product_name,
  ""Discount"": $d
};"
506,List the top 5 customers who have ordered the most expensive products (by unit price).,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, p.unitPrice AS price
ORDER BY price DESC
LIMIT 5
RETURN c.companyName AS customer, price","match
$c isa customer;
$o isa order;
$p isa product, has unit_price $price;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
sort $price desc;
limit 5;
fetch {
  ""customer"": $c.company_name,
  ""price"": $price
};"
507,Which 3 suppliers have the highest average unit price across their products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, avg(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN s.companyName AS Supplier, avgUnitPrice AS AverageUnitPrice","match
$s isa supplier;
$p isa product, has unit_price $up;
supplies (supplier: $s, product: $p);
reduce $avg = mean($up) groupby $s;
sort $avg desc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""AverageUnitPrice"": $avg
};"
508,List the top 5 products with a unit price between $10 and $50.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 50
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$p isa product, has unit_price $up;
$up >= 10.0;
$up <= 50.0;
sort $up desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
509,Which 3 orders have the highest number of distinct products ordered?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, COUNT(DISTINCT p.productID) AS distinctProductCount
ORDER BY distinctProductCount DESC
LIMIT 3
RETURN o.orderID, distinctProductCount","match
$o isa order;
$p isa product;
orders (order: $o, product: $p);
select $o, $p;
distinct;
reduce $count = count($p) groupby $o;
sort $count desc;
limit 3;
fetch {
  ""order_id"": $o.order_id,
  ""distinct_product_count"": $count
};"
510,What are the top 5 discontinued products by units in stock?,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product, has discontinued true, has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
511,List the first 3 suppliers who have supplied products with a unit price over $100.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 100
RETURN s.companyName
LIMIT 3","match
$s isa supplier;
$p isa product, has unit_price $up;
$up > 100.0;
supplies (supplier: $s, product: $p);
limit 3;
fetch { ""companyName"": $s.company_name };"
512,Which 3 products have been ordered in the highest quantities?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""totalQuantity"": $total
};"
513,List the top 5 suppliers with products in more than three categories.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 3
RETURN s.companyName AS Supplier, categoryCount
ORDER BY categoryCount DESC
LIMIT 5","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $count = count($c) groupby $s;
match $count > 3;
sort $count desc;
limit 5;
fetch { ""Supplier"": $s.company_name, ""categoryCount"": $count };"
514,Which 3 categories contain the most products with a unit price over $50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN category, productCount","match
$p isa product, has unit_price $price;
$price > 50.0;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""category"": $name, ""productCount"": $count };"
516,List the first 3 products from suppliers in 'Germany'.,"MATCH (s:Supplier {country: 'Germany'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName, s.companyName AS supplierName
LIMIT 3","match
$s isa supplier, has country ""Germany"";
$p isa product;
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $s.company_name
};"
517,What are the top 5 most frequently ordered products to 'Berlin'?,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName, COUNT(*) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $count = count groupby $p;
sort $count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $count };"
518,List the top 5 products by quantity per unit ordered in '1996'.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate STARTS WITH '1996'
RETURN p.productName, SUM(r.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$o isa order, has order_date $od;
$od like ""1996.*"";
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 5;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
519,What are the top 5 products with the most units on order in the 'Condiments' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
$p has units_on_order $u;
sort $u desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
521,What are the top 5 products with the highest reorder levels in the 'Meat/Poultry' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5","match
$p isa product, has product_name $name, has reorder_level $level;
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
sort $level desc;
limit 5;
fetch {
  ""productName"": $name,
  ""reorderLevel"": $level
};"
523,Which 3 products are most frequently ordered in the 'Confections' category?,"MATCH (c:Category {categoryName: 'Confections'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($o) groupby $p;
sort $order_count desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
524,List the top 5 orders with the most products ordered in a single order.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o.orderID AS orderID, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN orderID, productCount","match
$o isa order;
$rel isa orders (order: $o, product: $p);
reduce $productCount = count($p) groupby $o;
sort $productCount desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""productCount"": $productCount
};"
525,Which 3 categories have the most products with a unit price over $100?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 100
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN category, productCount","match
$p isa product, has unit_price $price;
$price > 100;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $count
};"
526,What are the top 5 most frequently ordered products in the 'Grains/Cereals' category?,"MATCH (c:Category {categoryName: 'Grains/Cereals'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
WITH p, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN p.productName AS productName, orderCount","match
$c isa category, has category_name ""Grains/Cereals"";
$p isa product;
part_of (product: $p, category: $c);
$o isa order;
orders (order: $o, product: $p);
reduce $order_count = count($o) groupby $p;
sort $order_count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $order_count };"
527,List the first 3 products with a unit price less than $5.,"MATCH (p:Product)
WHERE p.unitPrice < 5
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match
$p isa product, has unit_price $up;
$up < 5;
sort $up asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
528,Which 3 suppliers have the highest average units in stock per product?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, avg(p.unitsInStock) AS avgUnitsInStock
ORDER BY avgUnitsInStock DESC
LIMIT 3
RETURN s.companyName AS Supplier, avgUnitsInStock","match
$s isa supplier;
$p isa product, has units_in_stock $u;
supplies (supplier: $s, product: $p);
reduce $avg = mean($u) groupby $s;
sort $avg desc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""avgUnitsInStock"": $avg
};"
529,What are the top 5 products that have been reordered the least times?,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder ASC
LIMIT 5","match
$p isa product, has product_name $name, has units_on_order $units;
sort $units asc;
limit 5;
fetch {
  ""productName"": $name,
  ""unitsOnOrder"": $units
};"
530,Which 3 customers have ordered the most products in the 'Seafood' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Seafood'})
WITH c, SUM(o.quantity) AS totalProductsOrdered
ORDER BY totalProductsOrdered DESC
LIMIT 3
RETURN c.companyName, totalProductsOrdered","match
$c isa customer;
$o isa order;
$p isa product;
$cat isa category, has category_name ""Seafood"";
purchased (customer: $c, order: $o);
$ord isa orders (order: $o, product: $p), has quantity $q;
part_of (product: $p, category: $cat);
reduce $total = sum($q) groupby $c;
sort $total desc;
limit 3;
fetch {
  ""companyName"": $c.company_name,
  ""totalProductsOrdered"": $total
};"
531,List the top 5 products with the highest units on order in the 'Produce' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product, has product_name $name, has units_on_order $units;
$c isa category, has category_name ""Produce"";
part_of (product: $p, category: $c);
sort $units desc;
limit 5;
fetch {
  ""productName"": $name,
  ""unitsOnOrder"": $units
};"
532,What are the top 5 most frequently ordered products in the 'Dairy Products' category?,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
  $c isa category, has category_name ""Dairy Products"";
  part_of (product: $p, category: $c);
  orders (product: $p, order: $o);
reduce $order_count = count($o) groupby $p;
sort $order_count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $order_count
};"
533,List the first 3 orders that included both 'Beverages' and 'Condiments' products.,"MATCH (o:Order)-[:ORDERS]->(p1:Product)-[:PART_OF]->(c1:Category {categoryName: 'Beverages'}),
      (o)-[:ORDERS]->(p2:Product)-[:PART_OF]->(c2:Category {categoryName: 'Condiments'})
RETURN DISTINCT o.orderID, o.orderDate, o.shipName, o.shipCity, o.shipCountry
LIMIT 3","match
$o isa order;
$p1 isa product;
$p2 isa product;
$c1 isa category, has category_name ""Beverages"";
$c2 isa category, has category_name ""Condiments"";
orders (order: $o, product: $p1);
orders (order: $o, product: $p2);
part_of (product: $p1, category: $c1);
part_of (product: $p2, category: $c2);
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
534,Which 3 suppliers have provided products to the most distinct categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, COUNT(DISTINCT c.categoryID) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3
RETURN s.companyName, categoryCount","match
$s isa supplier, has company_name $name;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c, $name;
distinct;
reduce $count = count($c) groupby $s, $name;
sort $count desc;
limit 3;
fetch { ""companyName"": $name, ""categoryCount"": $count };"
535,What are the top 5 most frequently ordered products by customers from 'USA'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'USA'
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has country ""USA"";
$o isa order;
$p isa product, has product_name $name;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $count = count($o) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""productName"": $name, ""orderCount"": $count };"
536,List the top 5 categories with the most products on order.,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.unitsOnOrder > 0
RETURN c.categoryName, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5","match
$c isa category;
$p isa product, has units_on_order $uo;
$uo > 0;
part_of (category: $c, product: $p);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $count
};"
537,Which 3 products have the lowest reorder levels but are not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = false
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel ASC
LIMIT 3","match
$p isa product, has discontinued false, has reorder_level $rl;
sort $rl asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
538,List the top 5 orders with the latest required dates.,"MATCH (o:Order)
RETURN o.orderID, o.requiredDate
ORDER BY o.requiredDate DESC
LIMIT 5","match
$o isa order, has required_date $rd;
sort $rd desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""requiredDate"": $rd
};"
539,Which 3 suppliers have the most orders for their products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN s.companyName AS Supplier, orderCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
$o isa order;
orders (order: $o, product: $p);
reduce $order_count = count($o) groupby $s;
sort $order_count desc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""orderCount"": $order_count
};"
540,What are the top 5 most frequently ordered products in the 'Beverages' category?,"MATCH (c:Category {categoryName: 'Beverages'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($rel) groupby $p;
sort $order_count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $order_count };"
541,Which 3 customers have ordered the most distinct products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, COUNT(DISTINCT p.productID) AS distinctProducts
ORDER BY distinctProducts DESC
LIMIT 3
RETURN c.companyName AS customerName, distinctProducts","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $c, $p;
distinct;
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""distinctProducts"": $count
};"
542,Show all customers who have ordered the 'Aniseed Syrup' product.,"MATCH (p:Product {productName: 'Aniseed Syrup'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName AS customerName, c.contactName AS contactName, c.contactTitle AS contactTitle, c.phone AS phone, c.address AS address, c.city AS city, c.postalCode AS postalCode, c.country AS country","match
$p isa product, has product_name ""Aniseed Syrup"";
orders (product: $p, order: $o);
purchased (customer: $c, order: $o);
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""phone"": $c.phone,
  ""address"": $c.address,
  ""city"": $c.city,
  ""postalCode"": $c.postal_code,
  ""country"": $c.country
};"
543,How many products are there in each category?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
RETURN c.categoryName AS category, COUNT(p) AS productCount
ORDER BY category","match
$p isa product;
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c, $name;
sort $name;
fetch { ""category"": $name, ""productCount"": $count };"
544,List the top 5 most expensive products based on unitPrice.,"MATCH (p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$p isa product, has unit_price $up;
sort $up desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
545,Find the top 5 orders placed by customers from the 'UK'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.country = 'UK'
WITH o, c
MATCH (o)-[:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, c.companyName AS customerName, SUM(toFloat(o.freight)) AS totalFreight
ORDER BY totalFreight DESC
LIMIT 5","match
$c isa customer, has country ""UK"";
$o isa order, has order_id $oid, has freight $f;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
sort $f desc;
limit 5;
fetch {
  ""orderID"": $oid,
  ""customerName"": $c.company_name,
  ""freight"": $f
};"
546,Which 3 suppliers have the most diverse range of product categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, collect(DISTINCT c.categoryID) AS categories
RETURN s.companyName, size(categories) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3","match
$s isa supplier, has company_name $name;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c, $name;
distinct;
reduce $count = count groupby $s, $name;
sort $count desc;
limit 3;
fetch { ""companyName"": $name, ""categoryCount"": $count };"
547,List the first 5 categories that do not have any discontinued products.,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.discontinued = false
WITH c, COUNT(p) AS productCount
WHERE productCount > 0
RETURN DISTINCT c.categoryName
LIMIT 5","match
$c isa category;
part_of (product: $p, category: $c);
not {
  part_of (product: $p2, category: $c);
  $p2 has discontinued true;
};
limit 5;
fetch { ""categoryName"": $c.category_name };"
548,Which 3 products have a 'quantityPerUnit' specification involving 'bags'?,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bags'
RETURN p.productName, p.quantityPerUnit
LIMIT 3","match
$p isa product, has quantity_per_unit $q;
$q like "".*bags.*"";
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $q
};"
549,Find the top 5 orders with the lowest freight charges.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) ASC
LIMIT 5","match
$o isa order, has order_id $oid, has freight $f;
sort $f asc;
limit 5;
fetch {
  ""orderID"": $oid,
  ""freight"": $f
};"
550,Which 3 customers have ordered the least number of products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN c.companyName AS customerName, productCount","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $product_count = count($p) groupby $c;
sort $product_count asc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""productCount"": $product_count
};"
551,List the first 5 products that have been ordered with a quantity greater than 50.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE r.quantity > 50
RETURN p.productName AS productName, r.quantity AS quantity
ORDER BY r.quantity DESC
LIMIT 5","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p), has quantity $q;
$q > 50;
sort $q desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""quantity"": $q
};"
552,Which 3 suppliers are located in 'NULL' region?,"MATCH (s:Supplier)
WHERE s.region = 'NULL'
RETURN s.companyName
LIMIT 3","match
$s isa supplier, has region ""NULL"";
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
553,Find the top 5 orders that were shipped via 'shipVia' 2.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '2'
RETURN o.orderID, o.shipName, o.shipCity, o.shipCountry, o.shipPostalCode, o.shipAddress, o.shipRegion, o.shippedDate, o.freight
ORDER BY o.shippedDate DESC
LIMIT 5","match
$o isa order, has ship_via ""2"";
orders (order: $o, product: $p);
$o has shipped_date $sd;
sort $sd desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipRegion"": $o.ship_region,
  ""shippedDate"": $sd,
  ""freight"": $o.freight
};"
554,Which 3 customers have their phone numbers starting with '030'?,"MATCH (c:Customer)
WHERE c.phone STARTS WITH '030'
RETURN c.companyName, c.phone
LIMIT 3","match $c isa customer, has phone $p;
$p like ""030.*"";
limit 3;
fetch { ""companyName"": $c.company_name, ""phone"": $p };"
555,List the first 5 products that have a 'unitPrice' between $10 and $20.,"MATCH (p:Product)
WHERE p.unitPrice >= 10 AND p.unitPrice <= 20
RETURN p.productName, p.unitPrice
ORDER BY p.productName
LIMIT 5","match
$p isa product, has unit_price $price, has product_name $name;
$price >= 10.0;
$price <= 20.0;
sort $name;
limit 5;
fetch {
  ""productName"": $name,
  ""unitPrice"": $price
};"
556,Which 3 orders were shipped to the same city as the customer's address?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c.city AS customerCity, o
MATCH (o2:Order {shipCity: customerCity})
RETURN o2.orderID, o2.shipCity
LIMIT 3","match
$c isa customer, has city $city;
$o isa order, has ship_city $ship_city;
purchased (customer: $c, order: $o);
$city == $ship_city;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipCity"": $o.ship_city
};"
557,Find the top 5 categories with the most expensive products on average.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, avg(p.unitPrice) AS avgPrice
ORDER BY avgPrice DESC
LIMIT 5
RETURN category, avgPrice","match
$p isa product, has unit_price $price;
$c isa category, has category_name $cat_name;
part_of (product: $p, category: $c);
reduce $avg_price = mean($price) groupby $c, $cat_name;
sort $avg_price desc;
limit 5;
fetch {
  ""category"": $cat_name,
  ""avgPrice"": $avg_price
};"
558,Which 3 suppliers have the least number of products listed?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN s.companyName AS Supplier, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count asc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""productCount"": $count
};"
559,List the first 5 products that have been ordered in the year 1998.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.orderDate STARTS WITH '1998'
RETURN p.productName AS productName, o.orderDate AS orderDate
ORDER BY o.orderDate
LIMIT 5","match
$o isa order, has order_date $od;
$p isa product, has product_name $pn;
orders (order: $o, product: $p);
$od like ""1998.*"";
sort $od;
limit 5;
fetch {
  ""productName"": $pn,
  ""orderDate"": $od
};"
560,Which 3 orders have the highest number of units ordered per product?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, p.productName AS productName, r.quantity AS quantity
ORDER BY r.quantity DESC
LIMIT 3","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p), has quantity $q;
sort $q desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""productName"": $p.product_name,
  ""quantity"": $q
};"
561,Find the top 5 customers who have ordered the product with the highest unit price.,"// Step 1: Find the product with the highest unit price
MATCH (p:Product)
WITH p
ORDER BY p.unitPrice DESC
LIMIT 1

// Step 2: Find the orders for this product
MATCH (p)<-[:ORDERS]-(o:Order)

// Step 3: Find the customers who placed these orders
MATCH (c:Customer)-[:PURCHASED]->(o)

// Step 4: Count the number of orders per customer and get the top 5 customers
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5

// Step 5: Return the top 5 customers
RETURN c.companyName AS customerName, orderCount","match
$p1 isa product, has unit_price $up1;
reduce $max_price = max($up1);
match
$p isa product, has unit_price $up;
$up == $max_price;
orders (product: $p, order: $o);
purchased (customer: $c, order: $o);
$c has company_name $cn;
reduce $order_count = count($o) groupby $c, $cn;
sort $order_count desc;
limit 5;
fetch { ""customerName"": $cn, ""orderCount"": $order_count };"
562,Which 3 products have the lowest reorder level?,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel ASC
LIMIT 3","match
$p isa product, has reorder_level $rl;
sort $rl asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
563,List the first 5 products that have been ordered by customers in 'Berlin'.,"MATCH (c:Customer {city: 'Berlin'})-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
RETURN p.productName
LIMIT 5","match
$c isa customer, has city ""Berlin"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
limit 5;
fetch { ""productName"": $p.product_name };"
564,Which 3 products are most frequently reordered (reorder level at maximum)?,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 3","match
$p isa product, has product_name $name, has reorder_level $rl;
sort $rl desc;
limit 3;
fetch {
  ""productName"": $name,
  ""reorderLevel"": $rl
};"
565,List the first 5 suppliers whose products have never been out of stock.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock > 0
WITH s, COUNT(p) AS totalProducts, SUM(CASE WHEN p.unitsInStock > 0 THEN 1 ELSE 0 END) AS inStockProducts
WHERE totalProducts = inStockProducts
RETURN s.companyName
LIMIT 5","match
$s isa supplier;
supplies (supplier: $s, product: $p);
not {
  supplies (supplier: $s, product: $p2);
  $p2 has units_in_stock $stock;
  $stock <= 0;
};
limit 5;
fetch {
  ""companyName"": $s.company_name
};"
566,Which 3 customers have ordered products with the highest average unit price?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, avg(toFloat(p.unitPrice)) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN c.companyName AS customerName, avgUnitPrice","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$p has unit_price $up;
reduce $avg_price = mean($up) groupby $c;
sort $avg_price desc;
limit 3;
fetch { ""customerName"": $c.company_name, ""avgUnitPrice"": $avg_price };"
567,Find the top 5 products with the most orders during the last quarter of 1997.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate >= '1997-10-01' AND o.orderDate <= '1997-12-31'
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$o isa order, has order_date $od;
$od >= ""1997-10-01""; $od <= ""1997-12-31"";
$p isa product;
$rel isa orders (order: $o, product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $count
};"
568,Find the top 5 orders with the most different products included.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, COUNT(DISTINCT p.productID) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN o.orderID AS orderID, productCount","match
$o isa order;
$p isa product;
orders (order: $o, product: $p);
select $p, $o;
distinct;
reduce $productCount = count($p) groupby $o;
sort $productCount desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""productCount"": $productCount
};"
569,Which 3 suppliers have the most orders for their products?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN s.companyName AS Supplier, orderCount","match
$s isa supplier;
$p isa product;
$o isa order;
supplies (supplier: $s, product: $p);
orders (order: $o, product: $p);
reduce $order_count = count($o) groupby $s;
sort $order_count desc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""orderCount"": $order_count
};"
570,List the first 5 orders that included a product from the 'Seafood' category.,"MATCH (c:Category {categoryName: 'Seafood'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN o.orderID, o.orderDate, o.shipName, o.shipCity, o.shipCountry
ORDER BY o.orderDate
LIMIT 5","match
$c isa category, has category_name ""Seafood"";
part_of (category: $c, product: $p);
orders (product: $p, order: $o);
$o has order_date $od;
sort $od;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
571,Find the top 5 customers who have ordered the same product multiple times.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, p, COUNT(o) AS orderCount
WHERE orderCount > 1
RETURN c.companyName AS customer, COUNT(DISTINCT p.productID) AS productCount
ORDER BY productCount DESC
LIMIT 5","match
$c isa customer;
$o isa order;
$p isa product;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $order_count = count($o) groupby $c, $p;
match $order_count > 1;
reduce $product_count = count($p) groupby $c;
sort $product_count desc;
limit 5;
fetch { ""customer"": $c.company_name, ""productCount"": $product_count };"
572,Which 3 products have never been ordered?,"MATCH (p:Product)
WHERE NOT (p)<-[:ORDERS]-(:Order)
RETURN p.productName
LIMIT 3","match
$p isa product;
not { orders (product: $p); };
limit 3;
fetch { ""productName"": $p.product_name };"
573,List the first 5 suppliers with a 'homePage' listed.,"MATCH (s:Supplier)
WHERE s.homePage IS NOT NULL AND s.homePage <> 'NULL'
RETURN s.companyName, s.homePage
LIMIT 5","match
$s isa supplier, has home_page $hp, has company_name $cn;
not { $hp == ""NULL""; };
limit 5;
fetch {
  ""companyName"": $cn,
  ""homePage"": $hp
};"
574,Which 3 categories have the most suppliers?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(DISTINCT s.supplierID) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3
RETURN category, supplierCount","match
$s isa supplier, has supplier_id $sid;
$p isa product;
$c isa category, has category_name $cat_name;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $sid, $c;
distinct;
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch { ""category"": $c.category_name, ""supplierCount"": $count };"
575,Which 3 suppliers have the most products in the 'Grains/Cereals' category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Grains/Cereals"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
576,Which 3 suppliers provide products to the most number of unique cities?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, o.shipCity AS city
WHERE city IS NOT NULL
WITH s, collect(DISTINCT city) AS uniqueCities
RETURN s.companyName AS supplier, size(uniqueCities) AS cityCount
ORDER BY cityCount DESC
LIMIT 3","match
$s isa supplier, has company_name $cn;
supplies (supplier: $s, product: $p);
orders (product: $p, order: $o);
$o has ship_city $city;
select $s, $cn, $city;
distinct;
reduce $city_count = count groupby $s, $cn;
sort $city_count desc;
limit 3;
fetch { ""supplier"": $cn, ""cityCount"": $city_count };"
577,Which 3 products have the lowest 'unitPrice' in the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
$p has unit_price $price;
sort $price asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
578,Find the top 5 customers with the most orders for the 'Dairy Products' category.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Dairy Products'})
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
$o isa order;
$p isa product;
$cat isa category, has category_name ""Dairy Products"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 5;
fetch { ""customerName"": $c.company_name, ""orderCount"": $order_count };"
579,Which 3 suppliers have the most products with a 'unitsOnOrder' above 10?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsOnOrder > 10
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product, has units_on_order $uoo;
$uoo > 10;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $count
};"
580,List the first 5 categories where the average 'unitPrice' of products is above $30.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c, avg(p.unitPrice) AS avgPrice
WHERE avgPrice > 30
RETURN c.categoryName, avgPrice
ORDER BY avgPrice DESC
LIMIT 5","match
$p isa product, has unit_price $up;
$c isa category;
part_of (product: $p, category: $c);
reduce $avgPrice = mean($up) groupby $c;
match $avgPrice > 30;
sort $avgPrice desc;
limit 5;
fetch {
  ""categoryName"": $c.category_name,
  ""avgPrice"": $avgPrice
};"
581,Which 3 orders had the highest discount applied?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, toFloat(r.discount) AS discount
ORDER BY discount DESC
LIMIT 3
RETURN o.orderID AS orderID, discount","match
$o isa order;
$rel isa orders (order: $o, product: $p);
$rel has discount $discount;
sort $discount desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""discount"": $discount
};"
582,Find the top 5 products that have been supplied by more than one supplier.,"MATCH (s1:Supplier)-[:SUPPLIES]->(p:Product)<-[:SUPPLIES]-(s2:Supplier)
WHERE s1.supplierID <> s2.supplierID
WITH p, COUNT(DISTINCT s1) AS supplierCount
WHERE supplierCount > 1
RETURN p.productName, supplierCount
ORDER BY supplierCount DESC, p.productName
LIMIT 5","match
$p isa product, has product_name $name;
$s isa supplier;
supplies (supplier: $s, product: $p);
select $p, $s, $name;
distinct;
reduce $count = count($s) groupby $p, $name;
match $count > 1;
sort $count desc, $name asc;
limit 5;
fetch { ""product_name"": $name, ""supplier_count"": $count };"
583,Which 3 customers have a 'fax' number listed?,"MATCH (c:Customer)
WHERE c.fax IS NOT NULL
RETURN c.companyName, c.fax
LIMIT 3","match
$c isa customer, has fax $f, has company_name $cn;
limit 3;
fetch {
  ""companyName"": $cn,
  ""fax"": $f
};"
584,List the first 5 products that have a 'unitsInStock' of exactly 50.,"MATCH (p:Product)
WHERE p.unitsInStock = 50
RETURN p.productName, p.productID, p.unitsInStock
LIMIT 5","match
$p isa product, has units_in_stock 50;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitsInStock"": $p.units_in_stock
};"
585,Which 3 categories have the fewest products with units on order?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 0
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN category, productCount","match
$p isa product, has units_on_order $u;
$u > 0;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count asc;
limit 3;
fetch { ""category"": $c.category_name, ""productCount"": $count };"
586,List the first 5 orders that included products from at least three different categories.,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WITH o, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount >= 3
RETURN o.orderID, o.orderDate, o.shipName, o.shipCity, o.shipCountry
ORDER BY o.orderDate
LIMIT 5","match
$o isa order;
orders (order: $o, product: $p);
part_of (product: $p, category: $c);
$c has category_id $cid;
select $o, $c;
distinct;
reduce $cat_count = count groupby $o;
match $cat_count >= 3;
$o has order_date $od;
sort $od;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
587,Find the top 5 orders that were required in the year 1997.,"MATCH (o:Order)
WHERE o.requiredDate STARTS WITH '1997'
RETURN o.orderID, o.requiredDate
ORDER BY o.requiredDate
LIMIT 5","match
$o isa order, has order_id $oid, has required_date $rd;
$rd like ""1997.*"";
sort $rd;
limit 5;
fetch {
  ""orderID"": $oid,
  ""requiredDate"": $rd
};"
588,Which 3 customers have ordered products from the most categories?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH c, collect(DISTINCT cat.categoryID) AS categories
RETURN c.customerID, c.companyName, size(categories) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3","match
$c isa customer;
$o isa order;
$cat isa category;
$p isa product;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
select $c, $cat;
distinct;
reduce $category_count = count groupby $c;
sort $category_count desc;
limit 3;
fetch {
  ""customer_id"": $c.customer_id,
  ""company_name"": $c.company_name,
  ""category_count"": $category_count
};"
589,List the first 5 products that are part of the 'Meat/Poultry' category and have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Meat/Poultry' AND p.discontinued = true
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock
LIMIT 5","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock
};"
590,Which 3 suppliers supply the most products with a unit price over $20?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 20
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product, has unit_price $up;
$up > 20;
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
591,Find the top 5 products that are part of the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN p.productName, p.unitPrice, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product, has product_name $name, has unit_price $price, has units_in_stock $stock;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
sort $stock desc;
limit 5;
fetch {
  ""productName"": $name,
  ""unitPrice"": $price,
  ""unitsInStock"": $stock
};"
592,Which 3 orders had a required date in 1996?,"MATCH (o:Order)
WHERE o.requiredDate STARTS WITH '1996'
RETURN o.orderID, o.requiredDate
LIMIT 3","match
$o isa order, has required_date $rd;
$rd like ""1996%"";
limit 3;
fetch {
  ""order_id"": $o.order_id,
  ""required_date"": $rd
};"
593,List the first 5 customers who have ordered more than once.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
WHERE orderCount > 1
RETURN c.customerID, c.companyName, orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
match $order_count > 1;
sort $order_count desc;
limit 5;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""orderCount"": $order_count
};"
594,Which 3 suppliers are located in the UK?,"MATCH (s:Supplier {country: ""UK""})
RETURN s.companyName
LIMIT 3","match
$s isa supplier, has country ""UK"";
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
595,Find the top 5 products with the least quantity per unit in stock.,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock ASC
LIMIT 5","match
$p isa product;
$p has units_in_stock $stock;
sort $stock;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
596,Which 3 categories contain products with a unit price over $50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice > 50
RETURN c.categoryName, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3","match
$p isa product, has unit_price $price;
$price > 50.0;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $count
};"
597,List the first 5 orders with the highest freight charges.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 5","match
$o isa order, has order_id $oid, has freight $f;
sort $f desc;
limit 5;
fetch {
  ""orderID"": $oid,
  ""freight"": $f
};"
598,Which 3 products have the lowest units on order and are not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = false
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder ASC
LIMIT 3","match
$p isa product, has discontinued false, has units_on_order $u;
sort $u asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
599,List the first 5 products with reorder levels set at 30.,"MATCH (p:Product)
WHERE p.reorderLevel = 30
RETURN p.productName, p.reorderLevel
LIMIT 5","match
$p isa product, has reorder_level 30;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $p.reorder_level
};"
600,Find the top 5 suppliers with the most products in the 'Dairy Products' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Dairy Products"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 5;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
601,List the first 5 categories that have products supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
RETURN DISTINCT c.categoryName
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$c has category_name $name;
select $name;
distinct;
limit 5;
fetch { ""categoryName"": $name };"
602,Which 3 products have been ordered the most times?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$p isa product;
$rel isa orders (product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""orderCount"": $count
};"
603,What are the top 5 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
604,List the first 3 orders shipped to France.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry, o.shippedDate
ORDER BY o.shippedDate
LIMIT 3","match
$o isa order, has ship_country ""France"", has shipped_date $sd;
sort $sd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shippedDate"": $sd
};"
605,Which 3 products have the highest units in stock?,"MATCH (p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$p isa product, has units_in_stock $stock;
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
606,Find the top 5 customers based in Germany.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.country = 'Germany'
RETURN c.companyName AS customerName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has country ""Germany"";
purchased (customer: $c, order: $o);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $count
};"
607,Which 3 suppliers provide products in the 'Beverages' category?,"MATCH (c:Category {categoryName: 'Beverages'})<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN DISTINCT s.companyName
LIMIT 3","match
$c isa category, has category_name ""Beverages"";
$p isa product;
part_of (product: $p, category: $c);
$s isa supplier;
supplies (supplier: $s, product: $p);
select $s;
distinct;
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
608,List the top 5 products that have been discontinued.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.productID
ORDER BY p.productName
LIMIT 5","match
$p isa product, has discontinued true, has product_name $name;
sort $name;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
609,What are the first 3 products with a reorder level above 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel
ORDER BY p.productName
LIMIT 3","match $p isa product, has reorder_level $r;
$r > 20;
$p has product_name $n;
sort $n;
limit 3;
fetch { ""productName"": $n, ""reorderLevel"": $r };"
610,Which 3 customers have purchased the most orders?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
611,Which 3 suppliers have the largest coverage in terms of countries?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(DISTINCT s.country) AS countryCount
RETURN s.companyName AS supplier, countryCount
ORDER BY countryCount DESC
LIMIT 3","match
$s isa supplier, has company_name $name, has country $c;
$p isa product;
supplies (supplier: $s, product: $p);
select $s, $name, $c;
distinct;
reduce $count = count groupby $s, $name;
sort $count desc;
limit 3;
fetch { ""supplier"": $name, ""countryCount"": $count };"
612,Which 3 customers have the most unique products ordered?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, COUNT(DISTINCT p.productID) AS uniqueProductsOrdered
ORDER BY uniqueProductsOrdered DESC
LIMIT 3
RETURN c.companyName AS customerName, uniqueProductsOrdered","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$p has product_id $pid;
select $c, $pid;
distinct;
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch { ""customerName"": $c.company_name, ""uniqueProductsOrdered"": $count };"
613,Which 3 products have the most quantity per unit?,"MATCH (p:Product)
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3","match
$p isa product, has quantity_per_unit $q;
sort $q desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $q
};"
614,Which 3 orders include the most number of products?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN o.orderID, productCount","match
$o isa order;
$rel isa orders (order: $o, product: $p);
reduce $productCount = count($p) groupby $o;
sort $productCount desc;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""productCount"": $productCount
};"
615,Find the top 5 customers from the 'USA'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.country = 'USA'
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN c.companyName AS customerName, orderCount","match
$c isa customer, has country ""USA"";
purchased (customer: $c, order: $o);
reduce $orderCount = count($o) groupby $c;
sort $orderCount desc;
limit 5;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $orderCount
};"
616,Which 3 categories have the most products with units in stock over 50?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsInStock > 50
RETURN c.categoryName, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3","match
$p isa product, has units_in_stock $stock;
$stock > 50;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $count
};"
617,List the first 5 products that have a unit price less than the average unit price of all products.,"// Step 1: Calculate the average unit price of all products
MATCH (p:Product)
WITH avg(p.unitPrice) AS avgUnitPrice

// Step 2: Find products with a unit price less than the average unit price
MATCH (p:Product)
WHERE p.unitPrice < avgUnitPrice

// Step 3: Return the first 5 products that meet the criteria
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice
LIMIT 5","with fun avg_unit_price() -> double:
  match $p isa product, has unit_price $up;
  return mean($up);
match
  $p isa product, has unit_price $up, has product_name $pn;
  let $avg = avg_unit_price();
  $up < $avg;
sort $up;
limit 5;
fetch { ""productName"": $pn, ""unitPrice"": $up };"
618,Which 3 suppliers supply products with a unit price less than $10?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice < 10
RETURN s.companyName
LIMIT 3","match
$s isa supplier;
$p isa product, has unit_price $up;
$up < 10;
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
619,Which 3 products have the most discounts applied in orders?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WITH p.productName AS productName, SUM(toFloat(o.discount)) AS totalDiscount
ORDER BY totalDiscount DESC
LIMIT 3
RETURN productName, totalDiscount","match
$p isa product;
$rel isa orders (product: $p);
$rel has discount $d;
reduce $totalDiscount = sum($d) groupby $p;
sort $totalDiscount desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""totalDiscount"": $totalDiscount
};"
620,List the first 5 suppliers that have provided products to more than three different customers.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
WITH s, COUNT(DISTINCT c) AS customerCount
WHERE customerCount > 3
RETURN s.companyName
ORDER BY s.companyName
LIMIT 5","match
$s isa supplier, has company_name $cn;
supplies (supplier: $s, product: $p);
orders (product: $p, order: $o);
purchased (customer: $c, order: $o);
select $s, $cn, $c;
distinct;
reduce $customer_count = count($c) groupby $s, $cn;
match $customer_count > 3;
sort $cn;
limit 5;
fetch { ""companyName"": $cn };"
621,Which 3 categories are most frequently associated with discontinued products?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.discontinued = true
RETURN c.categoryName, COUNT(p) AS discontinuedProductCount
ORDER BY discontinuedProductCount DESC
LIMIT 3","match
$p isa product, has discontinued true;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $c.category_name,
  ""discontinuedProductCount"": $count
};"
622,Find the top 5 orders with the most units ordered.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, SUM(r.quantity) AS totalUnitsOrdered
ORDER BY totalUnitsOrdered DESC
LIMIT 5","match
$o isa order;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $o;
sort $total desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""totalUnitsOrdered"": $total
};"
623,Find the top 5 customers who have ordered the product 'Chai'.,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product, has product_name ""Chai"";
$o isa order;
$c isa customer;
orders (order: $o, product: $p);
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 5;
fetch { ""companyName"": $c.company_name, ""orderCount"": $order_count };"
624,List the first 5 suppliers based in 'London'.,"MATCH (s:Supplier {city: 'London'})
RETURN s.companyName
LIMIT 5","match
$s isa supplier, has city ""London"";
limit 5;
fetch {
  ""companyName"": $s.company_name
};"
625,Which 3 categories have the least number of products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN category, productCount","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$c has category_name $category;
reduce $productCount = count($p) groupby $c, $category;
sort $productCount asc;
limit 3;
fetch {
  ""category"": $category,
  ""productCount"": $productCount
};"
626,Find the top 5 products ordered during the month of July 1996.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.orderDate >= '1996-07-01' AND o.orderDate < '1996-08-01'
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$o isa order, has order_date $d;
$d >= ""1996-07-01""; $d < ""1996-08-01"";
$rel isa orders (order: $o, product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 5;
fetch { ""product_name"": $p.product_name, ""order_count"": $count };"
627,Which 3 customers have a contact title of 'Sales Representative'?,"MATCH (c:Customer)
WHERE c.contactTitle = 'Sales Representative'
RETURN c.companyName, c.contactName, c.contactTitle
LIMIT 3","match
$c isa customer, has contact_title ""Sales Representative"";
limit 3;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title
};"
628,List the first 5 orders shipped by 'shipVia' 1.,"MATCH (o:Order)
WHERE o.shipVia = '1'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipCountry, o.shipAddress, o.shipRegion, o.shippedDate
ORDER BY o.shippedDate
LIMIT 5","match
$o isa order, has ship_via ""1"";
$o has order_id $oid;
$o has ship_name $sn;
$o has ship_city $sc;
$o has ship_postal_code $spc;
$o has ship_country $sco;
$o has ship_address $sa;
$o has ship_region $sr;
$o has shipped_date $sd;
sort $sd;
limit 5;
fetch {
  ""orderID"": $oid,
  ""shipName"": $sn,
  ""shipCity"": $sc,
  ""shipPostalCode"": $spc,
  ""shipCountry"": $sco,
  ""shipAddress"": $sa,
  ""shipRegion"": $sr,
  ""shippedDate"": $sd
};"
629,Find the top 5 customers who have ordered products where the discount was not applied.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WHERE r.discount = ""0""
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5
RETURN c.customerID, c.companyName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
$r isa orders (order: $o, product: $p);
$r has discount 0.0;
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 5;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""orderCount"": $order_count
};"
630,Which 3 suppliers do not have a fax number?,"MATCH (s:Supplier)
WHERE s.fax IS NULL
RETURN s.companyName
LIMIT 3","match
$s isa supplier;
not { $s has fax $_; };
limit 3;
fetch {
  ""companyName"": $s.company_name
};"
631,List the first 5 categories with products that have a reorder level below 10.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel < 10
RETURN DISTINCT c.categoryName
LIMIT 5","match
$p isa product, has reorder_level $rl;
$rl < 10;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
limit 5;
fetch { ""categoryName"": $cn };"
632,Which 3 products have the highest units on order?,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 3","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
633,What are the names of the products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
635,Which products are part of the 'Beverages' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName AS productName","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name
};"
636,Identify the orders that include products from the 'Seafood' category and were shipped to France.,"MATCH (c:Category {categoryName: 'Seafood'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order {shipCountry: 'France'})
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry","match
$c isa category, has category_name ""Seafood"";
$p isa product;
part_of (product: $p, category: $c);
$o isa order, has ship_country ""France"";
orders (order: $o, product: $p);
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country
};"
638,Who are the customers with orders that have a shipVia of '3'?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipVia = '3'
RETURN c.companyName AS customerName, c.contactName AS contactName, c.contactTitle AS contactTitle, c.phone AS phone, c.address AS address, c.city AS city, c.postalCode AS postalCode, c.country AS country","match
$c isa customer;
$o isa order, has ship_via ""3"";
purchased (customer: $c, order: $o);
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""phone"": $c.phone,
  ""address"": $c.address,
  ""city"": $c.city,
  ""postalCode"": $c.postal_code,
  ""country"": $c.country
};"
639,Find the first 5 products from the 'Condiments' category that have been ordered in 1998.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'}),
      (o:Order)-[:ORDERS]->(p)
WHERE o.orderDate STARTS WITH '1998'
RETURN p.productName, p.productID
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
$o isa order, has order_date $od;
$od like ""1998%"";
orders (order: $o, product: $p);
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
640,Which suppliers have products with a minimum unitsInStock of 50?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock >= 50
RETURN s.companyName","match
$s isa supplier;
$p isa product, has units_in_stock $stock;
$stock >= 50;
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
641,List the suppliers who are based in non-UK European countries.,"MATCH (s:Supplier)
WHERE s.country IN ['Germany', 'France', 'Italy', 'Spain', 'Netherlands', 'Belgium', 'Sweden', 'Denmark', 'Finland', 'Norway', 'Switzerland', 'Austria', 'Ireland', 'Portugal', 'Greece'] AND s.country <> 'UK'
RETURN s.companyName AS SupplierName, s.country AS Country","match
$s isa supplier, has country $c;
{ $c == ""Germany""; } or { $c == ""France""; } or { $c == ""Italy""; } or { $c == ""Spain""; } or { $c == ""Netherlands""; } or { $c == ""Belgium""; } or { $c == ""Sweden""; } or { $c == ""Denmark""; } or { $c == ""Finland""; } or { $c == ""Norway""; } or { $c == ""Switzerland""; } or { $c == ""Austria""; } or { $c == ""Ireland""; } or { $c == ""Portugal""; } or { $c == ""Greece""; };
fetch {
  ""SupplierName"": $s.company_name,
  ""Country"": $c
};"
642,Identify the products that are part of orders that were required to be shipped before '1997-01-01'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.requiredDate < '1997-01-01'
RETURN DISTINCT p.productName AS ProductName, p.productID AS ProductID","match
$o isa order, has required_date $rd;
$p isa product;
orders (order: $o, product: $p);
$rd < ""1997-01-01"";
select $p;
distinct;
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id
};"
643,Find the first 3 products with a quantity per unit specification involving 'bottles'.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'bottles'
RETURN p.productName, p.quantityPerUnit
LIMIT 3","match
$p isa product, has quantity_per_unit $q;
$q like "".*bottles.*"";
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $q
};"
644,Which customers have ordered the product 'Spegesild'?,"MATCH (p:Product {productName: 'Spegesild'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.companyName AS customerName, c.contactName AS contactName, c.customerID AS customerID","match
$p isa product, has product_name ""Spegesild"";
orders (product: $p, order: $o);
purchased (customer: $c, order: $o);
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""customerID"": $c.customer_id
};"
645,List the top 5 discontinued products with the highest unit prices.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$p isa product, has discontinued true, has unit_price $up;
sort $up desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
646,What are the order IDs for orders containing products from more than three different categories?,"MATCH (o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(c:Category)
WITH o.orderID AS orderID, COUNT(DISTINCT c.categoryID) AS categoryCount
WHERE categoryCount > 3
RETURN orderID","match
$o isa order, has order_id $oid;
$p isa product;
$c isa category, has category_id $cid;
orders (order: $o, product: $p);
part_of (product: $p, category: $c);
select $o, $oid, $c;
distinct;
reduce $count = count($c) groupby $o, $oid;
match $count > 3;
fetch { ""orderID"": $oid };"
647,Identify the categories associated with products supplied by 'Mayumi's'.,"MATCH (s:Supplier {companyName: ""Mayumi's (on the World Wide Web)#http://www.micros""})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
RETURN DISTINCT c.categoryName","match
$s isa supplier, has company_name ""Mayumi's (on the World Wide Web)#http://www.micros"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
fetch { ""categoryName"": $cn };"
648,List the first 3 products that are part of the 'Dairy Products' category and have more than 20 units on order.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.unitsOnOrder > 20
RETURN p.productName, p.unitsOnOrder
ORDER BY p.productName
LIMIT 3","match
$p isa product, has units_on_order $uo;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$uo > 20;
$p has product_name $pn;
sort $pn;
limit 3;
fetch {
  ""productName"": $pn,
  ""unitsOnOrder"": $uo
};"
649,Who are the suppliers for the 'Grains/Cereals' category?,"MATCH (c:Category {categoryName: 'Grains/Cereals'})<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName AS supplierName","match
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
supplies (supplier: $s, product: $p);
fetch {
  ""supplierName"": $s.company_name
};"
650,Which products have both more than 70 units on order and a reorder level above 15?,"MATCH (p:Product)
WHERE p.unitsOnOrder > 70 AND p.reorderLevel > 15
RETURN p.productName, p.unitsOnOrder, p.reorderLevel","match
$p isa product, has units_on_order $uo, has reorder_level $rl, has product_name $pn;
$uo > 70;
$rl > 15;
fetch {
  ""productName"": $pn,
  ""unitsOnOrder"": $uo,
  ""reorderLevel"": $rl
};"
651,List all orders with a shipVia of '2' and shipped to the 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '2' AND o.shipCountry = 'USA'
RETURN o.orderID AS orderID, o.shipName AS shipName, o.requiredDate AS requiredDate, o.shipCity AS shipCity, o.shipPostalCode AS shipPostalCode, o.shippedDate AS shippedDate, o.freight AS freight, o.orderDate AS orderDate, o.shipAddress AS shipAddress, o.customerID AS customerID, o.shipCountry AS shipCountry, o.shipVia AS shipVia","match
$o isa order, has ship_via ""2"", has ship_country ""USA"";
orders (order: $o, product: $p);
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""requiredDate"": $o.required_date,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shippedDate"": $o.shipped_date,
  ""freight"": $o.freight,
  ""orderDate"": $o.order_date,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via
};"
652,Which products are associated with categories that have a description including 'sauces'?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description CONTAINS 'sauces'
RETURN p.productName AS productName, c.categoryName AS categoryName","match
$p isa product;
$c isa category, has description $desc;
$desc like "".*sauces.*"";
part_of (product: $p, category: $c);
fetch {
  ""productName"": $p.product_name,
  ""categoryName"": $c.category_name
};"
653,Find the first 3 orders that were shipped within Germany.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'Germany'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry, o.shipRegion, o.shippedDate
ORDER BY o.shippedDate
LIMIT 3","match
$o isa order, has ship_country ""Germany"";
orders (order: $o, product: $p);
$o has shipped_date $sd;
sort $sd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipRegion"": $o.ship_region,
  ""shippedDate"": $o.shipped_date
};"
654,Identify suppliers that have a contact title of 'Purchasing Manager'.,"MATCH (s:Supplier)
WHERE s.contactTitle = 'Purchasing Manager'
RETURN s.companyName AS SupplierName, s.contactName AS ContactName, s.phone AS Phone, s.address AS Address, s.city AS City, s.country AS Country","match
$s isa supplier, has contact_title ""Purchasing Manager"";
fetch {
  ""SupplierName"": $s.company_name,
  ""ContactName"": $s.contact_name,
  ""Phone"": $s.phone,
  ""Address"": $s.address,
  ""City"": $s.city,
  ""Country"": $s.country
};"
655,Which products have been ordered with a quantity of 100 or more in a single order?,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WHERE o.quantity >= 100
RETURN p.productName AS ProductName, o.quantity AS Quantity","match
$p isa product;
$o isa order;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
$q >= 100;
fetch {
  ""ProductName"": $p.product_name,
  ""Quantity"": $q
};"
656,List the products that are in the 'Produce' category and have a discontinued status.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName = 'Produce' AND p.discontinued = true
RETURN p.productName AS ProductName, p.productID AS ProductID","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Produce"";
part_of (product: $p, category: $c);
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id
};"
657,Identify the suppliers whose products are all in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WITH s, collect(p.productID) AS suppliedProducts
MATCH (p2:Product)
WHERE p2.productID IN suppliedProducts AND NOT (p2)-[:PART_OF]->(:Category {categoryName: 'Beverages'})
WITH s, count(p2) AS nonBeverageProducts
WHERE nonBeverageProducts = 0
RETURN s.companyName AS supplierName","match
$s isa supplier, has company_name $name;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
$c has category_name ""Beverages"";
not {
    supplies (supplier: $s, product: $p2);
    part_of (product: $p2, category: $c2);
    not { $c2 has category_name ""Beverages""; };
};
fetch {
    ""supplierName"": $name
};"
658,What are the product IDs of products that have been marked as discontinued but have a reorder level of 10?,"MATCH (p:Product)
WHERE p.discontinued = true AND p.reorderLevel = 10
RETURN p.productID","match
$p isa product, has discontinued true, has reorder_level 10;
fetch {
  ""productID"": $p.product_id
};"
659,Which products have a unitsInStock value between 10 and 20?,"MATCH (p:Product)
WHERE p.unitsInStock >= 10 AND p.unitsInStock <= 20
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $u;
$u >= 10;
$u <= 20;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $u
};"
660,List the first 3 products that have been supplied by 'Plutzer'.,"MATCH (s:Supplier {companyName: 'Plutzer'})-[:SUPPLIES]->(p:Product)
RETURN p.productName
LIMIT 3","match
$s isa supplier, has company_name ""Plutzer"";
supplies (supplier: $s, product: $p);
limit 3;
fetch {
  ""productName"": $p.product_name
};"
661,What are the supplierIDs for suppliers who have provided products to more than three different cities?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s.supplierID AS supplierID, COUNT(DISTINCT o.shipCity) AS cityCount
WHERE cityCount > 3
RETURN supplierID","match
$s isa supplier, has supplier_id $sid;
supplies (supplier: $s, product: $p);
orders (product: $p, order: $o);
$o has ship_city $city;
select $s, $sid, $city;
distinct;
reduce $count = count groupby $s, $sid;
match $count > 3;
fetch { ""supplierID"": $sid };"
662,Identify the orders placed for products from the 'Meat/Poultry' category with a shipVia of '2'.,"MATCH (c:Category {categoryName: 'Meat/Poultry'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
WHERE o.shipVia = '2'
RETURN o.orderID AS orderID, o.shipName AS shipName, o.shipCity AS shipCity, o.shipCountry AS shipCountry, o.shipPostalCode AS shipPostalCode, o.shipAddress AS shipAddress, o.shipRegion AS shipRegion, o.requiredDate AS requiredDate, o.shippedDate AS shippedDate, o.freight AS freight, o.orderDate AS orderDate, o.customerID AS customerID, o.employeeID AS employeeID","match
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
orders (order: $o, product: $p);
$o has ship_via ""2"";
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipRegion"": $o.ship_region,
  ""requiredDate"": $o.required_date,
  ""shippedDate"": $o.shipped_date,
  ""freight"": $o.freight,
  ""orderDate"": $o.order_date,
  ""employeeID"": $o.employee_id
};"
663,List the products that have a unitsInStock of zero and are not discontinued.,"MATCH (p:Product)
WHERE p.unitsInStock = 0 AND p.discontinued = false
RETURN p.productName","match
$p isa product, has units_in_stock 0, has discontinued false;
fetch {
  ""productName"": $p.product_name
};"
664,Who are the suppliers for products in the 'Confections' category?,"MATCH (c:Category {categoryName: 'Confections'})<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName AS SupplierName","match
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
supplies (supplier: $s, product: $p);
fetch { ""SupplierName"": $s.company_name };"
665,Find the first 3 orders with a shipVia of '1' and a ship country of 'USA'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '1' AND o.shipCountry = 'USA'
RETURN o.orderID, o.shipName, o.shipCity, o.shipPostalCode, o.shipAddress, o.shipCountry, o.shipVia
ORDER BY o.orderDate
LIMIT 3","match
$o isa order, has ship_via ""1"", has ship_country ""USA"", has order_date $date;
orders (order: $o, product: $p);
sort $date;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $o.ship_address,
  ""shipCountry"": $o.ship_country,
  ""shipVia"": $o.ship_via
};"
666,Which products have been reordered (reorder level not 0) and are supplied by suppliers in 'Germany'?,"MATCH (p:Product)-[:SUPPLIES]-(s:Supplier)
WHERE p.reorderLevel <> 0 AND s.country = 'Germany'
RETURN p.productName AS ProductName, s.companyName AS SupplierName","match
$p isa product, has reorder_level $rl;
$s isa supplier, has country ""Germany"";
supplies (supplier: $s, product: $p);
$rl != 0;
fetch {
  ""ProductName"": $p.product_name,
  ""SupplierName"": $s.company_name
};"
667,List the top 5 orders in terms of quantity for the 'Dairy Products' category.,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)<-[:ORDERS]-(o:Order)
RETURN o.orderID AS orderID, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$ol isa orders (order: $o, product: $p), has quantity $q;
reduce $total_quantity = sum($q) groupby $o;
sort $total_quantity desc;
limit 5;
fetch { ""orderID"": $o.order_id, ""totalQuantity"": $total_quantity };"
668,Which categories have products with a unit price less than $10?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitPrice < 10
RETURN DISTINCT c.categoryName","match
$p isa product, has unit_price $up;
$up < 10.0;
$c isa category;
part_of (product: $p, category: $c);
select $c;
distinct;
fetch { ""categoryName"": $c.category_name };"
669,Identify the customers who have ordered products with a total discount of 0.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WHERE r.discount = ""0""
RETURN DISTINCT c.companyName AS customerName, c.contactName AS contactName","match
$c isa customer;
$o isa order;
$p isa product;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p), has discount $d;
$d == 0.0;
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name
};"
670,List the first 3 categories that have products with unitsOnOrder above 30.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.unitsOnOrder > 30
RETURN DISTINCT c.categoryName
LIMIT 3","match
$p isa product, has units_on_order $u;
$u > 30;
part_of (product: $p, category: $c);
$c has category_name $name;
select $name;
distinct;
limit 3;
fetch { ""categoryName"": $name };"
671,Identify the products supplied by suppliers with a phone number starting with '(171)'.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone STARTS WITH '(171)'
RETURN p.productName AS productName, s.companyName AS supplierName","match
$s isa supplier, has phone $phone, has company_name $supplier_name;
$phone like ""\\(171\\).*"";
$p isa product, has product_name $product_name;
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $product_name,
  ""supplierName"": $supplier_name
};"
673,List the suppliers that have a fax number listed.,"MATCH (s:Supplier)
WHERE s.fax IS NOT NULL AND s.fax <> 'NULL'
RETURN s.companyName AS supplierName, s.fax AS faxNumber","match
$s isa supplier, has fax $f;
not { $f == ""NULL""; };
fetch {
  ""supplierName"": $s.company_name,
  ""faxNumber"": $f
};"
674,What are the ship cities for orders that included the product 'Chai'?,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)
RETURN DISTINCT o.shipCity AS shipCity","match
$p isa product, has product_name ""Chai"";
orders (order: $o, product: $p);
$o has ship_city $city;
select $city;
distinct;
fetch { ""shipCity"": $city };"
675,Identify the products with a reorder level less than 5 and a unit price less than $15.,"MATCH (p:Product)
WHERE p.reorderLevel < 5 AND p.unitPrice < 15
RETURN p.productName, p.reorderLevel, p.unitPrice","match
$p isa product, has reorder_level $rl, has unit_price $up;
$rl < 5;
$up < 15.0;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl,
  ""unitPrice"": $up
};"
676,List the orders placed by customers in 'Berlin' that have a shipped date in 1997.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.city = 'Berlin' AND o.shippedDate STARTS WITH '1997'
RETURN o.orderID AS orderID, o.shippedDate AS shippedDate, c.companyName AS customerName, p.productName AS productName","match
$c isa customer, has city ""Berlin"", has company_name $cn;
$o isa order, has order_id $oid, has shipped_date $sd;
$p isa product, has product_name $pn;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$sd like ""1997.*"";
fetch {
  ""orderID"": $oid,
  ""shippedDate"": $sd,
  ""customerName"": $cn,
  ""productName"": $pn
};"
677,Which categories have at least one product with a unit price over $100?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.unitPrice > 100
RETURN DISTINCT c.categoryName","match
$p isa product, has unit_price $up;
$up > 100.0;
part_of (product: $p, category: $c);
$c has category_name $cn;
select $cn;
distinct;
fetch { ""categoryName"": $cn };"
678,Find the first 3 orders that were shipped to 'Portland'.,"MATCH (o:Order)
WHERE o.shipCity = 'Portland'
RETURN o
ORDER BY o.orderDate
LIMIT 3","match
$o isa order, has ship_city ""Portland"", has order_date $od, has order_id $oid;
sort $od;
limit 3;
fetch {
  ""order_id"": $oid,
  ""order_date"": $od
};"
679,What are the details of products that are part of the 'Grains/Cereals' category and have been ordered more than 50 times?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'}),
      (o:Order)-[r:ORDERS]->(p)
WHERE r.quantity > 50
RETURN p.productName AS productName, p.quantityPerUnit AS quantityPerUnit, p.unitsOnOrder AS unitsOnOrder, 
       p.supplierID AS supplierID, p.productID AS productID, p.discontinued AS discontinued, 
       p.categoryID AS categoryID, p.reorderLevel AS reorderLevel, p.unitsInStock AS unitsInStock, 
       p.unitPrice AS unitPrice, SUM(r.quantity) AS totalOrdered","match
$p isa product;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
$o isa order;
$r isa orders (order: $o, product: $p), has quantity $q;
$q > 50;
reduce $totalOrdered = sum($q) groupby $p;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $p.quantity_per_unit,
  ""unitsOnOrder"": $p.units_on_order,
  ""productID"": $p.product_id,
  ""discontinued"": $p.discontinued,
  ""reorderLevel"": $p.reorder_level,
  ""unitsInStock"": $p.units_in_stock,
  ""unitPrice"": $p.unit_price,
  ""totalOrdered"": $totalOrdered
};"
680,List the first 5 customers who have placed orders with a total quantity greater than 200.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, SUM(r.quantity) AS totalQuantity
WHERE totalQuantity > 200
RETURN c.customerID, c.companyName, totalQuantity
ORDER BY totalQuantity DESC
LIMIT 5","match
$c isa customer;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $c;
match $total > 200;
sort $total desc;
limit 5;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""totalQuantity"": $total
};"
681,Identify the products that have a reorder level of 25 and are not discontinued.,"MATCH (p:Product)
WHERE p.reorderLevel = 25 AND p.discontinued = false
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock, p.quantityPerUnit","match
$p isa product,
  has reorder_level 25,
  has discontinued false;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock,
  ""quantityPerUnit"": $p.quantity_per_unit
};"
682,What are the ship countries for orders containing the product 'Aniseed Syrup'?,"MATCH (p:Product {productName: 'Aniseed Syrup'})<-[:ORDERS]-(o:Order)
RETURN DISTINCT o.shipCountry","match
$p isa product, has product_name ""Aniseed Syrup"";
orders (order: $o, product: $p);
$o has ship_country $sc;
select $sc;
distinct;
fetch { ""shipCountry"": $sc };"
683,What are the names of the products that are out of stock?,"MATCH (p:Product)
WHERE p.unitsInStock = 0
RETURN p.productName AS productName","match
$p isa product, has units_in_stock 0;
fetch {
  ""productName"": $p.product_name
};"
684,List orders that have a discount of 0.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE r.discount = ""0""
RETURN o.orderID AS orderID, o.orderDate AS orderDate, o.shipName AS shipName, o.shipCity AS shipCity, o.shipCountry AS shipCountry, r.unitPrice AS unitPrice, r.quantity AS quantity, p.productName AS productName","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has discount $d;
$d == 0.0;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country,
  ""unitPrice"": $rel.order_unit_price,
  ""quantity"": $rel.quantity,
  ""productName"": $p.product_name
};"
685,Which suppliers supply products to more than one category?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, collect(DISTINCT c.categoryID) AS categories
WHERE size(categories) > 1
RETURN s.companyName AS Supplier, size(categories) AS NumberOfCategories","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $count = count($c) groupby $s;
match $count > 1;
fetch { ""Supplier"": $s.company_name, ""NumberOfCategories"": $count };"
686,Identify the products that have been ordered more than 100 times.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
WITH p, SUM(o.quantity) AS totalQuantity
WHERE totalQuantity > 100
RETURN p.productName, totalQuantity","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
match $total > 100;
fetch {
  ""productName"": $p.product_name,
  ""totalQuantity"": $total
};"
687,Which orders contain the product 'Chai'?,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)
RETURN o.orderID AS orderID, o.orderDate AS orderDate, o.shipName AS shipName, o.shipCity AS shipCity, o.shipCountry AS shipCountry","match
$p isa product, has product_name ""Chai"";
$o isa order;
orders (order: $o, product: $p);
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
688,What are the products in the order with ID '10248'?,"MATCH (o:Order {orderID: '10248'})-[:ORDERS]->(p:Product)
RETURN p.productName AS productName, p.productID AS productID","match
$o isa order, has order_id ""10248"";
orders (order: $o, product: $p);
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
690,Find the first 3 orders that required shipping after '1997-01-01'.,"MATCH (o:Order)
WHERE o.requiredDate > '1997-01-01'
RETURN o.orderID, o.requiredDate
ORDER BY o.requiredDate
LIMIT 3","match
$o isa order, has required_date $rd, has order_id $oid;
$rd > ""1997-01-01"";
sort $rd;
limit 3;
fetch {
  ""orderID"": $oid,
  ""requiredDate"": $rd
};"
691,Identify suppliers who do not have a home page listed.,"MATCH (s:Supplier)
WHERE s.homePage = 'NULL'
RETURN s.companyName AS SupplierName, s.contactName AS ContactName, s.phone AS Phone","match
$s isa supplier, has home_page ""NULL"";
fetch {
  ""SupplierName"": $s.company_name,
  ""ContactName"": $s.contact_name,
  ""Phone"": $s.phone
};"
692,Identify the top 3 suppliers by number of products supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
693,List the products with a unit price greater than $50.,"MATCH (p:Product)
WHERE p.unitPrice > 50
RETURN p.productName, p.unitPrice","match
$p isa product, has unit_price $price;
$price > 50;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
694,What are the top 3 most expensive products in the 'Dairy Products' category?,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$c isa category, has category_name ""Dairy Products"";
$p isa product, has unit_price $price;
part_of (product: $p, category: $c);
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
695,Which products are supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
fetch {
  ""productName"": $p.product_name
};"
696,List all orders shipped via ship method '1'.,"MATCH (o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipVia = '1'
RETURN o.orderID AS orderID, o.shipName AS shipName, o.requiredDate AS requiredDate, o.shipCity AS shipCity, o.shipPostalCode AS shipPostalCode, o.shippedDate AS shippedDate, o.freight AS freight, o.orderDate AS orderDate, o.shipAddress AS shipAddress, o.customerID AS customerID, o.shipCountry AS shipCountry, o.shipRegion AS shipRegion","match
$o isa order, has ship_via ""1"";
orders (order: $o, product: $p);
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""requiredDate"": $o.required_date,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shippedDate"": $o.shipped_date,
  ""freight"": $o.freight,
  ""orderDate"": $o.order_date,
  ""shipAddress"": $o.ship_address,
  ""customerID"": $c.customer_id,
  ""shipCountry"": $o.ship_country,
  ""shipRegion"": $o.ship_region
};"
697,Who are the customers that purchased orders shipped to France?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN DISTINCT c.companyName AS CustomerName, c.contactName AS ContactName, c.contactTitle AS ContactTitle, c.city AS City, c.country AS Country","match
$c isa customer;
$o isa order, has ship_country ""France"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $c;
distinct;
fetch {
  ""CustomerName"": $c.company_name,
  ""ContactName"": $c.contact_name,
  ""ContactTitle"": $c.contact_title,
  ""City"": $c.city,
  ""Country"": $c.country
};"
698,Identify products with units on order greater than 50.,"MATCH (p:Product)
WHERE p.unitsOnOrder > 50
RETURN p.productName, p.unitsOnOrder","match
$p isa product, has units_on_order $u;
$u > 50;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
699,What are the discontinued products?,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName AS DiscontinuedProduct, p.productID AS ProductID","match
$p isa product, has discontinued true;
fetch {
  ""DiscontinuedProduct"": $p.product_name,
  ""ProductID"": $p.product_id
};"
700,Find the first 3 customers located in Berlin.,"MATCH (c:Customer)
WHERE c.city = 'Berlin'
RETURN c.companyName, c.contactName, c.contactTitle, c.address, c.postalCode, c.country, c.phone, c.fax
LIMIT 3","match
$c isa customer, has city ""Berlin"";
limit 3;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""contactTitle"": $c.contact_title,
  ""address"": $c.address,
  ""postalCode"": $c.postal_code,
  ""country"": $c.country,
  ""phone"": $c.phone,
  ""fax"": $c.fax
};"
701,Which products have a reorder level greater than 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel","match
$p isa product, has reorder_level $rl;
$rl > 20;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
702,List the top 5 suppliers based in the UK.,"MATCH (s:Supplier {country: 'UK'})
RETURN s.companyName AS supplierName
ORDER BY s.companyName
LIMIT 5","match
$s isa supplier, has country ""UK"", has company_name $cn;
sort $cn;
limit 5;
fetch {
  ""supplierName"": $cn
};"
703,Which categories contain more than 5 products?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WITH c, count(p) as productCount
WHERE productCount > 5
RETURN c.categoryName, productCount","match
$c isa category;
$p isa product;
part_of (product: $p, category: $c);
reduce $productCount = count($p) groupby $c;
match $productCount > 5;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $productCount
};"
704,Which 3 categories have the most products with a reorder level of 0?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 0
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN category, productCount","match
$p isa product, has reorder_level 0;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $count
};"
705,Which customers have a contact title of 'Sales Representative'?,"MATCH (c:Customer)
WHERE c.contactTitle = 'Sales Representative'
RETURN c.companyName AS customerName, c.contactName AS contactPerson","match
$c isa customer, has contact_title ""Sales Representative"";
fetch {
  ""customerName"": $c.company_name,
  ""contactPerson"": $c.contact_name
};"
706,What are the product names and prices for products that have been discontinued but are still in stock?,"MATCH (p:Product)
WHERE p.discontinued = true AND p.unitsInStock > 0
RETURN p.productName AS productName, p.unitPrice AS unitPrice","match
$p isa product, has discontinued true, has units_in_stock $stock;
$stock > 0;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $p.unit_price
};"
707,Who are the suppliers for the product with ID '3'?,"MATCH (p:Product {productID: '3'})<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName AS supplierName, s.contactName AS contactPerson, s.phone AS contactPhone","match
$p isa product, has product_id ""3"";
supplies (supplier: $s, product: $p);
fetch {
  ""supplierName"": $s.company_name,
  ""contactPerson"": $s.contact_name,
  ""contactPhone"": $s.phone
};"
708,Find the top 3 most ordered products in terms of quantity from orders.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName AS productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3","match
$p isa product;
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""totalQuantity"": $total
};"
709,Which suppliers provide products to both 'Beverages' and 'Seafood' categories?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WHERE c.categoryName IN ['Beverages', 'Seafood']
WITH s, c.categoryName AS categoryName
ORDER BY s.supplierID, categoryName
WITH s, collect(categoryName) AS categories
WHERE 'Beverages' IN categories AND 'Seafood' IN categories
RETURN s.companyName AS supplierName","match
$s isa supplier;
$p1 isa product;
$c1 isa category, has category_name ""Beverages"";
supplies (supplier: $s, product: $p1);
part_of (product: $p1, category: $c1);
$p2 isa product;
$c2 isa category, has category_name ""Seafood"";
supplies (supplier: $s, product: $p2);
part_of (product: $p2, category: $c2);
fetch { ""supplierName"": $s.company_name };"
710,List all the products ordered in the 'Confections' category.,"MATCH (c:Category {categoryName: 'Confections'})<-[:PART_OF]-(p:Product)
MATCH (o:Order)-[:ORDERS]->(p)
RETURN DISTINCT p.productName AS ProductName","match
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
orders (order: $o, product: $p);
$p has product_name $name;
select $name;
distinct;
fetch {
  ""ProductName"": $name
};"
711,Which products have a unitsInStock value between 50 and 100?,"MATCH (p:Product)
WHERE p.unitsInStock >= 50 AND p.unitsInStock <= 100
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $u;
$u >= 50;
$u <= 100;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $u
};"
712,Find the first 5 orders made in 1996.,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1996'
RETURN o
ORDER BY o.orderDate
LIMIT 5","match
$o isa order, has order_date $od;
$od like ""1996.*"";
sort $od asc;
limit 5;
fetch {
  ""order_id"": $o.order_id,
  ""order_date"": $o.order_date,
  ""ship_name"": $o.ship_name,
  ""ship_city"": $o.ship_city,
  ""ship_country"": $o.ship_country,
  ""freight"": $o.freight,
  ""shipped_date"": $o.shipped_date,
  ""required_date"": $o.required_date
};"
713,Identify the products supplied by suppliers with no listed phone number.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.phone IS NULL
RETURN p.productName AS productName, s.companyName AS supplierName","match
$s isa supplier;
$p isa product;
supplies (supplier: $s, product: $p);
not { $s has phone $ph; };
fetch {
  ""productName"": $p.product_name,
  ""supplierName"": $s.company_name
};"
714,Which orders were placed by customers in the 'NULL' region?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE c.region = 'NULL'
RETURN o.orderID AS orderID, c.companyName AS customerName, o.orderDate AS orderDate","match
$c isa customer, has region ""NULL"";
$o isa order;
purchased (customer: $c, order: $o);
fetch {
  ""orderID"": $o.order_id,
  ""customerName"": $c.company_name,
  ""orderDate"": $o.order_date
};"
715,List the categories of products that have never been reordered (reorder level is 0).,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel = 0
RETURN DISTINCT c.categoryName","match
$p isa product, has reorder_level 0;
part_of (product: $p, category: $c);
$c has category_name $name;
select $name;
distinct;
fetch { ""categoryName"": $name };"
716,List the first 3 products with '0' units on order and a reorder level of 10.,"MATCH (p:Product)
WHERE p.unitsOnOrder = 0 AND p.reorderLevel = 10
RETURN p.productName, p.quantityPerUnit, p.unitPrice
LIMIT 3","match
$p isa product, has units_on_order 0, has reorder_level 10;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $p.quantity_per_unit,
  ""unitPrice"": $p.unit_price
};"
717,Which suppliers have supplied products that are currently discontinued?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
RETURN DISTINCT s.companyName","match
$s isa supplier;
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
select $s;
distinct;
fetch { ""companyName"": $s.company_name };"
719,List the first 3 customers from 'Germany' who ordered 'Beverages'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WHERE c.country = 'Germany' AND cat.categoryName = 'Beverages'
RETURN c.companyName, c.contactName, c.city
LIMIT 3","match
$c isa customer, has country ""Germany"";
$cat isa category, has category_name ""Beverages"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
limit 3;
fetch {
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""city"": $c.city
};"
720,Which customers ordered more than 10 different products?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WITH c, COUNT(DISTINCT p.productID) AS productCount
WHERE productCount > 10
RETURN c.companyName AS customerName, productCount","match
$c isa customer;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
select $c, $p;
distinct;
reduce $count = count groupby $c;
match $count > 10;
fetch { ""customerName"": $c.company_name, ""productCount"": $count };"
721,What are the category descriptions for categories supplying 'Spegesild'?,"MATCH (p:Product {productName: 'Spegesild'})-[:PART_OF]->(c:Category)
RETURN c.description","match
$p isa product, has product_name ""Spegesild"";
part_of (product: $p, category: $c);
fetch {
  ""description"": $c.description
};"
722,List the products with quantities per unit described as 'boxes'.,"MATCH (p:Product)
WHERE p.quantityPerUnit CONTAINS 'boxes'
RETURN p.productName AS productName, p.quantityPerUnit AS quantityPerUnit","match
$p isa product, has quantity_per_unit $q;
$q like "".*boxes.*"";
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $q
};"
723,Which suppliers are located in 'London'?,"MATCH (s:Supplier)
WHERE s.city = 'London'
RETURN s.companyName AS supplierName","match
$s isa supplier, has city ""London"";
fetch {
  ""supplierName"": $s.company_name
};"
724,Identify products that are part of the 'Meat/Poultry' category and have more than 30 units in stock.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WHERE p.unitsInStock > 30
RETURN p.productName, p.unitsInStock","match
$p isa product, has units_in_stock $stock;
$c isa category, has category_name ""Meat/Poultry"";
part_of (product: $p, category: $c);
$stock > 30;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
725,List the orders that were shipped by 'Vins et alcools Chevalier'.,"MATCH (o:Order {shipName: 'Vins et alcools Chevalier'})
RETURN o.orderID, o.orderDate, o.shippedDate, o.shipCity, o.shipCountry","match
$o isa order, has ship_name ""Vins et alcools Chevalier"";
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $o.order_date,
  ""shippedDate"": $o.shipped_date,
  ""shipCity"": $o.ship_city,
  ""shipCountry"": $o.ship_country
};"
726,Which orders were shipped to the regions not specified (NULL region)?,"MATCH (o:Order)
WHERE o.shipRegion IS NULL
RETURN o.orderID AS orderID, o.shipName AS shipName, o.shipCity AS shipCity, o.shipPostalCode AS shipPostalCode, o.shipCountry AS shipCountry","match
$o isa order;
not { $o has ship_region $r; };
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country
};"
727,Identify the top 5 most frequently ordered products.,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$p isa product;
$rel isa orders (order: $o, product: $p);
reduce $order_count = count($rel) groupby $p;
sort $order_count desc;
limit 5;
fetch { ""productName"": $p.product_name, ""orderCount"": $order_count };"
728,List the top 5 orders with the highest freight cost.,"MATCH (o:Order)
RETURN o.orderID, o.freight
ORDER BY toFloat(o.freight) DESC
LIMIT 5","match
$o isa order, has order_id $oid, has freight $f;
sort $f desc;
limit 5;
fetch {
  ""orderID"": $oid,
  ""freight"": $f
};"
729,What are the top 3 most frequently shipped products to 'France'?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.shipCountry = 'France'
RETURN p.productName, COUNT(r) AS shipmentCount
ORDER BY shipmentCount DESC
LIMIT 3","match
$o isa order, has ship_country ""France"";
$r isa orders (order: $o, product: $p);
reduce $shipment_count = count($r) groupby $p;
sort $shipment_count desc;
limit 3;
fetch {
  ""product_name"": $p.product_name,
  ""shipment_count"": $shipment_count
};"
730,List all products that have been ordered by customers from the USA.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.country = 'USA'
RETURN DISTINCT p.productName","match
$c isa customer, has country ""USA"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
$p has product_name $name;
select $name;
distinct;
fetch { ""productName"": $name };"
731,List the top 3 customers based on the number of orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.companyName AS customerName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerName"": $c.company_name,
  ""orderCount"": $order_count
};"
732,Which 5 orders have the most distinct products included?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WITH o, count(DISTINCT p.productID) AS productCount
ORDER BY productCount DESC
LIMIT 5
RETURN o.orderID, productCount","match
$o isa order;
orders (order: $o, product: $p);
select $o, $p;
distinct;
reduce $productCount = count groupby $o;
sort $productCount desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""productCount"": $productCount
};"
733,Identify the 3 categories with the least number of products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount ASC
LIMIT 3
RETURN category, productCount","match
$c isa category, has category_name $name;
$p isa product;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c, $name;
sort $count asc;
limit 3;
fetch { ""category"": $name, ""productCount"": $count };"
734,What are the top 5 products with the lowest units on order and not discontinued?,"MATCH (p:Product)
WHERE p.discontinued = false
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder ASC
LIMIT 5","match
$p isa product, has discontinued false, has units_on_order $u;
sort $u asc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
735,List the 3 products with the highest units in stock supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has units_in_stock $stock;
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
736,Which 5 customers have orders with the required date in the year 1997?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.requiredDate STARTS WITH '1997'
RETURN c.companyName AS customerName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has company_name $name;
$o isa order, has required_date $rd;
$rd like ""1997.*"";
purchased (customer: $c, order: $o);
reduce $count = count($o) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""customerName"": $name, ""orderCount"": $count };"
737,Identify the 3 most common product names supplied by 'Exotic Liquids'.,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, COUNT(p.productName) AS productCount
ORDER BY productCount DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has product_name $name;
reduce $count = count($p) groupby $name;
sort $count desc;
limit 3;
fetch { ""productName"": $name, ""productCount"": $count };"
738,What are the first 5 orders placed in the year 1996?,"MATCH (o:Order)
WHERE o.orderDate STARTS WITH '1996'
RETURN o.orderID, o.orderDate
ORDER BY o.orderDate
LIMIT 5","match
$o isa order, has order_id $oid, has order_date $od;
$od like ""1996%"";
sort $od;
limit 5;
fetch {
  ""orderID"": $oid,
  ""orderDate"": $od
};"
739,List the top 3 products with the highest quantity per unit in the 'Dairy Products' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
$p has quantity_per_unit $qpu;
sort $qpu desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""quantityPerUnit"": $qpu
};"
740,Which 5 products have the most suppliers?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH p, COUNT(s) AS supplierCount
RETURN p.productName, supplierCount
ORDER BY supplierCount DESC
LIMIT 5","match
$p isa product;
$s isa supplier;
supplies (supplier: $s, product: $p);
reduce $supplierCount = count($s) groupby $p;
sort $supplierCount desc;
limit 5;
fetch { ""productName"": $p.product_name, ""supplierCount"": $supplierCount };"
741,Identify the 3 suppliers from the city 'London' who supply the most products.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.city = 'London'
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier, has city ""London"";
supplies (supplier: $s, product: $p);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
742,What are the top 5 most common contact titles among suppliers?,"MATCH (s:Supplier)
RETURN s.contactTitle, COUNT(*) AS titleCount
ORDER BY titleCount DESC
LIMIT 5","match
$s isa supplier, has contact_title $ct;
reduce $count = count($s) groupby $ct;
sort $count desc;
limit 5;
fetch { ""contact_title"": $ct, ""count"": $count };"
743,List the 3 customers who have ordered products with the highest average unit price.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
WITH c, avg(toFloat(r.unitPrice)) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 3
RETURN c.companyName AS customerName, avgUnitPrice","match
$c isa customer, has company_name $name;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has order_unit_price $price;
reduce $avg_price = mean($price) groupby $c, $name;
sort $avg_price desc;
limit 3;
fetch {
  ""customerName"": $name,
  ""avgUnitPrice"": $avg_price
};"
744,Which 5 categories contain products that are all actively being supplied (none discontinued)?,"MATCH (c:Category)<-[:PART_OF]-(p:Product)
WHERE p.discontinued = false
WITH c, COUNT(p) AS totalProducts
MATCH (c)<-[:PART_OF]-(p:Product)
WITH c, totalProducts, COUNT(p) AS activeProducts
WHERE totalProducts = activeProducts
RETURN c.categoryName
LIMIT 5","match
$c isa category, has category_name $name;
part_of (product: $p, category: $c);
not { 
  $p2 isa product, has discontinued true;
  part_of (product: $p2, category: $c);
};
limit 5;
fetch { ""categoryName"": $name };"
745,Identify the top 5 products with the lowest reorder level.,"MATCH (p:Product)
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel ASC
LIMIT 5","match $p isa product, has reorder_level $rl;
sort $rl asc;
limit 5;
fetch { ""product_name"": $p.product_name, ""reorder_level"": $rl };"
746,What are the first 5 products with a unit price greater than 50 supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: ""Exotic Liquids""})-[:SUPPLIES]->(p:Product)
WHERE p.unitPrice > 50
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 5","match
$s isa supplier, has company_name ""Exotic Liquids"";
$p isa product, has unit_price $up;
supplies (supplier: $s, product: $p);
$up > 50;
sort $up desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
747,Identify the 3 most frequent ship countries for orders from 'Alfreds Futterkiste'.,"MATCH (c:Customer {companyName: 'Alfreds Futterkiste'})-[:PURCHASED]->(o:Order)
RETURN o.shipCountry AS shipCountry, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$c isa customer, has company_name ""Alfreds Futterkiste"";
purchased (customer: $c, order: $o);
$o has ship_country $sc;
reduce $count = count($o) groupby $sc;
sort $count desc;
limit 3;
fetch { ""shipCountry"": $sc, ""orderCount"": $count };"
748,Which 5 customers have the most discontinued products ordered?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE p.discontinued = true
RETURN c.companyName AS customer, COUNT(p) AS discontinuedProductsOrdered
ORDER BY discontinuedProductsOrdered DESC
LIMIT 5","match
$c isa customer, has company_name $name;
$o isa order;
$p isa product, has discontinued true;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
reduce $count = count($p) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""customer"": $name, ""discontinuedProductsOrdered"": $count };"
749,List the top 3 products with the highest discount given in any order.,"MATCH (o:Order)-[ord:ORDERS]->(p:Product)
WITH p.productName AS productName, ord.discount AS discount
ORDER BY discount DESC
LIMIT 3
RETURN productName, discount","match
$p isa product;
$rel isa orders (product: $p);
$rel has discount $d;
sort $d desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""discount"": $d
};"
750,Which products from 'Exotic Liquids' are part of the 'Beverages' category and have a unit price less than 20?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WHERE p.unitPrice < 20
RETURN p.productName, p.unitPrice","match
  $s isa supplier, has company_name ""Exotic Liquids"";
  $p isa product, has unit_price $up;
  $c isa category, has category_name ""Beverages"";
  supplies (supplier: $s, product: $p);
  part_of (product: $p, category: $c);
  $up < 20;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
751,List the top 5 products with the highest total sales quantity.,"MATCH (p:Product)<-[:ORDERS]-(o:Order)
WITH p, SUM(o.quantity) AS totalSalesQuantity
ORDER BY totalSalesQuantity DESC
LIMIT 5
RETURN p.productName, totalSalesQuantity","match
$p isa product;
$rel isa orders (product: $p, order: $o);
$rel has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""totalSalesQuantity"": $total
};"
752,Which 3 categories have the most products with a reorder level above 15?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE p.reorderLevel > 15
RETURN c.categoryName, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3","match
$p isa product, has reorder_level $rl;
$rl > 15;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""categoryName"": $c.category_name,
  ""productCount"": $count
};"
753,Identify the 5 suppliers with the highest average unit price of products supplied.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WITH s, avg(p.unitPrice) AS avgUnitPrice
ORDER BY avgUnitPrice DESC
LIMIT 5
RETURN s.companyName AS Supplier, avgUnitPrice AS AverageUnitPrice","match
$s isa supplier;
supplies (supplier: $s, product: $p);
$p has unit_price $up;
reduce $avg = mean($up) groupby $s;
sort $avg desc;
limit 5;
fetch {
  ""Supplier"": $s.company_name,
  ""AverageUnitPrice"": $avg
};"
754,What are the first 3 orders that were shipped to 'Reims'?,"MATCH (o:Order)
WHERE o.shipCity = 'Reims'
RETURN o.orderID, o.shipName, o.shipAddress, o.shipCity, o.shipPostalCode, o.shipCountry, o.shippedDate
ORDER BY o.shippedDate
LIMIT 3","match
$o isa order, has ship_city ""Reims"", has shipped_date $sd;
sort $sd;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""shipName"": $o.ship_name,
  ""shipAddress"": $o.ship_address,
  ""shipCity"": $o.ship_city,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipCountry"": $o.ship_country,
  ""shippedDate"": $sd
};"
755,List the top 5 most recently added products to the database.,"MATCH (p:Product)
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock, p.unitsOnOrder, p.reorderLevel, p.discontinued, p.categoryID, p.supplierID, p.quantityPerUnit
ORDER BY p.productID DESC
LIMIT 5","match
$p isa product,
  has product_id $pid;
sort $pid desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock,
  ""unitsOnOrder"": $p.units_on_order,
  ""reorderLevel"": $p.reorder_level,
  ""discontinued"": $p.discontinued,
  ""quantityPerUnit"": $p.quantity_per_unit
};"
756,Which 3 products from 'Exotic Liquids' have been ordered the most in terms of quantity?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
RETURN p.productName, SUM(o.quantity) AS totalQuantity
ORDER BY totalQuantity DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$o isa orders (order: $ord, product: $p), has quantity $q;
reduce $total = sum($q) groupby $p;
sort $total desc;
limit 3;
fetch { ""productName"": $p.product_name, ""totalQuantity"": $total };"
757,What are the 3 most frequently supplied products by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, COUNT(p) AS supplyCount
ORDER BY supplyCount DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has product_name $pn;
reduce $count = count($p) groupby $pn;
sort $count desc;
limit 3;
fetch { ""product_name"": $pn, ""supply_count"": $count };"
758,What are the first 3 products in the 'Produce' category with the lowest unit price?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match
$p isa product, has unit_price $up;
$c isa category, has category_name ""Produce"";
part_of (product: $p, category: $c);
sort $up asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $up
};"
759,Which 3 suppliers have the most diverse range of product categories supplied?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH s, collect(DISTINCT c.categoryID) AS categories
RETURN s.companyName, size(categories) AS categoryCount
ORDER BY categoryCount DESC
LIMIT 3","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $category_count = count groupby $s;
sort $category_count desc;
limit 3;
fetch { ""companyName"": $s.company_name, ""categoryCount"": $category_count };"
760,Identify the 5 most recently shipped orders.,"MATCH (o:Order)
WHERE o.shippedDate IS NOT NULL
RETURN o.orderID, o.shippedDate
ORDER BY o.shippedDate DESC
LIMIT 5","match
$o isa order, has shipped_date $sd;
sort $sd desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""shippedDate"": $sd
};"
761,What are the first 3 customers who have ordered the product with productID '1'?,"MATCH (p:Product {productID: '1'})<-[:ORDERS]-(o:Order)<-[:PURCHASED]-(c:Customer)
RETURN c.customerID, c.companyName, c.contactName
LIMIT 3","match
$p isa product, has product_id ""1"";
orders (product: $p, order: $o);
purchased (customer: $c, order: $o);
limit 3;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name
};"
762,List the top 3 suppliers with the most products in the 'Beverages' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
WITH s, count(p) as productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Beverages"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
reduce $productCount = count($p) groupby $s;
sort $productCount desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $productCount
};"
763,Which 5 products have been reordered the most times?,"MATCH (p:Product)
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product, has units_on_order $u;
sort $u desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $u
};"
764,Identify the 3 most common ship addresses for orders.,"MATCH (o:Order)
WITH o.shipAddress AS address, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN address, orderCount","match
$o isa order, has ship_address $addr;
reduce $count = count($o) groupby $addr;
sort $count desc;
limit 3;
fetch {
  ""address"": $addr,
  ""orderCount"": $count
};"
765,What are the first 5 products from the 'Condiments' category with the most units in stock?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Condiments'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Condiments"";
part_of (product: $p, category: $c);
$p has units_in_stock $stock;
sort $stock desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
766,List the top 5 orders with the highest quantity of a single product.,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
RETURN o.orderID AS orderID, p.productName AS productName, r.quantity AS quantity
ORDER BY r.quantity DESC
LIMIT 5","match
$o isa order;
$p isa product;
$rel isa orders (order: $o, product: $p), has quantity $q;
sort $q desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""productName"": $p.product_name,
  ""quantity"": $q
};"
768,Identify the 5 customers who have ordered the most distinct categories of products.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category)
WITH c, cat.categoryID AS categoryID
ORDER BY c.customerID, categoryID
WITH c, collect(DISTINCT categoryID) AS categories
RETURN c.customerID, c.companyName, size(categories) AS distinctCategories
ORDER BY distinctCategories DESC
LIMIT 5","match
$c isa customer, has customer_id $cid, has company_name $cn;
$o isa order;
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
part_of (product: $p, category: $cat);
$cat has category_id $catid;
select $c, $cid, $cn, $catid;
distinct;
reduce $count = count groupby $c, $cid, $cn;
sort $count desc;
limit 5;
fetch {
  ""customerID"": $cid,
  ""companyName"": $cn,
  ""distinctCategories"": $count
};"
769,Identify the 5 most common ship cities for orders.,"MATCH (o:Order)
WITH o.shipCity AS city, COUNT(o) AS orderCount
RETURN city
ORDER BY orderCount DESC
LIMIT 5","match
$o isa order, has ship_city $city;
reduce $count = count($o) groupby $city;
sort $count desc;
limit 5;
fetch { ""city"": $city };"
770,List the top 5 products that have been discontinued.,"MATCH (p:Product)
WHERE p.discontinued = true
RETURN p.productName, p.productID
ORDER BY p.productName
LIMIT 5","match
$p isa product, has discontinued true, has product_name $name;
sort $name;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id
};"
771,Which suppliers have a contact title of 'Purchasing Manager' and supply products with a unit price above 50?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE s.contactTitle = 'Purchasing Manager' AND p.unitPrice > 50
RETURN s.companyName AS SupplierName, p.productName AS ProductName, p.unitPrice AS UnitPrice","match
$s isa supplier, has contact_title ""Purchasing Manager"";
$p isa product, has unit_price $price;
$price > 50;
supplies (supplier: $s, product: $p);
fetch {
  ""SupplierName"": $s.company_name,
  ""ProductName"": $p.product_name,
  ""UnitPrice"": $price
};"
772,"List all products that belong to the 'Desserts, candies, and sweet breads' category and have a reorder level above 15.","MATCH (p:Product)-[:PART_OF]->(c:Category)
WHERE c.description = 'Desserts, candies, and sweet breads' AND p.reorderLevel > 15
RETURN p.productName, p.reorderLevel","match
$p isa product, has reorder_level $rl;
$c isa category, has description ""Desserts, candies, and sweet breads"";
part_of (product: $p, category: $c);
$rl > 15;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
773,What are the top 5 suppliers by number of different cities they supply to?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WITH s, o.shipCity AS city
WHERE city IS NOT NULL
WITH s, COUNT(DISTINCT city) AS cityCount
RETURN s.companyName AS supplier, cityCount
ORDER BY cityCount DESC
LIMIT 5","match
$s isa supplier;
supplies (supplier: $s, product: $p);
orders (order: $o, product: $p);
$o has ship_city $city;
select $s, $city;
distinct;
reduce $count = count groupby $s;
sort $count desc;
limit 5;
fetch {
  ""supplier"": $s.company_name,
  ""cityCount"": $count
};"
774,Show the first 3 products from the 'Dairy Products' category that have been discontinued.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Dairy Products'})
WHERE p.discontinued = true
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock
LIMIT 3","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock
};"
775,Which suppliers provide products to more than one region?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)<-[:ORDERS]-(o:Order)
WHERE o.shipRegion IS NOT NULL
WITH s, COLLECT(DISTINCT o.shipRegion) AS regions
WHERE SIZE(regions) > 1
RETURN s.companyName AS Supplier, regions","match
$s isa supplier, has company_name $name;
supplies (supplier: $s, product: $p);
orders (product: $p, order: $o);
$o has ship_region $region;
select $s, $name, $region;
distinct;
reduce $region_count = count groupby $s, $name;
match $region_count > 1;
fetch { ""Supplier"": $name };"
776,List all products that have been ordered by 'Vins et alcools Chevalier'.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)
WHERE c.companyName = 'Vins et alcools Chevalier'
RETURN p.productName AS ProductName, p.productID AS ProductID","match
$c isa customer, has company_name ""Vins et alcools Chevalier"";
purchased (customer: $c, order: $o);
orders (order: $o, product: $p);
fetch {
  ""ProductName"": $p.product_name,
  ""ProductID"": $p.product_id
};"
777,What are the top 3 most expensive products supplied by 'Exotic Liquids'?,"MATCH (s:Supplier {companyName: 'Exotic Liquids'})-[:SUPPLIES]->(p:Product)
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice DESC
LIMIT 3","match
$s isa supplier, has company_name ""Exotic Liquids"";
supplies (supplier: $s, product: $p);
$p has unit_price $price;
sort $price desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
778,What are the top 5 categories by number of products supplied?,"MATCH (p:Product)-[:PART_OF]->(c:Category)
RETURN c.categoryName AS category, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 5","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $count
};"
779,Which products are supplied by suppliers from Germany?,"MATCH (s:Supplier {country: ""Germany""})-[:SUPPLIES]->(p:Product)
RETURN p.productName AS productName","match
$s isa supplier, has country ""Germany"";
supplies (supplier: $s, product: $p);
fetch { ""productName"": $p.product_name };"
780,List the first 3 products from the 'Seafood' category with a unitsOnOrder value above 20.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Seafood'})
WHERE p.unitsOnOrder > 20
RETURN p.productName, p.unitsOnOrder
ORDER BY p.productName
LIMIT 3","match
$p isa product, has product_name $pn, has units_on_order $uo;
$c isa category, has category_name ""Seafood"";
part_of (product: $p, category: $c);
$uo > 20;
sort $pn;
limit 3;
fetch {
  ""productName"": $pn,
  ""unitsOnOrder"": $uo
};"
781,List all customers who have placed orders with a required date in 1998.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.requiredDate STARTS WITH '1998'
RETURN c.companyName AS customerName, c.contactName AS contactName, c.customerID AS customerID","match
$c isa customer;
$o isa order, has required_date $rd;
$rd like ""1998.*"";
purchased (customer: $c, order: $o);
fetch {
  ""customerName"": $c.company_name,
  ""contactName"": $c.contact_name,
  ""customerID"": $c.customer_id
};"
782,What are the top 5 products by quantity per unit in the 'Produce' category?,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Produce'})
RETURN p.productName, p.quantityPerUnit
ORDER BY p.quantityPerUnit DESC
LIMIT 5","match
$p isa product, has product_name $pn, has quantity_per_unit $qpu;
$c isa category, has category_name ""Produce"";
part_of (product: $p, category: $c);
sort $qpu desc;
limit 5;
fetch {
  ""productName"": $pn,
  ""quantityPerUnit"": $qpu
};"
783,Show the first 3 discontinued products from the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
WHERE p.discontinued = true
RETURN p.productName, p.productID, p.unitPrice
LIMIT 3","match
$p isa product, has discontinued true;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price
};"
784,Which 3 products have been ordered the most frequently?,"MATCH (:Order)-[o:ORDERS]->(p:Product)
RETURN p.productName, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3","match
$p isa product;
$rel isa orders (product: $p);
reduce $count = count($rel) groupby $p;
sort $count desc;
limit 3;
fetch { ""productName"": $p.product_name, ""orderCount"": $count };"
785,Which categories have products supplied by more than three different suppliers?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(DISTINCT s.supplierID) AS supplierCount
WHERE supplierCount > 3
RETURN category","match
$s isa supplier;
$p isa product;
$c isa category;
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
select $s, $c;
distinct;
reduce $supplier_count = count groupby $c;
match $supplier_count > 3;
fetch { ""category"": $c.category_name };"
786,Show the first 3 orders for the product 'Chai'.,"MATCH (p:Product {productName: 'Chai'})<-[:ORDERS]-(o:Order)
RETURN o.orderID, o.orderDate, o.shipName, o.shipCity, o.shipCountry
ORDER BY o.orderDate
LIMIT 3","match
$p isa product, has product_name ""Chai"";
orders (product: $p, order: $o);
$o has order_id $oid,
   has order_date $odate,
   has ship_name $sname,
   has ship_city $scity,
   has ship_country $scountry;
sort $odate;
limit 3;
fetch {
  ""orderID"": $oid,
  ""orderDate"": $odate,
  ""shipName"": $sname,
  ""shipCity"": $scity,
  ""shipCountry"": $scountry
};"
787,Identify 5 products that are part of the 'Beverages' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Beverages'})
RETURN p.productName, p.productID, p.unitPrice, p.unitsInStock, p.unitsOnOrder
LIMIT 5","match
$p isa product;
$c isa category, has category_name ""Beverages"";
part_of (product: $p, category: $c);
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""productID"": $p.product_id,
  ""unitPrice"": $p.unit_price,
  ""unitsInStock"": $p.units_in_stock,
  ""unitsOnOrder"": $p.units_on_order
};"
788,Which suppliers supply products with a unitsInStock value above 80?,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock > 80
RETURN s.companyName","match
$s isa supplier;
$p isa product, has units_in_stock $stock;
$stock > 80;
supplies (supplier: $s, product: $p);
fetch {
  ""companyName"": $s.company_name
};"
790,Which 3 suppliers provide products in the 'Dairy Products' category?,"MATCH (c:Category {categoryName: 'Dairy Products'})<-[:PART_OF]-(p:Product)<-[:SUPPLIES]-(s:Supplier)
RETURN s.companyName
LIMIT 3","match
$c isa category, has category_name ""Dairy Products"";
part_of (product: $p, category: $c);
supplies (supplier: $s, product: $p);
limit 3;
fetch { ""companyName"": $s.company_name };"
791,What are the first 3 orders that included more than 100 units of any product?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE r.quantity > 100
RETURN o.orderID, o.orderDate, o.shipName, r.productID, r.quantity
ORDER BY o.orderDate
LIMIT 3","match
$o isa order;
$p isa product, has product_id $pid;
$rel isa orders (order: $o, product: $p), has quantity $q;
$q > 100;
$o has order_date $od;
sort $od;
limit 3;
fetch {
  ""orderID"": $o.order_id,
  ""orderDate"": $od,
  ""shipName"": $o.ship_name,
  ""productID"": $pid,
  ""quantity"": $q
};"
792,Which 3 customers have purchased the most products from the 'Seafood' category?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[:ORDERS]->(p:Product)-[:PART_OF]->(cat:Category {categoryName: 'Seafood'})
WITH c, SUM(o.quantity) AS totalProducts
ORDER BY totalProducts DESC
LIMIT 3
RETURN c.companyName AS customerName, totalProducts","match
  $c isa customer;
  $o isa order;
  $p isa product;
  $cat isa category, has category_name ""Seafood"";
  purchased (customer: $c, order: $o);
  $ord isa orders (order: $o, product: $p), has quantity $q;
  part_of (product: $p, category: $cat);
reduce $total = sum($q) groupby $c;
sort $total desc;
limit 3;
fetch { ""customerName"": $c.company_name, ""totalProducts"": $total };"
793,List the top 5 products ordered by 'Alfreds Futterkiste'.,"MATCH (c:Customer {companyName: 'Alfreds Futterkiste'})-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN p.productName, COUNT(r) AS orderCount
ORDER BY orderCount DESC
LIMIT 5","match
$c isa customer, has company_name ""Alfreds Futterkiste"";
purchased (customer: $c, order: $o);
$r isa orders (order: $o, product: $p);
reduce $order_count = count($r) groupby $p;
sort $order_count desc;
limit 5;
fetch { ""product_name"": $p.product_name, ""order_count"": $order_count };"
794,List the top 5 categories with the most products.,"MATCH (p:Product)-[:PART_OF]->(c:Category)
WITH c.categoryName AS category, COUNT(p) AS productCount
RETURN category, productCount
ORDER BY productCount DESC
LIMIT 5","match
$p isa product;
$c isa category;
part_of (product: $p, category: $c);
reduce $count = count($p) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""category"": $c.category_name,
  ""productCount"": $count
};"
795,What are the first 3 orders shipped via method '2' and have a discount?,"MATCH (o:Order)-[r:ORDERS]->(p:Product)
WHERE o.shipVia = '2' AND r.discount <> '0'
RETURN o.orderID, o.shipName, o.shipCity, o.shipCountry, o.shipPostalCode, o.shipAddress, o.shipRegion, o.shipDate, r.discount
ORDER BY o.orderDate
LIMIT 3","match
$o isa order, has ship_via ""2"", has order_id $oid, has ship_name $sn, has ship_city $sc, has ship_country $sco, has ship_address $sa, has ship_region $sr, has shipped_date $sd, has order_date $od;
$rel isa orders (order: $o, product: $p), has discount $d;
$d != 0.0;
sort $od;
limit 3;
fetch {
  ""orderID"": $oid,
  ""shipName"": $sn,
  ""shipCity"": $sc,
  ""shipCountry"": $sco,
  ""shipPostalCode"": $o.ship_postal_code,
  ""shipAddress"": $sa,
  ""shipRegion"": $sr,
  ""shipDate"": $sd,
  ""discount"": $d
};"
796,Find the 5 suppliers whose products have never been out of stock.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.unitsInStock > 0
WITH s, COUNT(p) AS totalProducts, SUM(CASE WHEN p.unitsInStock > 0 THEN 1 ELSE 0 END) AS inStockProducts
WHERE totalProducts = inStockProducts
RETURN s.companyName
LIMIT 5","match
$s isa supplier;
supplies (supplier: $s, product: $p);
not {
  supplies (supplier: $s, product: $p2);
  $p2 has units_in_stock $stock;
  $stock <= 0;
};
select $s;
distinct;
limit 5;
fetch { ""companyName"": $s.company_name };"
797,Name the top 3 products with the lowest unit price in the 'Grains/Cereals' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Grains/Cereals'})
RETURN p.productName, p.unitPrice
ORDER BY p.unitPrice ASC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Grains/Cereals"";
part_of (product: $p, category: $c);
$p has unit_price $price;
sort $price asc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitPrice"": $price
};"
798,Identify the 3 suppliers with the highest number of products supplied to the 'Meat/Poultry' category.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)-[:PART_OF]->(c:Category {categoryName: 'Meat/Poultry'})
WITH s, COUNT(p) AS productCount
ORDER BY productCount DESC
LIMIT 3
RETURN s.companyName AS supplierName, productCount","match
$s isa supplier;
$p isa product;
$c isa category, has category_name ""Meat/Poultry"";
supplies (supplier: $s, product: $p);
part_of (product: $p, category: $c);
reduce $product_count = count($p) groupby $s;
sort $product_count desc;
limit 3;
fetch {
  ""supplierName"": $s.company_name,
  ""productCount"": $product_count
};"
799,List the 3 suppliers who supply the most products that have been discontinued.,"MATCH (s:Supplier)-[:SUPPLIES]->(p:Product)
WHERE p.discontinued = true
WITH s, COUNT(p) AS discontinuedProducts
ORDER BY discontinuedProducts DESC
LIMIT 3
RETURN s.companyName AS Supplier, discontinuedProducts","match
$s isa supplier;
$p isa product, has discontinued true;
supplies (supplier: $s, product: $p);
reduce $count = count($p) groupby $s;
sort $count desc;
limit 3;
fetch {
  ""Supplier"": $s.company_name,
  ""discontinuedProducts"": $count
};"
800,Identify the 3 customers with the most orders placed.,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WITH c, COUNT(o) AS orderCount
ORDER BY orderCount DESC
LIMIT 3
RETURN c.customerID, c.companyName, orderCount","match
$c isa customer;
purchased (customer: $c, order: $o);
reduce $order_count = count($o) groupby $c;
sort $order_count desc;
limit 3;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""orderCount"": $order_count
};"
801,What are the top 5 products that have a reorder level above 20?,"MATCH (p:Product)
WHERE p.reorderLevel > 20
RETURN p.productName, p.reorderLevel
ORDER BY p.reorderLevel DESC
LIMIT 5","match
$p isa product, has reorder_level $rl;
$rl > 20;
sort $rl desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""reorderLevel"": $rl
};"
802,Find the 5 most recent orders by ship date.,"MATCH (o:Order)
RETURN o.orderID, o.shippedDate
ORDER BY o.shippedDate DESC
LIMIT 5","match
$o isa order, has shipped_date $sd;
sort $sd desc;
limit 5;
fetch {
  ""orderID"": $o.order_id,
  ""shippedDate"": $sd
};"
803,Which 3 customers have ordered the most units of any product?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)-[r:ORDERS]->(p:Product)
RETURN c.companyName AS customer, SUM(r.quantity) AS totalUnitsOrdered
ORDER BY totalUnitsOrdered DESC
LIMIT 3","match
$c isa customer;
purchased (customer: $c, order: $o);
$rel isa orders (order: $o, product: $p);
$rel has quantity $q;
reduce $total = sum($q) groupby $c;
sort $total desc;
limit 3;
fetch { ""customer"": $c.company_name, ""totalUnitsOrdered"": $total };"
804,List the top 3 products with the highest units in stock in the 'Confections' category.,"MATCH (p:Product)-[:PART_OF]->(c:Category {categoryName: 'Confections'})
RETURN p.productName, p.unitsInStock
ORDER BY p.unitsInStock DESC
LIMIT 3","match
$p isa product;
$c isa category, has category_name ""Confections"";
part_of (product: $p, category: $c);
$p has units_in_stock $stock;
sort $stock desc;
limit 3;
fetch {
  ""productName"": $p.product_name,
  ""unitsInStock"": $stock
};"
805,Which 5 products have the highest units on order and are still active (not discontinued)?,"MATCH (p:Product)
WHERE p.discontinued = false
RETURN p.productName, p.unitsOnOrder
ORDER BY p.unitsOnOrder DESC
LIMIT 5","match
$p isa product, has discontinued false, has units_on_order $units;
sort $units desc;
limit 5;
fetch {
  ""productName"": $p.product_name,
  ""unitsOnOrder"": $units
};"
806,What are the first 3 customers who have purchased orders shipped to France?,"MATCH (c:Customer)-[:PURCHASED]->(o:Order)
WHERE o.shipCountry = 'France'
RETURN c.customerID, c.companyName, c.contactName
LIMIT 3","match
$c isa customer;
$o isa order, has ship_country ""France"";
purchased (customer: $c, order: $o);
limit 3;
fetch {
  ""customerID"": $c.customer_id,
  ""companyName"": $c.company_name,
  ""contactName"": $c.contact_name
};"
