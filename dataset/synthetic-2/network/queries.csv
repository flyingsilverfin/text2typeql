original_index,question,cypher,typeql
0,How many different types of software are running on machines in zone 4?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(:Interface)<-[:ROUTES]-(:Switch)<-[:HOLDS]-(r:Rack {zone: 4})-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Software)
RETURN COUNT(DISTINCT s.name) AS numberOfSoftwareTypes","match
$r isa rack, has zone 4;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $proc);
instance_of (running_instance: $proc, template: $s);
$s isa software, has name $n;
select $n;
distinct;
reduce $count = count($n);"
2,Identify the top 3 processes by PID that depend on the 'java' service.,"MATCH (p:Process)-[:DEPENDS_ON]->(s:Service {name: 'java'})
RETURN p.name AS processName, p.pid AS processPID
ORDER BY p.pid DESC
LIMIT 3","match
  $p isa process, has name $pn, has pid $pid;
  $s isa service, has name ""java"";
  depends_on (dependent: $p, dependency: $s);
sort $pid desc;
limit 3;
fetch {
  ""processName"": $pn,
  ""processPID"": $pid
};"
3,Which machines are running services that started after timestamp 1606597376483?,"MATCH (m:Machine)-[:RUNS]->(s:Service)
WHERE s.startTime > 1606597376483
RETURN m.name","match
$m isa machine;
$s isa service, has start_time $st;
runs (host_machine: $m, running_process: $s);
$st > 1606597376483;
fetch {
  ""name"": $m.name
};"
4,Which interfaces connect networks in zone 2 with those in zone 3?,"MATCH (n2:Network {zone: 2})-[:ROUTES]->(i1:Interface)-[:CONNECTS]->(i2:Interface)<-[:ROUTES]-(n3:Network {zone: 3})
RETURN i1.ip AS Interface1, i2.ip AS Interface2","match
  $n2 isa network, has zone 2;
  $n3 isa network, has zone 3;
  routes (routing_device: $n2, routed_interface: $i1);
  routes (routing_device: $n3, routed_interface: $i2);
  connects (interface: $i1, interface: $i2);
fetch {
  ""Interface1"": $i1.ip,
  ""Interface2"": $i2.ip
};"
5,List all the services and their start times on machines in rack 'DC1-RCK-1-10'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN service.name AS serviceName, service.startTime AS startTime","match
$rack isa rack, has name ""DC1-RCK-1-10"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service;
fetch {
  ""serviceName"": $service.name,
  ""startTime"": $service.start_time
};"
6,Which applications are listening on ports greater than 1024?,"MATCH (app:Application)-[:LISTENS]->(port:Port)
WHERE port.port > 1024
RETURN app.name AS ApplicationName","match
$app isa application, has name $app_name;
$port isa port, has port_number $pn;
listens (listening_process: $app, listened_port: $port);
$pn > 1024;
fetch {
  ""ApplicationName"": $app_name
};"
7,What are the dependencies for the process named '8966'?,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(dependency)
RETURN dependency","match
  $p isa process, has pid 8966;
  depends_on (dependent: $p, dependency: $dep);
  $dep has name $n;
fetch {
  ""dependency_name"": $n
};"
8,Which DataCenters contain the Router named 'DC1-RE'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-RE'})
RETURN dc.name","match
$dc isa data_center;
$r isa router, has name ""DC1-RE"";
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $dc.name
};"
9,List the first 3 Routers contained in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router;
limit 3;
fetch {
  ""name"": $r.name
};"
10,What are the names of all Racks in zone 1 of DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 1})
RETURN r.name","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 1;
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $r.name
};"
11,List all types of machines that have a CPU count of at least 8.,"MATCH (t:Type)
WHERE t.cpu >= 8
RETURN t.name AS machineType, t.cpu AS cpuCount","match
$t isa machine_type_spec, has cpu $c;
$c >= 8;
fetch {
  ""machineType"": $t.name,
  ""cpuCount"": $c
};"
12,Identify the first 3 Interfaces connected by the Router named 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3","match
$r isa router, has name ""DC1-R-1"";
$i isa interface;
routes (routing_device: $r, routed_interface: $i);
limit 3;
fetch {
  ""ip"": $i.ip
};"
13,List the software versions installed on machines that have type 'm'.,"MATCH (t:Type {type: 'm'})<-[:TYPE]-(m:Machine)-[:RUNS]->(s:Software)-[:VERSION]->(v:Version)
RETURN DISTINCT v.name AS SoftwareVersion","match
  $mt isa machine_type_spec, has machine_type ""m"";
  typed_as (machine: $m, spec: $mt);
  runs (host_machine: $m, running_process: $proc);
  instance_of (running_instance: $proc, template: $sw);
  $sw isa software;
  has_version (versioned_software: $sw, release_version: $v);
  $v has name $vname;
select $vname;
distinct;
fetch { ""SoftwareVersion"": $vname };"
14,Which applications are instances of software named 'RHEL' and run on machines in zone 1?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 1})-[:HOLDS]->(machine:Machine)-[:RUNS]->(app:Application),
      (machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN DISTINCT app.name","match
$rack isa rack, has zone 1;
$machine isa machine;
$app isa application;
$os isa os, has name ""RHEL"";
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
holds (containing_rack: $rack, held_equipment: $machine);
runs (host_machine: $machine, running_process: $app);
runs (host_machine: $machine, running_process: $os);
select $app;
distinct;
fetch {
  ""name"": $app.name
};"
15,What is the total number of dependencies for the 'logstash' application?,"MATCH (app:Application {name: 'logstash'})-[:DEPENDS_ON]->(dependency)
RETURN count(dependency) AS totalDependencies","match
$app isa application, has name ""logstash"";
depends_on (dependent: $app, dependency: $dep);
reduce $totalDependencies = count($dep);"
16,Identify all machines with a disk size greater than 256 GB in zone 4.,"MATCH (m:Machine)-[:TYPE]->(t:Type), (m)-[:ROUTES]->(i:Interface), (i)-[:ROUTES]->(z:Zone)
WHERE t.disk > 256 AND z.zone = 4
RETURN m.name","match
$m isa machine, has name $mn;
$t isa machine_type_spec, has disk $d;
$d > 256;
typed_as (machine: $m, spec: $t);
routes (routing_device: $m, routed_interface: $i);
$nz isa network_zone, has zone $z;
$z == 4;
routes (routing_device: $nz, routed_interface: $i);
fetch {
  ""name"": $mn
};"
17,What are the IP addresses of Interfaces routed by Network '10.1'?,"MATCH (n:Network {ip: '10.1'})--[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$n isa network, has ip ""10.1"";
routes (routing_device: $n, routed_interface: $i);
$i isa interface, has ip $ip;
fetch {
  ""InterfaceIP"": $ip
};"
18,Which services listen to port 443 and are instances of 'java'?,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 443}),
      (s)-[:INSTANCE]->(:Application {name: 'java'})
RETURN s.name","match
$s isa service;
$p isa port, has port_number 443;
listens (listening_process: $s, listened_port: $p);
$a isa application, has name ""java"";
instance_of (running_instance: $s, template: $a);
fetch {
  ""name"": $s.name
};"
19,How many machines are in the 'DC1' DataCenter's zone 2?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack {zone: 2})-[:HOLDS]->(machine:Machine)
RETURN count(machine) AS numberOfMachines","match
$dc isa data_center, has name ""DC1"";
$rack isa rack, has zone 2;
dc_contains (data_center: $dc, contained_equipment: $rack);
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
reduce $count = count($machine);"
20,What types of machines are in zone 3 and have more than 16 GB RAM?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
WHERE r.zone = 3 AND t.ram > 16
RETURN DISTINCT t.type AS machineType","match
$r isa rack, has zone 3;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has ram $ram;
$ram > 16;
$t has machine_type $mt;
select $mt;
distinct;
fetch { ""machineType"": $mt };"
21,List the first 5 network IPs in zone 1.,"MATCH (n:Network)
WHERE n.zone = 1
RETURN n.ip
LIMIT 5","match
$n isa network, has zone 1;
limit 5;
fetch {
  ""ip"": $n.ip
};"
22,Which racks contain switches with IP starting with '10.1'?,"MATCH (rack:Rack)-[:HOLDS]->(switch:Switch)
WHERE switch.ip STARTS WITH '10.1'
RETURN rack.name","match
$rack isa rack;
$switch isa switch, has ip $ip;
$ip like ""10.1.*"";
holds (containing_rack: $rack, held_equipment: $switch);
fetch {
  ""rack_name"": $rack.name
};"
23,How many applications depend on the 'crm' service?,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'crm'})
RETURN count(app) AS numberOfApplications","match
$service isa service, has name ""crm"";
depends_on (dependent: $app, dependency: $service);
$app isa application;
reduce $count = count($app);"
24,What are the IP addresses for switches in zone 2's rack 3?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 2, rack: 3})-[:HOLDS]->(switch:Switch)
RETURN switch.ip AS switch_ip","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has zone 2, has rack_number 3;
holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
fetch {
  ""switch_ip"": $switch.ip
};"
25,Identify machines that run an OS started at or after timestamp 1606165629748.,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.startTime >= 1606165629748
RETURN m.name","match
$m isa machine;
$os isa os, has start_time $st;
runs (host_machine: $m, running_process: $os);
$st >= 1606165629748;
fetch {
  ""name"": $m.name
};"
26,List all machines that have a type 'xl' in the 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type {type: 'xl'})
RETURN machine.name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec, has machine_type ""xl"";
fetch {
  ""machine_name"": $machine.name
};"
27,Which ports are used by processes on the machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)-[:LISTENS]->(port:Port)
RETURN port.port AS used_ports","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $p);
$p isa process;
listens (listening_process: $p, listened_port: $port);
fetch {
  ""used_ports"": $port.port_number
};"
28,What are the applications that depend on the 'webapp' software?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependentApp:Application)
RETURN dependentApp.name","match
  $sw isa software, has name ""webapp"";
  depends_on (dependent: $app, dependency: $sw);
  $app isa application;
fetch {
  ""name"": $app.name
};"
29,Which services are instances of the 'cms' application?,"MATCH (app:Application {name: 'cms'})-[:INSTANCE]->(service:Service)
RETURN service.name","match
$app isa application, has name ""cms"";
instance_of (template: $app, running_instance: $service);
$service isa service;
fetch {
  ""name"": $service.name
};"
30,List all processes that are instances of the 'RHEL' OS.,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)<-[:INSTANCE]-(process:Process)
RETURN process.name, process.startTime, process.pid","match
  $os isa os, has name ""RHEL"";
  instance_of (running_instance: $os, template: $version);
  $version isa version;
  instance_of (running_instance: $process, template: $version);
  $process isa process;
fetch {
  ""name"": $process.name,
  ""start_time"": $process.start_time,
  ""pid"": $process.pid
};"
32,Which versions of software are dependencies for the 'webapp' application in zone 2?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(software:Software)-[:VERSION]->(version:Version),
      (machine:Machine)-[:RUNS]->(app),
      (rack:Rack)-[:HOLDS]->(machine)
WHERE rack.zone = 2
RETURN DISTINCT version.name AS Version","match
$app isa application, has name ""webapp"";
depends_on (dependent: $app, dependency: $software);
$software isa software;
has_version (versioned_software: $software, release_version: $version);
$version has name $vname;
runs (host_machine: $machine, running_process: $app);
holds (containing_rack: $rack, held_equipment: $machine);
$rack has zone 2;
select $vname;
distinct;
fetch { ""Version"": $vname };"
33,What are the names of all services started on machines in zone 1?,"MATCH (z:Zone {zone: 1})-[:ROUTES]->(:Interface)<-[:ROUTES]-(:Machine)-[:RUNS]->(s:Service)
RETURN s.name","match
  $z isa network_zone, has zone 1;
  routes (routing_device: $z, routed_interface: $i);
  routes (routing_device: $m, routed_interface: $i);
  $m isa machine;
  runs (host_machine: $m, running_process: $s);
  $s isa service;
fetch {
  ""name"": $s.name
};"
34,Name the first 3 Machines held in Rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)
RETURN machine.name
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
limit 3;
fetch {
  ""name"": $machine.name
};"
35,What are the IPs of Switches located in Rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(switch:Switch)
RETURN switch.ip AS switch_ip","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$switch isa switch;
holds (containing_rack: $rack, held_equipment: $switch);
fetch {
  ""switch_ip"": $switch.ip
};"
36,List all Switches in racks with zone 3.,"MATCH (r:Rack {zone: 3})-[:HOLDS]->(s:Switch)
RETURN s","match
$r isa rack, has zone 3;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
fetch {
  ""switch_ip"": $s.ip,
  ""switch_rack_number"": $s.rack_number
};"
37,Which Machines are running OS named 'RHEL' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name AS MachineName","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $os);
$os isa os, has name ""RHEL"";
fetch {
  ""MachineName"": $m.name
};"
38,List the first 3 Services instance of Application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(service:Service)
RETURN service
LIMIT 3","match
$app isa application, has name ""webapp"";
$service isa service;
instance_of (template: $app, running_instance: $service);
limit 3;
fetch {
  ""service_name"": $service.name,
  ""service_start_time"": $service.start_time,
  ""service_pid"": $service.pid
};"
39,Name the top 3 Applications that depend on Process '8966'.,"MATCH (p:Process {pid: 8966})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name AS application_name
ORDER BY a.startTime DESC
LIMIT 3","match
$p isa process, has pid 8966;
$a isa application, has start_time $st;
depends_on (dependent: $a, dependency: $p);
sort $st desc;
limit 3;
fetch {
  ""application_name"": $a.name
};"
40,What previous versions are linked to version '7.1'?,"MATCH (v:Version {name: '7.1'})−[:PREVIOUS]−>(prev:Version)
RETURN prev.name AS previous_versions","match
  $v isa version, has name ""7.1"";
  previous (newer_version: $v, older_version: $prev);
  $prev has name $prev_name;
fetch {
  ""previous_versions"": $prev_name
};"
41,List the first 3 Interfaces routed by Egress 'DC1-RE'.,"MATCH (e:Egress {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i
LIMIT 3","match
$e isa egress, has name ""DC1-RE"";
routes (routing_device: $e, routed_interface: $i);
$i isa interface;
limit 3;
fetch {
  ""ip"": $i.ip
};"
42,Which Racks are in zone 2 of DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 2})
RETURN r.name AS RackName","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 2;
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""RackName"": $r.name
};"
43,Identify the top 3 Types of Machines in terms of RAM capacity in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS TypeName, t.ram AS RAM
ORDER BY t.ram DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has name $tn, has ram $r;
sort $r desc;
limit 3;
fetch {
  ""TypeName"": $tn,
  ""RAM"": $r
};"
44,What are the IP addresses of Interfaces connected by Router 'DC1-R-2'?,"MATCH (router:Router {name: 'DC1-R-2'})-[:ROUTES]->(interface:Interface)
RETURN interface.ip AS ip_addresses","match
$router isa router, has name ""DC1-R-2"";
routes (routing_device: $router, routed_interface: $interface);
$interface isa interface;
fetch {
  ""ip_addresses"": $interface.ip
};"
45,Name the first 3 Machines that run version '7.1' of any Software.,"MATCH (m:Machine)-[:RUNS]->(:Software)-[:VERSION]->(v:Version {name: '7.1'})
RETURN m.name
LIMIT 3","match
$m isa machine, has name $n;
runs (host_machine: $m, running_process: $proc);
instance_of (running_instance: $proc, template: $sw);
$sw isa software;
has_version (versioned_software: $sw, release_version: $v);
$v isa version, has name ""7.1"";
limit 3;
fetch {
  ""name"": $n
};"
46,"What DataCenters are located in Iceland, Reykjavik?","MATCH (dc:DataCenter {location: 'Iceland, Rekjavik'})
RETURN dc.name","match
$dc isa data_center, has location ""Iceland, Rekjavik"";
fetch {
  ""name"": $dc.name
};"
47,Which Routers are located in zone 1?,"MATCH (r:Router)
WHERE r.zone = 1
RETURN r.name","match
$r isa router, has zone 1;
fetch {
  ""name"": $r.name
};"
48,List the first 3 Racks in zone 2.,"MATCH (r:Rack)
WHERE r.zone = 2
RETURN r.name
LIMIT 3","match
$r isa rack, has zone 2;
limit 3;
fetch {
  ""name"": $r.name
};"
49,What is the IP of the Interface connected to the Egress 'DC1-RE'?,"MATCH (e:Egress {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$e isa egress, has name ""DC1-RE"";
routes (routing_device: $e, routed_interface: $i);
fetch {
  ""InterfaceIP"": $i.ip
};"
50,Which Network routes through the Interface with IP '10.4.8.254'?,"MATCH (i:Interface {ip: '10.4.8.254'})&lt;-[:ROUTES]-(n:Network)
RETURN n.ip AS network_ip","match
$i isa interface, has ip ""10.4.8.254"";
routes (routing_device: $n, routed_interface: $i);
$n isa network, has ip $network_ip;
fetch {
  ""network_ip"": $network_ip
};"
51,Name the top 5 Machines held in Rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)
RETURN machine.name
LIMIT 5","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$machine isa machine;
holds (containing_rack: $rack, held_equipment: $machine);
limit 5;
fetch {
  ""name"": $machine.name
};"
52,Identify the first 3 Ports exposed by Interface with IP '10.1.1.1'.,"MATCH (i:Interface {ip: '10.1.1.1'})-[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3","match
$i isa interface, has ip ""10.1.1.1"";
exposes (exposing_interface: $i, exposed_port: $p);
limit 3;
fetch {
  ""port"": $p.port_number
};"
53,Which type of Machines are located in Rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec;
fetch {
  ""type_name"": $type.name,
  ""machine_type"": $type.machine_type
};"
54,What are the IPs of Interfaces connected to each other within zone 4?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i1:Interface)-[:CONNECTS]->(i2:Interface)
RETURN i1.ip AS Interface1_IP, i2.ip AS Interface2_IP","match
  $z isa network_zone, has zone 4;
  routes (routing_device: $z, routed_interface: $i1);
  $i1 isa interface;
  connects (interface: $i1, interface: $i2);
  $i2 isa interface;
fetch {
  ""Interface1_IP"": $i1.ip,
  ""Interface2_IP"": $i2.ip
};"
55,Which Processes in DataCenter 'DC1' depend on the Process named '8966'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process {pid: 8966})
MATCH (dependentProcess:Process)-[:DEPENDS_ON]->(p)
RETURN dependentProcess","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $p);
$p isa process, has pid 8966;
depends_on (dependent: $dep, dependency: $p);
$dep isa process;
fetch {
  ""dependent_process"": $dep
};"
56,What are the IPs of the top 3 Interfaces exposed to Port 80?,"MATCH (i:Interface)-[:EXPOSES]->(p:Port {port: 80})
RETURN i.ip
ORDER BY i.ip
LIMIT 3","match
$i isa interface, has ip $ip;
$p isa port, has port_number 80;
exposes (exposing_interface: $i, exposed_port: $p);
sort $ip;
limit 3;
fetch {
  ""ip"": $ip
};"
57,Identify the first 3 Applications running on Machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name
ORDER BY a.startTime
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$a isa application, has start_time $st;
runs (host_machine: $m, running_process: $a);
sort $st;
limit 3;
fetch {
  ""name"": $a.name
};"
58,Which OS instances are running on the Machines in Rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(os:OS)
RETURN os.name, os.startTime","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $os);
$os isa os;
fetch {
  ""os_name"": $os.name,
  ""os_start_time"": $os.start_time
};"
59,Name the first 3 Processes run by Machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN p.name
ORDER BY p.startTime
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $p);
$p isa process, has start_time $st;
sort $st;
limit 3;
fetch {
  ""name"": $p.name
};"
60,What are the dependencies of the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
61,List the first 3 Services running on Machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
RETURN s.name
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$s isa service, has name $sn;
runs (host_machine: $m, running_process: $s);
limit 3;
fetch {
  ""name"": $sn
};"
62,Which Applications listen on Port 8080?,"MATCH (p:Port {port: 8080})<-[:LISTENS]-(a:Application)
RETURN a.name","match
$p isa port, has port_number 8080;
listens (listening_process: $a, listened_port: $p);
$a isa application;
fetch {
  ""name"": $a.name
};"
63,Identify the first 3 Applications dependent on the Service 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name
LIMIT 3","match
$s isa service, has name ""java"";
$a isa application, has name $name;
depends_on (dependent: $a, dependency: $s);
limit 3;
fetch {
  ""name"": $name
};"
64,Which versions of Software 'RHEL' are currently used in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})-[:INSTANCE]->(v:Version)
RETURN DISTINCT v.name AS Version","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $os);
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $v);
$v isa version;
select $v;
distinct;
fetch { ""Version"": $v.name };"
65,Name the first 3 Software instances that depend on version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:DEPENDS_ON]-(s:Software)
RETURN s.name
LIMIT 3","match
  $v isa version, has name ""7.1"";
  depends_on (dependent: $s, dependency: $v);
  $s isa software, has name $n;
limit 3;
fetch {
  ""name"": $n
};"
66,What are the first 3 previous versions of Version '7.1'?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
previous (newer_version: $v, older_version: $v1);
try {
  previous (newer_version: $v1, older_version: $v2);
  try {
    previous (newer_version: $v2, older_version: $v3);
  };
};
fetch {
  ""prev_version_1"": $v1.name,
  ""prev_version_2"": $v2.name,
  ""prev_version_3"": $v3.name
};"
67,List the top 5 processes dependent on Service 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime DESC
LIMIT 5","match
$s isa service, has name ""java"";
$p isa process, has name $pn, has start_time $st, has pid $pid;
depends_on (dependent: $p, dependency: $s);
sort $st desc;
limit 5;
fetch {
  ""name"": $pn,
  ""start_time"": $st,
  ""pid"": $pid
};"
68,Which Machines in DataCenter 'DC1' are running an Application named 'webserver'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(machine:Machine)-[:RUNS]->(app:Application {name: 'webserver'})
RETURN machine.name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine, has name $machine_name;
runs (host_machine: $machine, running_process: $app);
$app isa application, has name ""webserver"";
fetch {
  ""machine_name"": $machine_name
};"
69,Identify the first 3 Services listening on Port 443.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 443})
RETURN s.name, s.startTime, s.pid
ORDER BY s.startTime
LIMIT 3","match
$s isa service, has name $sn, has start_time $st, has pid $sp;
$p isa port, has port_number 443;
listens (listening_process: $s, listened_port: $p);
sort $st asc;
limit 3;
fetch {
  ""name"": $sn,
  ""start_time"": $st,
  ""pid"": $sp
};"
70,What are the first 3 Processes that listen on Port 25 and their start times?,"MATCH (p:Process)-[:LISTENS]->(port:Port {port: 25})
RETURN p.name AS processName, p.startTime AS startTime
ORDER BY p.startTime
LIMIT 3","match
$p isa process, has name $name, has start_time $st;
$port isa port, has port_number 25;
listens (listening_process: $p, listened_port: $port);
sort $st asc;
limit 3;
fetch {
  ""processName"": $name,
  ""startTime"": $st
};"
71,List the top 3 Machines that route Interfaces to Network '10.4'.,"MATCH (n:Network {ip: '10.4'})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)
RETURN m.name AS machine_name, COUNT(i) AS interface_count
ORDER BY interface_count DESC
LIMIT 3","match
  $n isa network, has ip ""10.4"";
  routes (routing_device: $n, routed_interface: $i);
  $m isa machine;
  routes (routing_device: $m, routed_interface: $i);
reduce $count = count($i) groupby $m;
sort $count desc;
limit 3;
fetch { ""machine_name"": $m.name, ""interface_count"": $count };"
72,List all software that depends on version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:DEPENDS_ON]-(s:Software)
RETURN s.name","match
$v isa version, has name ""7.1"";
$s isa software;
depends_on (dependent: $s, dependency: $v);
fetch {
  ""name"": $s.name
};"
73,What are the first 3 interfaces that connect to the network with IP '10.4'?,"MATCH (n:Network {ip: '10.4'})−[:ROUTES]−>(i:Interface)
RETURN i
LIMIT 3","match
  $n isa network, has ip ""10.4"";
  routes (routing_device: $n, routed_interface: $i);
  $i isa interface;
limit 3;
fetch {
  ""ip"": $i.ip
};"
74,Which processes are running on machines that run the 'webserver' application?,"MATCH (app:Application {name: 'webserver'})<-[:RUNS]-(machine:Machine)-[:RUNS]->(process:Process)
RETURN process.name AS processName, process.startTime AS processStartTime, process.pid AS processPID","match
  $app isa application, has name ""webserver"";
  runs (host_machine: $machine, running_process: $app);
  $process isa process;
  runs (host_machine: $machine, running_process: $process);
fetch {
  ""processName"": $process.name,
  ""processStartTime"": $process.start_time,
  ""processPID"": $process.pid
};"
75,What are the first 3 ports that the process with PID 8966 listens to?,"MATCH (p:Process {pid: 8966})-[:LISTENS]->(port:Port)
RETURN port.port
ORDER BY port.port
LIMIT 3","match
$p isa process, has pid 8966;
listens (listening_process: $p, listened_port: $port);
$port has port_number $pn;
sort $pn;
limit 3;
fetch {
  ""port"": $pn
};"
76,Which 3 interfaces are connected to each other in zone 1?,"MATCH (z:Zone {zone: 1})-[:ROUTES]->(i1:Interface)-[:CONNECTS]->(i2:Interface)-[:CONNECTS]->(i3:Interface)-[:CONNECTS]->(i1)
RETURN i1.ip AS Interface1, i2.ip AS Interface2, i3.ip AS Interface3
LIMIT 3","match
$z isa network_zone, has zone 1;
routes (routing_device: $z, routed_interface: $i1);
$i1 isa interface;
connects (interface: $i1, interface: $i2);
$i2 isa interface;
connects (interface: $i2, interface: $i3);
$i3 isa interface;
connects (interface: $i3, interface: $i1);
limit 3;
fetch {
  ""Interface1"": $i1.ip,
  ""Interface2"": $i2.ip,
  ""Interface3"": $i3.ip
};"
77,List the first 3 machines that route to the interface with IP '10.1.1'.,"MATCH (i:Interface {ip: '10.1.1'})<-[:ROUTES]-(m:Machine)
RETURN m.name
LIMIT 3","match
$i isa interface, has ip ""10.1.1"";
$m isa machine;
routes (routing_device: $m, routed_interface: $i);
limit 3;
fetch {
  ""name"": $m.name
};"
78,Which 3 applications are instances of the software 'webapp'?,"MATCH (s:Software {name: 'webapp'})-[:INSTANCE]->(a:Application)
RETURN a.name
LIMIT 3","match
$s isa software, has name ""webapp"";
$a isa application;
instance_of (running_instance: $a, template: $s);
limit 3;
fetch {
  ""name"": $a.name
};"
79,What are the top 3 services that depend on the process named '8966'?,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(s:Service)
RETURN s.name AS service_name, COUNT(*) AS dependency_count
ORDER BY dependency_count DESC
LIMIT 3","match
$p isa process, has pid 8966;
$d isa depends_on (dependent: $p, dependency: $s);
$s isa service, has name $sn;
reduce $count = count($d) groupby $s, $sn;
sort $count desc;
limit 3;
fetch {
  ""service_name"": $sn,
  ""dependency_count"": $count
};"
80,Name the first 3 types of machines in Rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec;
limit 3;
fetch {
  ""type_name"": $type.name
};"
81,Which 3 machines in DataCenter 'DC1' are of type 'm-4/16/25'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {name: 'm-4/16/25'})
RETURN m.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has name ""m-4/16/25"";
limit 3;
fetch {
  ""name"": $m.name
};"
82,What are the top 3 applications that depend on the process '8966'?,"MATCH (p:Process {pid: 8966})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name AS application, COUNT(*) AS dependency_count
ORDER BY dependency_count DESC
LIMIT 3","match
$p isa process, has pid 8966;
$a isa application, has name $n;
$rel isa depends_on (dependent: $a, dependency: $p);
reduce $count = count($rel) groupby $n;
sort $count desc;
limit 3;"
83,Which 3 machines run OS named 'RHEL' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $os);
$os isa os, has name ""RHEL"";
limit 3;
fetch {
  ""name"": $m.name
};"
84,What are the first 3 services running on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
RETURN s.name
ORDER BY s.startTime
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$s isa service, has start_time $st;
runs (host_machine: $m, running_process: $s);
sort $st asc;
limit 3;
fetch {
  ""name"": $s.name
};"
85,Which 3 racks in DataCenter 'DC1' contain switches of type 's-2/4/5'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(switch:Switch),
      (rack)-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type {name: 's-2/4/5'})
RETURN DISTINCT rack.name
LIMIT 3","match
  $dc isa data_center, has name ""DC1"";
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack, has name $rn;
  holds (containing_rack: $rack, held_equipment: $sw);
  $sw isa switch;
  holds (containing_rack: $rack, held_equipment: $m);
  $m isa machine;
  typed_as (machine: $m, spec: $ts);
  $ts isa machine_type_spec, has name ""s-2/4/5"";
select $rn;
distinct;
limit 3;
fetch { ""rack_name"": $rn };"
86,Name the first 3 interfaces that connect to the network with IP '10.2'.,"MATCH (network:Network {ip: '10.2'})-[:ROUTES]->(interface:Interface)
RETURN interface.ip
LIMIT 3","match
$network isa network, has ip ""10.2"";
routes (routing_device: $network, routed_interface: $interface);
$interface isa interface;
limit 3;
fetch {
  ""ip"": $interface.ip
};"
87,What are the top 3 ports listened to by the process with PID 8966?,"MATCH (p:Process {pid: 8966})-[:LISTENS]->(port:Port)
RETURN port.port AS Port, COUNT(*) AS Frequency
ORDER BY Frequency DESC
LIMIT 3","match
$p isa process, has pid 8966;
$port isa port, has port_number $pn;
$rel isa listens (listening_process: $p, listened_port: $port);
reduce $count = count($rel) groupby $port, $pn;
sort $count desc;
limit 3;
fetch { ""Port"": $pn, ""Frequency"": $count };"
88,List the first 3 previous versions of version '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
$prev isa version, has name $prev_name;
{
  previous (newer_version: $v, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid1);
  previous (newer_version: $mid1, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid2a);
  previous (newer_version: $mid2a, older_version: $mid2b);
  previous (newer_version: $mid2b, older_version: $prev);
};
limit 3;
fetch { ""prev_name"": $prev_name };"
89,List the first 3 dependencies of the application 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(dep)
RETURN dep.name
LIMIT 3","match
$app isa application, has name ""webserver"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
limit 3;
fetch {
  ""dep_name"": $dep_name
};"
90,List the first 3 processes dependent on the service named 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p.name, p.startTime, p.pid
LIMIT 3","match
$s isa service, has name ""java"";
$p isa process, has name $pname, has start_time $st, has pid $pid;
depends_on (dependent: $p, dependency: $s);
limit 3;
fetch {
  ""name"": $pname,
  ""startTime"": $st,
  ""pid"": $pid
};"
91,What are the top 3 applications running on machines in zone 4?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 4})-[:HOLDS]->(machine:Machine)-[:RUNS]->(app:Application)
RETURN app.name, COUNT(app) AS app_count
ORDER BY app_count DESC
LIMIT 3","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has zone 4;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application, has name $app_name;
reduce $app_count = count($app) groupby $app_name;
sort $app_count desc;
limit 3;
fetch { ""name"": $app_name, ""app_count"": $app_count };"
92,Name the first 3 interfaces exposed by Port 80.,"MATCH (p:Port {port: 80})<-[:EXPOSES]-(i:Interface)
RETURN i.ip
LIMIT 3","match
$p isa port, has port_number 80;
exposes (exposing_interface: $i, exposed_port: $p);
limit 3;
fetch { ""ip"": $i.ip };"
93,What are the names of the top 3 routers in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name
ORDER BY r.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router, has name $n;
sort $n;
limit 3;
fetch { ""name"": $n };"
94,List the first 3 software dependencies for the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(d)
RETURN d.name
LIMIT 3","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $d);
$d has name $dn;
limit 3;
fetch {
  ""name"": $dn
};"
95,Which 3 machines are running the application named 'webserver' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN m.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $a);
$a isa application, has name ""webserver"";
limit 3;
fetch {
  ""name"": $m.name
};"
96,Name the first 3 types of machines held in Rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec, has name $tn;
limit 3;
fetch { ""type_name"": $tn };"
97,What are the top 5 IP addresses of interfaces connected to the router 'DC1-R-1'?,"MATCH (router:Router {name: 'DC1-R-1'})-[:ROUTES]->(interface:Interface)
RETURN interface.ip
LIMIT 5","match
  $router isa router, has name ""DC1-R-1"";
  routes (routing_device: $router, routed_interface: $interface);
limit 5;
fetch {
  ""ip"": $interface.ip
};"
98,List the first 3 networks connected to the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})&lt;-[:ROUTES]-(n:Network)
RETURN n.ip
LIMIT 3","match
$i isa interface, has ip ""10.0.0.254"";
$n isa network, has ip $nip;
routes (routing_device: $n, routed_interface: $i);
limit 3;
fetch {
  ""network_ip"": $nip
};"
99,Which 3 processes are running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN p.name AS process_name, p.startTime AS start_time, p.pid AS process_id
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$p isa process;
runs (host_machine: $m, running_process: $p);
limit 3;
fetch {
  ""process_name"": $p.name,
  ""start_time"": $p.start_time,
  ""process_id"": $p.pid
};"
100,What are the first 3 previous versions of the software named '7.1'?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
{
  previous (newer_version: $v, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $a);
  previous (newer_version: $a, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $b);
  previous (newer_version: $b, older_version: $c);
  previous (newer_version: $c, older_version: $prev);
};
$prev has name $n;
limit 3;
fetch { ""name"": $n };"
101,Which 3 versions of software does the OS named 'RHEL' have instances of?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)
RETURN version.name
LIMIT 3","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $version);
$version isa version;
limit 3;
fetch {
  ""version_name"": $version.name
};"
102,What are the top 3 ports listened to by the application 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:LISTENS]->(port:Port)
RETURN port.port AS port, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$app isa application, has name ""webserver"";
$port isa port, has port_number $pn;
listens (listening_process: $app, listened_port: $port);
reduce $frequency = count groupby $pn;
sort $frequency desc;
limit 3;"
103,Which 3 services are instances of the software 'RHEL'?,"MATCH (s:Service)-[:INSTANCE]->(sw:Software {name: 'RHEL'})
RETURN s.name
LIMIT 3","match
$s isa service, has name $sn;
$sw isa software, has name ""RHEL"";
instance_of (running_instance: $s, template: $sw);
limit 3;
fetch { ""name"": $sn };"
104,Name the first 3 applications that depend on the service named 'java'.,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name
LIMIT 3","match
$s isa service, has name ""java"";
$a isa application, has name $n;
depends_on (dependent: $a, dependency: $s);
limit 3;
fetch { ""name"": $n };"
105,What are the top 3 zones by IP address in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(z:Zone)
RETURN z.zone AS zone, z.ip AS ip_address
ORDER BY z.ip
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router;
routes (routing_device: $r, routed_interface: $i);
routes (routing_device: $z, routed_interface: $i);
$z isa network_zone, has ip $ip, has zone $zone;
sort $ip;
limit 3;
fetch { ""zone"": $zone, ""ip_address"": $ip };"
106,List the first 3 racks contained in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
limit 3;
fetch {
  ""name"": $rack.name
};"
107,Which 3 switches are held in Rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(switch:Switch)
RETURN switch.ip
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$switch isa switch, has ip $ip;
holds (containing_rack: $rack, held_equipment: $switch);
limit 3;
fetch {
  ""switch_ip"": $ip
};"
108,Which 3 applications are instances of the application 'crm'?,"MATCH (a:Application {name: 'crm'})-[:INSTANCE]->(instance:Application)
RETURN instance.name
LIMIT 3","match
$a isa application, has name ""crm"";
$instance isa application, has name $name;
instance_of (template: $a, running_instance: $instance);
limit 3;
fetch {
  ""name"": $name
};"
109,What are the first 3 services that depend on the version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(s:Service)
RETURN s.name
LIMIT 3","match
$v isa version, has name ""7.1"";
$s isa service, has name $n;
instance_of (running_instance: $s, template: $v);
limit 3;
fetch { ""name"": $n };"
110,Name the top 3 processes that are instances of the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(p:Process)
RETURN p.name AS processName, p.startTime AS startTime
ORDER BY p.startTime DESC
LIMIT 3","match
$s isa software, has name ""RHEL"";
instance_of (template: $s, running_instance: $p);
$p isa process, has name $pn, has start_time $st;
sort $st desc;
limit 3;
fetch {
  ""processName"": $pn,
  ""startTime"": $st
};"
111,List the first 3 machines that run services in zone 2.,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 2})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN machine.name
LIMIT 3","match
  $rack isa rack, has zone 2;
  holds (containing_rack: $rack, held_equipment: $machine);
  $machine isa machine;
  runs (host_machine: $machine, running_process: $service);
  $service isa service;
limit 3;
fetch {
  ""machine_name"": $machine.name
};"
112,How many zones are there in the 'DC1' DataCenter?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN COUNT(DISTINCT r.zone) AS numberOfZones","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router, has zone $z;
select $z;
distinct;
reduce $count = count;"
113,What are the IP addresses for interfaces connected to 'DC1-R-1' router?,"MATCH (router:Router {name: 'DC1-R-1'})-[:ROUTES]->(interface:Interface)
RETURN interface.ip AS ip_addresses","match
$router isa router, has name ""DC1-R-1"";
routes (routing_device: $router, routed_interface: $interface);
$interface isa interface;
fetch {
  ""ip_addresses"": $interface.ip
};"
114,Which ports are exposed by the interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
$p isa port;
fetch {
  ""exposed_ports"": $p.port_number
};"
115,Name the routers that are in zone 1 within 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router {zone: 1})
RETURN r.name","match
$dc isa data_center, has name ""DC1"";
$r isa router, has zone 1;
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $r.name
};"
116,Which egress routers are available in the 'DC1' DataCenter?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name AS EgressRouter","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $e);
$e isa egress;
fetch {
  ""EgressRouter"": $e.name
};"
117,List all racks contained within the 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack.name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
fetch {
  ""rack_name"": $rack.name
};"
118,Which type of machines are held in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name AS machineType","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec;
fetch {
  ""machineType"": $type.machine_type
};"
119,What software versions are available for 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v has name $version;
fetch {
  ""version"": $version
};"
120,What are the dependencies for the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(d)
RETURN d.name AS DependencyName","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $d);
$d has name $n;
fetch {
  ""DependencyName"": $n
};"
121,Which applications are running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$a isa application;
runs (host_machine: $m, running_process: $a);
fetch {
  ""name"": $a.name
};"
122,List the services running on machines in rack 'DC1-RCK-1-10'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN service.name","match
$rack isa rack, has name ""DC1-RCK-1-10"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service;
fetch {
  ""name"": $service.name
};"
123,Which switches are located in rack with name 'DC1-RCK-2-3'?,"MATCH (rack:Rack {name: 'DC1-RCK-2-3'})-[:HOLDS]->(switch:Switch)
RETURN switch","match
$rack isa rack, has name ""DC1-RCK-2-3"";
holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
fetch {
  ""switch_ip"": $switch.ip,
  ""switch_rack_number"": $switch.rack_number
};"
124,How many interfaces are connected to the network with IP '10.3'?,"MATCH (n:Network {ip: '10.3'})-[:ROUTES]->(i:Interface)
RETURN count(i) AS numberOfInterfaces","match
$n isa network, has ip ""10.3"";
routes (routing_device: $n, routed_interface: $i);
$i isa interface;
reduce $count = count($i);"
125,What are the IP addresses of zones in zone 4?,"MATCH (z:Zone {zone: 4})
RETURN z.ip AS ip_addresses","match
$z isa network_zone, has zone 4;
fetch {
  ""ip_addresses"": $z.ip
};"
126,Identify all applications that listen on port 80.,"MATCH (app:Application)-[:LISTENS]->(port:Port {port: 80})
RETURN app.name","match
$app isa application;
$port isa port, has port_number 80;
listens (listening_process: $app, listened_port: $port);
fetch {
  ""name"": $app.name
};"
127,List the routers in 'DC1' DataCenter.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router;
fetch {
  ""name"": $r.name
};"
128,What operating systems are installed on machines in zone 3?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 3})-[:HOLDS]->(machine:Machine)-[:RUNS]->(os:OS)
RETURN DISTINCT os.name AS operating_systems","match
  $rack isa rack, has zone 3;
  dc_contains (data_center: $dc, contained_equipment: $rack);
  holds (containing_rack: $rack, held_equipment: $machine);
  $machine isa machine;
  runs (host_machine: $machine, running_process: $os);
  $os isa os, has name $os_name;
select $os_name;
distinct;
fetch { ""operating_systems"": $os_name };"
129,"What are the names of all DataCenters located in 'Iceland, Rekjavik'?","MATCH (dc:DataCenter {location: 'Iceland, Rekjavik'})
RETURN dc.name","match
$dc isa data_center, has location ""Iceland, Rekjavik"";
fetch {
  ""name"": $dc.name
};"
130,Which 3 applications are instances of the software 'webapp'?,"MATCH (s:Software)-[:INSTANCE]->(a:Application {name: 'webapp'})
RETURN a.name
LIMIT 3","match
  $s isa software, has name ""webapp"";
  $a isa application;
  instance_of (running_instance: $a, template: $s);
limit 3;
fetch {
  ""name"": $a.name
};"
131,Which 3 ports are exposed by interfaces in zone 3?,"MATCH (zone:Zone {zone: 3})-[:ROUTES]->(interface:Interface)-[:EXPOSES]->(port:Port)
RETURN port.port
LIMIT 3","match
$nz isa network_zone, has zone 3;
routes (routing_device: $nz, routed_interface: $i);
exposes (exposing_interface: $i, exposed_port: $p);
limit 3;
fetch { ""port"": $p.port_number };"
132,What are the first 3 racks that hold machines of type 'xl-16/256/625'?,"MATCH (t:Type {name: 'xl-16/256/625'})<-[:TYPE]-(m:Machine)-[:HOLDS]-(r:Rack)
RETURN r.name
LIMIT 3","match
$t isa machine_type_spec, has machine_type ""xl-16/256/625"";
typed_as (machine: $m, spec: $t);
holds (containing_rack: $r, held_equipment: $m);
limit 3;
fetch {
  ""rack_name"": $r.name
};"
133,Which 3 services listen to port 80 in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name
LIMIT 3","match
  $dc isa data_center, has name ""DC1"";
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack;
  holds (containing_rack: $rack, held_equipment: $m);
  $m isa machine;
  runs (host_machine: $m, running_process: $s);
  $s isa service;
  listens (listening_process: $s, listened_port: $p);
  $p isa port, has port_number 80;
limit 3;
fetch {
  ""name"": $s.name
};"
134,Name the first 3 ports connected to the interface with IP '10.1.0.254'.,"MATCH (i:Interface {ip: '10.1.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3","match
$i isa interface, has ip ""10.1.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
limit 3;
fetch {
  ""port"": $p.port_number
};"
135,What are the top 3 types of software required by the application 'logstash'?,"MATCH (app:Application {name: 'logstash'})-[:INSTANCE]->(software:Software)
RETURN software.name, COUNT(*) AS usage_count
ORDER BY usage_count DESC
LIMIT 3","match
$app isa application, has name ""logstash"";
instance_of (running_instance: $app, template: $software);
$software isa software, has name $sname;
reduce $usage_count = count groupby $sname;
sort $usage_count desc;
limit 3;
fetch { ""software_name"": $sname, ""usage_count"": $usage_count };"
136,List the first 3 dependencies of the service named 'java'.,"MATCH (s:Service {name: 'java'})-[:INSTANCE]->(dep:Software)
RETURN dep.name
LIMIT 3","match
$s isa service, has name ""java"";
depends_on (dependent: $s, dependency: $dep);
$dep isa software, has name $n;
limit 3;
fetch {
  ""name"": $n
};"
137,Which 3 machines in DataCenter 'DC1' are connected to the interface with IP '10.3'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(machine:Machine)-[:ROUTES]->(interface:Interface {ip: '10.3'})
RETURN machine.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
routes (routing_device: $machine, routed_interface: $iface);
$iface isa interface, has ip ""10.3"";
limit 3;
fetch {
  ""machine_name"": $machine.name
};"
138,What are the first 3 applications that depend on the service 'java'?,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'java'})
RETURN app.name
ORDER BY app.startTime
LIMIT 3","match
$app isa application, has start_time $st;
$service isa service, has name ""java"";
depends_on (dependent: $app, dependency: $service);
sort $st;
limit 3;
fetch {
  ""name"": $app.name
};"
139,Name the top 3 processes that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime DESC
LIMIT 3","match
$v isa version, has name ""7.1"";
$p isa process, has name $pn, has start_time $st, has pid $pid;
instance_of (running_instance: $p, template: $v);
sort $st desc;
limit 3;
fetch {
  ""name"": $pn,
  ""start_time"": $st,
  ""pid"": $pid
};"
140,List the first 3 previous versions that the version '7.1' depends on.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
{
  previous (newer_version: $v, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid1);
  previous (newer_version: $mid1, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid2a);
  previous (newer_version: $mid2a, older_version: $mid2b);
  previous (newer_version: $mid2b, older_version: $prev);
};
limit 3;
fetch {
  ""prev_name"": $prev.name
};"
141,Which 3 types of machines are held in the racks of zone 2?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(:Interface)<-[:ROUTES]-(:Switch)<-[:HOLDS]-(r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.type AS machineType
LIMIT 3","match
$z isa network_zone, has zone 2;
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $sw, routed_interface: $i);
$sw isa switch;
holds (containing_rack: $r, held_equipment: $sw);
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t has machine_type $mt;
select $mt;
distinct;
limit 3;
fetch { ""machineType"": $mt };"
142,Which 3 racks in DataCenter 'DC1' contain switches of type 'm-4/16/25'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(switch:Switch)
MATCH (rack)-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type {name: 'm-4/16/25'})
RETURN DISTINCT rack.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type has name ""m-4/16/25"";
select $rack;
distinct;
limit 3;
fetch { ""rack_name"": $rack.name };"
143,Name the first 3 processes that are instances of the application 'cms'.,"MATCH (app:Application {name: 'cms'})-[:INSTANCE]->(process:Process)
RETURN process.name
ORDER BY process.startTime
LIMIT 3","match
  $app isa application, has name ""cms"";
  instance_of (template: $app, running_instance: $proc);
  $proc isa process, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""process_name"": $proc.name
};"
144,What are the top 3 services that depend on the application 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(service:Service)
RETURN service.name, COUNT(*) AS dependency_count
ORDER BY dependency_count DESC
LIMIT 3","match
$app isa application, has name ""webapp"";
$service isa service, has name $sn;
depends_on (dependent: $app, dependency: $service);
reduce $dependency_count = count groupby $sn;
sort $dependency_count desc;
limit 3;
fetch {
  ""service_name"": $sn,
  ""dependency_count"": $dependency_count
};"
145,List the first 3 ports listened to by the service named 'java'.,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port
LIMIT 3","match
$s isa service, has name ""java"";
listens (listening_process: $s, listened_port: $p);
$p isa port;
limit 3;
fetch {
  ""port"": $p.port_number
};"
146,What are the first 3 processes that are instances of the process '8966'?,"MATCH (p:Process {pid: 8966})-[:INSTANCE]->(v:Version)<-[:INSTANCE]-(relatedProcess:Process)
RETURN relatedProcess
ORDER BY relatedProcess.startTime
LIMIT 3","match
$p isa process, has pid 8966;
instance_of (running_instance: $p, template: $v);
$v isa version;
instance_of (running_instance: $relatedProcess, template: $v);
$relatedProcess isa process, has start_time $st;
not { $relatedProcess is $p; };
sort $st asc;
limit 3;
fetch {
  ""relatedProcess"": {
    ""name"": $relatedProcess.name,
    ""start_time"": $relatedProcess.start_time,
    ""pid"": $relatedProcess.pid
  }
};"
147,Name the top 3 egress routes from DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)-[:ROUTES]->(i:Interface)
RETURN e.name AS egress_name, count(i) AS route_count
ORDER BY route_count DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $e);
$e isa egress;
$rel isa routes (routing_device: $e, routed_interface: $i);
$i isa interface;
reduce $route_count = count($i) groupby $e;
sort $route_count desc;
limit 3;
fetch { ""egress_name"": $e.name, ""route_count"": $route_count };"
148,Which Applications are running on the Machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$a isa application;
runs (host_machine: $m, running_process: $a);
fetch {
  ""name"": $a.name
};"
149,What Software versions are available for 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
fetch {
  ""version"": $v.name
};"
150,List all processes that have a PID greater than 5000.,"MATCH (p:Process)
WHERE p.pid > 5000
RETURN p.name, p.pid","match
$p isa process, has pid $pid;
$pid > 5000;
fetch {
  ""name"": $p.name,
  ""pid"": $pid
};"
151,Which applications are dependent on the service named java?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name AS applicationName","match
$s isa service, has name ""java"";
$a isa application;
depends_on (dependent: $a, dependency: $s);
fetch {
  ""applicationName"": $a.name
};"
152,Identify the top 3 largest disks by capacity in the DataCenter DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS typeName, t.disk AS diskCapacity
ORDER BY t.disk DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has name $tn, has disk $d;
sort $d desc;
limit 3;
fetch {
  ""typeName"": $tn,
  ""diskCapacity"": $d
};"
153,List all network IPs in zone 2.,"MATCH (n:Network)
WHERE n.zone = 2
RETURN n.ip","match
$n isa network, has zone 2;
fetch {
  ""ip"": $n.ip
};"
154,What is the maximum RAM capacity of types available in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(:Machine)-[:TYPE]->(t:Type)
RETURN MAX(t.ram) AS maxRamCapacity","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has ram $r;
reduce $max_ram = max($r);"
155,Find all services that listen on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name","match
$s isa service;
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
fetch {
  ""name"": $s.name
};"
156,Which version of software is installed on OS named RHEL?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)
RETURN version.name AS softwareVersion","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $v);
$v isa version;
fetch {
  ""softwareVersion"": $v.name
};"
157,What are the dependencies of the software named RHEL?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
158,List all processes run by the application named webserver.,"MATCH (app:Application {name: 'webserver'})-[:INSTANCE]->(proc:Process)
RETURN proc.name AS processName, proc.startTime AS startTime, proc.pid AS pid","match
  $app isa application, has name ""webserver"";
  instance_of (template: $app, running_instance: $proc);
  $proc isa process;
fetch {
  ""processName"": $proc.name,
  ""startTime"": $proc.start_time,
  ""pid"": $proc.pid
};"
159,Which services are started by machines in the DataCenter named DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS service_name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $s);
$s isa service;
fetch {
  ""service_name"": $s.name
};"
160,Identify the applications running on machine named DC1-RCK-1-1-M-1.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $a);
$a isa application;
fetch {
  ""name"": $a.name
};"
161,Which ports are exposed by the interface with IP 10.0.0.254?,"MATCH (i:Interface {ip: ""10.0.0.254""})-[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
fetch {
  ""exposed_ports"": $p.port_number
};"
162,What are the IP addresses of switches located in rack number 5?,"MATCH (r: Rack {rack: 5})-[:HOLDS]->(s: Switch)
RETURN s.ip AS switch_ip","match
$r isa rack, has rack_number 5;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
fetch {
  ""switch_ip"": $s.ip
};"
163,How many different software versions are available for the software named RHEL?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN count(DISTINCT v.name) AS numberOfVersions","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v has name $vn;
select $vn;
distinct;
reduce $count = count($vn);"
164,List all switches in rack 1.,"MATCH (r:Rack {rack: 1})-[:HOLDS]->(s:Switch)
RETURN s.ip AS switch_ip","match
$r isa rack, has rack_number 1;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
fetch {
  ""switch_ip"": $s.ip
};"
165,Which racks contain machines in zone 2?,"MATCH (rack:Rack)-[:HOLDS]->(machine:Machine)
WHERE rack.zone = 2
RETURN rack.name AS rackName","match
$rack isa rack, has zone 2;
$machine isa machine;
holds (containing_rack: $rack, held_equipment: $machine);
fetch {
  ""rackName"": $rack.name
};"
166,What are the first 3 egress names in the DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $e);
$e isa egress;
limit 3;
fetch {
  ""name"": $e.name
};"
167,Identify the top 5 networks by size within zone 3.,"MATCH (n:Network)
WHERE n.zone = 3
RETURN n.ip, n.size
ORDER BY n.size DESC
LIMIT 5","match
$n isa network, has zone 3, has size $s;
sort $s desc;
limit 5;
fetch {
  ""ip"": $n.ip,
  ""size"": $s
};"
168,Which interfaces connect to the router named DC1-R-2?,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS interface_ip","match
$r isa router, has name ""DC1-R-2"";
routes (routing_device: $r, routed_interface: $i);
fetch {
  ""interface_ip"": $i.ip
};"
169,How many racks are there in zone 4 of the DataCenter named DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
RETURN count(r) AS numberOfRacks","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 4;
dc_contains (data_center: $dc, contained_equipment: $r);
reduce $count = count($r);"
170,List all routers in zone 1.,"MATCH (r:Router)
WHERE r.zone = 1
RETURN r.name","match
$r isa router, has zone 1, has name $n;
fetch {
  ""name"": $n
};"
171,"What are the names of all DataCenters located in Iceland, Rekjavik?","MATCH (dc:DataCenter {location: 'Iceland, Rekjavik'})
RETURN dc.name","match
$dc isa data_center, has location ""Iceland, Rekjavik"", has name $n;
fetch {
  ""name"": $n
};"
172,List the first 5 dependencies of the software 'logstash'.,"MATCH (s:Software {name: 'logstash'})-[:DEPENDS_ON]->(d)
RETURN d.name
LIMIT 5","match
$s isa software, has name ""logstash"";
depends_on (dependent: $s, dependency: $d);
$d has name $n;
limit 5;
fetch { ""name"": $n };"
173,Which machines are running applications that depend on the process '8966'?,"MATCH (p:Process {pid: 8966})<-[:DEPENDS_ON]-(a:Application)<-[:RUNS]-(m:Machine)
RETURN m.name AS machine_name","match
$p isa process, has pid 8966;
depends_on (dependent: $a, dependency: $p);
$a isa application;
runs (host_machine: $m, running_process: $a);
$m isa machine;
fetch {
  ""machine_name"": $m.name
};"
174,List all racks containing machines of type 'xxl'.,"MATCH (t:Type {type: 'xxl'})<-[:TYPE]-(m:Machine)<-[:HOLDS]-(r:Rack)
RETURN r.name AS rack_name","match
$t isa machine_type_spec, has machine_type ""xxl"";
typed_as (machine: $m, spec: $t);
$r isa rack;
holds (containing_rack: $r, held_equipment: $m);
fetch {
  ""rack_name"": $r.name
};"
175,What are the first 5 routers located in zone 2?,"MATCH (r:Router)
WHERE r.zone = 2
RETURN r.name
LIMIT 5","match
$r isa router, has zone 2;
limit 5;
fetch { ""name"": $r.name };"
176,What are the different types of machines that can run in a rack located in zone 4?,"MATCH (r:Rack {zone: 4})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.type AS machineType","match
$r isa rack, has zone 4;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t has machine_type $mt;
select $mt;
distinct;
fetch { ""machineType"": $mt };"
177,Identify the first 3 processes running on machine 'DC1-RCK-1-1-M-1' with a PID less than 5000.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
WHERE p.pid < 5000
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $p);
$p isa process, has pid $pid;
$pid < 5000;
$p has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $p.name,
  ""start_time"": $st,
  ""pid"": $pid
};"
178,Which machines are type 'm' in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type {type: 'm'})
RETURN machine.name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $spec);
$spec isa machine_type_spec, has machine_type ""m"";
fetch {
  ""machine_name"": $machine.name
};"
179,How many routers are there in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN count(r) AS numberOfRouters","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router;
reduce $count = count($r);"
180,Identify all software versions available for 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v isa version;
fetch {
  ""version"": $v.name
};"
181,Which machines are held in rack 'DC1-RCK-4-9'?,"MATCH (rack:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(machine:Machine)
RETURN machine.name","match
$rack isa rack, has name ""DC1-RCK-4-9"";
$m isa machine;
holds (containing_rack: $rack, held_equipment: $m);
fetch {
  ""name"": $m.name
};"
182,List all racks in zone 4 of DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
RETURN r.name","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 4;
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $r.name
};"
183,Which DataCenter contains the router named 'DC1-R-2'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-R-2'})
RETURN dc.name","match
$dc isa data_center;
$r isa router, has name ""DC1-R-2"";
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $dc.name
};"
184,What are the names of routers located in zone 2?,"MATCH (r:Router)
WHERE r.zone = 2
RETURN r.name","match
$r isa router, has zone 2;
fetch {
  ""name"": $r.name
};"
185,Which ports do the applications named webapp listen to?,"MATCH (app:Application {name: 'webapp'})-[:LISTENS]->(port:Port)
RETURN port.port AS Port","match
$app isa application, has name ""webapp"";
listens (listening_process: $app, listened_port: $port);
$port isa port;
fetch {
  ""Port"": $port.port_number
};"
186,List the first 5 applications that depend on the process named 7.1.,"MATCH (p:Process {name: ""7.1""})-[:DEPENDS_ON]->(a:Application)
RETURN a.name
LIMIT 5","match
$p isa process, has name ""7.1"";
depends_on (dependent: $a, dependency: $p);
$a isa application;
limit 5;
fetch { ""name"": $a.name };"
187,Identify all services that started after timestamp 1606165629748.,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s.name, s.startTime","match
$s isa service, has start_time $st;
$st > 1606165629748;
fetch {
  ""name"": $s.name,
  ""start_time"": $st
};"
188,Which processes are instances of the version named 7.1?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name AS processName, p.startTime AS startTime, p.pid AS pid","match
$v isa version, has name ""7.1"";
$p isa process, has name $pn, has start_time $st, has pid $pid;
instance_of (running_instance: $p, template: $v);
fetch {
  ""processName"": $pn,
  ""startTime"": $st,
  ""pid"": $pid
};"
189,What are the dependencies of the version named 7.1?,"MATCH (v:Version {name: '7.1'})<-[:VERSION]-(s:Software)
OPTIONAL MATCH (s)-[:DEPENDS_ON]->(dep:Software)
OPTIONAL MATCH (s)-[:DEPENDS_ON]->(app:Application)
OPTIONAL MATCH (s)-[:DEPENDS_ON]->(srv:Service)
RETURN v.name AS version, 
       collect(DISTINCT dep.name) AS software_dependencies, 
       collect(DISTINCT app.name) AS application_dependencies, 
       collect(DISTINCT srv.name) AS service_dependencies","match
  $v isa version, has name ""7.1"";
  has_version (versioned_software: $s, release_version: $v);
  $s isa software;
  depends_on (dependent: $s, dependency: $dep);
  $dep has name $dep_name;
fetch {
  ""version"": $v.name,
  ""dependency"": $dep_name
};"
190,How many applications are dependent on the service named java?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN count(a) AS numberOfDependentApplications","match
$s isa service, has name ""java"";
depends_on (dependent: $a, dependency: $s);
$a isa application;
reduce $count = count($a);"
191,Which routers connect to interfaces with IP addresses in the 10.2 range?,"MATCH (r:Router)-[:ROUTES]->(i:Interface)
WHERE i.ip STARTS WITH '10.2'
RETURN r.name AS router_name, i.ip AS interface_ip","match
$r isa router, has name $rn;
routes (routing_device: $r, routed_interface: $i);
$i isa interface, has ip $ip;
$ip like ""10.2.*"";
fetch {
  ""router_name"": $rn,
  ""interface_ip"": $ip
};"
192,What are the names of all applications that run on machine DC1-RCK-4-9-M-103?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(a:Application)
RETURN a.name","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
$a isa application, has name $n;
runs (host_machine: $m, running_process: $a);
fetch {
  ""name"": $n
};"
193,List all the types of applications running in zone 3 of DataCenter DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 3})-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application)
RETURN DISTINCT a.name AS application_types","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 3;
dc_contains (data_center: $dc, contained_equipment: $r);
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
$a isa application, has name $app_name;
runs (host_machine: $m, running_process: $a);
select $app_name;
distinct;
fetch { ""application_types"": $app_name };"
194,How many machines are there in rack 10 of DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack {rack: 10})-[:HOLDS]->(machine:Machine)
RETURN count(machine) AS numberOfMachines","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has rack_number 10;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
reduce $count = count($m);"
195,List all the dependencies of the process named 7.1.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$p isa process, has name ""7.1"";
depends_on (dependent: $p, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
196,Which machines run the OS starting with 'RHE'?,"MATCH (os:OS)-[:INSTANCE]->(version:Version),
      (machine:Machine)-[:RUNS]->(os)
WHERE os.name STARTS WITH 'RHE'
RETURN machine.name","match
$machine isa machine, has name $mn;
$os isa os, has name $on;
$on like ""^RHE.*"";
runs (host_machine: $machine, running_process: $os);
fetch {
  ""machine_name"": $mn
};"
197,Identify the racks that hold switches with IP starting with '10.1'.,"MATCH (rack:Rack)-[:HOLDS]->(switch:Switch)
WHERE switch.ip STARTS WITH '10.1'
RETURN DISTINCT rack.name","match
$rack isa rack;
$switch isa switch, has ip $ip;
$ip like ""^10\\.1.*"";
holds (containing_rack: $rack, held_equipment: $switch);
select $rack;
distinct;
fetch { ""name"": $rack.name };"
198,What are the start times of applications named cms?,"MATCH (a:Application {name: 'cms'})
RETURN a.startTime","match
$a isa application, has name ""cms"", has start_time $st;
fetch {
  ""start_time"": $st
};"
199,How many different versions are there for the application named crm?,"MATCH (app:Application {name: 'crm'})-[:INSTANCE]->(software:Software)-[:VERSION]->(version:Version)
RETURN COUNT(DISTINCT version.name) AS numberOfVersions","match
$app isa application, has name ""crm"";
instance_of (running_instance: $app, template: $software);
$software isa software;
has_version (versioned_software: $software, release_version: $version);
$version has name $vname;
select $vname;
distinct;
reduce $count = count;"
200,Which applications listen on port 443?,"MATCH (p:Port {port: 443})<-[:LISTENS]-(a:Application)
RETURN a.name","match
$p isa port, has port_number 443;
listens (listening_process: $a, listened_port: $p);
$a isa application;
fetch {
  ""name"": $a.name
};"
202,List all services that depend on the process named 7.1.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON]->(s:Service)
RETURN s.name","match
  $p isa process, has name ""7.1"";
  depends_on (dependent: $p, dependency: $s);
  $s isa service;
fetch {
  ""name"": $s.name
};"
203,How many types of machines have a CPU greater than 16?,"MATCH (t:Type)
WHERE t.cpu > 16
RETURN count(DISTINCT t.name) AS numberOfMachineTypes","match
$t isa machine_type_spec, has cpu $c, has name $n;
$c > 16;
select $n;
distinct;
reduce $count = count;"
204,Which ports are used by the service named java in DataCenter DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port AS Port","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $s);
$s isa service, has name ""java"";
listens (listening_process: $s, listened_port: $p);
fetch {
  ""Port"": $p.port_number
};"
205,What are the IP addresses of interfaces connected to the network with IP 10.2?,"MATCH (network:Network {ip: '10.2'})-[:ROUTES]->(interface:Interface)
RETURN interface.ip AS interface_ip","match
$network isa network, has ip ""10.2"";
routes (routing_device: $network, routed_interface: $interface);
$interface isa interface;
fetch {
  ""interface_ip"": $interface.ip
};"
206,What are the start times of services run by machine DC1-RCK-4-9-M-103?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(s:Service)
RETURN s.startTime","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
$s isa service;
runs (host_machine: $m, running_process: $s);
fetch {
  ""startTime"": $s.start_time
};"
207,List the first 3 services that started before timestamp 1606597376483 and are running on a machine in zone 4.,"MATCH (m:Machine)-[:RUNS]->(s:Service)
MATCH (m)-[:ROUTES]->(i:Interface)
MATCH (i)<-[:ROUTES]-(z:Zone {zone: 4})
WHERE s.startTime < 1606597376483
RETURN s.name, s.startTime
ORDER BY s.startTime ASC
LIMIT 3","match
  $m isa machine;
  $s isa service, has start_time $st;
  $st < 1606597376483;
  runs (host_machine: $m, running_process: $s);
  $i isa interface;
  routes (routing_device: $m, routed_interface: $i);
  $z isa network_zone, has zone 4;
  routes (routing_device: $z, routed_interface: $i);
sort $st asc;
limit 3;
fetch {
  ""name"": $s.name,
  ""startTime"": $st
};"
208,Which routers are connected to networks with IP '10.4'?,"MATCH (n:Network {ip: '10.4'})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(r:Router)
RETURN r.name","match
$n isa network, has ip ""10.4"";
routes (routing_device: $n, routed_interface: $i);
routes (routing_device: $r, routed_interface: $i);
$r isa router;
fetch {
  ""name"": $r.name
};"
209,List the first 5 services that depend on the software 'RHEL'.,"MATCH (s:Service)-[:INSTANCE]->(sw:Software {name: 'RHEL'})
RETURN s.name
LIMIT 5","match
$s isa service;
$sw isa software, has name ""RHEL"";
instance_of (running_instance: $s, template: $sw);
limit 5;
fetch { ""name"": $s.name };"
210,List the first 5 applications that were started after timestamp 1606165629748.,"MATCH (app:Application)
WHERE app.startTime > 1606165629748
RETURN app.name, app.startTime
ORDER BY app.startTime
LIMIT 5","match
$app isa application, has name $n, has start_time $st;
$st > 1606165629748;
sort $st asc;
limit 5;
fetch {
  ""app.name"": $n,
  ""app.startTime"": $st
};"
211,Identify the first 3 networks with a zone of 4 that route through any interface.,"MATCH (n:Network)-[:ROUTES]->(i:Interface)
WHERE n.zone = 4
RETURN n.ip, n.zone
LIMIT 3","match
$n isa network, has zone 4;
routes (routing_device: $n, routed_interface: $i);
$i isa interface;
limit 3;
fetch {
  ""ip"": $n.ip,
  ""zone"": $n.zone
};"
212,How many different types of switches are held in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(switch:Switch)
RETURN COUNT(DISTINCT switch.ip) AS numberOfSwitchTypes","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$switch isa switch, has ip $ip;
holds (containing_rack: $rack, held_equipment: $switch);
reduce $count = count($ip);"
213,Which applications have dependencies on the service 'java'?,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'java'})
RETURN app.name","match
$app isa application;
$service isa service, has name ""java"";
depends_on (dependent: $app, dependency: $service);
fetch {
  ""name"": $app.name
};"
214,List the first 5 machines connected to the network with IP '10.2'.,"MATCH (network:Network {ip: '10.2'})-[:ROUTES]->(interface:Interface)<-[:ROUTES]-(machine:Machine)
RETURN machine.name
LIMIT 5","match
$network isa network, has ip ""10.2"";
routes (routing_device: $network, routed_interface: $interface);
routes (routing_device: $machine, routed_interface: $interface);
$machine isa machine;
limit 5;
fetch {
  ""name"": $machine.name
};"
215,What are the first 3 services running on the OS 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)<-[:INSTANCE]-(service:Service)
RETURN service.name
LIMIT 3","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $v);
$v isa version;
instance_of (running_instance: $service, template: $v);
$service isa service;
limit 3;
fetch {
  ""service_name"": $service.name
};"
216,Identify the first 5 racks that hold machines of type 'm'.,"MATCH (rack:Rack)-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type {type: 'm'})
RETURN DISTINCT rack.name
LIMIT 5","match
$rack isa rack;
$machine isa machine;
$type isa machine_type_spec, has machine_type ""m"";
holds (containing_rack: $rack, held_equipment: $machine);
typed_as (machine: $machine, spec: $type);
select $rack;
distinct;
limit 5;
fetch {
  ""rack_name"": $rack.name
};"
217,List the first 3 processes that have a PID greater than 5000 and are running on a machine in zone 1.,"MATCH (z:Zone {zone: 1})-[:ROUTES]->(:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(p:Process)
WHERE p.pid > 5000
RETURN p.name, p.pid, m.name
LIMIT 3","match
$z isa network_zone, has zone 1;
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $m, routed_interface: $i);
$m isa machine;
runs (host_machine: $m, running_process: $p);
$p isa process, has pid $pid;
$pid > 5000;
limit 3;
fetch {
  ""process_name"": $p.name,
  ""pid"": $pid,
  ""machine_name"": $m.name
};"
218,Which applications are listening on ports higher than 1024?,"MATCH (app:Application)-[:LISTENS]->(port:Port)
WHERE port.port > 1024
RETURN app.name AS ApplicationName","match
$app isa application, has name $n;
$port isa port, has port_number $pn;
listens (listening_process: $app, listened_port: $port);
$pn > 1024;
fetch {
  ""ApplicationName"": $n
};"
219,What are the first 3 versions of the OS running on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(os:OS)-[:INSTANCE]->(v:Version)
RETURN v.name
ORDER BY v.name
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $os);
$os isa os;
instance_of (running_instance: $os, template: $v);
$v isa version, has name $vn;
sort $vn asc;
limit 3;
fetch { ""name"": $vn };"
220,How many machines run the service 'java' in the DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service {name: 'java'})
RETURN count(m) AS numberOfMachines","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $s);
$s isa service, has name ""java"";
reduce $count = count($m);"
221,List all the software dependencies for the application 'crm'.,"MATCH (app:Application {name: 'crm'})-[:INSTANCE]->(software:Software)-[:DEPENDS_ON]->(dependency:Software)
RETURN DISTINCT dependency.name AS SoftwareDependencies","match
  $app isa application, has name ""crm"";
  instance_of (running_instance: $app, template: $software);
  $software isa software;
  depends_on (dependent: $software, dependency: $dep);
  $dep isa software, has name $dep_name;
select $dep_name;
distinct;
fetch {
  ""SoftwareDependencies"": $dep_name
};"
222,Which routers route through interface with IP '10.1.0.254'?,"MATCH (r:Router)-[:ROUTES]->(i:Interface {ip: '10.1.0.254'})
RETURN r.name","match
$r isa router;
$i isa interface, has ip ""10.1.0.254"";
routes (routing_device: $r, routed_interface: $i);
fetch {
  ""name"": $r.name
};"
223,What are the first 3 types of machines available in zone 3?,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(:Interface)<-[:ROUTES]-(:Switch)<-[:HOLDS]-(r:Rack {zone: 3})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN DISTINCT t.name
ORDER BY t.name
LIMIT 3","match
  $z isa network_zone, has zone 3;
  routes (routing_device: $z, routed_interface: $i);
  $s isa switch;
  routes (routing_device: $s, routed_interface: $i);
  $r isa rack, has zone 3;
  holds (containing_rack: $r, held_equipment: $s);
  $m isa machine;
  holds (containing_rack: $r, held_equipment: $m);
  typed_as (machine: $m, spec: $t);
  $t has name $tn;
select $tn;
distinct;
sort $tn asc;
limit 3;
fetch { ""name"": $tn };"
224,What are the first 5 services that started before timestamp 1606597376483 and are running on a machine in zone 3?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 3})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
WHERE service.startTime < 1606597376483
RETURN service.name, service.startTime
ORDER BY service.startTime ASC
LIMIT 5","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has zone 3;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service, has start_time $st;
$st < 1606597376483;
sort $st asc;
limit 5;
fetch {
  ""name"": $service.name,
  ""start_time"": $st
};"
225,List the first 5 applications that depend on the process '8966'.,"MATCH (p:Process {pid: 8966})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name
LIMIT 5","match
$p isa process, has pid 8966;
$a isa application;
depends_on (dependent: $a, dependency: $p);
limit 5;
fetch {
  ""name"": $a.name
};"
226,How many interfaces are connected to router 'DC1-R-3'?,"MATCH (r:Router {name: 'DC1-R-3'})-[:ROUTES]->(i:Interface)
RETURN count(i) AS numberOfInterfaces","match
$r isa router, has name ""DC1-R-3"";
routes (routing_device: $r, routed_interface: $i);
reduce $count = count($i);"
227,Identify the first 3 machines that are of type 'xl'.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'xl'})
RETURN m.name
LIMIT 3","match
$m isa machine;
$t isa machine_type_spec, has machine_type ""xl"";
typed_as (machine: $m, spec: $t);
limit 3;
fetch {
  ""name"": $m.name
};"
229,List the first 3 services listening on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name
LIMIT 3","match
$s isa service;
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
limit 3;
fetch {
  ""name"": $s.name
};"
230,What are the first 5 applications running on OS 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)<-[:INSTANCE]-(app:Application)
RETURN app.name
LIMIT 5","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $version);
$version isa version;
instance_of (running_instance: $app, template: $version);
$app isa application;
limit 5;
fetch {
  ""app_name"": $app.name
};"
231,How many switches are connected to interfaces in zone 2?,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
RETURN count(s) AS numberOfSwitches","match
$nz isa network_zone, has zone 2;
routes (routing_device: $nz, routed_interface: $i);
routes (routing_device: $s, routed_interface: $i);
$s isa switch;
reduce $count = count($s);"
232,List the first 5 processes that depend on the service 'java'.,"MATCH (p:Process)-[:DEPENDS_ON]->(s:Service {name: 'java'})
RETURN p.name, p.startTime, p.pid
LIMIT 5","match
$p isa process;
$s isa service, has name ""java"";
depends_on (dependent: $p, dependency: $s);
limit 5;
fetch {
  ""name"": $p.name,
  ""start_time"": $p.start_time,
  ""pid"": $p.pid
};"
233,What are the top 3 software versions that the software 'RHEL' depends on?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS version, COUNT(*) AS dependency_count
ORDER BY dependency_count DESC
LIMIT 3","match
$s isa software, has name ""RHEL"";
$rel isa depends_on (dependent: $s, dependency: $v);
$v isa version, has name $vn;
reduce $count = count($rel) groupby $vn;
sort $count desc;
limit 3;
fetch { ""version"": $vn, ""dependency_count"": $count };"
234,Identify the top 3 racks in zone 4.,"MATCH (r:Rack)
WHERE r.zone = 4
RETURN r.name
ORDER BY r.rack
LIMIT 3","match
$r isa rack, has zone 4, has rack_number $rn;
sort $rn;
limit 3;
fetch {
  ""name"": $r.name
};"
235,List the first 5 dependencies of the application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name
LIMIT 5","match
$app isa application, has name ""webapp"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
limit 5;
fetch {
  ""dependency_name"": $dep_name
};"
236,Identify the first 3 applications with a PID less than 2000.,"MATCH (app:Application)
WHERE app.pid < 2000
RETURN app.name, app.pid
ORDER BY app.startTime ASC
LIMIT 3","match
$app isa application, has pid $pid, has start_time $st;
$pid < 2000;
sort $st asc;
limit 3;
fetch {
  ""name"": $app.name,
  ""pid"": $pid
};"
237,What are the first 3 types of machines located in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS type_name
LIMIT 3","match
  $dc isa data_center, has name ""DC1"";
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack;
  holds (containing_rack: $rack, held_equipment: $m);
  $m isa machine;
  typed_as (machine: $m, spec: $t);
  $t isa machine_type_spec;
limit 3;
fetch {
  ""type_name"": $t.name
};"
238,List all machines that run applications dependent on 'crm'.,"MATCH (app:Application {name: 'crm'})<-[:DEPENDS_ON]-(software:Software)<-[:INSTANCE]-(appInstance:Application)<-[:RUNS]-(machine:Machine)
RETURN DISTINCT machine.name","match
$app isa application, has name ""crm"";
depends_on (dependent: $software, dependency: $app);
$software isa software;
instance_of (running_instance: $appInstance, template: $software);
$appInstance isa application;
runs (host_machine: $machine, running_process: $appInstance);
$machine isa machine, has name $name;
select $name;
distinct;
fetch { ""name"": $name };"
239,How many applications are running on machines in zone 2?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 2})-[:HOLDS]->(machine:Machine)-[:RUNS]->(app:Application)
RETURN count(DISTINCT app) AS numberOfApplications","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has zone 2;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application;
select $app;
distinct;
reduce $count = count($app);"
240,Identify the first 3 racks that hold at least two types of switches.,"MATCH (r: Rack)-[:HOLDS]->(s: Switch)
WITH r, COUNT(DISTINCT s.ip) AS switchCount
WHERE switchCount >= 2
RETURN r.name
LIMIT 3","match
$r isa rack;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
reduce $count = count($s) groupby $r;
match
$count >= 2;
limit 3;
fetch {
  ""name"": $r.name
};"
241,What are the first 5 applications that are instances of the application 'webapp'?,MATCH (a:Application)-[:INSTANCE]->(app:Application {name: 'webapp'})\nRETURN a.name AS application_name\nLIMIT 5,"match\n$a isa application;\n$app isa application, has name ""webapp"";\ninstance_of (running_instance: $a, template: $app);\nlimit 5;\nfetch {\n  ""application_name"": $a.name\n};"
242,List the first 3 processes that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name, p.startTime, p.pid
LIMIT 3","match
$v isa version, has name ""7.1"";
$p isa process, has name $pname, has start_time $st, has pid $pid;
instance_of (running_instance: $p, template: $v);
limit 3;
fetch {
  ""name"": $pname,
  ""start_time"": $st,
  ""pid"": $pid
};"
243,Which DataCenter has the most types of routers?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)
WITH dc, count(DISTINCT r.name) AS routerCount
RETURN dc.name AS DataCenter, routerCount
ORDER BY routerCount DESC
LIMIT 1","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router, has name $rn;
reduce $routerCount = count($rn) groupby $dc;
sort $routerCount desc;
limit 1;
fetch { ""DataCenter"": $dc.name, ""routerCount"": $routerCount };"
244,Identify the first 5 machines that run the OS 'RHEL' and have a type with RAM greater than 256.,"MATCH (os:OS {name: 'RHEL'})<-[:RUNS]-(machine:Machine)-[:TYPE]->(type:Type)
WHERE type.ram > 256
RETURN machine.name
LIMIT 5","match
$os isa os, has name ""RHEL"";
runs (host_machine: $machine, running_process: $os);
typed_as (machine: $machine, spec: $type);
$type has ram $r;
$r > 256;
limit 5;
fetch {
  ""machine_name"": $machine.name
};"
245,List the first 3 switches that route through interfaces with an IP starting with '10.3'.,"MATCH (s:Switch)-[:ROUTES]->(i:Interface)
WHERE i.ip STARTS WITH '10.3'
RETURN s
LIMIT 3","match
$s isa switch;
$i isa interface, has ip $ip;
routes (routing_device: $s, routed_interface: $i);
$ip like ""10.3%"";
limit 3;
fetch {
  ""switch_ip"": $s.ip,
  ""switch_rack_number"": $s.rack_number
};"
246,What are the first 5 applications that depend on the service 'logstash'?,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'logstash'})
RETURN app.name
LIMIT 5","match
$app isa application;
$service isa service, has name ""logstash"";
depends_on (dependent: $app, dependency: $service);
limit 5;
fetch { ""name"": $app.name };"
247,Identify the top 3 routers that route through interfaces in zone 3.,"MATCH (r:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(z:Zone {zone: 3})
RETURN r.name, COUNT(i) AS interface_count
ORDER BY interface_count DESC
LIMIT 3","match
$r isa router, has name $rn;
routes (routing_device: $r, routed_interface: $i);
$z isa network_zone, has zone 3;
routes (routing_device: $z, routed_interface: $i);
reduce $count = count($i) groupby $r, $rn;
sort $count desc;
limit 3;
fetch { ""name"": $rn, ""interface_count"": $count };"
248,List the first 5 dependencies of the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:VERSION]-(s:Software)-[:DEPENDS_ON]->(d)
RETURN d.name
LIMIT 5","match
$v isa version, has name ""7.1"";
has_version (versioned_software: $s, release_version: $v);
depends_on (dependent: $s, dependency: $d);
$d has name $dn;
limit 5;
fetch {
  ""name"": $dn
};"
249,What are the first 3 services that depend on the process '8966'?,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(s:Service)
RETURN s.name
ORDER BY s.startTime
LIMIT 3","match
$p isa process, has pid 8966;
depends_on (dependent: $s, dependency: $p);
$s isa service, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $s.name
};"
250,List all machines that run processes with a PID less than 500.,"MATCH (m:Machine)-[:RUNS]->(p:Process)
WHERE p.pid < 500
RETURN m.name","match
$m isa machine;
$p isa process, has pid $pid;
$pid < 500;
runs (host_machine: $m, running_process: $p);
fetch {
  ""name"": $m.name
};"
251,Which racks are in zone 1 and hold machines of type 'l'?,"MATCH (r:Rack {zone: 1})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type {type: 'l'})
RETURN r.name","match
$r isa rack, has zone 1;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has machine_type ""l"";
fetch {
  ""name"": $r.name
};"
252,List the first 5 processes that are instances of the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name, p.startTime, p.pid
LIMIT 5","match
$v isa version, has name ""7.1"";
$p isa process;
instance_of (running_instance: $p, template: $v);
limit 5;
fetch {
  ""name"": $p.name,
  ""start_time"": $p.start_time,
  ""pid"": $p.pid
};"
253,Identify the first 3 applications that are instances of the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(a:Application)
RETURN a.name
LIMIT 3","match
$s isa software, has name ""RHEL"";
instance_of (template: $s, running_instance: $a);
$a isa application, has name $n;
limit 3;
fetch { ""name"": $n };"
254,Display the top 5 services that started after timestamp 1606165629748 and are running on machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
WHERE s.startTime > 1606165629748
RETURN s.name, s.startTime
ORDER BY s.startTime DESC
LIMIT 5","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $s);
$s isa service, has start_time $st;
$st > 1606165629748;
sort $st desc;
limit 5;
fetch {
  ""name"": $s.name,
  ""startTime"": $st
};"
255,What are the first 3 racks that hold switches with an IP starting with '10.1'?,"MATCH (r:Rack)-[:HOLDS]->(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r.name
ORDER BY r.name
LIMIT 3","match
$r isa rack, has name $n;
$s isa switch, has ip $ip;
holds (containing_rack: $r, held_equipment: $s);
$ip like ""10\\.1.*"";
sort $n;
limit 3;
fetch { ""name"": $r.name };"
256,List the first 3 ports exposed by machines in rack 'DC1-RCK-1-1'.,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:ROUTES]->(interface:Interface)-[:EXPOSES]->(port:Port)
RETURN port.port
LIMIT 3","match
  $dc isa data_center;
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack, has name ""DC1-RCK-1-1"";
  holds (containing_rack: $rack, held_equipment: $machine);
  $machine isa machine;
  routes (routing_device: $machine, routed_interface: $interface);
  exposes (exposing_interface: $interface, exposed_port: $port);
limit 3;
fetch {
  ""port"": $port.port_number
};"
257,How many machines in DataCenter 'DC1' are running the application 'webserver'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN count(m) AS numberOfMachines","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $a);
$a isa application, has name ""webserver"";
reduce $count = count($m);"
258,Which applications are instances of software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]-(a:Application)
RETURN a.name AS application_name","match
  $s isa software, has name ""RHEL"";
  $a isa application, has name $app_name;
  instance_of (running_instance: $a, template: $s);
fetch {
  ""application_name"": $app_name
};"
260,Identify the first 3 services that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(s:Service)
RETURN s.name
LIMIT 3","match
  $v isa version, has name ""7.1"";
  instance_of (running_instance: $s, template: $v);
  $s isa service;
limit 3;
fetch {
  ""name"": $s.name
};"
261,What are the first 5 services that a machine in rack 'DC1-RCK-1-1' can run?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN service.name
LIMIT 5","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service;
limit 5;
fetch {
  ""service_name"": $service.name
};"
262,List the first 3 processes that depend on the application 'webapp'.,"MATCH (app:Application {name: 'webapp'})<-[:DEPENDS_ON]-(process:Process)
RETURN process.name, process.startTime, process.pid
LIMIT 3","match
$app isa application, has name ""webapp"";
$process isa process, has name $pname, has start_time $st, has pid $pid;
depends_on (dependent: $process, dependency: $app);
limit 3;
fetch {
  ""name"": $pname,
  ""startTime"": $st,
  ""pid"": $pid
};"
263,Which machines are running the version '7.1' of any software?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(s:Software)<-[:INSTANCE]-(m:Machine)
RETURN m.name AS machine_name","match
$v isa version, has name ""7.1"";
has_version (versioned_software: $s, release_version: $v);
$s isa software;
instance_of (template: $s, running_instance: $ri);
runs (host_machine: $m, running_process: $ri);
$m isa machine;
fetch {
  ""machine_name"": $m.name
};"
264,List the first 5 machines that have a type with CPU greater than 16.,"MATCH (m:Machine)-[:TYPE]->(t:Type)
WHERE t.cpu > 16
RETURN m.name
LIMIT 5","match
$m isa machine;
typed_as (machine: $m, spec: $t);
$t has cpu $c;
$c > 16;
limit 5;
fetch {
  ""name"": $m.name
};"
265,Identify the first 3 applications run by process '8966'.,"MATCH (p:Process {pid: 8966})-[:INSTANCE]->(a:Application)
RETURN a.name, a.startTime
ORDER BY a.startTime ASC
LIMIT 3","match
$p isa process, has pid 8966;
instance_of (running_instance: $p, template: $a);
$a isa application, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $a.name,
  ""startTime"": $a.start_time
};"
266,What are the first 5 egress routes from routers in zone 4?,"MATCH (r:Router {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(e:Egress)
RETURN e.name, i.ip
LIMIT 5","match
  $r isa router, has zone 4;
  routes (routing_device: $r, routed_interface: $i);
  routes (routing_device: $e, routed_interface: $i);
  $e isa egress;
limit 5;
fetch {
  ""egress_name"": $e.name,
  ""interface_ip"": $i.ip
};"
267,What applications are running on the machine named 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(a:Application)
RETURN a.name AS application_name","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
$a isa application;
runs (host_machine: $m, running_process: $a);
fetch {
  ""application_name"": $a.name
};"
268,Which ports are exposed by the interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})—[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
$p isa port;
exposes (exposing_interface: $i, exposed_port: $p);
fetch {
  ""exposed_ports"": $p.port_number
};"
269,Find all networks routing to the interface with IP '10.4.8.254'.,"MATCH (i:Interface {ip: '10.4.8.254'})<-[:ROUTES]-(n:Network)
RETURN n.ip AS network_ip, n.size AS network_size, n.zone AS network_zone","match
  $i isa interface, has ip ""10.4.8.254"";
  $n isa network;
  routes (routing_device: $n, routed_interface: $i);
fetch {
  ""network_ip"": $n.ip,
  ""network_size"": $n.size,
  ""network_zone"": $n.zone
};"
270,Which services are running on machines located in rack 'DC1-RCK-4-9'?,"MATCH (rack:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN service.name","match
$rack isa rack, has name ""DC1-RCK-4-9"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service;
fetch {
  ""name"": $service.name
};"
271,List all ports exposed by interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
$p isa port;
fetch {
  ""exposed_ports"": $p.port_number
};"
272,Find all interfaces connected to the router 'DC1-R-1'.,"MATCH (router:Router {name: 'DC1-R-1'})-[:ROUTES]->(interface:Interface)
RETURN interface","match
$router isa router, has name ""DC1-R-1"";
$interface isa interface;
routes (routing_device: $router, routed_interface: $interface);
fetch {
  ""ip"": $interface.ip
};"
273,Which machines are running the OS named 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})<-[:RUNS]-(machine:Machine)
RETURN machine.name","match
$os isa os, has name ""RHEL"";
runs (host_machine: $machine, running_process: $os);
fetch {
  ""name"": $machine.name
};"
274,What are the top 3 processes running on the application 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:INSTANCE]->(proc:Process)
RETURN proc.name, proc.startTime, proc.pid
ORDER BY proc.startTime DESC
LIMIT 3","match
$app isa application, has name ""webserver"";
instance_of (template: $app, running_instance: $proc);
$proc isa process, has start_time $st, has name $pn, has pid $pid;
sort $st desc;
limit 3;
fetch {
  ""name"": $pn,
  ""startTime"": $st,
  ""pid"": $pid
};"
275,List all versions that are directly previous to version '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS]->(prev:Version)
RETURN prev.name","match
$v isa version, has name ""7.1"";
previous (newer_version: $v, older_version: $prev);
$prev has name $prev_name;
fetch {
  ""name"": $prev_name
};"
276,Provide the names of the top 3 software that depend on the application 'webserver'.,"MATCH (app:Application {name: 'webserver'})<-[:DEPENDS_ON]-(software:Software)
RETURN software.name AS softwareName
ORDER BY softwareName
LIMIT 3","match
$app isa application, has name ""webserver"";
$software isa software, has name $n;
depends_on (dependent: $software, dependency: $app);
sort $n;
limit 3;
fetch { ""softwareName"": $n };"
277,Which versions of software are installed on 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)
RETURN version.name AS version","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $version);
$version isa version, has name $v;
fetch {
  ""version"": $v
};"
278,Show the first 3 types of machines by RAM size in descending order.,"MATCH (t:Type)
RETURN t.name, t.ram
ORDER BY t.ram DESC
LIMIT 3","match
$t isa machine_type_spec, has ram $r;
sort $r desc;
limit 3;
fetch {
  ""name"": $t.name,
  ""ram"": $r
};"
279,What are the names of the first 3 switches located in rack 10?,"MATCH (r: Rack {rack: 10})-[:HOLDS]->(s: Switch)
RETURN s.ip
LIMIT 3","match
$r isa rack, has rack_number 10;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
limit 3;
fetch {
  ""ip"": $s.ip
};"
280,List all services that are listening on port 80.,"MATCH (p:Port {port: 80})<-[:LISTENS]-(s:Service)
RETURN s.name","match
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
$s isa service;
fetch {
  ""name"": $s.name
};"
281,What are the top 5 OS instances running on machines in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS)
RETURN os.name, COUNT(os) AS instance_count
ORDER BY instance_count DESC
LIMIT 5","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa rack;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $os);
$os isa os, has name $os_name;
reduce $count = count($os) groupby $os_name;
sort $count desc;
limit 5;
fetch { ""os_name"": $os_name, ""instance_count"": $count };"
282,Identify all software dependencies for the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
283,What are the top 3 applications with the highest PID running in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})−[:CONTAINS]−>(:Rack)−[:HOLDS]−>(m:Machine)−[:RUNS]−>(a:Application)
RETURN a.name AS application, a.pid AS pid
ORDER BY a.pid DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $a);
$a isa application, has name $app_name, has pid $pid;
sort $pid desc;
limit 3;
fetch {
  ""application"": $app_name,
  ""pid"": $pid
};"
284,Which applications are running on the machine named 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(a:Application)
RETURN a.name","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
runs (host_machine: $m, running_process: $a);
$a isa application;
fetch {
  ""name"": $a.name
};"
285,What are the names of all networks in zone 2?,"MATCH (n:Network)
WHERE n.zone = 2
RETURN n.name","match
$n isa network, has zone 2;
fetch {
  ""ip"": $n.ip
};"
286,List the top 5 routers in DataCenter 'DC1' by zone number.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name, r.zone
ORDER BY r.zone DESC
LIMIT 5","match
$dc isa data_center, has name ""DC1"";
$r isa router, has zone $z;
dc_contains (data_center: $dc, contained_equipment: $r);
sort $z desc;
limit 5;
fetch {
  ""name"": $r.name,
  ""zone"": $z
};"
287,What are the start times of all OS instances on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(os:OS)
RETURN os.startTime","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $os);
$os isa os;
fetch {
  ""startTime"": $os.start_time
};"
288,How many machines have a type with a disk size less than 100?,"MATCH (m:Machine)-[:TYPE]->(t:Type)
WHERE t.disk < 100
RETURN count(m) AS machineCount","match
$m isa machine;
$t isa machine_type_spec, has disk $d;
$d < 100;
typed_as (machine: $m, spec: $t);
reduce $count = count($m);"
289,List all applications that have dependencies on other applications.,"MATCH (app:Application)-[:DEPENDS_ON]->(:Application)
RETURN DISTINCT app.name","match
$app isa application;
$dep isa application;
depends_on (dependent: $app, dependency: $dep);
select $app;
distinct;
fetch {
  ""name"": $app.name
};"
290,Which software versions are dependent on version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:DEPENDS_ON]-(s:Software)
RETURN s.name AS software, s.versions AS versions","match
  $v isa version, has name ""7.1"";
  depends_on (dependent: $s, dependency: $v);
  $s isa software, has name $sname;
  has_version (versioned_software: $s, release_version: $ver);
  $ver has name $vname;
fetch {
  ""software"": $sname,
  ""version"": $vname
};"
291,Identify all machines running an application that listens on port 443.,"MATCH (m:Machine)-[:RUNS]->(a:Application)-[:LISTENS]->(p:Port {port: 443})
RETURN m.name","match
$m isa machine;
$a isa application;
$p isa port, has port_number 443;
runs (host_machine: $m, running_process: $a);
listens (listening_process: $a, listened_port: $p);
fetch {
  ""name"": $m.name
};"
292,How many different types of disks are there for machine types?,"MATCH (t:Type)
RETURN count(DISTINCT t.disk) AS numberOfDiskTypes","match
$t isa machine_type_spec, has disk $d;
select $d;
distinct;
reduce $count = count;"
293,What are the IP addresses of all networks in zone 3?,"MATCH (n:Network)
WHERE n.zone = 3
RETURN n.ip AS network_ip","match
$n isa network, has zone 3;
fetch {
  ""network_ip"": $n.ip
};"
294,List all services that are instances of the application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(service:Service)
RETURN service.name","match
$app isa application, has name ""webapp"";
$service isa service;
instance_of (running_instance: $service, template: $app);
fetch {
  ""name"": $service.name
};"
295,What are the names of all applications that depend on the process named '8966'?,"MATCH (p:Process {pid: 8966})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name","match
$p isa process, has pid 8966;
$a isa application;
depends_on (dependent: $a, dependency: $p);
fetch {
  ""name"": $a.name
};"
296,Show all ports that are connected to interfaces exposed by the router 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)-[:EXPOSES]->(p:Port)
RETURN p.port","match
  $r isa router, has name ""DC1-R-1"";
  routes (routing_device: $r, routed_interface: $i);
  exposes (exposing_interface: $i, exposed_port: $p);
fetch {
  ""port"": $p.port_number
};"
297,Find the first 3 machines in rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)
RETURN machine.name
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$machine isa machine;
holds (containing_rack: $rack, held_equipment: $machine);
limit 3;
fetch {
  ""machine_name"": $machine.name
};"
298,Identify the services running with a start time greater than 1607000000000.,"MATCH (s:Service)
WHERE s.startTime > 1607000000000
RETURN s.name, s.startTime","match
$s isa service, has name $n, has start_time $st;
$st > 1607000000000;
fetch {
  ""name"": $n,
  ""start_time"": $st
};"
299,Find the first 3 egress nodes in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $e);
$e isa egress;
limit 3;
fetch {
  ""name"": $e.name
};"
300,List all networks routing through interface with IP '10.2.1.1'.,"MATCH (i:Interface {ip: '10.2.1.1'})<-[:ROUTES]-(n:Network)
RETURN n.ip AS network_ip, n.size AS network_size, n.zone AS network_zone","match
$i isa interface, has ip ""10.2.1.1"";
$n isa network, has ip $nip, has size $s, has zone $z;
routes (routing_device: $n, routed_interface: $i);
fetch {
  ""network_ip"": $nip,
  ""network_size"": $s,
  ""network_zone"": $z
};"
301,List all Processes running on Machines within zone 3.,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(p:Process)
RETURN p.name AS ProcessName, p.startTime AS StartTime, p.pid AS PID","match
$z isa network_zone, has zone 3;
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $m, routed_interface: $i);
$m isa machine;
runs (host_machine: $m, running_process: $p);
$p isa process;
fetch {
  ""ProcessName"": $p.name,
  ""StartTime"": $p.start_time,
  ""PID"": $p.pid
};"
302,What type of Machines are in Rack 'DC1-RCK-1-1' and have more than 16 GB RAM?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
WHERE type.ram > 16
RETURN machine.name AS MachineName, type.name AS TypeName, type.ram AS RAM","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type has ram $ram;
$ram > 16;
fetch {
  ""MachineName"": $machine.name,
  ""TypeName"": $type.name,
  ""RAM"": $ram
};"
303,Provide the list of all machines that run the application named 'webapp'.,"MATCH (app:Application {name: 'webapp'})<-[:RUNS]-(machine:Machine)
RETURN machine.name","match
$app isa application, has name ""webapp"";
runs (host_machine: $machine, running_process: $app);
$machine isa machine;
fetch {
  ""machine_name"": $machine.name
};"
304,Which applications in DataCenter 'DC1' listen on port 80?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(app:Application)-[:LISTENS]->(p:Port {port: 80})
RETURN app.name AS applicationName","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $app);
$app isa application;
listens (listening_process: $app, listened_port: $p);
$p isa port, has port_number 80;
fetch {
  ""applicationName"": $app.name
};"
305,Find the top 3 types of services by start time in ascending order.,"MATCH (s:Service)
RETURN s.name AS service_name, s.startTime AS start_time
ORDER BY s.startTime ASC
LIMIT 3","match
$s isa service, has name $name, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""service_name"": $name,
  ""start_time"": $st
};"
306,What are the applications that depend on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name AS applicationName","match
$s isa service, has name ""java"";
$a isa application, has name $name;
depends_on (dependent: $a, dependency: $s);
fetch {
  ""applicationName"": $name
};"
307,List the first 3 previous versions to version named '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
$prev isa version;
{
  previous (newer_version: $v, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid1);
  previous (newer_version: $mid1, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid2);
  previous (newer_version: $mid2, older_version: $mid3);
  previous (newer_version: $mid3, older_version: $prev);
};
limit 3;
fetch { ""prev.name"": $prev.name };"
308,Which services are instances of the software 'RHEL'?,"MATCH (s:Service)-[:INSTANCE]->(sw:Software {name: 'RHEL'})
RETURN s.name AS service_name","match
$s isa service, has name $sn;
$sw isa software, has name ""RHEL"";
instance_of (running_instance: $s, template: $sw);
fetch {
  ""service_name"": $sn
};"
309,Find the top 3 applications by PID running in zone 4.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name AS application, a.pid AS pid
ORDER BY a.pid DESC
LIMIT 3","match
  $z isa network_zone, has zone 4;
  routes (routing_device: $z, routed_interface: $i);
  routes (routing_device: $m, routed_interface: $i);
  $m isa machine;
  runs (host_machine: $m, running_process: $a);
  $a isa application, has pid $pid;
sort $pid desc;
limit 3;
fetch {
  ""application"": $a.name,
  ""pid"": $pid
};"
310,Identify all ports where the process named '9.4' is listening.,"MATCH (p:Process {name: '9.4'})-[:LISTENS]->(port:Port)
RETURN port.port AS listening_ports","match
$p isa process, has name ""9.4"";
listens (listening_process: $p, listened_port: $port);
$port isa port;
fetch {
  ""listening_ports"": $port.port_number
};"
311,List the versions of software that the service named 'java' depends on.,"MATCH (s:Service {name: 'java'})-[:INSTANCE]->(sw:Software)-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS version","match
$s isa service, has name ""java"";
instance_of (running_instance: $s, template: $sw);
$sw isa software;
depends_on (dependent: $sw, dependency: $v);
$v isa version;
fetch {
  ""version"": $v.name
};"
312,What are the dependencies of the application named 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$app isa application, has name ""webapp"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
313,Provide the details of the first 3 machines in rack 'DC1-RCK-4-9' that run a type 'xl' configuration.,"MATCH (rack:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type {type: 'xl'})
RETURN machine.name, type.name, type.ram, type.cpu, type.disk
LIMIT 3","match
  $rack isa rack, has name ""DC1-RCK-4-9"";
  holds (containing_rack: $rack, held_equipment: $machine);
  $machine isa machine;
  typed_as (machine: $machine, spec: $type);
  $type isa machine_type_spec, has machine_type ""xl"";
limit 3;
fetch {
  ""machine_name"": $machine.name,
  ""type_name"": $type.name,
  ""ram"": $type.ram,
  ""cpu"": $type.cpu,
  ""disk"": $type.disk
};"
314,List the names of all applications that depend on the process named '9.4'.,"MATCH (p:Process {name: '9.4'})&lt;-[:DEPENDS_ON]-(a:Application)
RETURN a.name","match
$p isa process, has name ""9.4"";
$a isa application;
depends_on (dependent: $a, dependency: $p);
fetch {
  ""name"": $a.name
};"
315,What are the different types of services running on machines in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN DISTINCT service.name AS ServiceType","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service;
select $service;
distinct;
fetch { ""ServiceType"": $service.name };"
316,Identify the first 3 racks in zone 1 that contain more than 5 machines.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 1
WITH r, count(m) as machineCount
WHERE machineCount > 5
RETURN r.name
ORDER BY r.name
LIMIT 3","match
$r isa rack, has zone 1;
$m isa machine;
holds (containing_rack: $r, held_equipment: $m);
reduce $count = count($m) groupby $r;
match $count > 5;
$r has name $n;
sort $n asc;
limit 3;
fetch { ""name"": $n };"
317,Find the switches that route to interface with IP '10.1.1.1'.,"MATCH (s:Switch)-[:ROUTES]->(i:Interface {ip: '10.1.1.1'})
RETURN s","match
$s isa switch;
$i isa interface, has ip ""10.1.1.1"";
routes (routing_device: $s, routed_interface: $i);
fetch {
  ""ip"": $s.ip
};"
318,List the most recent 3 applications started in DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(:Machine)-[:RUNS]->(app:Application)
RETURN app.name, app.startTime
ORDER BY app.startTime DESC
LIMIT 3","match
  $dc isa data_center, has name ""DC1"";
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack;
  holds (containing_rack: $rack, held_equipment: $machine);
  $machine isa machine;
  runs (host_machine: $machine, running_process: $app);
  $app isa application, has start_time $st;
sort $st desc;
limit 3;
fetch {
  ""name"": $app.name,
  ""startTime"": $st
};"
319,What software versions are dependencies for the software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
$v isa version, has name $version_name;
depends_on (dependent: $s, dependency: $v);
fetch {
  ""version"": $version_name
};"
320,Provide a list of all OS instances with a start time before 1606000000000.,"MATCH (os:OS)
WHERE os.startTime < 1606000000000
RETURN os.name, os.startTime","match
$os isa os, has start_time $st;
$st < 1606000000000;
fetch {
  ""name"": $os.name,
  ""start_time"": $st
};"
321,Find the top 3 types of applications by PID in descending order.,"MATCH (a:Application)
RETURN a.name AS application, a.pid AS pid
ORDER BY pid DESC
LIMIT 3","match
$a isa application, has pid $pid;
sort $pid desc;
limit 3;
fetch {
  ""application"": $a.name,
  ""pid"": $pid
};"
322,Which interfaces are connected to the egress node 'DC1-RE'?,"MATCH (e:Egress {name: 'DC1-RE'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$e isa egress, has name ""DC1-RE"";
routes (routing_device: $e, routed_interface: $i);
$i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
323,Display the first 3 machines with type 'm' in their configurations.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'm'})
RETURN m.name
LIMIT 3","match
$m isa machine;
$t isa machine_type_spec, has machine_type ""m"";
typed_as (machine: $m, spec: $t);
limit 3;
fetch {
  ""name"": $m.name
};"
324,Identify all services that a process named '9.4' depends on.,"MATCH (p:Process {name: '9.4'})-[:DEPENDS_ON]->(s:Service)
RETURN s.name","match
$p isa process, has name ""9.4"";
$s isa service, has name $n;
depends_on (dependent: $p, dependency: $s);
fetch {
  ""name"": $n
};"
325,List the first 3 processes that depend on the service 'java'.,"MATCH (service:Service {name: 'java'})<-[:DEPENDS_ON]-(process:Process)
RETURN process.name, process.startTime, process.pid
ORDER BY process.startTime
LIMIT 3","match
$service isa service, has name ""java"";
$process isa process, has name $pname, has start_time $st, has pid $pid;
depends_on (dependent: $process, dependency: $service);
sort $st;
limit 3;
fetch {
  ""name"": $pname,
  ""start_time"": $st,
  ""pid"": $pid
};"
326,What are the types and quantities of machines held in rack 'DC1-RCK-4-9'?,"MATCH (rack:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name AS machineType, COUNT(machine) AS quantity","match
$rack isa rack, has name ""DC1-RCK-4-9"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type has name $type_name;
reduce $quantity = count($machine) groupby $type_name;"
327,Show the first 3 racks in zone 4 of DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})
RETURN r.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa rack, has zone 4;
limit 3;
fetch {
  ""name"": $r.name
};"
328,Which racks are in zone 1 and have more than 5 machines?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 1
WITH r, count(m) AS machineCount
WHERE machineCount > 5
RETURN r.name AS rackName","match
$r isa rack, has zone 1;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
reduce $count = count($m) groupby $r;
match $count > 5;
fetch { ""rackName"": $r.name };"
329,What are the first 5 IP addresses of interfaces connected to network '10.3'?,"MATCH (network:Network {ip: '10.3'})−[:ROUTES]−>(interface:Interface)
RETURN interface.ip
LIMIT 5","match
  $network isa network, has ip ""10.3"";
  routes (routing_device: $network, routed_interface: $interface);
  $interface isa interface;
limit 5;
fetch {
  ""ip"": $interface.ip
};"
330,List the top 5 most used process names in the database.,"MATCH (p:Process)
RETURN p.name AS processName, COUNT(p) AS usageCount
ORDER BY usageCount DESC
LIMIT 5","match
$p isa process, has name $n;
reduce $count = count($p) groupby $n;
sort $count desc;
limit 5;
fetch {
  ""processName"": $n,
  ""usageCount"": $count
};"
331,How many types of machines have a RAM capacity of 256 or more?,"MATCH (t:Type)
WHERE t.ram >= 256
RETURN count(t) AS numberOfMachineTypes","match
$t isa machine_type_spec, has ram $r;
$r >= 256;
reduce $count = count($t);"
332,How many types of machines have a RAM greater than 64?,"MATCH (t:Type)
WHERE t.ram > 64
RETURN count(DISTINCT t.type) AS numberOfMachineTypes","match
$t isa machine_type_spec, has ram $r, has machine_type $mt;
$r > 64;
select $mt;
distinct;
reduce $count = count;"
333,What type of machine is 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:TYPE]->(t:Type)
RETURN t.type AS machineType","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
typed_as (machine: $m, spec: $t);
fetch {
  ""machineType"": $t.machine_type
};"
334,Which services are instances of version '9.4'?,"MATCH (v:Version {name: '9.4'})<-[:INSTANCE]-(s:Service)
RETURN s.name AS service_name","match
$v isa version, has name ""9.4"";
$s isa service;
instance_of (running_instance: $s, template: $v);
fetch {
  ""service_name"": $s.name
};"
335,List all interfaces that connect racks in zone 4.,"MATCH (r1:Rack {zone: 4})-[:HOLDS]->(m1:Machine)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m2:Machine)<-[:HOLDS]-(r2:Rack {zone: 4})
RETURN DISTINCT i.ip AS InterfaceIP","match
$r1 isa rack, has zone 4;
$r2 isa rack, has zone 4;
holds (containing_rack: $r1, held_equipment: $m1);
holds (containing_rack: $r2, held_equipment: $m2);
$m1 isa machine;
$m2 isa machine;
routes (routing_device: $m1, routed_interface: $i);
routes (routing_device: $m2, routed_interface: $i);
not { $r1 is $r2; };
$i has ip $ip;
select $ip;
distinct;
fetch { ""InterfaceIP"": $ip };"
336,What are the properties of the network with IP '10.3'?,"MATCH (n:Network {ip: '10.3'})
RETURN n.ip AS ip, n.size AS size, n.zone AS zone","match
$n isa network, has ip ""10.3"";
fetch {
  ""ip"": $n.ip,
  ""size"": $n.size,
  ""zone"": $n.zone
};"
337,Which machines in DataCenter 'DC1' run an OS named 'RHEL'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name AS machine_name","match
$dc isa data_center, has name ""DC1"";
$r isa rack;
dc_contains (data_center: $dc, contained_equipment: $r);
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $os);
$os isa os, has name ""RHEL"";
fetch {
  ""machine_name"": $m.name
};"
338,Identify all ports that the OS running on 'DC1-RCK-4-9-M-103' listens to.,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(os:OS)-[:INSTANCE]->(v:Version)<-[:INSTANCE]-(p:Process)-[:LISTENS]->(port:Port)
RETURN port.port","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
runs (host_machine: $m, running_process: $os);
$os isa os;
instance_of (running_instance: $os, template: $v);
$v isa version;
instance_of (running_instance: $p, template: $v);
$p isa process;
listens (listening_process: $p, listened_port: $port);
$port isa port;
fetch {
  ""port"": $port.port_number
};"
339,Which applications are instances of software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]->(a:Application)
RETURN a.name AS applicationName","match
$s isa software, has name ""RHEL"";
$a isa application;
instance_of (running_instance: $a, template: $s);
fetch {
  ""applicationName"": $a.name
};"
340,What are the names of the types with a CPU count greater than 16?,"MATCH (t:Type)
WHERE t.cpu > 16
RETURN t.name","match
$t isa machine_type_spec, has cpu $c, has name $n;
$c > 16;
fetch {
  ""name"": $n
};"
341,List the start times of all processes running on machines in zone 2.,"MATCH (z:Zone {zone: 2})-[:ROUTES]->(:Interface)<-[:ROUTES]-(:Switch)<-[:HOLDS]-(r:Rack {zone: 2})-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)
RETURN p.startTime","match
$nz isa network_zone, has zone 2;
routes (routing_device: $nz, routed_interface: $i);
$i isa interface;
routes (routing_device: $sw, routed_interface: $i);
$sw isa switch;
holds (containing_rack: $r, held_equipment: $sw);
$r isa rack, has zone 2;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $p);
$p isa process;
fetch {
  ""startTime"": $p.start_time
};"
342,Who are the dependencies of version '9.4' in the software ecosystem?,"MATCH (v:Version {name: '9.4'})&lt;-[:VERSION]-(s:Software)-[:DEPENDS_ON]->(dep)
RETURN dep.name AS DependencyName","match
  $v isa version, has name ""9.4"";
  has_version (versioned_software: $s, release_version: $v);
  depends_on (dependent: $s, dependency: $dep);
fetch {
  ""DependencyName"": $dep.name
};"
343,What are the IPs of all switches in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})--[:CONTAINS]->(rack:Rack)-[:HOLDS]->(switch:Switch)
RETURN switch.ip AS switch_ip","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
fetch {
  ""switch_ip"": $switch.ip
};"
344,Which DataCenter routers connect to the interface with IP '10.0.0.254'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)-[:ROUTES]->(i:Interface {ip: '10.0.0.254'})
RETURN dc.name AS DataCenter, r.name AS Router","match
$dc isa data_center;
$r isa router;
$i isa interface, has ip ""10.0.0.254"";
dc_contains (data_center: $dc, contained_equipment: $r);
routes (routing_device: $r, routed_interface: $i);
fetch {
  ""DataCenter"": $dc.name,
  ""Router"": $r.name
};"
345,Which interfaces are routed by network '10.2'?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$n isa network, has ip ""10.2"";
routes (routing_device: $n, routed_interface: $i);
$i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
346,"List all services that a specific application depends on, for example, 'webserver'.","MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(service:Service)
RETURN service.name","match
$app isa application, has name ""webserver"";
$service isa service, has name $n;
depends_on (dependent: $app, dependency: $service);
fetch {
  ""service_name"": $n
};"
348,Which racks contain switches with IP starting with '10.1'?,"MATCH (rack:Rack)-[:HOLDS]->(switch:Switch)
WHERE switch.ip STARTS WITH '10.1'
RETURN rack.name","match
$rack isa rack;
$switch isa switch, has ip $ip;
$ip like ""10.1.*"";
holds (containing_rack: $rack, held_equipment: $switch);
fetch {
  ""rack_name"": $rack.name
};"
349,What are the names of all applications running on machines in zone 3?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 3})-[:HOLDS]->(machine:Machine)-[:RUNS]->(app:Application)
RETURN DISTINCT app.name AS application_name","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has zone 3;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application;
select $app;
distinct;
fetch {
  ""application_name"": $app.name
};"
350,Which racks are located in zone 1 of the DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 1})
RETURN r.name AS rackName","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 1;
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""rackName"": $r.name
};"
351,List all ports listened to by the service running on machine 'DC1-RCK-4-9-M-103'.,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(s:Service)-[:LISTENS]->(p:Port)
RETURN p.port AS port","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
runs (host_machine: $m, running_process: $s);
$s isa service;
listens (listening_process: $s, listened_port: $p);
fetch {
  ""port"": $p.port_number
};"
352,What are the dependencies of the web application named 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$app isa application, has name ""webserver"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
353,Find all interfaces connected to '10.0.0.254'.,"MATCH (i1:Interface {ip: '10.0.0.254'})-[:CONNECTS]-(i2:Interface)
RETURN i2.ip AS connected_interfaces","match
  $i1 isa interface, has ip ""10.0.0.254"";
  $i2 isa interface;
  connects ($i1, $i2);
  not { $i1 is $i2; };
fetch {
  ""connected_interfaces"": $i2.ip
};"
354,Which zones have a size of 16?,"MATCH (z:Zone)
WHERE z.size = 16
RETURN z.zone AS zone","match
$z isa network_zone, has size 16, has zone $zone;
fetch {
  ""zone"": $zone
};"
355,What is the start time of the process running on machine 'DC1-RCK-4-9-M-103'?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(p:Process)
RETURN p.startTime","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
runs (host_machine: $m, running_process: $p);
$p isa process;
fetch {
  ""start_time"": $p.start_time
};"
356,List the previous versions of version '9.4'.,"MATCH (v:Version {name: '9.4'})-[:PREVIOUS]->(prev:Version)
RETURN prev.name AS previous_version","match
$v isa version, has name ""9.4"";
previous (newer_version: $v, older_version: $prev);
$prev isa version, has name $prev_name;
fetch {
  ""previous_version"": $prev_name
};"
357,What types of software depend on the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})<-[:DEPENDS_ON]-(dependentSoftware:Software)
RETURN dependentSoftware.name AS DependentSoftware","match
$s isa software, has name ""RHEL"";
$dep isa software, has name $dep_name;
depends_on (dependent: $dep, dependency: $s);
fetch {
  ""DependentSoftware"": $dep_name
};"
358,What is the disk capacity of the type 'm-4/16/25'?,"MATCH (t:Type {name: 'm-4/16/25'})
RETURN t.disk AS disk_capacity","match
$t isa machine_type_spec, has name ""m-4/16/25"";
fetch {
  ""disk_capacity"": $t.disk
};"
359,What are the names of the services that depend on the process named '8966'?,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(s:Service)
RETURN s.name","match
  $p isa process, has pid 8966;
  depends_on (dependent: $p, dependency: $s);
  $s isa service;
fetch {
  ""name"": $s.name
};"
360,List the top 3 zones by size.,"MATCH (z:Zone)
RETURN z.zone, z.size
ORDER BY z.size DESC
LIMIT 3","match
$z isa network_zone, has zone $zone, has size $s;
sort $s desc;
limit 3;
fetch {
  ""zone"": $zone,
  ""size"": $s
};"
361,Identify all machines that run more than one type of application.,"MATCH (m:Machine)-[:RUNS]->(a:Application)
WITH m, COUNT(DISTINCT a) AS appCount
WHERE appCount > 1
RETURN m.name","match
$m isa machine;
$a isa application;
runs (host_machine: $m, running_process: $a);
reduce $app_count = count($a) groupby $m;
match
$app_count > 1;
fetch {
  ""name"": $m.name
};"
362,Which machines are connected to the interface with IP '10.1.1'?,"MATCH (i:Interface {ip: '10.1.1'})&lt;-[:ROUTES]-(m:Machine)
RETURN m.name","match
$i isa interface, has ip ""10.1.1"";
$m isa machine;
routes (routing_device: $m, routed_interface: $i);
fetch {
  ""name"": $m.name
};"
363,Identify all services that started before timestamp 1606200000000.,"MATCH (s:Service)
WHERE s.startTime < 1606200000000
RETURN s.name, s.startTime","match
$s isa service, has name $n, has start_time $st;
$st < 1606200000000;
fetch {
  ""name"": $n,
  ""start_time"": $st
};"
364,What are the software dependencies for the application 'logstash'?,"MATCH (app:Application {name: 'logstash'})-[:INSTANCE]->(software:Software)
MATCH (software)-[:DEPENDS_ON]->(dependency:Software)
RETURN DISTINCT dependency.name AS SoftwareDependencies","match
$app isa application, has name ""logstash"";
instance_of (running_instance: $app, template: $software);
$software isa software;
depends_on (dependent: $software, dependency: $dep);
$dep isa software;
fetch {
  ""SoftwareDependencies"": $dep.name
};"
365,List all versions of software that are previous to version '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS]->(prev:Version)
RETURN prev.name AS previous_versions","match
$v isa version, has name ""7.1"";
previous (newer_version: $v, older_version: $prev);
$prev has name $prev_name;
fetch {
  ""previous_versions"": $prev_name
};"
366,Which data center contains the egress named 'DC1-RE'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(e:Egress {name: 'DC1-RE'})
RETURN dc.name AS DataCenterName","match
$dc isa data_center;
$e isa egress, has name ""DC1-RE"";
dc_contains (data_center: $dc, contained_equipment: $e);
fetch {
  ""DataCenterName"": $dc.name
};"
367,How many different ports are used by applications named 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:LISTENS]->(port:Port)
RETURN COUNT(DISTINCT port.port) AS numberOfPorts","match
$app isa application, has name ""webserver"";
listens (listening_process: $app, listened_port: $port);
$port isa port, has port_number $pn;
reduce $count = count($pn);"
368,What are the IP addresses of interfaces connected to the network '10.3'?,"MATCH (n:Network {ip: '10.3'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$n isa network, has ip ""10.3"";
routes (routing_device: $n, routed_interface: $i);
$i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
369,Find all machines running an OS that started after timestamp 1606000000000.,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.startTime > 1606000000000
RETURN m.name","match
$m isa machine;
$os isa os, has start_time $st;
runs (host_machine: $m, running_process: $os);
$st > 1606000000000;
fetch {
  ""name"": $m.name
};"
370,Which zones have a size of 16?,"MATCH (z:Zone)
WHERE z.size = 16
RETURN z.zone AS zone","match
$z isa network_zone, has size 16, has zone $zone;
fetch {
  ""zone"": $zone
};"
371,List the names of all racks contained within the data center 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack.name","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
fetch {
  ""name"": $rack.name
};"
372,What is the maximum disk size available in the type 'xl'?,"MATCH (t:Type {type: 'xl'})
RETURN max(t.disk) AS max_disk_size","match
$t isa machine_type_spec, has machine_type ""xl"", has disk $d;
reduce $max_disk = max($d);"
373,Which types of machines (type names) have a CPU greater than 16?,"MATCH (t:Type)
WHERE t.cpu > 16
RETURN t.name AS typeName","match
$t isa machine_type_spec, has cpu $c, has name $n;
$c > 16;
fetch {
  ""typeName"": $n
};"
374,How many applications are dependent on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN count(a) AS numberOfDependentApplications","match
$s isa service, has name ""java"";
$a isa application;
depends_on (dependent: $a, dependency: $s);
reduce $count = count($a);"
375,List all services listening on port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name","match
$s isa service;
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
fetch {
  ""name"": $s.name
};"
376,What are the dependencies of the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(d)
RETURN d.name AS DependencyName","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $d);
$d has name $dn;
fetch {
  ""DependencyName"": $dn
};"
377,Find all networks routing through the interface with IP '10.2.8.254'.,"MATCH (i:Interface {ip: '10.2.8.254'})<-[:ROUTES]-(n:Network)
RETURN n.ip AS network_ip, n.size AS network_size, n.zone AS network_zone","match
$i isa interface, has ip ""10.2.8.254"";
$n isa network;
routes (routing_device: $n, routed_interface: $i);
fetch {
  ""network_ip"": $n.ip,
  ""network_size"": $n.size,
  ""network_zone"": $n.zone
};"
378,Identify the ports exposed by the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
$p isa port;
fetch {
  ""exposed_ports"": $p.port_number
};"
379,Which interfaces are connected to the router named 'DC1-R-2'?,"MATCH (r:Router {name: 'DC1-R-2'})-->[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$r isa router, has name ""DC1-R-2"";
routes (routing_device: $r, routed_interface: $i);
$i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
380,What are the top 3 applications by number of instances running on machines?,"MATCH (m:Machine)-[:RUNS]->(a:Application)
WITH a.name AS appName, COUNT(m) AS instanceCount
RETURN appName, instanceCount
ORDER BY instanceCount DESC
LIMIT 3","match
$a isa application, has name $name;
$m isa machine;
runs (host_machine: $m, running_process: $a);
reduce $count = count($m) groupby $a, $name;
sort $count desc;
limit 3;
fetch { ""appName"": $name, ""instanceCount"": $count };"
381,Show all processes that are instances of the software version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name, p.startTime, p.pid","match
  $v isa version, has name ""7.1"";
  instance_of (template: $v, running_instance: $p);
  $p isa process;
fetch {
  ""name"": $p.name,
  ""startTime"": $p.start_time,
  ""pid"": $p.pid
};"
383,Which machines are running the application named 'crm'?,"MATCH (app:Application {name: 'crm'})<-[:RUNS]-(machine:Machine)
RETURN machine.name","match
$app isa application, has name ""crm"";
runs (host_machine: $machine, running_process: $app);
$machine isa machine;
fetch {
  ""machine_name"": $machine.name
};"
384,List all software versions that depend on 'RHEL'.,"MATCH (s:Software)-[:DEPENDS_ON]->(v:Version)<-[:INSTANCE]-(os:OS {name: 'RHEL'})
RETURN DISTINCT v.name AS version","match
$s isa software;
depends_on (dependent: $s, dependency: $v);
$v isa version;
instance_of (running_instance: $os, template: $v);
$os isa os, has name ""RHEL"";
$v has name $version;
select $version;
distinct;
fetch {
  ""version"": $version
};"
385,What are the names of all switches in rack 5?,"MATCH (rack:Rack {rack: 5})-[:HOLDS]->(switch:Switch)
RETURN switch.name","match
$rack isa rack, has rack_number 5;
holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
fetch {
  ""switch_ip"": $switch.ip
};"
386,Which routers are located in zone 2?,"MATCH (r:Router)
WHERE r.zone = 2
RETURN r.name","match
$r isa router, has zone 2;
fetch {
  ""name"": $r.name
};"
387,Which applications listen to port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(a:Application)
RETURN a.name AS applicationName","match
$p isa port, has port_number 80;
listens (listening_process: $a, listened_port: $p);
$a isa application;
fetch {
  ""applicationName"": $a.name
};"
388,What versions of software does the software 'RHEL' depend on?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
$v isa version, has name $version_name;
depends_on (dependent: $s, dependency: $v);
fetch {
  ""version"": $version_name
};"
389,What is the total number of machines held in zone 4 racks?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 4
RETURN count(m) AS total_machines","match
$r isa rack, has zone 4;
$m isa machine;
holds (containing_rack: $r, held_equipment: $m);
reduce $total_machines = count($m);"
390,Display the top 3 services that started after timestamp 1606165629748.,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s.name, s.startTime
ORDER BY s.startTime DESC
LIMIT 3","match
$s isa service, has start_time $st;
$st > 1606165629748;
sort $st desc;
limit 3;
fetch {
  ""name"": $s.name,
  ""startTime"": $st
};"
391,Show the earliest start time of any process running on machine 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN min(p.startTime) AS earliestStartTime","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $p);
$p isa process, has start_time $st;
reduce $earliest = min($st);"
392,List all ports exposed by the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
fetch {
  ""exposed_ports"": $p.port_number
};"
393,List the first 3 networks that route through interfaces in zone 2.,"MATCH (zone:Zone {zone: 2})-[:ROUTES]->(interface:Interface)<-[:ROUTES]-(network:Network)
RETURN network.ip
LIMIT 3","match
  $z isa network_zone, has zone 2;
  routes (routing_device: $z, routed_interface: $i);
  $n isa network;
  routes (routing_device: $n, routed_interface: $i);
limit 3;
fetch {
  ""ip"": $n.ip
};"
394,Which ports are listened by all instances of the application 'webserver'?,"MATCH (app:Application {name: 'webserver'})-[:LISTENS]->(port:Port)
RETURN DISTINCT port.port AS listened_ports","match
$app isa application, has name ""webserver"";
listens (listening_process: $app, listened_port: $port);
$port has port_number $pn;
select $pn;
distinct;
fetch { ""listened_ports"": $pn };"
395,What are the first 3 services that a machine named 'DC1-RCK-4-9-M-103' runs?,"MATCH (m:Machine {name: 'DC1-RCK-4-9-M-103'})-[:RUNS]->(s:Service)
RETURN s.name
ORDER BY s.startTime
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-4-9-M-103"";
$s isa service, has start_time $st;
runs (host_machine: $m, running_process: $s);
sort $st asc;
limit 3;
fetch {
  ""name"": $s.name
};"
396,Which rack holds the most switches in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)-[:HOLDS]->(switch:Switch)
WITH rack, count(switch) AS switch_count
RETURN rack.name AS rack_name, switch_count
ORDER BY switch_count DESC
LIMIT 1","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
$rel isa holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
reduce $switch_count = count($rel) groupby $rack;
sort $switch_count desc;
limit 1;
fetch { ""rack_name"": $rack.name, ""switch_count"": $switch_count };"
398,List the first 3 machines in zone 4 that run an application named 'logstash'.,"MATCH (zone:Zone {zone: 4})-[:ROUTES]->(interface:Interface)<-[:ROUTES]-(machine:Machine)-[:RUNS]->(application:Application {name: 'logstash'})
RETURN machine.name
LIMIT 3","match
$zone isa network_zone, has zone 4;
routes (routing_device: $zone, routed_interface: $iface);
routes (routing_device: $machine, routed_interface: $iface);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application, has name ""logstash"";
limit 3;
fetch {
  ""machine_name"": $machine.name
};"
399,Which type of machine has the highest average CPU in the schema?,"MATCH (t:Type)
RETURN t.name AS machineType, AVG(t.cpu) AS averageCPU
ORDER BY averageCPU DESC
LIMIT 1","match
$t isa machine_type_spec, has name $n, has cpu $c;
sort $c desc;
limit 1;
fetch {
  ""machineType"": $n,
  ""averageCPU"": $c
};"
400,What are the top 3 earliest starting processes in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)
RETURN p.name, p.startTime
ORDER BY p.startTime ASC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa rack;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $p);
$p isa process, has name $pname, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $pname,
  ""startTime"": $st
};"
401,List the first 3 services that started after timestamp 1606165629748.,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s.name, s.startTime
ORDER BY s.startTime
LIMIT 3","match
$s isa service, has start_time $st;
$st > 1606165629748;
sort $st asc;
limit 3;
fetch {
  ""name"": $s.name,
  ""startTime"": $st
};"
402,What is the total number of interfaces that expose port 80 in the schema?,"MATCH (i:Interface)-[:EXPOSES]->(p:Port {port: 80})
RETURN count(i) AS total_interfaces","match
$i isa interface;
$p isa port, has port_number 80;
exposes (exposing_interface: $i, exposed_port: $p);
reduce $total = count($i);"
403,Which process listens on the highest port number in the schema?,"MATCH (p:Process)-[:LISTENS]->(port:Port)
RETURN p.name AS process_name, port.port AS port_number
ORDER BY port_number DESC
LIMIT 1","match
$p isa process, has name $pn;
$port isa port, has port_number $pnum;
listens (listening_process: $p, listened_port: $port);
sort $pnum desc;
limit 1;
fetch {
  ""process_name"": $pn,
  ""port_number"": $pnum
};"
404,List the first 3 machines that run a service instance named 'java'.,"MATCH (m:Machine)-[:RUNS]->(s:Service {name: 'java'})
RETURN m.name
LIMIT 3","match
$m isa machine, has name $mn;
$s isa service, has name ""java"";
runs (host_machine: $m, running_process: $s);
limit 3;
fetch {
  ""machine_name"": $mn
};"
405,What are the first 3 applications that depend on processes within zone 3?,"MATCH (zone:Zone {zone: 3})-[:ROUTES]->(interface:Interface)<-[:ROUTES]-(machine:Machine)-[:RUNS]->(process:Process)<-[:DEPENDS_ON]-(application:Application)
RETURN DISTINCT application.name
LIMIT 3","match
  $zone isa network_zone, has zone 3;
  routes (routing_device: $zone, routed_interface: $iface);
  $iface isa interface;
  routes (routing_device: $machine, routed_interface: $iface);
  $machine isa machine;
  runs (host_machine: $machine, running_process: $process);
  $process isa process;
  depends_on (dependent: $app, dependency: $process);
  $app isa application;
select $app;
distinct;
limit 3;
fetch {
  ""name"": $app.name
};"
406,Which applications are dependent on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name AS applicationName","match
$s isa service, has name ""java"";
$a isa application;
depends_on (dependent: $a, dependency: $s);
fetch {
  ""applicationName"": $a.name
};"
407,What are the top 3 previous versions of the version '7.1' in the schema?,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name AS previous_version
ORDER BY prev.name DESC
LIMIT 3","match
  $v isa version, has name ""7.1"";
  {
    previous (newer_version: $v, older_version: $prev);
  } or {
    previous (newer_version: $v, older_version: $a);
    previous (newer_version: $a, older_version: $prev);
  } or {
    previous (newer_version: $v, older_version: $b);
    previous (newer_version: $b, older_version: $c);
    previous (newer_version: $c, older_version: $prev);
  };
  $prev has name $n;
sort $n desc;
limit 3;
fetch { ""previous_version"": $n };"
408,What are the dependencies of the software named 'RHEL' and their versions?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(d)
OPTIONAL MATCH (d)-[:VERSION]->(v:Version)
RETURN d.name AS Dependency, v.name AS Version","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $d);
$d has name $dn;
try {
  has_version (versioned_software: $d, release_version: $v);
  $v has name $vn;
};
fetch {
  ""Dependency"": $dn,
  ""Version"": $vn
};"
409,How many racks contain switches in zone 4 of DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack {zone: 4})-[:HOLDS]->(s:Switch)
RETURN count(DISTINCT r) AS numberOfRacksWithSwitches","match
$dc isa data_center, has name ""DC1"";
$r isa rack, has zone 4;
dc_contains (data_center: $dc, contained_equipment: $r);
$s isa switch;
holds (containing_rack: $r, held_equipment: $s);
select $r;
distinct;
reduce $count = count($r);"
410,What are the top 5 latest services started in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name, s.startTime
ORDER BY s.startTime DESC
LIMIT 5","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa rack;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $s);
$s isa service, has start_time $st;
sort $st desc;
limit 5;
fetch {
  ""name"": $s.name,
  ""startTime"": $st
};"
411,Which zones have switches with IP starting with '10.1'?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN DISTINCT z.zone AS Zone","match
$z isa network_zone, has zone $zone;
$s isa switch, has ip $ip;
$ip like ""^10\\.1.*"";
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $s, routed_interface: $i);
select $zone;
distinct;
fetch { ""Zone"": $zone };"
412,What is the total RAM of all types of machines grouped by their type in the DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-([:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.type AS machineType, SUM(t.ram) AS totalRAM
ORDER BY machineType","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has ram $ram, has machine_type $mt;
reduce $total_ram = sum($ram) groupby $mt;
sort $mt;"
413,List the first 3 processes that depend on the version '7.1'.,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name, p.startTime, p.pid
LIMIT 3","match
  $v isa version, has name ""7.1"";
  instance_of (running_instance: $p, template: $v);
  $p isa process, has name $n, has start_time $st, has pid $pid;
limit 3;
fetch {
  ""name"": $n,
  ""startTime"": $st,
  ""pid"": $pid
};"
414,Which switch is located in the highest rack number within DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Rack)
WITH dc, r
ORDER BY r.rack DESC
LIMIT 1
MATCH (r)-[:HOLDS]->(s:Switch)
RETURN s.ip AS switch_ip, r.name AS rack_name, r.rack AS rack_number","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa rack, has rack_number $rn;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
sort $rn desc;
limit 1;
fetch {
  ""switch_ip"": $s.ip,
  ""rack_name"": $r.name,
  ""rack_number"": $rn
};"
415,What is the type of the machine that runs the most applications in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(a:Application)
WITH m, count(a) as appCount
ORDER BY appCount DESC
LIMIT 1
MATCH (m)-[:TYPE]->(t:Type)
RETURN t.type AS machineType","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $a);
$a isa application;
reduce $app_count = count($a) groupby $m;
sort $app_count desc;
limit 1;
match
typed_as (machine: $m, spec: $t);
$t has machine_type $mt;
fetch { ""machineType"": $mt };"
416,How many interfaces are connected to 'DC1-R-2'?,"MATCH (router:Router {name: 'DC1-R-2'})-[:ROUTES]->(interface:Interface)
RETURN count(interface) AS numberOfInterfaces","match
$router isa router, has name ""DC1-R-2"";
routes (routing_device: $router, routed_interface: $interface);
reduce $count = count($interface);"
417,Which network has the smallest size and what is its IP?,"MATCH (n:Network)
RETURN n.ip AS ip, n.size AS size
ORDER BY n.size ASC
LIMIT 1","match
$n isa network, has size $s, has ip $ip;
sort $s asc;
limit 1;
fetch {
  ""ip"": $ip,
  ""size"": $s
};"
418,What are the first 3 processes that depend on version '7.1' in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)-[:INSTANCE]->(v:Version {name: '7.1'})
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
$rack isa rack;
dc_contains (data_center: $dc, contained_equipment: $rack);
$m isa machine;
holds (containing_rack: $rack, held_equipment: $m);
$p isa process;
runs (host_machine: $m, running_process: $p);
$v isa version, has name ""7.1"";
instance_of (running_instance: $p, template: $v);
$p has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $p.name,
  ""start_time"": $st,
  ""pid"": $p.pid
};"
419,Which racks in zone 1 contain more than one type of machine?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
WHERE r.zone = 1
WITH r, count(DISTINCT t) AS typeCount
WHERE typeCount > 1
RETURN r.name AS rackName","match
$r isa rack, has zone 1;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
select $r, $t;
distinct;
reduce $count = count($t) groupby $r;
match
$count > 1;
fetch { ""rackName"": $r.name };"
420,List the top 5 switches by IP in zone 4.,"MATCH (s:Switch)
WHERE s.ip STARTS WITH '10.4'
RETURN s.ip
ORDER BY s.ip
LIMIT 5","match
$s isa switch, has ip $ip;
$ip like ""10[.]4.*"";
sort $ip;
limit 5;
fetch {
  ""ip"": $ip
};"
421,What is the name of the router that routes the most networks in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network)
WITH r, count(n) AS networkCount
RETURN r.name AS routerName
ORDER BY networkCount DESC
LIMIT 1","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router;
routes (routing_device: $r, routed_interface: $i);
$i isa interface;
routes (routing_device: $n, routed_interface: $i);
$n isa network;
reduce $count = count($n) groupby $r;
sort $count desc;
limit 1;
fetch { ""routerName"": $r.name };"
422,What are the names of the first 3 processes that depend on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)
RETURN p.name
ORDER BY p.startTime
LIMIT 3","match
$s isa service, has name ""java"";
depends_on (dependent: $p, dependency: $s);
$p isa process, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $p.name
};"
423,Which 3 applications are instances of the software named 'RHEL' and their start times?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]-(a:Application)
RETURN a.name AS application_name, a.startTime AS start_time
LIMIT 3","match
$s isa software, has name ""RHEL"";
$a isa application;
instance_of (running_instance: $a, template: $s);
limit 3;
fetch {
  ""application_name"": $a.name,
  ""start_time"": $a.start_time
};"
424,Name the first 3 services that listen to port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name
LIMIT 3","match
$s isa service, has name $n;
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
limit 3;
fetch {
  ""name"": $n
};"
425,Which 3 zones have a size of 16 and are connected via interface IP '10.3.10.254'?,"MATCH (z:Zone {size: 16})-[:ROUTES]->(i:Interface {ip: '10.3.10.254'})
RETURN z.ip AS zone_ip
LIMIT 3","match
$z isa network_zone, has size 16;
$i isa interface, has ip ""10.3.10.254"";
routes (routing_device: $z, routed_interface: $i);
limit 3;
fetch { ""zone_ip"": $z.ip };"
426,What are the top 5 types of machines in terms of RAM and CPU available in the data center?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS type, t.ram AS ram, t.cpu AS cpu
ORDER BY t.ram DESC, t.cpu DESC
LIMIT 5","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has name $type_name, has ram $ram, has cpu $cpu;
sort $ram desc, $cpu desc;
limit 5;
fetch {
  ""type"": $type_name,
  ""ram"": $ram,
  ""cpu"": $cpu
};"
427,Identify the first 3 versions of the software running on the application 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:INSTANCE]->(software:Software)-[:VERSION]->(version:Version)
RETURN version.name
ORDER BY version.name
LIMIT 3","match
  $app isa application, has name ""webserver"";
  instance_of (running_instance: $app, template: $sw);
  $sw isa software;
  has_version (versioned_software: $sw, release_version: $v);
  $v has name $vn;
sort $vn;
limit 3;
fetch {
  ""version_name"": $vn
};"
428,List the first 3 applications that depend on the service named 'java'.,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'java'})
RETURN app.name
LIMIT 3","match
$app isa application, has name $n;
$service isa service, has name ""java"";
depends_on (dependent: $app, dependency: $service);
limit 3;
fetch { ""name"": $n };"
429,What are the names and IPs of the first 3 interfaces routed by the network with IP '10.2'?,"MATCH (network:Network {ip: '10.2'})-[:ROUTES]->(interface:Interface)
RETURN interface.name, interface.ip
LIMIT 3","match
$network isa network, has ip ""10.2"";
routes (routing_device: $network, routed_interface: $i);
$i isa interface, has ip $ip;
limit 3;
fetch {
  ""ip"": $ip
};"
430,Name the top 5 processes running on the machine with the name 'DC1-RCK-1-1-M-1'.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime DESC
LIMIT 5","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $p);
$p isa process, has start_time $st;
sort $st desc;
limit 5;
fetch {
  ""name"": $p.name,
  ""startTime"": $st,
  ""pid"": $p.pid
};"
431,What are the names of the first 3 services running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(s:Service)
RETURN s.name
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$s isa service;
runs (host_machine: $m, running_process: $s);
limit 3;
fetch {
  ""name"": $s.name
};"
432,Which 3 ports are exposed by the interface with IP '10.1.1'?,"MATCH (i:Interface {ip: '10.1.1'})--[:EXPOSES]->(p:Port)
RETURN p.port
LIMIT 3","match
$i isa interface, has ip ""10.1.1"";
exposes (exposing_interface: $i, exposed_port: $p);
$p isa port, has port_number $pn;
limit 3;
fetch {
  ""port"": $pn
};"
433,List the first 3 software versions used by the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name
ORDER BY v.name
LIMIT 3","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v has name $vn;
sort $vn;
limit 3;
fetch {
  ""version_name"": $vn
};"
434,List the first 3 services that started on applications named 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:RUNS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN service.name, service.startTime
ORDER BY service.startTime
LIMIT 3","match
  $app isa application, has name ""webserver"";
  runs (host_machine: $machine, running_process: $app);
  $service isa service, has start_time $st;
  runs (host_machine: $machine, running_process: $service);
sort $st asc;
limit 3;
fetch {
  ""name"": $service.name,
  ""startTime"": $st
};"
435,Identify the top 5 machines held in rack 'DC1-RCK-1-10' and their types.,"MATCH (rack:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN machine.name AS machine_name, type.name AS type_name
LIMIT 5","match
$rack isa rack, has name ""DC1-RCK-1-10"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
limit 5;
fetch {
  ""machine_name"": $machine.name,
  ""type_name"": $type.name
};"
436,Name the first 3 applications running on the machine located in rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(application:Application)
RETURN application.name
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application;
limit 3;
fetch { ""name"": $app.name };"
437,Which 3 networks are routed to the interface with the IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})&lt;-[:ROUTES]-(n:Network)
RETURN n.ip
LIMIT 3","match
$i isa interface, has ip ""10.0.0.254"";
$n isa network;
routes (routing_device: $n, routed_interface: $i);
limit 3;
fetch {
  ""ip"": $n.ip
};"
438,List the top 5 IP addresses of interfaces connected to the router named 'DC1-R-1'.,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i.ip
LIMIT 5","match
$r isa router, has name ""DC1-R-1"";
routes (routing_device: $r, routed_interface: $i);
$i isa interface, has ip $ip;
limit 5;
fetch {
  ""ip"": $ip
};"
439,What are the names of the first 3 routers located in zone 1 in the data center?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router {zone: 1})
RETURN r.name
ORDER BY r.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
$r isa router, has zone 1;
dc_contains (data_center: $dc, contained_equipment: $r);
$r has name $n;
sort $n asc;
limit 3;
fetch {
  ""name"": $n
};"
440,List the first 3 machines that run the latest version of the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
WITH s, v
ORDER BY v.name DESC
LIMIT 1
MATCH (m:Machine)-[:RUNS]->(:OS {name: 'RHEL'})-[:INSTANCE]->(v)
RETURN m.name
LIMIT 3","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v has name $vn;
not {
  has_version (versioned_software: $s, release_version: $v2);
  $v2 has name $vn2;
  $vn2 > $vn;
};
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $v);
runs (host_machine: $m, running_process: $os);
$m has name $mn;
limit 3;
fetch { ""name"": $mn };"
441,Which applications are running on machines that type 'l'?,MATCH (t:Type {type: 'l'})\u003c-[:TYPE]-(m:Machine)-[:RUNS]->(a:Application)\nRETURN a.name AS application_name,"match
$t isa machine_type_spec, has machine_type ""l"";
typed_as (machine: $m, spec: $t);
runs (host_machine: $m, running_process: $a);
$a isa application;
fetch {
  ""application_name"": $a.name
};"
442,What are the direct and indirect dependencies of the process named '8966'?,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON*]->(dependency)
RETURN DISTINCT dependency","match
  $p isa process, has pid 8966;
  depends_on (dependent: $p, dependency: $dependency);
fetch {
  ""dependency"": $dependency
};"
443,List the first 3 applications that depend on the service named 'logstash'.,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'logstash'})
RETURN app.name
LIMIT 3","match
$app isa application;
$service isa service, has name ""logstash"";
depends_on (dependent: $app, dependency: $service);
limit 3;
fetch {
  ""app_name"": $app.name
};"
444,Which interface connects the most networks in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network)
WITH i, count(n) as networkCount
RETURN i.ip as interfaceIP, networkCount
ORDER BY networkCount DESC
LIMIT 1","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa router;
routes (routing_device: $r, routed_interface: $i);
$i isa interface;
routes (routing_device: $n, routed_interface: $i);
$n isa network;
reduce $networkCount = count($n) groupby $i;
sort $networkCount desc;
limit 1;
fetch { ""interfaceIP"": $i.ip, ""networkCount"": $networkCount };"
445,What are the total CPU resources allocated to machines in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN SUM(type.cpu) AS total_cpu_resources","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type has cpu $cpu;
reduce $total_cpu = sum($cpu);"
446,List the top 3 processes that listen on port 80.,"MATCH (p:Process)-[:LISTENS]->(port:Port {port: 80})
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime DESC
LIMIT 3","match
$p isa process, has name $n, has start_time $st, has pid $pid;
$port isa port, has port_number 80;
listens (listening_process: $p, listened_port: $port);
sort $st desc;
limit 3;
fetch {
  ""name"": $n,
  ""start_time"": $st,
  ""pid"": $pid
};"
447,Which services started the earliest in application 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(service:Service)
RETURN service.name, service.startTime
ORDER BY service.startTime ASC
LIMIT 1","match
  $app isa application, has name ""webapp"";
  depends_on (dependent: $app, dependency: $service);
  $service isa service, has start_time $st;
sort $st asc;
limit 1;
fetch {
  ""name"": $service.name,
  ""start_time"": $st
};"
448,What are the names of the first 3 racks contained within the data center 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack)
RETURN rack.name
ORDER BY rack.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has name $n;
sort $n;
limit 3;
fetch {
  ""name"": $n
};"
449,List the first 3 previous versions of the version named '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
$prev isa version, has name $prev_name;
{
  previous (newer_version: $v, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid1);
  previous (newer_version: $mid1, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $mid2);
  previous (newer_version: $mid2, older_version: $mid3);
  previous (newer_version: $mid3, older_version: $prev);
};
limit 3;
fetch { ""prev_name"": $prev_name };"
450,Which software has the most dependencies in the schema?,"MATCH (s:Software)-[:DEPENDS_ON]->(d)
WITH s, count(d) AS dependencyCount
RETURN s.name AS software, dependencyCount
ORDER BY dependencyCount DESC
LIMIT 1","match
$s isa software;
depends_on (dependent: $s, dependency: $d);
reduce $count = count($d) groupby $s;
sort $count desc;
limit 1;
fetch { ""software"": $s.name, ""dependencyCount"": $count };"
451,What are the top 3 egress routes from DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)-[:ROUTES]->(i:Interface)
RETURN e.name AS egress, count(i) AS route_count
ORDER BY route_count DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $e);
$e isa egress;
routes (routing_device: $e, routed_interface: $i);
reduce $count = count($i) groupby $e;
sort $count desc;
limit 3;
fetch { ""egress"": $e.name, ""route_count"": $count };"
452,Which Zone routes to Interface with IP '10.2.8.254'?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface {ip: '10.2.8.254'})
RETURN z.ip AS ZoneIP","match
$z isa network_zone;
$i isa interface, has ip ""10.2.8.254"";
routes (routing_device: $z, routed_interface: $i);
fetch {
  ""ZoneIP"": $z.ip
};"
453,List the top 3 DataCenters that contain more than 5 Routers.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router)
WITH dc, count(r) as routerCount
WHERE routerCount > 5
RETURN dc.name, routerCount
ORDER BY routerCount DESC
LIMIT 3","match
$dc isa data_center;
$r isa router;
dc_contains (data_center: $dc, contained_equipment: $r);
reduce $count = count($r) groupby $dc;
match $count > 5;
sort $count desc;
limit 3;
fetch {
  ""name"": $dc.name,
  ""routerCount"": $count
};"
454,Which Software requires version '7.1' to function?,"MATCH (s:Software)-[:DEPENDS_ON]->(v:Version {name: '7.1'})
RETURN s.name AS software_name","match
$s isa software;
$v isa version, has name ""7.1"";
depends_on (dependent: $s, dependency: $v);
fetch {
  ""software_name"": $s.name
};"
455,What are the names of the first 3 Types with a RAM size less than 64?,"MATCH (t:Type)
WHERE t.ram < 64
RETURN t.name
ORDER BY t.ram
LIMIT 3","match
$t isa machine_type_spec, has ram $r, has name $n;
$r < 64;
sort $r;
limit 3;
fetch {
  ""name"": $n
};"
456,Find the top 3 Processes that depend on themselves.,"MATCH (p:Process)-[:DEPENDS_ON]->(p_self:Process)
WHERE p = p_self
RETURN p.name, p.pid, p.startTime
ORDER BY p.startTime DESC
LIMIT 3","match
$p isa process, has name $n, has pid $pid, has start_time $st;
depends_on (dependent: $p, dependency: $p);
sort $st desc;
limit 3;
fetch { ""name"": $n, ""pid"": $pid, ""startTime"": $st };"
457,What Ports are listened to by the 'crm' application?,"MATCH (app:Application {name: 'crm'})-[:LISTENS]->(port:Port)
RETURN port.port AS listenedPorts","match
$app isa application, has name ""crm"";
listens (listening_process: $app, listened_port: $port);
$port isa port;
fetch {
  ""listenedPorts"": $port.port_number
};"
458,Which Applications depend on the 'webserver' application?,"MATCH (app:Application {name: 'webserver'})<-[:DEPENDS_ON]-(dependentApp:Application)
RETURN dependentApp.name","match
$app isa application, has name ""webserver"";
$dep isa application;
depends_on (dependent: $dep, dependency: $app);
fetch { ""name"": $dep.name };"
459,Identify the first 3 Services that are instances of 'java'.,"MATCH (s:Service)-[:INSTANCE]->(:Software {name: 'java'})
RETURN s.name, s.startTime, s.pid
ORDER BY s.startTime
LIMIT 3","match
$s isa service, has start_time $st;
$sw isa software, has name ""java"";
instance_of (running_instance: $s, template: $sw);
sort $st asc;
limit 3;
fetch {
  ""name"": $s.name,
  ""start_time"": $st,
  ""pid"": $s.pid
};"
460,What are the IPs of the Networks in zone 2?,"MATCH (n:Network)
WHERE n.zone = 2
RETURN n.ip","match
$n isa network, has zone 2;
fetch {
  ""ip"": $n.ip
};"
461,Which Routers are connected to Interfaces in zone 4?,"MATCH (r:Router)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(z:Zone {zone: 4})
RETURN r.name AS RouterName","match
$r isa router, has name $rn;
$nz isa network_zone, has zone 4;
routes (routing_device: $r, routed_interface: $i);
routes (routing_device: $nz, routed_interface: $i);
$i isa interface;
fetch {
  ""RouterName"": $rn
};"
462,List the Machines of type 'xl' that have a disk size greater than 256.,"MATCH (m:Machine)-[:TYPE]->(t:Type)
WHERE t.type = 'xl' AND t.disk > 256
RETURN m.name","match
$m isa machine, has name $name;
$t isa machine_type_spec, has machine_type ""xl"", has disk $d;
$d > 256;
typed_as (machine: $m, spec: $t);
fetch {
  ""name"": $name
};"
463,Which Type of machine has the highest CPU allocation?,"MATCH (t:Type)
RETURN t.name AS typeName, t.cpu AS cpuAllocation
ORDER BY t.cpu DESC
LIMIT 1","match
$t isa machine_type_spec, has cpu $cpu;
sort $cpu desc;
limit 1;
fetch {
  ""typeName"": $t.name,
  ""cpuAllocation"": $cpu
};"
464,What are the first 5 Services that started after timestamp 1606165629748?,"MATCH (s:Service)
WHERE s.startTime > 1606165629748
RETURN s.name, s.startTime
ORDER BY s.startTime ASC
LIMIT 5","match
$s isa service, has name $n, has start_time $st;
$st > 1606165629748;
sort $st asc;
limit 5;
fetch {
  ""name"": $n,
  ""start_time"": $st
};"
465,Name the Applications that listen on port 443.,"MATCH (p:Port {port: 443})<-[:LISTENS]-(a:Application)
RETURN a.name AS applicationName","match
$p isa port, has port_number 443;
listens (listening_process: $a, listened_port: $p);
$a isa application;
fetch {
  ""applicationName"": $a.name
};"
466,Which Process instances are linked to Version '7.1'?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)
RETURN p.name AS processName, p.startTime AS startTime, p.pid AS pid","match
$v isa version, has name ""7.1"";
$p isa process, has name $pn, has start_time $st, has pid $pid;
instance_of (running_instance: $p, template: $v);
fetch {
  ""processName"": $pn,
  ""startTime"": $st,
  ""pid"": $pid
};"
467,List the top 5 Processes depending on the Service with PID 8966.,"MATCH (s:Service {pid: 8966})<-[:DEPENDS_ON]-(p:Process)
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime DESC
LIMIT 5","match
$s isa service, has pid 8966;
$p isa process, has name $pname, has start_time $st, has pid $ppid;
depends_on (dependent: $p, dependency: $s);
sort $st desc;
limit 5;
fetch {
  ""name"": $pname,
  ""start_time"": $st,
  ""pid"": $ppid
};"
468,Name the Machines that run the OS 'RHEL'.,"MATCH (os:OS {name: 'RHEL'})<-[:RUNS]-(machine:Machine)
RETURN machine.name","match
$os isa os, has name ""RHEL"";
runs (host_machine: $machine, running_process: $os);
fetch {
  ""name"": $machine.name
};"
469,Which Switches route to the Interface with IP '10.1.1'?,"MATCH (s:Switch)-[:ROUTES]->(i:Interface {ip: '10.1.1'})
RETURN s","match
$s isa switch;
$i isa interface, has ip ""10.1.1"";
routes (routing_device: $s, routed_interface: $i);
fetch {
  ""s"": { $s.* }
};"
470,List the first 5 Switches in Rack 1.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack {rack: 1})-[:HOLDS]->(s:Switch)
RETURN s
LIMIT 5","match
$r isa rack, has rack_number 1;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
limit 5;
fetch {
  ""switch"": $s.ip
};"
471,What are the dependencies of the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(d)
RETURN d.name AS DependencyName","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $d);
$d has name $dn;
fetch {
  ""DependencyName"": $dn
};"
472,Which Versions are marked as previous to '7.1'?,"MATCH (v:Version)-[:PREVIOUS]->(prev:Version)
WHERE v.name = '7.1'
RETURN prev.name AS previous_versions","match
$v isa version, has name ""7.1"";
previous (newer_version: $v, older_version: $prev);
$prev has name $prev_name;
fetch {
  ""previous_versions"": $prev_name
};"
473,What are the names of the first 3 Applications that depend on the Service named 'java'?,"MATCH (s:Service {name: 'java'})&lt;-[:DEPENDS_ON]-(a:Application)
RETURN a.name
ORDER BY a.startTime
LIMIT 3","match
$s isa service, has name ""java"";
depends_on (dependent: $a, dependency: $s);
$a isa application, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $a.name
};"
474,Which Ports are exposed by the Interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})—[:EXPOSES]->(p:Port)
RETURN p.port AS exposedPorts","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
$p isa port;
fetch {
  ""exposedPorts"": $p.port_number
};"
475,What are the first 3 zones with size 16 and IP starting with '10.2'?,"MATCH (z:Zone)
WHERE z.size = 16 AND z.ip STARTS WITH '10.2'
RETURN z
ORDER BY z.zone
LIMIT 3","match
$z isa network_zone, has ip $ip, has size 16, has zone $zone;
$ip like ""10[.]2.*"";
sort $zone asc;
limit 3;
fetch {
  ""ip"": $z.ip,
  ""size"": $z.size,
  ""zone"": $zone
};"
476,Name the top 3 Services listening on Port 80.,"MATCH (s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN s.name AS service_name
LIMIT 3","match
$s isa service, has name $n;
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
limit 3;
fetch { ""service_name"": $n };"
477,Name the first 3 Machines that are of type 'm' and are located in zone 3.,"MATCH (m:Machine)-[:TYPE]->(t:Type {type: 'm'}),
      (r:Rack {zone: 3})-[:HOLDS]->(m)
RETURN m.name
LIMIT 3","match
$m isa machine;
$t isa machine_type_spec, has machine_type ""m"";
typed_as (machine: $m, spec: $t);
$r isa rack, has zone 3;
holds (containing_rack: $r, held_equipment: $m);
limit 3;
fetch {
  ""name"": $m.name
};"
478,List the first 5 Applications that depend on the Process with PID 8966.,"MATCH (p:Process {pid: 8966})<-[:DEPENDS_ON]-(a:Application)
RETURN a.name
LIMIT 5","match
$p isa process, has pid 8966;
$a isa application;
depends_on (dependent: $a, dependency: $p);
limit 5;
fetch {
  ""name"": $a.name
};"
479,What are the IPs of the Ports exposed by the Interface connected to Router 'DC1-R-1'?,"MATCH (router:Router {name: 'DC1-R-1'})-[:ROUTES]->(interface:Interface)-[:EXPOSES]->(port:Port)
RETURN interface.ip AS InterfaceIP, port.port AS Port","match
  $router isa router, has name ""DC1-R-1"";
  routes (routing_device: $router, routed_interface: $interface);
  exposes (exposing_interface: $interface, exposed_port: $port);
fetch {
  ""InterfaceIP"": $interface.ip,
  ""Port"": $port.port_number
};"
480,Which Machine types are used in DataCenter 'DC1'?,"MATCH (dc:DataCenter {name: 'DC1'})−[:CONTAINS]−>(:Rack)−[:HOLDS]−>(m:Machine)−[:TYPE]−>(t:Type)
RETURN DISTINCT t.name AS MachineType","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $r);
$r isa rack;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $t);
$t isa machine_type_spec, has name $mt;
select $mt;
distinct;
fetch { ""MachineType"": $mt };"
481,How many machines in rack 'DC1-RCK-1-1' run the OS 'RHEL'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN count(machine) AS numberOfMachines","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$machine isa machine;
$os isa os, has name ""RHEL"";
holds (containing_rack: $rack, held_equipment: $machine);
runs (host_machine: $machine, running_process: $os);
reduce $count = count($machine);"
482,Which application listens on port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(a:Application)
RETURN a.name","match
$p isa port, has port_number 80;
$a isa application;
listens (listening_process: $a, listened_port: $p);
fetch {
  ""name"": $a.name
};"
483,List the top 5 ports exposed by the interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port AS port
ORDER BY p.port
LIMIT 5","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
$p has port_number $pn;
sort $pn asc;
limit 5;
fetch {
  ""port"": $pn
};"
484,What are the first 3 processes running on machines within 'DC1-RCK-4-9'?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack {name: 'DC1-RCK-4-9'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(process:Process)
RETURN process.name, process.startTime, process.pid
ORDER BY process.startTime
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-4-9"";
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $process);
$process isa process, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $process.name,
  ""startTime"": $st,
  ""pid"": $process.pid
};"
485,Which zone has the most networks routed through it?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network)
WITH z.zone AS zone, COUNT(n) AS network_count
RETURN zone
ORDER BY network_count DESC
LIMIT 1","match
$z isa network_zone, has zone $zone;
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $n, routed_interface: $i);
$n isa network;
reduce $count = count($n) groupby $zone;
sort $count desc;
limit 1;
fetch { ""zone"": $zone };"
486,What are the top 3 applications running on the machine named 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name AS application, COUNT(a) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $a);
$a isa application, has name $app_name;
reduce $count = count($a) groupby $app_name;
sort $count desc;
limit 3;"
487,Which software versions are dependent on the software named 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $v);
$v isa version, has name $version;
fetch {
  ""version"": $version
};"
488,List the top 5 routers located in zone 2.,"MATCH (r:Router)
WHERE r.zone = 2
RETURN r.name
LIMIT 5","match
$r isa router, has zone 2;
limit 5;
fetch {
  ""name"": $r.name
};"
489,What are the top 3 types of machines held in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name AS typeName, COUNT(machine) AS machineCount
ORDER BY machineCount DESC
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $type);
$type has name $type_name;
reduce $machine_count = count($m) groupby $type, $type_name;
sort $machine_count desc;
limit 3;
fetch { ""typeName"": $type_name, ""machineCount"": $machine_count };"
490,Which DataCenter contains the router named 'DC1-R-1'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-R-1'})
RETURN dc.name","match
$dc isa data_center;
$r isa router, has name ""DC1-R-1"";
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $dc.name
};"
491,What are the IPs of the first 5 Interfaces connected to Zone 4?,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)
RETURN i.ip
LIMIT 5","match
$z isa network_zone, has zone 4;
routes (routing_device: $z, routed_interface: $i);
$i isa interface;
limit 5;
fetch {
  ""ip"": $i.ip
};"
492,Which Machine Interfaces are connected to Network '10.1'?,"MATCH (n:Network {ip: '10.1'})​-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)
RETURN m.name AS MachineName, i.ip AS InterfaceIP","match
  $n isa network, has ip ""10.1"";
  routes (routing_device: $n, routed_interface: $i);
  routes (routing_device: $m, routed_interface: $i);
  $m isa machine;
fetch {
  ""MachineName"": $m.name,
  ""InterfaceIP"": $i.ip
};"
493,List all routers connected to interfaces in zone 3.,"MATCH (z:Zone {zone: 3})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(r:Router)
RETURN r.name AS router_name","match
$z isa network_zone, has zone 3;
routes (routing_device: $z, routed_interface: $i);
$r isa router;
routes (routing_device: $r, routed_interface: $i);
fetch {
  ""router_name"": $r.name
};"
494,Name the Racks in Zone 1 that hold more than 3 Machines.,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 1
WITH r, count(m) as machineCount
WHERE machineCount > 3
RETURN r.name","match
$r isa rack, has zone 1;
$m isa machine;
holds (containing_rack: $r, held_equipment: $m);
reduce $count = count($m) groupby $r;
match $count > 3;
fetch { ""name"": $r.name };"
495,Which Zones have Networks with the IP '10.3'?,"MATCH (z:Zone)-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network {ip: '10.3'})
RETURN z.ip AS ZoneIP, z.zone AS ZoneNumber","match
$z isa network_zone;
$n isa network, has ip ""10.3"";
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $n, routed_interface: $i);
fetch {
  ""ZoneIP"": $z.ip,
  ""ZoneNumber"": $z.zone
};"
496,What are the Versions dependent on the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS Version","match
$s isa software, has name ""RHEL"";
depends_on (dependent: $s, dependency: $v);
$v isa version, has name $n;
fetch {
  ""Version"": $n
};"
497,Which Processes are instances of the Software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:INSTANCE]-(v:Version)<-[:INSTANCE]-(p:Process)
RETURN p.name AS ProcessName, p.startTime AS StartTime, p.pid AS PID","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
instance_of (template: $v, running_instance: $p);
$p isa process;
fetch {
  ""ProcessName"": $p.name,
  ""StartTime"": $p.start_time,
  ""PID"": $p.pid
};"
498,Name the Applications running on Machines in Zone 4.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(m:Machine)-[:RUNS]->(a:Application)
RETURN DISTINCT a.name AS ApplicationName","match
$z isa network_zone, has zone 4;
routes (routing_device: $z, routed_interface: $i);
routes (routing_device: $m, routed_interface: $i);
$m isa machine;
runs (host_machine: $m, running_process: $a);
$a isa application, has name $n;
select $n;
distinct;
fetch { ""ApplicationName"": $n };"
499,List the top 3 Versions used by the Software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS version, COUNT(*) AS usage_count
ORDER BY usage_count DESC
LIMIT 3","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v has name $vn;
reduce $usage_count = count groupby $vn;
sort $usage_count desc;
limit 3;
fetch { ""version"": $vn };"
500,Which Interfaces are directly connected to 'DC1-RE'?,"MATCH (egress:Egress {name: 'DC1-RE'})-[:ROUTES]->(interface:Interface)
RETURN interface.ip AS InterfaceIP","match
$e isa egress, has name ""DC1-RE"";
routes (routing_device: $e, routed_interface: $i);
$i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
501,What is the IP of the Interface in Rack 'DC1-RCK-1-1'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:ROUTES]->(interface:Interface)
RETURN interface.ip AS InterfaceIP","match
$rack isa rack, has name ""DC1-RCK-1-1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
routes (routing_device: $machine, routed_interface: $interface);
$interface isa interface;
fetch {
  ""InterfaceIP"": $interface.ip
};"
502,Which Switches are connected to Interfaces routing through network '10.2'?,"MATCH (n:Network {ip: '10.2'})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(s:Switch)
RETURN s.ip AS switch_ip","match
  $n isa network, has ip ""10.2"";
  routes (routing_device: $n, routed_interface: $i);
  $s isa switch, has ip $switch_ip;
  routes (routing_device: $s, routed_interface: $i);
fetch {
  ""switch_ip"": $switch_ip
};"
503,List the first 3 Zones that have a size of 16.,"MATCH (z:Zone)
WHERE z.size = 16
RETURN z
LIMIT 3","match
$z isa network_zone, has size 16;
limit 3;
fetch {
  ""ip"": $z.ip,
  ""size"": $z.size,
  ""zone"": $z.zone
};"
504,Which Routers have a connection to Interface with IP '10.3.8.253'?,"MATCH (router:Router)-[:ROUTES]->(interface:Interface {ip: '10.3.8.253'})
RETURN router.name","match
$router isa router;
$interface isa interface, has ip ""10.3.8.253"";
routes (routing_device: $router, routed_interface: $interface);
fetch {
  ""name"": $router.name
};"
505,What are the dependencies of the application 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$app isa application, has name ""webapp"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
506,Name the Egress points from the DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name AS EgressPoints","match
$dc isa data_center, has name ""DC1"";
$e isa egress;
dc_contains (data_center: $dc, contained_equipment: $e);
fetch {
  ""EgressPoints"": $e.name
};"
507,List the first 5 Ports listened to by the Service with name 'java'.,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port
LIMIT 5","match
$s isa service, has name ""java"";
listens (listening_process: $s, listened_port: $p);
$p isa port;
limit 5;
fetch {
  ""port"": $p.port_number
};"
508,Which 3 machines in rack 'DC1-RCK-1-10' run the OS named 'RHEL'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-10'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN machine.name
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-10"";
$machine isa machine;
$os isa os, has name ""RHEL"";
holds (containing_rack: $rack, held_equipment: $machine);
runs (host_machine: $machine, running_process: $os);
limit 3;
fetch { ""machine_name"": $machine.name };"
509,What are the first 3 Machines that run the OS starting after 1605733619064?,"MATCH (m:Machine)-[:RUNS]->(os:OS)
WHERE os.startTime > 1605733619064
RETURN m.name
ORDER BY os.startTime
LIMIT 3","match
$m isa machine;
$os isa os, has start_time $st;
runs (host_machine: $m, running_process: $os);
$st > 1605733619064;
sort $st asc;
limit 3;
fetch {
  ""name"": $m.name
};"
510,Which machines are running processes that depend on the service named 'java'?,"MATCH (s:Service {name: 'java'})<-[:DEPENDS_ON]-(p:Process)<-[:RUNS]-(m:Machine)
RETURN m.name AS machine_name","match
$s isa service, has name ""java"";
depends_on (dependent: $p, dependency: $s);
$p isa process;
runs (host_machine: $m, running_process: $p);
$m isa machine;
fetch {
  ""machine_name"": $m.name
};"
511,What are the names and IPs of interfaces that connect to zone 1's network?,"MATCH (zone:Zone {zone: 1})-[:ROUTES]->(interface:Interface)
RETURN interface.ip AS ip, interface.name AS name","match
$z isa network_zone, has zone 1;
routes (routing_device: $z, routed_interface: $i);
$i isa interface;
fetch {
  ""ip"": $i.ip
};"
512,List the first 3 services that depend on the process named '8966'.,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(s:Service)
RETURN s.name
LIMIT 3","match
$p isa process, has pid 8966;
$s isa service, has name $n;
depends_on (dependent: $p, dependency: $s);
limit 3;
fetch {
  ""name"": $n
};"
513,Which processes are instances of version '7.1' and listen to port 80?,"MATCH (v:Version {name: '7.1'})<-[:INSTANCE]-(p:Process)-[:LISTENS]->(port:Port {port: 80})
RETURN p.name AS processName, p.startTime AS processStartTime, p.pid AS processPID","match
$v isa version, has name ""7.1"";
$p isa process;
instance_of (running_instance: $p, template: $v);
$port isa port, has port_number 80;
listens (listening_process: $p, listened_port: $port);
fetch {
  ""processName"": $p.name,
  ""processStartTime"": $p.start_time,
  ""processPID"": $p.pid
};"
514,Find the top 3 types of machines by RAM that are held in racks in zone 1.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack {zone: 1})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS type, t.ram AS ram
ORDER BY t.ram DESC
LIMIT 3","match
  $dc isa data_center;
  dc_contains (data_center: $dc, contained_equipment: $r);
  $r isa rack, has zone 1;
  holds (containing_rack: $r, held_equipment: $m);
  $m isa machine;
  typed_as (machine: $m, spec: $t);
  $t isa machine_type_spec, has ram $ram;
sort $ram desc;
limit 3;
fetch {
  ""type"": $t.name,
  ""ram"": $ram
};"
515,Identify all previous versions of the software named 'RHEL' that are depended upon by other software.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)<-[:PREVIOUS]-(prev:Version)<-[:DEPENDS_ON]-(other:Software)
RETURN DISTINCT prev.name AS PreviousVersion","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
previous (newer_version: $v, older_version: $prev);
depends_on (dependent: $other, dependency: $prev);
$other isa software;
$prev has name $prev_name;
select $prev_name;
distinct;
fetch { ""PreviousVersion"": $prev_name };"
516,What are the names of all machines in rack 'DC1-RCK-1-1' and their respective applications?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(application:Application)
RETURN machine.name AS machineName, application.name AS applicationName","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application;
fetch {
  ""machineName"": $machine.name,
  ""applicationName"": $app.name
};"
517,List the top 3 networks by size that route through interfaces in zone 4.,"MATCH (z:Zone {zone: 4})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network)
RETURN n.ip AS network_ip, n.size AS network_size
ORDER BY n.size DESC
LIMIT 3","match
  $z isa network_zone, has zone 4;
  routes (routing_device: $z, routed_interface: $i);
  $n isa network, has size $s;
  routes (routing_device: $n, routed_interface: $i);
sort $s desc;
limit 3;
fetch {
  ""network_ip"": $n.ip,
  ""network_size"": $s
};"
518,Which applications are instances of service named 'java'?,"MATCH (s:Service {name: 'java'})-[:INSTANCE]->(a:Application)
RETURN a.name AS application_name","match
$s isa service, has name ""java"";
instance_of (template: $s, running_instance: $a);
$a isa application;
fetch {
  ""application_name"": $a.name
};"
519,What are the dependencies of the service named 'java' that started after 1605733619064?,"MATCH (s:Service {name: 'java'})-[:DEPENDS_ON]->(dep)
WHERE s.startTime > 1605733619064
RETURN dep.name AS DependencyName","match
$s isa service, has name ""java"", has start_time $st;
$st > 1605733619064;
depends_on (dependent: $s, dependency: $dep);
$dep has name $dn;
fetch {
  ""DependencyName"": $dn
};"
520,Find the top 5 types of machines by CPU in racks located in zone 2.,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 2})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name AS machineType, type.cpu AS cpu
ORDER BY cpu DESC
LIMIT 5","match
$dc isa data_center;
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack, has zone 2;
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec, has cpu $cpu;
sort $cpu desc;
limit 5;
fetch {
  ""machineType"": $type.name,
  ""cpu"": $cpu
};"
521,Which ports does the OS 'RHEL' listen to through its services?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)<-[:INSTANCE]-(service:Service)-[:LISTENS]->(port:Port)
RETURN DISTINCT port.port AS ListeningPorts","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $version);
$version isa version;
instance_of (running_instance: $service, template: $version);
$service isa service;
listens (listening_process: $service, listened_port: $port);
$port has port_number $pn;
select $pn;
distinct;
fetch { ""ListeningPorts"": $pn };"
522,List the first 3 processes that are instances of software named 'webapp'.,"MATCH (s:Software {name: 'webapp'})-[:INSTANCE]->(p:Process)
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime
LIMIT 3","match
  $s isa software, has name ""webapp"";
  instance_of (running_instance: $p, template: $s);
  $p isa process, has start_time $st;
sort $st asc;
limit 3;
fetch {
  ""name"": $p.name,
  ""startTime"": $st,
  ""pid"": $p.pid
};"
523,Which services started between timestamps 1605733619064 and 1606597376483 and listen to port 80?,"MATCH (s:Service)-[:LISTENS]->(p:Port)
WHERE s.startTime >= 1605733619064 AND s.startTime <= 1606597376483 AND p.port = 80
RETURN s.name, s.startTime","match
$s isa service, has name $sn, has start_time $st;
$st >= 1605733619064;
$st <= 1606597376483;
$p isa port, has port_number 80;
listens (listening_process: $s, listened_port: $p);
fetch {
  ""name"": $sn,
  ""startTime"": $st
};"
524,What are the names of all switches in racks within zone 1?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 1})-[:HOLDS]->(switch:Switch)
RETURN switch.ip AS switch_name","match
  $dc isa data_center;
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack, has zone 1;
  holds (containing_rack: $rack, held_equipment: $switch);
  $switch isa switch;
fetch {
  ""switch_name"": $switch.ip
};"
526,Which processes are instances of application named 'crm'?,"MATCH (app:Application {name: 'crm'})-[:INSTANCE]->(process:Process)
RETURN process.name AS processName, process.startTime AS startTime, process.pid AS pid","match
$app isa application, has name ""crm"";
instance_of (template: $app, running_instance: $process);
$process isa process;
fetch {
  ""processName"": $process.name,
  ""startTime"": $process.start_time,
  ""pid"": $process.pid
};"
528,What are the names and IPs of interfaces that connect to network '10.3'?,"MATCH (network:Network {ip: '10.3'})-[:ROUTES]->(interface:Interface)
RETURN interface.name AS interfaceName, interface.ip AS interfaceIP","match
  $network isa network, has ip ""10.3"";
  routes (routing_device: $network, routed_interface: $interface);
  $interface isa interface;
fetch {
  ""interfaceIP"": $interface.ip
};"
529,Which machines are running services that listen on port 80?,"MATCH (m:Machine)-[:RUNS]->(s:Service)-[:LISTENS]->(p:Port {port: 80})
RETURN m.name AS machine_name","match
$m isa machine;
$s isa service;
$p isa port, has port_number 80;
runs (host_machine: $m, running_process: $s);
listens (listening_process: $s, listened_port: $p);
fetch {
  ""machine_name"": $m.name
};"
530,Find the top 5 switches by rack number in zone 4.,"MATCH (r: Rack {zone: 4})-[:HOLDS]->(s: Switch)
RETURN s.ip, r.rack
ORDER BY r.rack DESC
LIMIT 5","match
$r isa rack, has zone 4, has rack_number $rn;
$s isa switch;
holds (containing_rack: $r, held_equipment: $s);
sort $rn desc;
limit 5;
fetch {
  ""ip"": $s.ip,
  ""rack"": $rn
};"
531,What are the names of all routers routing through interface with IP '10.1.0.254'?,"MATCH (r:Router)-[:ROUTES]->(i:Interface {ip: '10.1.0.254'})
RETURN r.name","match
$r isa router, has name $n;
$i isa interface, has ip ""10.1.0.254"";
routes (routing_device: $r, routed_interface: $i);
fetch {
  ""name"": $n
};"
532,List the top 3 types of machines based on disk size in racks located in zone 3.,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 3})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name AS machineType, type.disk AS diskSize
ORDER BY diskSize DESC
LIMIT 3","match
  $dc isa data_center;
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack, has zone 3;
  holds (containing_rack: $rack, held_equipment: $m);
  $m isa machine;
  typed_as (machine: $m, spec: $type);
  $type isa machine_type_spec, has disk $disk;
sort $disk desc;
limit 3;
fetch {
  ""machineType"": $type.name,
  ""diskSize"": $disk
};"
533,Which applications and their start times are running on machines in zone 2?,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 2})-[:HOLDS]->(machine:Machine)-[:RUNS]->(app:Application)
RETURN app.name AS application, app.startTime AS startTime","match
$rack isa rack, has zone 2;
dc_contains (data_center: $dc, contained_equipment: $rack);
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application;
fetch {
  ""application"": $app.name,
  ""startTime"": $app.start_time
};"
534,Identify the first 5 ports listened to by the process named '8966'.,"MATCH (p:Process {pid: 8966})-[:LISTENS]->(port:Port)
RETURN port.port
LIMIT 5","match
$p isa process, has pid 8966;
listens (listening_process: $p, listened_port: $port);
$port isa port;
limit 5;
fetch {
  ""port"": $port.port_number
};"
535,What are the dependencies of the application named 'logstash'?,"MATCH (app:Application {name: 'logstash'})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$app isa application, has name ""logstash"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
fetch {
  ""DependencyName"": $dep_name
};"
536,List the first 3 services that are instances of the application named 'webserver'.,"MATCH (app:Application {name: 'webserver'})-[:INSTANCE]->(service:Service)
RETURN service.name
LIMIT 3","match
$app isa application, has name ""webserver"";
instance_of (template: $app, running_instance: $service);
$service isa service;
limit 3;
fetch {
  ""service_name"": $service.name
};"
537,Which versions of software named 'RHEL' are used by processes started after 1605733619064?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)<-[:INSTANCE]-(p:Process)
WHERE p.startTime > 1605733619064
RETURN DISTINCT v.name AS version","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
instance_of (template: $v, running_instance: $p);
$p isa process, has start_time $st;
$st > 1605733619064;
select $v;
distinct;
fetch {
  ""version"": $v.name
};"
538,Which applications listen to ports managed by software 'RHEL'?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)<-[:INSTANCE]-(a:Application)-[:LISTENS]->(p:Port)
RETURN a.name AS application, p.port AS port","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
instance_of (running_instance: $a, template: $v);
$a isa application;
listens (listening_process: $a, listened_port: $p);
fetch {
  ""application"": $a.name,
  ""port"": $p.port_number
};"
539,What are the types of machines that are running applications named 'cms'?,"MATCH (app:Application {name: 'cms'})<-[:RUNS]-(machine:Machine)-[:TYPE]->(type:Type)
RETURN DISTINCT type.name AS MachineType","match
$app isa application, has name ""cms"";
runs (host_machine: $machine, running_process: $app);
typed_as (machine: $machine, spec: $type);
$type has name $machine_type;
select $machine_type;
distinct;
fetch {
  ""MachineType"": $machine_type
};"
540,Identify the first 5 machines by name that run the application named 'webserver'.,"MATCH (m:Machine)-[:RUNS]->(a:Application {name: 'webserver'})
RETURN m.name
LIMIT 5","match
$m isa machine;
$a isa application, has name ""webserver"";
runs (host_machine: $m, running_process: $a);
limit 5;
fetch { ""name"": $m.name };"
541,List all types of machines in rack 'DC1-RCK-1-1' and their disk sizes.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN machine.name AS machine_name, type.disk AS disk_size","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
typed_as (machine: $m, spec: $type);
fetch {
  ""machine_name"": $m.name,
  ""disk_size"": $type.disk
};"
542,Display the first 5 processes running on machine 'DC1-RCK-1-1-M-1' with PID greater than 5000.,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(p:Process)
WHERE p.pid > 5000
RETURN p
LIMIT 5","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
runs (host_machine: $m, running_process: $p);
$p isa process, has pid $pid;
$pid > 5000;
limit 5;
fetch {
  ""name"": $p.name,
  ""start_time"": $p.start_time,
  ""pid"": $pid
};"
543,Identify the first 3 machines running the application 'webserver'.,"MATCH (app:Application {name: 'webserver'})<-[:RUNS]-(machine:Machine)
RETURN machine.name
LIMIT 3","match
$app isa application, has name ""webserver"";
runs (host_machine: $machine, running_process: $app);
$machine has name $n;
limit 3;
fetch { ""name"": $n };"
544,Which switches are located in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(switch:Switch)
RETURN switch.ip AS switch_ip","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$switch isa switch;
holds (containing_rack: $rack, held_equipment: $switch);
fetch {
  ""switch_ip"": $switch.ip
};"
545,Which DataCenter has the egress named 'DC1-RE'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(e:Egress {name: 'DC1-RE'})
RETURN dc.name","match
$dc isa data_center;
$e isa egress, has name ""DC1-RE"";
dc_contains (data_center: $dc, contained_equipment: $e);
fetch {
  ""name"": $dc.name
};"
546,How many versions of the software 'RHEL' exist?,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN count(v) AS numberOfVersions","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
reduce $count = count($v);"
547,What are the top 3 applications listening on port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(a:Application)
RETURN a.name AS application, COUNT(a) AS count
ORDER BY count DESC
LIMIT 3","match
$p isa port, has port_number 80;
listens (listening_process: $a, listened_port: $p);
$a isa application, has name $n;
reduce $count = count($a) groupby $n;
sort $count desc;
limit 3;"
548,List the first 3 versions of software 'RHEL' installed on any machine.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name
ORDER BY v.name
LIMIT 3","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v has name $vn;
sort $vn;
limit 3;
fetch {
  ""version_name"": $vn
};"
549,What are the top 3 services running on machines in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(service:Service)
RETURN service.name, COUNT(service) AS service_count
ORDER BY service_count DESC
LIMIT 3","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $service);
$service isa service, has name $sn;
reduce $service_count = count($service) groupby $sn;
sort $service_count desc;
limit 3;"
550,Find the top 5 egress routes from DataCenter 'DC1'.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)-[:ROUTES]->(i:Interface)
RETURN e.name AS egress, i.ip AS interface_ip
LIMIT 5","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $e);
$e isa egress;
routes (routing_device: $e, routed_interface: $i);
$i isa interface;
limit 5;
fetch {
  ""egress"": $e.name,
  ""interface_ip"": $i.ip
};"
551,Which type of machine has the maximum CPU capacity?,"MATCH (t:Type)
RETURN t.name AS machineType, t.cpu AS cpuCapacity
ORDER BY t.cpu DESC
LIMIT 1","match
$t isa machine_type_spec, has cpu $cpu;
sort $cpu desc;
limit 1;
fetch {
  ""machineType"": $t.name,
  ""cpuCapacity"": $cpu
};"
552,List all the types of machines available in rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN type.name AS machineType","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec;
fetch {
  ""machineType"": $type.name
};"
553,Identify the first 3 networks routing through interface with IP '10.0.0.254'.,"MATCH (i:Interface {ip: '10.0.0.254'})&lt;-[:ROUTES]-(n:Network)
RETURN n.ip
LIMIT 3","match
$i isa interface, has ip ""10.0.0.254"";
$n isa network;
routes (routing_device: $n, routed_interface: $i);
limit 3;
fetch {
  ""ip"": $n.ip
};"
554,What are the top 3 recent applications run on machine 'DC1-RCK-1-1-M-1'?,"MATCH (m:Machine {name: 'DC1-RCK-1-1-M-1'})-[:RUNS]->(a:Application)
RETURN a.name, a.startTime
ORDER BY a.startTime DESC
LIMIT 3","match
$m isa machine, has name ""DC1-RCK-1-1-M-1"";
$a isa application, has start_time $st;
runs (host_machine: $m, running_process: $a);
sort $st desc;
limit 3;
fetch {
  ""name"": $a.name,
  ""start_time"": $st
};"
555,Name the top 5 software dependencies for the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(d:Software)
RETURN d.name AS Dependency, COUNT(*) AS DependencyCount
ORDER BY DependencyCount DESC
LIMIT 5","match
$s isa software, has name ""RHEL"";
$d isa software, has name $dn;
$rel isa depends_on (dependent: $s, dependency: $d);
reduce $count = count($rel) groupby $dn;
sort $count desc;
limit 5;
fetch { ""Dependency"": $dn, ""DependencyCount"": $count };"
556,How many machines are held in the rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)
RETURN count(machine) AS numberOfMachines","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$machine isa machine;
holds (containing_rack: $rack, held_equipment: $machine);
reduce $count = count($machine);"
557,Find all interfaces connected to router 'DC1-R-2'.,"MATCH (r:Router {name: 'DC1-R-2'})-[:ROUTES]->(i:Interface)
RETURN i","match
$r isa router, has name ""DC1-R-2"";
routes (routing_device: $r, routed_interface: $i);
$i isa interface;
fetch {
  ""ip"": $i.ip
};"
558,Which DataCenter contains the router 'DC1-R-1'?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {name: 'DC1-R-1'})
RETURN dc.name","match
$dc isa data_center;
$r isa router, has name ""DC1-R-1"";
dc_contains (data_center: $dc, contained_equipment: $r);
fetch {
  ""name"": $dc.name
};"
559,List the top 3 routers located in zone 1.,"MATCH (r:Router)
WHERE r.zone = 1
RETURN r.name
ORDER BY r.name
LIMIT 3","match
$r isa router, has zone 1, has name $n;
sort $n;
limit 3;
fetch {
  ""name"": $n
};"
561,Which ports are listened to by all processes running on OS 'RHEL'?,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)<-[:INSTANCE]-(process:Process)-[:LISTENS]->(port:Port)
RETURN DISTINCT port.port AS listened_ports","match
  $os isa os, has name ""RHEL"";
  instance_of (running_instance: $os, template: $version);
  $version isa version;
  instance_of (running_instance: $process, template: $version);
  $process isa process;
  listens (listening_process: $process, listened_port: $port);
  $port has port_number $pn;
select $pn;
distinct;"
562,Find the top 5 applications by start time running on machines in rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(application:Application)
RETURN application.name, application.startTime
ORDER BY application.startTime DESC
LIMIT 5","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
runs (host_machine: $machine, running_process: $app);
$app isa application, has start_time $st;
sort $st desc;
limit 5;
fetch {
  ""name"": $app.name,
  ""startTime"": $app.start_time
};"
563,What are the names and IPs of all switches in zone 4?,"MATCH (s:Switch)-[:ROUTES]->(i:Interface)
MATCH (r:Rack)-[:HOLDS]->(s)
WHERE r.zone = 4
RETURN s.name AS switchName, i.ip AS switchIP","match
$r isa rack, has zone 4;
holds (containing_rack: $r, held_equipment: $s);
$s isa switch;
routes (routing_device: $s, routed_interface: $i);
$i isa interface;
fetch {
  ""switchIP"": $s.ip,
  ""interfaceIP"": $i.ip
};"
564,List the top 3 networks by IP that are routed through interfaces connected to routers in zone 3.,"MATCH (r:Router {zone: 3})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(n:Network)
RETURN n.ip, COUNT(i) AS interface_count
ORDER BY interface_count DESC
LIMIT 3","match
$r isa router, has zone 3;
routes (routing_device: $r, routed_interface: $i);
routes (routing_device: $n, routed_interface: $i);
$n isa network, has ip $ip;
reduce $count = count($i) groupby $n;
sort $count desc;
limit 3;
fetch { ""ip"": $n.ip, ""interface_count"": $count };"
565,Identify all applications that are instances of process named '8966'.,"MATCH (p:Process {pid: 8966})-[:INSTANCE]->(a:Application)
RETURN a.name","match
$p isa process, has pid 8966;
instance_of (running_instance: $p, template: $a);
$a isa application;
fetch {
  ""name"": $a.name
};"
566,What are the dependencies of the software named 'RHEL' that are versions?,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name AS versionName","match
  $s isa software, has name ""RHEL"";
  depends_on (dependent: $s, dependency: $v);
  $v isa version, has name $vn;
fetch {
  ""versionName"": $vn
};"
567,Find the top 5 racks by zone that contain the most types of machines.,"MATCH (rack:Rack)-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
WITH rack, rack.zone AS zone, COUNT(DISTINCT type) AS typeCount
ORDER BY zone, typeCount DESC
RETURN zone, rack.name AS rackName, typeCount
LIMIT 5","match
$rack isa rack, has zone $zone, has name $rack_name;
$machine isa machine;
$type isa machine_type_spec;
holds (containing_rack: $rack, held_equipment: $machine);
typed_as (machine: $machine, spec: $type);
select $rack, $zone, $rack_name, $type;
distinct;
reduce $type_count = count($type) groupby $rack, $zone, $rack_name;
sort $zone asc, $type_count desc;
limit 5;
fetch { ""zone"": $zone, ""rackName"": $rack_name, ""typeCount"": $type_count };"
568,Which versions of software are instances of other applications?,"MATCH (s:Software)-[:INSTANCE]->(a:Application)
RETURN DISTINCT s.name AS SoftwareName, a.name AS ApplicationName","match
$s isa software, has name $sn;
$a isa application, has name $an;
instance_of (template: $s, running_instance: $a);
select $sn, $an;
distinct;
fetch {
  ""SoftwareName"": $sn,
  ""ApplicationName"": $an
};"
569,What are the IP addresses of all interfaces in routers located in zone 2?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {zone: 2})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
  $dc isa data_center;
  dc_contains (data_center: $dc, contained_equipment: $r);
  $r isa router, has zone 2;
  routes (routing_device: $r, routed_interface: $i);
  $i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
570,Find the top 5 machines by name running the OS 'RHEL' in rack 'DC1-RCK-1-1'.,"MATCH (r:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
RETURN m.name
ORDER BY m.name
LIMIT 5","match
$r isa rack, has name ""DC1-RCK-1-1"";
$m isa machine, has name $mn;
$os isa os, has name ""RHEL"";
holds (containing_rack: $r, held_equipment: $m);
runs (host_machine: $m, running_process: $os);
sort $mn asc;
limit 5;
fetch {
  ""name"": $mn
};"
571,Identify the first 5 applications by version that depend on the software 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)<-[:INSTANCE]-(a:Application)
RETURN a.name, v.name
ORDER BY v.name
LIMIT 5","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v isa version, has name $vn;
instance_of (template: $v, running_instance: $a);
$a isa application, has name $an;
sort $vn asc;
limit 5;
fetch {
  ""application_name"": $an,
  ""version_name"": $vn
};"
572,List all processes that depend on the service named 'java'.,"MATCH (p:Process)-[:DEPENDS_ON]->(s:Service {name: 'java'})
RETURN p.name AS processName, p.startTime AS processStartTime, p.pid AS processPID","match
$p isa process, has name $pn, has start_time $st, has pid $pid;
$s isa service, has name ""java"";
depends_on (dependent: $p, dependency: $s);
fetch {
  ""processName"": $pn,
  ""processStartTime"": $st,
  ""processPID"": $pid
};"
573,Which racks in zone 4 hold more than 5 machines?,"MATCH (r:Rack)-[:HOLDS]->(m:Machine)
WHERE r.zone = 4
WITH r, count(m) AS machineCount
WHERE machineCount > 5
RETURN r.name AS rackName, machineCount","match
$r isa rack, has zone 4;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
reduce $machineCount = count($m) groupby $r;
match $machineCount > 5;
$r has name $rackName;
fetch { ""rackName"": $rackName, ""machineCount"": $machineCount };"
574,What are the names of the switches located in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(switch:Switch)
RETURN switch.ip AS switch_ip","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $switch);
$switch isa switch;
fetch {
  ""switch_ip"": $switch.ip
};"
575,List the first 3 previous versions for version named '7.1'.,"MATCH (v:Version {name: '7.1'})-[:PREVIOUS*1..3]->(prev:Version)
RETURN prev.name
LIMIT 3","match
$v isa version, has name ""7.1"";
{
  previous (newer_version: $v, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $a);
  previous (newer_version: $a, older_version: $prev);
} or {
  previous (newer_version: $v, older_version: $b);
  previous (newer_version: $b, older_version: $c);
  previous (newer_version: $c, older_version: $prev);
};
limit 3;
fetch { ""prev_name"": $prev.name };"
576,Which services are instances of software named 'RHEL'?,"MATCH (s:Service)-[:INSTANCE]->(sw:Software {name: 'RHEL'})
RETURN s.name AS serviceName","match
$s isa service, has name $sn;
$sw isa software, has name ""RHEL"";
instance_of (running_instance: $s, template: $sw);
fetch {
  ""serviceName"": $sn
};"
577,Find all machines running OS named 'RHEL' in the first 5 racks of zone 1.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(os:OS {name: 'RHEL'})
WHERE r.zone = 1 AND r.rack <= 5
RETURN m.name AS MachineName","match
$r isa rack, has zone 1, has rack_number $rn;
$rn <= 5;
holds (containing_rack: $r, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $os);
$os isa os, has name ""RHEL"";
fetch {
  ""MachineName"": $m.name
};"
578,What are the top 3 processes that listen on port 80?,"MATCH (p:Process)-[:LISTENS]->(port:Port {port: 80})
RETURN p.name, p.pid, p.startTime
ORDER BY p.startTime DESC
LIMIT 3","match
$p isa process, has name $n, has pid $pid, has start_time $st;
$port isa port, has port_number 80;
listens (listening_process: $p, listened_port: $port);
sort $st desc;
limit 3;
fetch {
  ""name"": $n,
  ""pid"": $pid,
  ""startTime"": $st
};"
579,List the first 3 applications that started after timestamp 1606165629748.,"MATCH (app:Application)
WHERE app.startTime > 1606165629748
RETURN app.name, app.startTime
ORDER BY app.startTime
LIMIT 3","match
$app isa application, has start_time $st;
$st > 1606165629748;
sort $st asc;
limit 3;
fetch {
  ""name"": $app.name,
  ""startTime"": $st
};"
580,Which software depends on version '7.1'?,"MATCH (v:Version {name: '7.1'})&lt;-[:DEPENDS_ON]-(s:Software)
RETURN s.name","match
$v isa version, has name ""7.1"";
$s isa software;
depends_on (dependent: $s, dependency: $v);
fetch {
  ""name"": $s.name
};"
581,Identify the first 5 types of machines in zone 3 by rack.,"MATCH (dc:DataCenter)-[:CONTAINS]->(rack:Rack {zone: 3})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN rack.name AS rackName, machine.name AS machineName, type.name AS typeName
ORDER BY rack.name, machine.name
LIMIT 5","match
  $dc isa data_center;
  dc_contains (data_center: $dc, contained_equipment: $rack);
  $rack isa rack, has zone 3, has name $rn;
  holds (containing_rack: $rack, held_equipment: $machine);
  $machine isa machine, has name $mn;
  typed_as (machine: $machine, spec: $type);
  $type isa machine_type_spec, has name $tn;
sort $rn, $mn;
limit 5;
fetch {
  ""rackName"": $rn,
  ""machineName"": $mn,
  ""typeName"": $tn
};"
582,Find the first 3 networks routing through interface with IP '10.1.0.254'.,"MATCH (i:Interface {ip: '10.1.0.254'})&lt;-[:ROUTES]-(n:Network)
RETURN n.ip
LIMIT 3","match
$i isa interface, has ip ""10.1.0.254"";
$n isa network;
routes (routing_device: $n, routed_interface: $i);
limit 3;
fetch {
  ""ip"": $n.ip
};"
583,Which racks are contained within Data Center DC1 and are in zone 2?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(rack:Rack {zone: 2})
RETURN rack.name","match
$dc isa data_center, has name ""DC1"";
$rack isa rack, has zone 2;
dc_contains (data_center: $dc, contained_equipment: $rack);
fetch {
  ""name"": $rack.name
};"
584,What are the names of the egress nodes in Data Center DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(e:Egress)
RETURN e.name","match
$dc isa data_center, has name ""DC1"";
$e isa egress;
dc_contains (data_center: $dc, contained_equipment: $e);
fetch {
  ""name"": $e.name
};"
585,Can you list the first 4 dependencies of the 'webserver' application?,"MATCH (app:Application {name: 'webserver'})-[:DEPENDS_ON]->(dep)
RETURN dep.name
LIMIT 4","match
$app isa application, has name ""webserver"";
depends_on (dependent: $app, dependency: $dep);
$dep has name $dep_name;
limit 4;
fetch { ""dep.name"": $dep_name };"
586,Display the top 3 services by PID running in Data Center DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
RETURN s.name AS service_name, s.pid AS pid
ORDER BY s.pid DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $s);
$s isa service, has pid $pid;
sort $pid desc;
limit 3;
fetch {
  ""service_name"": $s.name,
  ""pid"": $pid
};"
587,Which applications listen on port 80?,"MATCH (p:Port {port: 80})<-[:LISTENS]-(a:Application)
RETURN a.name","match
$p isa port, has port_number 80;
$a isa application;
listens (listening_process: $a, listened_port: $p);
fetch {
  ""name"": $a.name
};"
588,List all versions that software 'RHEL' depends on.,"MATCH (s:Software {name: 'RHEL'})-[:DEPENDS_ON]->(v:Version)
RETURN v.name","match
$s isa software, has name ""RHEL"";
$v isa version;
depends_on (dependent: $s, dependency: $v);
fetch {
  ""name"": $v.name
};"
589,Which racks in zone 1 contain switches with IP starting with '10.1'?,"MATCH (r: Rack {zone: 1})-[:HOLDS]->(s: Switch)
WHERE s.ip STARTS WITH '10.1'
RETURN r.name","match
$r isa rack, has zone 1;
$s isa switch, has ip $ip;
$ip like ""^10\\.1.*"";
holds (containing_rack: $r, held_equipment: $s);
fetch {
  ""name"": $r.name
};"
590,Find the first 5 processes running on any machine in Data Center DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(p:Process)
RETURN p.name, p.startTime, p.pid
ORDER BY p.startTime ASC
LIMIT 5","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $p);
$p isa process, has start_time $st;
sort $st asc;
limit 5;
fetch {
  ""name"": $p.name,
  ""startTime"": $st,
  ""pid"": $p.pid
};"
591,Which ports are exposed by the interface with IP '10.0.0.254'?,"MATCH (i:Interface {ip: '10.0.0.254'})-[:EXPOSES]->(p:Port)
RETURN p.port AS exposed_ports","match
$i isa interface, has ip ""10.0.0.254"";
exposes (exposing_interface: $i, exposed_port: $p);
$p isa port;
fetch {
  ""exposed_ports"": $p.port_number
};"
592,List all software versions associated with the software named 'RHEL'.,"MATCH (s:Software {name: 'RHEL'})-[:VERSION]->(v:Version)
RETURN v.name AS version","match
$s isa software, has name ""RHEL"";
has_version (versioned_software: $s, release_version: $v);
$v isa version;
fetch {
  ""version"": $v.name
};"
593,What are the names of applications running on machines in rack 'DC1-RCK-1-1'?,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:RUNS]->(application:Application)
RETURN application.name","match
$rack isa rack, has name ""DC1-RCK-1-1"";
$machine isa machine;
$application isa application;
holds (containing_rack: $rack, held_equipment: $machine);
runs (host_machine: $machine, running_process: $application);
fetch {
  ""name"": $application.name
};"
594,Identify the top 5 machines held in racks within zone 1.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack {zone: 1})-[:HOLDS]->(m:Machine)
RETURN m.name AS machine_name
LIMIT 5","match
$dc isa data_center;
$r isa rack, has zone 1;
$m isa machine;
dc_contains (data_center: $dc, contained_equipment: $r);
holds (containing_rack: $r, held_equipment: $m);
limit 5;
fetch { ""machine_name"": $m.name };"
595,Which interfaces are connected to the router named 'DC1-R-1'?,"MATCH (r:Router {name: 'DC1-R-1'})-[:ROUTES]->(i:Interface)
RETURN i.ip AS InterfaceIP","match
$r isa router, has name ""DC1-R-1"";
routes (routing_device: $r, routed_interface: $i);
$i isa interface;
fetch {
  ""InterfaceIP"": $i.ip
};"
596,List the first 3 zones by IP address in ascending order.,"MATCH (z:Zone)
RETURN z.ip
ORDER BY z.ip ASC
LIMIT 3","match $z isa network_zone, has ip $ip;
sort $ip asc;
limit 3;
fetch { ""ip"": $ip };"
597,What are the names of the top 3 routers in Data Center DC1?,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(r:Router)
RETURN r.name
ORDER BY r.name
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
$r isa router, has name $name;
dc_contains (data_center: $dc, contained_equipment: $r);
sort $name;
limit 3;
fetch {
  ""name"": $name
};"
598,Identify the top 5 applications by PID that depend on the service 'java'.,"MATCH (app:Application)-[:DEPENDS_ON]->(service:Service {name: 'java'})
RETURN app.name AS application, app.pid AS pid
ORDER BY pid DESC
LIMIT 5","match
$app isa application, has name $app_name, has pid $pid;
$service isa service, has name ""java"";
depends_on (dependent: $app, dependency: $service);
sort $pid desc;
limit 5;
fetch {
  ""application"": $app_name,
  ""pid"": $pid
};"
599,What are the IP addresses of networks in zone 2?,"MATCH (n:Network)
WHERE n.zone = 2
RETURN n.ip AS network_ip","match
$n isa network, has zone 2, has ip $ip;
fetch {
  ""network_ip"": $ip
};"
600,What are the top 3 largest types by disk size available in the system?,"MATCH (t:Type)
RETURN t.name, t.disk
ORDER BY t.disk DESC
LIMIT 3","match $t isa machine_type_spec, has disk $d;
sort $d desc;
limit 3;
fetch { ""name"": $t.name, ""disk"": $d };"
601,Which applications have 'cms' as a dependency?,"MATCH (app:Application {name: 'cms'})<-[:DEPENDS_ON]-(dependentApp:Application)
RETURN dependentApp.name","match
$cms isa application, has name ""cms"";
$app isa application, has name $n;
depends_on (dependent: $app, dependency: $cms);
fetch {
  ""name"": $n
};"
602,List the first 3 racks by name that contain switches.,"MATCH (rack:Rack)-[:HOLDS]->(:Switch)
RETURN rack.name
ORDER BY rack.name
LIMIT 3","match
$rack isa rack, has name $name;
$switch isa switch;
holds (containing_rack: $rack, held_equipment: $switch);
sort $name;
limit 3;
fetch { ""name"": $name };"
604,What are the names of all egress nodes routing through interface with IP '10.0.0.254'?,"MATCH (e:Egress)-[:ROUTES]->(i:Interface {ip: '10.0.0.254'})
RETURN e.name","match
$e isa egress;
$i isa interface, has ip ""10.0.0.254"";
routes (routing_device: $e, routed_interface: $i);
fetch {
  ""name"": $e.name
};"
605,List the first 3 interfaces that connect to routers in zone 1.,"MATCH (r:Router {zone: 1})-[:ROUTES]->(i:Interface)
RETURN i.ip
LIMIT 3","match
$r isa router, has zone 1;
routes (routing_device: $r, routed_interface: $i);
$i isa interface;
limit 3;
fetch { ""ip"": $i.ip };"
606,Which applications are instances of software named 'webapp'?,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(software:Software)
RETURN app.name AS ApplicationName","match
$software isa software, has name ""webapp"";
$app isa application;
instance_of (running_instance: $app, template: $software);
fetch {
  ""ApplicationName"": $app.name
};"
607,Which processes are instances of version '7.1'?,"MATCH (p:Process)-[:INSTANCE]->(v:Version {name: '7.1'})
RETURN p.name AS processName, p.startTime AS startTime, p.pid AS pid","match
$p isa process;
$v isa version, has name ""7.1"";
instance_of (running_instance: $p, template: $v);
fetch {
  ""processName"": $p.name,
  ""startTime"": $p.start_time,
  ""pid"": $p.pid
};"
608,List the first 3 ports exposed by any service running on OS 'RHEL'.,"MATCH (os:OS {name: 'RHEL'})-[:INSTANCE]->(version:Version)<-[:INSTANCE]-(service:Service)-[:LISTENS]->(port:Port)
RETURN port.port
LIMIT 3","match
$os isa os, has name ""RHEL"";
instance_of (running_instance: $os, template: $version);
$service isa service;
instance_of (running_instance: $service, template: $version);
listens (listening_process: $service, listened_port: $port);
limit 3;
fetch { ""port"": $port.port_number };"
609,What are the IP addresses of interfaces that are connected to zone 3's network?,"MATCH (zone:Zone {zone: 3})-[:ROUTES]->(interface:Interface)
RETURN interface.ip","match
$zone isa network_zone, has zone 3;
routes (routing_device: $zone, routed_interface: $interface);
$interface isa interface;
fetch {
  ""ip"": $interface.ip
};"
610,Identify the top 5 types of machines by CPU power available in the system.,"MATCH (m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS typeName, t.cpu AS cpuPower
ORDER BY t.cpu DESC
LIMIT 5","match
$m isa machine;
typed_as (machine: $m, spec: $t);
$t has name $name, has cpu $cpu;
sort $cpu desc;
limit 5;
fetch {
  ""typeName"": $name,
  ""cpuPower"": $cpu
};"
611,Which racks contain machines running application named 'logstash'?,"MATCH (app:Application {name: 'logstash'})<-[:RUNS]-(machine:Machine)<-[:HOLDS]-(rack:Rack)
RETURN DISTINCT rack.name AS rack_name","match
$app isa application, has name ""logstash"";
runs (host_machine: $machine, running_process: $app);
holds (containing_rack: $rack, held_equipment: $machine);
select $rack;
distinct;
fetch { ""rack_name"": $rack.name };"
612,What are the dependencies of the process named '8966'?,"MATCH (p:Process {pid: 8966})-[:DEPENDS_ON]->(dependency)
RETURN dependency.name AS DependencyName","match
$p isa process, has pid 8966;
depends_on (dependent: $p, dependency: $dep);
$dep has name $n;
fetch { ""DependencyName"": $n };"
613,Find the top 3 largest services by RAM usage in Data Center DC1.,"MATCH (dc:DataCenter {name: 'DC1'})-[:CONTAINS]->(:Rack)-[:HOLDS]->(m:Machine)-[:RUNS]->(s:Service)
MATCH (m)-[:TYPE]->(t:Type)
RETURN s.name AS serviceName, t.ram AS ramUsage
ORDER BY t.ram DESC
LIMIT 3","match
$dc isa data_center, has name ""DC1"";
dc_contains (data_center: $dc, contained_equipment: $rack);
$rack isa rack;
holds (containing_rack: $rack, held_equipment: $m);
$m isa machine;
runs (host_machine: $m, running_process: $s);
$s isa service, has name $sname;
typed_as (machine: $m, spec: $t);
$t has ram $ram;
sort $ram desc;
limit 3;
fetch {
  ""serviceName"": $sname,
  ""ramUsage"": $ram
};"
614,Find the top 3 types of machines by RAM in racks located in zone 4.,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Rack {zone: 4})-[:HOLDS]->(m:Machine)-[:TYPE]->(t:Type)
RETURN t.name AS type, t.ram AS ram
ORDER BY t.ram DESC
LIMIT 3","match
$dc isa data_center;
$r isa rack, has zone 4;
$m isa machine;
$t isa machine_type_spec, has ram $ram;
dc_contains (data_center: $dc, contained_equipment: $r);
holds (containing_rack: $r, held_equipment: $m);
typed_as (machine: $m, spec: $t);
sort $ram desc;
limit 3;
fetch {
  ""type"": $t.name,
  ""ram"": $ram
};"
615,List the first 3 applications that are dependencies of processes named '7.1'.,"MATCH (p:Process {name: '7.1'})-[:DEPENDS_ON]->(a:Application)
RETURN a.name
LIMIT 3","match
$p isa process, has name ""7.1"";
$a isa application, has name $n;
depends_on (dependent: $p, dependency: $a);
limit 3;
fetch { ""name"": $n };"
616,Which ports does the application 'crm' listen to?,"MATCH (app:Application {name: 'crm'})-[:LISTENS]->(port:Port)
RETURN port.port AS Port","match
$app isa application, has name ""crm"";
listens (listening_process: $app, listened_port: $port);
fetch {
  ""Port"": $port.port_number
};"
617,Find the top 5 processes by PID that are instances of application 'webapp'.,"MATCH (app:Application {name: 'webapp'})-[:INSTANCE]->(proc:Process)
RETURN proc.name AS processName, proc.pid AS processPID
ORDER BY proc.pid DESC
LIMIT 5","match
$app isa application, has name ""webapp"";
$proc isa process, has pid $pid;
instance_of (running_instance: $proc, template: $app);
sort $pid desc;
limit 5;
fetch {
  ""processName"": $proc.name,
  ""processPID"": $pid
};"
618,What ports are listened to by the service named 'java'?,"MATCH (s:Service {name: 'java'})-[:LISTENS]->(p:Port)
RETURN p.port AS port","match
$s isa service, has name ""java"";
listens (listening_process: $s, listened_port: $p);
$p isa port;
fetch {
  ""port"": $p.port_number
};"
619,List all machines and their types in rack 'DC1-RCK-1-1'.,"MATCH (rack:Rack {name: 'DC1-RCK-1-1'})-[:HOLDS]->(machine:Machine)-[:TYPE]->(type:Type)
RETURN machine.name AS machineName, type.name AS typeName","match
$rack isa rack, has name ""DC1-RCK-1-1"";
holds (containing_rack: $rack, held_equipment: $machine);
$machine isa machine;
typed_as (machine: $machine, spec: $type);
$type isa machine_type_spec;
fetch {
  ""machineName"": $machine.name,
  ""typeName"": $type.name
};"
620,What are the top 3 software names that depend on 'webserver'?,"MATCH (s:Software)-[:DEPENDS_ON]->(:Application {name: 'webserver'})
RETURN s.name AS software_name
ORDER BY s.name
LIMIT 3","match
$s isa software, has name $name;
$a isa application, has name ""webserver"";
depends_on (dependent: $s, dependency: $a);
sort $name;
limit 3;
fetch {
  ""software_name"": $name
};"
621,Which versions of software are depended upon by more than one other software?,"MATCH (s1:Software)-[:DEPENDS_ON]->(v:Version)<-[:VERSION]-(s2:Software)
WITH v, COUNT(DISTINCT s1) AS dependents
WHERE dependents > 1
RETURN v.name AS version, dependents","match
$v isa version;
$s1 isa software;
depends_on (dependent: $s1, dependency: $v);
reduce $count = count($s1) groupby $v;
match $count > 1;
fetch { ""version"": $v.name, ""dependents"": $count };"
622,Which services started after timestamp 1605733619064 and before 1606597376483?,"MATCH (s:Service)
WHERE s.startTime > 1605733619064 AND s.startTime < 1606597376483
RETURN s.name, s.startTime","match
$s isa service, has start_time $st;
$st > 1605733619064;
$st < 1606597376483;
fetch {
  ""name"": $s.name,
  ""startTime"": $st
};"
624,Identify all applications running on machines that are of type 'xl'.,"MATCH (t:Type {type: 'xl'})&lt;-[:TYPE]-(m:Machine)-[:RUNS]->(a:Application)
RETURN a.name AS applicationName","match
$t isa machine_type_spec, has machine_type ""xl"";
typed_as (machine: $m, spec: $t);
runs (host_machine: $m, running_process: $a);
$a isa application;
fetch {
  ""applicationName"": $a.name
};"
31,What are the start times for applications named 'webserver' in zone 3?,"MATCH (dc:DataCenter)-[:CONTAINS]->(r:Router {zone: 3})-[:ROUTES]->(i:Interface)<-[:ROUTES]-(z:Zone {zone: 3}),
      (rck:Rack {zone: 3})-[:HOLDS]->(m:Machine)-[:RUNS]->(app:Application {name: 'webserver'})
RETURN app.startTime","match
$rck isa rack, has zone 3;
$m isa machine;
$app isa application, has name ""webserver"";
holds (containing_rack: $rck, held_equipment: $m);
runs (host_machine: $m, running_process: $app);
fetch {
  ""startTime"": $app.start_time
};"
