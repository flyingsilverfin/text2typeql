original_index,question,cypher,typeql
0,Which 3 movies have the longest runtime and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has runtime $rt;
$rd < 2000-01-01T00:00:00;
sort $rt desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""runtime"": $rt
};"
1,What are the top 3 genres associated with videos that have a runtime over 100 minutes?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime > 100
RETURN g.name, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has runtime $r;
$r > 100;
in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre_name"": $g.genre_name, ""video_count"": $count };"
2,What are the first 3 languages spoken in the most popular movies (popularity > 20)?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 20
RETURN l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has popularity $pop;
$pop > 20;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name };"
3,List the top 5 actors by the number of movies they have cast in with a budget over 50 million USD.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.budget > 50000000
WITH p, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN p.name AS actor, movie_count","match
$p isa person, has person_name $name;
$m isa movie, has budget $b;
$b > 50000000;
cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""actor"": $p.person_name,
  ""movie_count"": $count
};"
4,"Name the top 5 movies that have been produced in a specific genre, e.g., 'Animation'.","MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title AS MovieTitle, m.average_vote AS AverageVote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
sort $av desc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""AverageVote"": $av
};"
5,List the first 3 languages spoken in movies released after 2010.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2010-01-01')
RETURN DISTINCT l.name
ORDER BY l.name
LIMIT 3","match
$m isa movie, has release_date $rd;
$rd > 2010-01-01T00:00:00;
spoken_in_language (media: $m, language: $l);
$l has language_name $ln;
select $ln;
distinct;
sort $ln asc;
limit 3;
fetch {
  ""language_name"": $ln
};"
6,Which 5 countries have produced the most adult films?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(a) AS adult_film_count
ORDER BY adult_film_count DESC
LIMIT 5","match
$a isa adult_video;
produced_in_country (media: $a, country: $c);
$c isa country;
reduce $adult_film_count = count($a) groupby $c;
sort $adult_film_count desc;
limit 5;
fetch {
  ""country"": $c.country_name,
  ""adult_film_count"": $adult_film_count
};"
7,Which 5 users have rated the highest number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 5
RETURN u.id AS userId, ratingCount","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($m) groupby $u;
sort $count desc;
limit 5;
fetch {
  ""userId"": $u.user_id,
  ""ratingCount"": $count
};"
8,What are the first 3 collections that include movies with a budget over 50 million USD?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.budget > 50000000
RETURN DISTINCT c.name
ORDER BY c.name
LIMIT 3","match
$m isa movie, has budget $b;
$b > 50000000;
in_collection (media: $m, collection: $c);
$c has collection_name $cn;
select $c, $cn;
distinct;
sort $cn asc;
limit 3;
fetch { ""name"": $cn };"
9,List the top 5 actors by the number of movies they have cast in.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN p.name AS actor_name, movie_count","match
$p isa person, has person_name $name;
$m isa movie;
cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""actor_name"": $name, ""movie_count"": $count };"
10,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, keyword_count","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m;
sort $keyword_count desc;
limit 3;
fetch { ""MovieTitle"": $m.title, ""keyword_count"": $keyword_count };"
11,List the 5 countries where movies with a revenue greater than 500 million USD were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 500000000
RETURN DISTINCT c.name
LIMIT 5","match
$m isa movie, has revenue $r;
$r > 500000000.0;
produced_in_country (media: $m, country: $c);
$c has country_name $cn;
select $cn;
distinct;
limit 5;
fetch { ""country_name"": $cn };"
12,What are the first 3 genres associated with movies that have a popularity greater than 20?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.popularity > 20
RETURN DISTINCT g.name
LIMIT 3","match
  $m isa movie, has popularity $pop;
  $pop > 20;
  in_genre (media: $m, genre: $g);
  $g has genre_name $gn;
select $gn;
distinct;
limit 3;
fetch {
  ""genre_name"": $gn
};"
13,Name the top 3 production companies by the number of movies produced with a budget over 100 million USD.,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
RETURN pc.name AS production_company, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$pc isa production_company, has production_company_name $name;
$m isa movie, has budget $b;
$b > 100000000;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""movie_count"": $count };"
14,Which 5 movies have the highest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has average_vote $av;
$rd < 2000-01-01T00:00:00;
sort $av desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
15,What are the top 5 movies by revenue that have a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has runtime $rt, has revenue $rev;
$rt > 120.0;
sort $rev desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
16,Which 3 directors have the most films with a status of 'Released'?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director' AND m.status = 'Released'
RETURN p.name AS Director, COUNT(m) AS FilmCount
ORDER BY FilmCount DESC
LIMIT 3","match
$p isa person;
$m isa media, has status ""Released"";
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch {
  ""director"": $p.person_name,
  ""film_count"": $count
};"
17,What are the top 5 movies with the most spoken languages and released after 2015?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date(""2015-01-01"")
WITH m, count(l) AS language_count
ORDER BY language_count DESC
LIMIT 5
RETURN m.title AS movie_title, language_count","match
$m isa movie, has release_date $rd;
$rd > 2015-01-01T00:00:00;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie_title"": $m.title,
  ""language_count"": $count
};"
18,List the first 3 genres with the most movies featuring a runtime over 200 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 200
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has runtime $r;
$r > 200.0;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""movie_count"": $count
};"
19,Who are the first 3 actors to have appeared in movies from more than five different countries?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH p, COUNT(DISTINCT c) AS countryCount
WHERE countryCount > 5
WITH p
MATCH (p)-[r:CAST_FOR]->(m:Movie)
RETURN p.name AS actorName, COUNT(DISTINCT m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$p isa person;
cast_for (actor: $p, film: $m);
$m isa movie;
produced_in_country (media: $m, country: $c);
select $p, $c;
distinct;
reduce $country_count = count($c) groupby $p;
match $country_count > 5;
match
cast_for (actor: $p, film: $m2);
$m2 isa movie;
select $p, $m2;
distinct;
reduce $movie_count = count($m2) groupby $p;
sort $movie_count desc;
limit 3;
fetch { ""actorName"": $p.person_name, ""movieCount"": $movie_count };"
20,Name the top 3 genres in videos that have a runtime less than 30 minutes.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime < 30
RETURN g.name AS genre, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has runtime $r;
$r < 30.0;
$g isa genre, has genre_name $gn;
in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name };"
21,What are the top 3 countries producing the most videos with a budget over $1 million?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 1000000
RETURN c.name AS country, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has budget $b;
$b > 1000000;
$c isa country;
produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name, ""video_count"": $count };"
22,Which 3 languages are most common in movies with a revenue over $200 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 200000000
RETURN l.name, COUNT(*) AS language_count
ORDER BY language_count DESC
LIMIT 3","match
$m isa movie, has revenue $r;
$r > 200000000;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language_name"": $l.language_name, ""count"": $count };"
23,Who are the first 3 directors to have made both adult films and videos?,"MATCH (director:Person)-[:CREW_FOR]->(adult:Adult {status: 'Released'}),
      (director)-[:CREW_FOR]->(video:Video {status: 'Released'})
WHERE EXISTS {
  MATCH (director)-[:CREW_FOR]->(adult)-[:IN_GENRE]->(:Genre {name: 'Adult'})
}
AND EXISTS {
  MATCH (director)-[:CREW_FOR]->(video)-[:IN_GENRE]->(:Genre {name: 'Video'})
}
AND (director)-[:CREW_FOR]->(:Adult)-[:IN_GENRE]->(:Genre {name: 'Adult'})
AND (director)-[:CREW_FOR]->(:Video)-[:IN_GENRE]->(:Genre {name: 'Video'})
RETURN DISTINCT director.name
LIMIT 3","match
$director isa person, has person_name $name;
$adult isa media, has status ""Released"";
$video isa media, has status ""Released"";
$g1 isa genre, has genre_name ""Adult"";
$g2 isa genre, has genre_name ""Video"";
crew_for (crew_member: $director, film: $adult);
crew_for (crew_member: $director, film: $video);
in_genre (media: $adult, genre: $g1);
in_genre (media: $video, genre: $g2);
select $name;
distinct;
limit 3;
fetch { ""name"": $name };"
24,What are the top 5 genres with the most movies having a poster path that starts with '/rh'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.poster_path STARTS WITH '/rh'
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$m isa movie, has poster_path $pp;
$pp like ""^/rh.*"";
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
25,List the first 3 actors who have appeared in at least three movies with different original languages.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH p, COUNT(DISTINCT l.id) AS languageCount, COUNT(DISTINCT m.id) AS movieCount
WHERE languageCount >= 3 AND movieCount >= 3
RETURN p.name AS actorName
ORDER BY actorName
LIMIT 3","match
$p isa person, has person_name $name;
cast_for (actor: $p, film: $m);
$m isa movie;
original_language (media: $m, language: $l);
select $p, $name, $l;
distinct;
reduce $lang_count = count($l) groupby $p, $name;
match $lang_count >= 3;
sort $name;
limit 3;
fetch { ""actorName"": $name };"
26,Which 3 production companies have the most movies with a runtime under 80 minutes?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime < 80
RETURN p.name, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$p isa production_company;
$m isa movie, has runtime $r;
$r < 80;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch {
  ""name"": $p.production_company_name,
  ""movie_count"": $count
};"
27,What are the top 5 countries producing the most movies with a tagline that includes the word 'love'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.tagline CONTAINS 'love'
RETURN c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
  $m isa movie, has tagline $t;
  $t like "".*love.*"";
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""country"": $c.country_name,
  ""movie_count"": $count
};"
28,Who are the first 3 directors who have worked on movies with an average vote below 5?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director"" AND m.average_vote < 5
RETURN p.name AS Director
ORDER BY m.average_vote ASC
LIMIT 3","match
$p isa person;
$m isa movie, has average_vote $av;
$av < 5.0;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
sort $av asc;
limit 3;
fetch {
  ""Director"": $p.person_name
};"
29,What are the top 5 production companies with the most movies featuring a runtime over 150 minutes?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 150
RETURN p.name AS ProductionCompany, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 5","match
$p isa production_company, has production_company_name $name;
$m isa movie, has runtime $r;
$r > 150;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""production_company"": $p.production_company_name,
  ""movie_count"": $count
};"
30,List the first 3 movies with the highest number of directors.,"MATCH (p:Person)-[:CREW_FOR {job: ""Director""}]->(m:Movie)
WITH m, COUNT(p) AS director_count
ORDER BY director_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, director_count AS NumberOfDirectors","match
$m isa movie;
$p isa person;
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Director"";
reduce $count = count($p) groupby $m;
sort $count desc;
limit 3;
fetch { ""MovieTitle"": $m.title, ""NumberOfDirectors"": $count };"
31,Which 3 languages are most commonly spoken in movies with an average vote below 4?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.average_vote < 4
RETURN l.name AS language, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has average_vote $av;
$av < 4.0;
$l isa language, has language_name $ln;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""count"": $count
};"
33,What are the top 5 genres with the least number of movies made?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, COUNT(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 5
RETURN g.name AS genre, movieCount","match
$g isa genre;
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $movieCount = count($m) groupby $g;
sort $movieCount asc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""movieCount"": $movieCount
};"
34,List the top 3 movies with a budget over 100 million USD and an average vote above 7.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.average_vote > 7
RETURN m.title, m.budget, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie,
  has budget $b,
  has average_vote $av,
  has title $t;
$b > 100000000;
$av > 7.0;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b,
  ""average_vote"": $av
};"
35,List the top 5 movies with the most production companies involved.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, COUNT(pc) AS productionCompanyCount
ORDER BY productionCompanyCount DESC
LIMIT 5
RETURN m.title AS MovieTitle, productionCompanyCount","match
$m isa movie, has title $t;
$pc isa production_company;
produced_by (media: $m, producer: $pc);
reduce $count = count($pc) groupby $m, $t;
sort $count desc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""productionCompanyCount"": $count
};"
36,List the first 5 production companies that produced videos with zero revenue.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE v.revenue = 0.0
RETURN DISTINCT pc.name
LIMIT 5","match
$v isa video, has revenue 0.0;
$pc isa production_company, has production_company_name $name;
produced_by (media: $v, producer: $pc);
select $name;
distinct;
limit 5;
fetch {
  ""production_company_name"": $name
};"
37,What are the top 3 countries where adult films are produced the most?,"MATCH (:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(*) as num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN c.name AS country, num_adult_films","match
$a isa adult_video;
produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""num_adult_films"": $count
};"
38,"Which 5 keywords are most common in adult films with a budget less than 500,000 USD?","MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WHERE a.budget < 500000
RETURN k.name AS keyword, COUNT(*) AS occurrences
ORDER BY occurrences DESC
LIMIT 5","match
$a isa adult_video, has budget $b;
$b < 500000;
has_keyword (media: $a, keyword: $k);
$k has keyword_name $name;
reduce $count = count($a) groupby $k;
sort $count desc;
limit 5;
fetch {
  ""keyword"": $k.keyword_name,
  ""occurrences"": $count
};"
39,"List the first 3 adult films with a specific tagline, e.g., 'Trust Will Get You Killed'.","MATCH (a:Adult {tagline: 'Trust Will Get You Killed'})
RETURN a.title, a.release_date, a.tagline
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has tagline ""Trust Will Get You Killed"", has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""release_date"": $rd,
  ""tagline"": $a.tagline
};"
41,What are the first 3 collections that include videos?,"MATCH (v:Video)-[:IN_COLLECTION]->(c:Collection)
RETURN DISTINCT c.name
LIMIT 3","match
$v isa video;
in_collection (media: $v, collection: $c);
$c has collection_name $name;
select $name;
distinct;
limit 3;
fetch {
  ""collection_name"": $name
};"
42,"List the top 5 movies with the most diverse cast, measured by the number of different countries actors come from.","MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, COUNT(DISTINCT c.id) AS country_count
ORDER BY country_count DESC
LIMIT 5
RETURN m.title AS movie_title, country_count","match
  $m isa movie;
  cast_for (actor: $p, film: $m);
  born_in (person: $p, country: $c);
select $m, $c;
distinct;
reduce $count = count($c) groupby $m;
sort $count desc;
limit 5;
fetch { ""movie_title"": $m.title, ""country_count"": $count };"
43,Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.revenue > 0 AND m.budget > 0
WITH m, (m.budget / m.revenue) AS budget_to_revenue_ratio
RETURN m.title, m.budget, m.revenue, budget_to_revenue_ratio
ORDER BY budget_to_revenue_ratio DESC
LIMIT 3","match
$m isa movie,
  has title $title,
  has budget $budget,
  has revenue $revenue;
$revenue > 0.0;
$budget > 0;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""budget_to_revenue_ratio"": $ratio
};"
44,List the first 5 languages used in the original language of adult films.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN DISTINCT l.name
LIMIT 5","match
$a isa adult_video;
original_language (media: $a, language: $l);
$l has language_name $name;
select $name;
distinct;
limit 5;
fetch {
  ""language_name"": $name
};"
45,What are the top 3 movies based on popularity that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date(""1990-01-01"") AND m.release_date < date(""2000-01-01"")
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has popularity $pop, has release_date $rd;
$rd >= 1990-01-01T00:00:00;
$rd < 2000-01-01T00:00:00;
sort $pop desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
46,Name the first 5 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.title
LIMIT 5","match
$m isa movie, has title $t, has homepage $h;
sort $t asc;
limit 5;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
47,List the top 3 actors who have appeared in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
MATCH (p)-[:CAST_FOR]->(v:Video)
WITH p, COUNT(DISTINCT m) AS movie_count, COUNT(DISTINCT v) AS video_count
WHERE movie_count > 0 AND video_count > 0
RETURN p.name AS actor, movie_count, video_count
ORDER BY movie_count + video_count DESC
LIMIT 3","match
$p isa person;
cast_for (actor: $p, film: $m);
$m isa $t;
{ $t label movie; } or { $t label video; };
not { not { cast_for (actor: $p, film: $mv); $mv isa movie; }; };
not { not { cast_for (actor: $p, film: $vd); $vd isa video; }; };
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""actor"": $p.person_name, ""count"": $count };"
48,Which 5 genres are most common among movies with a budget over 200 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 200000000
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$m isa movie, has budget $b;
$b > 200000000;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
49,List the first 3 keywords associated with movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN DISTINCT k.name
LIMIT 3","match
$m isa movie, has poster_path $pp;
$pp like "".*\\.jpg"";
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
select $kn;
distinct;
limit 3;
fetch {
  ""keyword_name"": $kn
};"
50,Name the top 5 production companies that have produced movies with a runtime longer than 150 minutes.,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 150
RETURN p.name, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$p isa production_company, has production_company_name $name;
$m isa movie, has runtime $rt;
$rt > 150;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch { ""name"": $p.production_company_name };"
51,What are the first 3 movies that were produced in the United States and have a vote count greater than 5000?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
WHERE m.vote_count > 5000
RETURN m.title AS MovieTitle, m.vote_count AS VoteCount
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has vote_count $vc, has release_date $rd;
$vc > 5000;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
sort $rd;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""VoteCount"": $vc
};"
52,List the top 5 actors based on the number of leading roles they have had in movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.order = 0
RETURN p.name AS actor, COUNT(m) AS leading_roles
ORDER BY leading_roles DESC
LIMIT 5","match
$p isa person;
$rel isa cast_for (actor: $p, film: $m);
$rel has cast_order 0;
$m isa movie;
reduce $leading_roles = count($m) groupby $p;
sort $leading_roles desc;
limit 5;
fetch {
  ""actor"": $p.person_name,
  ""leading_roles"": $leading_roles
};"
53,Which 3 users have given the highest ratings to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, r.rating AS rating
ORDER BY rating DESC
LIMIT 3
RETURN u.id AS userId, rating","match
$u isa user, has user_id $uid;
$r isa rated (reviewer: $u, rated_media: $m);
$m isa movie;
$r has rating $rating;
sort $rating desc;
limit 3;
fetch { ""userId"": $uid, ""rating"": $rating };"
54,List the first 5 adult films released after 2010.,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 5","match
$a isa adult_video, has release_date $rd, has title $t;
$rd > 2010-01-01T00:00:00;
sort $rd;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
55,What are the top 3 adult films with the highest average vote?,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
$a isa adult_video, has title $title, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $title,
  ""average_vote"": $av
};"
56,Name the first 5 genres that videos with a popularity rating above 5 belong to.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.popularity > 5
RETURN DISTINCT g.name
LIMIT 5","match
$v isa video, has popularity $pop;
$pop > 5.0;
in_genre (media: $v, genre: $g);
$g has genre_name $name;
select $name;
distinct;
limit 5;
fetch { ""genre_name"": $name };"
57,List the top 3 countries by the number of videos produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3
RETURN country, video_count","match
$v isa video;
$c isa country, has country_name $name;
produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $name;
sort $count desc;
limit 3;
fetch { ""country"": $name, ""video_count"": $count };"
58,Which 5 movies have the most cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, COUNT(p) AS cast_count
RETURN m.title AS movie_title, cast_count
ORDER BY cast_count DESC
LIMIT 5","match
$m isa movie;
$p isa person;
cast_for (actor: $p, film: $m);
reduce $count = count($p) groupby $m;
sort $count desc;
limit 5;
fetch { ""movie_title"": $m.title, ""cast_count"": $count };"
59,List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!'.,"MATCH (m:Movie)
WHERE m.tagline = 'Roll the dice and unleash the excitement!'
RETURN m.title
ORDER BY m.id
LIMIT 3","match
$m isa movie, has tagline ""Roll the dice and unleash the excitement!"", has movie_id $id;
sort $id asc;
limit 3;
fetch {
  ""title"": $m.title
};"
60,Name the top 5 directors who have worked on the most films.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director""
WITH p, COUNT(m) AS film_count
ORDER BY film_count DESC
LIMIT 5
RETURN p.name AS director_name, film_count","match
$p isa person;
$m isa movie;
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Director"";
reduce $film_count = count($m) groupby $p;
sort $film_count desc;
limit 5;
fetch {
  ""director_name"": $p.person_name,
  ""film_count"": $film_count
};"
61,What are the first 3 genres associated with the highest-grossing movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, m
ORDER BY m.revenue DESC
LIMIT 3
RETURN g.name AS Genre, m.title AS MovieTitle, m.revenue AS Revenue","match
$m isa movie, has revenue $rev, has title $t;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
sort $rev desc;
limit 3;
fetch {
  ""Genre"": $gn,
  ""MovieTitle"": $t,
  ""Revenue"": $rev
};"
62,"List the top 5 movies that have been produced by a specific company, e.g., 'Pixar Animation Studios'.","MATCH (company:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]-(movie:Movie)
RETURN movie.title, movie.average_vote
ORDER BY movie.average_vote DESC
LIMIT 5","match
$company isa production_company, has production_company_name ""Pixar Animation Studios"";
$movie isa movie, has average_vote $av;
produced_by (media: $movie, producer: $company);
sort $av desc;
limit 5;
fetch {
  ""title"": $movie.title,
  ""average_vote"": $av
};"
63,Which 3 languages are most frequently listed as the original language in videos?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video;
$l isa language;
original_language (media: $v, language: $l);
reduce $count = count($v) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""video_count"": $count };"
64,"List the first 5 movies that have been tagged with a specific keyword, e.g., 'adventure'.","MATCH (k:Keyword {name: 'adventure'})<-[:HAS_KEYWORD]-(m:Movie)
RETURN m.title AS MovieTitle
ORDER BY m.title
LIMIT 5","match
$k isa keyword, has keyword_name ""adventure"";
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
sort $t asc;
limit 5;
fetch {
  ""MovieTitle"": $t
};"
65,What are the top 3 actors who have played in the most number of adult films?,"MATCH (p:Person)-[:CAST_FOR]->(a:Adult)
WITH p, COUNT(a) AS numAdultFilms
ORDER BY numAdultFilms DESC
LIMIT 3
RETURN p.name AS actor, numAdultFilms","match
$p isa person;
$a isa adult_video;
cast_for (actor: $p, film: $a);
reduce $count = count($a) groupby $p;
sort $count desc;
limit 3;
fetch { ""actor"": $p.person_name, ""numAdultFilms"": $count };"
66,"Name the first 5 movies that were rated by users on a specific date, e.g., '2020-01-01'.","MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE date(r.timestamp) = date('2020-01-01')
RETURN m.title AS MovieTitle, r.timestamp AS RatingTimestamp
ORDER BY r.timestamp
LIMIT 5","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has timestamp $ts;
$ts >= 2020-01-01T00:00:00;
$ts < 2020-01-02T00:00:00;
sort $ts;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""RatingTimestamp"": $ts
};"
67,List the top 3 movies with the highest revenue that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title AS title, m.revenue AS revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $title, has revenue $rev;
in_collection (media: $m, collection: $c);
sort $rev desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $rev };"
68,"Name the first 5 movies that were produced by a specific country, e.g., 'France'.","MATCH (c:Country {name: 'France'})<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
$c isa country, has country_name ""France"";
produced_in_country (media: $m, country: $c);
$m isa movie, has release_date $rd;
sort $rd asc;
limit 5;
fetch { ""title"": $m.title };"
69,List the first 5 production companies that have produced the most adult films.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(a:Adult)
WITH pc, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 5
RETURN pc.name AS ProductionCompany, num_adult_films AS NumberOfAdultFilms","match
$pc isa production_company;
$a isa adult_video;
produced_by (media: $a, producer: $pc);
reduce $count = count($a) groupby $pc;
sort $count desc;
limit 5;
fetch { ""ProductionCompany"": $pc.production_company_name, ""NumberOfAdultFilms"": $count };"
70,Which movies have a title that starts with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m.title","match
$m isa movie, has title $t;
$t like ""The.*"";
fetch {
  ""title"": $t
};"
71,Which 3 movies have the highest average vote above 8.0?,"MATCH (m:Movie)
WHERE m.average_vote > 8.0
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has average_vote $av, has title $t;
$av > 8.0;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
72,"What are the first 3 adult videos with a budget over $500,000?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
$a isa adult_video, has budget $b, has title $t;
$b > 500000;
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
73,Name the top 5 adult videos with the highest average vote.,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
74,Which 3 adult videos have the longest runtime?,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
$a isa adult_video, has runtime $r;
sort $r desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""runtime"": $r
};"
75,List the top 5 adult videos by vote count.,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
$a isa adult_video, has title $t, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
76,What are the first 3 adult videos by revenue?,"MATCH (a:Adult)
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3","match
$a isa adult_video, has title $t, has revenue $r;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
77,Name the top 5 movies with 'Animated' as a keyword.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'Animation'})
RETURN m.title AS MovieTitle, m.average_vote AS AverageVote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
$k isa keyword, has keyword_name ""Animation"";
has_keyword (media: $m, keyword: $k);
sort $av desc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""AverageVote"": $av
};"
78,Which 3 countries have the least number of movies produced in them?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WITH c, COUNT(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN c.name AS country, movieCount","match
$c isa country;
$m isa movie;
produced_in_country (media: $m, country: $c);
reduce $movieCount = count($m) groupby $c;
sort $movieCount asc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""movieCount"": $movieCount
};"
79,List 5 movies where the original and spoken languages are different.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language), 
      (m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language)
WHERE ol.id <> sl.id
RETURN m.title AS MovieTitle, ol.name AS OriginalLanguage, sl.name AS SpokenLanguage
LIMIT 5","match
$m isa movie, has title $t;
$ol isa language, has language_name $oln, has language_id $olid;
$sl isa language, has language_name $sln, has language_id $slid;
original_language (media: $m, language: $ol);
spoken_in_language (media: $m, language: $sl);
$olid != $slid;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""OriginalLanguage"": $oln,
  ""SpokenLanguage"": $sln
};"
80,What are the first 3 languages spoken in movies with a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN DISTINCT l.name
LIMIT 3","match
$m isa movie, has budget $b;
$b > 50000000;
$l isa language, has language_name $ln;
spoken_in_language (media: $m, language: $l);
select $ln;
distinct;
limit 3;
fetch { ""language_name"": $ln };"
81,Name the top 5 genres by the average votes of the movies in them.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.vote_count > 0
WITH g.name AS genre, avg(m.average_vote) AS avg_vote
RETURN genre, avg_vote
ORDER BY avg_vote DESC
LIMIT 5","match
$m isa movie, has vote_count $vc, has average_vote $av;
$vc > 0;
in_genre (media: $m, genre: $g);
reduce $avg_vote = mean($av) groupby $g;
sort $avg_vote desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""avg_vote"": $avg_vote };"
82,Which 3 movies have the highest popularity but the least revenue?,"MATCH (m:Movie)
WITH m
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3
RETURN m.title AS Title, m.popularity AS Popularity, m.revenue AS Revenue","match
$m isa movie,
    has popularity $pop,
    has revenue $rev,
    has title $title;
sort $pop desc, $rev asc;
limit 3;
fetch {
    ""Title"": $title,
    ""Popularity"": $pop,
    ""Revenue"": $rev
};"
83,List the top 5 movies that have a homepage URL.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has homepage $h, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""homepage"": $h
};"
84,Name the top 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has tagline $tl, has popularity $pop;
$tl like "".*love.*"";
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""tagline"": $tl
};"
85,Which 3 movies have the most revenue among those released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has revenue $rev;
$rd >= 1990-01-01T00:00:00;
$rd < 2000-01-01T00:00:00;
sort $rev desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
86,List 5 movies that have a poster path containing '/rh'.,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rh'
RETURN m.title, m.poster_path
LIMIT 5","match
$m isa movie, has poster_path $pp;
$pp like "".*/rh.*"";
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
87,What are the first 3 movies that are not part of any collection?,"MATCH (m:Movie)
WHERE NOT (m)-[:IN_COLLECTION]->(:Collection)
RETURN m.title AS MovieTitle
LIMIT 3","match
$m isa movie;
not { in_collection (media: $m, collection: $c); };
limit 3;
fetch {
  ""MovieTitle"": $m.title
};"
88,Name the top 5 movies that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title AS MovieTitle, c.name AS CollectionName
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$c isa collection;
in_collection (media: $m, collection: $c);
$m has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""CollectionName"": $c.collection_name
};"
89,Which 3 production companies have the smallest number of movies?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, COUNT(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN pc.name AS ProductionCompany, movieCount","match
$pc isa production_company;
$m isa movie;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count asc;
limit 3;
fetch { ""ProductionCompany"": $pc.production_company_name, ""movieCount"": $count };"
90,List the top 5 languages based on the number of movies originally in that language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN language, movie_count","match
$m isa movie;
original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""movie_count"": $count
};"
91,What are the first 3 genres with the least number of associated movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name AS genre, movieCount","match
$g isa genre;
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $movieCount = count($m) groupby $g;
sort $movieCount asc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""movieCount"": $movieCount
};"
92,Name the top 5 movies with the most budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget > 0 AND m.revenue > 0
WITH m, (m.revenue / m.budget) AS budget_to_revenue_ratio
RETURN m.title AS movie_title, budget_to_revenue_ratio
ORDER BY budget_to_revenue_ratio DESC
LIMIT 5","match
$m isa movie,
    has budget $b,
    has revenue $r,
    has title $t;
$b > 0;
$r > 0.0;
let $ratio = $r / $b;
sort $ratio desc;
limit 5;
fetch {
    ""movie_title"": $t,
    ""budget_to_revenue_ratio"": $ratio
};"
93,Which 3 movies have the least number of votes?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count ASC
LIMIT 3","match
$m isa movie, has vote_count $vc, has title $t;
sort $vc asc;
limit 3;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
94,List the 5 oldest adult videos based on release date.,"MATCH (a:Adult)
RETURN a.title, a.release_date
ORDER BY a.release_date ASC
LIMIT 5","match
$a isa adult_video, has title $t, has release_date $rd;
sort $rd asc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
95,List the top 5 movies based on popularity.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has title $t, has popularity $p;
sort $p desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
96,Which 3 adult videos have the most keywords associated with them?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN a.title AS AdultVideoTitle, keyword_count","match
$a isa adult_video;
has_keyword (media: $a, keyword: $k);
reduce $count = count($k) groupby $a;
sort $count desc;
limit 3;
fetch { ""AdultVideoTitle"": $a.title, ""keyword_count"": $count };"
97,What are the first 3 adult videos not produced in any country listed?,"MATCH (a:Adult)
WHERE NOT (a)-[:PRODUCED_IN_COUNTRY]->(:Country)
RETURN a.title AS title, a.release_date AS release_date
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video;
not { produced_in_country (media: $a, country: $c); };
$a has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""release_date"": $rd
};"
98,Name the top 5 videos with the most associated genres.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH v, COUNT(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN v.title AS videoTitle, genreCount","match
$v isa video, has title $t;
in_genre (media: $v, genre: $g);
reduce $count = count($g) groupby $v, $t;
sort $count desc;
limit 5;
fetch { ""videoTitle"": $t, ""genreCount"": $count };"
99,Which 3 videos have the highest number of associated production companies?,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH v, COUNT(pc) AS productionCompanyCount
ORDER BY productionCompanyCount DESC
LIMIT 3
RETURN v.title AS videoTitle, productionCompanyCount","match
$v isa video;
produced_by (media: $v, producer: $pc);
reduce $count = count($pc) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""videoTitle"": $v.title,
  ""productionCompanyCount"": $count
};"
100,List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, COUNT(c) AS country_count
RETURN v.title AS video_title, country_count
ORDER BY country_count DESC
LIMIT 5","match
$v isa video;
produced_in_country (media: $v, country: $c);
reduce $country_count = count($c) groupby $v;
sort $country_count desc;
limit 5;
fetch {
  ""video_title"": $v.title,
  ""country_count"": $country_count
};"
101,What are the first 3 videos with the most associated keywords?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN v.title AS video_title, keyword_count","match
$v isa video, has title $t;
has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v, $t;
sort $count desc;
limit 3;
fetch { ""video_title"": $t, ""keyword_count"": $count };"
102,Name the top 5 movies with the most associated collections.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, COUNT(c) AS collectionCount
ORDER BY collectionCount DESC
LIMIT 5
RETURN m.title AS MovieTitle, collectionCount","match
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $count = count($c) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""collectionCount"": $count
};"
103,Which 3 movies have the most associated genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, COUNT(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS MovieTitle, genreCount","match
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $genre_count = count($g) groupby $m;
sort $genre_count desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""genreCount"": $genre_count
};"
104,List the top 5 movies that are rated by the most users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS user_count
ORDER BY user_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, user_count AS NumberOfRatings","match
$m isa movie;
rated (reviewer: $u, rated_media: $m);
reduce $count = count($u) groupby $m;
sort $count desc;
limit 5;
fetch { ""MovieTitle"": $m.title, ""NumberOfRatings"": $count };"
105,What are the first 3 movies with the highest number of associated production companies?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, COUNT(pc) AS productionCompanyCount
ORDER BY productionCompanyCount DESC
LIMIT 3
RETURN m.title AS movieTitle, productionCompanyCount","match
$m isa movie, has title $t;
$pc isa production_company;
produced_by (media: $m, producer: $pc);
reduce $count = count($pc) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movieTitle"": $m.title,
  ""productionCompanyCount"": $count
};"
106,Name the top 5 countries based on the number of languages spoken in their produced movies.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country),
      (m)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH c.name AS country, COUNT(DISTINCT l.id) AS language_count
ORDER BY language_count DESC
LIMIT 5
RETURN country, language_count","match
$m isa movie;
$c isa country, has country_name $cn;
$l isa language;
produced_in_country (media: $m, country: $c);
spoken_in_language (media: $m, language: $l);
select $c, $cn, $l;
distinct;
reduce $lang_count = count($l) groupby $c, $cn;
sort $lang_count desc;
limit 5;
fetch { ""country"": $cn, ""language_count"": $lang_count };"
107,Which 3 movies have the highest number of associated languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) as language_count
ORDER BY language_count DESC
LIMIT 3
RETURN m.title as MovieTitle, language_count as NumberOfLanguages","match
$m isa movie;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""NumberOfLanguages"": $count
};"
108,List the top 5 movies with the most crew members in the 'Production' department.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WHERE p.department = 'Production'
WITH m, COUNT(p) AS crew_count
ORDER BY crew_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, crew_count AS CrewCount","match
$m isa movie, has title $t;
$p isa person;
$rel isa crew_for (crew_member: $p, film: $m), has department ""Production"";
reduce $count = count($p) groupby $m;
sort $count desc;
limit 5;
fetch { ""MovieTitle"": $m.title, ""CrewCount"": $count };"
109,What are the first 3 movies with the most associated cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, count(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, cast_count AS NumberOfCastMembers","match
$m isa movie;
cast_for (actor: $p, film: $m);
reduce $cast_count = count($p) groupby $m;
sort $cast_count desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""NumberOfCastMembers"": $cast_count
};"
110,Name the top 5 packages that provide access to the 'Animation' genre.,"MATCH (g:Genre {name: 'Animation'})<-[:PROVIDES_ACCESS_TO]-(p:Package)
RETURN p.name AS package_name, p.price AS package_price
ORDER BY p.price DESC
LIMIT 5","match
$g isa genre, has genre_name ""Animation"";
provides_access_to (package: $p, genre: $g);
$p has package_price $price;
sort $price desc;
limit 5;
fetch {
  ""package_name"": $p.package_name,
  ""package_price"": $price
};"
111,Which 3 genres are provided access to by the 'Gold' package?,"MATCH (p:Package {name: 'Gold'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
$p isa package, has package_name ""Gold"";
provides_access_to (package: $p, genre: $g);
$g has genre_name $gn;
limit 3;
fetch { ""genre_name"": $gn };"
112,List the top 5 packages by the number of subscriptions associated with them.,"MATCH (p:Package)<-[:FOR_PACKAGE]-(s:Subscription)
WITH p, count(s) AS subscription_count
RETURN p.name AS package_name, subscription_count
ORDER BY subscription_count DESC
LIMIT 5","match
$p isa package;
$s isa subscription;
for_package (subscription: $s, package: $p);
reduce $count = count($s) groupby $p;
sort $count desc;
limit 5;
fetch {
  ""package_name"": $p.package_name,
  ""subscription_count"": $count
};"
113,What are the first 3 packages with the highest price?,"MATCH (p:Package)
RETURN p.name, p.price
ORDER BY p.price DESC
LIMIT 3","match
$p isa package, has package_price $price;
sort $price desc;
limit 3;
fetch {
  ""name"": $p.package_name,
  ""price"": $price
};"
114,Name the top 5 subscriptions by the duration of the package they are for.,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package)
RETURN s.id AS subscription_id, p.name AS package_name, p.duration AS package_duration
ORDER BY p.duration DESC
LIMIT 5","match
$s isa subscription, has subscription_id $sid;
for_package (subscription: $s, package: $p);
$p has package_name $pn, has package_duration $pd;
sort $pd desc;
limit 5;
fetch {
  ""subscription_id"": $sid,
  ""package_name"": $pn,
  ""package_duration"": $pd
};"
115,Which 3 packages provide access to the most genres?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
WITH p, COUNT(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN p.name AS packageName, genreCount","match
$p isa package;
$g isa genre;
provides_access_to (package: $p, genre: $g);
reduce $count = count($g) groupby $p;
sort $count desc;
limit 3;
fetch { ""packageName"": $p.package_name, ""genreCount"": $count };"
116,List the top 5 adult videos based on popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
$a isa adult_video, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $a.title,
  ""popularity"": $pop
};"
117,What are the first 3 adult videos with exactly one keyword?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, COUNT(k) AS keywordCount
WHERE keywordCount = 1
RETURN a.title AS AdultVideoTitle, a.id AS AdultVideoID
ORDER BY a.title
LIMIT 3","match
$a isa adult_video;
has_keyword (media: $a, keyword: $k);
reduce $count = count($k) groupby $a;
match
$count == 1;
$a has title $t;
sort $t;
limit 3;
fetch {
  ""AdultVideoTitle"": $a.title,
  ""AdultVideoID"": $a.movie_id
};"
118,Name the top 5 adult videos with the least revenue.,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title AS title, a.revenue AS revenue
ORDER BY a.revenue ASC
LIMIT 5","match
$a isa adult_video, has title $title, has revenue $rev;
sort $rev asc;
limit 5;
fetch {
  ""title"": $title,
  ""revenue"": $rev
};"
119,Which 3 adult videos have the most provocative poster paths?,"MATCH (a:Adult)
RETURN a.title, a.poster_path
ORDER BY a.popularity DESC
LIMIT 3","match
$a isa adult_video, has popularity $pop;
sort $pop desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""poster_path"": $a.poster_path
};"
120,List 5 adult videos with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a.title, a.tagline
LIMIT 5","match
$a isa adult_video, has tagline $t;
$t like "".*sex.*"";
limit 5;
fetch {
  ""title"": $a.title,
  ""tagline"": $t
};"
121,Name the top 5 adult videos that were produced in Italy.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""Italy""})
RETURN a.title AS title, a.average_vote AS average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $title, has average_vote $av;
$c isa country, has country_name ""Italy"";
produced_in_country (media: $a, country: $c);
sort $av desc;
limit 5;
fetch {
  ""title"": $title,
  ""average_vote"": $av
};"
122,What are the first 3 videos with the highest popularity?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
$v isa video, has popularity $pop;
sort $pop desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""popularity"": $pop
};"
123,What are the first 3 movies with the shortest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime ASC
LIMIT 3","match
$m isa movie, has runtime $r;
sort $r asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""runtime"": $r
};"
124,Which 3 collections contain the most movies?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WITH c, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN c.name AS collectionName, movieCount","match
$c isa collection;
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $movieCount = count($m) groupby $c;
sort $movieCount desc;
limit 3;
fetch {
  ""collectionName"": $c.collection_name,
  ""movieCount"": $movieCount
};"
125,Show the top 5 oldest movies in the collection with the highest revenue.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, c
ORDER BY m.release_date ASC
LIMIT 5
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.revenue AS Revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd, has revenue $rev;
in_collection (media: $m, collection: $c);
sort $rd asc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""ReleaseDate"": $rd,
  ""Revenue"": $rev
};"
126,Which 3 movies have the most extensive cast list?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, count(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, cast_count AS CastCount","match
$m isa movie;
cast_for (actor: $p, film: $m);
reduce $cast_count = count($p) groupby $m;
sort $cast_count desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""CastCount"": $cast_count
};"
127,What are the first 5 movies that have a character played by a person with gender 1?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE p.gender = 1
RETURN m.title AS MovieTitle, p.name AS ActorName, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 5","match
$p isa person, has gender 1, has person_name $name;
$m isa movie, has title $t, has release_date $rd;
cast_for (actor: $p, film: $m);
sort $rd asc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""ActorName"": $name,
  ""ReleaseDate"": $rd
};"
128,List the top 3 highest grossing movies in the genre 'Action'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
RETURN m.title AS title, m.revenue AS revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $title, has revenue $rev;
$g isa genre, has genre_name ""Action"";
in_genre (media: $m, genre: $g);
sort $rev desc;
limit 3;
fetch {
  ""title"": $title,
  ""revenue"": $rev
};"
129,Show the first 5 movies where the original language is not English but have English as a spoken language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language {id: 'en'})
WHERE NOT (m)-[:ORIGINAL_LANGUAGE]->(:Language {id: 'en'})
WITH m
MATCH (m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language {id: 'en'})
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd;
$en isa language, has language_id ""en"";
not { original_language (media: $m, language: $en); };
spoken_in_language (media: $m, language: $en);
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""ReleaseDate"": $rd
};"
130,Which 3 movies have the highest discrepancy between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, (m.revenue - m.budget) AS discrepancy
ORDER BY discrepancy DESC
LIMIT 3","match
$m isa movie, has budget $b, has revenue $r;
let $discrepancy = $r - $b;
sort $discrepancy desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b,
  ""revenue"": $r,
  ""discrepancy"": $discrepancy
};"
131,What are the top 5 movies that have undergone a title change after release?,"MATCH (m:Movie)
WHERE m.title <> m.original_title
RETURN m.title AS current_title, m.original_title AS original_title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
$m isa movie,
  has title $t,
  has original_title $ot,
  has release_date $rd;
$t != $ot;
sort $rd desc;
limit 5;
fetch {
  ""current_title"": $t,
  ""original_title"": $ot,
  ""release_date"": $rd
};"
132,List the first 3 movies with a backdrop path that includes '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {backdrop_path: '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'})
RETURN m.title, m.release_date, m.id
LIMIT 3","match
$m isa movie;
$c isa collection, has backdrop_path ""/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg"";
in_collection (media: $m, collection: $c);
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $m.release_date,
  ""id"": $m.movie_id
};"
133,Show the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has poster_path $pp, has popularity $pop;
$pp like "".*\\.jpg"";
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
134,Which 3 movies have changed their status from 'In Production' to 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released'
WITH m
MATCH (m)-[:HAS_KEYWORD]->(k:Keyword {name: 'In Production'})
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has status ""Released"", has title $title, has release_date $rd;
$k isa keyword, has keyword_name ""In Production"";
has_keyword (media: $m, keyword: $k);
sort $rd desc;
limit 3;
fetch {
  ""MovieTitle"": $title,
  ""ReleaseDate"": $rd
};"
135,What are the first 5 movies that have a genre change from their original genre in a collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, c
MATCH (m)-[:IN_GENRE]->(g:Genre)
WITH m, c, g
ORDER BY m.release_date
WITH m, c, g, collect(g.name) AS genres
WHERE size(genres) > 1
RETURN m.title AS MovieTitle, c.name AS CollectionName, genres AS Genres
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd;
in_collection (media: $m, collection: $c);
$c has collection_name $cn;
in_genre (media: $m, genre: $g1);
in_genre (media: $m, genre: $g2);
$g1 has genre_id $gid1;
$g2 has genre_id $gid2;
$gid1 != $gid2;
select $m, $t, $cn, $rd;
distinct;
sort $rd asc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""CollectionName"": $cn
};"
136,List the top 3 people with the most crew roles in movies.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WITH p, count(r) AS crew_roles
ORDER BY crew_roles DESC
LIMIT 3
RETURN p.name AS person_name, crew_roles","match
$p isa person, has person_name $name;
$m isa movie;
$rel isa crew_for (crew_member: $p, film: $m);
reduce $count = count($rel) groupby $p, $name;
sort $count desc;
limit 3;
fetch { ""person_name"": $name, ""crew_roles"": $count };"
137,Show the first 5 movies that have a character named 'Charlie Wilson' in their cast.,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.character = 'Charlie Wilson'
RETURN m.title AS MovieTitle
LIMIT 5","match
$m isa movie, has title $t;
$rel isa cast_for (actor: $p, film: $m), has character ""Charlie Wilson"";
$p isa person;
limit 5;
fetch { ""MovieTitle"": $t };"
138,Which 3 countries have produced the most movies in the genre 'Drama'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) as movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS country, movie_count","match
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name ""Drama"";
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name, ""movie_count"": $count };"
139,What are the top 5 languages spoken in movies that have a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN l.name AS language, COUNT(*) AS count
ORDER BY count DESC
LIMIT 5","match
$m isa movie, has budget $b;
$b > 50000000;
spoken_in_language (media: $m, language: $l);
$l has language_name $ln;
reduce $count = count($m) groupby $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
140,List the first 3 people who have both acted in and produced a movie.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
MATCH (p)-[:CREW_FOR {job: ""Producer""}]->(m)
RETURN DISTINCT p.name
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
cast_for (actor: $p, film: $m);
$crew isa crew_for (crew_member: $p, film: $m);
$crew has job ""Producer"";
select $name;
distinct;
limit 3;
fetch {
  ""name"": $name
};"
141,Show the top 5 movies with the lowest average vote but highest revenue.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.average_vote, m.revenue
ORDER BY m.average_vote ASC, m.revenue DESC
LIMIT 5","match
$m isa movie,
    has title $title,
    has average_vote $av,
    has revenue $rev;
sort $av asc, $rev desc;
limit 5;
fetch {
    ""title"": $title,
    ""average_vote"": $av,
    ""revenue"": $rev
};"
142,Which 3 production companies have produced the most movies?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN pc.name AS productionCompany, COUNT(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$m isa movie;
$pc isa production_company;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 3;
fetch { ""productionCompany"": $pc.production_company_name, ""movieCount"": $count };"
143,List the top 3 collections with the most movies included.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, count(m) as movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN c.name as CollectionName, movieCount","match
$m isa movie;
$c isa collection;
in_collection (media: $m, collection: $c);
reduce $movieCount = count($m) groupby $c;
sort $movieCount desc;
limit 3;
fetch {
  ""CollectionName"": $c.collection_name,
  ""movieCount"": $movieCount
};"
144,Show the first 5 videos produced by the company with ID 10.,"MATCH (company:ProductionCompany {id: 10})-[:PRODUCED_BY]->(video:Video)
RETURN video.title, video.release_date
ORDER BY video.release_date
LIMIT 5","match
$company isa production_company, has production_company_id 10;
$video isa video;
produced_by (media: $video, producer: $company);
$video has release_date $rd;
sort $rd;
limit 5;
fetch {
  ""title"": $video.title,
  ""release_date"": $rd
};"
145,Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN v.title AS video_title, keyword_count","match
$v isa video, has title $t;
has_keyword (media: $v, keyword: $k);
reduce $keyword_count = count($k) groupby $v, $t;
sort $keyword_count desc;
limit 3;
fetch { ""video_title"": $t, ""keyword_count"": $keyword_count };"
146,What are the top 5 videos that have been rated by the most users?,"MATCH (v:Video)<-[:RATED]-(u:User)
WITH v, COUNT(u) AS user_count
ORDER BY user_count DESC
LIMIT 5
RETURN v.title AS video_title, user_count","match
$v isa video;
$u isa user;
rated (rated_media: $v, reviewer: $u);
reduce $user_count = count($u) groupby $v;
sort $user_count desc;
limit 5;
fetch {
  ""video_title"": $v.title,
  ""user_count"": $user_count
};"
147,List the first 3 movies that have a link to their homepage that includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage
LIMIT 3","match
$m isa movie, has homepage $h, has title $t;
$h like "".*disney.*"";
limit 3;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
148,Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has runtime $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""runtime"": $r
};"
149,What are the top 5 movies with the most significant number of languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS language_count
RETURN m.title AS movie_title, language_count
ORDER BY language_count DESC
LIMIT 5","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $language_count = count($l) groupby $m;
sort $language_count desc;
limit 5;
fetch {
  ""movie_title"": $m.title,
  ""language_count"": $language_count
};"
150,Show the first 5 movies where the production company's name includes 'Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE pc.name CONTAINS 'Studios'
RETURN m.title AS MovieTitle, pc.name AS ProductionCompanyName
LIMIT 5","match
$m isa movie;
produced_by (media: $m, producer: $pc);
$pc has production_company_name $pcn;
$pcn like "".*Studios.*"";
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""ProductionCompanyName"": $pcn
};"
151,List 5 countries where the most movies were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN country, movie_count","match
$m isa movie;
$c isa country, has country_name $cn;
produced_in_country (media: $m, country: $c);
reduce $movie_count = count($m) groupby $c;
sort $movie_count desc;
limit 5;
fetch {
  ""country"": $c.country_name,
  ""movie_count"": $movie_count
};"
152,What are the first 3 genres that have the most movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name AS genre, movieCount","match
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""movieCount"": $count };"
153,Name the top 5 production companies by the number of movies produced.,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN pc.name AS production_company, movie_count","match
$m isa movie;
produced_by (media: $m, producer: $pc);
$pc has production_company_name $name;
reduce $count = count($m) groupby $pc, $name;
sort $count desc;
limit 5;
fetch {
  ""production_company"": $name,
  ""movie_count"": $count
};"
154,Which 3 languages are spoken in the most number of movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN language, movie_count","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $movie_count = count($m) groupby $l;
sort $movie_count desc;
limit 3;
fetch { ""language"": $l.language_name, ""movie_count"": $movie_count };"
155,List the top 5 movies that made the least revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue ASC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r asc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
157,Name the top 5 movies by vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
$m isa movie, has title $t, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
158,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, keyword_count","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""MovieTitle"": $t, ""keyword_count"": $count };"
159,List 5 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
LIMIT 5","match
$m isa movie, has runtime $r, has title $t;
$r > 120.0;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
160,What are the first 3 highest budget movies that were released?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has status ""Released"", has budget $b;
sort $b desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
161,Name the top 5 oldest movies in the database.,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd;
sort $rd asc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
162,Which 3 movies have the highest average vote?,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
163,List the first 3 movies released after 2010.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01')
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has release_date $rd;
$rd > 2010-01-01T00:00:00;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
164,What are the top 5 movies sorted by revenue?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has revenue $rev;
sort $rev desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
165,"List the top 3 adult films with a budget under $10,000.","MATCH (a:Adult)
WHERE a.budget < 10000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
$a isa adult_video, has budget $b, has title $t;
$b < 10000;
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
166,Show the first 5 adult films based on their IMDB ID starting with 'tt007'.,"MATCH (a:Adult)
WHERE a.imdb_id STARTS WITH 'tt007'
RETURN a.title, a.imdb_id
ORDER BY a.imdb_id
LIMIT 5","match
$a isa adult_video, has imdb_id $id;
$id like ""^tt007.*"";
sort $id asc;
limit 5;
fetch {
  ""title"": $a.title,
  ""imdb_id"": $id
};"
167,Which 3 adult films have the lowest average votes but were produced in 'United States of America'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN a.title, a.average_vote
ORDER BY a.average_vote ASC
LIMIT 3","match
$a isa adult_video, has title $t, has average_vote $av;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $a, country: $c);
sort $av asc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
168,What are the top 5 adult films with the highest number of votes?,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
$a isa adult_video, has title $t, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
169,List the first 3 adult films with a tagline mentioning 'love'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'love'
RETURN a.title, a.tagline
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has tagline $tl, has release_date $rd;
$tl like "".*love.*"";
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""tagline"": $tl
};"
170,Show the top 5 adult films with a poster path containing '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'.,"MATCH (a:Adult)
WHERE a.poster_path = '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'
RETURN a.title, a.poster_path, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video,
    has poster_path ""/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg"",
    has average_vote $av;
sort $av desc;
limit 5;
fetch {
    ""title"": $a.title,
    ""poster_path"": $a.poster_path,
    ""average_vote"": $av
};"
172,What are the first 5 adult films that have a runtime over 100 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 100
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 5","match
$a isa adult_video,
    has title $title,
    has runtime $rt;
$rt > 100.0;
sort $rt desc;
limit 5;
fetch {
    ""title"": $title,
    ""runtime"": $rt
};"
173,List the top 3 videos that have a revenue of zero.,"MATCH (v:Video)
WHERE v.revenue = 0.0
RETURN v.title, v.revenue
ORDER BY v.popularity DESC
LIMIT 3","match
$v isa video, has revenue $r, has popularity $pop;
$r == 0.0;
sort $pop desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""revenue"": $r
};"
174,Which 3 movies have been rated exactly 5 times?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS rating_count
WHERE rating_count = 5
RETURN m.title AS movie_title
LIMIT 3","match
$m isa movie;
$r isa rated (rated_media: $m, reviewer: $u);
reduce $count = count($u) groupby $m;
match
$count == 5;
limit 3;
fetch {
  ""movie_title"": $m.title
};"
175,List the first 3 adult films with the largest budget.,"MATCH (a:Adult)
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
$a isa adult_video, has budget $b;
sort $b desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""budget"": $b
};"
176,List the top 5 videos with the least revenue.,"MATCH (v:Video)
WHERE v.revenue IS NOT NULL
RETURN v.title, v.revenue
ORDER BY v.revenue ASC
LIMIT 5","match
$v isa video, has title $t, has revenue $r;
sort $r asc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
177,Name the top 5 videos with the most crew members in the 'Production' department.,"MATCH (v:Video)-[:CREW_FOR]->(p:Person)
WHERE p.department = 'Production'
WITH v, COUNT(p) AS crew_count
ORDER BY crew_count DESC
LIMIT 5
RETURN v.title AS video_title, crew_count","match
$v isa video;
$p isa person;
$rel isa crew_for (film: $v, crew_member: $p);
$rel has department ""Production"";
reduce $crew_count = count($p) groupby $v;
sort $crew_count desc;
limit 5;
fetch {
  ""video_title"": $v.title,
  ""crew_count"": $crew_count
};"
178,What are the first 3 movies that have a poster path containing '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'
RETURN m.title, m.poster_path
LIMIT 3","match
$m isa movie, has poster_path $pp, has title $t;
$pp like "".*/vzmL6fP7aPKNKPRTFnZmiUfciyV\\.jpg.*"";
limit 3;
fetch {
  ""title"": $t,
  ""poster_path"": $pp
};"
179,Name the top 5 videos that were released in the year 2010 or later.,"MATCH (v:Video)
WHERE v.release_date >= date('2010-01-01')
RETURN v.title, v.release_date
ORDER BY v.popularity DESC
LIMIT 5","match
$v isa video, has title $t, has release_date $rd, has popularity $pop;
$rd >= 2010-01-01T00:00:00;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
180,List the top 5 movies that have a runtime exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m.title, m.runtime
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has runtime $rt, has popularity $pop;
$rt == 90.0;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""runtime"": $rt
};"
181,Which 3 movies have an average vote greater than 8 and have been produced in 'France'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'France'})
WHERE m.average_vote > 8
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has title $t, has average_vote $av;
$c isa country, has country_name ""France"";
produced_in_country (media: $m, country: $c);
$av > 8.0;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
182,List the top 5 countries where the most adult films have been produced.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(a) AS numberOfAdultFilms
ORDER BY numberOfAdultFilms DESC
LIMIT 5","match
$a isa adult_video;
produced_in_country (media: $a, country: $c);
$c has country_name $cn;
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""numberOfAdultFilms"": $count };"
183,What are the first 3 movies that have a budget exactly 50 million USD?,"MATCH (m:Movie)
WHERE m.budget = 50000000
RETURN m.title, m.budget
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has budget $b, has release_date $rd;
$b == 50000000;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
184,Name the top 5 production companies that have produced the highest grossing movies.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH pc, SUM(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN pc.name AS production_company, total_revenue","match
$m isa movie, has revenue $r;
produced_by (media: $m, producer: $pc);
$pc isa production_company;
reduce $total_revenue = sum($r) groupby $pc;
sort $total_revenue desc;
limit 5;
fetch {
  ""production_company"": $pc.production_company_name,
  ""total_revenue"": $total_revenue
};"
185,List the top 5 videos that have a tagline including the word 'comedy'.,"MATCH (v:Video)
WHERE v.tagline CONTAINS 'comedy'
RETURN v.title, v.tagline, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
$v isa video, has tagline $tl, has popularity $pop;
$tl like "".*comedy.*"";
sort $pop desc;
limit 5;
fetch {
  ""title"": $v.title,
  ""tagline"": $tl,
  ""popularity"": $pop
};"
186,Which 3 movies have the most extensive cast list as determined by the number of cast credits?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, COUNT(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3
RETURN m.title AS movie_title, cast_count","match
$m isa movie;
$p isa person;
cast_for (actor: $p, film: $m);
reduce $cast_count = count($p) groupby $m;
sort $cast_count desc;
limit 3;
fetch { ""movie_title"": $m.title, ""cast_count"": $cast_count };"
187,"List the top 5 movies with a release date on or before December 31, 1990.","MATCH (m:Movie)
WHERE m.release_date <= date(""1990-12-31"")
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd;
$rd <= 1990-12-31T00:00:00;
sort $rd desc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
188,What are the first 3 movies that have been rated by the user with ID '1'?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$u isa user, has user_id ""1"";
$m isa movie, has release_date $rd;
rated (reviewer: $u, rated_media: $m);
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title
};"
189,Name the top 5 movies that have an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title, m.imdb_id
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has imdb_id $id, has popularity $pop;
$id like ""tt.*"";
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""imdb_id"": $id
};"
190,List the first 3 adult films that were released in the year 2000 or later.,"MATCH (a:Adult)
WHERE a.release_date >= date('2000-01-01')
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has release_date $rd, has title $t;
$rd >= 2000-01-01T00:00:00;
sort $rd;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
191,Which 3 movies have the most languages spoken in them?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, COUNT(l) AS language_count
ORDER BY language_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, language_count AS NumberOfLanguages","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch { ""MovieTitle"": $m.title, ""NumberOfLanguages"": $count };"
192,List the top 5 movies that have been produced by 'Universal Pictures'.,"MATCH (pc:ProductionCompany {name: 'Universal Pictures'})<-[:PRODUCED_BY]-(m:Movie)
RETURN m.title AS MovieTitle, m.revenue AS Revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$pc isa production_company, has production_company_name ""Universal Pictures"";
$m isa movie, has title $t, has revenue $r;
produced_by (media: $m, producer: $pc);
sort $r desc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""Revenue"": $r
};"
193,What are the first 3 movies that have a homepage URL containing 'disney'?,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has homepage $hp;
$hp like "".*disney.*"";
$m has release_date $rd;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title,
  ""homepage"": $hp
};"
194,Name the top 5 most popular movies according to the vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
$m isa movie, has title $t, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
195,List the first 3 persons who have worked as producers in more than 5 movies.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Producer""
WITH p, COUNT(m) AS movieCount
WHERE movieCount > 5
RETURN p.name AS producerName, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Producer"";
reduce $count = count($m) groupby $p, $name;
match
$count > 5;
sort $count desc;
limit 3;
fetch {
  ""producerName"": $name,
  ""movieCount"": $count
};"
196,Which 3 movies have a production company named 'Lucasfilm' associated with them?,"MATCH (p:ProductionCompany {name: 'Lucasfilm'})&lt;-[:PRODUCED_BY]-(m:Movie)
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has popularity $pop;
$p isa production_company, has production_company_name ""Lucasfilm"";
produced_by (media: $m, producer: $p);
sort $pop desc;
limit 3;
fetch {
  ""title"": $m.title
};"
197,List the top 5 movies where the revenue exceeded the budget by over 100 million USD.,"MATCH (m:Movie)
WHERE m.revenue - m.budget > 100000000
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue - m.budget DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has budget $b;
let $diff = $rev - $b;
$diff > 100000000;
sort $diff desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $rev,
  ""budget"": $b
};"
198,What are the first 3 movies with the genre 'Drama' that have a budget less than 10 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WHERE m.budget < 10000000
RETURN m.title, m.budget
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has budget $b, has release_date $rd;
$g isa genre, has genre_name ""Drama"";
in_genre (media: $m, genre: $g);
$b < 10000000;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
199,Name the top 5 movies where the main language spoken is not the original language.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(spokenLang:Language), 
      (m)-[:ORIGINAL_LANGUAGE]->(originalLang:Language)
WHERE spokenLang.id <> originalLang.id
RETURN m.title AS MovieTitle, m.popularity AS Popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
spoken_in_language (media: $m, language: $spokenLang);
original_language (media: $m, language: $originalLang);
$spokenLang has language_id $sid;
$originalLang has language_id $oid;
$sid != $oid;
$m has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""Popularity"": $pop
};"
200,List the first 3 genres where the most movies have been produced.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN g.name AS genre, movie_count","match
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $movie_count = count($m) groupby $g;
sort $movie_count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""movie_count"": $movie_count
};"
201,List the top 5 movies that were part of the 'Toy Story Collection' and have a runtime over 80 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WHERE m.runtime > 80
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
$r > 80.0;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
202,Which 3 persons have the most crew credits in movies released after 2010?,"MATCH (p:Person)-[c:CREW_FOR]->(m:Movie)
WHERE m.release_date > date('2010-01-01')
WITH p, count(c) AS crew_credits
ORDER BY crew_credits DESC
LIMIT 3
RETURN p.name AS person_name, crew_credits","match
$p isa person;
$m isa movie, has release_date $rd;
$rd > 2010-01-01T00:00:00;
$c isa crew_for (crew_member: $p, film: $m);
reduce $count = count($c) groupby $p;
sort $count desc;
limit 3;
fetch {
  ""person_name"": $p.person_name,
  ""crew_credits"": $count
};"
203,Which 3 movies have been produced by 'Pixar Animation Studios' and have a runtime under 100 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime < 100
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $m, producer: $pc);
$r < 100.0;
sort $r asc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
204,Name the top 5 movies that have the keyword 'jealousy' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
205,Who are the first 3 actors with the most roles in videos released after 2010?,"MATCH (p:Person)-[r:CAST_FOR]->(v:Video)
WHERE v.release_date > date('2010-01-01')
WITH p, count(r) AS role_count
ORDER BY role_count DESC
LIMIT 3
RETURN p.name AS actor_name, role_count","match
$p isa person;
$v isa video, has release_date $rd;
$rd > 2010-01-01T00:00:00;
$rel isa cast_for (actor: $p, film: $v);
reduce $role_count = count($rel) groupby $p;
sort $role_count desc;
limit 3;
fetch { ""actor_name"": $p.person_name, ""role_count"": $role_count };"
206,List the first 3 genres with the most movies released in the 21st century.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.release_date >= date(""2000-01-01"")
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has release_date $rd;
$rd >= 2000-01-01T00:00:00;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movie_count"": $count };"
207,What are the top 5 movies with the most keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, keyword_count AS KeywordCount","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m;
sort $keyword_count desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""KeywordCount"": $keyword_count
};"
208,Which 3 directors have the highest average vote for their movies?,"MATCH (p:Person)-[r:CREW_FOR {job: ""Director""}]->(m:Movie)
WITH p, avg(m.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 3
RETURN p.name AS director, avg_vote","match
$p isa person;
$m isa movie;
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Director"";
$m has average_vote $av;
reduce $avg_vote = mean($av) groupby $p;
sort $avg_vote desc;
limit 3;
fetch { ""director"": $p.person_name, ""avg_vote"": $avg_vote };"
209,List the first 3 movies with the most unique spoken languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(DISTINCT l) AS uniqueLanguages
ORDER BY uniqueLanguages DESC
LIMIT 3
RETURN m.title AS MovieTitle, uniqueLanguages","match
$m isa movie;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""uniqueLanguages"": $count
};"
210,What are the top 5 countries with the most movies featuring an average vote over 7.5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 7.5
RETURN c.name AS Country, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 5","match
$m isa movie, has average_vote $av;
$av > 7.5;
produced_in_country (media: $m, country: $c);
$c isa country, has country_name $cn;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""Country"": $c.country_name,
  ""MovieCount"": $count
};"
211,Who are the first 3 actors to have roles in movies with at least five different production companies?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH p, COUNT(DISTINCT pc) AS productionCompanyCount
WHERE productionCompanyCount >= 5
MATCH (p)-[:CAST_FOR]->(m2:Movie)
WITH p, m2
ORDER BY m2.release_date ASC
WITH p, COLLECT(DISTINCT m2)[..3] AS firstThreeMovies
RETURN p.name AS actor, firstThreeMovies
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
cast_for (actor: $p, film: $m);
produced_by (media: $m, producer: $pc);
select $p, $name, $pc;
distinct;
reduce $pc_count = count($pc) groupby $p, $name;
match $pc_count >= 5;
limit 3;
fetch { ""actor"": $name };"
212,Which 3 languages are most commonly found in movies with a status of 'In Production'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.status = 'In Production'
RETURN l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has status ""In Production"";
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""movie_count"": $count };"
213,List the top 5 adult films based on the number of different languages spoken.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH a, COUNT(DISTINCT l) AS language_count
RETURN a.title AS title, language_count
ORDER BY language_count DESC
LIMIT 5","match
$a isa adult_video;
$l isa language;
spoken_in_language (media: $a, language: $l);
select $a, $l;
distinct;
reduce $language_count = count($l) groupby $a;
sort $language_count desc;
limit 5;
fetch {
  ""title"": $a.title,
  ""language_count"": $language_count
};"
214,What are the top 3 countries producing the most movies with an average vote below 5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote < 5
RETURN c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has average_vote $av;
$av < 5.0;
$c isa country, has country_name $cn;
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""movie_count"": $count };"
215,Who are the first 3 directors with movies in at least three different genres?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE EXISTS {
  MATCH (p)-[:CREW_FOR]->(m)-[:IN_GENRE]->(g)
  WHERE g.name = ""Director""
}
WITH p, COUNT(DISTINCT g) AS genreCount
WHERE genreCount >= 3
WITH p
MATCH (p)-[:CREW_FOR]->(m)-[:IN_GENRE]->(g)
WHERE g.name = ""Director""
RETURN p.name AS Director
LIMIT 3","match
$p isa person, has person_name $name;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
in_genre (media: $m, genre: $g);
select $p, $g;
distinct;
reduce $gc = count groupby $p;
match $gc >= 3;
sort $gc desc;
limit 3;
fetch { ""Director"": $p.person_name };"
216,Which 3 production companies have produced the most movies with a popularity over 20?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.popularity > 20
RETURN pc.name AS ProductionCompany, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3","match
$pc isa production_company;
$m isa movie, has popularity $pop;
$pop > 20;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 3;
fetch {
  ""ProductionCompany"": $pc.production_company_name,
  ""MovieCount"": $count
};"
217,List the first 3 movies that have a homepage and were released after 2010.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m.title, m.release_date, m.homepage
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has homepage $hp, has release_date $rd;
$rd > 2010-01-01T00:00:00;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd,
  ""homepage"": $hp
};"
218,Name the top 5 most popular movies in the 'Science Fiction' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Science Fiction'})
RETURN m.title AS title, m.popularity AS popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has title $title, has popularity $pop;
$g isa genre, has genre_name ""Science Fiction"";
in_genre (media: $m, genre: $g);
sort $pop desc;
limit 5;
fetch {
  ""title"": $title,
  ""popularity"": $pop
};"
219,List the first 3 movies that have a revenue over 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has revenue $r, has title $t;
$r > 500000000;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
220,Which 3 movies have a vote count over 2000 and a budget under 50 million USD?,"MATCH (m:Movie)
WHERE m.vote_count > 2000 AND m.budget < 50000000
RETURN m.title, m.vote_count, m.budget
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie,
    has vote_count $vc,
    has budget $b,
    has title $t;
$vc > 2000;
$b < 50000000;
sort $vc desc;
limit 3;
fetch {
    ""title"": $t,
    ""vote_count"": $vc,
    ""budget"": $b
};"
221,List the top 5 movies released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date(""1990-01-01"") AND m.release_date < date(""2000-01-01"")
RETURN m.title, m.release_date
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has popularity $pop;
$rd >= 1990-01-01T00:00:00;
$rd < 2000-01-01T00:00:00;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
222,What are the first 3 movies that have been rated 5 or higher by more than one user?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WHERE u.rating >= 5.0
WITH m, COUNT(DISTINCT u) AS userCount
WHERE userCount > 1
RETURN m.title AS MovieTitle, userCount
ORDER BY m.release_date
LIMIT 3","match
$m isa movie;
$u isa user;
$rel isa rated (reviewer: $u, rated_media: $m), has rating $r;
$r >= 5.0;
select $u, $m;
distinct;
reduce $user_count = count groupby $m;
match
$user_count > 1;
$m has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""userCount"": $user_count
};"
223,Name the top 5 users who have given the lowest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, AVG(r.rating) AS avg_rating
ORDER BY avg_rating ASC
LIMIT 5
RETURN u.id AS user_id, avg_rating","match
$u isa user, has user_id $uid;
$r isa rated (reviewer: $u, rated_media: $m);
$m isa movie;
$r has rating $rat;
reduce $avg = mean($rat) groupby $u;
sort $avg asc;
limit 5;
fetch { ""user_id"": $u.user_id, ""avg_rating"": $avg };"
224,List the top 5 languages in which the most adult films have been originally made.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 5
RETURN language, num_adult_films","match
$a isa adult_video;
original_language (media: $a, language: $l);
$l has language_name $ln;
reduce $count = count($a) groupby $l;
sort $count desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""num_adult_films"": $count
};"
225,Which 3 videos have a homepage URL containing 'youtube'?,"MATCH (v:Video)
WHERE v.homepage CONTAINS 'youtube'
RETURN v.title, v.homepage
LIMIT 3","match
$v isa video, has homepage $h, has title $t;
$h like "".*youtube.*"";
limit 3;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
226,List the top 5 movies with the most extensive production crew.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WITH m, COUNT(p) AS crew_count
ORDER BY crew_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, crew_count AS CrewCount","match
$m isa movie;
crew_for (film: $m, crew_member: $p);
reduce $crew_count = count($p) groupby $m;
sort $crew_count desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""CrewCount"": $crew_count
};"
227,"What are the first 3 adult films with a budget over 500,000 USD?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
$a isa adult_video, has budget $b;
$b > 500000;
sort $b desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""budget"": $b
};"
228,List the top 5 highest budget movies in the 'Animation' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has title $t, has budget $b;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
sort $b desc;
limit 5;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
229,Which 3 videos have the most associated cast members?,"MATCH (v:Video)<-[:CAST_FOR]-(p:Person)
WITH v, COUNT(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3
RETURN v.title AS video_title, cast_count","match
$v isa video;
cast_for (actor: $p, film: $v);
reduce $cast_count = count($p) groupby $v;
sort $cast_count desc;
limit 3;
fetch {
  ""video_title"": $v.title,
  ""cast_count"": $cast_count
};"
230,List the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has poster_path $pp, has popularity $pop;
$pp like "".*\\.jpg"";
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
231,Name the top 5 movies that have been produced in more than 3 countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, COUNT(c) AS countryCount
WHERE countryCount > 3
RETURN m.title AS movieTitle, countryCount
ORDER BY countryCount DESC
LIMIT 5","match
$m isa movie;
produced_in_country (media: $m, country: $c);
reduce $countryCount = count($c) groupby $m;
match
$countryCount > 3;
sort $countryCount desc;
limit 5;
fetch {
  ""movieTitle"": $m.title,
  ""countryCount"": $countryCount
};"
232,Name the top 5 countries where the original language of the movie is Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {name: 'es'})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$m isa movie;
$l isa language, has language_id ""es"";
original_language (media: $m, language: $l);
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.country_name, ""movie_count"": $count };"
233,List the first 3 movies in the 'Toy Story Collection'.,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie;
in_collection (media: $m, collection: $c);
$m has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title
};"
234,Which 3 movies have Tom Hanks as a cast member and have been released after 1995?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
WHERE m.release_date > date(""1995-12-31"")
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
cast_for (actor: $p, film: $m);
$m isa movie, has release_date $rd;
$rd > 1995-12-31T23:59:59;
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $rd
};"
235,Can you list the top 5 adult films with the highest popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
$a isa adult_video, has title $t, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
236,What are the first 3 movies that have a revenue greater than 100 million USD and are in the genre 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 100000000 AND g.name = 'Action'
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has revenue $rev, has title $t;
$g isa genre, has genre_name ""Action"";
in_genre (media: $m, genre: $g);
$rev > 100000000;
sort $rev desc;
limit 3;
fetch {
  ""title"": $t,
  ""revenue"": $rev
};"
237,List the top 5 genres that have been accessed by the package named 'Platinum'.,"MATCH (p:Package {name: 'Platinum'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre, COUNT(g) AS access_count
ORDER BY access_count DESC
LIMIT 5","match
$p isa package, has package_name ""Platinum"";
provides_access_to (package: $p, genre: $g);
$g has genre_name $gn;
reduce $count = count($g) groupby $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""access_count"": $count };"
238,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 3
RETURN u.id AS userId, ratingCount","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($m) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""userId"": $u.user_id,
  ""ratingCount"": $count
};"
239,Name the top 5 persons who have played the character 'Woody' in any movie.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Woody'
RETURN p.name AS PersonName, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 5","match
$p isa person, has person_name $name;
$rel isa cast_for (actor: $p, film: $m), has character ""Woody"";
$m isa movie;
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""PersonName"": $name, ""MovieCount"": $count };"
240,What are the first 3 collections that include movies with a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.poster_path CONTAINS '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie, has poster_path $pp;
  $pp like "".*/rhIRbceoE9lR4veEXuwCC2wARtG.jpg.*"";
  in_collection (media: $m, collection: $c);
  $c has collection_name $cn;
select $cn;
distinct;
limit 3;
fetch { ""collection_name"": $cn };"
241,List the top 5 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
$v isa video, has title ""Jonah: A VeggieTales Movie"";
$k isa keyword, has keyword_name $name;
$rel isa has_keyword (media: $v, keyword: $k);
reduce $frequency = count($rel) groupby $name;
sort $frequency desc;
limit 5;
fetch {
  ""keyword"": $name,
  ""frequency"": $frequency
};"
242,Which 3 countries have produced the most number of videos?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$c isa country, has country_name $name;
$v isa video;
produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name, ""video_count"": $count };"
243,List the first 3 languages spoken in the movie titled 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3","match
$m isa movie, has title ""Jumanji"";
spoken_in_language (media: $m, language: $l);
$l has language_name $ln;
limit 3;
fetch { ""name"": $ln };"
244,What are the top 5 production companies that have produced the most number of movies?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(m:Movie)
WITH pc, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN pc.name AS production_company, movie_count","match
$pc isa production_company;
$m isa movie;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 5;
fetch { ""production_company"": $pc.production_company_name, ""movie_count"": $count };"
245,Can you list the first 3 genres associated with the movie titled 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$m isa movie, has title ""Toy Story"";
in_genre (media: $m, genre: $g);
$g has genre_name $name;
limit 3;
fetch {
  ""genre_name"": $name
};"
246,Which 3 movies have more than 5000 vote counts?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has vote_count $vc;
$vc > 5000;
sort $vc desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""vote_count"": $vc
};"
247,Name the top 5 movies that were released after 2010 and have a budget over 100 million USD.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.budget > 100000000
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.budget AS Budget
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie,
  has release_date $rd,
  has budget $b;
$rd > 2010-01-01T00:00:00;
$b > 100000000;
sort $b desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd,
  ""budget"": $b
};"
248,What are the first 3 movies directed by a person named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3","match
$p isa person, has person_name ""John Doe"";
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$m isa movie, has release_date $rd;
sort $rd;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $rd
};"
249,Identify the top 5 most popular videos as per the popularity metric.,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
$v isa video, has title $t, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
250,Which 3 movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has runtime $r, has title $t;
$r > 120.0;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
251,List the first 3 movies produced in the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
RETURN m.title AS MovieTitle
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $t
};"
252,What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
253,List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, COUNT(c) AS country_count
RETURN v.title AS video_title, country_count
ORDER BY country_count DESC
LIMIT 5","match
$v isa video;
$c isa country;
produced_in_country (media: $v, country: $c);
reduce $country_count = count($c) groupby $v;
sort $country_count desc;
limit 5;
fetch { ""video_title"": $v.title, ""country_count"": $country_count };"
254,What are the first 3 videos with the highest number of associated languages?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH v, COUNT(l) AS language_count
ORDER BY language_count DESC
LIMIT 3
RETURN v.title AS video_title, language_count","match
$v isa video;
$l isa language;
spoken_in_language (media: $v, language: $l);
reduce $language_count = count($l) groupby $v;
sort $language_count desc;
limit 3;
fetch {
  ""video_title"": $v.title,
  ""language_count"": $language_count
};"
255,What are the first 3 movies with the status 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has status ""In Production"", has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
256,What are the first 3 adult films that have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
$a isa adult_video, has runtime $r, has title $t;
$r > 90;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
257,List the top 5 movies that have been rated 10 by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 10
RETURN m.title, m.average_vote, m.vote_count, m.release_date
ORDER BY m.average_vote DESC, m.vote_count DESC
LIMIT 5","match
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has rating $rating;
$rating == 10.0;
$m has average_vote $av;
$m has vote_count $vc;
sort $av desc, $vc desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av,
  ""vote_count"": $vc,
  ""release_date"": $m.release_date
};"
258,List the first 3 movies that have the keyword 'space' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m.title
LIMIT 3","match
$m isa movie;
$k isa keyword, has keyword_name ""space"";
has_keyword (media: $m, keyword: $k);
limit 3;
fetch {
  ""title"": $m.title
};"
259,List the first 3 languages used in movies with an original title 'Toy Story'.,"MATCH (m:Movie {original_title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3","match
$m isa movie, has original_title ""Toy Story"";
spoken_in_language (media: $m, language: $l);
$l has language_name $ln;
limit 3;
fetch {
  ""language_name"": $ln
};"
260,Which 3 movies have been produced by a company named 'Warner Bros' and have a revenue over 200 million USD?,"MATCH (pc:ProductionCompany {name: 'Warner Bros'})&lt;-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue > 200000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r;
$pc isa production_company, has production_company_name ""Warner Bros"";
produced_by (media: $m, producer: $pc);
$r > 200000000.0;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
261,List the top 5 highest-rated movies by users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, AVG(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 5","match
$m isa movie;
$rel isa rated (reviewer: $u, rated_media: $m);
$rel has rating $r;
reduce $avg = mean($r) groupby $m;
sort $avg desc;
limit 5;
fetch { ""title"": $m.title, ""average_rating"": $avg };"
262,What are the first 3 genres associated with the video titled 'Electrical Girl'?,"MATCH (v:Video {title: 'Electrical Girl'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$v isa video, has title ""Electrical Girl"";
in_genre (media: $v, genre: $g);
$g has genre_name $gn;
limit 3;
fetch { ""name"": $gn };"
263,Name the top 5 most frequently used keywords in videos.,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH k, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 5
RETURN k.name AS keyword, video_count","match
$v isa video;
$k isa keyword;
has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k;
sort $count desc;
limit 5;
fetch { ""keyword"": $k.keyword_name, ""video_count"": $count };"
264,List the first 3 persons who have directed a movie with a budget over 150 million USD.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director"" AND m.budget > 150000000
RETURN p.name AS DirectorName, m.title AS MovieTitle, m.budget AS Budget
ORDER BY m.budget DESC
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie, has title $title, has budget $budget;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$budget > 150000000;
sort $budget desc;
limit 3;
fetch {
  ""DirectorName"": $name,
  ""MovieTitle"": $title,
  ""Budget"": $budget
};"
265,Which 3 movies have an average vote less than 5 and have been produced in the country with ID 'US'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {id: 'US'})
WHERE m.average_vote < 5
RETURN m.title, m.average_vote
ORDER BY m.average_vote ASC
LIMIT 3","match
$m isa movie, has average_vote $av, has title $t;
$c isa country, has country_id ""US"";
produced_in_country (media: $m, country: $c);
$av < 5.0;
sort $av asc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
266,"List the top 5 highest grossing movies that have been released on or after January 1, 2000.","MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01')
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has revenue $rev;
$rd >= 2000-01-01T00:00:00;
sort $rev desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
267,What are the first 3 videos that have a runtime shorter than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v.title, v.runtime
ORDER BY v.release_date
LIMIT 3","match
$v isa video, has runtime $r, has release_date $rd;
$r < 30.0;
sort $rd;
limit 3;
fetch {
  ""title"": $v.title,
  ""runtime"": $r
};"
268,Name the top 5 languages in which the most movies have been originally made.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN language, movie_count","match
$m isa movie;
original_language (media: $m, language: $l);
$l has language_name $ln;
reduce $movie_count = count($m) groupby $l, $ln;
sort $movie_count desc;
limit 5;
fetch {
  ""language"": $ln,
  ""movie_count"": $movie_count
};"
269,List the first 3 movies that have been produced by 'Pixar Animation Studios' and have a budget over 50 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has title $t, has budget $b;
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $m, producer: $pc);
$b > 50000000;
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
270,Which 3 adult films have the tagline 'Humiliation. Rape. Murder. You know the drill.'?,"MATCH (a:Adult {tagline: 'Humiliation. Rape. Murder. You know the drill.'})
RETURN a.title
LIMIT 3","match
$a isa adult_video, has tagline ""Humiliation. Rape. Murder. You know the drill."", has title $t;
limit 3;
fetch {
  ""title"": $t
};"
271,List the top 5 countries that have produced the most movies in the 'Comedy' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) as movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN c.name as Country, movie_count as NumberOfMovies","match
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name ""Comedy"";
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch { ""Country"": $c.country_name, ""NumberOfMovies"": $count };"
272,What are the first 3 movies that have a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title, m.tagline
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has tagline $tl, has release_date $rd;
$tl like "".*adventure.*"";
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""tagline"": $tl
};"
273,Name the top 5 most popular movies released before 2000.,"MATCH (m:Movie)
WHERE m.release_date < date(""2000-01-01"")
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has popularity $pop;
$rd < 2000-01-01T00:00:00;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
274,List the first 3 videos that have a budget less than 5000 USD.,"MATCH (v:Video)
WHERE v.budget < 5000
RETURN v.title, v.budget
ORDER BY v.budget ASC
LIMIT 3","match
$v isa video, has budget $b, has title $t;
$b < 5000;
sort $b asc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
275,Which 3 movies have the highest revenue and are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r;
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
276,List the first 5 movies with a budget over 20 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 20000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has budget $b;
$b > 20000000;
sort $b desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
277,What are the first 3 production companies that produced videos with zero revenue?,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE v.revenue = 0.0
RETURN DISTINCT pc.name
LIMIT 3","match
$v isa video, has revenue 0.0;
produced_by (media: $v, producer: $pc);
$pc has production_company_name $name;
select $name;
distinct;
limit 3;"
278,List the top 5 users who have rated videos the most.,"MATCH (u:User)-[r:RATED]->(:Video)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 5
RETURN u.id AS userId, ratingCount","match
$u isa user, has user_id $uid;
$v isa video;
$r isa rated (reviewer: $u, rated_media: $v);
reduce $count = count($r) groupby $u, $uid;
sort $count desc;
limit 5;
fetch { ""userId"": $uid, ""ratingCount"": $count };"
279,Which 3 movies have the lowest average vote and more than 100 vote counts?,"MATCH (m:Movie)
WHERE m.vote_count > 100
RETURN m.title, m.average_vote, m.vote_count
ORDER BY m.average_vote ASC
LIMIT 3","match
$m isa movie, has vote_count $vc, has average_vote $av;
$vc > 100;
sort $av asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av,
  ""vote_count"": $vc
};"
280,Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
281,What are the top 5 languages spoken in the adult films?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(a) AS count
ORDER BY count DESC
LIMIT 5","match
$a isa adult_video;
spoken_in_language (media: $a, language: $l);
$l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch {
  ""language"": $ln,
  ""count"": $count
};"
282,Which 3 genres do the most movies belong to?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;"
283,Show the top 5 most popular adult films based on their popularity score.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
$a isa adult_video, has title $t, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
284,Which 3 languages are most common in adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(a) AS count
ORDER BY count DESC
LIMIT 3","match
$a isa adult_video;
$l isa language;
original_language (media: $a, language: $l);
reduce $count = count($a) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""count"": $count };"
285,What are the first 5 countries where most adult films are produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 5
RETURN country, num_adult_films","match
$a isa adult_video;
produced_in_country (media: $a, country: $c);
$c has country_name $cn;
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 5;
fetch {
  ""country"": $cn,
  ""num_adult_films"": $count
};"
286,Which movies have Tom Hanks credited as a producer?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CREW_FOR {job: ""Producer""}]->(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""Tom Hanks"";
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Producer"";
$m isa movie;
fetch {
  ""MovieTitle"": $m.title
};"
287,Find all movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90.0
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r;
$r == 90.0;
fetch {
  ""title"": $m.title,
  ""runtime"": $r
};"
288,Display the top 5 movies that were most recently released.,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd;
sort $rd desc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
289,Which movies are associated with the keyword 'space'?,"MATCH (k:Keyword {name: 'space'})<-[:HAS_KEYWORD]-(m:Movie)
RETURN m.title AS MovieTitle","match
$k isa keyword, has keyword_name ""space"";
has_keyword (media: $m, keyword: $k);
$m isa movie;
fetch {
  ""MovieTitle"": $m.title
};"
290,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime ASC
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
sort $r asc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
291,Which movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
RETURN m.title AS movie_title, keyword_count
ORDER BY keyword_count DESC
LIMIT 10","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 10;
fetch { ""movie_title"": $m.title, ""keyword_count"": $count };"
292,"Display movies that have been rated after January 1, 2015.","MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.timestamp > datetime('2015-01-01T00:00:00Z')
RETURN m.title AS MovieTitle, r.rating AS Rating, r.timestamp AS RatingTimestamp","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has timestamp $ts;
$ts > 2015-01-01T00:00:00;
$r has rating $rating;
fetch {
  ""MovieTitle"": $m.title,
  ""Rating"": $rating,
  ""RatingTimestamp"": $ts
};"
293,Which movies have a budget less than 10 million but a revenue greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue","match
$m isa movie,
    has budget $b,
    has revenue $r;
$b < 10000000;
$r > 100000000;
fetch {
    ""title"": $m.title,
    ""budget"": $b,
    ""revenue"": $r
};"
294,List all movies that have been rated by user with ID 1.,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t;
rated (reviewer: $u, rated_media: $m);
fetch {
  ""MovieTitle"": $t
};"
295,Identify all movies that were produced in a country other than the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name <> ""United States of America""
RETURN m.title AS MovieTitle, c.name AS CountryName","match
$m isa movie, has title $t;
$c isa country, has country_name $cn;
produced_in_country (media: $m, country: $c);
not { $cn == ""United States of America""; };
fetch {
  ""MovieTitle"": $t,
  ""CountryName"": $cn
};"
296,Which movies have a status of 'Released' and a vote count of over 1000?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.vote_count > 1000
RETURN m.title, m.vote_count","match
$m isa movie, has status ""Released"", has vote_count $vc, has title $t;
$vc > 1000;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
297,List all movies where the overview mentions 'adventure'.,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m.title, m.overview","match
$m isa movie, has overview $o;
$o like "".*adventure.*"";
fetch {
  ""title"": $m.title,
  ""overview"": $o
};"
298,Display the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget > 0 AND m.revenue > 0
WITH m, (m.budget / m.revenue) AS budget_to_revenue_ratio
RETURN m.title, m.budget, m.revenue, budget_to_revenue_ratio
ORDER BY budget_to_revenue_ratio DESC
LIMIT 5","match
$m isa movie,
  has budget $b,
  has revenue $r,
  has title $t;
$b > 0;
$r > 0.0;
let $ratio = $b / $r;
sort $ratio desc;
limit 5;
fetch {
  ""title"": $t,
  ""budget"": $b,
  ""revenue"": $r,
  ""budget_to_revenue_ratio"": $ratio
};"
299,Which movies are associated with more than one production company?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, COUNT(pc) AS productionCompanyCount
WHERE productionCompanyCount > 1
RETURN m.title AS MovieTitle, productionCompanyCount","match
$m isa movie;
produced_by (media: $m, producer: $pc);
reduce $count = count($pc) groupby $m;
match $count > 1;
fetch { ""MovieTitle"": $m.title, ""productionCompanyCount"": $count };"
300,Find all movies where Tom Hanks is listed first in the cast.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR {order: 0}]->(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.overview AS Overview","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
$rel isa cast_for (actor: $p, film: $m);
$rel has cast_order 0;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $m.release_date,
  ""Overview"": $m.overview
};"
301,List the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
$m isa movie, has title ""Toy Story"";
in_genre (media: $m, genre: $g);
$g isa genre;
fetch {
  ""genre"": $g.genre_name
};"
302,Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, COUNT(l) AS languageCount
WHERE languageCount > 3
RETURN m.title AS MovieTitle, languageCount","match
$m isa movie;
spoken_in_language (media: $m, language: $l);
reduce $lang_count = count($l) groupby $m;
match $lang_count > 3;
fetch { ""MovieTitle"": $m.title, ""languageCount"": $lang_count };"
303,Find all movies where the original language is 'en' and have a tagline included.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE l.id = 'en' AND m.tagline IS NOT NULL
RETURN m.title, m.tagline","match
$m isa movie, has title $t, has tagline $tg;
$l isa language, has language_id ""en"";
original_language (media: $m, language: $l);
fetch {
  ""title"": $t,
  ""tagline"": $tg
};"
304,Which movies have a homepage listed in their properties?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
$m isa movie, has homepage $h, has title $t;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
305,List the top 3 movies with the most revenue that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has revenue $rev;
$rd < 2000-01-01T00:00:00;
sort $rev desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
306,Display all movies that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date(""1990-01-01"") AND m.release_date < date(""2000-01-01"")
RETURN m.title, m.release_date","match
$m isa movie, has release_date $rd, has title $t;
$rd >= 1990-01-01T00:00:00;
$rd < 2000-01-01T00:00:00;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
307,Which movies have been rated exactly 5.0 by any user?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0
RETURN m.title AS MovieTitle, m.id AS MovieID","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has rating $rating;
$rating == 5.0;
fetch {
  ""MovieTitle"": $m.title,
  ""MovieID"": $m.movie_id
};"
308,What are the movies directed by a person who has also acted in a movie?,"MATCH (director:Person)-[:CREW_FOR {job: ""Director""}]->(movie:Movie)
MATCH (director)-[:CAST_FOR]->(acted_movie:Movie)
RETURN DISTINCT movie.title AS DirectedMovies","match
$director isa person;
$movie isa movie;
$crew isa crew_for (crew_member: $director, film: $movie);
$crew has job ""Director"";
cast_for (actor: $director, film: $acted_movie);
$acted_movie isa movie;
$movie has title $t;
select $t;
distinct;
fetch { ""DirectedMovies"": $t };"
309,List all genres that have been accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre_name","match
$p isa package, has package_name ""Ultimate"";
provides_access_to (package: $p, genre: $g);
$g has genre_name $gn;
fetch {
  ""genre_name"": $gn
};"
310,Which movies feature 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
cast_for (actor: $p, film: $m);
fetch {
  ""MovieTitle"": $m.title
};"
311,Display the top 3 movies with the least popularity.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity ASC
LIMIT 3","match
$m isa movie, has title $t, has popularity $pop;
sort $pop asc;
limit 3;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
312,Find all movies where the original and spoken languages are different.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language), 
      (m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language)
WHERE ol.id <> sl.id
RETURN m.title AS MovieTitle, ol.name AS OriginalLanguage, sl.name AS SpokenLanguage","match
$m isa movie;
$ol isa language, has language_id $ol_id;
$sl isa language, has language_id $sl_id;
original_language (media: $m, language: $ol);
spoken_in_language (media: $m, language: $sl);
not { $ol_id == $sl_id; };
fetch {
  ""MovieTitle"": $m.title,
  ""OriginalLanguage"": $ol.language_name,
  ""SpokenLanguage"": $sl.language_name
};"
313,What are the languages available for the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
$m isa movie, has title ""Toy Story"";
spoken_in_language (media: $m, language: $l);
fetch {
  ""language"": $l.language_name
};"
314,Which production companies have produced movies with a budget over 50 million?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 50000000
RETURN DISTINCT p.name AS ProductionCompany","match
$m isa movie, has budget $b;
$b > 50000000;
$p isa production_company;
produced_by (media: $m, producer: $p);
select $p;
distinct;
fetch {
  ""ProductionCompany"": $p.production_company_name
};"
315,List all the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
$m isa movie, has title ""Toy Story"";
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
fetch {
  ""genre"": $gn
};"
316,Which movies have 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""Tom Hanks"";
cast_for (actor: $p, film: $m);
$m isa movie;
fetch {
  ""MovieTitle"": $m.title
};"
317,What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has title $t, has popularity $p;
sort $p desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
318,Can you find movies that are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.overview AS Overview","match
$m isa movie;
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $m.release_date,
  ""Overview"": $m.overview
};"
319,Which movies are associated with the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title AS MovieTitle","match
$m isa movie, has title $t;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
fetch {
  ""MovieTitle"": $t
};"
320,How many movies have a budget greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN count(m) AS numberOfMovies","match
$m isa movie, has budget $b;
$b > 100000000;
reduce $count = count($m);"
321,Which movies were released after the year 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title, m.release_date","match
$m isa movie, has release_date $rd, has title $t;
$rd > 2000-01-01T00:00:00;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
322,What are the first 3 highest voted movies?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has vote_count $vc;
sort $vc desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""vote_count"": $vc
};"
323,List all the languages spoken in the movie 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
$m isa movie, has title ""Jumanji"";
spoken_in_language (media: $m, language: $l);
fetch {
  ""language"": $l.language_name
};"
324,Which movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r, has title $t;
$r > 120.0;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
325,What are the top 5 movies by revenue?,"MATCH (m:Movie)
RETURN m.title AS title, m.revenue AS revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $title, has revenue $revenue;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title,
  ""revenue"": $revenue
};"
326,"Which adult movies have a budget greater than 500,000 dollars?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title AS Title, a.budget AS Budget","match
$a isa adult_video, has budget $b, has title $t;
$b > 500000;
fetch {
  ""Title"": $t,
  ""Budget"": $b
};"
327,List the top 3 adult movies by average vote.,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
328,Find all adult movies that have been released.,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title AS Title, a.release_date AS ReleaseDate, a.overview AS Overview","match
$a isa adult_video, has status ""Released"", has title $title, has release_date $rd, has overview $overview;
fetch {
  ""Title"": $title,
  ""ReleaseDate"": $rd,
  ""Overview"": $overview
};"
329,Display movies that have a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m.title, m.revenue","match
$m isa movie, has revenue $r, has title $t;
$r == 0.0;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
330,Which movies have the highest number of associated keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
RETURN m.title AS movie_title, keyword_count
LIMIT 10","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m;
sort $keyword_count desc;
limit 10;
fetch { ""movie_title"": $m.title, ""keyword_count"": $keyword_count };"
331,List all movies produced in countries where the primary language is not English.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country),
      (m)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE l.id <> 'en'
RETURN m.title AS MovieTitle, c.name AS CountryName","match
$m isa movie;
original_language (media: $m, language: $l);
produced_in_country (media: $m, country: $c);
$l has language_id $lid;
$lid != ""en"";
fetch {
  ""MovieTitle"": $m.title,
  ""CountryName"": $c.country_name
};"
332,Which movies are associated with a collection that has a poster path?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.poster_path IS NOT NULL
RETURN m.title AS MovieTitle, c.name AS CollectionName, c.poster_path AS CollectionPosterPath","match
$m isa movie, has title $mt;
$c isa collection, has collection_name $cn, has poster_path $cp;
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $mt,
  ""CollectionName"": $cn,
  ""CollectionPosterPath"": $cp
};"
333,Display the top 5 movies with the lowest average vote.,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote ASC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
sort $av asc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
334,Which movies have more than three genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, COUNT(g) AS genreCount
WHERE genreCount > 3
RETURN m.title AS MovieTitle, genreCount","match
$m isa movie;
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $genreCount = count($g) groupby $m;
match
$genreCount > 3;
fetch {
  ""MovieTitle"": $m.title,
  ""genreCount"": $genreCount
};"
335,List all movies that have a backdrop path available.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path IS NOT NULL
RETURN m.title AS MovieTitle, c.backdrop_path AS BackdropPath","match
$m isa movie;
$c isa collection, has backdrop_path $bp;
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $m.title,
  ""BackdropPath"": $bp
};"
336,Which movies have a cast member who has also worked in the crew of the same movie?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)<-[:CREW_FOR]-(p)
RETURN m.title AS MovieTitle, p.name AS PersonName","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
crew_for (crew_member: $p, film: $m);
fetch {
  ""MovieTitle"": $m.title,
  ""PersonName"": $p.person_name
};"
337,Which movies have a homepage listed?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
$m isa movie, has homepage $h;
fetch {
  ""title"": $m.title,
  ""homepage"": $h
};"
338,List the top 5 movies that have a poster path available.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has poster_path $pp, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
339,Which movies have a runtime longer than 120 minutes and are categorized under the 'Drama' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120 AND g.name = 'Drama'
RETURN m.title, m.runtime","match
$m isa movie, has runtime $rt, has title $t;
$rt > 120;
$g isa genre, has genre_name ""Drama"";
in_genre (media: $m, genre: $g);
fetch {
  ""title"": $t,
  ""runtime"": $rt
};"
340,Which movies are associated with the production company 'Pixar Animation Studios'?,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})&lt;-[:PRODUCED_BY]-(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie;
produced_by (media: $m, producer: $p);
fetch {
  ""MovieTitle"": $m.title
};"
341,List the first 3 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
LIMIT 3","match
$m isa movie, has poster_path $pp;
$pp like "".*\\.jpg"";
limit 3;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
342,Which movies have a homepage URL specified?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
$m isa movie, has title $t, has homepage $h;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
343,Name 3 movies with a release date after 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title
LIMIT 3","match
$m isa movie, has release_date $rd;
$rd > 2000-01-01T00:00:00;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title
};"
344,What are the top 5 movies with the most votes?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
$m isa movie, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""vote_count"": $vc
};"
345,Which movies are part of a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path CONTAINS '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title AS MovieTitle, c.name AS CollectionName","match
$m isa movie;
$c isa collection, has backdrop_path $bp;
$bp like "".*/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg.*"";
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $m.title,
  ""CollectionName"": $c.collection_name
};"
346,List the first 3 movies where Tom Hanks acted as a cast member.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle
ORDER BY m.release_date
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie, has release_date $rd;
cast_for (actor: $p, film: $m);
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $m.title
};"
347,Which movies feature the original language as 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$l isa language, has language_id ""en"";
original_language (media: $m, language: $l);
fetch {
  ""MovieTitle"": $m.title
};"
348,Name 3 movies that have been translated into Kiswahili.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title
LIMIT 3","match
$m isa movie;
$l isa language, has language_name ""Kiswahili"";
spoken_in_language (media: $m, language: $l);
limit 3;
fetch {
  ""title"": $m.title
};"
349,What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
350,Which movies have been produced in the United States of America?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
RETURN m.title AS MovieTitle","match
$m isa movie, has title $t;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
fetch {
  ""MovieTitle"": $t
};"
351,List the first 3 movies with a tagline containing the word 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline
ORDER BY m.title
LIMIT 3","match
$m isa movie, has tagline $tg, has title $t;
$tg like "".*excitement.*"";
sort $t;
limit 3;
fetch {
  ""title"": $m.title,
  ""tagline"": $tg
};"
352,What are the latest 3 movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
sort $rd desc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
353,Which movies are categorized under the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
fetch {
  ""MovieTitle"": $m.title
};"
354,Name 3 movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 3","match
$m isa movie;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
limit 3;
fetch {
  ""title"": $m.title
};"
355,Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, m.id AS MovieID","match
$u isa user, has user_id ""1"";
$m isa movie;
rated (reviewer: $u, rated_media: $m);
fetch {
  ""MovieTitle"": $m.title,
  ""MovieID"": $m.movie_id
};"
356,What are the top 5 highest revenue-generating movies?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has revenue $rev;
sort $rev desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
357,List the first 3 movies in the Toy Story Collection.,"MATCH (c:Collection {name: ""Toy Story Collection""})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie;
in_collection (media: $m, collection: $c);
$m has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title
};"
358,Which movies have a runtime longer than 100 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 100
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r, has title $t;
$r > 100.0;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
359,Name 3 movies directed by Pixar Animation Studios.,"MATCH (p:ProductionCompany {name: ""Pixar Animation Studios""})<-[:PRODUCED_BY]-(m:Movie)
RETURN m.title
LIMIT 3","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie, has title $t;
produced_by (media: $m, producer: $p);
limit 3;
fetch {
  ""title"": $t
};"
360,What are the top 5 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has title $t, has popularity $p;
sort $p desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
361,List the first 3 movies with a budget over 50 million.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has budget $b;
$b > 50000000;
sort $b desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
362,Which movies were released in 1995?,"MATCH (m:Movie)
WHERE m.release_date >= date(""1995-01-01"") AND m.release_date <= date(""1995-12-31"")
RETURN m.title, m.release_date","match
$m isa movie, has release_date $rd, has title $t;
$rd >= 1995-01-01T00:00:00;
$rd <= 1995-12-31T23:59:59;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
363,What are the 3 most recent movies with a status of 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has status ""Released"", has release_date $rd, has title $t;
sort $rd desc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
364,Display movies that have been released in the 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate","match
$m isa movie, has title $t, has release_date $rd;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
fetch {
  ""MovieTitle"": $t,
  ""ReleaseDate"": $rd
};"
365,Name 3 movies that Tom Hanks has a credit in as a crew member.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CREW_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
crew_for (crew_member: $p, film: $m);
$m isa movie, has title $t;
limit 3;
fetch { ""title"": $t };"
366,List the first 3 movies with an average vote less than 5.,"MATCH (m:Movie)
WHERE m.average_vote < 5
RETURN m.title, m.average_vote
ORDER BY m.average_vote ASC
LIMIT 3","match
$m isa movie, has average_vote $av, has title $t;
$av < 5.0;
sort $av asc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
367,Which movies are released in the 'Animation' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate","match
$m isa movie, has title $t, has release_date $rd;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
fetch {
  ""MovieTitle"": $t,
  ""ReleaseDate"": $rd
};"
368,What are the top 3 highest voted movies in terms of average vote?,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has title $t, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
369,List all movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle","match
$m isa movie, has title $t;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
fetch {
  ""MovieTitle"": $t
};"
370,Which movies are part of the Toy Story Collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: ""Toy Story Collection""})
RETURN m.title AS MovieTitle","match
$m isa movie;
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $m.title
};"
371,Display the top 5 longest movies by runtime.,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has runtime $r, has title $t;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
372,Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS userCount
WHERE userCount > 5000
RETURN m.title AS MovieTitle, userCount","match
$m isa movie, has title $t;
$u isa user;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $user_count = count($u) groupby $m, $t;
match
$user_count > 5000;
fetch {
  ""MovieTitle"": $t,
  ""userCount"": $user_count
};"
373,What are the top 3 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has popularity $p, has title $t;
sort $p desc;
limit 3;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
374,Find all movies produced by Pixar Animation Studios.,"MATCH (p:ProductionCompany {name: ""Pixar Animation Studios""})<-[:PRODUCED_BY]-(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.budget AS Budget, m.revenue AS Revenue","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie;
produced_by (media: $m, producer: $p);
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $m.release_date,
  ""Budget"": $m.budget,
  ""Revenue"": $m.revenue
};"
375,Which movies have a budget greater than 50 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget","match
$m isa movie, has budget $b, has title $t;
$b > 50000000;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
376,List the top 5 movies by revenue.,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
377,Which movies feature music by a person named 'John Williams' as a crew member?,"MATCH (p:Person {name: 'John Williams'})-[:CREW_FOR {job: 'Music'}]->(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""John Williams"";
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Music"";
$m isa movie;
fetch {
  ""MovieTitle"": $m.title
};"
378,Name 3 movies with a budget of exactly 30 million.,"MATCH (m:Movie)
WHERE m.budget = 30000000
RETURN m.title
LIMIT 3","match
$m isa movie, has budget 30000000;
limit 3;
fetch {
  ""title"": $m.title
};"
379,What are the top 5 movies with the lowest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue ASC
LIMIT 5","match
$m isa movie, has revenue $r, has title $t;
sort $r asc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
380,List the first 3 movies that have a vote count greater than 500.,"MATCH (m:Movie)
WHERE m.vote_count > 500
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has vote_count $vc, has title $t;
$vc > 500;
sort $vc desc;
limit 3;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
381,Which movies have a tagline that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline","match
$m isa movie, has tagline $t, has title $title;
$t like "".*love.*"";
fetch {
  ""title"": $title,
  ""tagline"": $t
};"
382,Name 3 movies that have been keyword-tagged with 'based on novel'.,"MATCH (k:Keyword {name: 'based on novel'})<-[:HAS_KEYWORD]-(m:Movie)
RETURN m.title
LIMIT 3","match
$m isa movie;
$k isa keyword, has keyword_name ""based on novel"";
has_keyword (media: $m, keyword: $k);
limit 3;
fetch {
  ""title"": $m.title
};"
383,What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime ASC
LIMIT 5","match
$m isa movie, has runtime $r, has title $t;
sort $r asc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
384,Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, COUNT(c) AS countryCount
WHERE countryCount > 1
RETURN m.title AS MovieTitle, countryCount","match
$m isa movie, has title $t;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $country_count = count($c) groupby $m;
match $country_count > 1;
fetch { ""MovieTitle"": $m.title, ""countryCount"": $country_count };"
385,List the first 3 movies with an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title, m.imdb_id
ORDER BY m.imdb_id
LIMIT 3","match
$m isa movie, has imdb_id $id;
$id like ""tt.*"";
sort $id;
limit 3;
fetch {
  ""title"": $m.title,
  ""imdb_id"": $id
};"
386,Which movies have been rated by at least 100 users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS userCount
WHERE userCount >= 100
RETURN m.title AS MovieTitle, userCount AS NumberOfRatings","match
$m isa movie;
$u isa user;
$rel isa rated (rated_media: $m, reviewer: $u);
reduce $count = count($u) groupby $m;
match
$count >= 100;
$m has title $t;
sort $count desc;
fetch {
  ""MovieTitle"": $t,
  ""NumberOfRatings"": $count
};"
387,Name 3 movies spoken in more than one language.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, COUNT(l) AS languageCount
WHERE languageCount > 1
RETURN m.title
LIMIT 3","match
$m isa movie, has title $t;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m, $t;
match $count > 1;
limit 3;
fetch { ""title"": $t };"
388,What are the top 5 movies by budget size?,"MATCH (m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has title $t, has budget $b;
sort $b desc;
limit 5;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
389,Which movies have a runtime less than 85 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 85
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r;
$r < 85.0;
fetch {
  ""title"": $m.title,
  ""runtime"": $r
};"
390,Which movies have a revenue greater than 300 million?,"MATCH (m:Movie)
WHERE m.revenue > 300000000
RETURN m.title, m.revenue","match
$m isa movie, has revenue $rev, has title $t;
$rev > 300000000;
fetch {
  ""title"": $t,
  ""revenue"": $rev
};"
391,List the first 5 movies sorted by popularity in descending order.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has title $t, has popularity $p;
sort $p desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
392,What are the original titles of movies that have been translated to Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Spanish'})
RETURN m.original_title","match
$m isa movie, has original_title $ot;
$l isa language, has language_name ""Spanish"";
spoken_in_language (media: $m, language: $l);
fetch {
  ""original_title"": $ot
};"
393,Who are the top 5 most frequent directors in the movies dataset?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director""
RETURN p.name AS Director, COUNT(r) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 5","match
$p isa person;
$m isa movie;
$r isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($r) groupby $p;
sort $count desc;
limit 5;
fetch { ""Director"": $p.person_name, ""MovieCount"": $count };"
394,Which 5 movies have Tom Hanks in the cast?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 5","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie, has title $t;
cast_for (actor: $p, film: $m);
limit 5;
fetch { ""title"": $t };"
395,What are the top 3 movies spoken in Kiswahili?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has title $t, has popularity $pop;
$l isa language, has language_name ""Kiswahili"";
spoken_in_language (media: $m, language: $l);
sort $pop desc;
limit 3;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
396,Which 3 highest budget movies were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has budget $b;
$rd > 2000-01-01T00:00:00;
sort $b desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
397,List the top 5 highest voted movies on IMDb.,"MATCH (m:Movie)
RETURN m.title, m.imdb_id, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has title $title, has imdb_id $imdb, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $title,
  ""imdb_id"": $imdb,
  ""average_vote"": $av
};"
398,What are the first 5 movies rated by user with ID 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, m.id AS MovieID, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 5","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t, has movie_id $mid, has release_date $rd;
rated (reviewer: $u, rated_media: $m);
sort $rd asc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""MovieID"": $mid,
  ""ReleaseDate"": $rd
};"
399,Which 3 movies have the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 3","match
$m isa movie, has title $t;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
limit 3;
fetch { ""title"": $t };"
400,Find the first 3 movies in the Toy Story Collection.,"MATCH (c:Collection {name: ""Toy Story Collection""})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie, has title $t, has release_date $rd;
in_collection (media: $m, collection: $c);
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $t,
  ""ReleaseDate"": $rd
};"
401,Which 5 movies were produced by Pixar Animation Studios?,"MATCH (p:ProductionCompany {name: ""Pixar Animation Studios""})<-[:PRODUCED_BY]-(m:Movie)
RETURN m.title
ORDER BY m.title
LIMIT 5","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie, has title $t;
produced_by (media: $m, producer: $p);
sort $t;
limit 5;
fetch {
  ""title"": $m.title
};"
402,List the top 3 movies released in the United States of America.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
sort $rd desc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
403,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has revenue $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""revenue"": $r
};"
404,Which adult films have been released with the status 'In Production'?,"MATCH (a:Adult)
WHERE a.status = 'In Production'
RETURN a.title AS Title, a.release_date AS ReleaseDate, a.status AS Status","match
$a isa adult_video, has status ""In Production"", has title $title, has release_date $rd, has status $s;
fetch {
  ""Title"": $title,
  ""ReleaseDate"": $rd,
  ""Status"": $s
};"
405,What are the top 3 most budget-efficient adult films (highest revenue to budget ratio)?,"MATCH (a:Adult)
WHERE a.budget > 0
WITH a, (a.revenue / a.budget) AS efficiency
RETURN a.title AS title, efficiency
ORDER BY efficiency DESC
LIMIT 3","match
$a isa adult_video, has title $title, has budget $budget, has revenue $revenue;
$budget > 0;
let $efficiency = $revenue / $budget;
sort $efficiency desc;
limit 3;
fetch {
  ""title"": $title,
  ""efficiency"": $efficiency
};"
406,Which adult films have a homepage listed?,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title AS Title, a.homepage AS Homepage","match
$a isa adult_video, has title $title, has homepage $homepage;
fetch {
  ""Title"": $title,
  ""Homepage"": $homepage
};"
407,List the top 5 longest running adult films.,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 5","match
$a isa adult_video, has title $t, has runtime $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
408,What are the first 3 videos that have been rated higher than 8.0?,"MATCH (v:Video)<-[:RATED]-(u:User)
WHERE v.average_vote > 8.0
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 3","match
$v isa video, has average_vote $av, has title $t;
rated (reviewer: $u, rated_media: $v);
$av > 8.0;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
409,Which adult films feature the keyword 'murder'?,"MATCH (k:Keyword {name: 'murder'})<-[:HAS_KEYWORD]-(a:Adult)
RETURN a.title AS AdultFilmTitle","match
$k isa keyword, has keyword_name ""murder"";
$a isa adult_video;
has_keyword (media: $a, keyword: $k);
fetch {
  ""AdultFilmTitle"": $a.title
};"
410,What are the first 5 adult films with the highest average vote?,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
411,List the first 3 adult films sorted by runtime in descending order.,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
$a isa adult_video, has title $t, has runtime $r;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
412,Which adult films have been produced by companies not based in the USA?,"MATCH (a:Adult)-[:PRODUCED_BY]->(pc:ProductionCompany),
      (a)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name <> 'United States of America'
RETURN a.title AS AdultFilmTitle, pc.name AS ProductionCompany, c.name AS Country","match
$a isa adult_video, has title $t;
produced_by (media: $a, producer: $pc);
$pc has production_company_name $pcn;
produced_in_country (media: $a, country: $c);
$c has country_name $cn;
$cn != ""United States of America"";
fetch {
  ""AdultFilmTitle"": $t,
  ""ProductionCompany"": $pcn,
  ""Country"": $cn
};"
413,What are the top 5 most popular genres in adult films?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, COUNT(a) AS popularity
ORDER BY popularity DESC
LIMIT 5","match
$a isa adult_video;
in_genre (media: $a, genre: $g);
$g has genre_name $gn;
reduce $count = count($a) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""popularity"": $count };"
414,List the first 3 videos with no revenue reported.,"MATCH (v:Video)
WHERE v.revenue = 0.0
RETURN v.title, v.release_date, v.revenue
ORDER BY v.release_date
LIMIT 3","match
$v isa video, has revenue $rev, has release_date $rd;
$rev == 0.0;
sort $rd;
limit 3;
fetch {
  ""title"": $v.title,
  ""release_date"": $rd,
  ""revenue"": $rev
};"
415,Which videos have a budget less than 100000?,"MATCH (v:Video)
WHERE v.budget < 100000
RETURN v.title, v.budget","match
$v isa video, has budget $b, has title $t;
$b < 100000;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
416,What are the first 3 countries with the most movies produced in the genre 'Drama'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS country, movie_count","match
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name ""Drama"";
produced_in_country (media: $m, country: $c);
$c has country_name $cn;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name, ""movie_count"": $count };"
417,List the first 3 movies directed by a person with gender 2.,"MATCH (p:Person)-[:CREW_FOR {job: ""Director""}]->(m:Movie)
WHERE p.gender = 2
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3","match
$p isa person, has gender 2;
$m isa movie, has release_date $rd;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $rd
};"
418,Which movies have a tagline containing the word 'excitement'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline","match
$m isa movie, has tagline $tl;
$tl like "".*excitement.*"";
fetch {
  ""title"": $m.title,
  ""tagline"": $tl
};"
419,What are the top 5 movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has runtime $r;
$r > 120.0;
sort $r desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""runtime"": $r
};"
420,Which 3 movies are part of genres with an ID between 15 and 50?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.id >= 15 AND g.id <= 50
RETURN m.title AS MovieTitle, g.name AS GenreName
LIMIT 3","match
$m isa movie, has title $t;
$g isa genre, has genre_id $gid, has genre_name $gn;
in_genre (media: $m, genre: $g);
$gid >= 15;
$gid <= 50;
limit 3;
fetch {
  ""MovieTitle"": $t,
  ""GenreName"": $gn
};"
421,List the top 3 genres most frequently associated with videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video;
$g isa genre, has genre_name $gn;
in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""video_count"": $count
};"
422,Which 5 subscriptions are linked to the 'Ultimate' package?,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package {name: 'Ultimate'})
RETURN s.id
LIMIT 5","match
$s isa subscription;
$p isa package, has package_name ""Ultimate"";
for_package (subscription: $s, package: $p);
limit 5;
fetch {
  ""id"": $s.subscription_id
};"
423,What are the first 3 packages that provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name
LIMIT 3","match
$p isa package;
$g isa genre, has genre_name ""Animation"";
provides_access_to (package: $p, genre: $g);
limit 3;
fetch {
  ""name"": $p.package_name
};"
424,List the top 5 adult films with a tagline containing 'murder'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'murder'
RETURN a.title, a.tagline, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has tagline $tl, has average_vote $av;
$tl like "".*murder.*"";
sort $av desc;
limit 5;
fetch {
  ""title"": $a.title,
  ""tagline"": $tl,
  ""average_vote"": $av
};"
425,Show the first 3 adult films that are spoken in Italian.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'it'})
RETURN a.title AS Title, a.release_date AS ReleaseDate, a.overview AS Overview
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has title $t, has release_date $rd, has overview $ov;
$l isa language, has language_id ""it"";
spoken_in_language (media: $a, language: $l);
sort $rd asc;
limit 3;
fetch {
  ""Title"": $t,
  ""ReleaseDate"": $rd,
  ""Overview"": $ov
};"
426,Which 5 videos have a runtime under 60 minutes?,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v.title, v.runtime
ORDER BY v.runtime ASC
LIMIT 5","match
$v isa video, has runtime $r, has title $t;
$r < 60;
sort $r asc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
427,List the first 3 videos with the highest average vote.,"MATCH (v:Video)
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 3","match
$v isa video, has average_vote $av, has title $t;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
428,Show the top 3 movies that have been reviewed most recently by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, r.timestamp AS ReviewTimestamp
ORDER BY r.timestamp DESC
LIMIT 3","match
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has timestamp $t;
sort $t desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReviewTimestamp"": $t
};"
429,Which 5 movies have the most poster path variations?,"MATCH (m:Movie)
WITH m, count(m.poster_path) AS poster_count
ORDER BY poster_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, poster_count AS PosterPathVariations","match
$m isa movie, has poster_path $pp;
reduce $count = count($pp) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""PosterPathVariations"": $count
};"
430,What are the first 5 movies that have no revenue recorded?,"MATCH (m:Movie)
WHERE m.revenue IS NULL OR m.revenue = 0
RETURN m.title, m.id
LIMIT 5","match
$m isa movie;
{ not { $m has revenue $r; }; } or { $m has revenue 0.0; };
limit 5;
fetch {
  ""title"": $m.title,
  ""id"": $m.movie_id
};"
431,List the top 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has homepage $h, has popularity $pop;
sort $pop desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""homepage"": $h
};"
432,Show the first 5 movies that were originally titled differently from their English title.,"MATCH (m:Movie)
WHERE m.original_title <> m.title
RETURN m.title AS EnglishTitle, m.original_title AS OriginalTitle
LIMIT 5","match
$m isa movie, has title $t, has original_title $ot;
$t != $ot;
limit 5;
fetch {
  ""EnglishTitle"": $t,
  ""OriginalTitle"": $ot
};"
433,Which 3 movies have the shortest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime ASC
LIMIT 3","match
$m isa movie, has runtime $r, has title $t;
sort $r asc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
434,What are the top 5 movies with a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title, m.tagline, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has tagline $tl, has average_vote $av;
$tl like "".*adventure.*"";
sort $av desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""tagline"": $tl,
  ""average_vote"": $av
};"
435,List the top 3 oldest movies in the database.,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
436,Which 5 movies were produced by companies with an ID over 1000?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE pc.id > 1000
RETURN m.title AS MovieTitle, pc.name AS ProductionCompanyName
ORDER BY m.title
LIMIT 5","match
$m isa movie, has title $t;
$pc isa production_company, has production_company_id $pcid, has production_company_name $pcn;
produced_by (media: $m, producer: $pc);
$pcid > 1000;
sort $t asc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""ProductionCompanyName"": $pcn
};"
437,Find the first 3 movies that feature both English and Spanish languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'}),
      (m)-[:SPOKEN_IN_LANGUAGE]->(l2:Language {name: 'Spanish'})
RETURN m.title AS MovieTitle
LIMIT 3","match
$m isa movie;
$l1 isa language, has language_name ""English"";
$l2 isa language, has language_name ""Spanish"";
spoken_in_language (media: $m, language: $l1);
spoken_in_language (media: $m, language: $l2);
limit 3;
fetch {
  ""MovieTitle"": $m.title
};"
438,Which 3 movies have the most diverse cast in terms of gender?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, COLLECT(DISTINCT p.gender) AS genders
RETURN m.title AS movie, SIZE(genders) AS gender_diversity
ORDER BY gender_diversity DESC
LIMIT 3","match
$m isa movie;
cast_for (actor: $p, film: $m);
$p isa person, has gender $g;
select $m, $g;
distinct;
reduce $count = count groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""gender_diversity"": $count
};"
439,List the first 5 movies that have been tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t;
$k isa keyword, has keyword_name ""based on novel"";
has_keyword (media: $m, keyword: $k);
limit 5;
fetch {
  ""title"": $t
};"
440,Show the top 3 movies that were produced in multiple countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, COUNT(c) AS countryCount
WHERE countryCount > 1
RETURN m.title AS title, countryCount
ORDER BY countryCount DESC, m.popularity DESC
LIMIT 3","match
$m isa movie, has title $t, has popularity $pop;
produced_in_country (media: $m, country: $c);
reduce $country_count = count($c) groupby $m;
match
$country_count > 1;
$m has title $t, has popularity $pop;
sort $country_count desc, $pop desc;
limit 3;
fetch {
  ""title"": $t,
  ""countryCount"": $country_count
};"
441,Which 3 movies have the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3
RETURN m.title AS MovieTitle, keywordCount","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch { ""MovieTitle"": $m.title, ""keywordCount"": $count };"
442,List the top 5 movies that have been rated over 8.0.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WHERE u.rating > 8.0
RETURN m.title, m.average_vote, m.release_date
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie;
$rel isa rated (reviewer: $u, rated_media: $m);
$rel has rating $r;
$r > 8.0;
$m has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av,
  ""release_date"": $m.release_date
};"
443,Show the first 5 movies that have a popularity score over 15.,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has popularity $p, has title $t;
$p > 15;
sort $p desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
444,What are the first 5 movies with the lowest average vote?,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote ASC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
sort $av asc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
445,List the first 3 movies sorted by release date in ascending order.,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 3","match
$m isa movie, has release_date $rd, has title $t;
sort $rd asc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
446,Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS userCount
WHERE userCount > 5000
RETURN m.title AS MovieTitle, userCount","match
$m isa movie;
$u isa user;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $userCount = count($u) groupby $m;
match $userCount > 5000;
$m has title $t;
fetch { ""MovieTitle"": $t, ""userCount"": $userCount };"
447,Which adult films have been released after 2010?,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a.title AS Title, a.release_date AS ReleaseDate","match
$a isa adult_video, has title $title, has release_date $rd;
$rd > 2010-01-01T00:00:00;
fetch {
  ""Title"": $title,
  ""ReleaseDate"": $rd
};"
448,What are the original languages of the top 5 highest rated adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN a.title AS Title, l.name AS OriginalLanguage, a.average_vote AS Rating
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $t, has average_vote $av;
original_language (media: $a, language: $l);
$l has language_name $ln;
sort $av desc;
limit 5;
fetch {
  ""Title"": $t,
  ""OriginalLanguage"": $ln,
  ""Rating"": $av
};"
449,List the top 3 most controversial adult films based on their overview.,"MATCH (a:Adult)
WITH a
ORDER BY a.vote_count DESC
LIMIT 3
RETURN a.title AS Title, a.overview AS Overview, a.vote_count AS VoteCount","match
$a isa adult_video, has vote_count $vc, has title $t, has overview $o;
sort $vc desc;
limit 3;
fetch {
  ""Title"": $t,
  ""Overview"": $o,
  ""VoteCount"": $vc
};"
450,Which adult films have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title AS Title, a.runtime AS Runtime","match
$a isa adult_video, has runtime $r, has title $t;
$r > 90.0;
fetch {
  ""Title"": $t,
  ""Runtime"": $r
};"
451,What are the top 3 countries by the number of adult films produced?,"MATCH (:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(*) as num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN c.name AS country, num_adult_films","match
$av isa adult_video;
produced_in_country (media: $av, country: $c);
$c has country_name $cn;
reduce $num_adult_films = count($av) groupby $c, $cn;
sort $num_adult_films desc;
limit 3;
fetch {
  ""country"": $cn,
  ""num_adult_films"": $num_adult_films
};"
452,List all the keywords associated with the video 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword","match
$v isa video, has title ""Jonah: A VeggieTales Movie"";
has_keyword (media: $v, keyword: $k);
$k has keyword_name $name;
fetch {
  ""keyword"": $name
};"
453,Which videos have been produced by 'Pixar Animation Studios'?,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title AS VideoTitle, v.release_date AS ReleaseDate, v.id AS VideoID","match
$v isa video;
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $v, producer: $pc);
fetch {
  ""VideoTitle"": $v.title,
  ""ReleaseDate"": $v.release_date,
  ""VideoID"": $v.movie_id
};"
454,What are the top 5 most popular videos?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
$v isa video, has title $title, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $title,
  ""popularity"": $pop
};"
455,Which videos have a runtime less than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v.title, v.runtime","match
$v isa video, has runtime $r, has title $t;
$r < 30;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
456,List the first 3 genres most commonly found in videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3
RETURN g.name AS genre, videoCount","match
$v isa video;
in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""videoCount"": $count };"
457,Which languages have more than 5 movies spoken in them?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l, count(m) AS movieCount
WHERE movieCount > 5
RETURN l.name AS language, movieCount","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
match
$count > 5;
$l has language_name $ln;
fetch {
  ""language"": $ln,
  ""movieCount"": $count
};"
458,What are the different jobs listed in the crew for the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CREW_FOR]-(p:Person)
RETURN DISTINCT p.job AS job","match
$m isa movie, has title ""Toy Story"";
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job $job;
select $job;
distinct;
fetch { ""job"": $job };"
459,List the first 5 movies that have been associated with more than one genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, COUNT(g) AS genreCount
WHERE genreCount > 1
RETURN m.title AS MovieTitle
ORDER BY m.title
LIMIT 5","match
$m isa movie, has title $t;
in_genre (media: $m, genre: $g);
reduce $count = count($g) groupby $m, $t;
match
$count > 1;
sort $t asc;
limit 5;
fetch {
  ""MovieTitle"": $t
};"
460,Which movies have exactly 3 keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keywordCount
WHERE keywordCount = 3
RETURN m.title AS MovieTitle","match
$m isa movie;
$k isa keyword;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
match $count == 3;
fetch { ""MovieTitle"": $m.title };"
461,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has runtime $r, has title $t;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
462,Which movies have the tagline 'Roll the dice and unleash the excitement!'?,"MATCH (m:Movie)
WHERE m.tagline = 'Roll the dice and unleash the excitement!'
RETURN m.title","match
$m isa movie, has tagline ""Roll the dice and unleash the excitement!"", has title $t;
fetch {
  ""title"": $t
};"
463,What are the first 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
464,List all movies that have been produced in 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
fetch {
  ""MovieTitle"": $m.title
};"
465,Which movies have been rated by user '1'?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle","match
$u isa user, has user_id ""1"";
$m isa movie;
rated (reviewer: $u, rated_media: $m);
fetch {
  ""MovieTitle"": $m.title
};"
466,What are the top 5 movies with the most user ratings?,"MATCH (m:Movie)<-[:RATED]-(u:User)
RETURN m.title AS MovieTitle, COUNT(u) AS NumberOfRatings
ORDER BY NumberOfRatings DESC
LIMIT 5","match
$m isa movie, has title $t;
$u isa user;
$rel isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($u) groupby $m, $t;
sort $count desc;
limit 5;
fetch { ""MovieTitle"": $t, ""NumberOfRatings"": $count };"
467,Which movies feature the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
$m isa movie;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
fetch {
  ""title"": $m.title
};"
468,List the first 3 production companies by the number of movies produced.,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN pc.name AS production_company, movie_count","match
$pc isa production_company;
$m isa movie;
produced_by (media: $m, producer: $pc);
reduce $movie_count = count($m) groupby $pc;
sort $movie_count desc;
limit 3;
fetch {
  ""production_company"": $pc.production_company_name,
  ""movie_count"": $movie_count
};"
469,Which countries have produced movies with a revenue exceeding 200 million?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WHERE m.revenue > 200000000
RETURN DISTINCT c.name AS country","match
$m isa movie, has revenue $r;
$r > 200000000;
$c isa country, has country_name $cn;
produced_in_country (media: $m, country: $c);
select $cn;
distinct;
fetch { ""country"": $cn };"
470,List the first 3 production companies that have produced the most adult films.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(a:Adult)
WITH pc, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN pc.name AS ProductionCompany, num_adult_films AS NumberOfAdultFilms","match
$pc isa production_company;
$a isa adult_video;
produced_by (media: $a, producer: $pc);
reduce $count = count($a) groupby $pc;
sort $count desc;
limit 3;
fetch {
  ""ProductionCompany"": $pc.production_company_name,
  ""NumberOfAdultFilms"": $count
};"
471,Which adult films are associated with the genre 'Horror'?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
RETURN a.title AS AdultFilmTitle, a.id AS AdultFilmID","match
$a isa adult_video, has title $t, has movie_id $id;
$g isa genre, has genre_name ""Horror"";
in_genre (media: $a, genre: $g);
fetch {
  ""AdultFilmTitle"": $t,
  ""AdultFilmID"": $id
};"
472,What are the first 3 most popular adult films based on popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 3","match
$a isa adult_video, has title $t, has popularity $p;
sort $p desc;
limit 3;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
473,Which packages provide access to the genre 'Animation'?,"MATCH (g:Genre {name: 'Animation'})<-[:PROVIDES_ACCESS_TO]-(p:Package)
RETURN p.name AS PackageName","match
$g isa genre, has genre_name ""Animation"";
provides_access_to (package: $p, genre: $g);
$p isa package;
fetch {
  ""PackageName"": $p.package_name
};"
474,List the first 3 movies with a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has revenue $rev, has release_date $rd;
$rev == 0.0;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
475,Which movies have a cast member with the profile path ending in 'jpg'?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE p.profile_path ENDS WITH 'jpg'
RETURN m.title AS MovieTitle, p.name AS CastMemberName, p.profile_path AS ProfilePath","match
$p isa person, has profile_path $pp, has person_name $pn;
$pp like "".*jpg"";
$m isa movie, has title $t;
cast_for (actor: $p, film: $m);
fetch {
  ""MovieTitle"": $t,
  ""CastMemberName"": $pn,
  ""ProfilePath"": $pp
};"
476,What are the first 3 movies in the 'Toy Story Collection' based on release date?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie, has release_date $rd;
in_collection (media: $m, collection: $c);
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
477,Which production companies have produced movies that are part of a collection?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN DISTINCT pc.name AS ProductionCompany","match
$pc isa production_company;
$m isa movie;
$c isa collection;
produced_by (media: $m, producer: $pc);
in_collection (media: $m, collection: $c);
select $pc;
distinct;
fetch {
  ""ProductionCompany"": $pc.production_company_name
};"
478,List the first 5 countries that have produced movies with an average vote above 7.0.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 7.0
RETURN DISTINCT c.name
LIMIT 5","match
$m isa movie, has average_vote $av;
$av > 7.0;
produced_in_country (media: $m, country: $c);
select $c;
distinct;
limit 5;
fetch { ""name"": $c.country_name };"
479,What are the first 3 movies with the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget > 0 AND m.revenue > 0
WITH m, (m.revenue / m.budget) AS budget_to_revenue_ratio
ORDER BY budget_to_revenue_ratio DESC
LIMIT 3
RETURN m.title AS MovieTitle, m.budget AS Budget, m.revenue AS Revenue, budget_to_revenue_ratio AS BudgetToRevenueRatio","match
$m isa movie,
    has title $title,
    has budget $b,
    has revenue $r;
$b > 0;
$r > 0.0;
let $ratio = $r / $b;
sort $ratio desc;
limit 3;
fetch {
    ""MovieTitle"": $title,
    ""Budget"": $b,
    ""Revenue"": $r,
    ""BudgetToRevenueRatio"": $ratio
};"
480,Which movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
RETURN m.title AS movie_title, keyword_count
ORDER BY keyword_count DESC
LIMIT 10","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 10;
fetch { ""movie_title"": $m.title, ""keyword_count"": $count };"
481,Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) as languageCount
WHERE languageCount > 3
RETURN m.title AS MovieTitle, languageCount","match
$m isa movie, has title $t;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $lang_count = count($l) groupby $m, $t;
match
$lang_count > 3;
fetch {
  ""MovieTitle"": $t,
  ""languageCount"": $lang_count
};"
482,What are the jobs of the first 3 crew members for the movie with the highest budget?,"MATCH (m:Movie)
WITH m
ORDER BY m.budget DESC
LIMIT 1
MATCH (p:Person)-[c:CREW_FOR]->(m)
RETURN p.name AS crew_member, c.job AS job
ORDER BY c.credit_id
LIMIT 3","with fun max_budget() -> integer:
  match $m isa movie, has budget $b;
  return max($b);
match
  $m isa movie, has budget $b;
  $b == max_budget();
  $rel isa crew_for (crew_member: $p, film: $m), has credit_id $cid, has job $j;
  $p has person_name $name;
sort $cid;
limit 3;
fetch { ""crew_member"": $name, ""job"": $j };"
483,List the first 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
LIMIT 5","match
$m isa movie, has poster_path $pp;
$pp like "".*\\.jpg"";
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
484,"What are the top 3 countries where the most videos with a budget over $500,000 are produced?","MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 500000
RETURN c.name AS country, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has budget $b;
$c isa country;
produced_in_country (media: $v, country: $c);
$b > 500000;
reduce $count = count($v) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name, ""video_count"": $count };"
485,Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, COUNT(c) AS countryCount
WHERE countryCount > 1
RETURN m.title AS MovieTitle, countryCount","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $countryCount = count($c) groupby $m;
match $countryCount > 1;
fetch { ""MovieTitle"": $m.title, ""countryCount"": $countryCount };"
486,Which countries have produced more than 10 movies in the database?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WITH c, count(m) as movieCount
WHERE movieCount > 10
RETURN c.name as Country, movieCount
ORDER BY movieCount DESC","match
$c isa country;
$m isa movie;
produced_in_country (media: $m, country: $c);
reduce $movieCount = count($m) groupby $c;
match $movieCount > 10;
$c has country_name $name;
sort $movieCount desc;
fetch { ""Country"": $name, ""movieCount"": $movieCount };"
487,Which movies are tagged with 'adventure' and have a popularity above 15?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE k.name = 'adventure' AND m.popularity > 15
RETURN m.title, m.popularity","match
$m isa movie, has popularity $pop, has title $t;
$k isa keyword, has keyword_name ""adventure"";
has_keyword (media: $m, keyword: $k);
$pop > 15;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
488,What are the original languages for the top 5 movies based on average vote?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH m, l
ORDER BY m.average_vote DESC
LIMIT 5
RETURN m.title AS MovieTitle, l.name AS OriginalLanguage, m.average_vote AS AverageVote","match
$m isa movie, has title $t, has average_vote $av;
original_language (media: $m, language: $l);
$l has language_name $ln;
sort $av desc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""OriginalLanguage"": $ln,
  ""AverageVote"": $av
};"
489,List all the movies that have a status of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title AS MovieTitle","match
$m isa movie, has status ""In Production"";
fetch {
  ""MovieTitle"": $m.title
};"
490,Which movies have a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title AS MovieTitle, m.revenue AS Revenue, m.budget AS Budget","match
$m isa movie, has title $title, has revenue $rev, has budget $bud;
$rev > $bud;
fetch {
  ""MovieTitle"": $title,
  ""Revenue"": $rev,
  ""Budget"": $bud
};"
491,What are the top 3 movies by vote count that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date(""1990-01-01"") AND m.release_date < date(""2000-01-01"")
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has vote_count $vc;
$rd >= 1990-01-01T00:00:00;
$rd < 2000-01-01T00:00:00;
sort $vc desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""vote_count"": $vc
};"
492,Which movies have Tom Hanks listed both in cast and crew?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
MATCH (p)-[:CREW_FOR]->(m)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
cast_for (actor: $p, film: $m);
crew_for (crew_member: $p, film: $m);
fetch {
  ""MovieTitle"": $m.title
};"
493,What are the top 3 videos rated by users?,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN v.title, v.average_vote, COUNT(r) AS rating_count
ORDER BY v.average_vote DESC, rating_count DESC
LIMIT 3","match
$v isa video, has title $title, has average_vote $avg;
$rel isa rated (reviewer: $u, rated_media: $v);
$u isa user;
reduce $rating_count = count($rel) groupby $v, $title, $avg;
sort $avg desc, $rating_count desc;
limit 3;"
494,Which genres are accessible through the 'Ultimate' package?,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre","match
$p isa package, has package_name ""Ultimate"";
provides_access_to (package: $p, genre: $g);
$g has genre_name $gn;
fetch {
  ""genre"": $gn
};"
495,What are the prices of the packages named 'Gold' and 'Platinum'?,"MATCH (p:Package)
WHERE p.name IN ['Gold', 'Platinum']
RETURN p.name, p.price","match
$p isa package, has package_name $name;
{ $name == ""Gold""; } or { $name == ""Platinum""; };
fetch {
  ""name"": $p.package_name,
  ""price"": $p.package_price
};"
496,List the first 5 subscriptions that expire in 2020.,"MATCH (s:Subscription)
WHERE s.expiresAt >= date(""2020-01-01"") AND s.expiresAt < date(""2021-01-01"")
RETURN s.id, s.expiresAt
ORDER BY s.expiresAt
LIMIT 5","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
  $exp >= 2020-01-01T00:00:00;
  $exp < 2021-01-01T00:00:00;
sort $exp;
limit 5;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
497,What are the first 5 production companies by the number of genres they produce movies in?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH pc, COUNT(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN pc.name AS ProductionCompany, genreCount","match
$pc isa production_company, has production_company_name $name;
$m isa movie;
produced_by (media: $m, producer: $pc);
in_genre (media: $m, genre: $g);
select $pc, $name, $g;
distinct;
reduce $count = count($g) groupby $pc, $name;
sort $count desc;
limit 5;
fetch { ""ProductionCompany"": $name, ""genreCount"": $count };"
498,Can you list the top 5 movies that are part of more than one collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, COUNT(c) AS collectionCount
WHERE collectionCount > 1
RETURN m.title AS MovieTitle, collectionCount
ORDER BY collectionCount DESC
LIMIT 5","match
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $count = count($c) groupby $m;
match
$count > 1;
sort $count desc;
limit 5;
fetch {
  ""MovieTitle"": $m.title,
  ""collectionCount"": $count
};"
499,Who are the first 3 directors of movies with a budget less than $5 million?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director"" AND m.budget < 5000000
RETURN p.name AS Director, m.title AS MovieTitle
ORDER BY r.credit_id
LIMIT 3","match
$p isa person;
$m isa movie, has budget $b;
$b < 5000000;
$r isa crew_for (crew_member: $p, film: $m), has job ""Director"", has credit_id $cid;
sort $cid;
limit 3;
fetch {
  ""Director"": $p.person_name,
  ""MovieTitle"": $m.title
};"
500,List the movies that have a revenue greater than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title AS MovieTitle, m.revenue AS Revenue, m.budget AS Budget","match
$m isa movie, has title $title, has revenue $rev, has budget $bud;
$rev > $bud;
fetch {
  ""MovieTitle"": $title,
  ""Revenue"": $rev,
  ""Budget"": $bud
};"
501,Which movies have been spoken in 'Kiswahili'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$l isa language, has language_name ""Kiswahili"";
spoken_in_language (media: $m, language: $l);
fetch {
  ""MovieTitle"": $m.title
};"
502,What are the movies where 'Brad Pitt' has acted?,"MATCH (p:Person {name: 'Brad Pitt'})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""Brad Pitt"";
cast_for (actor: $p, film: $m);
$m isa movie;
fetch {
  ""MovieTitle"": $m.title
};"
503,Which movies have an overview that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m.title, m.overview","match
$m isa movie, has overview $o, has title $t;
$o like "".*adventure.*"";
fetch {
  ""title"": $t,
  ""overview"": $o
};"
504,Which 3 production companies have produced the most films with a release date before 1980?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.release_date < date('1980-01-01')
RETURN p.name AS production_company, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$p isa production_company, has production_company_name $name;
$m isa movie, has release_date $rd;
$rd < 1980-01-01T00:00:00;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 3;
fetch { ""production_company"": $name, ""movie_count"": $count };"
505,What are the movies with a vote count less than 50?,"MATCH (m:Movie)
WHERE m.vote_count < 50
RETURN m.title AS title, m.vote_count AS vote_count","match
$m isa movie, has vote_count $vc;
$vc < 50;
fetch {
  ""title"": $m.title,
  ""vote_count"": $vc
};"
506,List the movies where the original language is not English.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE l.id <> 'en'
RETURN m.title AS MovieTitle, l.name AS OriginalLanguage","match
$m isa movie;
$l isa language, has language_id $lid;
original_language (media: $m, language: $l);
$lid != ""en"";
fetch {
  ""MovieTitle"": $m.title,
  ""OriginalLanguage"": $l.language_name
};"
507,Which movies have a popularity score above 15?,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m.title, m.popularity","match
$m isa movie, has popularity $pop;
$pop > 15;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
508,What are the top 5 movies with the smallest budget?,"MATCH (m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget ASC
LIMIT 5","match
$m isa movie, has title $t, has budget $b;
sort $b asc;
limit 5;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
509,List all movies that have a runtime greater than 150 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r, has title $t;
$r > 150;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
510,Which movies have been tagged with the keyword 'romance'?,"MATCH (k:Keyword {name: 'romance'})<-[:HAS_KEYWORD]-(m:Movie)
RETURN m.title AS MovieTitle","match
$k isa keyword, has keyword_name ""romance"";
has_keyword (media: $m, keyword: $k);
$m isa movie;
fetch {
  ""MovieTitle"": $m.title
};"
511,What are the movies that have been produced in 'China'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'China'})
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.budget AS Budget, m.revenue AS Revenue","match
$m isa movie,
  has title $title,
  has release_date $rd,
  has budget $b,
  has revenue $r;
$c isa country, has country_name ""China"";
produced_in_country (media: $m, country: $c);
fetch {
  ""MovieTitle"": $title,
  ""ReleaseDate"": $rd,
  ""Budget"": $b,
  ""Revenue"": $r
};"
512,List the movies with a revenue exceeding 100 million USD and a popularity below 10.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.popularity < 10
RETURN m.title AS title, m.revenue AS revenue, m.popularity AS popularity","match
$m isa movie,
    has title $title,
    has revenue $revenue,
    has popularity $popularity;
$revenue > 100000000;
$popularity < 10;
fetch {
    ""title"": $title,
    ""revenue"": $revenue,
    ""popularity"": $popularity
};"
513,Which movies have a status of 'Released' and an average vote less than 4?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote < 4
RETURN m.title, m.average_vote","match
$m isa movie, has status ""Released"", has average_vote $av;
$av < 4.0;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
514,List the movies that have been rated 10 by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 10
RETURN m.title AS MovieTitle, m.id AS MovieID","match
$u isa user;
$m isa movie;
$rel isa rated (reviewer: $u, rated_media: $m);
$rel has rating $r;
$r == 10.0;
fetch {
  ""MovieTitle"": $m.title,
  ""MovieID"": $m.movie_id
};"
515,What are the movies with a revenue exactly 76578911.0 USD?,"MATCH (m:Movie)
WHERE m.revenue = 76578911.0
RETURN m.title AS title, m.revenue AS revenue","match
$m isa movie, has revenue $rev, has title $t;
$rev == 76578911.0;
fetch {
  ""title"": $t,
  ""revenue"": $rev
};"
516,List the movies that have an average vote of 7.1.,"MATCH (m:Movie)
WHERE m.average_vote = 7.1
RETURN m.title AS MovieTitle, m.average_vote AS AverageVote","match
$m isa movie, has average_vote $av, has title $t;
$av == 7.1;
fetch {
  ""MovieTitle"": $t,
  ""AverageVote"": $av
};"
517,Which movies have a tagline that includes 'surprise'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'surprise'
RETURN m.title, m.tagline","match
$m isa movie, has tagline $tl, has title $t;
$tl like "".*surprise.*"";
fetch {
  ""title"": $t,
  ""tagline"": $tl
};"
518,What are the movies directed by a female from the 'Production' department?,"MATCH (p:Person)-[:CREW_FOR {job: ""Director"", department: ""Production""}]->(m:Movie)
WHERE p.gender = 1
RETURN m.title AS MovieTitle, p.name AS DirectorName","match
$p isa person, has gender 1, has person_name $name;
$m isa movie, has title $t;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"", has department ""Production"";
fetch {
  ""MovieTitle"": $m.title,
  ""DirectorName"": $p.person_name
};"
519,List all directors for the movie with an ID of 862.,"MATCH (m:Movie {id: 862})<-[:CREW_FOR]-(p:Person)
WHERE p.job = ""Director""
RETURN p.name AS Director","match
$m isa movie, has movie_id 862;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$p has person_name $name;
fetch {
  ""Director"": $name
};"
520,Which movies have a runtime less than 80 minutes and a budget over 20 million USD?,"MATCH (m:Movie)
WHERE m.runtime < 80 AND m.budget > 20000000
RETURN m.title, m.runtime, m.budget","match
$m isa movie,
    has runtime $rt,
    has budget $bg,
    has title $t;
$rt < 80.0;
$bg > 20000000;
fetch {
    ""title"": $t,
    ""runtime"": $rt,
    ""budget"": $bg
};"
521,What are the top 3 movies by average vote in the database?,"MATCH (m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has title $t, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
522,List the movies that have a release date in January 1995.,"MATCH (m:Movie)
WHERE m.release_date >= date('1995-01-01') AND m.release_date < date('1995-02-01')
RETURN m.title, m.release_date","match
$m isa movie, has title $t, has release_date $rd;
$rd >= 1995-01-01T00:00:00;
$rd < 1995-02-01T00:00:00;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
523,Which movies have been involved in a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path CONTAINS '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title AS MovieTitle, c.name AS CollectionName","match
$m isa movie;
$c isa collection, has backdrop_path $bp;
in_collection (media: $m, collection: $c);
$bp like "".*/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg.*"";
fetch {
  ""MovieTitle"": $m.title,
  ""CollectionName"": $c.collection_name
};"
524,Which movies have a poster path containing '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'
RETURN m.title, m.poster_path","match
$m isa movie, has poster_path $pp;
$pp like "".*/eoWvKD60lT95Ss1MYNgVExpo5iU\\.jpg.*"";
$m has title $t;
fetch {
  ""title"": $t,
  ""poster_path"": $pp
};"
525,List all movies that have an average_vote less than 3.,"MATCH (m:Movie)
WHERE m.average_vote < 3
RETURN m.title, m.average_vote","match
$m isa movie, has average_vote $av, has title $t;
$av < 3.0;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
526,Which movies have been produced by 'Warner Bros.' and have a revenue over 500 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Warner Bros.'})\nWHERE m.revenue > 500000000\nRETURN m.title AS MovieTitle, m.revenue AS Revenue","match
$m isa movie, has revenue $rev, has title $title;
$rev > 500000000;
$pc isa production_company, has production_company_name ""Warner Bros."";
produced_by (media: $m, producer: $pc);
fetch {
  ""MovieTitle"": $title,
  ""Revenue"": $rev
};"
527,Which movies have been most frequently rated by users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
RETURN m.title, COUNT(u) AS rating_count
ORDER BY rating_count DESC
LIMIT 10","match
$m isa movie;
$u isa user;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $rating_count = count($u) groupby $m;
sort $rating_count desc;
limit 10;
fetch { ""title"": $m.title, ""rating_count"": $rating_count };"
528,List the top 3 highest-grossing movies of 1995.,"MATCH (m:Movie)
WHERE m.release_date >= date(""1995-01-01"") AND m.release_date <= date(""1995-12-31"")
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has revenue $rev;
$rd >= 1995-01-01T00:00:00 ;
$rd <= 1995-12-31T23:59:59 ;
sort $rev desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
529,What are the movies with a vote count greater than 5000?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title AS title, m.vote_count AS vote_count","match
$m isa movie, has vote_count $vc, has title $t;
$vc > 5000;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
530,Which movies are associated with the keyword 'family' and have a release date in the last 5 years?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE k.name = 'family' AND m.release_date >= date().year - 5
RETURN m.title, m.release_date","match
$m isa movie, has title $t, has release_date $rd;
$k isa keyword, has keyword_name ""family"";
has_keyword (media: $m, keyword: $k);
$rd >= 2021-01-01T00:00:00;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
531,List the production companies that have produced movies with an original language of Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {name: 'es'})
MATCH (m)-[:PRODUCED_BY]->(pc:ProductionCompany)
RETURN DISTINCT pc.name AS ProductionCompany","match
$m isa movie;
$l isa language, has language_id ""es"";
original_language (media: $m, language: $l);
$pc isa production_company, has production_company_name $name;
produced_by (media: $m, producer: $pc);
select $name;
distinct;
fetch { ""ProductionCompany"": $name };"
532,Which movies have a popularity less than 5 and more than 2?,"MATCH (m:Movie)
WHERE m.popularity > 2 AND m.popularity < 5
RETURN m.title, m.popularity","match
$m isa movie, has popularity $p, has title $t;
$p > 2.0;
$p < 5.0;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
533,List the movies where the spoken language is 'Gaeilge'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$l isa language, has language_name ""Gaeilge"";
spoken_in_language (media: $m, language: $l);
fetch {
  ""MovieTitle"": $m.title
};"
534,Which movies have a backdrop path of '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {backdrop_path: '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'})
RETURN m.title AS movie_title","match
$m isa movie;
$c isa collection, has backdrop_path ""/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg"";
in_collection (media: $m, collection: $c);
fetch {
  ""movie_title"": $m.title
};"
535,What are the three oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
536,List movies that are part of a genre with ID 10770.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {id: 10770})
RETURN m.title AS MovieTitle, m.id AS MovieID","match
$m isa movie, has title $t, has movie_id $mid;
$g isa genre, has genre_id 10770;
in_genre (media: $m, genre: $g);
fetch {
  ""MovieTitle"": $t,
  ""MovieID"": $mid
};"
537,Which movies have a status of 'Released' and a budget greater than 25 million USD?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget > 25000000
RETURN m.title, m.budget","match
$m isa movie, has status ""Released"", has budget $b;
$b > 25000000;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
538,List all movies that have an average vote of exactly 7.7.,"MATCH (m:Movie)
WHERE m.average_vote = 7.7
RETURN m.title AS title, m.average_vote AS average_vote","match
$m isa movie, has average_vote 7.7;
fetch {
  ""title"": $m.title,
  ""average_vote"": $m.average_vote
};"
539,What are the movies with a poster path that ends with 'T4B.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'T4B.jpg'
RETURN m.title, m.poster_path","match
$m isa movie, has poster_path $pp, has title $t;
$pp like "".*T4B\\.jpg"";
fetch {
  ""title"": $t,
  ""poster_path"": $pp
};"
540,Which movies have been produced by companies based in 'France'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'France'})
RETURN m.title AS MovieTitle, pc.name AS ProductionCompany","match
$m isa movie, has title $t;
$pc isa production_company, has production_company_name $pcn;
produced_by (media: $m, producer: $pc);
$c isa country, has country_name ""France"";
produced_in_country (media: $m, country: $c);
fetch {
  ""MovieTitle"": $t,
  ""ProductionCompany"": $pcn
};"
541,List the movies that have been rated exactly 5.0.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0
RETURN m.title AS MovieTitle","match
$m isa movie;
$rel isa rated (reviewer: $u, rated_media: $m), has rating 5.0;
fetch {
  ""MovieTitle"": $m.title
};"
542,What are the movies directed by 'Christopher Nolan'?,"MATCH (director:Person {name: 'Christopher Nolan'})-[:CREW_FOR {job: 'Director'}]->(movie:Movie)
RETURN movie.title AS MovieTitle","match
$director isa person, has person_name ""Christopher Nolan"";
$rel isa crew_for (crew_member: $director, film: $movie);
$rel has job ""Director"";
$movie isa movie;
fetch {
  ""MovieTitle"": $movie.title
};"
543,Which movies have a runtime longer than the average runtime of all movies?,"// First, calculate the average runtime of all movies
MATCH (m:Movie)
WITH avg(m.runtime) AS average_runtime

// Then, find movies with a runtime longer than the average runtime
MATCH (m:Movie)
WHERE m.runtime > average_runtime
RETURN m.title, m.runtime","with fun avg_runtime() -> double:
  match $m isa movie, has runtime $r;
  return mean($r);
match $m isa movie, has runtime $r;
let $avg = avg_runtime();
$r > $avg;
sort $r;
fetch { ""title"": $m.title, ""runtime"": $r };"
544,List the movies that have been produced in more than three countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, COUNT(c) AS countryCount
WHERE countryCount > 3
RETURN m.title AS MovieTitle, countryCount","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $country_count = count($c) groupby $m;
match $country_count > 3;
fetch {
  ""MovieTitle"": $m.title,
  ""countryCount"": $country_count
};"
545,List all movies that have a revenue of zero but have been highly rated.,"MATCH (m:Movie)
WHERE m.revenue = 0
MATCH (u:User)-[r:RATED]->(m)
WHERE r.rating >= 8.0
RETURN m.title, m.revenue, avg(r.rating) AS average_rating
ORDER BY average_rating DESC","match
$m isa movie, has revenue $rev, has title $title;
$rev == 0.0;
$r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
$rating >= 8.0;
reduce $avg_rating = mean($rating) groupby $m;
sort $avg_rating desc;
fetch {
  ""title"": $m.title,
  ""revenue"": $m.revenue,
  ""average_rating"": $avg_rating
};"
546,Which movies have been associated with the keyword 'high school' and have an average vote above 6?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE k.name = 'high school' AND m.average_vote > 6
RETURN m.title, m.average_vote","match
$m isa movie, has title $t, has average_vote $av;
$k isa keyword, has keyword_name ""high school"";
has_keyword (media: $m, keyword: $k);
$av > 6.0;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
547,What are the top 5 longest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $title, has runtime $rt;
sort $rt desc;
limit 5;
fetch {
  ""title"": $title,
  ""runtime"": $rt
};"
548,List all movies where the spoken language includes both English and Spanish.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'}),
      (m)-[:SPOKEN_IN_LANGUAGE]->(l2:Language {name: 'Spanish'})
RETURN m.title AS MovieTitle","match
$m isa movie, has title $t;
$l1 isa language, has language_name ""English"";
$l2 isa language, has language_name ""Spanish"";
spoken_in_language (media: $m, language: $l1);
spoken_in_language (media: $m, language: $l2);
fetch {
  ""MovieTitle"": $t
};"
549,What are the three most recent movies that have a tagline?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.release_date, m.tagline
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has tagline $tl, has release_date $rd;
sort $rd desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd,
  ""tagline"": $tl
};"
550,List the movies that have a budget of zero.,"MATCH (m:Movie)
WHERE m.budget = 0
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.overview AS Overview","match
$m isa movie, has budget 0, has title $title, has release_date $rd, has overview $ov;
fetch {
  ""MovieTitle"": $title,
  ""ReleaseDate"": $rd,
  ""Overview"": $ov
};"
551,List all movies that have a budget greater than 100 million USD and were released after 2000.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.release_date > date('2000-01-01')
RETURN m.title, m.budget, m.release_date","match
$m isa movie,
  has budget $b,
  has release_date $rd,
  has title $t;
$b > 100000000;
$rd > 2000-01-01T00:00:00;
fetch {
  ""title"": $t,
  ""budget"": $b,
  ""release_date"": $rd
};"
552,What are the movies with a runtime exactly equal to the runtime of 'Toy Story'?,"MATCH (m1:Movie {title: ""Toy Story""})
MATCH (m2:Movie {runtime: m1.runtime})
RETURN m2.title AS MovieTitle, m2.runtime AS Runtime","match
$m1 isa movie, has title ""Toy Story"", has runtime $r;
$m2 isa movie, has title $t2, has runtime $r;
fetch {
  ""MovieTitle"": $t2,
  ""Runtime"": $r
};"
553,List the top 5 adult films by average vote.,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
554,Which 3 adult films have the highest budget?,"MATCH (a:Adult)
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
$a isa adult_video, has budget $b, has title $t;
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
555,What are the top 5 countries where adult films have been produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS Country, COUNT(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 5","match
$a isa adult_video;
produced_in_country (media: $a, country: $c);
$c has country_name $cn;
reduce $count = count($a) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""Country"": $c.country_name,
  ""NumberOfAdultFilms"": $count
};"
556,List the first 3 users who rated the adult film titled 'Standoff'.,"MATCH (a:Adult {title: 'Standoff'})<-[:RATED]-(u:User)
RETURN u.id
ORDER BY u.id
LIMIT 3","match
$a isa adult_video, has title ""Standoff"";
$r isa rated (reviewer: $u, rated_media: $a);
$u isa user, has user_id $uid;
sort $uid asc;
limit 3;
fetch {
  ""user_id"": $uid
};"
557,Which 3 genres are most common in adult films?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, COUNT(a) AS count
ORDER BY count DESC
LIMIT 3","match
$a isa adult_video;
in_genre (media: $a, genre: $g);
$g has genre_name $name;
reduce $count = count($a) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""count"": $count
};"
558,What are the top 5 keywords found in videos?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name, COUNT(*) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5","match
$v isa video;
has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k;
sort $count desc;
limit 5;
fetch { ""keyword_name"": $k.keyword_name, ""keyword_count"": $count };"
559,List the first 3 video titles that have been produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(pc:ProductionCompany {name: ""Pixar Animation Studios""})
RETURN v.title
ORDER BY v.title
LIMIT 3","match
$v isa video, has title $t;
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $v, producer: $pc);
sort $t asc;
limit 3;
fetch {
  ""title"": $v.title
};"
560,Which 3 videos have the highest popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
$v isa video, has popularity $pop;
sort $pop desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""popularity"": $pop
};"
561,What are the 3 longest videos in terms of runtime?,"MATCH (v:Video)
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3","match
$v isa video, has title $title, has runtime $rt;
sort $rt desc;
limit 3;
fetch {
  ""title"": $title,
  ""runtime"": $rt
};"
562,List the top 5 genres associated with the highest-grossing videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, SUM(v.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN g.name AS genre, total_revenue","match
$v isa video, has revenue $r;
$g isa genre, has genre_name $gn;
in_genre (media: $v, genre: $g);
reduce $total_revenue = sum($r) groupby $g;
sort $total_revenue desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""total_revenue"": $total_revenue
};"
563,Which 3 collections include videos with an average vote above 7?,"MATCH (v:Video)-[:IN_COLLECTION]->(c:Collection)
WHERE v.average_vote > 7
RETURN c.name AS CollectionName, COUNT(v) AS VideoCount
ORDER BY VideoCount DESC
LIMIT 3","match
$v isa video, has average_vote $av;
$av > 7.0;
$c isa collection, has collection_name $cn;
in_collection (media: $v, collection: $c);
reduce $count = count($v) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""collection_name"": $c.collection_name,
  ""video_count"": $count
};"
564,What are the top 5 languages in which the most adult films are originally made?,"MATCH (:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(*) AS film_count
ORDER BY film_count DESC
LIMIT 5","match
$a isa adult_video;
original_language (media: $a, language: $l);
$l has language_name $ln;
reduce $film_count = count($a) groupby $l;
sort $film_count desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""film_count"": $film_count
};"
565,List the first 3 packages that offer access to the 'Animation' genre.,"MATCH (g:Genre {name: 'Animation'})<-[:PROVIDES_ACCESS_TO]-(p:Package)
RETURN p.name
LIMIT 3","match
$g isa genre, has genre_name ""Animation"";
provides_access_to (package: $p, genre: $g);
$p isa package;
limit 3;
fetch {
  ""name"": $p.package_name
};"
566,Which 3 subscriptions will expire the soonest?,"MATCH (s:Subscription)
RETURN s.id, s.expiresAt
ORDER BY s.expiresAt ASC
LIMIT 3","match
$s isa subscription, has subscription_id $id, has expires_at $ea;
sort $ea asc;
limit 3;
fetch {
  ""id"": $id,
  ""expires_at"": $ea
};"
567,What are the top 5 most expensive packages by price?,"MATCH (p:Package)
RETURN p.name, p.price
ORDER BY p.price DESC
LIMIT 5","match
$p isa package, has package_price $price, has package_name $name;
sort $price desc;
limit 5;
fetch {
  ""name"": $name,
  ""price"": $price
};"
568,List the first 3 genres that are accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
$p isa package, has package_name ""Ultimate"";
provides_access_to (package: $p, genre: $g);
$g has genre_name $gn;
limit 3;
fetch {
  ""genre_name"": $gn
};"
569,"Which 3 production companies are associated with the most number of genres across movies, videos, and adult films?","MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m)
WHERE (m:Movie OR m:Video OR m:Adult)
MATCH (m)-[:IN_GENRE]->(g:Genre)
WITH pc, COUNT(DISTINCT g) AS genreCount
RETURN pc.name AS productionCompany, genreCount
ORDER BY genreCount DESC
LIMIT 3","match
$pc isa production_company;
$m isa media;
produced_by (media: $m, producer: $pc);
in_genre (media: $m, genre: $g);
select $pc, $g;
distinct;
reduce $count = count($g) groupby $pc;
sort $count desc;
limit 3;
fetch {
  ""productionCompany"": $pc.production_company_name,
  ""genreCount"": $count
};"
570,What are the top 5 countries by the number of genres produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH c, count(DISTINCT g) AS genreCount
RETURN c.name AS country, genreCount
ORDER BY genreCount DESC
LIMIT 5","match
$c isa country, has country_name $cn;
$m isa movie;
produced_in_country (media: $m, country: $c);
in_genre (media: $m, genre: $g);
select $c, $cn, $g;
distinct;
reduce $genre_count = count($g) groupby $c, $cn;
sort $genre_count desc;
limit 5;
fetch { ""country"": $cn, ""genreCount"": $genre_count };"
571,List the first 3 movies that have no revenue reported.,"MATCH (m:Movie)
WHERE m.revenue IS NULL OR m.revenue = 0
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie;
{ not { $m has revenue $r; }; } or { $m has revenue 0.0; };
$m has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
572,Which 3 videos have a poster path ending with 'jpg'?,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH 'jpg'
RETURN v.title, v.poster_path
LIMIT 3","match
$v isa video, has poster_path $pp;
$pp like "".*jpg"";
limit 3;
fetch {
  ""title"": $v.title,
  ""poster_path"": $pp
};"
574,List the first 3 adult films with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a.title, a.tagline
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has tagline $tl, has release_date $rd;
$tl like "".*sex.*"";
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""tagline"": $tl
};"
575,Which 3 genres have the least movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, COUNT(m) AS movieCount
ORDER BY movieCount ASC
LIMIT 3
RETURN g.name AS genre, movieCount","match
$g isa genre;
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $movieCount = count($m) groupby $g;
sort $movieCount asc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""movieCount"": $movieCount
};"
576,What are the first 3 collections that contain more than 5 movies?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WITH c, count(m) as movieCount
WHERE movieCount > 5
RETURN c.name AS collectionName, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$c isa collection;
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $movieCount = count($m) groupby $c;
match
$movieCount > 5;
sort $movieCount desc;
limit 3;
fetch {
  ""collectionName"": $c.collection_name,
  ""movieCount"": $movieCount
};"
577,Which movies have an IMDb ID that starts with 'tt00'?,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt00'
RETURN m.title, m.imdb_id","match
$m isa movie, has imdb_id $id, has title $t;
$id like ""tt00.*"";
fetch {
  ""title"": $t,
  ""imdb_id"": $id
};"
578,Which 3 languages are most frequently spoken in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video;
$l isa language, has language_name $ln;
spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $ln;
sort $count desc;
limit 3;"
579,Which 3 genres are most frequently found in movies with a revenue greater than $100 million?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 100000000
RETURN g.name, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has revenue $rev;
$rev > 100000000.0;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
580,List the movies that have been tagged with the keyword 'explosive'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'explosive'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$k isa keyword, has keyword_name ""explosive"";
has_keyword (media: $m, keyword: $k);
fetch {
  ""MovieTitle"": $m.title
};"
582,List the movies that have a backdrop path of '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {backdrop_path: '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$c isa collection, has backdrop_path ""/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg"";
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $m.title
};"
583,What are the three highest budget movies produced by 'Disney'?,"MATCH (p:ProductionCompany {name: 'Disney'})<-[:PRODUCED_BY]-(m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$p isa production_company, has production_company_name ""Disney"";
$m isa movie, has budget $b, has title $t;
produced_by (media: $m, producer: $p);
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
584,What are the top 5 movies by revenue?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
585,List 3 movies that have a runtime greater than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
LIMIT 3","match
$m isa movie, has runtime $r;
$r > 120.0;
limit 3;
fetch {
  ""title"": $m.title,
  ""runtime"": $r
};"
586,Which 5 movies were released after 2010 and have a vote count over 1000?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.vote_count > 1000
RETURN m.title, m.release_date, m.vote_count
ORDER BY m.release_date DESC
LIMIT 5","match
$m isa movie,
  has title $t,
  has release_date $rd,
  has vote_count $vc;
$rd > 2010-01-01T00:00:00;
$vc > 1000;
sort $rd desc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd,
  ""vote_count"": $vc
};"
587,Find 3 movies that have 'Toy Story' in their title.,"MATCH (m:Movie)
WHERE m.title CONTAINS 'Toy Story'
RETURN m.title, m.release_date, m.id
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd, has movie_id $mid;
$t like "".*Toy Story.*"";
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd,
  ""id"": $mid
};"
588,What are the top 5 highest budget movies?,"MATCH (m:Movie)
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has budget $b, has title $t;
sort $b desc;
limit 5;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
589,List the first 3 languages that have been used as original languages in more than 10 movies.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l, COUNT(m) AS movieCount
WHERE movieCount > 10
RETURN l.name AS language, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$m isa movie;
$l isa language;
original_language (media: $m, language: $l);
reduce $movieCount = count($m) groupby $l;
match $movieCount > 10;
sort $movieCount desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""movieCount"": $movieCount
};"
590,Which 3 countries have produced more than 50 movies?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WITH c, count(m) as movieCount
WHERE movieCount > 50
RETURN c.name AS country, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$c isa country;
$m isa movie;
produced_in_country (media: $m, country: $c);
reduce $movieCount = count($m) groupby $c;
match $movieCount > 50;
sort $movieCount desc;
limit 3;
fetch { ""country"": $c.country_name, ""movieCount"": $movieCount };"
591,What are the top 5 genres by the number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) as movieCount
RETURN g.name as genre, movieCount
ORDER BY movieCount DESC
LIMIT 5","match
$g isa genre;
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $movieCount = count($m) groupby $g;
sort $movieCount desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movieCount"": $movieCount };"
592,Which 3 production companies have produced the most movies with a budget over $50 million?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 50000000
RETURN pc.name AS production_company, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$pc isa production_company, has production_company_name $name;
$m isa movie, has budget $b;
$b > 50000000;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""movie_count"": $count };"
593,List the 3 most recent movies in the 'Toy Story Collection'.,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie, has release_date $rd;
in_collection (media: $m, collection: $c);
sort $rd desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
594,Who are the top 5 actors by the number of movies they have appeared in?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN p.name AS actor, movie_count","match
$p isa person, has person_name $name;
$m isa movie;
cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""actor"": $name, ""movie_count"": $count };"
595,What are the first 3 keywords associated with the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3","match
$m isa movie, has title ""Toy Story"";
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
limit 3;
fetch { ""name"": $kn };"
596,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 3
RETURN u.id AS userId, ratingCount","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch { ""userId"": $u.user_id, ""ratingCount"": $count };"
597,List the top 5 most popular movies according to their popularity score.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has popularity $pop, has title $t;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
598,What are the 3 longest movies in terms of runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
599,Which 3 movies have the highest average vote and more than 1000 votes?,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has vote_count $vc, has average_vote $av;
$vc > 1000;
sort $av desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
600,List the first 3 movies that have a poster path starting with '/r'.,"MATCH (m:Movie)
WHERE m.poster_path STARTS WITH '/r'
RETURN m.title, m.poster_path
LIMIT 3","match
$m isa movie, has poster_path $pp;
$pp like ""/r.*"";
limit 3;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
601,Which 5 movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
$m has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title
};"
602,What are the 3 latest movies rated by user with id 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
$u isa user, has user_id ""1"";
$m isa movie, has release_date $rd;
rated (reviewer: $u, rated_media: $m);
sort $rd desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
603,List the top 5 production companies by the number of videos they have produced.,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(v:Video)
WITH pc, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 5
RETURN pc.name AS production_company, video_count","match
$pc isa production_company;
$v isa video;
produced_by (media: $v, producer: $pc);
reduce $video_count = count($v) groupby $pc;
sort $video_count desc;
limit 5;
fetch {
  ""production_company"": $pc.production_company_name,
  ""video_count"": $video_count
};"
604,Find all actors who have appeared in more than 10 movies.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, COUNT(m) AS movieCount
WHERE movieCount > 10
RETURN p.name AS actorName, movieCount","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
reduce $movieCount = count($m) groupby $p;
match $movieCount > 10;
fetch {
  ""actorName"": $p.person_name,
  ""movieCount"": $movieCount
};"
605,Which movies have a runtime that is exactly 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime = 90.0
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r, has title $t;
$r == 90.0;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
606,Which movies have been released with a status of 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title","match
$m isa movie, has status ""In Production"";
fetch {
  ""title"": $m.title
};"
607,Which 3 keywords are most commonly associated with movies that have a budget less than 1 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget < 1000000
RETURN k.name AS keyword, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has budget $b;
$b < 1000000;
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
reduce $count = count($m) groupby $kn;
sort $count desc;
limit 3;
fetch { ""keyword"": $kn, ""count"": $count };"
608,List the top 5 movies that have been rated by users more than 1000 times.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, count(u) AS user_ratings
WHERE user_ratings > 1000
RETURN m.title AS title, user_ratings
ORDER BY user_ratings DESC
LIMIT 5","match
$m isa movie, has title $title;
$u isa user;
$rel isa rated (reviewer: $u, rated_media: $m);
reduce $user_ratings = count($u) groupby $m, $title;
match $user_ratings > 1000;
sort $user_ratings desc;
limit 5;
fetch { ""title"": $title, ""user_ratings"": $user_ratings };"
609,What are the first 3 production companies that have produced movies in more than one language?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH pc, COUNT(DISTINCT l) AS languageCount
WHERE languageCount > 1
RETURN pc.name
ORDER BY pc.name
LIMIT 3","match
$pc isa production_company;
$m isa movie;
produced_by (media: $m, producer: $pc);
$l isa language;
spoken_in_language (media: $m, language: $l);
select $pc, $l;
distinct;
reduce $count = count($l) groupby $pc;
match
$count > 1;
$pc has production_company_name $name;
sort $name asc;
limit 3;
fetch {
  ""name"": $name
};"
610,Which 3 movies have the longest runtime and were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has runtime $rt, has release_date $rd;
$rd > 2000-01-01T00:00:00;
sort $rt desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""runtime"": $rt
};"
611,List the top 5 highest rated movies by users.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH m, AVG(r.rating) AS avgRating, COUNT(r) AS ratingCount
WHERE ratingCount > 0
RETURN m.title AS title, avgRating
ORDER BY avgRating DESC
LIMIT 5","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has rating $rating;
reduce $avg_rating = mean($rating) groupby $m;
sort $avg_rating desc;
limit 5;
fetch { ""title"": $m.title, ""avgRating"": $avg_rating };"
612,Name the first 5 genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 5","match
$m isa movie, has title ""Toy Story"";
in_genre (media: $m, genre: $g);
limit 5;
fetch {
  ""name"": $g.genre_name
};"
613,What are the 3 most popular movies in the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has popularity $pop;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
sort $pop desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
614,Which 3 production companies have produced films with a budget over 100 million dollars?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
RETURN p.name, COUNT(m) AS numberOfMovies
ORDER BY numberOfMovies DESC
LIMIT 3","match
$p isa production_company;
$m isa movie, has budget $b;
$b > 100000000;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""name"": $p.production_company_name, ""numberOfMovies"": $count };"
615,List the first 5 movies that were produced in the country 'United States of America' and have a revenue over 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE m.revenue > 50000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
$r > 50000000;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
616,"What are the top 3 languages spoken in the videos with a budget greater than 500,000 dollars?","MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.budget > 500000
RETURN l.name AS language, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has budget $b;
$b > 500000;
$l isa language, has language_name $ln;
spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name };"
617,Name the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget above 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has budget $b, has release_date $rd;
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $m, producer: $pc);
$b > 50000000;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title
};"
618,Which 3 keywords are most common in movies with an average vote below 5?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.average_vote < 5
RETURN k.name AS keyword, COUNT(*) AS occurrences
ORDER BY occurrences DESC
LIMIT 3","match
$m isa movie, has average_vote $av;
$av < 5.0;
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
reduce $count = count($m) groupby $kn;
sort $count desc;
limit 3;
fetch { ""keyword"": $kn, ""occurrences"": $count };"
619,List the top 5 movies that have a runtime longer than 150 minutes and were released before 2010.,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.release_date < date(""2010-01-01"")
RETURN m.title, m.runtime, m.release_date
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie,
  has runtime $rt,
  has release_date $rd;
$rt > 150.0;
$rd < 2010-01-01T00:00:00;
sort $rt desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""runtime"": $rt,
  ""release_date"": $rd
};"
620,What are the first 3 genres associated with the movie 'Father of the Bride Part II'?,"MATCH (m:Movie {title: 'Father of the Bride Part II'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$m isa movie, has title ""Father of the Bride Part II"";
in_genre (media: $m, genre: $g);
$g has genre_name $name;
limit 3;
fetch { ""name"": $name };"
622,List the top 5 adult films with the most keywords associated.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN a.title AS Title, keyword_count AS KeywordCount","match
$a isa adult_video;
has_keyword (media: $a, keyword: $k);
reduce $keyword_count = count($k) groupby $a;
sort $keyword_count desc;
limit 5;
fetch {
  ""Title"": $a.title,
  ""KeywordCount"": $keyword_count
};"
623,Name the first 5 movies that have a homepage URL associated.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.id
LIMIT 5","match
$m isa movie, has title $t, has homepage $h, has movie_id $mid;
sort $mid asc;
limit 5;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
624,What are the 3 most popular movies in the genre 'Comedy'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has title $t, has popularity $p;
$g isa genre, has genre_name ""Comedy"";
in_genre (media: $m, genre: $g);
sort $p desc;
limit 3;
fetch { ""title"": $t, ""popularity"": $p };"
625,Which 3 production companies have produced the most movies in the genre 'Drama'?,"MATCH (g:Genre {name: 'Drama'})<-[:IN_GENRE]-(m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH pc, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN pc.name AS production_company, movie_count","match
$g isa genre, has genre_name ""Drama"";
$m isa movie;
in_genre (media: $m, genre: $g);
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""movie_count"": $count };"
626,List the first 5 movies that have a tagline and were released after 2010.,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m.title, m.release_date, m.tagline
ORDER BY m.release_date
LIMIT 5","match
$m isa movie, has tagline $tl, has release_date $rd, has title $t;
$rd > 2010-01-01T00:00:00;
sort $rd;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd,
  ""tagline"": $tl
};"
627,What are the top 3 languages spoken in movies that have a status of 'Released'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.status = 'Released'
RETURN l.name AS language, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has status ""Released"";
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""count"": $count
};"
628,Name the first 3 adult films that were produced in the country 'Italy'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'Italy'})
RETURN a.title
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has title $t, has release_date $rd;
$c isa country, has country_name ""Italy"";
produced_in_country (media: $a, country: $c);
sort $rd asc;
limit 3;
fetch {
  ""title"": $t
};"
629,Which 3 keywords are most commonly associated with videos that have a budget over 1 million dollars?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WHERE v.budget > 1000000
RETURN k.name, COUNT(*) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3","match
$v isa video, has budget $b;
$b > 1000000;
has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k;
sort $count desc;
limit 3;
fetch { ""keyword_name"": $k.keyword_name, ""keyword_count"": $count };"
630,Name the first 3 adult films with the highest average vote.,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
631,List the top 5 highest revenue generating movies of all time.,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
632,What are the top 3 languages for movies produced by 'Pixar Animation Studios'?,"MATCH (pc:ProductionCompany {name: 'Pixar Animation Studios'})<-[:PRODUCED_BY]-(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN language, movie_count","match
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie;
produced_by (media: $m, producer: $pc);
spoken_in_language (media: $m, language: $l);
reduce $movie_count = count($m) groupby $l;
sort $movie_count desc;
limit 3;
fetch { ""language"": $l.language_name, ""movie_count"": $movie_count };"
633,Which 3 movies have the highest revenue and were released in the 'United States of America'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
RETURN m.title AS title, m.revenue AS revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $title, has revenue $rev;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
sort $rev desc;
limit 3;
fetch {
  ""title"": $title,
  ""revenue"": $rev
};"
634,Find the top 5 genres by the number of movies associated.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) as movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN g.name as genre, movie_count","match
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $movie_count = count($m) groupby $g;
sort $movie_count desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""movie_count"": $movie_count
};"
635,What are the names of the top 3 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date(""2000-01-01"")
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has popularity $pop;
$rd < 2000-01-01T00:00:00;
sort $pop desc;
limit 3;
fetch {
  ""title"": $m.title
};"
636,Who are the first 3 actors cast in the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})&lt;-[:CAST_FOR]-(p:Person)
WITH p, m
ORDER BY p.cast_id
LIMIT 3
RETURN p.name AS actor_name","match
$m isa movie, has title ""Toy Story"";
$rel isa cast_for (actor: $p, film: $m);
$rel has cast_id $cid;
$p isa person;
sort $cid asc;
limit 3;
fetch {
  ""actor_name"": $p.person_name
};"
637,What are the first 5 production companies producing films in the 'Animation' genre?,"MATCH (g:Genre {name: 'Animation'})&lt;-[:IN_GENRE]-(m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
RETURN DISTINCT pc.name
LIMIT 5","match
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
produced_by (media: $m, producer: $pc);
$pc isa production_company, has production_company_name $name;
select $name;
distinct;
limit 5;
fetch { ""name"": $name };"
638,List the first 3 countries where movies with a revenue greater than 100 million dollars were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 100000000
RETURN c.name
ORDER BY c.name
LIMIT 3","match
$m isa movie, has revenue $r;
$r > 100000000.0;
produced_in_country (media: $m, country: $c);
$c has country_name $cn;
sort $cn;
limit 3;
fetch {
  ""name"": $cn
};"
639,Which 3 languages are most common among movies with a popularity score above 10?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 10
RETURN l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has popularity $pop;
$pop > 10;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""movie_count"": $count };"
640,What are the top 5 keywords associated with the movie 'Waiting to Exhale'?,"MATCH (m:Movie {title: 'Waiting to Exhale'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
$m isa movie, has title ""Waiting to Exhale"";
$k isa keyword, has keyword_name $kn;
has_keyword (media: $m, keyword: $k);
reduce $frequency = count groupby $k;
sort $frequency desc;
limit 5;
fetch { ""keyword"": $k.keyword_name };"
641,Which 3 collections contain the most movies with a budget over 50 million dollars?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.budget > 50000000
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS collection_name, movie_count","match
$m isa movie, has budget $b;
$b > 50000000;
in_collection (media: $m, collection: $c);
reduce $movie_count = count($m) groupby $c;
sort $movie_count desc;
limit 3;
fetch {
  ""collection_name"": $c.collection_name,
  ""movie_count"": $movie_count
};"
642,Name the top 3 directors who have worked on movies with an average vote greater than 7.5.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director"" AND m.average_vote > 7.5
RETURN p.name AS Director, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie, has average_vote $av;
$av > 7.5;
$r isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""Director"": $p.person_name, ""MovieCount"": $count };"
643,List the 5 most recent movies that have been added to the 'Toy Story Collection'.,"MATCH (c:Collection {name: ""Toy Story Collection""})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie;
in_collection (media: $m, collection: $c);
$m has release_date $rd;
sort $rd desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
644,What are the top 3 highest-grossing movies directed by a person named 'Tom Hanks'?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title AS MovieTitle, m.revenue AS Revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
$rel isa crew_for (crew_member: $p, film: $m);
$rel has job ""Director"";
$m isa movie, has revenue $rev;
sort $rev desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""Revenue"": $rev
};"
645,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 3
RETURN u.id AS userId, ratingCount","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""userId"": $u.user_id,
  ""ratingCount"": $count
};"
646,List the top 5 movies that have been tagged with the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title, m.average_vote, m.vote_count
ORDER BY m.average_vote DESC, m.vote_count DESC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av, has vote_count $vc;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
sort $av desc, $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av,
  ""vote_count"": $vc
};"
647,What are the first 3 genres associated with the movie 'Jonah: A VeggieTales Movie'?,"MATCH (m:Movie {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$m isa movie, has title ""Jonah: A VeggieTales Movie"";
in_genre (media: $m, genre: $g);
$g has genre_name $name;
limit 3;
fetch {
  ""name"": $name
};"
648,Name the top 5 movies with the most keywords associated.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, keyword_count","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 5;
fetch { ""MovieTitle"": $m.title, ""keyword_count"": $count };"
649,Which 3 countries have produced the most movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.runtime > 120
RETURN c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has runtime $r;
$r > 120.0;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name };"
650,Find the first 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline
LIMIT 5","match
$m isa movie, has tagline $tl;
$tl like "".*love.*"";
limit 5;
fetch {
  ""title"": $m.title,
  ""tagline"": $tl
};"
651,List the top 3 languages spoken in the highest-grossing movies.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l, SUM(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3
RETURN l.name AS language, total_revenue","match
$m isa movie, has revenue $r;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $total_revenue = sum($r) groupby $l;
sort $total_revenue desc;
limit 3;
fetch { ""language"": $l.language_name, ""total_revenue"": $total_revenue };"
652,What are the first 5 actors who have starred in both a movie and an adult film?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
MATCH (p)-[:CAST_FOR]->(a:Adult)
RETURN p.name AS actor_name
LIMIT 5","match
$p isa person;
$m isa movie;
$a isa adult_video;
cast_for (actor: $p, film: $m);
cast_for (actor: $p, film: $a);
limit 5;
fetch {
  ""actor_name"": $p.person_name
};"
653,Which 3 production companies have the highest total revenues from their movies?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, SUM(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3
RETURN pc.name AS production_company, total_revenue","match
$pc isa production_company;
$m isa movie, has revenue $r;
produced_by (media: $m, producer: $pc);
reduce $total_revenue = sum($r) groupby $pc;
sort $total_revenue desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""total_revenue"": $total_revenue };"
654,List the top 3 most popular videos with a runtime under 90 minutes.,"MATCH (v:Video)
WHERE v.runtime < 90
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
$v isa video, has runtime $r, has popularity $p;
$r < 90;
sort $p desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""popularity"": $p
};"
655,Name the first 5 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title AS movie_title, m.poster_path AS poster_path
LIMIT 5","match
$m isa movie, has poster_path $pp;
$pp like "".*\\.jpg"";
limit 5;
fetch {
  ""movie_title"": $m.title,
  ""poster_path"": $pp
};"
656,What are the top 3 genres in which 'Pixar Animation Studios' has produced movies?,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN genre, movie_count","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie;
produced_by (media: $m, producer: $p);
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movie_count"": $count };"
657,List the first 5 movies that are part of a collection and have a revenue greater than 100 million dollars.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.revenue > 100000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
$r > 100000000.0;
in_collection (media: $m, collection: $c);
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
658,What are the first 3 genres associated with the video 'Jonah: A VeggieTales Movie'?,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$v isa video, has title ""Jonah: A VeggieTales Movie"";
in_genre (media: $v, genre: $g);
limit 3;
fetch {
  ""genre_name"": $g.genre_name
};"
659,Which 3 movies have the lowest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.average_vote
ORDER BY m.average_vote ASC
LIMIT 3","match
$m isa movie, has release_date $rd, has average_vote $av;
$rd < 2000-01-01T00:00:00;
sort $av asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
660,List the top 5 movies with the longest runtime.,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
661,What are the most recent three movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has title $t;
sort $rd desc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
662,List the movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
$m isa movie, has runtime $r, has title $t;
$r > 120;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
663,Which movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title AS MovieTitle","match
$m isa movie;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $m, keyword: $k);
fetch {
  ""MovieTitle"": $m.title
};"
664,Find all movies released before 2000 with an average vote greater than 8.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote > 8
RETURN m.title, m.release_date, m.average_vote","match
$m isa movie,
    has release_date $rd,
    has average_vote $av,
    has title $t;
$rd < 2000-01-01T00:00:00;
$av > 8.0;
fetch {
    ""title"": $t,
    ""release_date"": $rd,
    ""average_vote"": $av
};"
665,List all languages spoken in the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
$m isa movie, has title ""Toy Story"";
spoken_in_language (media: $m, language: $l);
$l has language_name $ln;
fetch {
  ""language"": $ln
};"
666,What are the original titles of movies that have been translated into Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Spanish'})
RETURN m.original_title","match
$m isa movie;
$l isa language, has language_name ""Spanish"";
spoken_in_language (media: $m, language: $l);
fetch {
  ""original_title"": $m.original_title
};"
667,Which countries have produced movies with a budget exceeding 10 million USD?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.budget > 10000000
RETURN DISTINCT c.name AS country","match
$m isa movie, has budget $b;
$b > 10000000;
$c isa country, has country_name $cn;
produced_in_country (media: $m, country: $c);
select $cn;
distinct;
fetch { ""country"": $cn };"
668,List the names of all production companies involved with movies that grossed over 200 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WHERE m.revenue > 200000000
RETURN DISTINCT pc.name AS ProductionCompanyName","match
$m isa movie, has revenue $r;
$r > 200000000;
produced_by (media: $m, producer: $pc);
$pc has production_company_name $name;
select $name;
distinct;
fetch { ""ProductionCompanyName"": $name };"
669,Which genres are associated with movies directed by 'Steven Spielberg'?,"MATCH (director:Person {name: 'Steven Spielberg'})-[:CREW_FOR {job: 'Director'}]->(movie:Movie)-[:IN_GENRE]->(genre:Genre)
RETURN DISTINCT genre.name AS Genre","match
$director isa person, has person_name ""Steven Spielberg"";
$cf isa crew_for (crew_member: $director, film: $movie);
$cf has job ""Director"";
$movie isa movie;
in_genre (media: $movie, genre: $genre);
$genre has genre_name $gn;
select $gn;
distinct;
fetch { ""Genre"": $gn };"
670,List all the movies where the character 'Woody' appears.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Woody'
RETURN m.title AS MovieTitle","match
$p isa person;
$m isa movie;
$rel isa cast_for (actor: $p, film: $m);
$rel has character ""Woody"";
fetch {
  ""MovieTitle"": $m.title
};"
671,What are the top 3 most voted movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has vote_count $vc;
sort $vc desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""vote_count"": $vc
};"
672,Which movies have a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN m.title, m.poster_path","match
$m isa movie, has poster_path $pp;
$pp contains ""/rhIRbceoE9lR4veEXuwCC2wARtG.jpg"";
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
673,What are the names of people who have directed movies with a budget over 50 million USD?,"MATCH (p:Person)-[:CREW_FOR {job: ""Director""}]->(m:Movie)
WHERE m.budget > 50000000
RETURN p.name","match
$p isa person;
$m isa movie, has budget $b;
$b > 50000000;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
fetch {
  ""name"": $p.person_name
};"
674,Which movies feature a runtime less than 85 minutes and have been released after 2010?,"MATCH (m:Movie)
WHERE m.runtime < 85 AND m.release_date > date('2010-01-01')
RETURN m.title, m.runtime, m.release_date","match
$m isa movie,
    has runtime $rt,
    has release_date $rd,
    has title $t;
$rt < 85.0;
$rd > 2010-01-01T00:00:00;
fetch {
    ""title"": $t,
    ""runtime"": $rt,
    ""release_date"": $rd
};"
675,What are the movies in which 'Pixar Animation Studios' served as a production company and have a popularity score above 20?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany {name: ""Pixar Animation Studios""})
WHERE m.popularity > 20
RETURN m.title AS MovieTitle, m.popularity AS PopularityScore","match
$m isa movie, has popularity $pop, has title $t;
$pop > 20;
$pc isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $m, producer: $pc);
fetch {
  ""MovieTitle"": $t,
  ""PopularityScore"": $pop
};"
676,List all movies that are part of any collection and have a revenue less than 1 million USD.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.revenue < 1000000
RETURN m.title AS MovieTitle, c.name AS CollectionName, m.revenue AS Revenue","match
$m isa movie, has title $mt, has revenue $r;
$c isa collection, has collection_name $cn;
in_collection (media: $m, collection: $c);
$r < 1000000;
fetch {
  ""MovieTitle"": $mt,
  ""CollectionName"": $cn,
  ""Revenue"": $r
};"
677,What are the names of all genres represented in the 'Toy Story Collection'?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name AS genre_name","match
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
select $gn;
distinct;
fetch { ""genre_name"": $gn };"
678,Which movies have an IMDb ID of 'tt0114709'?,"MATCH (m:Movie {imdb_id: 'tt0114709'})
RETURN m.title, m.release_date, m.overview, m.average_vote, m.revenue, m.budget, m.runtime, m.popularity, m.homepage","match
$m isa movie, has imdb_id ""tt0114709"";
fetch {
  ""title"": $m.title,
  ""release_date"": $m.release_date,
  ""overview"": $m.overview,
  ""average_vote"": $m.average_vote,
  ""revenue"": $m.revenue,
  ""budget"": $m.budget,
  ""runtime"": $m.runtime,
  ""popularity"": $m.popularity,
  ""homepage"": $m.homepage
};"
679,What are the top 5 movies by revenue in descending order?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
680,List the movies with a tagline that includes 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title AS MovieTitle, m.tagline AS Tagline","match
$m isa movie, has tagline $tl, has title $t;
$tl like "".*excitement.*"";
fetch {
  ""MovieTitle"": $t,
  ""Tagline"": $tl
};"
681,Which movies have been produced in the 'United States of America' and have an adult rating?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
MATCH (m)-[:IN_GENRE]->(g:Genre {name: 'Adult'})
RETURN m.title AS MovieTitle","match
$m isa movie, has title $t;
$c isa country, has country_name ""United States of America"";
$g isa genre, has genre_name ""Adult"";
produced_in_country (media: $m, country: $c);
in_genre (media: $m, genre: $g);
fetch {
  ""MovieTitle"": $t
};"
682,List all movies that have a homepage URL defined.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
$m isa movie, has homepage $h;
fetch {
  ""title"": $m.title,
  ""homepage"": $h
};"
683,Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[:RATED]->(m:Movie)
RETURN m.title AS MovieTitle, m.id AS MovieID","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t, has movie_id $mid;
rated (reviewer: $u, rated_media: $m);
fetch {
  ""MovieTitle"": $t,
  ""MovieID"": $mid
};"
684,What are the names of genres associated with movies having a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name AS genre_name","match
  $m isa movie, has budget $b;
  $b > 100000000;
  in_genre (media: $m, genre: $g);
  $g has genre_name $gn;
select $gn;
distinct;
fetch {
  ""genre_name"": $gn
};"
685,List all movies produced by 'Pixar Animation Studios'.,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]-(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie;
produced_by (media: $m, producer: $p);
fetch {
  ""MovieTitle"": $m.title
};"
686,Which movies are part of the 'Toy Story Collection'?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title AS MovieTitle","match
$c isa collection, has collection_name ""Toy Story Collection"";
$m isa movie;
in_collection (media: $m, collection: $c);
fetch {
  ""MovieTitle"": $m.title
};"
687,Name the first 5 movies that have been rated by at least 50 users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS userCount
WHERE userCount >= 50
RETURN m.title AS movieTitle
ORDER BY userCount DESC
LIMIT 5","match
$m isa movie;
$u isa user;
rated (reviewer: $u, rated_media: $m);
reduce $user_count = count($u) groupby $m;
match $user_count >= 50;
sort $user_count desc;
limit 5;
fetch {
  ""movieTitle"": $m.title
};"
688,What are the 3 most popular movies that have been released since 2015?,"MATCH (m:Movie)
WHERE m.release_date >= date('2015-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has popularity $pop;
$rd >= 2015-01-01T00:00:00;
sort $pop desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
689,Which 3 production companies have produced films with a runtime longer than 180 minutes?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 180
RETURN p.name AS ProductionCompany, COUNT(m) AS NumberOfMovies
ORDER BY NumberOfMovies DESC
LIMIT 3","match
$p isa production_company;
$m isa movie, has runtime $r;
$r > 180;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""ProductionCompany"": $p.production_company_name, ""NumberOfMovies"": $count };"
690,List the first 5 videos that have a runtime under 60 minutes.,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v.title, v.runtime
ORDER BY v.runtime
LIMIT 5","match
$v isa video, has title $title, has runtime $rt;
$rt < 60.0;
sort $rt asc;
limit 5;
fetch {
  ""title"": $title,
  ""runtime"": $rt
};"
691,"What are the top 3 languages spoken in the adult films with a budget greater than 100,000 dollars?","MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.budget > 100000
RETURN l.name AS language, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$a isa adult_video, has budget $b;
$b > 100000;
$l isa language, has language_name $ln;
spoken_in_language (media: $a, language: $l);
reduce $count = count($a) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""count"": $count
};"
692,Name the first 3 movies that have a poster path ending in '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster_path $pp, has title $t;
$pp like "".*\\/pQFoyx7rp09CJTAb932F2g8Nlho\\.jpg"";
limit 3;
fetch {
  ""title"": $t
};"
693,Which 3 keywords are most commonly associated with movies that have a revenue over 200 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 200000000
RETURN k.name AS keyword, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has revenue $r;
$r > 200000000;
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
reduce $count = count($m) groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
694,List the top 5 movies that have been part of at least one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
in_collection (media: $m, collection: $c);
$m has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
695,What are the first 3 genres associated with the movie 'Alex & Emma'?,"MATCH (m:Movie {title: 'Alex & Emma'})[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$m isa movie, has title ""Alex & Emma"";
in_genre (media: $m, genre: $g);
limit 3;
fetch {
  ""genre_name"": $g.genre_name
};"
696,Which 3 movies have the highest vote count?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has title $t, has vote_count $vc;
sort $vc desc;
limit 3;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
697,List the top 5 adult films with the highest popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
$a isa adult_video, has title $t, has popularity $p;
sort $p desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
698,What are the top 5 languages spoken in the highest-grossing movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l, SUM(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN l.name AS language, total_revenue","match
$m isa movie, has revenue $rev;
spoken_in_language (media: $m, language: $l);
$l isa language;
reduce $total_revenue = sum($rev) groupby $l;
sort $total_revenue desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""total_revenue"": $total_revenue
};"
699,Name the first 5 movies that have a release date before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01')
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
$m isa movie, has release_date $rd, has title $t;
$rd < 1990-01-01T00:00:00;
sort $rd;
limit 5;
fetch {
  ""title"": $t
};"
700,Which 3 production companies have the highest total budgets for their movies?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, SUM(m.budget) AS total_budget
ORDER BY total_budget DESC
LIMIT 3
RETURN pc.name AS production_company, total_budget","match
$pc isa production_company;
$m isa movie, has budget $b;
produced_by (media: $m, producer: $pc);
reduce $total_budget = sum($b) groupby $pc;
sort $total_budget desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""total_budget"": $total_budget };"
701,List the first 5 videos that were produced by 'Pixar Animation Studios'.,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]->(v:Video)
RETURN v.title AS VideoTitle, v.release_date AS ReleaseDate
ORDER BY v.release_date
LIMIT 5","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$v isa video, has release_date $rd;
produced_by (media: $v, producer: $p);
sort $rd asc;
limit 5;
fetch {
  ""title"": $v.title,
  ""release_date"": $rd
};"
702,What are the top 3 languages spoken in adult films with a vote count over 10?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.vote_count > 10
RETURN l.name AS language, COUNT(a) AS count
ORDER BY count DESC
LIMIT 3","match
$a isa adult_video, has vote_count $vc;
$vc > 10;
spoken_in_language (media: $a, language: $l);
$l has language_name $ln;
reduce $count = count($a) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""count"": $count };"
703,Name the first 3 adult films that have a runtime longer than 90 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has runtime $r, has release_date $rd;
$r > 90.0;
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title
};"
704,Which 3 keywords are most commonly associated with movies that have an original language of 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'}),
      (m)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie;
$l isa language, has language_id ""en"";
original_language (media: $m, language: $l);
$k isa keyword, has keyword_name $kn;
has_keyword (media: $m, keyword: $k);
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 3;
fetch { ""keyword"": $kn, ""count"": $count };"
705,List the top 5 movies that have been rated by users with an average rating below 4.0.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, avg(u.rating) AS average_rating
WHERE average_rating < 4.0
RETURN m.title AS MovieTitle, average_rating AS AverageRating
ORDER BY AverageRating ASC
LIMIT 5","match
$m isa movie, has title $t;
$r isa rated (reviewer: $u, rated_media: $m), has rating $rat;
$u isa user;
reduce $avg = mean($rat) groupby $m, $t;
match $avg < 4.0;
sort $avg asc;
limit 5;
fetch { ""MovieTitle"": $t, ""AverageRating"": $avg };"
706,What are the first 3 genres associated with the movie 'Nil Battey Sannata'?,"MATCH (m:Movie {title: 'Nil Battey Sannata'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
$m isa movie, has title ""Nil Battey Sannata"";
in_genre (media: $m, genre: $g);
limit 3;
fetch {
  ""name"": $g.genre_name
};"
707,Which 3 movies have the highest revenue and were released in the 'United Kingdom'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United Kingdom'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r;
$c isa country, has country_name ""United Kingdom"";
produced_in_country (media: $m, country: $c);
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
708,Which movies have a revenue greater than 50 million USD?,"MATCH (m:Movie)
WHERE m.revenue > 50000000
RETURN m.title, m.revenue","match
$m isa movie, has revenue $rev, has title $title;
$rev > 50000000;
fetch {
  ""title"": $title,
  ""revenue"": $rev
};"
709,List all movies where Tom Hanks acted in.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
RETURN m.title AS MovieTitle","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
cast_for (actor: $p, film: $m);
fetch {
  ""MovieTitle"": $m.title
};"
710,What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
711,What are the 3 most popular movies in the genre 'Thriller'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Thriller'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has title $t, has popularity $p;
$g isa genre, has genre_name ""Thriller"";
in_genre (media: $m, genre: $g);
sort $p desc;
limit 3;
fetch {
  ""title"": $t,
  ""popularity"": $p
};"
712,List the first 3 people who have a profile path starting with '/p'.,"MATCH (p:Person)
WHERE p.profile_path STARTS WITH '/p'
RETURN p.name, p.profile_path
LIMIT 3","match
$p isa person, has profile_path $pp;
$pp like ""/p.*"";
limit 3;
fetch {
  ""name"": $p.person_name,
  ""profile_path"": $pp
};"
713,List the movies with a release date on '1995-10-30'.,"MATCH (m:Movie)
WHERE m.release_date = date('1995-10-30')
RETURN m.title, m.release_date","match
$m isa movie, has release_date $rd;
$rd == 1995-10-30T00:00:00;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
714,What are the top 5 original titles of movies with an original language of 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN m.original_title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has original_title $ot, has popularity $pop;
$l isa language, has language_id ""en"";
original_language (media: $m, language: $l);
sort $pop desc;
limit 5;
fetch {
  ""original_title"": $ot
};"
715,List the top 3 people who have the most credits as a producer.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Producer""
RETURN p.name, COUNT(r) AS producer_credits
ORDER BY producer_credits DESC
LIMIT 3","match
$p isa person, has person_name $name;
$r isa crew_for (crew_member: $p, film: $m);
$r has job ""Producer"";
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 3;
fetch { ""name"": $name, ""producer_credits"": $count };"
716,Which 3 movies have the most distinct languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(DISTINCT l) AS language_count
ORDER BY language_count DESC
LIMIT 3
RETURN m.title AS movie_title, language_count","match
$m isa movie;
spoken_in_language (media: $m, language: $l);
reduce $language_count = count($l) groupby $m;
sort $language_count desc;
limit 3;
fetch { ""movie_title"": $m.title, ""language_count"": $language_count };"
717,List the first 3 movies that have been rated exactly 10 times and have a budget greater than 100000 USD.,"MATCH (m:Movie)
WHERE m.budget > 100000
WITH m
MATCH (m)<-[:RATED]-(u:User)
WITH m, count(u) as rating_count
WHERE rating_count = 10
RETURN m.title, m.budget
LIMIT 3","match
$m isa movie, has budget $b, has title $t;
$b > 100000;
$u isa user;
rated (reviewer: $u, rated_media: $m);
reduce $count = count($u) groupby $m, $t, $b;
match
$count == 10;
limit 3;
fetch { ""title"": $t, ""budget"": $b };"
718,What are the top 5 movies with a specific keyword 'space' and have been released?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE k.name = 'space' AND m.status = 'Released'
RETURN m.title, m.release_date, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie,
  has title $title,
  has status ""Released"",
  has release_date $rd,
  has average_vote $av;
$k isa keyword, has keyword_name ""space"";
has_keyword (media: $m, keyword: $k);
sort $av desc;
limit 5;
fetch {
  ""title"": $title,
  ""release_date"": $rd,
  ""average_vote"": $av
};"
719,"List the first 3 movies that have a release date on a specific day, say '1995-12-22'.","MATCH (m:Movie)
WHERE m.release_date = date('1995-12-22')
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has release_date $rd;
$rd == 1995-12-22T00:00:00;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
720,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
721,List the first 3 genres most commonly associated with movies that have a budget over $50 million.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 50000000
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has budget $b;
$b > 50000000;
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
722,Which 3 movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, keyword_count","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch { ""MovieTitle"": $m.title, ""keyword_count"": $count };"
723,Who are the top 5 directors with the most films produced in the United States?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: ""United States of America""})
WHERE EXISTS {
  MATCH (p)-[:CREW_FOR {job: ""Director""}]->(m)
}
RETURN p.name AS director, COUNT(m) AS film_count
ORDER BY film_count DESC
LIMIT 5","match
$p isa person, has person_name $name;
$m isa movie;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
reduce $film_count = count($m) groupby $p, $name;
sort $film_count desc;
limit 5;
fetch { ""director"": $name, ""film_count"": $film_count };"
724,What are the top 3 languages spoken in movies that have a revenue greater than $100 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 100000000
RETURN l.name, COUNT(*) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has revenue $r;
$r > 100000000;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""name"": $l.language_name, ""movie_count"": $count };"
725,List the first 3 countries where movies with an average vote above 8 were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 8
RETURN c.name
ORDER BY c.name
LIMIT 3","match
$m isa movie, has average_vote $av;
$av > 8.0;
produced_in_country (media: $m, country: $c);
$c has country_name $cn;
sort $cn asc;
limit 3;
fetch {
  ""name"": $cn
};"
726,Which 3 production companies have produced the most movies with a runtime longer than 120 minutes?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 120
RETURN p.name, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has runtime $r;
$r > 120.0;
$p isa production_company;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""name"": $p.production_company_name, ""movie_count"": $count };"
727,What are the top 5 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has popularity $pop;
$rd < 2000-01-01T00:00:00;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""popularity"": $pop
};"
728,Who are the first 3 actors by number of roles in movies with a status of 'Released'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE m.status = 'Released'
RETURN p.name AS actor, COUNT(r) AS roles
ORDER BY roles DESC
LIMIT 3","match
$p isa person;
$m isa movie, has status ""Released"";
$rel isa cast_for (actor: $p, film: $m);
reduce $roles = count($rel) groupby $p;
sort $roles desc;
limit 3;
fetch {
  ""actor"": $p.person_name,
  ""roles"": $roles
};"
729,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 3
RETURN u.id AS userId, ratingCount","match
$u isa user;
$rel isa rated (reviewer: $u, rated_media: $m);
$m isa movie;
reduce $rating_count = count($rel) groupby $u;
sort $rating_count desc;
limit 3;
fetch { ""userId"": $u.user_id, ""ratingCount"": $rating_count };"
730,What are the top 5 countries with the most movies produced?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN country, movie_count","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch {
  ""country"": $c.country_name,
  ""movie_count"": $count
};"
731,List the first 3 genres associated with the highest average movie budget.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.budget) AS avg_budget
ORDER BY avg_budget DESC
LIMIT 3
RETURN g.name AS genre, avg_budget","match
$m isa movie, has budget $b;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $avg_budget = mean($b) groupby $g, $gn;
sort $avg_budget desc;
limit 3;
fetch { ""genre"": $gn, ""avg_budget"": $avg_budget };"
732,What are the top 3 collections with the most movies included?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH c, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN c.name AS collectionName, movieCount","match
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""collectionName"": $c.collection_name, ""movieCount"": $count };"
733,Which 3 directors have worked on the highest-grossing movies?,"MATCH (m:Movie)-[:CREW_FOR]->(p:Person)
WHERE p.job = ""Director""
RETURN p.name AS Director, SUM(m.revenue) AS TotalRevenue
ORDER BY TotalRevenue DESC
LIMIT 3","match
$m isa movie, has revenue $rev;
$p isa person, has person_name $name;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $total_revenue = sum($rev) groupby $p;
sort $total_revenue desc;
limit 3;
fetch { ""Director"": $p.person_name, ""TotalRevenue"": $total_revenue };"
734,List the first 3 actors who have starred in the most movies within a single genre.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, g, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN p.name AS actor_name, g.name AS genre_name, movie_count","match
$p isa person, has person_name $name;
$m isa movie;
$g isa genre, has genre_name $gname;
cast_for (actor: $p, film: $m);
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $p, $g;
sort $count desc;
limit 3;
fetch { ""actor_name"": $p.person_name, ""genre_name"": $g.genre_name, ""movie_count"": $count };"
735,What are the top 5 languages in which the most highly rated movies were originally made?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l, m
ORDER BY m.average_vote DESC
RETURN l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$m isa movie;
$l isa language;
original_language (media: $m, language: $l);
$l has language_name $ln;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""movie_count"": $count };"
736,Which 3 production companies have the highest average revenue per movie?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, avg(m.revenue) AS avg_revenue
ORDER BY avg_revenue DESC
LIMIT 3
RETURN pc.name AS production_company, avg_revenue","match
$pc isa production_company;
$m isa movie, has revenue $r;
produced_by (media: $m, producer: $pc);
reduce $avg_rev = mean($r) groupby $pc;
sort $avg_rev desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""avg_revenue"": $avg_rev };"
737,List the first 3 movies that have been rated by the highest number of users.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS user_count
ORDER BY user_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, user_count AS NumberOfRatings","match
$m isa movie;
$u isa user;
rated (reviewer: $u, rated_media: $m);
reduce $count = count($u) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""NumberOfRatings"": $count
};"
738,What are the first 5 movies that have a poster path ending in '.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
LIMIT 5","match
$m isa movie, has poster_path $pp;
$pp like "".*\\.jpg"";
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $pp
};"
739,What are the top 5 genres with the most movies having a runtime of less than 90 minutes?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime < 90
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$m isa movie, has runtime $r;
$r < 90;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
740,List the first 3 packages that provide the longest duration of access to movies.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(:Genre)
RETURN p.name, p.duration
ORDER BY p.duration DESC
LIMIT 3","match
$p isa package, has package_duration $d;
provides_access_to (package: $p, genre: $g);
sort $d desc;
limit 3;
fetch {
  ""name"": $p.package_name,
  ""duration"": $d
};"
741,List the first 3 adult films with a tagline 'Humiliation. Rape. Murder. You know the drill.',"MATCH (a:Adult {tagline: 'Humiliation. Rape. Murder. You know the drill.'})
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has tagline ""Humiliation. Rape. Murder. You know the drill."", has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""release_date"": $rd
};"
742,Which 3 genres are most commonly associated with videos that have a budget over 100000 USD?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.budget > 100000
RETURN g.name, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has budget $b;
$b > 100000;
$g isa genre;
in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre_name"": $g.genre_name, ""video_count"": $count };"
743,List the top 3 countries where the most videos have been produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c, count(v) AS video_count
ORDER BY video_count DESC
LIMIT 3
RETURN c.name AS country, video_count","match
$v isa video;
$c isa country, has country_name $cn;
produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""video_count"": $count };"
744,What are the first 5 keywords most associated with movies that have a revenue above 1 million USD?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 1000000
RETURN k.name, COUNT(*) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5","match
$m isa movie, has revenue $r;
$r > 1000000.0;
$k isa keyword, has keyword_name $kn;
has_keyword (media: $m, keyword: $k);
reduce $count = count($m) groupby $k;
sort $count desc;
limit 5;
fetch {
  ""keyword_name"": $k.keyword_name,
  ""keyword_count"": $count
};"
745,List the first 3 genres that have the highest average rating across all movies.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)<-[:RATED]-(r:User)
WITH g, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3
RETURN g.name AS genre, avg_rating","match
$m isa movie;
$g isa genre;
in_genre (media: $m, genre: $g);
$rel isa rated (rated_media: $m);
$rel has rating $r;
reduce $avg_rating = mean($r) groupby $g;
sort $avg_rating desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""avg_rating"": $avg_rating
};"
746,Which 3 production companies have produced the most adult films?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(a:Adult)
RETURN pc.name, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3","match
$pc isa production_company, has production_company_name $name;
$a isa adult_video;
produced_by (media: $a, producer: $pc);
reduce $count = count($a) groupby $pc, $name;
sort $count desc;
limit 3;
fetch { ""name"": $name, ""num_adult_films"": $count };"
747,List the top 3 people who have acted the most in released movies.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie {status: ""Released""})
WITH p, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN p.name AS actor_name, movie_count","match
$p isa person;
$m isa movie, has status ""Released"";
cast_for (actor: $p, film: $m);
reduce $movie_count = count($m) groupby $p;
sort $movie_count desc;
limit 3;
fetch { ""actor_name"": $p.person_name, ""movie_count"": $movie_count };"
748,What are the top 5 users who have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, COUNT(r) AS ratingCount
ORDER BY ratingCount DESC
LIMIT 5
RETURN u.id AS userId, ratingCount","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
reduce $ratingCount = count($r) groupby $u;
sort $ratingCount desc;
limit 5;
fetch { ""userId"": $u.user_id, ""ratingCount"": $ratingCount };"
749,List the first 3 movies with the highest number of associated keywords and a budget above 50000 USD.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 50000
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN m.title AS movie_title, keyword_count, m.budget","match
$m isa movie, has budget $b, has title $t;
$b > 50000;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie_title"": $m.title,
  ""keyword_count"": $count,
  ""budget"": $m.budget
};"
750,Which 3 movies have the longest gap between their release date and the current date?,"MATCH (m:Movie)
WITH m, duration.inDays(date(m.release_date), date()) AS days_since_release
RETURN m.title, m.release_date, days_since_release
ORDER BY days_since_release DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has title $t;
sort $rd asc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
751,List the first 3 movies that have a specific keyword 'adventure' and are in the 'Released' status.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword), (m)-[:IN_GENRE]->(g:Genre)
WHERE k.name = 'adventure' AND m.status = 'Released'
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has status ""Released"", has release_date $rd;
$k isa keyword, has keyword_name ""adventure"";
has_keyword (media: $m, keyword: $k);
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $rd
};"
753,List the first 3 movies that are part of a collection and have a runtime less than 90 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.runtime < 90
RETURN m.title, m.runtime, c.name
ORDER BY m.runtime
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
$c isa collection, has collection_name $cn;
in_collection (media: $m, collection: $c);
$r < 90;
sort $r;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r,
  ""collection_name"": $cn
};"
754,Which 3 adult films have the most provocative taglines?,"MATCH (a:Adult)
WHERE a.tagline IS NOT NULL
RETURN a.title, a.tagline
ORDER BY a.popularity DESC
LIMIT 3","match
$a isa adult_video, has tagline $tl, has popularity $pop;
sort $pop desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""tagline"": $tl
};"
755,List the first 3 videos that have a specific keyword 'action' and are in the 'Released' status.,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword {name: 'action'})
WHERE v.status = 'Released'
RETURN v.title, v.release_date, v.status
ORDER BY v.release_date
LIMIT 3","match
$v isa video, has status ""Released"", has release_date $rd;
$k isa keyword, has keyword_name ""action"";
has_keyword (media: $v, keyword: $k);
sort $rd asc;
limit 3;
fetch {
  ""title"": $v.title,
  ""release_date"": $rd,
  ""status"": $v.status
};"
756,What are the top 5 adult films with the lowest vote count and are still in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.vote_count
ORDER BY a.vote_count ASC
LIMIT 5","match
$a isa adult_video, has status ""Released"", has vote_count $vc, has title $t;
sort $vc asc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
757,List the first 3 movies that have an original language of 'es' and are in the 'Released' status.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'es'})
WHERE m.status = 'Released'
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has status ""Released"", has release_date $rd;
original_language (media: $m, language: $l);
$l isa language, has language_id ""es"";
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
759,List the top 3 adult films that have been rated exactly 3 times.,"MATCH (a:Adult)<-[:RATED]-(u:User)
WITH a, COUNT(u) AS rating_count
WHERE rating_count = 3
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 3","match
$a isa adult_video;
$u isa user;
rated (reviewer: $u, rated_media: $a);
reduce $rating_count = count($u) groupby $a;
match
$rating_count == 3;
$a has vote_count $vc;
sort $vc desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""vote_count"": $vc
};"
760,What are the first 5 packages that provide access to the genre 'Drama'?,"MATCH (g:Genre {name: 'Drama'})  <-[:PROVIDES_ACCESS_TO]-(p:Package)
RETURN p.name
LIMIT 5","match
$g isa genre, has genre_name ""Drama"";
provides_access_to (package: $p, genre: $g);
$p has package_name $pn;
limit 5;
fetch { ""name"": $pn };"
761,List the first 3 subscriptions that were initiated in 2020.,"MATCH (s:Subscription)
WHERE s.expiresAt >= datetime('2020-01-01T00:00:00Z') AND s.expiresAt < datetime('2021-01-01T00:00:00Z')
RETURN s.id, s.expiresAt
ORDER BY s.expiresAt
LIMIT 3","match
$s isa subscription, has expires_at $ea, has subscription_id $sid;
$ea >= 2020-01-01T00:00:00Z;
$ea < 2021-01-01T00:00:00Z;
sort $ea;
limit 3;
fetch {
  ""id"": $sid,
  ""expiresAt"": $ea
};"
762,Which 3 movies have the most cast members named 'Tom Hanks'?,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)
WITH m, COUNT(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3
RETURN m.title AS movie_title, cast_count","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
$rel isa cast_for (actor: $p, film: $m);
reduce $cast_count = count($rel) groupby $m;
sort $cast_count desc;
limit 3;
fetch {
  ""movie_title"": $m.title,
  ""cast_count"": $cast_count
};"
763,List the top 3 videos that have been produced by 'Pixar Animation Studios' and have a runtime shorter than 50 minutes.,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})<-[:PRODUCED_BY]-(v:Video)
WHERE v.runtime < 50
RETURN v.title, v.runtime
ORDER BY v.popularity DESC
LIMIT 3","match
$v isa video, has runtime $r, has popularity $pop;
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
produced_by (media: $v, producer: $p);
$r < 50.0;
sort $pop desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""runtime"": $r
};"
764,What are the top 5 movies with an original title different from their title?,"MATCH (m:Movie)
WHERE m.original_title <> m.title
RETURN m.title, m.original_title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie,
  has title $t,
  has original_title $ot,
  has popularity $pop;
$t != $ot;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""original_title"": $ot
};"
765,Which 3 languages are most frequently used in videos with a runtime over 100 minutes?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.runtime > 100
RETURN l.name AS language, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$v isa video, has runtime $r;
$r > 100;
$l isa language, has language_name $ln;
spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name };"
766,List the first 3 languages that have been spoken in the most adult films.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(a) AS film_count
ORDER BY film_count DESC
LIMIT 3
RETURN language, film_count","match
$a isa adult_video;
spoken_in_language (media: $a, language: $l);
$l has language_name $ln;
reduce $film_count = count($a) groupby $l, $ln;
sort $film_count desc;
limit 3;
fetch {
  ""language"": $ln,
  ""film_count"": $film_count
};"
767,Which 3 production companies have the most movies with a vote count over 1000?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.vote_count > 1000
RETURN p.name AS ProductionCompany, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3","match
$p isa production_company;
$m isa movie, has vote_count $vc;
$vc > 1000;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch {
  ""ProductionCompany"": $p.production_company_name,
  ""MovieCount"": $count
};"
768,List the top 5 adult films with the highest average votes.,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
769,What are the top 3 languages spoken in videos that have a revenue greater than $0?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.revenue > 0
RETURN l.name, COUNT(*) AS video_count
ORDER BY video_count DESC
LIMIT 3","match
$v isa video, has revenue $r;
$r > 0;
$l isa language, has language_name $ln;
spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""video_count"": $count
};"
770,Who are the first 3 actors by number of roles in videos with a status of 'Released'?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video {status: 'Released'})
WITH p, COUNT(v) AS role_count
ORDER BY role_count DESC
LIMIT 3
RETURN p.name AS actor_name, role_count","match
$p isa person;
$v isa video, has status ""Released"";
cast_for (actor: $p, film: $v);
reduce $role_count = count($v) groupby $p;
sort $role_count desc;
limit 3;
fetch { ""actor_name"": $p.person_name, ""role_count"": $role_count };"
771,List the first 3 genres with the most adult films associated.,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
WITH g, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3
RETURN g.name AS genre, adultFilmCount","match
$a isa adult_video;
in_genre (media: $a, genre: $g);
$g has genre_name $gn;
reduce $count = count($a) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""adultFilmCount"": $count };"
772,What are the top 5 movies with the most number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, COUNT(l) AS language_count
RETURN m.title AS movie_title, language_count
ORDER BY language_count DESC
LIMIT 5","match
$m isa movie, has title $t;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m, $t;
sort $count desc;
limit 5;
fetch { ""movie_title"": $t, ""language_count"": $count };"
773,Which 3 directors have worked on movies with the longest total runtime?,"MATCH (p:Person)-[c:CREW_FOR]->(m:Movie)
WHERE c.job = ""Director""
WITH p, SUM(m.runtime) AS total_runtime
ORDER BY total_runtime DESC
LIMIT 3
RETURN p.name AS director, total_runtime","match
$p isa person;
$m isa movie;
$c isa crew_for (crew_member: $p, film: $m);
$c has job ""Director"";
$m has runtime $r;
reduce $total = sum($r) groupby $p;
sort $total desc;
limit 3;
fetch { ""director"": $p.person_name, ""total_runtime"": $total };"
774,List the first 3 countries where the most non-English language movies are produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country), (m)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE l.id <> 'en'
WITH c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN country, movie_count","match
$m isa movie;
produced_in_country (media: $m, country: $c);
original_language (media: $m, language: $l);
$l has language_id $lid;
$lid != ""en"";
$c has country_name $cn;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""movie_count"": $count };"
775,What are the top 5 most popular videos based on their popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
$v isa video, has popularity $p;
sort $p desc;
limit 5;
fetch {
  ""title"": $v.title,
  ""popularity"": $p
};"
776,Who are the first 3 actors to have starred in at least 3 movies from the 'Toy Story Collection'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WITH p, COUNT(m) AS movieCount
WHERE movieCount >= 3
RETURN p.name AS actorName
ORDER BY movieCount DESC, p.name
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
$c isa collection, has collection_name ""Toy Story Collection"";
cast_for (actor: $p, film: $m);
in_collection (media: $m, collection: $c);
reduce $movie_count = count($m) groupby $p, $name;
match $movie_count >= 3;
sort $movie_count desc, $name asc;
limit 3;
fetch { ""actorName"": $name };"
777,Which 3 languages are spoken most commonly in movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.runtime > 120
RETURN l.name AS language, COUNT(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has runtime $r;
$r > 120;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""count"": $count
};"
778,List the first 3 genres that have the most movies featuring Tom Hanks.,"MATCH (p:Person {name: ""Tom Hanks""})-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name AS genre, movieCount","match
  $p isa person, has person_name ""Tom Hanks"";
  cast_for (actor: $p, film: $m);
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""movieCount"": $count };"
779,What are the top 5 production companies by the number of comedy films produced?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Comedy""})
WITH p, COUNT(m) AS comedyFilmCount
ORDER BY comedyFilmCount DESC
LIMIT 5
RETURN p.name AS productionCompany, comedyFilmCount","match
$p isa production_company;
$m isa movie;
$g isa genre, has genre_name ""Comedy"";
produced_by (media: $m, producer: $p);
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch { ""productionCompany"": $p.production_company_name, ""comedyFilmCount"": $count };"
780,What are the top 3 highest revenue adult films?,"MATCH (a:Adult)
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3","match
$a isa adult_video, has revenue $r;
sort $r desc;
limit 3;
fetch {
  ""title"": $a.title,
  ""revenue"": $r
};"
781,Who are the first 3 directors who have worked on both movies and adult films?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie), 
      (p)-[:CREW_FOR]->(a:Adult)
WHERE EXISTS {
  MATCH (p)-[:CREW_FOR {job: ""Director""}]->(m)
} AND EXISTS {
  MATCH (p)-[:CREW_FOR {job: ""Director""}]->(a)
}
RETURN DISTINCT p.name
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
$a isa adult_video;
$rel1 isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$rel2 isa crew_for (crew_member: $p, film: $a), has job ""Director"";
select $name;
distinct;
limit 3;
fetch { ""name"": $name };"
782,Which 3 production companies have the most films with an original language of 'en'?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN p.name AS ProductionCompany, COUNT(m) AS FilmCount
ORDER BY FilmCount DESC
LIMIT 3","match
$p isa production_company;
$m isa movie;
$l isa language, has language_id ""en"";
produced_by (media: $m, producer: $p);
original_language (media: $m, language: $l);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""ProductionCompany"": $p.production_company_name, ""FilmCount"": $count };"
783,List the top 5 keywords associated with the most commercially successful movies.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH k, SUM(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN k.name AS keyword, total_revenue","match
$m isa movie, has revenue $rev;
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
reduce $total_revenue = sum($rev) groupby $k, $kn;
sort $total_revenue desc;
limit 5;
fetch { ""keyword"": $kn, ""total_revenue"": $total_revenue };"
784,What are the top 3 countries producing the most comedies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: ""Comedy""}), 
      (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, COUNT(m) AS comedy_count
ORDER BY comedy_count DESC
LIMIT 3","match
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name ""Comedy"";
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""comedy_count"": $count
};"
785,Who are the first 3 actors who have starred in both comedies and dramas?,"MATCH (actor:Person)-[:CAST_FOR]->(comedy:Movie)-[:IN_GENRE]->(comedyGenre:Genre {name: ""Comedy""}),
      (actor)-[:CAST_FOR]->(drama:Movie)-[:IN_GENRE]->(dramaGenre:Genre {name: ""Drama""})
RETURN DISTINCT actor.name
LIMIT 3","match
$actor isa person;
$comedy isa movie;
$drama isa movie;
$comedyGenre isa genre, has genre_name ""Comedy"";
$dramaGenre isa genre, has genre_name ""Drama"";
cast_for (actor: $actor, film: $comedy);
in_genre (media: $comedy, genre: $comedyGenre);
cast_for (actor: $actor, film: $drama);
in_genre (media: $drama, genre: $dramaGenre);
select $actor;
distinct;
limit 3;
fetch {
  ""actor_name"": $actor.person_name
};"
786,Which 3 languages are spoken in the most films with a poster featuring '/rh'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.poster_path STARTS WITH '/rh'
RETURN l.name, COUNT(m) AS film_count
ORDER BY film_count DESC
LIMIT 3","match
$m isa movie, has poster_path $pp;
$pp like ""/rh.*"";
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $film_count = count($m) groupby $l;
sort $film_count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""film_count"": $film_count
};"
787,List the first 3 genres of movies with the lowest average revenue.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.revenue) AS avg_revenue
ORDER BY avg_revenue ASC
LIMIT 3
RETURN g.name AS genre, avg_revenue","match
$m isa movie, has revenue $rev;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $avg_rev = mean($rev) groupby $g, $gn;
sort $avg_rev asc;
limit 3;
fetch {
  ""genre"": $gn,
  ""avg_revenue"": $avg_rev
};"
788,What are the top 5 movies with a tagline that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title, m.tagline, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has tagline $t, has average_vote $av;
$t like "".*adventure.*"";
sort $av desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""tagline"": $t,
  ""average_vote"": $av
};"
789,Who are the first 3 directors with movies that have a runtime of over 180 minutes?,"MATCH (p:Person)-[c:CREW_FOR]->(m:Movie)
WHERE c.job = ""Director"" AND m.runtime > 180
RETURN p.name AS Director
ORDER BY p.name
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie, has runtime $rt;
$rt > 180;
$c isa crew_for (crew_member: $p, film: $m), has job ""Director"";
sort $name;
limit 3;
fetch {
  ""Director"": $name
};"
790,Which 3 languages are most commonly found in movies with a poster path featuring '/9'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.poster_path CONTAINS '/9'
RETURN l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has poster_path $pp;
$pp like "".*/9.*"";
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""movie_count"": $count
};"
791,What are the top 5 movies with the highest budget that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has budget $b, has release_date $rd;
$rd >= 1990-01-01T00:00:00;
$rd < 2000-01-01T00:00:00;
sort $b desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
792,Which 3 languages are most common in movies with a budget over $30 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 30000000
RETURN l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has budget $b;
$b > 30000000;
$l isa language, has language_name $ln;
spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""movie_count"": $count
};"
793,What are the top 3 highest budget movies that have a poster path ending in 'jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'jpg'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has poster_path $pp, has budget $b, has title $t;
$pp like "".*jpg"";
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
794,Which 3 directors have the most movies with an average vote higher than 7?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = ""Director"" AND m.average_vote > 7
RETURN p.name AS Director, COUNT(m) AS MovieCount
ORDER BY MovieCount DESC
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie, has average_vote $av;
$av > 7.0;
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($m) groupby $p;
sort $count desc;
limit 3;
fetch { ""Director"": $p.person_name, ""MovieCount"": $count };"
795,List the first 3 countries where the most English language movies are produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country), (m)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
WITH c, count(m) as movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS country, movie_count","match
$m isa movie;
$l isa language, has language_id ""en"";
original_language (media: $m, language: $l);
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $movie_count = count($m) groupby $c;
sort $movie_count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""movie_count"": $movie_count
};"
796,What are the top 5 production companies by the number of movies with a runtime longer than 100 minutes?,"MATCH (p:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 100
RETURN p.name AS production_company, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$m isa movie, has runtime $r;
$r > 100.0;
$p isa production_company, has production_company_name $name;
produced_by (media: $m, producer: $p);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch { ""production_company"": $p.production_company_name, ""movie_count"": $count };"
797,List the first 3 actors who have played in movies with at least three different taglines.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, COUNT(DISTINCT m.tagline) AS tagline_count
WHERE tagline_count >= 3
MATCH (p)-[:CAST_FOR]->(m:Movie)
RETURN p.name AS actor_name, COLLECT(DISTINCT m.tagline) AS taglines
ORDER BY actor_name
LIMIT 3","match
$p isa person, has person_name $name;
cast_for (actor: $p, film: $m);
$m isa movie, has tagline $t;
select $p, $name, $t;
distinct;
reduce $count = count($t) groupby $p, $name;
match $count >= 3;
sort $name;
limit 3;
fetch { ""actor_name"": $name };"
798,Which 3 genres have the most videos associated with them?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, count(v) as videoCount
RETURN g.name as genre, videoCount
ORDER BY videoCount DESC
LIMIT 3","match
$v isa video;
$g isa genre;
in_genre (media: $v, genre: $g);
$g has genre_name $name;
reduce $count = count($v) groupby $g, $name;
sort $count desc;
limit 3;
fetch { ""genre"": $name, ""videoCount"": $count };"
799,List the first 3 countries with the most videos produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3
RETURN country, video_count","match
$v isa video;
$c isa country, has country_name $name;
produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""country"": $name, ""video_count"": $count };"
800,What are the top 5 movies with the longest runtime and released after 2010?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01')
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has runtime $rt;
$rd > 2010-01-01T00:00:00;
sort $rt desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""runtime"": $rt
};"
801,Who are the first 3 actors by number of roles in adult films?,"MATCH (p:Person)-[:CAST_FOR]->(a:Adult)
WITH p, COUNT(a) AS numRoles
ORDER BY numRoles DESC
LIMIT 3
RETURN p.name AS actor, numRoles","match
$p isa person;
$a isa adult_video;
cast_for (actor: $p, film: $a);
reduce $numRoles = count($a) groupby $p;
sort $numRoles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""numRoles"": $numRoles };"
802,What are the top 5 genres of movies produced by Pixar Animation Studios?,"MATCH (p:ProductionCompany {name: ""Pixar Animation Studios""})-[:PRODUCED_BY]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie;
produced_by (media: $m, producer: $p);
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
803,List the first 3 movies with the most revenue that were released after the year 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has release_date $rd, has revenue $rev;
$rd > 2000-01-01T00:00:00;
sort $rev desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
804,Who are the first 3 directors to have movies in more than one collection?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE p.job = ""Director""
WITH p, COUNT(DISTINCT c) AS collectionCount
WHERE collectionCount > 1
RETURN p.name AS DirectorName
ORDER BY p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $rel isa crew_for (crew_member: $p, film: $m);
  $rel has job ""Director"";
  in_collection (media: $m, collection: $c);
select $p, $name, $c;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count > 1;
sort $name;
limit 3;
fetch { ""DirectorName"": $name };"
805,What are the top 5 languages in which the most adult films were originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 5
RETURN language, num_adult_films","match
$a isa adult_video;
original_language (media: $a, language: $l);
$l has language_name $ln;
reduce $count = count($a) groupby $l;
sort $count desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""num_adult_films"": $count
};"
806,Which 3 production companies have produced the most adult films?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(a:Adult)
RETURN pc.name AS ProductionCompany, COUNT(a) AS NumberOfAdultFilms
ORDER BY NumberOfAdultFilms DESC
LIMIT 3","match
$pc isa production_company, has production_company_name $name;
$a isa adult_video;
produced_by (media: $a, producer: $pc);
reduce $count = count($a) groupby $pc, $name;
sort $count desc;
limit 3;
fetch {
  ""ProductionCompany"": $name,
  ""NumberOfAdultFilms"": $count
};"
807,List the top 5 keywords associated with movies that have a runtime over 150 minutes.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.runtime > 150
RETURN k.name, COUNT(*) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5","match
$m isa movie, has runtime $r;
$r > 150;
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
reduce $count = count($m) groupby $k;
sort $count desc;
limit 5;
fetch { ""name"": $k.keyword_name, ""keyword_count"": $count };"
808,What are the top 3 countries producing the most adult films with a runtime over 60 minutes?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE a.runtime > 60
RETURN c.name AS country, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3","match
$a isa adult_video, has runtime $r;
$r > 60;
produced_in_country (media: $a, country: $c);
$c has country_name $cn;
reduce $count = count($a) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""num_adult_films"": $count
};"
809,Who are the first 3 actors with roles in both movies and adult films?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
MATCH (p)-[:CAST_FOR]->(a:Adult)
WITH p, COUNT(DISTINCT m) AS movieCount, COUNT(DISTINCT a) AS adultCount
WHERE movieCount > 0 AND adultCount > 0
RETURN p.name AS actorName
ORDER BY p.name
LIMIT 3","match
$p isa person, has person_name $name;
cast_for (actor: $p, film: $m);
$m isa movie;
cast_for (actor: $p, film: $a);
$a isa adult_video;
sort $name;
limit 3;
fetch {
  ""actorName"": $name
};"
810,Which 3 keywords are most frequently associated with movies having a budget over $200 million?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 200000000
RETURN k.name AS keyword, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$m isa movie, has budget $b;
$b > 200000000;
has_keyword (media: $m, keyword: $k);
$k has keyword_name $kn;
reduce $count = count($m) groupby $k;
sort $count desc;
limit 3;
fetch { ""keyword"": $k.keyword_name, ""frequency"": $count };"
811,Which 3 production companies have produced movies with the highest average popularity?,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 3
RETURN pc.name AS ProductionCompany, avg_popularity AS AveragePopularity","match
$pc isa production_company;
$m isa movie, has popularity $pop;
produced_by (media: $m, producer: $pc);
reduce $avg_pop = mean($pop) groupby $pc;
sort $avg_pop desc;
limit 3;
fetch { ""ProductionCompany"": $pc.production_company_name, ""AveragePopularity"": $avg_pop };"
812,List the first 3 movies with the lowest revenue and released before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01')
RETURN m.title, m.revenue
ORDER BY m.revenue ASC
LIMIT 3","match
$m isa movie, has release_date $rd, has revenue $rev;
$rd < 1990-01-01T00:00:00;
sort $rev asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""revenue"": $rev
};"
813,What are the top 5 most popular genres based on average movie popularity?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.popularity) AS avg_popularity
RETURN g.name AS genre, avg_popularity
ORDER BY avg_popularity DESC
LIMIT 5","match
$m isa movie, has popularity $pop;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $avg_pop = mean($pop) groupby $g;
sort $avg_pop desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""avg_popularity"": $avg_pop
};"
814,Who are the first 3 actors to star in movies from both the horror and comedy genres?,"MATCH (horror:Genre {name: 'Horror'})<-[:IN_GENRE]-(horrorMovie:Movie)<-[:CAST_FOR]-(actor:Person)-[:CAST_FOR]->(comedyMovie:Movie)-[:IN_GENRE]->(comedy:Genre {name: 'Comedy'})
WITH actor, COUNT(DISTINCT horrorMovie) AS horrorCount, COUNT(DISTINCT comedyMovie) AS comedyCount
WHERE horrorCount > 0 AND comedyCount > 0
RETURN actor.name AS actorName
ORDER BY actorName
LIMIT 3","match
$actor isa person, has person_name $name;
$horror_movie isa movie;
$comedy_movie isa movie;
$horror isa genre, has genre_name ""Horror"";
$comedy isa genre, has genre_name ""Comedy"";
cast_for (actor: $actor, film: $horror_movie);
in_genre (media: $horror_movie, genre: $horror);
cast_for (actor: $actor, film: $comedy_movie);
in_genre (media: $comedy_movie, genre: $comedy);
sort $name asc;
limit 3;
fetch {
  ""actorName"": $name
};"
815,List the first 3 genres of movies with the highest average vote count.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.vote_count) AS avg_vote_count
RETURN g.name AS genre, avg_vote_count
ORDER BY avg_vote_count DESC
LIMIT 3","match
$m isa movie, has vote_count $vc;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $avg_vote_count = mean($vc) groupby $g;
sort $avg_vote_count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""avg_vote_count"": $avg_vote_count
};"
816,What are the first 3 subscriptions that are about to expire?,"MATCH (s:Subscription)
WITH s
ORDER BY s.expiresAt ASC
LIMIT 3
RETURN s.id, s.expiresAt","match
$s isa subscription, has subscription_id $id, has expires_at $ea;
sort $ea asc;
limit 3;
fetch {
  ""id"": $id,
  ""expiresAt"": $ea
};"
817,List the first 3 actors with roles in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
MATCH (p)-[:CAST_FOR]->(v:Video)
RETURN DISTINCT p.name AS actor_name
LIMIT 3","match
$p isa person;
$m isa movie;
$v isa video;
cast_for (actor: $p, film: $m);
cast_for (actor: $p, film: $v);
select $p;
distinct;
limit 3;
fetch {
  ""actor_name"": $p.person_name
};"
818,Which 3 packages have the highest price?,"MATCH (p:Package)
RETURN p.name, p.price
ORDER BY p.price DESC
LIMIT 3","match
$p isa package, has package_price $price;
sort $price desc;
limit 3;
fetch {
  ""name"": $p.package_name,
  ""price"": $price
};"
819,List the first 3 movies that were part of more than one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, COUNT(c) AS collectionCount
WHERE collectionCount > 1
RETURN m.title AS MovieTitle, collectionCount
ORDER BY collectionCount DESC
LIMIT 3","match
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $collectionCount = count($c) groupby $m;
match
$collectionCount > 1;
sort $collectionCount desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""collectionCount"": $collectionCount
};"
820,Which 3 movies have the most significant number of cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, count(p) AS cast_count
ORDER BY cast_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, cast_count AS NumberOfCastMembers","match
$m isa movie;
$p isa person;
cast_for (actor: $p, film: $m);
reduce $cast_count = count($p) groupby $m;
sort $cast_count desc;
limit 3;
fetch { ""MovieTitle"": $m.title, ""NumberOfCastMembers"": $cast_count };"
821,What are the top 5 videos by vote count?,"MATCH (v:Video)
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 5","match
$v isa video, has title $t, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
822,List the first 3 movies that have been both highly rated and have high revenue.,"MATCH (m:Movie)
WHERE m.vote_count > 1000 AND m.revenue > 1.0E8
RETURN m.title, m.average_vote, m.revenue
ORDER BY m.average_vote DESC, m.revenue DESC
LIMIT 3","match
$m isa movie,
  has vote_count $vc,
  has revenue $rev,
  has average_vote $av;
$vc > 1000;
$rev > 100000000.0;
sort $av desc, $rev desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av,
  ""revenue"": $rev
};"
823,Which 3 people have the highest number of crew credits in movies?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie)
WITH p, COUNT(*) AS crew_credits
ORDER BY crew_credits DESC
LIMIT 3
RETURN p.name AS person_name, crew_credits","match
$p isa person;
$m isa movie;
crew_for (crew_member: $p, film: $m);
reduce $crew_credits = count($m) groupby $p;
sort $crew_credits desc;
limit 3;
fetch { ""person_name"": $p.person_name, ""crew_credits"": $crew_credits };"
824,What are the top 5 adult films by vote count?,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
$a isa adult_video, has title $t, has vote_count $vc;
sort $vc desc;
limit 5;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
825,List the first 3 adult films that have been produced in the 'United States of America'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN a.title AS Title, a.release_date AS ReleaseDate
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has title $t, has release_date $rd;
produced_in_country (media: $a, country: $c);
$c isa country, has country_name ""United States of America"";
sort $rd asc;
limit 3;
fetch {
  ""Title"": $t,
  ""ReleaseDate"": $rd
};"
826,Which 3 genres are most popular according to the popularity scores in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g.name AS genre, SUM(m.popularity) AS total_popularity
RETURN genre, total_popularity
ORDER BY total_popularity DESC
LIMIT 3","match
$m isa movie, has popularity $pop;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $total = sum($pop) groupby $gn;
sort $total desc;
limit 3;
fetch { ""genre"": $gn, ""total_popularity"": $total };"
827,What are the top 5 languages used in the original language of adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(a) AS count
ORDER BY count DESC
LIMIT 5","match
$a isa adult_video;
original_language (media: $a, language: $l);
$l has language_name $ln;
reduce $count = count($a) groupby $l;
sort $count desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""count"": $count
};"
828,List the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget over $100 million.,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
RETURN m.title AS MovieTitle, m.budget AS Budget
ORDER BY m.budget DESC
LIMIT 3","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie, has budget $b;
produced_by (media: $m, producer: $p);
$b > 100000000;
sort $b desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""Budget"": $b
};"
830,What are the top 5 most popular genres based on movie data?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g.name AS genre, SUM(m.popularity) AS total_popularity
ORDER BY total_popularity DESC
LIMIT 5
RETURN genre, total_popularity","match
$m isa movie, has popularity $pop;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $total_popularity = sum($pop) groupby $gn;
sort $total_popularity desc;
limit 5;
fetch { ""genre"": $gn, ""total_popularity"": $total_popularity };"
831,List the first 3 adult films with a runtime longer than 60 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 60
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
$a isa adult_video, has runtime $r, has title $t;
$r > 60;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
832,Which 3 movies have the highest number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, COUNT(l) AS language_count
ORDER BY language_count DESC
LIMIT 3
RETURN m.title AS movie_title, language_count","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $lang_count = count($l) groupby $m;
sort $lang_count desc;
limit 3;
fetch { ""movie_title"": $m.title, ""language_count"": $lang_count };"
833,What are the top 5 longest running movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
834,List the first 3 videos with no budget reported.,"MATCH (v:Video)
WHERE v.budget IS NULL
RETURN v.title, v.release_date, v.imdb_id
LIMIT 3","match
$v isa video;
not { $v has budget $b; };
limit 3;
fetch {
  ""title"": $v.title,
  ""release_date"": $v.release_date,
  ""imdb_id"": $v.imdb_id
};"
835,Which 3 movies have the highest number of production companies associated?,"MATCH (m:Movie)-[:PRODUCED_BY]->(pc:ProductionCompany)
WITH m, COUNT(pc) AS productionCompanyCount
ORDER BY productionCompanyCount DESC
LIMIT 3
RETURN m.title AS movieTitle, productionCompanyCount","match
$m isa movie;
$pc isa production_company;
produced_by (media: $m, producer: $pc);
reduce $count = count($pc) groupby $m;
sort $count desc;
limit 3;
fetch { ""movieTitle"": $m.title, ""productionCompanyCount"": $count };"
836,What are the top 5 genres associated with the highest average votes in videos?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g.name AS genre, avg(v.average_vote) AS avg_vote
RETURN genre, avg_vote
ORDER BY avg_vote DESC
LIMIT 5","match
$v isa video, has average_vote $av;
$g isa genre, has genre_name $gn;
in_genre (media: $v, genre: $g);
reduce $avg_vote = mean($av) groupby $gn;
sort $avg_vote desc;
limit 5;
fetch { ""genre"": $gn, ""avg_vote"": $avg_vote };"
837,List the first 3 packages that provide access to the 'Drama' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p.name
LIMIT 3","match
$p isa package;
$g isa genre, has genre_name ""Drama"";
provides_access_to (package: $p, genre: $g);
limit 3;
fetch {
  ""name"": $p.package_name
};"
838,Which 3 countries have produced the most videos?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
WITH c, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 3
RETURN c.name AS country, video_count","match
$c isa country;
$v isa video;
produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""video_count"": $count
};"
839,What are the top 5 most popular packages based on duration?,"MATCH (p:Package)
RETURN p.name, p.duration
ORDER BY p.duration DESC
LIMIT 5","match
$p isa package, has package_name $name, has package_duration $duration;
sort $duration desc;
limit 5;
fetch {
  ""name"": $name,
  ""duration"": $duration
};"
840,List the first 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.title
LIMIT 3","match
$m isa movie, has title $t, has homepage $h;
sort $t asc;
limit 3;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
841,Which 3 adult films have been rated by the most users?,"MATCH (a:Adult)<-[:RATED]-(u:User)
WITH a, COUNT(u) AS userCount
ORDER BY userCount DESC
LIMIT 3
RETURN a.title AS Title, userCount AS NumberOfRatings","match
$a isa adult_video;
$u isa user;
rated (reviewer: $u, rated_media: $a);
reduce $count = count($u) groupby $a;
sort $count desc;
limit 3;
fetch { ""Title"": $a.title, ""NumberOfRatings"": $count };"
842,What are the top 5 most frequently spoken languages in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 5","match
$v isa video;
$l isa language, has language_name $name;
spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l;
sort $count desc;
limit 5;
fetch {
  ""language"": $l.language_name,
  ""video_count"": $count
};"
843,List the first 3 videos that have been produced in more than one country.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, COUNT(c) AS countryCount
WHERE countryCount > 1
RETURN v.title AS VideoTitle, countryCount
ORDER BY countryCount DESC
LIMIT 3","match
$v isa video;
$c isa country;
produced_in_country (media: $v, country: $c);
reduce $countryCount = count($c) groupby $v;
match $countryCount > 1;
sort $countryCount desc;
limit 3;
fetch { ""VideoTitle"": $v.title, ""countryCount"": $countryCount };"
844,What are the top 5 movies with the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 5
RETURN m.title AS MovieTitle, keyword_count AS KeywordCount","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 5;
fetch { ""MovieTitle"": $t, ""KeywordCount"": $count };"
845,List the top 5 packages by the duration they provide access.,"MATCH (p:Package)
RETURN p.name, p.duration
ORDER BY p.duration DESC
LIMIT 5","match
$p isa package, has package_name $name, has package_duration $dur;
sort $dur desc;
limit 5;
fetch {
  ""name"": $name,
  ""duration"": $dur
};"
846,List the first 3 movies directed by a person named 'John Doe'.,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate
ORDER BY m.release_date
LIMIT 3","match
$p isa person, has person_name ""John Doe"";
$rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$m isa movie, has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $rd
};"
847,Which 3 movies have the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, (m.revenue - m.budget) AS profit_difference
ORDER BY profit_difference DESC
LIMIT 3","match
$m isa movie,
    has title $title,
    has budget $b,
    has revenue $r;
let $diff = $r - $b;
sort $diff desc;
limit 3;
fetch {
    ""title"": $title,
    ""budget"": $b,
    ""revenue"": $r,
    ""profit_difference"": $diff
};"
848,List the first 3 movies that were rated exactly 5 stars by any user.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0
RETURN m.title AS MovieTitle, r.rating AS Rating
ORDER BY r.timestamp
LIMIT 3","match
$u isa user;
$m isa movie;
$r isa rated (reviewer: $u, rated_media: $m);
$r has rating $rating;
$rating == 5.0;
$r has timestamp $ts;
sort $ts;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""Rating"": $rating
};"
849,Which 3 people have acted in the most number of videos?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video)
WITH p, COUNT(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3
RETURN p.name AS personName, videoCount","match
$p isa person, has person_name $name;
$v isa video;
cast_for (actor: $p, film: $v);
reduce $count = count($v) groupby $p, $name;
sort $count desc;
limit 3;
fetch { ""personName"": $name, ""videoCount"": $count };"
850,What are the top 5 movies with the smallest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime ASC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r asc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
851,List the first 3 genres that have movies with no keywords associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE NOT (m)-[:HAS_KEYWORD]->(:Keyword)
RETURN DISTINCT g.name
LIMIT 3","match
$g isa genre, has genre_name $gn;
$m isa movie;
in_genre (media: $m, genre: $g);
not { has_keyword (media: $m); };
select $gn;
distinct;
limit 3;
fetch { ""genre_name"": $gn };"
852,Which 3 production companies have produced movies in more than 3 different languages?,"MATCH (pc:ProductionCompany)-[:PRODUCED_BY]->(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH pc, count(DISTINCT l) AS languageCount
WHERE languageCount > 3
RETURN pc.name AS ProductionCompany, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
$pc isa production_company, has production_company_name $name;
$m isa movie;
produced_by (media: $m, producer: $pc);
spoken_in_language (media: $m, language: $l);
select $pc, $name, $l;
distinct;
reduce $lang_count = count($l) groupby $pc, $name;
match $lang_count > 3;
sort $lang_count desc;
limit 3;
fetch { ""ProductionCompany"": $name, ""languageCount"": $lang_count };"
853,What are the top 5 most frequently used keywords in adult films?,"MATCH (:Adult)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
$a isa adult_video;
has_keyword (media: $a, keyword: $k);
$k has keyword_name $name;
reduce $frequency = count($a) groupby $k;
sort $frequency desc;
limit 5;
fetch { ""keyword"": $k.keyword_name, ""frequency"": $frequency };"
854,List the first 3 adult films that have a revenue of 0.,"MATCH (a:Adult)
WHERE a.revenue = 0
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
$a isa adult_video, has revenue $r, has release_date $rd;
$r == 0.0;
sort $rd asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""release_date"": $rd
};"
855,What are the top 5 movies by revenue?,"MATCH (m:Movie)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $r
};"
856,Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN v.title AS video_title, keyword_count","match
$v isa video, has title $t;
has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v, $t;
sort $count desc;
limit 3;
fetch { ""video_title"": $t, ""keyword_count"": $count };"
857,List the first 3 movies in which 'Tom Hanks' has acted.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie, has release_date $rd;
cast_for (actor: $p, film: $m);
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title
};"
858,Which 3 genres are most common among movies released before 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.release_date < date('2000-01-01')
RETURN g.name AS genre, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$m isa movie, has release_date $rd;
$rd < 2000-01-01T00:00:00;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""movie_count"": $count
};"
859,What are the top 5 most popular adult films?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
$a isa adult_video, has popularity $pop;
sort $pop desc;
limit 5;
fetch {
  ""title"": $a.title,
  ""popularity"": $pop
};"
860,List the first 3 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3","match
$v isa video, has title ""Jonah: A VeggieTales Movie"";
has_keyword (media: $v, keyword: $k);
limit 3;
fetch { ""name"": $k.keyword_name };"
861,Which 3 movies have been rated highest by users?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN m.title, AVG(r.rating) AS average_rating
ORDER BY average_rating DESC
LIMIT 3","match
$m isa movie;
$u isa user;
$rel isa rated (reviewer: $u, rated_media: $m), has rating $r;
reduce $avg = mean($r) groupby $m;
sort $avg desc;
limit 3;
fetch { ""title"": $m.title, ""average_rating"": $avg };"
862,What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date ASC
LIMIT 5","match
$m isa movie, has title $t, has release_date $rd;
sort $rd asc;
limit 5;
fetch {
  ""title"": $t,
  ""release_date"": $rd
};"
863,List the first 3 movies with taglines containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title, m.tagline
ORDER BY m.title
LIMIT 3","match
$m isa movie, has tagline $tg, has title $t;
$tg like "".*adventure.*"";
sort $t;
limit 3;
fetch {
  ""title"": $m.title,
  ""tagline"": $m.tagline
};"
864,Which 3 adult films have the lowest average vote?,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote ASC
LIMIT 3","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av asc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
865,List the first 3 countries that have produced the most adult films.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
WITH c, COUNT(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN c.name AS country, num_adult_films","match
$c isa country, has country_name $cn;
$a isa adult_video;
produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""num_adult_films"": $count };"
866,Which 3 genres have the highest average votes in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g.name AS genre, avg(m.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 3
RETURN genre, avg_vote","match
$m isa movie, has average_vote $av;
$g isa genre, has genre_name $gn;
in_genre (media: $m, genre: $g);
reduce $avg_vote = mean($av) groupby $g;
sort $avg_vote desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""avg_vote"": $avg_vote
};"
867,What are the top 5 countries by the number of videos produced there?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH c.name AS country, COUNT(v) AS video_count
ORDER BY video_count DESC
LIMIT 5
RETURN country, video_count","match
$v isa video;
produced_in_country (media: $v, country: $c);
$c has country_name $name;
reduce $count = count($v) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""country"": $name, ""video_count"": $count };"
868,List the first 3 movies where the budget was over 50 million USD.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has budget $b;
$b > 50000000;
sort $b desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""budget"": $b
};"
869,Who are the first 3 actors in the cast list of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})&lt;-[:CAST_FOR]-(p:Person)
RETURN p.name, p.id, p.profile_path
ORDER BY p.cast_id
LIMIT 3","match
$m isa movie, has title ""Toy Story"";
$rel isa cast_for (actor: $p, film: $m), has cast_id $cid;
$p has person_name $name, has person_id $pid, has profile_path $pp;
sort $cid;
limit 3;
fetch {
  ""name"": $name,
  ""id"": $pid,
  ""profile_path"": $pp
};"
870,Find the top 3 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has runtime $r, has title $t;
$r > 120;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
871,List the first 3 movies that have a 'status' of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has status ""In Production"", has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
872,What are the top 5 movies that have a genre of 'Comedy' and are rated above 6?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
WHERE m.average_vote > 6
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has title $t, has average_vote $av;
$g isa genre, has genre_name ""Comedy"";
in_genre (media: $m, genre: $g);
$av > 6.0;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
873,List the first 3 videos that have a poster path ending in '.jpg'.,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH '.jpg'
RETURN v.title, v.poster_path
LIMIT 3","match
$v isa video, has poster_path $pp;
$pp like "".*\\.jpg"";
limit 3;
fetch {
  ""title"": $v.title,
  ""poster_path"": $pp
};"
874,Which 5 videos have the highest average vote and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 5","match
$v isa video, has status ""Released"", has average_vote $av, has title $t;
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
875,List the first 3 videos with a budget greater than 100000 USD.,"MATCH (v:Video)
WHERE v.budget > 100000
RETURN v.title, v.budget
ORDER BY v.budget DESC
LIMIT 3","match
$v isa video, has budget $b, has title $t;
$b > 100000;
sort $b desc;
limit 3;
fetch {
  ""title"": $t,
  ""budget"": $b
};"
876,What are the top 5 videos produced in 'United States of America'?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
$v isa video, has title $t, has popularity $pop;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $v, country: $c);
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
877,List the top 3 videos that have the most votes.,"MATCH (v:Video)
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 3","match
$v isa video, has title $title, has vote_count $vc;
sort $vc desc;
limit 3;
fetch {
  ""title"": $title,
  ""vote_count"": $vc
};"
878,Which 3 videos have the longest runtime and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3","match
$v isa video, has status ""Released"", has runtime $r, has title $t;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
879,List the first 5 videos that have been translated into the language 'Azrbaycan'.,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Azrbaycan'})
RETURN v.title AS VideoTitle, v.release_date AS ReleaseDate
ORDER BY v.release_date
LIMIT 5","match
$v isa video, has title $t, has release_date $rd;
$l isa language, has language_name ""Azrbaycan"";
spoken_in_language (media: $v, language: $l);
sort $rd;
limit 5;
fetch {
  ""VideoTitle"": $t,
  ""ReleaseDate"": $rd
};"
880,What are the first 3 videos with a 'status' of 'In Production'?,"MATCH (v:Video {status: 'In Production'})
RETURN v.title, v.release_date, v.status
ORDER BY v.release_date
LIMIT 3","match
$v isa video, has status ""In Production"", has release_date $rd;
sort $rd asc;
limit 3;
fetch {
  ""title"": $v.title,
  ""release_date"": $rd,
  ""status"": $v.status
};"
881,List the top 5 videos that have a genre of 'Horror' and are rated above 5.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
MATCH (u:User)-[r:RATED]->(v)
WHERE r.rating > 5
RETURN v.title, v.average_vote, v.release_date
ORDER BY v.average_vote DESC
LIMIT 5","match
$v isa video;
$g isa genre, has genre_name ""Horror"";
in_genre (media: $v, genre: $g);
$rel isa rated (reviewer: $u, rated_media: $v);
$rel has rating $r;
$r > 5.0;
$v has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $v.title,
  ""average_vote"": $av,
  ""release_date"": $v.release_date
};"
882,Which 3 adult films have the highest average vote?,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
$a isa adult_video, has title $t, has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
883,List the first 3 adult films with a budget less than 50000 USD.,"MATCH (a:Adult)
WHERE a.budget < 50000
RETURN a.title, a.budget
ORDER BY a.budget ASC
LIMIT 3","match
$a isa adult_video, has budget $b;
$b < 50000;
sort $b asc;
limit 3;
fetch {
  ""title"": $a.title,
  ""budget"": $b
};"
884,What are the top 5 adult films produced in 'Italy'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'Italy'})
RETURN a.title AS Title, a.average_vote AS AverageVote
ORDER BY a.average_vote DESC
LIMIT 5","match
$a isa adult_video, has title $t, has average_vote $av;
$c isa country, has country_name ""Italy"";
produced_in_country (media: $a, country: $c);
sort $av desc;
limit 5;
fetch {
  ""Title"": $t,
  ""AverageVote"": $av
};"
885,Which 3 adult films have the longest runtime and are in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
$a isa adult_video, has status ""Released"", has runtime $r, has title $t;
sort $r desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $r
};"
886,List the first 5 adult films that have a homepage URL.,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title, a.homepage
LIMIT 5","match
$a isa adult_video, has homepage $h, has title $t;
limit 5;
fetch {
  ""title"": $t,
  ""homepage"": $h
};"
887,What are the top 3 genres that have the most movies associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, count(m) as movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN g.name as Genre, movieCount","match
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name $gn;
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""Genre"": $gn, ""movieCount"": $count };"
888,List the first 3 production companies that have produced the most movies.,"MATCH (pc:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH pc, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN pc.name AS production_company, movie_count","match
$pc isa production_company;
$m isa movie;
produced_by (media: $m, producer: $pc);
reduce $count = count($m) groupby $pc;
sort $count desc;
limit 3;
fetch { ""production_company"": $pc.production_company_name, ""movie_count"": $count };"
889,Which 3 countries have the most movies produced in them?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
$c isa country;
$m isa movie;
produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c.country_name, ""movie_count"": $count };"
890,List the first 5 languages that are most frequently used as the original language in movies.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH l.name AS language, COUNT(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5
RETURN language, movie_count","match
$m isa movie;
original_language (media: $m, language: $l);
$l has language_name $ln;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch {
  ""language"": $ln,
  ""movie_count"": $count
};"
891,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS collection_name, movie_count","match
$c isa collection;
$m isa movie;
in_collection (media: $m, collection: $c);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""collection_name"": $c.collection_name, ""movie_count"": $count };"
892,List the first 3 genres that are most frequently targeted by packages.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
WITH g, count(p) AS packageCount
ORDER BY packageCount DESC
LIMIT 3
RETURN g.name AS genre, packageCount","match
$g isa genre;
$p isa package;
provides_access_to (package: $p, genre: $g);
reduce $packageCount = count($p) groupby $g;
sort $packageCount desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""packageCount"": $packageCount };"
893,Which 5 movies have the highest average vote and have been released?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$m isa movie, has status ""Released"", has average_vote $av;
sort $av desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
894,Which 3 movies have been rated 5.0 by users and have a 'Released' status?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating = 5.0 AND m.status = 'Released'
RETURN m.title AS MovieTitle, m.release_date AS ReleaseDate, m.average_vote AS AverageVote
ORDER BY m.average_vote DESC
LIMIT 3","match
$u isa user;
$m isa movie, has status ""Released"";
$r isa rated (reviewer: $u, rated_media: $m), has rating 5.0;
$m has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""MovieTitle"": $m.title,
  ""ReleaseDate"": $m.release_date,
  ""AverageVote"": $av
};"
895,List the top 3 movies that were produced by 'Pixar Animation Studios' and have a runtime longer than 90 minutes.,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 90
RETURN m.title, m.runtime
ORDER BY m.average_vote DESC
LIMIT 3","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie, has runtime $rt;
produced_by (media: $m, producer: $p);
$rt > 90.0;
$m has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""runtime"": $rt
};"
896,List the top 3 adult films that have been tagged with the keyword 'jealousy'.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
$a isa adult_video, has title $title, has average_vote $av;
$k isa keyword, has keyword_name ""jealousy"";
has_keyword (media: $a, keyword: $k);
sort $av desc;
limit 3;
fetch {
  ""title"": $title,
  ""average_vote"": $av
};"
897,List the top 3 movies with the tagline 'What price would you put on your health?',"MATCH (m:Movie)
WHERE m.tagline = 'What price would you put on your health?'
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has tagline ""What price would you put on your health?"", has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""average_vote"": $av
};"
898,List the top 3 movies that were released before the year 2000 and have an 'original_language' of 'en'.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE m.release_date < date('2000-01-01') AND l.id = 'en'
RETURN m.title, m.release_date, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has release_date $rd;
$l isa language, has language_id ""en"";
original_language (media: $m, language: $l);
$rd < 2000-01-01T00:00:00;
$m has average_vote $av;
sort $av desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd,
  ""average_vote"": $av
};"
899,What are the first 5 most popular movies with a popularity score above 20?,"MATCH (m:Movie)
WHERE m.popularity > 20
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has popularity $pop, has title $t;
$pop > 20;
sort $pop desc;
limit 5;
fetch {
  ""title"": $t,
  ""popularity"": $pop
};"
900,What are the first 5 movies that have a main character named 'Charlie Wilson'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Charlie Wilson'
RETURN m.title AS MovieTitle
ORDER BY r.order
LIMIT 5","match
$p isa person;
$m isa movie;
$r isa cast_for (actor: $p, film: $m);
$r has character ""Charlie Wilson"";
$r has cast_order $order;
sort $order asc;
limit 5;
fetch {
  ""MovieTitle"": $m.title
};"
901,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, COUNT(k) AS keyword_count
ORDER BY keyword_count DESC
LIMIT 3
RETURN m.title AS MovieTitle, keyword_count","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""MovieTitle"": $t, ""keyword_count"": $count };"
902,List the first 3 movies with the highest number of votes.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
$m isa movie, has vote_count $vc, has title $t;
sort $vc desc;
limit 3;
fetch {
  ""title"": $t,
  ""vote_count"": $vc
};"
903,What are the top 5 movies with the lowest revenue and are still in 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.revenue
ORDER BY m.revenue ASC
LIMIT 5","match
$m isa movie, has status ""Released"", has revenue $rev, has title $t;
sort $rev asc;
limit 5;
fetch {
  ""title"": $t,
  ""revenue"": $rev
};"
904,List the top 3 movies with the largest budgets that have been released.,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has status ""Released"", has title $title, has budget $budget;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget
};"
905,What are the first 5 movies that are part of a collection and have a budget greater than 10000000?,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.budget > 10000000
RETURN m.title, m.budget, m.release_date
ORDER BY m.release_date
LIMIT 5","match
$m isa movie, has budget $b, has release_date $rd;
in_collection (media: $m, collection: $c);
$b > 10000000;
sort $rd asc;
limit 5;
fetch {
  ""title"": $m.title,
  ""budget"": $b,
  ""release_date"": $rd
};"
906,Which 3 movies have the highest popularity but the lowest revenue?,"MATCH (m:Movie)
WITH m
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3
RETURN m.title AS Title, m.popularity AS Popularity, m.revenue AS Revenue","match
$m isa movie, has popularity $pop, has revenue $rev, has title $t;
sort $pop desc, $rev asc;
limit 3;
fetch {
  ""Title"": $t,
  ""Popularity"": $pop,
  ""Revenue"": $rev
};"
907,List the top 3 movies which are in the genre 'Animation' and have been released.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
WHERE m.status = 'Released'
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has title $t, has status ""Released"", has popularity $pop;
$g isa genre, has genre_name ""Animation"";
in_genre (media: $m, genre: $g);
$m has release_date $rd;
sort $pop desc;
limit 3;
fetch {
  ""title"": $t,
  ""release_date"": $rd,
  ""popularity"": $pop
};"
908,What are the first 5 movies directed by a specific director named 'John Doe'?,"MATCH (director:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(movie:Movie)
RETURN movie.title AS MovieTitle, movie.release_date AS ReleaseDate
ORDER BY movie.release_date
LIMIT 5","match
$director isa person, has person_name ""John Doe"";
$movie isa movie, has title $t, has release_date $rd;
$rel isa crew_for (crew_member: $director, film: $movie);
$rel has job ""Director"";
sort $rd asc;
limit 5;
fetch {
  ""MovieTitle"": $t,
  ""ReleaseDate"": $rd
};"
909,List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!',"MATCH (m:Movie)
WHERE m.tagline = 'Roll the dice and unleash the excitement!'
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has tagline ""Roll the dice and unleash the excitement!"", has release_date $rd;
sort $rd;
limit 3;
fetch {
  ""title"": $m.title
};"
910,Which 3 movies have the longest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has status ""Released"", has runtime $rt, has title $t;
sort $rt desc;
limit 3;
fetch {
  ""title"": $t,
  ""runtime"": $rt
};"
911,Find the top 3 movies with a specific actor named 'Tom Hanks' in the cast.,"MATCH (actor:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(movie:Movie)
RETURN movie.title, movie.average_vote
ORDER BY movie.average_vote DESC
LIMIT 3","match
$actor isa person, has person_name ""Tom Hanks"";
$movie isa movie, has average_vote $av;
cast_for (actor: $actor, film: $movie);
sort $av desc;
limit 3;
fetch {
  ""title"": $movie.title,
  ""average_vote"": $av
};"
912,Which 5 movies have been rated by the most users?,"MATCH (m:Movie)<-[:RATED]-(u:User)
WITH m, COUNT(u) AS userCount
ORDER BY userCount DESC
LIMIT 5
RETURN m.title AS MovieTitle, userCount AS NumberOfRatings","match
$m isa movie;
$rel isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($u) groupby $m;
sort $count desc;
limit 5;
fetch { ""MovieTitle"": $m.title, ""NumberOfRatings"": $count };"
913,List the first 3 movies that have an 'average_vote' greater than 8.,"MATCH (m:Movie)
WHERE m.average_vote > 8
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has average_vote $av, has title $t;
$av > 8;
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
914,List the top 3 movies where the homepage URL includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
$m isa movie, has homepage $h, has popularity $p;
$h like "".*disney.*"";
sort $p desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""homepage"": $h,
  ""popularity"": $p
};"
915,What are the first 5 movies in the 'Toy Story Collection'?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
$m isa movie, has release_date $rd;
sort $rd asc;
limit 5;
fetch {
  ""title"": $m.title
};"
916,Which 5 movies have the shortest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.runtime
ORDER BY m.runtime ASC
LIMIT 5","match
$m isa movie, has status ""Released"", has runtime $rt, has title $t;
sort $rt asc;
limit 5;
fetch {
  ""title"": $t,
  ""runtime"": $rt
};"
917,Which 3 movies have the most expensive poster paths registered?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.poster_path DESC
LIMIT 3","match
$m isa movie, has title $t, has poster_path $pp;
sort $pp desc;
limit 3;
fetch {
  ""title"": $t,
  ""poster_path"": $pp
};"
918,Which 3 movies are most commonly spoken in 'Gaeilge'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title, COUNT(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$m isa movie;
$l isa language, has language_name ""Gaeilge"";
$rel isa spoken_in_language (media: $m, language: $l);
reduce $frequency = count($rel) groupby $m;
sort $frequency desc;
limit 3;
fetch {
  ""title"": $m.title,
  ""frequency"": $frequency
};"
919,List the first 3 movies that have been translated into the language 'Kiswahili'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
$m isa movie, has title $t, has release_date $rd;
$l isa language, has language_name ""Kiswahili"";
spoken_in_language (media: $m, language: $l);
sort $rd asc;
limit 3;
fetch {
  ""title"": $t
};"
920,What are the top 5 movies that were produced by 'Pixar Animation Studios'?,"MATCH (p:ProductionCompany {name: 'Pixar Animation Studios'})&lt;-[:PRODUCED_BY]-(m:Movie)
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
$p isa production_company, has production_company_name ""Pixar Animation Studios"";
$m isa movie, has title $t, has average_vote $av;
produced_by (media: $m, producer: $p);
sort $av desc;
limit 5;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
921,List the top 3 movies that have been produced in the country 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
$m isa movie, has title $t, has average_vote $av;
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
sort $av desc;
limit 3;
fetch {
  ""title"": $t,
  ""average_vote"": $av
};"
922,What are the top 5 movies with a release date on or after '2000-01-01'?,"MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01')
RETURN m.title, m.release_date
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has release_date $rd, has popularity $pop;
$rd >= 2000-01-01;
sort $pop desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""release_date"": $rd
};"
