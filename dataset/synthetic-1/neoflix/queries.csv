original_index,question,cypher,typeql
1,List the first 3 movies with a budget over 50 million.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 50000000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
2,What are the top 5 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
3,Name 3 movies directed by Pixar Animation Studios.,"MATCH (m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
4,Which movies have a runtime longer than 100 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 100
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 100;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
5,List the first 3 movies in the Toy Story Collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 3;
fetch {
  ""title"": $title_m
};"
6,What are the top 5 highest revenue-generating movies?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
8,Name 3 movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
9,Which movies are categorized under the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
10,What are the latest 3 movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
11,List the first 3 movies with a tagline containing the word 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*excitement.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
12,Which movies have been produced in the United States of America?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title","match
  $m isa movie;
  $c isa country, has country_name 'United States of America';
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
13,What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
14,Name 3 movies that have been translated into Kiswahili.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
15,Which movies feature the original language as 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_id 'en';
  $rel0 isa original_language (media: $m, language: $l);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
16,List the first 3 movies where Tom Hanks acted as a cast member.,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
17,Which movies are part of a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $c has backdrop_path $backdrop_path_c;
  $backdrop_path_c == ""/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg"";
fetch {
  ""title"": $title_m
};"
18,What are the top 5 movies with the most votes?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
19,Name 3 movies with a release date after 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
20,Which movies have a homepage URL specified?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
22,Which movies are associated with the production company 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
23,What are the 3 most recent movies with a status of 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $m has release_date $release_date;
  $status == ""Released"";
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
24,Name 3 movies that Tom Hanks has a credit in as a crew member.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CREW_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
25,Which movies have a revenue greater than 300 million?,"MATCH (m:Movie)
WHERE m.revenue > 300000000
RETURN m.title, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $revenue > 300000000;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
26,List the first 3 movies with an average vote less than 5.,"MATCH (m:Movie)
WHERE m.average_vote < 5
RETURN m.title, m.average_vote
ORDER BY m.average_vote
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote < 5;
sort $average_vote asc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
27,Which movies have a runtime less than 85 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 85
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime < 85;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
28,What are the top 5 movies by budget size?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
30,Which movies have been rated by at least 100 users?,"MATCH (m:Movie)
WHERE m.vote_count >= 100
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count >= 100;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
33,What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
34,Name 3 movies that have been keyword-tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'based on novel';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
35,Which movies have a tagline that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*love.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
36,List the first 3 movies that have a vote count greater than 500.,"MATCH (m:Movie)
WHERE m.vote_count > 500
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 500;
limit 3;
fetch {
  ""title"": $title
};"
37,What are the top 5 movies with the lowest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
38,Name 3 movies with a budget of exactly 30 million.,"MATCH (m:Movie)
WHERE m.budget = 30000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $budget == 30000000;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""budget"": $budget };"
39,Which movies feature music by a person named 'John Williams' as a crew member?,"MATCH (p:Person {name: 'John Williams'})-[:CREW_FOR]->(m:Movie)
WHERE p.name IS NOT NULL
RETURN m.title","match
  $p isa person, has person_name 'John Williams';
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $p has person_name $person_name_p;
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
40,List the top 5 movies by revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
41,Which movies have a budget greater than 50 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 50000000;
fetch {
  ""title"": $title, ""budget"": $budget
};"
42,Find all movies produced by Pixar Animation Studios.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
43,What are the top 3 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
44,Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
45,Display the top 5 longest movies by runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
46,Which movies are part of the Toy Story Collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
47,List all movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
48,Which movies are released in the 'Animation' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
49,Which movies have a runtime longer than 120 minutes and are categorized under the 'Drama' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
  $m isa movie;
  $g isa genre, has genre_name 'Drama';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $runtime_m > 120;
fetch {
  ""title"": $title_m, ""runtime"": $runtime_m
};"
51,List the top 5 movies that have a poster path available.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
52,Which movies feature 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
54,Which movies have been rated exactly 5.0 by any user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title","match
  $m isa movie;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating == 5.0;
  $m has title $title;
fetch { ""title"": $title, ""rating"": $rating };"
56,List the top 3 movies with the most revenue that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""revenue"": $revenue };"
57,Which movies have a homepage listed in their properties?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
58,Find all movies where the original language is 'en' and have a tagline included.,"MATCH (m:Movie)
WHERE m.original_language = 'en' AND m.tagline IS NOT NULL
RETURN m","match
$m isa movie, has tagline $tagline;
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
fetch {
  ""movie"": $m.title
};"
60,List the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
64,List all movies where the overview mentions 'adventure'.,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m.title, m.overview","match
  $m isa movie;
  $m has overview $overview;
  $m has title $title;
  $overview like "".*adventure.*"";
fetch {
  ""title"": $title, ""overview"": $overview
};"
65,Which movies have a status of 'Released' and a vote count of over 1000?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.vote_count > 1000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has status $status;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 1000;
  $status == ""Released"";
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
68,Which movies have a budget less than 10 million but a revenue greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue","match
  $m isa movie;
  $m has budget $budget;
  $m has revenue $revenue;
  $m has title $title;
  $budget < 10000000;
  $revenue > 100000000;
fetch {
  ""title"": $title, ""budget"": $budget, ""revenue"": $revenue
};"
69,"Display movies that have been rated after January 1, 2015.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= date('2015-01-01')
RETURN m.title AS movie, r.rating AS rating, r.timestamp AS rated_at","match
  $m isa movie;
  $m has release_date $rd;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has timestamp $ts, has rating $rating;
  $m has title $title;
  $ts >= 2015-01-01;
fetch { ""title"": $title, ""release_date"": $rd, ""rating"": $rating, ""timestamp"": $ts };"
71,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
72,Which movies are associated with the keyword 'space'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'space';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
73,Display the top 5 movies that were most recently released.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
74,Find all movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m","match
  $m isa movie, has title $title;
  $m has runtime $rt;
  $rt == 90;
limit 50;
fetch { ""title"": $title, ""runtime"": $rt };"
75,Which movies have Tom Hanks credited as a producer?,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CREW_FOR {job: 'Producer'}]->(m:Movie)
RETURN m.title","match $p isa person, has person_name 'Tom Hanks'; $m isa movie; $r isa crew_for (crew_member: $p, film: $m), has job ""Producer""; $m has title $title_m; fetch { ""title"": $title_m };"
76,List all genres that have been accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre","match
  $p isa package, has package_name 'Ultimate';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
77,Display the top 3 movies with the least popularity.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity asc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
78,Which movies have a cast member who has also worked in the crew of the same movie?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)-[:CREW_FOR]->(m)
RETURN m.title AS movie, p.name AS person","match
  $m isa movie;
  $p isa person;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel1 isa cast_for (film: $m, actor: $p);
  $m has title $title_m;
  $p has person_name $person_name_p;
fetch {
  ""movie"": $title_m, ""person"": $person_name_p
};"
82,Display the top 5 movies with the lowest average vote.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote asc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
83,Which movies are associated with a collection that has a poster path?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.poster_path IS NOT NULL
RETURN m.title, c.name, c.poster_path","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $c has poster_path $poster_path_c;
  $c has collection_name $collection_name_c;
fetch {
  ""title"": $title_m, ""name"": $collection_name_c, ""poster_path"": $poster_path_c
};"
86,Display movies that have a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m.title, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
fetch { ""title"": $title, ""revenue"": $revenue };"
87,Find all adult movies that have been released.,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.release_date","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $a has release_date $release_date;
  $status == ""Released"";
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
88,List the top 3 adult movies by average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
89,"Which adult movies have a budget greater than 500,000 dollars?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget > 500000;
fetch {
  ""title"": $title, ""budget"": $budget
};"
90,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
91,Which movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
92,List all the languages spoken in the movie 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
  $m isa movie, has title 'Jumanji';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
fetch {
  ""language"": $language_name_l
};"
93,What are the first 3 highest voted movies?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
94,Which movies were released after the year 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title, m.release_date","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has title $title;
fetch { ""title"": $title, ""release_date"": $rd };"
96,Which movies are associated with the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
97,Can you find movies that are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
98,What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
99,Which movies have 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
100,List all the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
101,Which production companies have produced movies with a budget over 50 million?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 50000000
RETURN DISTINCT c.name AS company","match $c isa production_company; $m isa movie; $c has production_company_name $production_company_name_c; $m has budget $budget_m; $budget_m > 50000000; fetch { ""company"": $production_company_name_c, ""name"": $production_company_name_c };"
102,What are the languages available for the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
  $m isa movie, has title 'Toy Story';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
fetch {
  ""language"": $language_name_l
};"
103,Which movies have a homepage listed?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
104,List the first 5 movies sorted by popularity in descending order.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
105,What are the original titles of movies that have been translated to Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'})
WHERE m.original_language <> 'es'
RETURN m.original_title","match
$m isa movie, has original_title $original_title;
spoken_in_language (media: $m, language: $spanish);
$spanish has language_name ""Spanish"";
original_language (media: $m, language: $orig_lang);
not { $orig_lang has language_id ""es""; };
fetch {
  ""original_title"": $original_title
};"
107,Which countries have produced movies with a revenue exceeding 200 million?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 200000000
RETURN DISTINCT c.name AS country","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has revenue $revenue_m;
  $c has country_name $country_name_c;
  $revenue_m > 200000000;
fetch {
  ""country"": $country_name_c, ""name"": $country_name_c
};"
109,Which movies feature the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
112,List all movies that have been produced in 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title","match
  $m isa movie;
  $c isa country, has country_name 'United States of America';
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
113,What are the first 3 oldest movies in the database?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
114,Which movies have the tagline 'Roll the dice and unleash the excitement!'?,"MATCH (m:Movie)
WHERE m.tagline = 'Roll the dice and unleash the excitement!'
RETURN m.title","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline == ""Roll the dice and unleash the excitement!"";
fetch {
  ""title"": $title
};"
115,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
117,Who are the first 3 actors in the cast list of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CAST_FOR]-(p:Person)
RETURN p.name
ORDER BY p.id
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $p isa person;
  $rel0 isa cast_for (film: $m, actor: $p);
  $p has person_name $person_name_p;
  $p has person_id $person_id_p;
sort $person_id_p asc;
limit 3;
fetch {
  ""name"": $person_name_p
};"
118,Who are the first 3 actors in the cast list of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CAST_FOR]-(p:Person)
RETURN p.name
ORDER BY p.id
LIMIT 3","match
  $m isa movie, has title ""Toy Story"";
  $c isa cast_for (actor: $p, film: $m), has cast_order $order;
  $p has person_name $name;
sort $order asc;
limit 3;
fetch { ""name"": $name };"
120,Which videos have a runtime less than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v.title, v.runtime","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 30;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
121,What are the top 5 most popular videos?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
122,Which videos have been produced by 'Pixar Animation Studios'?,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
fetch {
  ""title"": $title_v
};"
123,List all the keywords associated with the video 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $k isa keyword;
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $k has keyword_name $keyword_name_k;
fetch {
  ""keyword"": $keyword_name_k
};"
125,Which adult films have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title, a.runtime","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 90;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
127,What are the original languages of the top 5 highest rated adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH a, l
ORDER BY a.average_vote DESC
LIMIT 5
RETURN a.title AS movie, l.name AS language","match
  $a isa adult_video;
  $l isa language;
  $rel0 isa original_language (media: $a, language: $l);
  $a has title $title_a;
  $a has average_vote $average_vote_a;
  $l has language_name $language_name_l;
sort $average_vote_a desc;
limit 5;
fetch {
  ""movie"": $title_a, ""language"": $language_name_l
};"
128,Which adult films have been released after 2010?,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a.title, a.release_date","match
  $m isa adult_video;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has title $title;
fetch { ""title"": $title, ""release_date"": $rd };"
130,Which adult films are associated with the genre 'Horror'?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
RETURN a.title","match
  $a isa adult_video;
  $g isa genre, has genre_name 'Horror';
  $rel0 isa in_genre (media: $a, genre: $g);
  $a has title $title_a;
fetch {
  ""title"": $title_a
};"
131,What are the first 3 most popular adult films based on popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 3","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
132,Which packages provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS package","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
fetch {
  ""package"": $package_name_p
};"
135,Which genres are accessible through the 'Ultimate' package?,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre","match
  $p isa package, has package_name 'Ultimate';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
137,Which movies have Tom Hanks listed both in cast and crew?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)<-[:CREW_FOR]-(p)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $rel1 isa crew_for (film: $m, crew_member: $p);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
140,List all the movies that have a status of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $status == ""In Production"";
fetch {
  ""title"": $title
};"
141,What are the original languages for the top 5 movies based on average vote?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH m, l
ORDER BY m.average_vote DESC
LIMIT 5
RETURN m.title AS movie, l.name AS original_language","match
  $m isa movie;
  $l isa language;
  $rel0 isa original_language (media: $m, language: $l);
  $m has title $title_m;
  $m has average_vote $average_vote_m;
  $l has language_name $language_name_l;
sort $average_vote_m desc;
limit 5;
fetch {
  ""movie"": $title_m, ""original_language"": $language_name_l
};"
142,Which movies are tagged with 'adventure' and have a popularity above 15?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
WHERE m.popularity > 15
RETURN m.title, m.popularity","match
  $m isa movie;
  $k isa keyword, has keyword_name 'adventure';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has popularity $popularity_m;
  $m has title $title_m;
  $popularity_m > 15;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
143,What are the original languages for the top 5 movies based on average vote?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH m, l
ORDER BY m.average_vote DESC
LIMIT 5
RETURN m.title AS movie, l.name AS original_language","match
  $m isa movie, has title $title, has average_vote $vote;
  (media: $m, language: $l) isa original_language;
  $l has language_name $lang_name;
sort $vote desc;
limit 5;
fetch { ""movie"": $title, ""original_language"": $lang_name };"
151,List the first 5 countries that have produced movies with an average vote above 7.0.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WHERE m.average_vote > 7.0
RETURN c.name AS country, avg(m.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  (media: $m, country: $c) isa produced_in_country;
  $m has average_vote $av;
  $av > 7.0;
limit 50;
fetch { ""country"": $cn };"
152,Which production companies have produced movies that are part of a collection?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)<-[:PRODUCED_BY]-(p:ProductionCompany)
RETURN DISTINCT p.name AS ProductionCompany","match $c isa collection; $m isa movie; $p isa production_company; $rel0 isa in_collection (collection: $c, media: $m); $p has production_company_name $production_company_name_p; fetch { ""ProductionCompany"": $production_company_name_p, ""name"": $production_company_name_p };"
153,What are the first 3 movies in the 'Toy Story Collection' based on release date?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 3;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m
};"
154,Which movies have a cast member with the profile path ending in 'jpg'?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.profile_path ENDS WITH '.jpg'
RETURN m.title","match $m isa movie; $p isa person; $rel0 isa cast_for (film: $m, actor: $p); $m has title $title_m; $p has profile_path $profile_path_p; fetch { ""title"": $title_m };"
155,List the first 3 movies with a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
156,Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
157,List the first 3 movies sorted by release date in ascending order.,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
158,What are the first 5 movies with the lowest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote asc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
159,Which movies have a tagline containing the word 'excitement'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*excitement.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
160,What are the first 3 countries with the most movies produced in the genre 'Drama'?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
RETURN c.name AS country, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  (media: $m, genre: $g) isa in_genre;
limit 30;
fetch { ""genre"": $gn };"
161,Which videos have a budget less than 100000?,"MATCH (v:Video)
WHERE v.budget < 100000
RETURN v.title, v.budget","match
  $v isa video;
  $v has budget $budget;
  $v has title $title;
  $budget < 100000;
fetch {
  ""title"": $title, ""budget"": $budget
};"
162,List the first 3 videos with no revenue reported.,"MATCH (v:Video)
WHERE v.revenue IS NULL OR v.revenue = 0
RETURN v.title, v.revenue
LIMIT 3","match
  $m isa video;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
163,What are the top 5 most popular genres in adult films?,"MATCH (g:Genre)<-[:IN_GENRE]-(a:Adult)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa adult_video;
  (media: $m, genre: $g) isa in_genre;
limit 50;
fetch { ""genre"": $gn };"
164,Which adult films have been produced by companies not based in the USA?,"MATCH (a:Adult)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE NOT EXISTS { (c)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'}) }
RETURN a.title AS `Adult Film`, c.name AS `Production Company`","match
  $a isa adult_video;
  $c isa production_company;
  $rel0 isa produced_by (media: $a, producer: $c);
  $a has title $title_a;
  $c has production_company_name $production_company_name_c;
fetch {
  ""title"": $title_a, ""name"": $production_company_name_c
};"
165,List the first 3 adult films sorted by runtime in descending order.,"MATCH (a:Adult)
WHERE a.runtime IS NOT NULL
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
166,What are the first 5 adult films with the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
167,Which adult films feature the keyword 'murder'?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'murder'})
RETURN a.title","match
  $a isa adult_video;
  $k isa keyword, has keyword_name 'murder';
  $rel0 isa has_keyword (media: $a, keyword: $k);
  $a has title $title_a;
fetch {
  ""title"": $title_a
};"
168,What are the first 3 videos that have been rated higher than 8.0?,"MATCH (v:Video)<-[r:RATED]-(u:User)
WHERE r.rating > 8.0
RETURN v.title, r.rating
ORDER BY r.rating DESC
LIMIT 3","match
  $m isa video;
  $m has title $title;
limit 3;
fetch { ""title"": $title };"
169,List the top 5 longest running adult films.,"MATCH (a:Adult)
WHERE a.runtime IS NOT NULL
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 5","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
170,Which adult films have a homepage listed?,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title, a.homepage","match
  $a isa adult_video;
  $a has homepage $homepage;
  $a has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
171,What are the top 3 most budget-efficient adult films (highest revenue to budget ratio)?,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL AND a.revenue IS NOT NULL
RETURN a.title, a.revenue / a.budget AS efficiency
ORDER BY efficiency DESC
LIMIT 3","match $a isa adult_video; $a has budget $budget; $a has revenue $revenue; $a has title $title; limit 3; fetch { ""title"": $title, ""revenue"": $revenue, ""efficiency"": $budget };"
172,Which adult films have been released with the status 'In Production'?,"MATCH (a:Adult)
WHERE a.status = 'In Production'
RETURN a.title","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $status == ""In Production"";
fetch {
  ""title"": $title
};"
173,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
174,List the top 3 movies released in the United States of America.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has title $title; $m has release_date $release_date; $m has popularity $popularity; sort $popularity desc; limit 3; fetch { ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity };"
175,Which 5 movies were produced by Pixar Animation Studios?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
176,Find the first 3 movies in the Toy Story Collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 3;
fetch {
  ""title"": $title_m
};"
177,Which 3 movies have the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
178,What are the first 5 movies rated by user with ID 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating
ORDER BY r.timestamp
LIMIT 5","match $u isa user, has user_id 1; $m isa movie; $r isa rated (reviewer: $u, rated_media: $m), has rating $rating; $m has title $title_m; limit 5; fetch { ""title"": $title_m, ""rating"": $rating };"
179,List the top 5 highest voted movies on IMDb.,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
180,Which 3 highest budget movies were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""budget"": $budget };"
181,What are the top 3 movies spoken in Kiswahili?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
182,Which 5 movies have Tom Hanks in the cast?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 5","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
183,List the first 3 movies directed by a person with gender 2.,"MATCH (p:Person {gender: 2})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
LIMIT 3","match $p isa person, has gender 2; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $m has title $title_m; limit 3; fetch { ""title"": $title_m };"
184,What are the top 5 movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
185,Show the first 5 movies that have a popularity score over 15.,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has popularity $popularity;
  $m has title $title;
  $popularity > 15;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
186,Which 3 movies are part of genres with an ID between 15 and 50?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.id >= 15 AND g.id <= 50
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $g has genre_id $genre_id_g;
  $genre_id_g >= 15;
  $genre_id_g <= 50;
limit 3;
fetch {
  ""title"": $title_m
};"
187,List the top 5 movies that have been rated over 8.0.,"MATCH (m:Movie)
WHERE m.average_vote > 8.0
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 8.0;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
188,Which 3 movies have the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $k isa keyword, has keyword_name $kn;
  $m isa movie;
  (media: $m, keyword: $k) isa has_keyword;
limit 30;
fetch { ""keyword"": $kn };"
189,Show the top 3 movies that were produced in multiple countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS numCountries
WHERE numCountries > 1
RETURN m.title AS movie, numCountries
ORDER BY numCountries DESC
LIMIT 3","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
reduce $count = count($c);
sort $count desc;
limit 3;
fetch {
  ""count"": $count
};"
190,List the first 5 movies that have been tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'based on novel';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
191,What are the top 5 movies that premiered in the last quarter of any year?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL AND m.release_date.month >= 10
RETURN m.title, m.release_date
ORDER BY m.popularity DESC
LIMIT 5","match $m isa movie; $m has release_date $release_date; $m has title $title; $m has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title, ""release_date"": $release_date };"
192,Find the first 3 movies that feature both English and Spanish languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'})
WHERE EXISTS {
  (m)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'})
}
RETURN m.title
LIMIT 3","match $m isa movie; $l1 isa language, has language_name 'English'; $rel0 isa spoken_in_language (media: $m, language: $l1); $m has title $title_m; limit 3; fetch { ""title"": $title_m };"
193,Which 5 movies were produced by companies with an ID over 1000?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.id > 1000
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $c has production_company_id $production_company_id_c;
  $production_company_id_c > 1000;
limit 5;
fetch {
  ""title"": $title_m
};"
194,List the top 3 oldest movies in the database.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
195,What are the top 5 movies with a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'adventure'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 5","match $m isa movie; $m has tagline $tagline; $m has title $title; $m has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title, ""tagline"": $tagline };"
196,Which 3 movies have the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
197,Show the first 5 movies that were originally titled differently from their English title.,"MATCH (m:Movie)
WHERE m.title <> m.original_title
RETURN m.title AS title, m.original_title AS original_title
LIMIT 5","match $m isa movie; $m has title $title; $m has original_title $original_title; limit 5; fetch { ""title"": $title, ""original_title"": $original_title };"
198,List the top 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
199,What are the first 5 movies that have no revenue recorded?,"MATCH (m:Movie)
WHERE m.revenue IS NULL
RETURN m.title
LIMIT 5","match $m isa movie; $m has revenue $revenue; $m has title $title; limit 5; fetch { ""title"": $title };"
200,Which 5 movies have the most poster path variations?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, count(m.poster_path) AS poster_variations
ORDER BY poster_variations DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
limit 5;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
202,List the first 3 videos with the highest average vote.,"MATCH (v:Video)
WHERE v.average_vote IS NOT NULL
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 3","match
  $v isa video;
  $v has average_vote $average_vote;
  $v has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
203,Which 5 videos have a runtime under 60 minutes?,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v.title, v.runtime
ORDER BY v.runtime
LIMIT 5","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 60;
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
204,Show the first 3 adult films that are spoken in Italian.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'it'})
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
  $a isa adult_video;
  $l isa language, has language_name 'it';
  $rel0 isa spoken_in_language (media: $a, language: $l);
  $a has title $title_a;
  $a has release_date $release_date_a;
sort $release_date_a asc;
limit 3;
fetch {
  ""title"": $title_a, ""release_date"": $release_date_a
};"
205,List the top 5 adult films with a tagline containing 'murder'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'murder'
RETURN a.title, a.tagline
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $a has popularity $popularity;
  $tagline like "".*murder.*"";
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
206,What are the first 3 packages that provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name
LIMIT 3","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 3;
fetch {
  ""name"": $package_name_p
};"
211,Show the top 5 most popular adult films based on their popularity score.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
212,List the first 3 adult films with the largest budget.,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
215,Show the first 5 videos produced by the company with ID 10.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {id: 10})
RETURN v.title, v.release_date, v.popularity
LIMIT 5","match
  $v isa video;
  $c isa production_company, has production_company_id 10;
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
  $v has release_date $release_date_v;
  $v has popularity $popularity_v;
limit 5;
fetch {
  ""title"": $title_v, ""release_date"": $release_date_v, ""popularity"": $popularity_v
};"
219,Show the top 5 movies with the lowest average vote but highest revenue.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.average_vote, m.revenue
ORDER BY m.average_vote ASC, m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has revenue $revenue;
  $m has title $title;
sort $average_vote asc, $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""revenue"": $revenue
};"
220,List the first 3 people who have both acted in and produced a movie.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)<-[:CREW_FOR]-(p)
WHERE p.name IS NOT NULL
RETURN DISTINCT p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $rel1 isa crew_for (film: $m, crew_member: $p);
  $p has person_name $person_name_p;
limit 3;
fetch {
  ""name"": $person_name_p
};"
232,List the top 3 highest grossing movies in the genre 'Action'.,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Action'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $g isa genre, has genre_name ""Action"";
  (media: $m, genre: $g) isa in_genre;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
233,What are the first 5 movies that have a character played by a person with gender 1?,"MATCH (p:Person)-[c:CAST_FOR]->(m:Movie)
WHERE p.gender = 1
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $cast isa cast_for (actor: $p, film: $m);
  $p has gender 1;
  $m has title $title;
limit 5;
fetch { ""title"": $title };"
234,Show the top 5 oldest movies in the collection with the highest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.release_date, m.revenue
ORDER BY m.release_date, m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date asc, $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""revenue"": $revenue
};"
235,List the first 3 movies that have a link to their homepage that includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $homepage like "".*disney.*"";
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
237,Show the first 5 movies where the production company's name includes 'Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.name CONTAINS 'Studios'
RETURN m.title, c.name
LIMIT 5","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $c has production_company_name $production_company_name_c;
  $production_company_name_c like "".*Studios.*"";
limit 5;
fetch {
  ""title"": $title_m, ""name"": $production_company_name_c
};"
239,What are the first 5 adult films that have a runtime over 100 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 100
RETURN a.title
ORDER BY a.title
LIMIT 5","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 100;
sort $title asc;
limit 5;
fetch {
  ""title"": $title
};"
241,Show the top 5 adult films with a poster path containing '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'.,"MATCH (a:Adult)
WHERE a.poster_path = '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'
RETURN a.title, a.release_date, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has poster_path $poster_path;
  $a has title $title;
  $a has release_date $release_date;
  $a has popularity $popularity;
  $poster_path == ""/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg"";
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity
};"
242,List the first 3 adult films with a tagline mentioning 'love'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'love'
RETURN a.title, a.tagline
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline like "".*love.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
243,What are the top 5 adult films with the highest number of votes?,"MATCH (a:Adult)
WHERE a.vote_count IS NOT NULL
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
  $a isa adult_video;
  $a has vote_count $vote_count;
  $a has title $title;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
244,Which 3 adult films have the lowest average votes but were produced in 'United States of America'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN a.title, a.average_vote
ORDER BY a.average_vote
LIMIT 3","match $a isa adult_video; $country isa country, has country_name 'United States of America'; (media: $a, country: $country) isa produced_in_country; $a has title $title; $a has average_vote $average_vote; sort $average_vote asc; limit 3; fetch { ""title"": $title, ""average_vote"": $average_vote };"
246,"List the top 3 adult films with a budget under $10,000.","MATCH (a:Adult)
WHERE a.budget < 10000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget < 10000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
247,What are the top 5 movies sorted by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
248,List the first 3 movies released after 2010.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01')
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has title $title;
sort $rd asc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
249,Which 3 movies have the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
250,Name the top 5 oldest movies in the database.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
251,What are the first 3 highest budget movies that were released?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has budget $budget;
  $m has title $title;
  $status == ""Released"";
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
252,List 5 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
limit 5;
fetch {
  ""title"": $title
};"
254,Name the top 5 movies by vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
255,Which 3 movies have the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie, has title $title, has average_vote $vote;
sort $vote desc;
limit 3;
fetch { ""title"": $title, ""average_vote"": $vote };"
256,List the top 5 movies that made the least revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
262,Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
263,What are the first 3 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
264,List the top 5 movies based on popularity.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
265,Which 3 movies have the least number of votes?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count asc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
268,Name the top 5 movies that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title, c.name
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has popularity $popularity_m;
  $c has collection_name $collection_name_c;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""name"": $collection_name_c
};"
270,List 5 movies that have a poster path containing '/rh'.,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rh'
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $poster_path like "".*/rh.*"";
limit 5;
fetch {
  ""title"": $title
};"
273,List the top 5 movies that have a homepage URL.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
274,Which 3 movies have the highest popularity but the least revenue?,"MATCH (m:Movie)
WHERE m.popularity IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.popularity, m.revenue
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3","match
  $m isa movie;
  $m has popularity $popularity;
  $m has revenue $revenue;
  $m has title $title;
sort $popularity desc, $revenue asc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity, ""revenue"": $revenue
};"
276,What are the first 3 languages spoken in movies with a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN l.name AS language
ORDER BY language
LIMIT 3","match $m isa movie; $l isa language; $rel0 isa spoken_in_language (media: $m, language: $l); $m has budget $budget_m; $l has language_name $language_name_l; $budget_m > 50000000; limit 3; fetch { ""language"": $language_name_l };"
278,Name the top 5 movies with 'Animated' as a keyword.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'Animated'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'Animated';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m
};"
279,What are the first 3 adult videos by revenue?,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3","match
  $a isa adult_video;
  $a has revenue $revenue;
  $a has title $title;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
280,List the top 5 adult videos by vote count.,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
281,Which 3 adult videos have the longest runtime?,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has title $title;
  $a has runtime $runtime;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
282,Name the top 5 adult videos with the highest average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
283,"What are the first 3 adult videos with a budget over $500,000?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget > 500000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
284,List the 5 oldest adult videos based on release date.,"MATCH (a:Adult)
WHERE a.release_date IS NOT NULL
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 5","match
  $a isa adult_video;
  $a has release_date $release_date;
  $a has title $title;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
286,Name the top 5 adult videos that were produced in Italy.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN a.title
ORDER BY a.popularity DESC
LIMIT 5","match $a isa adult_video; $country isa country, has country_name 'Italy'; (media: $a, country: $country) isa produced_in_country; $a has title $title; $a has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title };"
288,List 5 adult videos with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a.title, a.tagline
LIMIT 5","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline like "".*sex.*"";
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
289,Which 3 adult videos have the most provocative poster paths?,"MATCH (a:Adult)
WHERE a.poster_path IS NOT NULL
RETURN a.title, a.poster_path
ORDER BY a.popularity DESC
LIMIT 3","match
  $a isa adult_video;
  $a has poster_path $poster_path;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
290,Name the top 5 adult videos with the least revenue.,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue
LIMIT 5","match
  $a isa adult_video;
  $a has revenue $revenue;
  $a has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
291,List the top 5 adult videos based on popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
293,Name the top 5 subscriptions by the duration of the package they are for.,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package)
RETURN s.id AS subscription_id, p.name AS package_name, p.duration AS package_duration
ORDER BY p.duration DESC
LIMIT 5","match
  $s isa subscription;
  $p isa package;
  $rel0 isa for_package (subscription: $s, package: $p);
  $s has subscription_id $subscription_id_s;
  $p has package_name $package_name_p;
  $p has package_duration $package_duration_p;
sort $package_duration_p desc;
limit 5;
fetch {
  ""subscription_id"": $subscription_id_s, ""package_name"": $package_name_p, ""package_duration"": $package_duration_p
};"
294,What are the first 3 packages with the highest price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 3","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_price $package_price;
sort $package_price desc;
limit 3;
fetch {
  ""package"": $package_name, ""price"": $package_price
};"
296,Which 3 genres are provided access to by the 'Gold' package?,"MATCH (p:Package {name: 'Gold'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $p isa package, has package_name 'Gold';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
297,Name the top 5 packages that provide access to the 'Animation' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 5","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
  $p has package_price $package_price_p;
sort $package_price_p desc;
limit 5;
fetch {
  ""package"": $package_name_p, ""price"": $package_price_p
};"
310,What are the first 3 videos with the highest popularity?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
311,List the top 5 videos with the least revenue.,"MATCH (v:Video)
WHERE v.revenue IS NOT NULL
RETURN v.title, v.revenue
ORDER BY v.revenue
LIMIT 5","match
  $v isa video;
  $v has revenue $revenue;
  $v has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
316,What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
317,List the first 3 movies produced in the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has title $title; limit 3; fetch { ""title"": $title };"
318,Which 3 movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
limit 3;
fetch {
  ""title"": $title
};"
319,Identify the top 5 most popular videos as per the popularity metric.,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
320,What are the first 3 movies directed by a person named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
LIMIT 3","match $p isa person, has person_name 'John Doe'; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $m has title $title_m; limit 3; fetch { ""title"": $title_m };"
321,Name the top 5 movies that were released after 2010 and have a budget over 100 million USD.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.budget > 100000000
RETURN m.title, m.budget, m.release_date
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has budget $budget;
  $budget > 100000000;
  $m has title $title;
sort $budget desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""budget"": $budget };"
322,Which 3 movies have more than 5000 vote counts?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
limit 3;
fetch {
  ""title"": $title
};"
323,Can you list the first 3 genres associated with the movie titled 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
325,List the first 3 languages spoken in the movie titled 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3","match
  $m isa movie, has title 'Jumanji';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
limit 3;
fetch {
  ""name"": $language_name_l
};"
327,List the top 5 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $k isa keyword;
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $v has popularity $popularity_v;
  $k has keyword_name $keyword_name_k;
sort $popularity_v desc;
limit 5;
fetch {
  ""keyword"": $keyword_name_k
};"
328,What are the first 3 collections that include movies with a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.poster_path = '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN c.name
LIMIT 3","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has poster_path $poster_path_m;
  $c has collection_name $collection_name_c;
  $poster_path_m == ""/rhIRbceoE9lR4veEXuwCC2wARtG.jpg"";
limit 3;
fetch {
  ""name"": $collection_name_c
};"
329,Name the top 5 persons who have played the character 'Woody' in any movie.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Woody'
RETURN p.name
ORDER BY m.popularity DESC
LIMIT 5","match
  $p isa person, has person_name $pn;
  $m isa movie, has popularity $pop;
  $cast isa cast_for (actor: $p, film: $m), has character ""Woody"";
sort $pop desc;
limit 5;
fetch { ""name"": $pn };"
332,What are the first 3 movies that have a revenue greater than 100 million USD and are in the genre 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
WHERE m.revenue > 100000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name 'Action';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has revenue $revenue_m;
  $m has title $title_m;
  $revenue_m > 100000000;
limit 3;
fetch {
  ""title"": $title_m
};"
333,Can you list the top 5 adult films with the highest popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
334,Which 3 movies have Tom Hanks as a cast member and have been released after 1995?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
WHERE m.release_date > date('1995-01-01')
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 1995-01-01;
  $p isa person;
  $cast isa cast_for (actor: $p, film: $m);
  $p has person_name ""Tom Hanks"";
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
335,List the first 3 movies in the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
337,What are the first 3 movies with the status 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $status == ""In Production"";
limit 3;
fetch {
  ""title"": $title
};"
338,List the top 5 movies that have been rated 10 by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 10
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating == 10;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""rating"": $rating, ""popularity"": $popularity };"
340,List the first 3 movies that have the keyword 'space' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'space';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
342,Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
345,Which 3 movies have the highest revenue and are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has revenue $revenue_m;
sort $revenue_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""revenue"": $revenue_m
};"
346,List the first 3 videos that have a budget less than 5000 USD.,"MATCH (v:Video)
WHERE v.budget < 5000
RETURN v.title, v.budget
LIMIT 3","match
  $v isa video;
  $v has budget $budget;
  $v has title $title;
  $budget < 5000;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
347,Name the top 5 most popular movies released before 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
348,What are the first 3 movies that have a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*adventure.*"";
limit 3;
fetch {
  ""title"": $title
};"
350,Which 3 adult films have the tagline 'Humiliation. Rape. Murder. You know the drill.'?,"MATCH (a:Adult)
WHERE a.tagline = 'Humiliation. Rape. Murder. You know the drill.'
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline == ""Humiliation. Rape. Murder. You know the drill."";
limit 3;
fetch {
  ""title"": $title
};"
351,List the first 3 movies that have been produced by 'Pixar Animation Studios' and have a budget over 50 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has budget $budget_m;
  $m has title $title_m;
  $budget_m > 50000000;
sort $budget_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
353,What are the first 3 videos that have a runtime shorter than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v.title, v.runtime
ORDER BY v.runtime
LIMIT 3","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 30;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
354,"List the top 5 highest grossing movies that have been released on or after January 1, 2000.","MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 2000-01-01;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""revenue"": $revenue };"
356,List the first 3 persons who have directed a movie with a budget over 150 million USD.,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.budget > 150000000
RETURN p.name
LIMIT 3","match $p isa person; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $p has person_name $person_name_p; $m has budget $budget_m; $budget_m > 150000000; limit 3; fetch { ""name"": $person_name_p };"
358,What are the first 3 genres associated with the video titled 'Electrical Girl'?,"MATCH (v:Video {title: 'Electrical Girl'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $v isa video, has title 'Electrical Girl';
  $g isa genre;
  $rel0 isa in_genre (media: $v, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
360,Which 3 movies have been produced by a company named 'Warner Bros' and have a revenue over 200 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.name = 'Warner Bros' AND m.revenue > 200000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has revenue $revenue_m;
  $m has title $title_m;
  $c has production_company_name $production_company_name_c;
  $revenue_m > 200000000;
  $production_company_name_c == ""Warner Bros"";
limit 3;
fetch {
  ""title"": $title_m
};"
361,List the first 3 languages used in movies with an original title 'Toy Story'.,"MATCH (m:Movie {original_title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language
LIMIT 3","match
  $m isa movie, has original_title 'Toy Story';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
limit 3;
fetch {
  ""language"": $language_name_l
};"
363,What are the first 3 adult films that have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title
ORDER BY a.title
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 90;
sort $title asc;
limit 3;
fetch {
  ""title"": $title
};"
367,What are the first 3 movies with the genre 'Drama' that have a budget less than 10 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
WHERE m.budget < 10000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $budget < 10000000;
  $g isa genre, has genre_name ""Drama"";
  (media: $m, genre: $g) isa in_genre;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""budget"": $budget };"
369,Which 3 movies have a production company named 'Lucasfilm' associated with them?,"MATCH (m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany {name: 'Lucasfilm'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Lucasfilm';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
371,Name the top 5 most popular movies according to the vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
372,What are the first 3 movies that have a homepage URL containing 'disney'?,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $homepage like "".*disney.*"";
limit 3;
fetch {
  ""title"": $title
};"
373,List the top 5 movies that have been produced by 'Universal Pictures'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Universal Pictures'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Universal Pictures';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
375,List the first 3 adult films that were released in the year 2000 or later.,"MATCH (a:Adult)
WHERE a.release_date >= date('2000-01-01')
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
  $m isa adult_video;
  $m has release_date $rd;
  $rd >= 2000-01-01;
  $m has title $title;
sort $rd asc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
378,"List the top 5 movies with a release date on or before December 31, 1990.","MATCH (m:Movie)
WHERE m.release_date <= date('1990-12-31')
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd <= 1990-12-31;
  $m has title $title;
sort $rd desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd };"
379,List the top 5 videos that have a tagline including the word 'comedy'.,"MATCH (v:Video)
WHERE v.tagline CONTAINS 'comedy'
RETURN v.title, v.tagline
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has tagline $tagline;
  $v has title $title;
  $v has popularity $popularity;
  $tagline like "".*comedy.*"";
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
381,What are the first 3 movies that have a budget exactly 50 million USD?,"MATCH (m:Movie)
WHERE m.budget = 50000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $budget == 50000000;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""budget"": $budget };"
383,Which 3 movies have an average vote greater than 8 and have been produced in 'France'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'France'})
WHERE m.average_vote > 8
RETURN m.title
LIMIT 3","match $m isa movie; $country isa country, has country_name 'France'; (media: $m, country: $country) isa produced_in_country; $m has average_vote $average_vote; $m has title $title; $average_vote > 8; limit 3; fetch { ""title"": $title };"
384,List the top 5 movies that have a runtime exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m.title, m.runtime
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $runtime == 90;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""runtime"": $runtime, ""popularity"": $popularity };"
385,Name the top 5 videos that were released in the year 2010 or later.,"MATCH (v:Video)
WHERE v.release_date >= date('2010-01-01')
RETURN v.title
ORDER BY v.popularity DESC
LIMIT 5","match
  $m isa video;
  $m has release_date $rd;
  $rd >= 2010-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
387,List the top 5 movies that were part of the 'Toy Story Collection' and have a runtime over 80 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WHERE m.runtime > 80
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $runtime_m > 80;
sort $runtime_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""runtime"": $runtime_m
};"
388,Which 3 movies have been produced by 'Pixar Animation Studios' and have a runtime under 100 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime < 100
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $runtime_m < 100;
limit 3;
fetch {
  ""title"": $title_m
};"
389,List the top 5 highest budget movies in the 'Animation' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has budget $budget_m;
sort $budget_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
390,Name the top 5 movies that have the keyword 'jealousy' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m
};"
391,"What are the first 3 adult films with a budget over 500,000 USD?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget > 500000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title
};"
393,Which 3 videos have a homepage URL containing 'youtube'?,"MATCH (v:Video)
WHERE v.homepage CONTAINS 'youtube'
RETURN v.title
LIMIT 3","match
  $v isa video;
  $v has homepage $homepage;
  $v has title $title;
  $homepage like "".*youtube.*"";
limit 3;
fetch {
  ""title"": $title
};"
398,Which 3 movies have a vote count over 2000 and a budget under 50 million USD?,"MATCH (m:Movie)
WHERE m.vote_count > 2000 AND m.budget < 50000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has budget $budget;
  $m has title $title;
  $vote_count > 2000;
  $budget < 50000000;
limit 3;
fetch {
  ""title"": $title
};"
399,List the first 3 movies that have a revenue over 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $revenue > 500000000;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
400,Name the top 5 most popular movies in the 'Science Fiction' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Science Fiction'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name 'Science Fiction';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
401,List the first 5 movies with a budget over 20 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 20000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 20000000;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
402,Which 3 movies have the highest average vote above 8.0?,"MATCH (m:Movie)
WHERE m.average_vote > 8.0
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 8.0;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
404,What are the names of the top 3 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title AS movie, m.popularity AS popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
405,Who are the first 3 actors cast in the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CAST_FOR]-(p:Person)
RETURN p.name
ORDER BY p.id
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $p isa person;
  $rel0 isa cast_for (film: $m, actor: $p);
  $p has person_name $person_name_p;
  $p has person_id $person_id_p;
sort $person_id_p asc;
limit 3;
fetch {
  ""name"": $person_name_p
};"
407,List the first 3 countries where movies with a revenue greater than 100 million dollars were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 100000000
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has revenue $revenue_m;
  $c has country_name $country_name_c;
  $revenue_m > 100000000;
limit 3;
fetch {
  ""name"": $country_name_c
};"
409,What are the top 5 keywords associated with the movie 'Waiting to Exhale'?,"MATCH (m:Movie {title: 'Waiting to Exhale'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie, has title 'Waiting to Exhale';
  $k isa keyword;
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has popularity $popularity_m;
  $k has keyword_name $keyword_name_k;
sort $popularity_m desc;
limit 5;
fetch {
  ""keyword"": $keyword_name_k
};"
412,List the 5 most recent movies that have been added to the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m
};"
415,List the top 5 movies that have been tagged with the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
416,What are the first 3 genres associated with the movie 'Jonah: A VeggieTales Movie'?,"MATCH (m:Movie {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Jonah: A VeggieTales Movie';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
419,Find the first 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline
LIMIT 5","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*love.*"";
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
423,List the top 3 most popular videos with a runtime under 90 minutes.,"MATCH (v:Video)
WHERE v.runtime < 90
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $v has popularity $popularity;
  $runtime < 90;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
426,Which 3 movies have the highest revenue and were released in the 'United States of America'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has title $title; $m has revenue $revenue; sort $revenue desc; limit 3; fetch { ""title"": $title, ""revenue"": $revenue };"
427,List the first 5 movies that are part of a collection and have a revenue greater than 100 million dollars.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.revenue > 100000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie; $collection isa collection; (media: $m, collection: $collection) isa in_collection; $m has revenue $revenue; $m has title $title; $revenue > 100000000; sort $revenue desc; limit 5; fetch { ""title"": $title, ""revenue"": $revenue };"
429,Name the first 3 adult films with the highest average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
431,List the top 5 movies that have been rated by users more than 1000 times.,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 1000;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
433,Which 3 movies have the longest runtime and were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""runtime"": $runtime };"
435,Name the first 5 genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 5","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 5;
fetch {
  ""name"": $genre_name_g
};"
436,What are the 3 most popular movies in the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
438,List the first 5 movies that were produced in the country 'United States of America' and have a revenue over 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WHERE m.revenue > 50000000
RETURN m.title, m.revenue
LIMIT 5","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has revenue $revenue; $m has title $title; $revenue > 50000000; limit 5; fetch { ""title"": $title, ""revenue"": $revenue };"
440,Name the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget above 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has budget $budget_m;
  $m has title $title_m;
  $budget_m > 50000000;
limit 3;
fetch {
  ""title"": $title_m
};"
442,List the top 5 movies that have a runtime longer than 150 minutes and were released before 2010.,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.release_date < date('2010-01-01')
RETURN m.title, m.runtime, m.release_date
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2010-01-01;
  $m has runtime $runtime;
  $runtime > 150;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""runtime"": $runtime };"
443,What are the first 3 genres associated with the movie 'Father of the Bride Part II'?,"MATCH (m:Movie {title: 'Father of the Bride Part II'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Father of the Bride Part II';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
446,Name the first 5 movies that have a homepage URL associated.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
limit 5;
fetch {
  ""title"": $title
};"
447,What are the 3 most popular movies in the genre 'Comedy'?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  (media: $m, genre: $g) isa in_genre;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch { ""title"": $title, ""popularity"": $popularity };"
449,List the first 5 movies that have a tagline and were released after 2010.,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m.title, m.tagline, m.release_date
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has title $title;
  $m has tagline $tagline;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""tagline"": $tagline };"
451,Name the first 3 adult films that were produced in the country 'Italy'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN a.title
LIMIT 3","match $a isa adult_video; $country isa country, has country_name 'Italy'; (media: $a, country: $country) isa produced_in_country; $a has title $title; limit 3; fetch { ""title"": $title };"
453,List the top 5 highest revenue generating movies of all time.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
454,What are the first 3 genres associated with the video 'Jonah: A VeggieTales Movie'?,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $g isa genre;
  $rel0 isa in_genre (media: $v, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
455,Which 3 movies have the lowest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote IS NOT NULL
RETURN m.title, m.average_vote, m.release_date
ORDER BY m.average_vote
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has title $title;
  $m has average_vote $av;
sort $av asc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""average_vote"": $av };"
456,List the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
458,What are the 3 most popular movies that have been released since 2015?,"MATCH (m:Movie)
WHERE m.release_date >= date('2015-01-01') AND m.popularity IS NOT NULL
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 2015-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
460,List the first 5 videos that have a runtime under 60 minutes.,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v.title, v.runtime
LIMIT 5","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 60;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
464,List the top 5 movies that have been part of at least one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match $m isa movie; $collection isa collection; (media: $m, collection: $collection) isa in_collection; $m has title $title; $m has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title, ""popularity"": $popularity };"
465,What are the first 3 genres associated with the movie 'Alex & Emma'?,"MATCH (m:Movie {title: 'Alex & Emma'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Alex & Emma';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
466,Which 3 movies have the highest vote count?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has vote_count $vote_count;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
467,List the top 5 adult films with the highest popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
468,Name the first 5 movies that have a release date before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01')
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 1990-01-01;
  $m has title $title;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd };"
469,What are the 3 most popular movies in the genre 'Thriller'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Thriller'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name 'Thriller';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
471,List the first 5 videos that were produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 5","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
limit 5;
fetch {
  ""title"": $title_v
};"
473,Name the first 3 adult films that have a runtime longer than 90 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 90;
limit 3;
fetch {
  ""title"": $title
};"
474,Which 3 keywords are most commonly associated with movies that have an original language of 'en'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.original_language = 'en'
RETURN k.name, count(*) as count
ORDER BY count DESC
LIMIT 3","match
$m isa movie;
$k isa keyword;
has_keyword (media: $m, keyword: $k);
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
reduce $count = count groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
475,Name the first 3 movies that have a poster path ending in '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'
RETURN m.title
LIMIT 3","match
  $m isa movie, has title $title, has poster_path $path;
  $path like "".*pQFoyx7rp09CJTAb932F2g8Nlho.jpg"";
limit 3;
fetch { ""title"": $title };"
476,What are the first 3 genres associated with the movie 'Nil Battey Sannata'?,"MATCH (m:Movie {title: 'Nil Battey Sannata'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Nil Battey Sannata';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
477,Which 3 movies have the highest revenue and were released in the 'United Kingdom'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United Kingdom'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United Kingdom'; (media: $m, country: $country) isa produced_in_country; $m has title $title; $m has revenue $revenue; sort $revenue desc; limit 3; fetch { ""title"": $title, ""revenue"": $revenue };"
478,Which movies have a revenue greater than 50 million USD?,"MATCH (m:Movie)
WHERE m.revenue > 50000000
RETURN m.title, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $revenue > 50000000;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
479,List all movies where Tom Hanks acted in.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
480,What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
481,Which movies are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
482,List all movies produced by 'Pixar Animation Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
483,What are the names of genres associated with movies having a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name","match
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has budget $budget_m;
  $g has genre_name $genre_name_g;
  $budget_m > 100000000;
fetch {
  ""name"": $genre_name_g
};"
484,Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
  $u isa user, has user_id 1;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
  $m has title $title_m;
fetch {
  ""movie"": $title_m, ""rating"": $rating
};"
485,What are the most recent three movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
486,List the movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
487,Which movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
488,Find all movies released before 2000 with an average vote greater than 8.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote > 8
RETURN m","match
  $m isa movie, has title $title;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has average_vote $av;
  $av > 8;
limit 50;
fetch { ""title"": $title, ""release_date"": $rd, ""average_vote"": $av };"
489,List all languages spoken in the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
  $m isa movie, has title 'Toy Story';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
fetch {
  ""language"": $language_name_l
};"
490,What are the original titles of movies that have been translated into Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'})
WHERE m.original_language <> 'es'
RETURN m.original_title","match
$m isa movie, has original_title $original_title;
spoken_in_language (media: $m, language: $spanish);
$spanish has language_name ""Spanish"";
original_language (media: $m, language: $orig_lang);
not { $orig_lang has language_id ""es""; };
fetch {
  ""original_title"": $original_title
};"
491,Which countries have produced movies with a budget exceeding 10 million USD?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.budget > 10000000
RETURN DISTINCT c.name AS country","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has budget $budget_m;
  $c has country_name $country_name_c;
  $budget_m > 10000000;
fetch {
  ""country"": $country_name_c, ""name"": $country_name_c
};"
492,List the names of all production companies involved with movies that grossed over 200 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE m.revenue > 200000000
RETURN DISTINCT c.name","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has revenue $revenue_m;
  $c has production_company_name $production_company_name_c;
  $revenue_m > 200000000;
fetch {
  ""name"": $production_company_name_c
};"
495,What are the top 3 most voted movies in the database?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
496,Which movies have a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN m.title","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $poster_path == ""/rhIRbceoE9lR4veEXuwCC2wARtG.jpg"";
fetch {
  ""title"": $title
};"
497,What are the names of people who have directed movies with a budget over 50 million USD?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.budget > 50000000
RETURN DISTINCT p.name","match $p isa person; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $p has person_name $person_name_p; $m has budget $budget_m; $budget_m > 50000000; fetch { ""name"": $person_name_p };"
499,List all movies that are part of any collection and have a revenue less than 1 million USD.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.revenue < 1000000
RETURN m.title, m.revenue","match $m isa movie; $collection isa collection; (media: $m, collection: $collection) isa in_collection; $m has revenue $revenue; $m has title $title; $revenue < 1000000; fetch { ""title"": $title, ""revenue"": $revenue };"
500,What are the names of all genres represented in the 'Toy Story Collection'?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name","match
  $c isa collection, has collection_name 'Toy Story Collection';
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $rel1 isa in_collection (collection: $c, media: $m);
  $g has genre_name $genre_name_g;
fetch {
  ""name"": $genre_name_g
};"
501,Which movies have an IMDb ID of 'tt0114709'?,"MATCH (m:Movie {imdb_id: 'tt0114709'})
RETURN m.title","match
  $m isa movie, has imdb_id 'tt0114709';
  $m has title $title;
fetch {
  ""title"": $title
};"
502,What are the top 5 movies by revenue in descending order?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
503,List the movies with a tagline that includes 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*excitement.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
505,List all movies that have a homepage URL defined.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
506,Which movies have been released with a status of 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title, m.release_date, m.status","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $m has release_date $release_date;
  $status == ""In Production"";
fetch {
  ""title"": $title, ""release_date"": $release_date, ""status"": $status
};"
507,Which movies have a runtime that is exactly 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m.title","match
  $m isa movie;
  $m has runtime $runtime;
  $runtime == 90;
  $m has title $title;
fetch { ""title"": $title, ""runtime"": $runtime };"
508,What are the top 3 most voted movies in the database?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie, has title $title, has vote_count $votes;
sort $votes desc;
limit 3;
fetch { ""title"": $title, ""vote_count"": $votes };"
513,What are the movies with a vote count greater than 5000?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
517,List the movies where the spoken language is 'Gaeilge'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_name 'Gaeilge';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
518,Which movies have a backdrop path of '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {backdrop_path: '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has backdrop_path '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
519,What are the three oldest movies in the database?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
520,List movies that are part of a genre with ID 10770.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {id: 10770})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_id 10770;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
521,Which movies have a status of 'Released' and a budget greater than 25 million USD?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget > 25000000
RETURN m.title, m.budget, m.status","match
  $m isa movie;
  $m has status $status;
  $m has budget $budget;
  $m has title $title;
  $budget > 25000000;
  $status == ""Released"";
fetch {
  ""title"": $title, ""budget"": $budget, ""status"": $status
};"
525,List the movies that have been rated exactly 5.0.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title","match
  $m isa movie;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating == 5.0;
  $m has title $title;
fetch { ""title"": $title, ""rating"": $rating };"
526,What are the movies directed by 'Christopher Nolan'?,"MATCH (p:Person {name: 'Christopher Nolan'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title","match $p isa person, has person_name 'Christopher Nolan'; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $m has title $title_m; fetch { ""title"": $title_m };"
530,List all movies that have a revenue of zero but have been highly rated.,"MATCH (m:Movie)
WHERE m.revenue = 0 AND m.average_vote >= 7.0
RETURN m.title, m.average_vote, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
  $m has average_vote $av;
  $av >= 7.0;
fetch { ""title"": $title, ""revenue"": $revenue, ""average_vote"": $av };"
531,Which movies have been associated with the keyword 'high school' and have an average vote above 6?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'high school'})
WHERE m.average_vote > 6
RETURN m.title, m.average_vote","match
  $m isa movie;
  $k isa keyword, has keyword_name 'high school';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has average_vote $average_vote_m;
  $m has title $title_m;
  $average_vote_m > 6;
fetch {
  ""title"": $title_m, ""average_vote"": $average_vote_m
};"
532,What are the top 5 longest movies in the database?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
534,Which movies have been produced by 'Warner Bros.' and have a revenue over 500 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Warner Bros.'})
WHERE m.revenue > 500000000
RETURN m.title, m.revenue","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Warner Bros.';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has revenue $revenue_m;
  $m has title $title_m;
  $revenue_m > 500000000;
fetch {
  ""title"": $title_m, ""revenue"": $revenue_m
};"
535,What are the three most recent movies that have a tagline?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline, ""release_date"": $release_date
};"
536,List all movies that have an average_vote less than 3.,"MATCH (m:Movie)
WHERE m.average_vote < 3
RETURN m","match
  $m isa movie, has title $title;
  $m has average_vote $av;
  $av < 3;
limit 50;
fetch { ""title"": $title, ""average_vote"": $av };"
537,Which movies have been involved in a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $c has backdrop_path $backdrop_path_c;
  $backdrop_path_c == ""/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg"";
fetch {
  ""title"": $title_m
};"
539,Which movies have been spoken in 'Kiswahili'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
540,What are the movies where 'Brad Pitt' has acted?,"MATCH (p:Person {name: 'Brad Pitt'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Brad Pitt';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
541,Which movies have an overview that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m.title, m.overview","match
  $m isa movie;
  $m has overview $overview;
  $m has title $title;
  $overview like "".*adventure.*"";
fetch {
  ""title"": $title, ""overview"": $overview
};"
544,What are the movies with a vote count less than 50?,"MATCH (m:Movie)
WHERE m.vote_count < 50
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count < 50;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
545,List the movies where the original language is not English.,"MATCH (m:Movie)
WHERE m.original_language <> 'en'
RETURN m.title, m.original_language","match
$m isa movie, has title $title;
original_language (media: $m, language: $lang);
$lang has language_id $lang_id;
not { $lang_id == ""en""; };
fetch {
  ""title"": $title,
  ""language"": $lang_id
};"
546,Which movies have a popularity score above 15?,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m.title, m.popularity","match
  $m isa movie;
  $m has popularity $popularity;
  $m has title $title;
  $popularity > 15;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
547,What are the top 5 movies with the smallest budget?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
sort $budget asc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
548,List all movies that have a runtime greater than 150 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 150;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
549,Which movies have been tagged with the keyword 'romance'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'romance'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'romance';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
551,List the movies with a revenue exceeding 100 million USD and a popularity below 10.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.popularity < 10
RETURN m.title, m.revenue, m.popularity","match
  $m isa movie;
  $m has revenue $revenue;
  $m has popularity $popularity;
  $m has title $title;
  $revenue > 100000000;
  $popularity < 10;
fetch {
  ""title"": $title, ""revenue"": $revenue, ""popularity"": $popularity
};"
552,Which movies have a status of 'Released' and an average vote less than 4?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote < 4
RETURN m.title, m.average_vote","match
  $m isa movie;
  $m has status $status;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote < 4;
  $status == ""Released"";
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
555,Which movies have a tagline that includes 'surprise'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'surprise'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*surprise.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
558,Which movies have a runtime less than 80 minutes and a budget over 20 million USD?,"MATCH (m:Movie)
WHERE m.runtime < 80 AND m.budget > 20000000
RETURN m.title, m.runtime, m.budget","match
  $m isa movie;
  $m has runtime $runtime;
  $m has budget $budget;
  $m has title $title;
  $runtime < 80;
  $budget > 20000000;
fetch {
  ""title"": $title, ""runtime"": $runtime, ""budget"": $budget
};"
559,What are the top 3 movies by average vote in the database?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
561,Which movies have a poster path containing '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'
RETURN m.title","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $poster_path == ""/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg"";
fetch {
  ""title"": $title
};"
565,List the movies that have been tagged with the keyword 'explosive'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'explosive'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'explosive';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
568,What are the three highest budget movies produced by 'Disney'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.name CONTAINS 'Disney'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has budget $budget_m;
  $c has production_company_name $production_company_name_c;
  $production_company_name_c like "".*Disney.*"";
sort $budget_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
569,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
570,List 3 movies that have a runtime greater than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
limit 3;
fetch {
  ""title"": $title
};"
572,Find 3 movies that have 'Toy Story' in their title.,"MATCH (m:Movie)
WHERE m.title CONTAINS 'Toy Story'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $title like "".*Toy Story.*"";
limit 3;
fetch {
  ""title"": $title
};"
573,What are the top 5 highest budget movies?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
578,List the 3 most recent movies in the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m
};"
580,What are the first 3 keywords associated with the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $k isa keyword;
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $k has keyword_name $keyword_name_k;
limit 3;
fetch {
  ""name"": $keyword_name_k
};"
582,List the top 5 most popular movies according to their popularity score.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
583,What are the 3 longest movies in terms of runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has runtime $runtime;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
584,Which 3 movies have the highest average vote and more than 1000 votes?,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m.title, m.average_vote, m.vote_count
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $m has average_vote $average_vote;
  $vote_count > 1000;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""vote_count"": $vote_count
};"
586,Which 5 movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
591,List the top 5 adult films by average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
592,Which 3 adult films have the highest budget?,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
597,List the first 3 video titles that have been produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 3","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
limit 3;
fetch {
  ""title"": $title_v
};"
598,Which 3 videos have the highest popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
599,What are the 3 longest videos in terms of runtime?,"MATCH (v:Video)
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3","match
  $v isa video;
  $v has title $title;
  $v has runtime $runtime;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
601,Which 3 collections include videos with an average vote above 7?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(v:Video)
WHERE v.average_vote > 7
RETURN c.name AS collection, avg(v.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  $m isa video;
  (media: $m, collection: $c) isa in_collection;
  $m has average_vote $av;
  $av > 7;
limit 30;
fetch { ""collection"": $cn };"
603,List the first 3 packages that offer access to the 'Animation' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS package
LIMIT 3","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 3;
fetch {
  ""package"": $package_name_p
};"
604,Which 3 subscriptions will expire the soonest?,"MATCH (s:Subscription)
RETURN s
ORDER BY s.expiresAt
LIMIT 3","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
sort $exp asc;
limit 3;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
605,What are the top 5 most expensive packages by price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 5","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_price $package_price;
sort $package_price desc;
limit 5;
fetch {
  ""package"": $package_name, ""price"": $package_price
};"
606,List the first 3 genres that are accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $p isa package, has package_name 'Ultimate';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
611,List the first 3 video titles that have been produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 3","match
  $v isa video, has title $title;
  $pc isa production_company, has production_company_name ""Pixar Animation Studios"";
  (media: $v, producer: $pc) isa produced_by;
limit 3;
fetch { ""title"": $title };"
612,List the first 3 adult films with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a.title, a.tagline
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline like "".*sex.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
617,What are the top 5 original titles of movies with an original language of 'en'?,"MATCH (m:Movie {original_language: 'en'})
RETURN m.original_title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has original_title $original_title, has popularity $popularity;
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
sort $popularity desc;
limit 5;
fetch {
  ""original_title"": $original_title
};"
620,List the first 3 genres that are accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $p isa package, has package_name ""Ultimate"";
  (package: $p, genre: $g) isa provides_access_to;
  $g has genre_name $name;
limit 3;
fetch { ""name"": $name };"
623,What are the top 5 movies with the smallest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
630,List the first 3 movies in which 'Tom Hanks' has acted.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
632,What are the top 5 most popular adult films?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
633,List the first 3 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $k isa keyword;
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $k has keyword_name $keyword_name_k;
limit 3;
fetch {
  ""name"": $keyword_name_k
};"
635,What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
636,List the first 3 movies with taglines containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title, m.tagline
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*adventure.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
637,Which 3 adult films have the lowest average vote?,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote
LIMIT 3","match
  $a isa adult_video;
  $a has title $title;
  $a has average_vote $average_vote;
sort $average_vote asc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
638,List the first 3 genres that have movies with no keywords associated.,"MATCH (g:Genre)
WHERE NOT EXISTS {
  (g)<-[:IN_GENRE]-(:Movie)-[:HAS_KEYWORD]->(:Keyword)
}
RETURN g.name
LIMIT 3","match
  $g isa genre, has genre_name $name;
  (media: $m, genre: $g) isa in_genre;
  $m isa movie;
  not { (media: $m, keyword: $k) isa has_keyword; };
limit 3;
fetch { ""name"": $name };"
647,What are the top 5 videos by vote count?,"MATCH (v:Video)
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
648,List the first 3 movies that have been both highly rated and have high revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.average_vote IS NOT NULL
RETURN m.title, m.revenue, m.average_vote
ORDER BY m.average_vote DESC, m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc, $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue, ""average_vote"": $average_vote
};"
650,What are the top 5 adult films by vote count?,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
654,List the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget over $100 million.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has budget $budget_m;
  $m has title $title_m;
  $budget_m > 100000000;
sort $budget_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
656,List the first 3 adult films with a runtime longer than 60 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 60
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 60;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
658,What are the top 5 longest running movies in the database?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
662,List the first 3 packages that provide access to the 'Drama' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p.name AS package
LIMIT 3","match
  $p isa package;
  $g isa genre, has genre_name 'Drama';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 3;
fetch {
  ""package"": $package_name_p
};"
664,What are the top 5 most popular packages based on duration?,"MATCH (p:Package)
RETURN p.name AS package, p.duration AS duration
ORDER BY duration DESC
LIMIT 5","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_duration $package_duration;
limit 5;
fetch {
  ""package"": $package_name, ""duration"": $package_duration
};"
665,List the first 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
667,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
668,List the first 3 movies where the budget was over 50 million USD.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 50000000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
669,Which 5 movies have the highest average vote and have been released?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has status $status;
  $m has average_vote $average_vote;
  $m has title $title;
  $status == ""Released"";
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
670,Find the top 3 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
671,What are the first 5 most popular movies with a popularity score above 20?,"MATCH (m:Movie)
WHERE m.popularity > 20
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has popularity $popularity;
  $m has title $title;
  $popularity > 20;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
672,List the top 3 movies that were released before the year 2000 and have an 'original_language' of 'en'.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.original_language = 'en'
RETURN m.title, m.release_date, m.original_language
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has title $title, has release_date $release_date;
original_language (media: $m, language: $lang);
$lang has language_id $lang_id;
$lang_id == ""en"";
$release_date < 2000-01-01;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title,
  ""release_date"": $release_date,
  ""language"": $lang_id
};"
674,List the first 3 movies with the highest number of votes.,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
675,What are the top 5 movies with the lowest revenue and are still in 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match
  $m isa movie;
  $m has status $status;
  $m has revenue $revenue;
  $m has title $title;
  $status == ""Released"";
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
676,Which 3 movies have the longest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $m has runtime $runtime;
  $status == ""Released"";
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
677,List the top 3 movies with the largest budgets that have been released.,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has budget $budget;
  $m has title $title;
  $status == ""Released"";
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
679,Which 3 movies have the highest popularity but the lowest revenue?,"MATCH (m:Movie)
WHERE m.popularity IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.popularity, m.revenue
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3","match
  $m isa movie;
  $m has popularity $popularity;
  $m has revenue $revenue;
  $m has title $title;
sort $popularity desc, $revenue asc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity, ""revenue"": $revenue
};"
682,List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!',"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m.title
LIMIT 3","match
  $m isa movie, has tagline 'Roll the dice and unleash the excitement!';
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
684,Find the top 3 movies with a specific actor named 'Tom Hanks' in the cast.,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CAST_FOR]->(m:Movie)
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
  $m has release_date $release_date_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m, ""popularity"": $popularity_m
};"
685,What are the top 5 movies that were produced by 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
686,List the first 3 movies that have been translated into the language 'Kiswahili'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
687,Which 3 movies are most commonly spoken in 'Gaeilge'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Gaeilge';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m
};"
689,What are the first 5 movies in the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 5;
fetch {
  ""title"": $title_m
};"
690,Which 3 movies have the most expensive poster paths registered?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $m has budget $budget;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
691,List the top 3 movies where the homepage URL includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $m has popularity $popularity;
  $homepage like "".*disney.*"";
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
693,List the first 3 movies that have an 'average_vote' greater than 8.,"MATCH (m:Movie)
WHERE m.average_vote > 8
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 8;
limit 3;
fetch {
  ""title"": $title
};"
694,Which 5 movies have the shortest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
  $m isa movie;
  $m has status $status;
  $m has runtime $runtime;
  $m has title $title;
  $status == ""Released"";
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
695,List the top 3 movies with the tagline 'What price would you put on your health?',"MATCH (m:Movie)
WHERE m.tagline = 'What price would you put on your health?'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $m has popularity $popularity;
  $tagline == ""What price would you put on your health?"";
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
697,List the top 3 movies that were produced by 'Pixar Animation Studios' and have a runtime longer than 90 minutes.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime > 90
RETURN m.title, m.runtime
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $m has popularity $popularity_m;
  $runtime_m > 90;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""runtime"": $runtime_m
};"
699,List the first 3 movies that have a 'status' of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $status == ""In Production"";
limit 3;
fetch {
  ""title"": $title
};"
702,Which 5 videos have the highest average vote and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 5","match
  $v isa video;
  $v has status $status;
  $v has title $title;
  $v has average_vote $average_vote;
  $status == ""Released"";
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
703,List the first 3 videos with a budget greater than 100000 USD.,"MATCH (v:Video)
WHERE v.budget > 100000
RETURN v.title, v.budget
ORDER BY v.budget DESC
LIMIT 3","match
  $v isa video;
  $v has budget $budget;
  $v has title $title;
  $budget > 100000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
705,List the top 3 videos that have the most votes.,"MATCH (v:Video)
WHERE v.vote_count IS NOT NULL
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 3","match
  $v isa video;
  $v has vote_count $vote_count;
  $v has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
706,Which 3 videos have the longest runtime and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3","match
  $v isa video;
  $v has status $status;
  $v has title $title;
  $v has runtime $runtime;
  $status == ""Released"";
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
707,List the first 5 videos that have been translated into the language 'Azrbaycan'.,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Azrbaycan'})
RETURN v.title
LIMIT 5","match
  $v isa video;
  $l isa language, has language_name 'Azrbaycan';
  $rel0 isa spoken_in_language (media: $v, language: $l);
  $v has title $title_v;
limit 5;
fetch {
  ""title"": $title_v
};"
708,What are the first 3 videos with a 'status' of 'In Production'?,"MATCH (v:Video)
WHERE v.status = 'In Production'
RETURN v.title
LIMIT 3","match
  $v isa video;
  $v has status $status;
  $v has title $title;
  $status == ""In Production"";
limit 3;
fetch {
  ""title"": $title
};"
709,Which 3 adult films have the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
710,List the first 3 adult films with a budget less than 50000 USD.,"MATCH (a:Adult)
WHERE a.budget < 50000
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget < 50000;
limit 3;
fetch {
  ""title"": $title
};"
712,List the top 3 adult films that have been tagged with the keyword 'jealousy'.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 3","match
  $a isa adult_video;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $a, keyword: $k);
  $a has title $title_a;
  $a has popularity $popularity_a;
sort $popularity_a desc;
limit 3;
fetch {
  ""title"": $title_a, ""popularity"": $popularity_a
};"
713,Which 3 adult films have the longest runtime and are in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $a has runtime $runtime;
  $status == ""Released"";
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
714,List the first 5 adult films that have a homepage URL.,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title, a.homepage
LIMIT 5","match
  $a isa adult_video;
  $a has homepage $homepage;
  $a has title $title;
limit 5;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
721,Which 3 packages have the highest price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 3","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_price $package_price;
sort $package_price desc;
limit 3;
fetch {
  ""package"": $package_name, ""price"": $package_price
};"
723,What are the first 3 subscriptions that are about to expire?,"MATCH (s:Subscription)
RETURN s
ORDER BY s.expiresAt
LIMIT 3","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
sort $exp asc;
limit 3;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
734,List the first 3 movies that have a specific keyword 'adventure' and are in the 'Released' status.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
WHERE m.status = 'Released'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'adventure';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has status $status_m;
  $m has title $title_m;
  $status_m == ""Released"";
limit 3;
fetch {
  ""title"": $title_m
};"
737,Which 3 packages have the highest price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 3","match
  $p isa package, has package_name $name, has package_price $price;
sort $price desc;
limit 3;
fetch { ""package"": $name, ""price"": $price };"
738,List the first 3 videos that have a specific keyword 'action' and are in the 'Released' status.,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword {name: 'action'})
WHERE v.status = 'Released'
RETURN v.title, v.release_date, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $k isa keyword, has keyword_name 'action';
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $v has status $status_v;
  $v has title $title_v;
  $v has release_date $release_date_v;
  $v has popularity $popularity_v;
  $status_v == ""Released"";
sort $popularity_v desc;
limit 3;
fetch {
  ""title"": $title_v, ""release_date"": $release_date_v, ""popularity"": $popularity_v
};"
739,What are the top 5 adult films with the lowest vote count and are still in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.vote_count
ORDER BY a.vote_count
LIMIT 5","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $a has vote_count $vote_count;
  $status == ""Released"";
sort $vote_count asc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
740,List the first 3 movies that have an original language of 'es' and are in the 'Released' status.,"MATCH (m:Movie)
WHERE m.original_language = 'es' AND m.status = 'Released'
RETURN m.title
LIMIT 3","match
$m isa movie, has title $title, has status $status;
original_language (media: $m, language: $lang);
$lang has language_id ""es"";
$status == ""Released"";
limit 3;
fetch {
  ""title"": $title
};"
743,What are the first 5 packages that provide access to the genre 'Drama'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p.name AS package
LIMIT 5","match
  $p isa package;
  $g isa genre, has genre_name 'Drama';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 5;
fetch {
  ""package"": $package_name_p
};"
746,List the top 3 videos that have been produced by 'Pixar Animation Studios' and have a runtime shorter than 50 minutes.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE v.runtime < 50
RETURN v.title, v.runtime
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has runtime $runtime_v;
  $v has title $title_v;
  $v has popularity $popularity_v;
  $runtime_v < 50;
sort $popularity_v desc;
limit 3;
fetch {
  ""title"": $title_v, ""runtime"": $runtime_v
};"
748,List the first 3 adult films with a tagline 'Humiliation. Rape. Murder. You know the drill.',"MATCH (a:Adult)
WHERE a.tagline = 'Humiliation. Rape. Murder. You know the drill.'
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline == ""Humiliation. Rape. Murder. You know the drill."";
limit 3;
fetch {
  ""title"": $title
};"
755,What are the top 5 movies with a specific keyword 'space' and have been released?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
WHERE m.status = 'Released'
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'space';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has status $status_m;
  $m has title $title_m;
  $m has release_date $release_date_m;
  $m has popularity $popularity_m;
  $status_m == ""Released"";
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m, ""popularity"": $popularity_m
};"
757,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
762,List the first 3 countries where movies with an average vote above 8 were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 8
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has average_vote $average_vote_m;
  $c has country_name $country_name_c;
  $average_vote_m > 8;
limit 3;
fetch {
  ""name"": $country_name_c
};"
778,List the first 3 countries where movies with an average vote above 8 were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 8
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie, has average_vote $vote;
  $vote > 8;
  (media: $m, country: $c) isa produced_in_country;
  $c has country_name $name;
limit 3;
fetch { ""name"": $name };"
807,List the top 5 adult films with the highest average votes.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
813,List the first 3 countries where the most non-English language movies are produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.original_language <> 'en'
RETURN c.name AS country, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
original_language (media: $m, language: $lang);
not { $lang has language_id ""en""; };
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""count"": $count
};"
814,What are the top 5 most popular videos based on their popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
820,What are the top 3 highest revenue adult films?,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3","match
  $a isa adult_video;
  $a has revenue $revenue;
  $a has title $title;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
822,Which 3 production companies have the most films with an original language of 'en'?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.original_language = 'en'
RETURN c.name AS company, count(*) AS num_films
ORDER BY num_films DESC
LIMIT 3","match
$m isa movie;
$c isa production_company;
produced_by (media: $m, producer: $c);
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""count"": $count
};"
842,What are the top 3 countries producing the most movies with an average vote below 5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote < 5
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS country, movie_count","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has average_vote $average_vote_m;
  $c has country_name $country_name_c;
  $average_vote_m < 5;
reduce $count = count($m);
sort $count desc;
limit 3;
fetch {
  ""count"": $count
};"
863,What are the top 5 movies by revenue that have a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $m has revenue $revenue;
  $runtime > 120;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
867,What are the first 3 genres associated with movies that have a popularity greater than 20?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.popularity > 20
RETURN g.name AS genre
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has popularity $popularity_m;
  $g has genre_name $genre_name_g;
  $popularity_m > 20;
sort $popularity_m desc;
limit 3;
fetch {
  ""genre"": $genre_name_g
};"
868,List the 5 countries where movies with a revenue greater than 500 million USD were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 500000000
RETURN c.name AS country
LIMIT 5","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has revenue $revenue_m;
  $c has country_name $country_name_c;
  $revenue_m > 500000000;
limit 5;
fetch {
  ""country"": $country_name_c
};"
871,What are the first 3 collections that include movies with a budget over 50 million USD?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WHERE m.budget > 50000000
RETURN c.name
LIMIT 3","match
  $c isa collection;
  $m isa movie;
  $rel0 isa in_collection (collection: $c, media: $m);
  $c has collection_name $collection_name_c;
  $m has budget $budget_m;
  $budget_m > 50000000;
limit 3;
fetch {
  ""name"": $collection_name_c
};"
880,"List the first 5 movies that have been tagged with a specific keyword, e.g., 'adventure'.","MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'adventure';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
882,"List the top 5 movies that have been produced by a specific company, e.g., 'Pixar Animation Studios'.","MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m, ""popularity"": $popularity_m
};"
885,List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!'.,"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m.title
LIMIT 3","match
  $m isa movie, has tagline 'Roll the dice and unleash the excitement!';
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
888,Name the first 5 genres that videos with a popularity rating above 5 belong to.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.popularity > 5
RETURN g.name AS genre
LIMIT 5","match
  $v isa video;
  $g isa genre;
  $rel0 isa in_genre (media: $v, genre: $g);
  $v has popularity $popularity_v;
  $g has genre_name $genre_name_g;
  $popularity_v > 5;
limit 5;
fetch {
  ""genre"": $genre_name_g
};"
889,What are the top 3 adult films with the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
898,Name the first 5 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
limit 5;
fetch {
  ""title"": $title
};"
900,List the first 5 languages used in the original language of adult films.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN DISTINCT l.name AS language
LIMIT 5","match
  $a isa adult_video;
  $l isa language;
  $rel0 isa original_language (media: $a, language: $l);
  $l has language_name $language_name_l;
limit 5;
fetch {
  ""language"": $language_name_l, ""name"": $language_name_l
};"
903,What are the first 3 collections that include videos?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(v:Video)
RETURN c.name AS collection
ORDER BY c.name
LIMIT 3","match
  $c isa collection;
  $v isa video;
  $rel0 isa in_collection (collection: $c, media: $v);
  $c has collection_name $collection_name_c;
sort $collection_name_c asc;
limit 3;
fetch {
  ""collection"": $collection_name_c
};"
905,"List the first 3 adult films with a specific tagline, e.g., 'Trust Will Get You Killed'.","MATCH (a:Adult)
WHERE a.tagline = 'Trust Will Get You Killed'
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline == ""Trust Will Get You Killed"";
limit 3;
fetch {
  ""title"": $title
};"
907,List the top 3 movies with a budget over 100 million USD and an average vote above 7.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.average_vote > 7
RETURN m.title, m.budget, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has average_vote $average_vote;
  $m has title $title;
  $budget > 100000000;
  $average_vote > 7;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget, ""average_vote"": $average_vote
};"
908,"Name the first 5 movies that were produced by a specific country, e.g., 'France'.","MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'France'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $c isa country, has country_name 'France';
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
914,"Name the top 5 movies that have been produced in a specific genre, e.g., 'Animation'.","MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
0,Which movies were released in 1995?,"MATCH (m:Movie)
WHERE m.release_date STARTS WITH '1995'
RETURN m.title, m.release_date","match $m isa movie, has release_date $release_date, has title $title; $release_date >= 1995-01-01T00:00:00; $release_date < 1996-01-01T00:00:00; fetch { ""title"": $title, ""release_date"": $release_date };"
7,Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
  $u isa user, has user_id ""1"";
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
  $m has title $title_m;
fetch {
  ""movie"": $title_m, ""rating"": $rating
};"
21,List the first 3 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster_path $poster_path, has title $title;
$poster_path like "".*\\.jpg"";
limit 3;
fetch { ""title"": $title };"
29,Name 3 movies spoken in more than one language.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
WHERE languageCount > 1
RETURN m.title
LIMIT 3","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
match $count > 1;
limit 3;
fetch { ""title"": $m.title };"
31,List the first 3 movies with an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title, m.imdb_id
LIMIT 3","match
$m isa movie;
$m has imdb_id $imdb_id;
$imdb_id like ""tt.*"";
$m has title $title;
limit 3;
fetch { ""title"": $title, ""imdb_id"": $imdb_id };"
32,Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 1
RETURN m.title AS movie, num_countries","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $num_countries = count($c) groupby $m;
match $num_countries > 1;
fetch {
  ""movie"": $m.title,
  ""num_countries"": $num_countries
};"
50,Display movies that have been released in the 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE m.status = 'Released'
RETURN m","match
$m isa movie, has status ""Released"";
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
fetch {
  ""movie"": {
    ""title"": $m.title,
    ""status"": $m.status
  }
};"
53,What are the movies directed by a person who has also acted in a movie?,"MATCH (director:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)<-[:CAST_FOR]-(actor:Person)
WHERE director = actor
RETURN m.title AS movie, director.name AS director","match
$p isa person, has person_name $name;
$m isa movie, has title $title;
$crew isa crew_for (crew_member: $p, film: $m), has job ""Director"";
cast_for (actor: $p, film: $any_movie);
fetch {
  ""movie"": $title,
  ""director"": $name
};"
55,Display all movies that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has title $title;
fetch {
  ""title"": $title,
  ""release_date"": $rd
};"
59,Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
WHERE languageCount > 3
RETURN m.title AS movie, languageCount AS translatedLanguages","match
$m isa movie, has title $title;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m, $title;
match $count > 3;
sort $title;
fetch {
  ""movie"": $title,
  ""translatedLanguages"": $count
};"
61,Find all movies where Tom Hanks is listed first in the cast.,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CAST_FOR]->(m:Movie)
WHERE r.order = 0
RETURN m","match
$p isa person, has person_name ""Tom Hanks"";
$rel isa cast_for (actor: $p, film: $m), has cast_order 0;
$m isa movie;
fetch {
  ""movie"": { ""title"": $m.title }
};"
62,Which movies are associated with more than one production company?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WITH m, count(c) AS num_companies
WHERE num_companies > 1
RETURN m.title AS movie, num_companies","match
$m isa movie;
produced_by (media: $m, producer: $c);
reduce $num_companies = count($c) groupby $m;
match $num_companies > 1;
fetch {
  ""movie"": $m.title,
  ""num_companies"": $num_companies
};"
63,Display the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget / m.revenue AS budget_revenue_ratio
ORDER BY budget_revenue_ratio DESC
LIMIT 5","match
$m isa movie, has budget $budget, has revenue $revenue;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""budget_revenue_ratio"": $ratio
};"
66,Identify all movies that were produced in a country other than the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name <> 'United States of America'
RETURN m.title, c.name","match
$m isa movie, has title $title;
$c isa country, has country_name $cname;
produced_in_country (media: $m, country: $c);
not { $cname == ""United States of America""; };
fetch {
  ""title"": $title,
  ""country"": $cname
};"
67,List all movies that have been rated by user with ID 1.,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating","match
$u isa user, has user_id ""1"";
$r isa rated (reviewer: $u, rated_media: $m);
$m isa movie;
$r has rating $rating;
fetch {
  ""title"": $m.title,
  ""rating"": $rating
};"
70,Which movies have the most keywords associated with them?,"MATCH (m:Movie)-[r:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(r) AS num_keywords
ORDER BY num_keywords DESC
LIMIT 10","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $num_keywords = count($k) groupby $m, $t;
sort $num_keywords desc;
limit 10;
fetch {
  ""movie"": $t,
  ""num_keywords"": $num_keywords
};"
79,Find all movies where the original and spoken languages are different.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(origLang:Language)
WHERE exists {
  (m)-[:SPOKEN_IN_LANGUAGE]->(spokenLang:Language)
  WHERE spokenLang <> origLang
}
RETURN m.title AS movie, origLang.name AS originalLanguage,
       [(m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language) | sl.name] AS spokenLanguages","match
$m isa movie;
original_language (media: $m, language: $origLang);
spoken_in_language (media: $m, language: $spokenLang);
$origLang has language_id $origId;
$spokenLang has language_id $spokenId;
$origId != $spokenId;
fetch {
  ""movie"": $m.title,
  ""originalLanguage"": $origLang.language_name,
  ""spokenLanguage"": $spokenLang.language_name
};"
81,Which movies have more than three genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 3
RETURN m.title AS movie, genreCount","match
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $genreCount = count($g) groupby $m;
match $genreCount > 3;
fetch {
  ""movie"": $m.title,
  ""genreCount"": $genreCount
};"
84,List all movies produced in countries where the primary language is not English.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE NOT EXISTS {
  (m)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'English'})
}
RETURN m.title AS movie, c.name AS country","match
$m isa movie;
produced_in_country (media: $m, country: $c);
not { 
  original_language (media: $m, language: $l);
  $l has language_name ""English"";
};
fetch {
  ""movie"": $m.title,
  ""country"": $c.country_name
};"
85,Which movies have the highest number of associated keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keywordCount
RETURN m.title AS movie, keywordCount
ORDER BY keywordCount DESC
LIMIT 10","match
$m isa movie, has title $title;
has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m, $title;
sort $keyword_count desc;
limit 10;
fetch {
  ""movie"": $title,
  ""keywordCount"": $keyword_count
};"
95,How many movies have a budget greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN count(m)","match
$m isa movie, has budget $b;
$b > 100000000;
reduce $count = count($m);"
106,Who are the top 5 most frequent directors in the movies dataset?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
RETURN p.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $p isa person, has person_name $pn;
  $m isa movie;
  crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $num_movies = count($m) groupby $p, $pn;
sort $num_movies desc;
limit 5;
fetch { ""director"": $pn, ""num_movies"": $num_movies };"
108,List the first 3 production companies by the number of movies produced.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
110,What are the top 5 movies with the most user ratings?,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
  $m isa movie, has title $title;
  rated (reviewer: $u, rated_media: $m);
reduce $count = count groupby $m, $title;
sort $count desc;
limit 5;
fetch { ""title"": $title, ""num_ratings"": $count };"
111,Which movies have been rated by user '1'?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
  $u isa user, has user_id ""1"";
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
  $m has title $title_m;
fetch {
  ""movie"": $title_m, ""rating"": $rating
};"
116,List the first 5 movies that have been associated with more than one genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 1
RETURN m.title
LIMIT 5","match
$m isa movie;
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $count = count($g) groupby $m;
match $count > 1;
limit 5;
fetch { ""title"": $m.title };"
119,List the first 3 genres most commonly found in videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn };"
124,What are the top 3 countries by the number of adult films produced?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adult_film_count"": $count };"
126,What are the top 3 countries by the number of adult films produced?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $name;
  produced_in_country (media: $a, country: $c);
  $a isa adult_video;
reduce $count = count($a) groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""country"": $name, ""adultFilmCount"": $count };"
129,List the first 3 production companies that have produced the most adult films.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
WITH c, count(a) AS adultCount
ORDER BY adultCount DESC
LIMIT 3
RETURN c.name AS productionCompany, adultCount","match
  $c isa production_company, has production_company_name $name;
  $a isa adult_video;
  produced_by (producer: $c, media: $a);
reduce $count = count($a) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""productionCompany"": $name,
  ""adultCount"": $count
};"
133,List the first 5 subscriptions that expire in 2020.,"MATCH (s:Subscription)
WHERE s.expiresAt >= date('2020-01-01') AND s.expiresAt < date('2021-01-01')
RETURN s
LIMIT 5","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
  $exp >= 2020-01-01T00:00:00;
  $exp < 2021-01-01T00:00:00;
sort $exp asc;
limit 5;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
134,What are the prices of the packages named 'Gold' and 'Platinum'?,"MATCH (p:Package)
WHERE p.name IN ['Gold', 'Platinum']
RETURN p.name AS package, p.price AS price","match
$p isa package;
$p has package_name $package_name;
$p has package_price $package_price;
{ $package_name == ""Gold""; } or { $package_name == ""Platinum""; };
fetch { ""package"": $package_name, ""price"": $package_price };"
136,What are the top 3 videos rated by users?,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN v.title AS video, avg(r.rating) AS averageRating
ORDER BY averageRating DESC
LIMIT 3","match
  $v isa video, has title $title;
  $rel isa rated (rated_media: $v), has rating $rating;
reduce $avg = mean($rating) groupby $v, $title;
sort $avg desc;
limit 3;
fetch { ""video"": $title, ""averageRating"": $avg };"
138,What are the top 3 movies by vote count that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has vote_count $vc;
sort $vc desc;
limit 3;
fetch { ""title"": $m.title, ""vote_count"": $vc };"
139,Which movies have a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.budget, m.revenue","match
$m isa movie;
$m has revenue $revenue;
$m has budget $budget;
$revenue > $budget;
fetch {
  ""title"": $m.title,
  ""budget"": $budget,
  ""revenue"": $revenue
};"
144,What are the first 5 production companies by the number of genres they produce movies in?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]->(:Movie)-[:IN_GENRE]->(g:Genre)
WITH c, count(distinct g) AS num_genres
ORDER BY num_genres DESC
LIMIT 5
RETURN c.name AS company, num_genres","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  $g isa genre;
  produced_by (media: $m, producer: $c);
  in_genre (media: $m, genre: $g);
select $c, $g, $name;
distinct;
reduce $num_genres = count($g) groupby $c, $name;
sort $num_genres desc;
limit 5;
fetch {
  ""company"": $name,
  ""num_genres"": $num_genres
};"
145,Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 1
RETURN m.title AS movie, num_countries","match $m isa movie; $c isa country; produced_in_country (media: $m, country: $c); reduce $num_countries = count($c) groupby $m; match $num_countries > 1; fetch { ""movie"": $m.title, ""num_countries"": $num_countries };"
146,List the first 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
LIMIT 5","match
$m isa movie;
$m has poster_path $poster_path;
$poster_path like "".*\\.jpg"";
$m has title $title;
limit 5;
fetch { ""title"": $title, ""poster_path"": $poster_path };"
147,What are the jobs of the first 3 crew members for the movie with the highest budget?,"MATCH (m:Movie)<-[r:CREW_FOR]-(p:Person)
WITH m, r, p
ORDER BY m.budget DESC
LIMIT 1
WITH m, collect({job: r.job, person: p}) AS crew
RETURN m.title AS movie, crew[0..2] AS crew_jobs","match
  $m isa movie, has budget $budget, has title $title;
  $r isa crew_for (film: $m, crew_member: $p), has job $job;
sort $budget desc;
limit 3;
fetch {
  ""movie"": $title,
  ""job"": $job
};"
148,Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
WHERE languageCount > 3
RETURN m.title AS movie, languageCount AS translatedLanguages","match 
$m isa movie; 
$l isa language; 
spoken_in_language (media: $m, language: $l);
$m has title $title;
reduce $count = count($l) groupby $m, $title;
match $count > 3;
fetch { ""movie"": $title, ""translatedLanguages"": $count };"
149,Which movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[r:HAS_KEYWORD]->(k:Keyword)
WITH m, count(r) AS num_keywords
RETURN m.title AS movie, num_keywords
ORDER BY num_keywords DESC
LIMIT 10","match
  $m isa movie;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 10;
fetch {
  ""movie"": $m.title,
  ""num_keywords"": $count
};"
150,What are the first 3 movies with the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget / m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 3","match
$m isa movie;
$m has budget $budget;
$m has revenue $revenue;
$m has title $title;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""ratio"": $ratio
};"
201,Show the top 3 movies that have been reviewed most recently by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, r.timestamp AS reviewedAt
ORDER BY r.timestamp DESC
LIMIT 3","match
$m isa movie, has title $title;
$u isa user;
$r isa rated (rated_media: $m, reviewer: $u), has timestamp $timestamp;
sort $timestamp desc;
limit 3;
fetch {
  ""movie"": $title,
  ""reviewedAt"": $timestamp
};"
207,Which 5 subscriptions are linked to the 'Ultimate' package?,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package {name: 'Ultimate'})
RETURN s
LIMIT 5","match
  $s isa subscription;
  $p isa package, has package_name ""Ultimate"";
  for_package (subscription: $s, package: $p);
limit 5;
fetch { ""subscription"": $s.subscription_id };"
208,List the top 3 genres most frequently associated with videos.,"MATCH (g:Genre)<-[:IN_GENRE]-(v:Video)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $frequency = count($v) groupby $g, $gn;
sort $frequency desc;
limit 3;
fetch { ""genre"": $gn, ""frequency"": $frequency };"
209,What are the first 5 countries where most adult films are produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
210,Which 3 languages are most common in adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa adult_video;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
213,What are the top 5 videos that have been rated by the most users?,"MATCH (v:Video)<-[r:RATED]-(u:User)
WITH v, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5
RETURN v.title AS video, numRatings","match
  $v isa video, has title $title;
  $u isa user;
  $r isa rated (rated_media: $v, reviewer: $u);
reduce $count = count($r) groupby $v, $title;
sort $count desc;
limit 5;
fetch {
  ""video"": $title,
  ""numRatings"": $count
};"
214,Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
RETURN v.title AS video, keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""keywordCount"": $count
};"
216,List the top 3 collections with the most movies included.,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  $m isa movie;
  in_collection (media: $m, collection: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 3;
fetch { ""collection"": $cn, ""num_movies"": $num_movies };"
218,Which 3 production companies have produced the most movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""company"": $name, ""num_movies"": $count };"
221,What are the top 5 languages spoken in movies that have a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $m isa movie, has budget $budget;
  $budget > 50000000;
  spoken_in_language (media: $m, language: $l);
  $l has language_name $ln;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
222,Which 3 countries have produced the most movies in the genre 'Drama'?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
RETURN c.name AS country, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa movie;
  $g isa genre, has genre_name ""Drama"";
  produced_in_country (media: $m, country: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""num_movies"": $count };"
223,Show the first 5 movies that have a character named 'Charlie Wilson' in their cast.,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.name = 'Tom Hanks' AND exists{ (p)-[:CAST_FOR {character: 'Charlie Wilson'}]->(m) }
RETURN m.title
LIMIT 5","match
$m isa movie;
$rel isa cast_for (actor: $p, film: $m);
$rel has character ""Charlie Wilson"";
$m has title $title;
limit 5;
fetch { ""title"": $title };"
224,List the top 3 people with the most crew roles in movies.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
RETURN p.name AS person, count(r) AS num_crew_roles
ORDER BY num_crew_roles DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie;
  $rel isa crew_for (crew_member: $p, film: $m);
reduce $num_crew_roles = count($rel) groupby $p, $pn;
sort $num_crew_roles desc;
limit 3;
fetch { ""person"": $pn, ""num_crew_roles"": $num_crew_roles };"
226,Which 3 movies have changed their status from 'In Production' to 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND exists {
  (m)-[:HAS_KEYWORD]->(:Keyword {name: 'in production'})
}
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has status ""Released"";
  $k isa keyword, has keyword_name ""in production"";
  has_keyword (media: $m, keyword: $k);
limit 3;
fetch {
  ""title"": $m.title
};"
227,Show the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $poster_path
};"
229,What are the top 5 movies that have undergone a title change after release?,"MATCH (m:Movie)
WHERE m.title <> m.original_title
RETURN m.title AS title, m.original_title AS original_title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$m has title $title;
$m has original_title $original_title;
$m has popularity $popularity;
not { $title == $original_title; };
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title,
  ""original_title"": $original_title
};"
230,Which 3 movies have the highest discrepancy between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie,
    has budget $budget,
    has revenue $revenue,
    has title $title;
let $discrepancy = $revenue - $budget;
sort $discrepancy desc;
limit 3;
fetch {
    ""title"": $title,
    ""budget"": $budget,
    ""revenue"": $revenue,
    ""discrepancy"": $discrepancy
};"
231,Show the first 5 movies where the original language is not English but have English as a spoken language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language)
WHERE ol.name <> 'English'
AND EXISTS {
  (m)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'English'})
}
RETURN m.title
LIMIT 5","match $m isa movie; $ol isa language, has language_name $ol_name; $ol_name != ""English""; original_language (media: $m, language: $ol); $english isa language, has language_name ""English""; spoken_in_language (media: $m, language: $english); $m has title $title; limit 5; fetch { ""title"": $title };"
236,What are the top 5 movies with the most significant number of languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 5
RETURN m.title AS movie, languageCount AS spokenLanguages","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""spokenLanguages"": $count
};"
238,List the top 3 videos that have a revenue of zero.,"MATCH (v:Video)
WHERE v.revenue = 0
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has revenue $revenue;
  $revenue == 0.0;
  $v has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""popularity"": $popularity
};"
245,Show the first 5 adult films based on their IMDB ID starting with 'tt007'.,"MATCH (a:Adult)
WHERE a.imdb_id STARTS WITH 'tt007'
RETURN a.title, a.imdb_id
ORDER BY a.imdb_id
LIMIT 5","match
$a isa adult_video;
$a has imdb_id $imdb_id;
$imdb_id like ""^tt007.*"";
$a has title $title;
sort $imdb_id asc;
limit 5;
fetch { ""title"": $title, ""imdb_id"": $imdb_id };"
253,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch { ""movie"": $m.title, ""keywordCount"": $count };"
257,Which 3 languages are spoken in the most number of movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""movieCount"": $count };"
258,Name the top 5 production companies by the number of movies produced.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name };"
259,What are the first 3 genres that have the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $movie_count = count($m) groupby $g, $gn;
sort $movie_count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $movie_count };"
260,List 5 countries where the most movies were produced.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
reduce $movie_count = count($m) groupby $c, $cn;
sort $movie_count desc;
limit 5;
fetch { ""country"": $cn, ""movieCount"": $movie_count };"
261,Which 3 collections contain the most movies?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  $m isa movie;
  in_collection (media: $m, collection: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 3;
fetch { ""collection"": $cn, ""num_movies"": $num_movies };"
266,Name the top 5 movies with the most budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget / m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 5","match
$m isa movie, has budget $budget, has revenue $revenue, has title $title;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 5;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""ratio"": $ratio
};"
267,List the top 5 languages based on the number of movies originally in that language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  $m isa movie;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""movieCount"": $count };"
269,What are the first 3 movies that are not part of any collection?,"MATCH (m:Movie)
WHERE NOT EXISTS {(m)-[:IN_COLLECTION]->(:Collection)}
RETURN m.title
LIMIT 3","match
$m isa movie;
not { in_collection (media: $m, collection: $c); };
limit 3;
fetch { ""title"": $m.title };"
271,Which 3 movies have the most revenue among those released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
272,Name the top 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'love'
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$m has tagline $tagline;
$tagline like ""(?i).*love.*"";
$m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $m.title };"
275,Name the top 5 genres by the average votes of the movies in them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, avg(m.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 5
RETURN g.name AS genre, avg_vote","match
  $g isa genre, has genre_name $name;
  $m isa movie, has average_vote $vote;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($vote) groupby $g, $name;
sort $avg desc;
limit 5;
fetch {
  ""genre"": $name,
  ""avg_vote"": $avg
};"
277,Which 3 countries have the least number of movies produced in them?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count asc;
limit 3;
fetch { ""country"": $cn, ""movieCount"": $count };"
285,Which 3 adult videos have the most keywords associated with them?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS keywordCount
RETURN a.title, keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $a isa adult_video, has title $title;
  has_keyword (media: $a, keyword: $k);
reduce $keywordCount = count($k) groupby $a, $title;
sort $keywordCount desc;
limit 3;
fetch {
  ""title"": $title,
  ""keywordCount"": $keywordCount
};"
287,What are the first 3 adult videos not produced in any country listed?,"MATCH (a:Adult)
WHERE NOT EXISTS {
  (a)-[:PRODUCED_IN_COUNTRY]->(:Country)
}
RETURN a.title
LIMIT 3","match
$a isa adult_video;
not { produced_in_country (media: $a, country: $c); };
limit 3;
fetch { ""title"": $a.title };"
292,Which 3 packages provide access to the most genres?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
WITH p, count(g) AS genreCount
RETURN p.name AS package, genreCount
ORDER BY genreCount DESC
LIMIT 3","match
  $p isa package, has package_name $name;
  provides_access_to (package: $p, genre: $g);
reduce $count = count($g) groupby $p, $name;
sort $count desc;
limit 3;
fetch {
  ""package"": $name,
  ""genreCount"": $count
};"
295,List the top 5 packages by the number of subscriptions associated with them.,"MATCH (p:Package)<-[:FOR_PACKAGE]-(s:Subscription)
RETURN p.name AS package, count(s) AS subscriptions
ORDER BY subscriptions DESC
LIMIT 5","match
  $p isa package, has package_name $name;
  for_package (subscription: $s, package: $p);
reduce $count = count($s) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""package"": $name, ""subscriptions"": $count };"
298,What are the first 3 movies with the most associated cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
RETURN m.title AS movie, count(p) AS cast_size
ORDER BY cast_size DESC
LIMIT 3","match
  $m isa movie;
  cast_for (actor: $p, film: $m);
reduce $cast_size = count($p) groupby $m;
sort $cast_size desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""cast_size"": $cast_size
};"
299,List the top 5 movies with the most crew members in the 'Production' department.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WHERE exists{ (p)-[:CREW_FOR {department: 'Production'}]->(m) }
WITH m, count(p) AS crewCount
RETURN m.title AS movie, crewCount
ORDER BY crewCount DESC
LIMIT 5","match
  $m isa movie, has title $title;
  $rel isa crew_for (crew_member: $p, film: $m), has department ""Production"";
reduce $count = count($p) groupby $m, $title;
sort $count desc;
limit 5;
fetch {
  ""movie"": $title,
  ""crewCount"": $count
};"
300,Which 3 movies have the highest number of associated languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
RETURN m.title AS movie, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""languageCount"": $count
};"
301,Name the top 5 countries based on the number of languages spoken in their produced movies.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH c, count(distinct l) AS numLanguages
RETURN c.name AS country, numLanguages
ORDER BY numLanguages DESC
LIMIT 5","match
  $c isa country, has country_name $country_name;
  $m isa movie;
  $l isa language;
  spoken_in_language (media: $m, language: $l);
  produced_in_country (country: $c, media: $m);
select $c, $l, $country_name;
distinct;
reduce $num_languages = count groupby $c, $country_name;
sort $num_languages desc;
limit 5;
fetch {
  ""country"": $country_name,
  ""numLanguages"": $num_languages
};"
302,What are the first 3 movies with the highest number of associated production companies?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN m.title AS movie, count(c) AS num_production_companies
ORDER BY num_production_companies DESC
LIMIT 3","match
  $m isa movie, has title $t;
  produced_by (media: $m, producer: $c);
reduce $count = count($c) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""num_production_companies"": $count };"
303,List the top 5 movies that are rated by the most users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(u) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
$m isa movie, has title $title;
$u isa user;
rated (rated_media: $m, reviewer: $u);
reduce $num_ratings = count($u) groupby $m, $title;
sort $num_ratings desc;
limit 5;
fetch { ""title"": $title, ""num_ratings"": $num_ratings };"
304,Which 3 movies have the most associated genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS movie, genreCount","match
$m isa movie;
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $count = count($g) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""genreCount"": $count
};"
305,Name the top 5 movies with the most associated collections.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title, count(c) AS num_collections
ORDER BY num_collections DESC
LIMIT 5","match
  $m isa movie, has title $title;
  $c isa collection;
  in_collection (media: $m, collection: $c);
reduce $num_collections = count($c) groupby $m, $title;
sort $num_collections desc;
limit 5;
fetch { ""title"": $title, ""num_collections"": $num_collections };"
306,What are the first 3 videos with the most associated keywords?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3
RETURN v.title AS video, keywordCount","match
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""keywordCount"": $count
};"
307,List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN v.title AS video, count(c) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","match
  $v isa video, has title $title;
  produced_in_country (media: $v, country: $c);
reduce $count = count($c) groupby $v, $title;
sort $count desc;
limit 5;
fetch { ""video"": $title, ""numCountries"": $count };"
308,Which 3 videos have the highest number of associated production companies?,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany)
WITH v, count(c) AS companyCount
RETURN v.title AS video, companyCount
ORDER BY companyCount DESC
LIMIT 3","match
  $v isa video;
  produced_by (media: $v, producer: $c);
reduce $count = count($c) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""companyCount"": $count
};"
309,Name the top 5 videos with the most associated genres.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH v, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN v.title AS video, genreCount","match
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $count = count($g) groupby $v;
sort $count desc;
limit 5;
fetch {
  ""video"": $v.title,
  ""genreCount"": $count
};"
313,Name the top 5 videos with the most crew members in the 'Production' department.,"MATCH (v:Video)<-[:CREW_FOR]-(p:Person)
WHERE EXISTS {
  (p)-[:CREW_FOR {department: 'Production'}]->(v)
}
WITH v, count(p) AS crewCount
RETURN v.title AS video, crewCount
ORDER BY crewCount DESC
LIMIT 5","match
  $v isa video, has title $title;
  $p isa person;
  $rel isa crew_for (crew_member: $p, film: $v), has department ""Production"";
reduce $count = count($p) groupby $v, $title;
sort $count desc;
limit 5;
fetch {
  ""video"": $title,
  ""crewCount"": $count
};"
314,What are the first 3 videos with the highest number of associated languages?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH v, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 3
RETURN v.title AS video, languageCount","match
  $v isa video;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($l) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""languageCount"": $count
};"
315,List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(c) AS countryCount
ORDER BY countryCount DESC
LIMIT 5
RETURN v.title AS video, countryCount AS numberOfCountries","match
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($c) groupby $v;
sort $count desc;
limit 5;
fetch {
  ""video"": $v.title,
  ""numberOfCountries"": $count
};"
324,What are the top 5 production companies that have produced the most number of movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 5;
fetch { ""company"": $cn, ""num_movies"": $num_movies };"
326,Which 3 countries have produced the most number of videos?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $v isa video;
  $c isa country, has country_name $cn;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
330,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $r isa rated (reviewer: $u, rated_media: $m);
  $m isa movie;
reduce $num_ratings = count($r) groupby $u;
sort $num_ratings desc;
limit 3;
fetch {
  ""user"": $u,
  ""num_ratings"": $num_ratings
};"
331,List the top 5 genres that have been accessed by the package named 'Platinum'.,"MATCH (p:Package {name: 'Platinum'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre, count(*) AS accessCount
ORDER BY accessCount DESC
LIMIT 5","match
  $p isa package, has package_name ""Platinum"";
  $g isa genre, has genre_name $gn;
  provides_access_to (package: $p, genre: $g);
limit 5;
fetch { ""genre"": $gn };"
336,Name the top 5 countries where the original language of the movie is Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {name: 'es'})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS spanishMovieCount
ORDER BY spanishMovieCount DESC
LIMIT 5","match
  $l isa language, has language_id ""es"";
  $m isa movie;
  original_language (media: $m, language: $l);
  $c isa country, has country_name $cn;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""spanishMovieCount"": $count };"
339,Which 3 genres do the most movies belong to?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
341,What are the top 5 languages spoken in the adult films?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $a, language: $l);
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
343,List the top 5 users who have rated videos the most.,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN u.id AS user, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
  $u isa user, has user_id $uid;
  $v isa video;
  rated (rated_media: $v, reviewer: $u);
reduce $num_ratings = count groupby $u, $uid;
sort $num_ratings desc;
limit 5;
fetch { ""user"": $uid, ""num_ratings"": $num_ratings };"
344,What are the first 3 production companies that produced videos with zero revenue?,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE v.revenue = 0
RETURN DISTINCT c.name
LIMIT 3","match
  $v isa video, has revenue 0;
  produced_by (media: $v, producer: $c);
  $c has production_company_name $name;
limit 3;
fetch { ""name"": $name };"
349,List the top 5 countries that have produced the most movies in the 'Comedy' genre.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN c.name AS country, count(m) AS comedyMovies
ORDER BY comedyMovies DESC
LIMIT 5","match
  $g isa genre, has genre_name ""Comedy"";
  $m isa movie;
  in_genre (media: $m, genre: $g);
  $c isa country, has country_name $cn;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""comedyMovies"": $count };"
352,Name the top 5 languages in which the most movies have been originally made.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $m isa movie;
  $l isa language, has language_name $ln;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""movieCount"": $count };"
355,Which 3 movies have an average vote less than 5 and have been produced in the country with ID 'US'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {id: 'US'})
WHERE m.average_vote < 5
RETURN m.title
LIMIT 3","match
$m isa movie, has average_vote $average_vote, has title $title;
$country isa country, has country_id ""US"";
produced_in_country (media: $m, country: $country);
$average_vote < 5;
limit 3;
fetch { ""title"": $title };"
357,Name the top 5 most frequently used keywords in videos.,"MATCH (k:Keyword)<-[:HAS_KEYWORD]-(v:Video)
RETURN k.name AS Keyword, count(*) AS Frequency
ORDER BY Frequency DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $count };"
359,List the top 5 highest-rated movies by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 5
RETURN m.title AS movie, avg_rating","match
  $m isa movie, has title $title;
  $u isa user;
  $r isa rated (rated_media: $m, reviewer: $u), has rating $rating;
reduce $avg = mean($rating) groupby $m, $title;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $title,
  ""avg_rating"": $avg
};"
364,List the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
365,Which 3 persons have the most crew credits in movies released after 2010?,"MATCH (p:Person)-[c:CREW_FOR]->(m:Movie)
WHERE m.release_date > date('2010-01-01')
WITH p, count(c) AS crewCount
ORDER BY crewCount DESC
LIMIT 3
RETURN p.name AS person, crewCount","match
  $p isa person, has person_name $name;
  $m isa movie, has release_date $rd;
  $rd > 2010-01-01;
  $crew isa crew_for (crew_member: $p, film: $m);
reduce $crew_count = count($crew) groupby $p, $name;
sort $crew_count desc;
limit 3;
fetch { ""person"": $name, ""crew_count"": $crew_count };"
366,List the first 3 genres where the most movies have been produced.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
368,List the top 5 movies where the revenue exceeded the budget by over 100 million USD.,"MATCH (m:Movie)
WHERE m.revenue - m.budget > 100000000
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue - m.budget DESC
LIMIT 5","match
$m isa movie;
$m has revenue $revenue;
$m has budget $budget;
$m has title $title;
let $diff = $revenue - $budget;
$diff > 100000000;
sort $diff desc;
limit 5;
fetch {
  ""title"": $title,
  ""revenue"": $revenue,
  ""budget"": $budget
};"
370,List the first 3 persons who have worked as producers in more than 5 movies.,"MATCH (p:Person)-[:CREW_FOR {job: 'Producer'}]->(m:Movie)
WITH p, count(m) AS num_movies
WHERE num_movies > 5
RETURN p.name
ORDER BY num_movies DESC
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
crew_for (crew_member: $p, film: $m), has job ""Producer"";
reduce $count = count($m) groupby $p, $name;
match $count > 5;
sort $count desc;
limit 3;
fetch { ""name"": $name };"
374,Which 3 movies have the most languages spoken in them?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
RETURN m.title AS movie, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""languageCount"": $count
};"
376,Name the top 5 movies that have an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$m has imdb_id $imdb_id;
$imdb_id like ""tt.*"";
$m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $m.title };"
377,What are the first 3 movies that have been rated by the user with ID '1'?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title
ORDER BY r.timestamp
LIMIT 3","match
  $u isa user, has user_id ""1"";
  $r isa rated (reviewer: $u, rated_media: $m);
  $r has timestamp $ts;
  $m has title $title;
sort $ts asc;
limit 3;
fetch { ""title"": $title };"
380,Name the top 5 production companies that have produced the highest grossing movies.,"MATCH (m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany)
WHERE m.revenue IS NOT NULL
RETURN c.name AS company, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has revenue $rev;
  produced_by (media: $m, producer: $c);
reduce $total_revenue = sum($rev) groupby $c, $cn;
sort $total_revenue desc;
limit 5;
fetch { ""company"": $cn, ""total_revenue"": $total_revenue };"
382,List the top 5 countries where the most adult films have been produced.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 5","match
  $a isa adult_video;
  $c isa country, has country_name $cn;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
386,What are the first 3 movies that have a poster path containing '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*/vzmL6fP7aPKNKPRTFnZmiUfciyV\\.jpg.*"";
limit 3;
fetch {
  ""title"": $m.title
};"
392,List the top 5 movies with the most extensive production crew.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WITH m, count(p) AS crewSize
RETURN m.title AS movie, crewSize
ORDER BY crewSize DESC
LIMIT 5","match
$m isa movie;
crew_for (film: $m, crew_member: $p);
reduce $crewSize = count($p) groupby $m;
sort $crewSize desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""crewSize"": $crewSize
};"
394,List the top 5 languages in which the most adult films have been originally made.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  $l isa language;
  original_language (media: $a, language: $l);
reduce $count = count($a) groupby $l;
sort $count desc;
limit 5;
fetch { ""language"": $l.language_name, ""count"": $count };"
395,Name the top 5 users who have given the lowest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avg_rating
ORDER BY avg_rating
LIMIT 5
RETURN u.id AS user_id, avg_rating","match
  $u isa user, has user_id $user_id;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
reduce $avg = mean($rating) groupby $u, $user_id;
sort $avg asc;
limit 5;
fetch {
  ""user_id"": $user_id,
  ""avg_rating"": $avg
};"
396,What are the first 3 movies that have been rated 5 or higher by more than one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating >= 5
WITH m, count(u) AS num_users
WHERE num_users > 1
RETURN m.title
ORDER BY num_users DESC
LIMIT 3","match
  $m isa movie, has title $title;
  $r isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating >= 5.0;
reduce $count = count($u) groupby $m, $title;
match $count > 1;
sort $count desc;
limit 3;
fetch {
  ""title"": $title
};"
397,List the top 5 movies released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.release_date
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $m.title, ""release_date"": $rd };"
403,Find the top 5 genres by the number of movies associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""movieCount"": $count };"
406,What are the first 5 production companies producing films in the 'Animation' genre?,"MATCH (g:Genre {name: 'Animation'})<-[:IN_GENRE]-(m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany)
RETURN c.name AS company
ORDER BY company
LIMIT 5","match
$g isa genre, has genre_name ""Animation"";
$m isa movie;
in_genre (genre: $g, media: $m);
$c isa production_company, has production_company_name $company;
produced_by (producer: $c, media: $m);
sort $company;
limit 5;
fetch {
  ""company"": $company
};"
408,Which 3 languages are most common among movies with a popularity score above 10?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 10
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has popularity $pop;
  $pop > 10;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
410,Which 3 collections contain the most movies with a budget over 50 million dollars?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WHERE m.budget > 50000000
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS collection, movie_count","match
  $c isa collection;
  $m isa movie;
  in_collection (collection: $c, media: $m);
  $m has budget $budget;
  $budget > 50000000;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""collection"": $c.collection_name,
  ""movie_count"": $count
};"
411,Name the top 3 directors who have worked on movies with an average vote greater than 7.5.,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.average_vote > 7.5
WITH p, count(m) AS num_movies, avg(m.average_vote) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3
RETURN p.name AS director, num_movies, avg_rating","match
  $p isa person, has person_name $name;
  crew_for (crew_member: $p, film: $m) isa crew_for, has job ""Director"";
  $m isa movie, has average_vote $vote;
  $vote > 7.5;
reduce $num_movies = count($m), $avg_rating = mean($vote) groupby $p, $name;
sort $avg_rating desc;
limit 3;
fetch { ""director"": $name, ""num_movies"": $num_movies, ""avg_rating"": $avg_rating };"
413,What are the top 3 highest-grossing movies directed by a person named 'Tom Hanks'?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
crew_for (crew_member: $p, film: $m), has job ""Director"";
$m has revenue $revenue;
sort $revenue desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""revenue"": $revenue
};"
414,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
417,Name the top 5 movies with the most keywords associated.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5","match
  $m isa movie;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 5;
fetch { ""movie"": $m.title, ""keywordCount"": $count };"
418,Which 3 countries have produced the most movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.runtime > 120
RETURN c.name AS country, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $m isa movie, has runtime $rt;
  $rt > 120;
  produced_in_country (media: $m, country: $c);
  $c has country_name $cn;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""numMovies"": $count };"
420,List the top 3 languages spoken in the highest-grossing movies.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3
RETURN l.name AS language, total_revenue","match
  $m isa movie;
  $l isa language;
  spoken_in_language (media: $m, language: $l);
  $m has revenue $revenue;
reduce $total = sum($revenue) groupby $l;
sort $total desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""total_revenue"": $total
};"
422,Which 3 production companies have the highest total revenues from their movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN c.name AS company, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has revenue $rev;
  produced_by (media: $m, producer: $c);
reduce $total_revenue = sum($rev) groupby $c, $cn;
sort $total_revenue desc;
limit 3;
fetch { ""company"": $cn, ""total_revenue"": $total_revenue };"
424,Name the first 5 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 5","match
$m isa movie;
$m has poster_path $poster_path;
$poster_path like "".*\\.jpg"";
$m has title $title;
limit 5;
fetch { ""title"": $title };"
425,What are the top 3 genres in which 'Pixar Animation Studios' has produced movies?,"MATCH (c:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $c isa production_company, has production_company_name ""Pixar Animation Studios"";
  $m isa movie;
  $g isa genre, has genre_name $gn;
  produced_by (media: $m, producer: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
428,What are the top 3 languages for movies produced by 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
MATCH (m)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $pc isa production_company, has production_company_name ""Pixar Animation Studios"";
  $m isa movie;
  produced_by (media: $m, producer: $pc);
  $l isa language, has language_name $ln;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
430,Which 3 keywords are most commonly associated with movies that have a budget less than 1 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget < 1000000
RETURN k.name AS keyword, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $m isa movie, has budget $budget;
  $budget < 1000000;
  $k isa keyword, has keyword_name $kn;
  has_keyword (media: $m, keyword: $k);
reduce $frequency = count($m) groupby $k, $kn;
sort $frequency desc;
limit 3;
fetch { ""keyword"": $kn, ""frequency"": $frequency };"
432,What are the first 3 production companies that have produced movies in more than one language?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH c, count(distinct l) as numLangs
WHERE numLangs > 1
RETURN c.name
LIMIT 3","match
  $c isa production_company;
  $m isa movie;
  $l isa language;
  produced_by (producer: $c, media: $m);
  original_language (media: $m, language: $l);
select $c, $l;
distinct;
reduce $count = count groupby $c;
match $count > 1;
limit 3;
fetch { ""name"": $c.production_company_name };"
434,List the top 5 highest rated movies by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 5
RETURN m.title AS movie, avg_rating","match
  $m isa movie, has title $title;
  $u isa user;
  rated (rated_media: $m, reviewer: $u), has rating $rating;
reduce $avg = mean($rating) groupby $m, $title;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $title,
  ""avg_rating"": $avg
};"
437,Which 3 production companies have produced films with a budget over 100 million dollars?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
RETURN c.name AS company, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has budget $budget;
  $budget > 100000000;
  produced_by (media: $m, producer: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 3;
fetch { ""company"": $cn, ""num_movies"": $num_movies };"
439,"What are the top 3 languages spoken in the videos with a budget greater than 500,000 dollars?","MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.budget > 500000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $v isa video, has budget $budget;
  $budget > 500000;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
441,Which 3 keywords are most common in movies with an average vote below 5?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.average_vote < 5
WITH k, count(*) as count
ORDER BY count DESC
LIMIT 3
RETURN k.name AS keyword, count","match
  $m isa movie, has average_vote $avg;
  $avg < 5.0;
  $k isa keyword, has keyword_name $name;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($m) groupby $k, $name;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $name,
  ""count"": $count
};"
445,List the top 5 adult films with the most keywords associated.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5
RETURN a.title AS title, keywordCount","match
  $a isa adult_video, has title $title;
  has_keyword (media: $a, keyword: $k);
reduce $count = count($k) groupby $a, $title;
sort $count desc;
limit 5;
fetch {
  ""title"": $title,
  ""keywordCount"": $count
};"
448,Which 3 production companies have produced the most movies in the genre 'Drama'?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
RETURN c.name AS company, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $g isa genre, has genre_name ""Drama"";
  $m isa movie;
  in_genre (media: $m, genre: $g);
  $c isa production_company, has production_company_name $cn;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""movie_count"": $count };"
450,What are the top 3 languages spoken in movies that have a status of 'Released'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.status = 'Released'
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has status ""Released"";
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
452,Which 3 keywords are most commonly associated with videos that have a budget over 1 million dollars?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WHERE v.budget > 1000000
WITH k, count(*) as count
ORDER BY count DESC
LIMIT 3
RETURN k.name AS keyword, count","match
  $v isa video, has budget $budget;
  $k isa keyword, has keyword_name $name;
  has_keyword (media: $v, keyword: $k);
  $budget > 1000000;
reduce $count = count($v) groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
459,Which 3 production companies have produced films with a runtime longer than 180 minutes?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 180
RETURN c.name AS company, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $c isa production_company;
  $m isa movie, has runtime $rt;
  $rt > 180;
  produced_by (media: $m, producer: $c);
reduce $num_movies = count($m) groupby $c;
sort $num_movies desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""numMovies"": $num_movies
};"
461,"What are the top 3 languages spoken in the adult films with a budget greater than 100,000 dollars?","MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.budget > 100000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $a isa adult_video, has budget $budget;
  $budget > 100000;
  spoken_in_language (media: $a, language: $l);
  $l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
462,Name the first 3 movies that have a poster path ending in '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster_path $pp, has title $title;
$pp like "".*\\/pQFoyx7rp09CJTAb932F2g8Nlho\\.jpg"";
limit 3;
fetch { ""title"": $title };"
463,Which 3 keywords are most commonly associated with movies that have a revenue over 200 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 200000000
WITH k, count(*) as count
ORDER BY count DESC
LIMIT 3
RETURN k.name AS keyword, count","match
  $m isa movie, has revenue $revenue;
  $k isa keyword, has keyword_name $keyword_name;
  has_keyword (media: $m, keyword: $k);
  $revenue > 200000000;
reduce $count = count($m) groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
470,Which 3 production companies have the highest total budgets for their movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget IS NOT NULL
WITH c, sum(m.budget) AS totalBudget
RETURN c.name AS company, totalBudget
ORDER BY totalBudget DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has budget $budget;
  produced_by (producer: $c, media: $m);
reduce $total = sum($budget) groupby $c;
sort $total desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""totalBudget"": $total
};"
472,What are the top 3 languages spoken in adult films with a vote count over 10?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.vote_count > 10
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $a isa adult_video, has vote_count $vc;
  $vc > 10;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $a, language: $l);
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
493,Which genres are associated with movies directed by 'Steven Spielberg'?,"MATCH (p:Person {name: 'Steven Spielberg'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name AS genre","match
$p isa person, has person_name ""Steven Spielberg"";
crew_for (crew_member: $p, film: $m) isa crew_for, has job ""Director"";
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name $genre;
select $genre;
distinct;
fetch { ""genre"": $genre };"
494,List all the movies where the character 'Woody' appears.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character CONTAINS 'Woody'
RETURN m.title AS movie, r.character AS character","match
  $p isa person;
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m), has character $character;
  $character like "".*Woody.*"";
  $m has title $title;
fetch {
  ""movie"": $title,
  ""character"": $character
};"
498,List the movies that have won awards and have an original language of Italian.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {name: 'Italian'})
WHERE exists{ (m)-[:HAS_KEYWORD]->(:Keyword {name: 'award won'}) }
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_name ""Italian"";
  original_language (media: $m, language: $l);
  $k isa keyword, has keyword_name ""award won"";
  has_keyword (media: $m, keyword: $k);
fetch {
  ""title"": $m.title
};"
509,List the movies that have a budget of zero.,"MATCH (m:Movie)
WHERE m.budget = 0
RETURN m.title","match
$m isa movie, has budget $budget, has title $title;
$budget == 0;
fetch { ""title"": $title };"
510,List the first 3 countries that have produced the most adult films.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
511,Which movies have been most frequently rated by users?,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title AS movie, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 10","match
  $m isa movie, has title $title;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $m;
sort $count desc;
limit 10;
fetch {
  ""movie"": $m.title,
  ""num_ratings"": $count
};"
512,List the top 3 highest-grossing movies of 1995.,"MATCH (m:Movie)
WHERE m.release_date STARTS WITH '1995' AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie;
$m has release_date $release_date;
$release_date >= 1995-01-01T00:00:00;
$release_date < 1996-01-01T00:00:00;
$m has title $title;
$m has revenue $revenue;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
514,Which movies are associated with the keyword 'family' and have a release date in the last 5 years?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'family'})
WHERE m.release_date >= date() - duration('P5Y')
RETURN m.title, m.release_date","match
$m isa movie, has title $title, has release_date $release_date;
$k isa keyword, has keyword_name ""family"";
has_keyword (media: $m, keyword: $k);
$release_date >= 2020-01-01T00:00:00;
fetch {
  ""title"": $title,
  ""release_date"": $release_date
};"
515,List the production companies that have produced movies with an original language of Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'es'})
MATCH (m)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN DISTINCT c.name","match
$m isa movie;
$lang isa language, has language_id ""es"";
original_language (media: $m, language: $lang);
$c isa production_company, has production_company_name $name;
produced_by (media: $m, producer: $c);
select $name;
distinct;
fetch { ""name"": $name };"
516,Which movies have a popularity less than 5 and more than 2?,"MATCH (m:Movie)
WHERE m.popularity < 5 AND m.popularity > 2
RETURN m","match
  $m isa movie, has title $title;
  $m has popularity $pop;
  $pop < 5;
  $pop > 2;
limit 50;
fetch { ""title"": $title, ""popularity"": $pop };"
522,List all movies that have an average vote of exactly 7.7.,"MATCH (m:Movie)
WHERE m.average_vote = 7.7
RETURN m.title","match
$m isa movie, has average_vote $av, has title $title;
$av == 7.7;
fetch { ""title"": $title };"
523,What are the movies with a poster path that ends with 'T4B.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'T4B.jpg'
RETURN m.title","match
$m isa movie, has poster_path $poster_path, has title $title;
$poster_path like "".*T4B\\.jpg"";
fetch { ""title"": $title };"
528,List the movies that have been produced in more than three countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 3
RETURN m.title AS movie, num_countries","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $num_countries = count($c) groupby $m;
match $num_countries > 3;
$m has title $title;
fetch {
  ""movie"": $title,
  ""num_countries"": $num_countries
};"
529,Which movies have a budget less than 1 million USD and have won an award?,"MATCH (m:Movie)
WHERE m.budget < 1000000 AND exists{ (m)<-[:AWARDED_TO]-() }
RETURN m","match
  $m isa movie;
  $m has budget $budget;
  $budget < 1000000;
  $k isa keyword, has keyword_name ""award won"";
  has_keyword (media: $m, keyword: $k);
fetch {
  ""title"": $m.title
};"
533,List all movies where the spoken language includes both English and Spanish.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'})
WHERE exists{ (m)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'}) }
RETURN m.title","match $m isa movie; $l1 isa language, has language_name ""English""; $l2 isa language, has language_name ""Spanish""; spoken_in_language (media: $m, language: $l1); spoken_in_language (media: $m, language: $l2); fetch { ""title"": $m.title };"
538,List the movies that have a revenue greater than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.budget, m.revenue","match
$m isa movie;
$m has revenue $revenue;
$m has budget $budget;
$m has title $title;
$revenue > $budget;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue
};"
542,List the movies with a release date on '1995-10-30'.,"MATCH (m:Movie)
WHERE m.release_date = date('1995-10-30')
RETURN m.title, m.release_date","match
$m isa movie;
$m has release_date $release_date;
$release_date == 1995-10-30;
$m has title $title;
fetch { ""title"": $title, ""release_date"": $release_date };"
543,Which movies have a title that starts with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m.title","match
$m isa movie, has title $title;
$title like ""^The.*"";
fetch { ""title"": $title };"
550,What are the movies that have been produced in 'China'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'China'})
RETURN m.title","match
  $m isa movie;
  $c isa country, has country_name ""China"";
  produced_in_country (media: $m, country: $c);
fetch {
  ""title"": $m.title
};"
553,List the movies that have been rated 10 by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 10
RETURN m.title","match
  $m isa movie;
  $u isa user;
  rated (rated_media: $m, reviewer: $u), has rating 10.0;
  $m has title $title;
fetch {
  ""title"": $title
};"
554,List the movies that have an average vote of 7.1.,"MATCH (m:Movie)
WHERE m.average_vote = 7.1
RETURN m.title","match
  $m isa movie;
  $m has average_vote $average_vote;
  $average_vote == 7.1;
fetch {
  ""title"": $m.title
};"
556,What are the movies directed by a female from the 'Production' department?,"MATCH (p:Person {gender: 1})-[r:CREW_FOR {department: 'Production', job: 'Director'}]->(m:Movie)
RETURN m.title AS movie, p.name AS director","match
  $p isa person, has gender 1;
  $m isa movie;
  $r isa crew_for (crew_member: $p, film: $m);
  $r has job ""Director"", has department ""Production"";
fetch {
  ""movie"": $m.title,
  ""director"": $p.person_name
};"
557,List all directors for the movie with an ID of 862.,"MATCH (m:Movie {id: 862})<-[:CREW_FOR]-(p:Person)
WHERE exists{ (p)-[:CREW_FOR {job: 'Director'}]->(m) }
RETURN p.name AS director","match
  $m isa movie, has movie_id 862;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  $p has person_name $name;
fetch {
  ""director"": $name
};"
560,List the movies that have a release date in January 1995.,"MATCH (m:Movie)
WHERE m.release_date >= date('1995-01-01') AND m.release_date < date('1995-02-01')
RETURN m.title, m.release_date","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 1995-01-01T00:00:00;
  $release_date < 1995-02-01T00:00:00;
fetch {
  ""title"": $m.title,
  ""release_date"": $release_date
};"
562,List all movies that have a budget greater than 100 million USD and were released after 2000.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.release_date > date('2000-01-01')
RETURN m.title, m.budget, m.release_date","match
  $m isa movie;
  $m has budget $budget;
  $m has release_date $release_date;
  $m has title $title;
  $budget > 100000000;
  $release_date > 2000-01-01;
fetch {
  ""title"": $title, ""budget"": $budget, ""release_date"": $release_date
};"
563,Which movies have an IMDb ID that starts with 'tt00'?,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt00'
RETURN m.title, m.imdb_id","match
  $m isa movie;
  $m has imdb_id $imdb_id;
  $imdb_id like ""^tt00.*"";
fetch {
  ""title"": $m.title,
  ""imdb_id"": $imdb_id
};"
564,What are the movies with a runtime exactly equal to the runtime of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'}), (other:Movie)
WHERE other.runtime = m.runtime AND other <> m
RETURN other.title, other.runtime","match
  $m isa movie, has title ""Toy Story"", has runtime $runtime;
  $other isa movie, has runtime $runtime, has title $title;
  not { $other is $m; };
fetch {
  ""title"": $title,
  ""runtime"": $runtime
};"
567,List the movies that have a backdrop path of '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path = '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'
RETURN m.title","match
  $m isa movie;
  $c isa collection, has backdrop_path ""/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg"";
  in_collection (media: $m, collection: $c);
fetch {
  ""title"": $m.title
};"
571,Which 5 movies were released after 2010 and have a vote count over 1000?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.vote_count > 1000
RETURN m.title, m.release_date, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $m has vote_count $vote_count;
  $m has title $title;
  $release_date > 2010-01-01T00:00:00;
  $vote_count > 1000;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""vote_count"": $vote_count
};"
574,List the first 3 languages that have been used as original languages in more than 10 movies.,"MATCH (l:Language)<-[:ORIGINAL_LANGUAGE]-(m:Movie)
WITH l, count(m) AS movieCount
WHERE movieCount > 10
RETURN l.name AS language
ORDER BY movieCount DESC
LIMIT 3","match
  $l isa language, has language_name $name;
  $m isa movie;
  original_language (language: $l, media: $m);
reduce $count = count($m) groupby $l, $name;
match $count > 10;
sort $count desc;
limit 3;
fetch {
  ""language"": $name
};"
575,Which 3 countries have produced more than 50 movies?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WITH c, count(m) AS movieCount
WHERE movieCount > 50
RETURN c.name AS country, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $c isa country, has country_name $name;
  $m isa movie;
  produced_in_country (country: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
match $count > 50;
sort $count desc;
limit 3;
fetch {
  ""country"": $name,
  ""movieCount"": $count
};"
576,What are the top 5 genres by the number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""movieCount"": $count };"
577,Which 3 production companies have produced the most movies with a budget over $50 million?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 50000000
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS company, movie_count","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has budget $budget;
  $budget > 50000000;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""movie_count"": $count
};"
579,Who are the top 5 actors by the number of movies they have appeared in?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WITH p, count(r) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS actor, num_movies","match
  $p isa person, has person_name $name;
  cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""num_movies"": $count
};"
581,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
585,List the first 3 movies that have a poster path starting with '/r'.,"MATCH (m:Movie)
WHERE m.poster_path STARTS WITH '/r'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like ""/r.*"";
limit 3;
fetch {
  ""title"": $m.title
};"
587,What are the 3 latest movies rated by user with id 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating, r.timestamp
ORDER BY r.timestamp DESC
LIMIT 3","match
  $u isa user, has user_id ""1"";
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating, has timestamp $timestamp;
  $m has title $title;
sort $timestamp desc;
limit 3;
fetch {
  ""title"": $title,
  ""rating"": $rating,
  ""timestamp"": $timestamp
};"
588,Which 3 genres are most frequently found in movies with a revenue greater than $100 million?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 100000000
WITH g, count(*) AS frequency
RETURN g.name AS genre, frequency
ORDER BY frequency DESC
LIMIT 3","match
  $m isa movie, has revenue $revenue;
  $g isa genre, has genre_name $name;
  in_genre (media: $m, genre: $g);
  $revenue > 100000000;
reduce $frequency = count($m) groupby $g, $name;
sort $frequency desc;
limit 3;
fetch {
  ""genre"": $name,
  ""frequency"": $frequency
};"
589,List the top 5 production companies by the number of videos they have produced.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(v:Video)
RETURN c.name AS company, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $v isa video;
  produced_by (media: $v, producer: $c);
reduce $count = count($v) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name, ""videoCount"": $count };"
590,Which 3 languages are most frequently spoken in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $v isa video;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""frequency"": $count };"
593,What are the top 5 countries where adult films have been produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa adult_video;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""count"": $count };"
595,Which 3 genres are most common in adult films?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa adult_video;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
596,What are the top 5 keywords found in videos?,"MATCH (k:Keyword)<-[:HAS_KEYWORD]-(v:Video)
RETURN k.name AS Keyword, count(*) AS Frequency
ORDER BY Frequency DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $count };"
600,List the top 5 genres associated with the highest-grossing videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, sum(v.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN g.name AS genre, total_revenue","match
  $v isa video;
  $g isa genre;
  in_genre (media: $v, genre: $g);
  $v has revenue $revenue;
reduce $total = sum($revenue) groupby $g;
sort $total desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""total_revenue"": $total
};"
602,What are the top 5 languages in which the most adult films are originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  $l isa language, has language_name $ln;
  original_language (media: $a, language: $l);
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
608,What are the top 5 countries by the number of genres produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m)<-[:IN_GENRE]-(g:Genre)
WITH c, count(distinct g) AS genreCount
RETURN c.name AS country, genreCount
ORDER BY genreCount DESC
LIMIT 5","match
  $c isa country, has country_name $country_name;
  $g isa genre;
  produced_in_country (media: $m, country: $c);
  in_genre (media: $m, genre: $g);
select $c, $g, $country_name;
distinct;
reduce $count = count($g) groupby $c, $country_name;
sort $count desc;
limit 5;
fetch {
  ""country"": $country_name,
  ""genreCount"": $count
};"
609,List the first 3 movies that have no revenue reported.,"MATCH (m:Movie)
WHERE m.revenue IS NULL
RETURN m.title
LIMIT 3","match
  $m isa movie;
  not { $m has revenue $r; };
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
610,Which 3 videos have a poster path ending with 'jpg'?,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH 'jpg'
RETURN v.title
LIMIT 3","match
  $v isa video;
  $v has poster_path $poster_path;
  $poster_path like "".*jpg"";
limit 3;
fetch {
  ""title"": $v.title
};"
613,Which 3 genres have the least movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count asc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
614,What are the top 5 languages spoken in the highest-grossing movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  $m isa movie, has revenue $rev;
  spoken_in_language (media: $m, language: $l);
reduce $total_revenue = sum($rev) groupby $l, $ln;
sort $total_revenue desc;
limit 5;
fetch { ""language"": $ln, ""total_revenue"": $total_revenue };"
615,List the first 3 people who have a profile path starting with '/p'.,"MATCH (p:Person)
WHERE p.profile_path STARTS WITH '/p'
RETURN p.name, p.profile_path
LIMIT 3","match
  $p isa person;
  $p has profile_path $profile_path;
  $p has person_name $person_name;
  $profile_path like ""/p.*"";
limit 3;
fetch {
  ""name"": $person_name,
  ""profile_path"": $profile_path
};"
616,Which 3 keywords are most frequently associated with movies having a budget over $200 million?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 200000000
WITH k, count(*) as frequency
ORDER BY frequency DESC
LIMIT 3
RETURN k.name AS keyword, frequency","match
  $m isa movie, has budget $budget;
  $budget > 200000000;
  $k isa keyword, has keyword_name $name;
  has_keyword (media: $m, keyword: $k);
reduce $frequency = count($m) groupby $k, $name;
sort $frequency desc;
limit 3;
fetch {
  ""keyword"": $name,
  ""frequency"": $frequency
};"
618,List the first 3 movies directed by a person named 'John Doe'.,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name ""John Doe"";
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director"";
limit 3;
fetch {
  ""title"": $m.title
};"
619,Which 3 movies have the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has revenue $revenue;
  $m has title $title;
let $profit = $revenue - $budget;
sort $profit desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""profit"": $profit
};"
621,List the first 3 movies that were rated exactly 5 stars by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $u isa user;
  rated (rated_media: $m, reviewer: $u), has rating 5.0;
limit 3;
fetch {
  ""title"": $m.title
};"
624,List the first 3 genres that have movies with no keywords associated.,"MATCH (g:Genre)
WHERE NOT EXISTS {
  (g)<-[:IN_GENRE]-(:Movie)-[:HAS_KEYWORD]->(:Keyword)
}
RETURN g.name
LIMIT 3","match
  $g isa genre;
  in_genre (media: $m, genre: $g);
  $m isa movie;
  not { has_keyword (media: $m, keyword: $k); };
limit 3;
fetch {
  ""name"": $g.genre_name
};"
625,Which 3 production companies have produced movies in more than 3 different languages?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH c, count(distinct l) AS numLangs
WHERE numLangs > 3
RETURN c.name, numLangs
ORDER BY numLangs DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  $l isa language;
  produced_by (media: $m, producer: $c);
  original_language (media: $m, language: $l);
select $l, $c, $name;
distinct;
reduce $num_langs = count groupby $c, $name;
match $num_langs > 3;
sort $num_langs desc;
limit 3;
fetch {
  ""name"": $name,
  ""numLangs"": $num_langs
};"
626,What are the top 5 most frequently used keywords in adult films?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $a isa adult_video;
  $k isa keyword, has keyword_name $kn;
  has_keyword (media: $a, keyword: $k);
reduce $frequency = count($a) groupby $k, $kn;
sort $frequency desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $frequency };"
627,List the first 3 adult films that have a revenue of 0.,"MATCH (a:Adult)
WHERE a.revenue = 0
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has revenue $revenue;
  $revenue == 0.0;
  $a has title $title;
limit 3;
fetch {
  ""title"": $title
};"
628,Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
RETURN v.title AS video, keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""keywordCount"": $count
};"
629,What are the top 5 countries by the number of videos produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""videoCount"": $count };"
631,Which 3 genres are most common among movies released before 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.release_date < date('2000-01-01')
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has release_date $rd;
  $rd < 2000-01-01;
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
634,Which 3 movies have been rated highest by users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $r isa rated (rated_media: $m), has rating $rating;
reduce $avg_rating = mean($rating) groupby $m, $t;
sort $avg_rating desc;
limit 3;
fetch { ""title"": $t, ""avg_rating"": $avg_rating };"
639,List the first 3 countries that have produced the most adult films.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""adultFilmCount"": $count
};"
640,Which 3 genres have the highest average votes in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.average_vote) AS avg_vote
RETURN g.name AS genre, avg_vote
ORDER BY avg_vote DESC
LIMIT 3","match
  $m isa movie, has average_vote $av;
  $g isa genre, has genre_name $name;
  in_genre (media: $m, genre: $g);
reduce $avg = mean($av) groupby $g;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""avg_vote"": $avg
};"
641,What are the top 5 movies with the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5
RETURN m.title AS movie, keywordCount","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""keywordCount"": $count
};"
642,List the first 3 videos that have been produced in more than one country.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(c) AS num_countries
WHERE num_countries > 1
RETURN v.title
LIMIT 3","match
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($c) groupby $v;
match $count > 1;
limit 3;
fetch {
  ""title"": $v.title
};"
643,What are the top 5 countries by the number of videos produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 5","match
  $c isa country, has country_name $name;
  produced_in_country (media: $v, country: $c);
  $v isa video;
reduce $count = count($v) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.country_name, ""videoCount"": $count };"
644,What are the top 5 most frequently spoken languages in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $v isa video;
  spoken_in_language (media: $v, language: $l);
  $l has language_name $ln;
reduce $frequency = count($v) groupby $l, $ln;
sort $frequency desc;
limit 5;
fetch { ""language"": $ln, ""frequency"": $frequency };"
645,List the first 3 movies that were part of more than one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, count(c) AS num_collections
WHERE num_collections > 1
RETURN m.title
LIMIT 3","match
  $m isa movie;
  in_collection (media: $m, collection: $c);
reduce $count = count($c) groupby $m;
match $count > 1;
limit 3;
fetch {
  ""title"": $m.title
};"
646,Which 3 movies have the most significant number of cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
RETURN m.title AS movie, count(p) AS cast_size
ORDER BY cast_size DESC
LIMIT 3","match
  $m isa movie, has title $t;
  cast_for (film: $m, actor: $p);
reduce $cast_size = count($p) groupby $m, $t;
sort $cast_size desc;
limit 3;
fetch { ""movie"": $t, ""cast_size"": $cast_size };"
649,Which 3 people have the highest number of crew credits in movies?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
RETURN p.name AS person, count(r) AS num_crew_credits
ORDER BY num_crew_credits DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie;
  crew_for (crew_member: $p, film: $m);
reduce $count = count($m) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""person"": $pn, ""num_crew_credits"": $count };"
651,List the first 3 adult films that have been produced in the 'United States of America'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $a, country: $c);
limit 3;
fetch {
  ""title"": $a.title
};"
652,Which 3 genres are most popular according to the popularity scores in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 3","match
  $m isa movie, has popularity $pop;
  in_genre (media: $m, genre: $g);
  $g has genre_name $gn;
reduce $avg_pop = mean($pop) groupby $g, $gn;
sort $avg_pop desc;
limit 3;
fetch { ""genre"": $gn, ""avg_popularity"": $avg_pop };"
653,What are the top 5 languages used in the original language of adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  original_language (media: $a, language: $l);
  $l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
655,What are the top 5 most popular genres based on movie data?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""movieCount"": $count
};"
657,Which 3 movies have the highest number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
RETURN m.title AS movie, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""languageCount"": $count
};"
659,List the first 3 videos with no budget reported.,"MATCH (v:Video)
WHERE v.budget IS NULL
RETURN v.title, v.budget
LIMIT 3","match
  $v isa video;
  not { $v has budget $b; };
limit 3;
fetch {
  ""title"": $v.title,
  ""budget"": $v.budget
};"
660,Which 3 movies have the highest number of production companies associated?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN m.title AS movie, count(c) AS num_production_companies
ORDER BY num_production_companies DESC
LIMIT 3","match
  $m isa movie, has title $t;
  produced_by (media: $m, producer: $c);
reduce $count = count($c) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""num_production_companies"": $count };"
661,What are the top 5 genres associated with the highest average votes in videos?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, avg(v.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 5
RETURN g.name AS genre, avg_vote","match
  $v isa video, has average_vote $avg_vote;
  $g isa genre, has genre_name $name;
  in_genre (media: $v, genre: $g);
reduce $avg = mean($avg_vote) groupby $g, $name;
sort $avg desc;
limit 5;
fetch {
  ""genre"": $name,
  ""avg_vote"": $avg
};"
663,Which 3 countries have produced the most videos?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $video_count = count($v) groupby $c;
sort $video_count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""video_count"": $video_count
};"
673,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie, has title $t;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""keywordCount"": $count };"
678,What are the first 5 movies that are part of a collection and have a budget greater than 10000000?,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.budget > 10000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 10000000;
  in_collection (media: $m, collection: $c);
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
680,List the top 3 movies which are in the genre 'Animation' and have been released.,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Animation'})
WHERE m.status = 'Released'
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name ""Animation"";
  in_genre (media: $m, genre: $g);
  $m has status ""Released"";
  $m has title $title;
  $m has release_date $release_date;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity
};"
681,What are the first 5 movies directed by a specific director named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
  $p isa person, has person_name ""John Doe"";
  $m isa movie;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  $m has release_date $release_date;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $m.title
};"
683,Which 5 movies have been rated by the most users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
$m isa movie, has title $title;
rated (rated_media: $m, reviewer: $u);
$u isa user;
reduce $num_ratings = count($u) groupby $m, $title;
sort $num_ratings desc;
limit 5;
fetch { ""title"": $title, ""num_ratings"": $num_ratings };"
688,List the top 3 movies that have been produced in the country 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $m, country: $c);
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
692,What are the top 5 movies with a release date on or after '2000-01-01'?,"MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01')
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 2000-01-01T00:00:00;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity
};"
696,What are the first 5 movies that have a main character named 'Charlie Wilson'?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.name IS NOT NULL AND m.title IS NOT NULL
  AND exists{ (p)-[:CAST_FOR {character: 'Charlie Wilson'}]->(m) }
RETURN m.title
LIMIT 5","match
  $m isa movie, has title $title;
  $rel isa cast_for (actor: $p, film: $m), has character ""Charlie Wilson"";
limit 5;
fetch {
  ""title"": $title
};"
698,Which 3 movies have been rated 5.0 by users and have a 'Released' status?,"MATCH (m:Movie {status: 'Released'})<-[r:RATED {rating: 5.0}]-(u:User)
RETURN m.title
LIMIT 3","match
  $m isa movie, has status ""Released"", has title $title;
  $u isa user;
  $r isa rated (rated_media: $m, reviewer: $u), has rating 5.0;
limit 3;
fetch {
  ""title"": $title
};"
700,What are the top 5 movies that have a genre of 'Comedy' and are rated above 6?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
WHERE m.average_vote > 6
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  in_genre (media: $m, genre: $g);
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 6;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
701,List the first 3 videos that have a poster path ending in '.jpg'.,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH '.jpg'
RETURN v.title, v.poster_path
LIMIT 3","match
  $v isa video;
  $v has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $v has title $title;
limit 3;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
704,What are the top 5 videos produced in 'United States of America'?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN v.title, v.average_vote, v.vote_count
ORDER BY v.average_vote DESC, v.vote_count DESC
LIMIT 5","match
  $v isa video;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $v, country: $c);
  $v has title $title;
  $v has average_vote $average_vote;
  $v has vote_count $vote_count;
sort $average_vote desc, $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""vote_count"": $vote_count
};"
711,What are the top 5 adult films produced in 'Italy'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $c isa country, has country_name ""Italy"";
  produced_in_country (media: $a, country: $c);
  $a has title $title;
  $a has average_vote $average_vote;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
715,What are the top 3 genres that have the most movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
  $m isa movie;
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
716,List the first 3 production companies that have produced the most movies.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  produced_by (media: $m, producer: $c);
  $m isa movie;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""num_movies"": $count };"
717,Which 3 countries have the most movies produced in them?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  produced_in_country (media: $m, country: $c);
  $m isa movie;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""movieCount"": $count };"
718,List the first 5 languages that are most frequently used as the original language in movies.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  (media: $m, language: $l) isa original_language;
  $m isa movie;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
719,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  in_collection (media: $m, collection: $c);
  $m isa movie;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;"
720,List the first 3 genres that are most frequently targeted by packages.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  provides_access_to (package: $p, genre: $g);
reduce $frequency = count($p) groupby $g, $gn;
sort $frequency desc;
limit 3;
fetch { ""genre"": $gn, ""frequency"": $frequency };"
722,List the top 5 packages by the duration they provide access.,"MATCH (p:Package)
RETURN p.name AS package, p.duration AS duration
ORDER BY duration DESC
LIMIT 5","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_duration $package_duration;
sort $package_duration desc;
limit 5;
fetch {
  ""package"": $package_name, ""duration"": $package_duration
};"
724,List the first 3 languages that have been spoken in the most adult films.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $a isa adult_video;
  spoken_in_language (media: $a, language: $l);
  $l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
725,Which 3 genres are most commonly associated with videos that have a budget over 100000 USD?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.budget > 100000
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  in_genre (media: $v, genre: $g);
  $v isa video, has budget $budget;
  $budget > 100000;
reduce $frequency = count($v) groupby $g, $gn;
sort $frequency desc;
limit 3;
fetch { ""genre"": $gn, ""frequency"": $frequency };"
726,List the top 3 countries where the most videos have been produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  produced_in_country (media: $v, country: $c);
  $v isa video;
reduce $count = count($v) groupby $cn;
sort $count desc;
limit 3;"
727,What are the first 5 keywords most associated with movies that have a revenue above 1 million USD?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 1000000
RETURN k.name, count(*) as count
ORDER BY count DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  has_keyword (media: $m, keyword: $k);
  $m isa movie, has revenue $revenue;
  $revenue > 1000000;
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""count"": $count };"
728,List the first 3 genres that have the highest average rating across all movies.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.average_vote IS NOT NULL
WITH g, avg(m.average_vote) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3
RETURN g.name AS genre, avg_rating","match
  $g isa genre, has genre_name $name;
  $m isa movie, has average_vote $vote;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($vote) groupby $g, $name;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $name,
  ""avg_rating"": $avg
};"
729,Which 3 production companies have produced the most adult films?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
RETURN c.name AS company, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa adult_video;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""num_adult_films"": $count };"
730,List the top 3 people who have acted the most in released movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE m.status = 'Released'
WITH p, count(r) AS num_roles
ORDER BY num_roles DESC
LIMIT 3
RETURN p.name AS person, num_roles","match
  $p isa person, has person_name $name;
  $m isa movie, has status ""Released"";
  $r isa cast_for (actor: $p, film: $m);
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 3;
fetch {
  ""person"": $name,
  ""num_roles"": $count
};"
731,What are the top 5 users who have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 5;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
732,List the first 3 movies with the highest number of associated keywords and a budget above 50000 USD.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 50000
WITH m, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3
RETURN m.title AS movie, keywordCount","match
  $m isa movie, has budget $budget, has title $title;
  $budget > 50000;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""keywordCount"": $count
};"
733,Which 3 movies have the longest gap between their release date and the current date?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date, duration.between(date(m.release_date), date()).days AS days_since_release
ORDER BY days_since_release DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
735,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection;
  in_collection (media: $m, collection: $c);
  $m isa movie;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""collection"": $c.collection_name, ""num_movies"": $count };"
736,List the first 3 movies that are part of a collection and have a runtime less than 90 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.runtime < 90
RETURN m.title, m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime < 90;
  in_collection (media: $m, collection: $c);
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
741,Which 3 genres are most commonly associated with videos that have a budget over 100000 USD?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.budget > 100000
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $v isa video, has budget $budget;
  $budget > 100000;
  in_genre (media: $v, genre: $g);
  $g has genre_name $name;
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""frequency"": $count };"
744,List the first 3 subscriptions that were initiated in 2020.,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package)
WHERE s.expiresAt >= date('2020-01-01') AND s.expiresAt < date('2021-01-01')
RETURN s, p
ORDER BY s.expiresAt
LIMIT 3","match
  $s isa subscription, has expires_at $exp;
  $p isa package;
  for_package (subscription: $s, package: $p);
  $exp >= 2020-01-01T00:00:00;
  $exp < 2021-01-01T00:00:00;
sort $exp;
limit 3;
fetch { ""subscription"": $s, ""package"": $p };"
745,Which 3 movies have the most cast members named 'Tom Hanks'?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person {name: 'Tom Hanks'})
RETURN m.title, count(p) AS num_tom_hanks
ORDER BY num_tom_hanks DESC
LIMIT 3","match
  $m isa movie;
  $p isa person, has person_name ""Tom Hanks"";
  cast_for (actor: $p, film: $m);
reduce $count = count($p) groupby $m;
sort $count desc;
limit 3;
fetch { ""title"": $m.title, ""num_tom_hanks"": $count };"
747,What are the top 5 movies with an original title different from their title?,"MATCH (m:Movie)
WHERE m.original_title <> m.title
RETURN m.title, m.original_title
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has original_title $original_title;
  $m has title $title;
  $m has popularity $popularity;
  $original_title != $title;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""original_title"": $original_title
};"
749,Which 3 languages are most frequently used in videos with a runtime over 100 minutes?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE v.runtime > 100
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $v isa video, has runtime $rt;
  original_language (media: $v, language: $l);
  $rt > 100;
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""frequency"": $count };"
750,List the first 3 packages that provide the longest duration of access to movies.,"MATCH (p:Package)
RETURN p.name AS package, p.duration AS duration
ORDER BY duration DESC
LIMIT 3","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_duration $package_duration;
sort $package_duration desc;
limit 3;
fetch {
  ""package"": $package_name, ""duration"": $package_duration
};"
751,What are the first 5 movies that have a poster path ending in '.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $m has title $title;
limit 5;
fetch {
  ""title"": $title
};"
752,List the top 3 people who have the most credits as a producer.,"MATCH (p:Person)-[r:CREW_FOR]->(m)
WHERE r.job = 'Producer'
WITH p, count(r) AS num_credits
ORDER BY num_credits DESC
LIMIT 3
RETURN p.name AS person, num_credits","match
  $p isa person, has person_name $person_name;
  $r isa crew_for (crew_member: $p, film: $m), has job ""Producer"";
reduce $count = count($r) groupby $p, $person_name;
sort $count desc;
limit 3;
fetch {
  ""person"": $person_name,
  ""num_credits"": $count
};"
753,Which 3 movies have the most distinct languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(distinct l) as numLanguages
ORDER BY numLanguages DESC
LIMIT 3
RETURN m.title, numLanguages","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
  $m has title $title;
select $l, $m, $title;
distinct;
reduce $count = count($l) groupby $m, $title;
sort $count desc;
limit 3;
fetch {
  ""title"": $title,
  ""numLanguages"": $count
};"
754,List the first 3 movies that have been rated exactly 10 times and have a budget greater than 100000 USD.,"MATCH (m:Movie)
WHERE m.budget > 100000 AND m.vote_count = 10
RETURN m.title, m.budget, m.vote_count
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has vote_count $vote_count;
  $m has title $title;
  $budget > 100000;
  $vote_count == 10;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget, ""vote_count"": $vote_count
};"
756,"List the first 3 movies that have a release date on a specific day, say '1995-12-22'.","MATCH (m:Movie)
WHERE m.release_date = date('1995-12-22')
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has release_date 1995-12-22;
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
758,List the first 3 genres most commonly associated with movies that have a budget over $50 million.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 50000000
WITH g, count(*) AS count
ORDER BY count DESC
LIMIT 3
RETURN g.name AS genre, count","match
  $m isa movie, has budget $budget;
  $g isa genre, has genre_name $genre_name;
  in_genre (media: $m, genre: $g);
  $budget > 50000000;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""count"": $count
};"
759,Which 3 movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie, has title $t;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""keywordCount"": $count };"
760,Who are the top 5 directors with the most films produced in the United States?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WITH p, count(m) AS num_films
ORDER BY num_films DESC
LIMIT 5
RETURN p.name AS director, num_films","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa country, has country_name ""United States of America"";
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  produced_in_country (media: $m, country: $c);
reduce $num_films = count($m) groupby $p, $name;
sort $num_films desc;
limit 5;
fetch {
  ""director"": $name,
  ""num_films"": $num_films
};"
761,What are the top 3 languages spoken in movies that have a revenue greater than $100 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 100000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has revenue $rev;
  $rev > 100000000;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };
"
763,Which 3 production companies have produced the most movies with a runtime longer than 120 minutes?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 120
WITH c, count(m) AS num_movies
RETURN c.name AS company, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  $runtime > 120;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
764,What are the top 5 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
765,Who are the first 3 actors by number of roles in movies with a status of 'Released'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie {status: 'Released'})
RETURN p.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has status ""Released"";
  $r isa cast_for (actor: $p, film: $m);
reduce $count = count($r) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""actor"": $pn, ""roles"": $count };"
766,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
767,What are the top 5 countries with the most movies produced?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""movieCount"": $count };"
768,List the first 3 genres associated with the highest average movie budget.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.budget IS NOT NULL
WITH g, avg(m.budget) AS avgBudget
ORDER BY avgBudget DESC
LIMIT 3
RETURN g.name AS genre, avgBudget","match
  $g isa genre, has genre_name $name;
  $m isa movie, has budget $budget;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($budget) groupby $g, $name;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $name,
  ""avgBudget"": $avg
};"
769,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  in_collection (media: $m, collection: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""collection"": $cn, ""num_movies"": $count };"
770,Which 3 directors have worked on the highest-grossing movies?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN p.name AS director, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has revenue $rev;
  crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $total_revenue = sum($rev) groupby $p, $pn;
sort $total_revenue desc;
limit 3;
fetch { ""director"": $pn, ""total_revenue"": $total_revenue };"
771,List the first 3 actors who have starred in the most movies within a single genre.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, g, count(m) AS movieCount
ORDER BY movieCount DESC
RETURN p.name AS actor, g.name AS genre, movieCount
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $g isa genre;
  cast_for (actor: $p, film: $m);
  in_genre (media: $m, genre: $g);
reduce $movieCount = count($m) groupby $p, $g;
sort $movieCount desc;
limit 3;
fetch {
  ""actor"": $p.person_name,
  ""genre"": $g.genre_name,
  ""movieCount"": $movieCount
};"
772,What are the top 5 languages in which the most highly rated movies were originally made?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE m.vote_count IS NOT NULL AND m.vote_count > 100
RETURN l.name AS language, avg(m.average_vote) AS avg_rating, count(*) AS num_movies
ORDER BY avg_rating DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vc;
  $vc > 100;
  $m has average_vote $av;
  $l isa language, has language_name $ln;
  original_language (media: $m, language: $l);
reduce $avg_rating = mean($av), $num_movies = count($m) groupby $l, $ln;
sort $avg_rating desc;
limit 5;
fetch { ""language"": $ln, ""avg_rating"": $avg_rating, ""num_movies"": $num_movies };"
773,Which 3 production companies have the highest average revenue per movie?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue IS NOT NULL
WITH c, avg(m.revenue) AS avg_revenue
RETURN c.name AS company, avg_revenue
ORDER BY avg_revenue DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has revenue $revenue;
  produced_by (producer: $c, media: $m);
reduce $avg = mean($revenue) groupby $c, $name;
sort $avg desc;
limit 3;
fetch {
  ""company"": $name,
  ""avg_revenue"": $avg
};"
774,List the first 3 movies that have been rated by the highest number of users.,"MATCH (m:Movie)<-[r:RATED]-(:User)
WITH m, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN m.title AS movie, numRatings","match
  $m isa movie, has title $title;
  rated (reviewer: $u, rated_media: $m);
reduce $count = count groupby $m;
sort $count desc;
limit 3;
fetch { ""movie"": $m.title, ""numRatings"": $count };"
775,What are the top 5 genres with the most movies having a runtime of less than 90 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime < 90
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa movie, has runtime $rt;
  $rt < 90;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""numMovies"": $count };"
776,Who are the first 3 actors to appear in movies from at least two different genres?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, count(distinct g) AS genreCount
WHERE genreCount >= 2
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $g isa genre;
  cast_for (actor: $p, film: $m);
  in_genre (media: $m, genre: $g);
select $p, $g, $name;
distinct;
reduce $count = count($g) groupby $p, $name;
match $count >= 2;
limit 3;
fetch {
  ""name"": $name
};"
777,Which 3 languages are most commonly found in movies with a poster path featuring '/9'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/9'
WITH m
MATCH (m)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has poster_path $path;
  $path like "".*/9.*"";
  spoken_in_language (media: $m, language: $l);
  $l has language_name $name;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""count"": $count };"
779,What are the top 3 highest budget movies that have a poster path ending in 'jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'jpg' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*jpg"";
  $m has budget $budget;
sort $budget desc;
limit 3;
fetch {
  ""title"": $m.title, ""budget"": $budget
};"
780,Which 3 directors have the most movies with an average vote higher than 7?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.average_vote > 7
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN p.name AS director, num_movies","match
  $p isa person, has person_name $name;
  $m isa movie, has average_vote $avg;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  $avg > 7;
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 3;
fetch {
  ""director"": $name,
  ""num_movies"": $count
};"
781,List the first 3 countries where the most English language movies are produced.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'English'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS englishMovieCount
ORDER BY englishMovieCount DESC
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name ""English"";
  (media: $m, language: $l) isa original_language;
  $c isa country, has country_name $cn;
  (media: $m, country: $c) isa produced_in_country;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""englishMovieCount"": $count };"
782,What are the top 5 production companies by the number of movies with a runtime longer than 100 minutes?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 100
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  produced_by (producer: $c, media: $m);
  $runtime > 100;
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
783,List the first 3 actors who have played in movies with at least three different taglines.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(DISTINCT m.tagline) AS num_taglines
WHERE num_taglines >= 3
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has tagline $tag;
  cast_for (actor: $p, film: $m);
select $p, $pn, $tag;
distinct;
reduce $count = count($tag) groupby $p, $pn;
match $count >= 3;
limit 3;
fetch { ""person_name"": $pn };"
784,Which 3 genres have the most videos associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(v:Video)
RETURN g.name AS genre, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""videoCount"": $count };"
785,List the first 3 countries with the most videos produced.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
786,What are the top 5 movies with the longest runtime and released after 2010?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date > 2010-01-01;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
788,What are the top 5 genres of movies produced by Pixar Animation Studios?,"MATCH (c:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $c isa production_company, has production_company_name ""Pixar Animation Studios"";
  $m isa movie;
  produced_by (media: $m, producer: $c);
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""count"": $count };"
789,List the first 3 movies with the most revenue that were released after the year 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date > 2000-01-01T00:00:00;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
790,Who are the first 3 directors to have movies in more than one collection?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH p, count(distinct c) AS num_collections
WHERE num_collections > 1
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa collection;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  in_collection (media: $m, collection: $c);
select $p, $name, $c;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count > 1;
limit 3;
fetch {
  ""name"": $name
};"
791,What are the top 5 languages in which the most adult films were originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  $m isa adult_video;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
792,Which 3 production companies have produced the most adult films?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
RETURN c.name AS company, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa adult_video;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""num_adult_films"": $count };"
793,List the top 5 keywords associated with movies that have a runtime over 150 minutes.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.runtime > 150
RETURN k.name AS keyword, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $m isa movie, has runtime $rt;
  $rt > 150;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $count };"
794,What are the top 3 countries producing the most adult films with a runtime over 60 minutes?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE a.runtime > 60
RETURN c.name AS country, count(*) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa adult_video, has runtime $rt;
  $rt > 60;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
797,List the first 3 countries where the most English language movies are produced.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'English'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS englishMovieCount
ORDER BY englishMovieCount DESC
LIMIT 3","match
  $m isa movie;
  original_language (media: $m, language: $l);
  $l has language_name ""English"";
  produced_in_country (media: $m, country: $c);
  $c has country_name $name_c;
reduce $count = count($m) groupby $c, $name_c;
sort $count desc;
limit 3;
fetch { ""country"": $name_c, ""englishMovieCount"": $count };"
798,Which 3 production companies have produced movies with the highest average popularity?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has popularity $pop;
  produced_by (media: $m, producer: $c);
reduce $avg_pop = mean($pop) groupby $c, $cn;
sort $avg_pop desc;
limit 3;
fetch { ""company"": $cn, ""avg_popularity"": $avg_pop };"
799,List the first 3 movies with the lowest revenue and released before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has revenue $revenue;
  $m has title $title;
  $release_date < 1990-01-01;
sort $revenue asc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
800,What are the top 5 most popular genres based on average movie popularity?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 5
RETURN g.name AS genre, avg_popularity","match
  $g isa genre, has genre_name $genre_name;
  $m isa movie, has popularity $popularity;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($popularity) groupby $g, $genre_name;
sort $avg desc;
limit 5;
fetch {
  ""genre"": $genre_name,
  ""avg_popularity"": $avg
};"
801,Who are the first 3 actors to star in movies from both the horror and comedy genres?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE (m)-[:IN_GENRE]->(:Genre {name: 'Horror'})
AND (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  cast_for (actor: $p, film: $m);
  $g1 isa genre, has genre_name ""Horror"";
  $g2 isa genre, has genre_name ""Comedy"";
  in_genre (media: $m, genre: $g1);
  in_genre (media: $m, genre: $g2);
limit 3;
fetch {
  ""name"": $name
};"
802,Which 3 languages are most common in movies with a budget over $30 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 30000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has budget $budget;
  spoken_in_language (media: $m, language: $l);
  $budget > 30000000;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
803,List the first 3 genres of movies with the highest average vote count.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.vote_count) AS avg_votes
ORDER BY avg_votes DESC
LIMIT 3
RETURN g.name AS genre, avg_votes","match
  $m isa movie, has vote_count $vc;
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
reduce $avg = mean($vc) groupby $g, $gn;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $gn,
  ""avg_votes"": $avg
};"
804,What are the top 5 movies with the highest budget that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01') AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 1990-01-01T00:00:00;
  $release_date < 2000-01-01T00:00:00;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
805,Who are the first 3 directors with movies that have a runtime of over 180 minutes?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.runtime > 180
RETURN p.name AS director
ORDER BY director
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel0 has job ""Director"";
  $p has person_name $person_name_p;
  $m has runtime $runtime_m;
  $runtime_m > 180;
sort $person_name_p asc;
limit 3;
fetch {
  ""director"": $person_name_p
};"
806,Which 3 production companies have the most movies with a vote count over 1000?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.vote_count > 1000
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has vote_count $vc;
  $vc > 1000;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
808,What are the top 3 languages spoken in videos that have a revenue greater than $0?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.revenue > 0
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $v isa video, has revenue $rev;
  $rev > 0;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
810,List the first 3 genres with the most adult films associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(a:Adult)
WITH g, count(a) AS adultCount
ORDER BY adultCount DESC
RETURN g.name AS genre, adultCount
LIMIT 3","match
  $g isa genre, has genre_name $genre_name;
  $a isa adult_video;
  in_genre (genre: $g, media: $a);
reduce $count = count($a) groupby $g, $genre_name;
sort $count desc;
limit 3;
fetch {
  ""genre"": $genre_name,
  ""adultCount"": $count
};"
811,What are the top 5 movies with the most number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 5
RETURN m.title AS movie, languageCount AS spokenLanguages","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""spokenLanguages"": $count
};"
812,Which 3 directors have worked on movies with the longest total runtime?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WITH p, sum(m.runtime) AS total_runtime
RETURN p.name AS director, total_runtime
ORDER BY total_runtime DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie, has runtime $runtime;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $total = sum($runtime) groupby $p, $name;
sort $total desc;
limit 3;
fetch {
  ""director"": $name,
  ""total_runtime"": $total
};"
815,Who are the first 3 actors to have starred in at least 3 movies from the 'Toy Story Collection'?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WITH p, count(m) AS num_movies
WHERE num_movies >= 3
RETURN p.name
ORDER BY num_movies DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa collection, has collection_name ""Toy Story Collection"";
  cast_for (actor: $p, film: $m);
  in_collection (media: $m, collection: $c);
reduce $count = count($m) groupby $p, $name;
match $count >= 3;
sort $count desc;
limit 3;
fetch {
  ""name"": $name
};"
816,Which 3 languages are spoken most commonly in movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.runtime > 120
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has runtime $rt;
  $rt > 120;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
817,List the first 3 genres that have the most movies featuring Tom Hanks.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $p isa person, has person_name ""Tom Hanks"";
  $m isa movie;
  $g isa genre, has genre_name $gn;
  cast_for (actor: $p, film: $m);
  in_genre (media: $m, genre: $g);
reduce $movie_count = count($m) groupby $g, $gn;
sort $movie_count desc;
limit 3;
fetch { ""genre"": $gn, ""movie_count"": $movie_count };"
818,What are the top 5 production companies by the number of comedy films produced?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN c.name AS company, count(*) AS comedyCount
ORDER BY comedyCount DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  produced_by (media: $m, producer: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name, ""comedyCount"": $count };"
819,List the first 3 genres of movies with the highest average vote count.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.vote_count) AS avg_votes
ORDER BY avg_votes DESC
LIMIT 3
RETURN g.name AS genre, avg_votes","match
  $m isa movie, has vote_count $votes;
  in_genre (media: $m, genre: $g);
  $g has genre_name $name;
reduce $avg = mean($votes) groupby $g, $name;
sort $avg desc;
limit 3;
fetch { ""genre"": $name, ""avg_votes"": $avg };"
823,List the top 5 keywords associated with the most commercially successful movies.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH k, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN k.name AS keyword, total_revenue","match
  $m isa movie;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
  $m has revenue $revenue;
reduce $total = sum($revenue) groupby $k;
sort $total desc;
limit 5;
fetch {
  ""keyword"": $k.keyword_name,
  ""total_revenue"": $total
};"
824,What are the top 3 countries producing the most comedies?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN c.name AS country, count(*) AS comedyCount
ORDER BY comedyCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  produced_in_country (media: $m, country: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;"
825,Who are the first 3 actors who have starred in both comedies and dramas?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
  AND (p)-[:CAST_FOR]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m1 isa movie;
  $m2 isa movie;
  $g1 isa genre, has genre_name ""Comedy"";
  $g2 isa genre, has genre_name ""Drama"";
  cast_for (actor: $p, film: $m1);
  cast_for (actor: $p, film: $m2);
  in_genre (media: $m1, genre: $g1);
  in_genre (media: $m2, genre: $g2);
  $p has person_name $name;
limit 3;
fetch {
  ""name"": $name
};"
826,Which 3 languages are spoken in the most films with a poster featuring '/rh'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rh'
WITH m
MATCH (m)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has poster_path $path;
  $path like "".*/rh.*"";
  spoken_in_language (media: $m, language: $l);
  $l has language_name $name_l;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""count"": $count };"
827,List the first 3 genres of movies with the lowest average revenue.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.revenue) AS avg_revenue
ORDER BY avg_revenue
RETURN g.name AS genre, avg_revenue
LIMIT 3","match
  $m isa movie, has revenue $revenue;
  $g isa genre, has genre_name $name;
  in_genre (media: $m, genre: $g);
reduce $avg = mean($revenue) groupby $g, $name;
sort $avg asc;
limit 3;
fetch {
  ""genre"": $name,
  ""avg_revenue"": $avg
};"
828,What are the top 5 movies with a tagline that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'adventure'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline $tagline;
  $tagline like ""(?i).*adventure.*"";
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
829,Who are the first 3 directors of movies with a budget less than $5 million?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.budget < 5000000
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel0 has job ""Director"";
  $p has person_name $person_name_p;
  $m has budget $budget_m;
  $budget_m < 5000000;
limit 3;
fetch {
  ""name"": $person_name_p
};"
830,Which 3 production companies have produced the most films with a release date before 1980?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.release_date < date('1980-01-01')
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has release_date $rd;
  produced_by (producer: $c, media: $m);
  $rd < 1980-01-01;
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
832,"What are the top 3 countries where the most videos with a budget over $500,000 are produced?","MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 500000
RETURN c.name AS country, count(*) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $v isa video, has budget $budget;
  $budget > 500000;
  produced_in_country (media: $v, country: $c);
reduce $video_count = count($v) groupby $cn;
sort $video_count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $video_count };"
834,List the first 3 genres with the most movies released in the 21st century.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.release_date >= date('2000-01-01')
WITH g, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN g.name AS genre, num_movies","match
  $g isa genre, has genre_name $genre_name;
  $m isa movie, has release_date $release_date;
  in_genre (genre: $g, media: $m);
  $release_date >= 2000-01-01T00:00:00;
reduce $count = count($m) groupby $g, $genre_name;
sort $count desc;
limit 3;
fetch {
  ""genre"": $genre_name,
  ""num_movies"": $count
};"
835,What are the top 5 movies with the most keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5","match
  $m isa movie, has title $title;
  has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m, $title;
sort $keyword_count desc;
limit 5;
fetch { ""movie"": $title, ""keywordCount"": $keyword_count };"
836,Which 3 directors have the highest average vote for their movies?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WITH p, avg(m.average_vote) AS avg_vote
RETURN p.name AS director, avg_vote
ORDER BY avg_vote DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie, has average_vote $avg_vote;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $avg = mean($avg_vote) groupby $p, $name;
sort $avg desc;
limit 3;
fetch {
  ""director"": $name,
  ""avg_vote"": $avg
};"
837,List the first 3 movies with the most unique spoken languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN m.title AS movie, collect(DISTINCT l.name) AS languages, size(collect(DISTINCT l.name)) AS numLanguages
ORDER BY numLanguages DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $num_languages = count($l) groupby $m;
sort $num_languages desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""numLanguages"": $num_languages
};"
838,What are the top 5 countries with the most movies featuring an average vote over 7.5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 7.5
RETURN c.name AS country, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie, has average_vote $av;
  $av > 7.5;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""num_movies"": $count };"
839,Who are the first 3 actors to have roles in movies with at least five different production companies?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany)
WITH p, count(DISTINCT c) AS num_companies
WHERE num_companies >= 5
RETURN p.name
ORDER BY num_companies DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa production_company;
  cast_for (actor: $p, film: $m);
  produced_by (media: $m, producer: $c);
select $p, $c, $name;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count >= 5;
sort $count desc;
limit 3;
fetch {
  ""name"": $name
};
"
840,Which 3 languages are most commonly found in movies with a status of 'In Production'?,"MATCH (m:Movie {status: 'In Production'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has status ""In Production"";
  $l isa language, has language_name $ln;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
841,List the top 5 adult films based on the number of different languages spoken.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH a, count(distinct l) as numLanguages
ORDER BY numLanguages DESC
LIMIT 5
RETURN a.title as title, numLanguages","match
  $a isa adult_video, has title $title;
  spoken_in_language (media: $a, language: $l);
select $a, $title, $l;
distinct;
reduce $count = count($l) groupby $a, $title;
sort $count desc;
limit 5;
fetch {
  ""title"": $title,
  ""numLanguages"": $count
};"
844,Which 3 production companies have produced the most movies with a popularity over 20?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.popularity > 20
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company;
  $m isa movie, has popularity $pop;
  $pop > 20;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""num_movies"": $count
};"
845,List the first 3 movies that have a homepage and were released after 2010.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m.title, m.homepage, m.release_date
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has release_date $release_date;
  $release_date > 2010-01-01;
  $m has title $title;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage, ""release_date"": $release_date
};"
846,Who are the first 3 actors who starred in movies that won at least one Oscar?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.title IN ['The Lord of the Rings: The Return of the King', 'Titanic', 'Forrest Gump']
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  cast_for (actor: $p, film: $m);
  { $m has title ""The Lord of the Rings: The Return of the King""; } or
  { $m has title ""Titanic""; } or
  { $m has title ""Forrest Gump""; };
limit 3;
fetch {
  ""name"": $p.person_name
};"
847,Which 3 languages are most commonly spoken in movies with an average vote below 4?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.average_vote < 4
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has average_vote $av;
  $av < 4;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
848,List the first 3 movies with the highest number of directors.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WHERE p.job = 'Director'
WITH m, count(p) AS num_directors
ORDER BY num_directors DESC
RETURN m.title AS movie, num_directors
LIMIT 3","match
  $m isa movie, has title $title;
  $crew isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($p) groupby $m, $title;
sort $count desc;
limit 3;
fetch { ""movie"": $title, ""num_directors"": $count };"
849,What are the top 5 production companies with the most movies featuring a runtime over 150 minutes?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 150
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  produced_by (producer: $c, media: $m);
  $runtime > 150;
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
850,Who are the first 3 directors who have worked on movies with an average vote below 5?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.average_vote < 5
RETURN p.name AS director
ORDER BY m.average_vote
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel0 has job ""Director"";
  $p has person_name $person_name_p;
  $m has average_vote $average_vote_m;
  $average_vote_m < 5;
sort $average_vote_m asc;
limit 3;
fetch {
  ""director"": $person_name_p
};"
851,What are the top 5 countries producing the most movies with a tagline that includes the word 'love'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE toLower(m.tagline) CONTAINS 'love'
RETURN c.name AS country, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
  $m has tagline $tag;
  $tag like "".*[Ll]ove.*"";
reduce $movie_count = count($m) groupby $cn;
sort $movie_count desc;
limit 5;"
852,Which 3 production companies have the most movies with a runtime under 80 minutes?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime < 80
WITH c, count(m) AS num_movies
RETURN c.name AS company, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  $runtime < 80;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
854,What are the top 5 genres with the most movies having a poster path that starts with '/rh'?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.poster_path STARTS WITH '/rh'
RETURN g.name AS genre, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
  $m isa movie, has poster_path $path;
  $path like ""/rh.*"";
  in_genre (media: $m, genre: $g);
  $g has genre_name $name;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
856,Which 3 languages are most common in movies with a revenue over $200 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 200000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has revenue $rev;
  $rev > 200000000;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
857,List the top 5 movies with the most production companies involved.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN m.title AS movie, count(c) AS numCompanies
ORDER BY numCompanies DESC
LIMIT 5","match
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $num_companies = count($c) groupby $m;
sort $num_companies desc;
limit 5;
fetch { ""movie"": $m.title, ""numCompanies"": $num_companies };"
858,What are the top 3 countries producing the most videos with a budget over $1 million?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 1000000
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $v isa video, has budget $budget;
  $budget > 1000000;
  $c isa country, has country_name $cn;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
859,Who are the first 3 actors to have appeared in movies from more than five different countries?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH p, count(distinct c) as numCountries
WHERE numCountries > 5
RETURN p.name
ORDER BY numCountries DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $c isa country;
  cast_for (actor: $p, film: $m);
  produced_in_country (media: $m, country: $c);
  $p has person_name $name;
select $p, $c, $name;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count > 5;
sort $count desc;
limit 3;
fetch {
  ""name"": $name
};"
860,List the first 3 genres with the most movies featuring a runtime over 200 minutes.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 200
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie, has runtime $rt;
  $rt > 200;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""numMovies"": $count };"
861,What are the top 5 movies with the most spoken languages and released after 2015?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2015-01-01')
WITH m, count(l) AS languageCount
RETURN m.title, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date > 2015-01-01;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""languageCount"": $count
};"
862,Which 3 directors have the most films with a status of 'Released'?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie {status: 'Released'})
RETURN p.name AS director, count(m) AS num_released_movies
ORDER BY num_released_movies DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has status ""Released"";
  crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($m) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""director"": $pn, ""num_released_movies"": $count };"
864,List the first 3 languages spoken in movies released after 2010.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2010-01-01')
RETURN l.name AS language
ORDER BY language
LIMIT 3","match
  $m isa movie;
  $l isa language;
  spoken_in_language (media: $m, language: $l);
  $m has release_date $release_date;
  $release_date > 2010-01-01;
  $l has language_name $language_name;
sort $language_name asc;
limit 3;
fetch {
  ""language"": $language_name
};"
865,Which 5 movies have the highest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote IS NOT NULL
RETURN m.title, m.average_vote, m.release_date
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date < 2000-01-01;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""release_date"": $release_date
};"
866,Name the top 3 production companies by the number of movies produced with a budget over 100 million USD.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
WITH c, count(m) AS num_movies
RETURN c.name AS company, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has budget $budget;
  $budget > 100000000;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};
"
869,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""keywordCount"": $count };"
870,List the top 5 actors by the number of movies they have cast in.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS actor, num_movies","match
  $p isa person, has person_name $name;
  cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""num_movies"": $count
};"
872,Which 5 users have rated the highest number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 5;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
873,Name the top 3 genres in videos that have a runtime less than 30 minutes.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime < 30
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $v isa video, has runtime $rt;
  $rt < 30;
  $g isa genre, has genre_name $gn;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn };"
874,List the first 5 production companies that produced videos with zero revenue.,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(v:Video)
WHERE v.revenue = 0
RETURN c.name
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $v isa video, has revenue $r;
  $r == 0.0;
  produced_by (producer: $c, media: $v);
limit 5;
fetch {
  ""name"": $name
};"
875,What are the top 3 countries where adult films are produced the most?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa adult_video;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
876,"Which 5 keywords are most common in adult films with a budget less than 500,000 USD?","MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WHERE a.budget < 500000
RETURN k.name, count(*) as count
ORDER BY count DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $m isa adult_video, has budget $budget;
  has_keyword (media: $m, keyword: $k);
  $budget < 500000;
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""count"": $count };"
877,List the top 3 movies with the highest revenue that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has revenue $revenue;
  in_collection (media: $m, collection: $c);
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
878,"Name the first 5 movies that were rated by users on a specific date, e.g., '2020-01-01'.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE date(r.timestamp) = date('2020-01-01')
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $u isa user;
  $r isa rated (rated_media: $m, reviewer: $u), has timestamp $timestamp;
  $timestamp >= 2020-01-01T00:00:00;
  $timestamp < 2020-01-02T00:00:00;
limit 5;
fetch {
  ""title"": $m.title
};"
881,Which 3 languages are most frequently listed as the original language in videos?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $v isa video;
  $l isa language, has language_name $ln;
  original_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""frequency"": $count };"
883,What are the first 3 genres associated with the highest-grossing movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
RETURN g.name AS genre, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match
  $m isa movie, has revenue $rev;
  in_genre (media: $m, genre: $g);
  $g has genre_name $name;
reduce $total = sum($rev) groupby $g, $name;
sort $total desc;
limit 3;
fetch { ""genre"": $name, ""total_revenue"": $total };"
884,Name the top 5 directors who have worked on the most films.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
WITH p, count(r) AS num_films
ORDER BY num_films DESC
LIMIT 5
RETURN p.name AS director, num_films","match
  $p isa person, has person_name $name;
  $r isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""director"": $name,
  ""num_films"": $count
};"
886,Which 5 movies have the most cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
RETURN m.title AS movie, count(p) AS cast_size
ORDER BY cast_size DESC
LIMIT 5","match
  $m isa movie;
  cast_for (actor: $p, film: $m);
reduce $cast_size = count($p) groupby $m;
sort $cast_size desc;
limit 5;
fetch { ""movie"": $m.title, ""cast_size"": $cast_size };"
887,List the top 3 countries by the number of videos produced.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
890,List the first 5 adult films released after 2010.,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 5","match
  $a isa adult_video;
  $a has release_date $release_date;
  $a has title $title;
  $release_date > 2010-01-01;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
891,Which 3 users have given the highest ratings to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id AS user, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3","match
  $u isa user, has user_id $uid;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $m isa movie;
reduce $avg_rating = mean($rating) groupby $u, $uid;
sort $avg_rating desc;
limit 3;
fetch { ""user"": $uid, ""avg_rating"": $avg_rating };"
892,List the top 5 actors based on the number of leading roles they have had in movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.order = 0
WITH p, count(r) AS leadingRoles
ORDER BY leadingRoles DESC
LIMIT 5
RETURN p.name AS actor, leadingRoles","match
  $p isa person, has person_name $name;
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m), has cast_order $order;
  $order == 0;
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""leadingRoles"": $count
};"
893,What are the first 3 movies that were produced in the United States and have a vote count greater than 5000?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WHERE m.vote_count > 5000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $vote_count > 5000;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $m, country: $c);
limit 3;
fetch {
  ""title"": $m.title
};"
894,Name the top 5 production companies that have produced movies with a runtime longer than 150 minutes.,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 150
RETURN c.name AS company, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $rt;
  $rt > 150;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name, ""num_movies"": $count };"
895,List the first 3 keywords associated with movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN k.name
LIMIT 3","match
  $m isa movie;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $k has keyword_name $keyword_name;
limit 3;
fetch {
  ""name"": $keyword_name
};"
896,Which 5 genres are most common among movies with a budget over 200 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 200000000
WITH g, count(*) AS count
ORDER BY count DESC
LIMIT 5
RETURN g.name AS genre, count","match
  $m isa movie, has budget $budget;
  $g isa genre, has genre_name $genre_name;
  in_genre (media: $m, genre: $g);
  $budget > 200000000;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""count"": $count
};"
899,What are the top 3 movies based on popularity that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 1990-01-01;
  $release_date < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
901,Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget/m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has revenue $revenue;
  $m has title $title;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""ratio"": $ratio
};"
906,Which 5 countries have produced the most adult films?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa adult_video;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
909,What are the top 3 genres associated with videos that have a runtime over 100 minutes?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime > 100
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $v isa video, has runtime $rt;
  $rt > 100;
  $g isa genre, has genre_name $gn;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
910,List the first 5 production companies that have produced the most adult films.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
WITH c, count(a) AS adultCount
ORDER BY adultCount DESC
LIMIT 5
RETURN c.name AS productionCompany, adultCount","match
  $c isa production_company, has production_company_name $name;
  $a isa adult_video;
  produced_by (producer: $c, media: $a);
reduce $count = count($a) groupby $c, $name;
sort $count desc;
limit 5;
fetch {
  ""productionCompany"": $name,
  ""adultCount"": $count
};"
911,Which 3 movies have the longest runtime and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date < 2000-01-01;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
912,List the top 5 actors by the number of movies they have cast in with a budget over 50 million USD.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.budget > 50000000
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS actor, num_movies","match
  $p isa person, has person_name $name;
  $m isa movie, has budget $budget;
  cast_for (actor: $p, film: $m);
  $budget > 50000000;
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""num_movies"": $count
};"
913,What are the first 3 languages spoken in the most popular movies (popularity > 20)?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 20
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
  $m has popularity $pop;
  $pop > 20;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
594,List the first 3 users who rated the adult film titled 'Standoff'.,"MATCH (u:User)-[:RATED]->(a:Adult {title: 'Standoff'})
RETURN u
LIMIT 3","match
$u isa user;
$a isa adult_video, has title ""Standoff"";
rated (reviewer: $u, rated_media: $a);
limit 3;
fetch { ""user"": $u.user_id };"
666,Which 3 adult films have been rated by the most users?,"MATCH (a:Adult)<-[r:RATED]-(u:User)
RETURN a.title, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3","match
$a isa adult_video;
$r isa rated (rated_media: $a);
reduce $num_ratings = count($r) groupby $a;
sort $num_ratings desc;
limit 3;
fetch { ""title"": $a.title, ""num_ratings"": $num_ratings };"
742,List the top 3 adult films that have been rated exactly 3 times.,"MATCH (a:Adult)<-[r:RATED]-(u:User)
WITH a, count(r) AS ratingCount
WHERE ratingCount = 3
RETURN a.title AS title, a.release_date AS releaseDate
ORDER BY a.popularity DESC
LIMIT 3","match
$a isa adult_video;
$r isa rated (rated_media: $a);
reduce $rating_count = count($r) groupby $a;
match
$rating_count == 3;
$a has popularity $pop;
sort $pop desc;
limit 3;
fetch { ""title"": $a.title, ""releaseDate"": $a.release_date };"
787,Who are the first 3 actors by number of roles in adult films?,"MATCH (p:Person)-[:CAST_FOR]->(a:Adult)
WITH p, count(a) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name AS actor, roles","match
$p isa person;
$a isa adult_video;
cast_for (actor: $p, film: $a);
reduce $roles = count($a) groupby $p;
sort $roles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""roles"": $roles };"
855,Who are the first 3 directors to have made both adult films and videos?,"MATCH (p:Person)-[:CREW_FOR]->(a:Adult), (p)-[:CREW_FOR]->(v:Video)
WHERE a.id IS NOT NULL AND v.id IS NOT NULL
WITH p, count(DISTINCT a) AS numAdult, count(DISTINCT v) AS numVideo
WHERE numAdult > 0 AND numVideo > 0
RETURN p.name
LIMIT 3","match
$p isa person;
$a isa adult_video;
$r1 isa crew_for (crew_member: $p, film: $a), has job ""Director"";
$v isa video;
not { $v isa adult_video; };
$r2 isa crew_for (crew_member: $p, film: $v), has job ""Director"";
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
879,What are the top 3 actors who have played in the most number of adult films?,"MATCH (p:Person)-[:CAST_FOR]->(a:Adult)
WITH p, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN p.name AS actor, num_adult_films","match
$p isa person;
$a isa adult_video;
cast_for (actor: $p, film: $a);
reduce $num_adult_films = count($a) groupby $p;
sort $num_adult_films desc;
limit 3;
fetch { ""actor"": $p.person_name, ""num_adult_films"": $num_adult_films };"
421,What are the first 5 actors who have starred in both a movie and an adult film?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE EXISTS {
  (p)-[:CAST_FOR]->(:Adult)
}
RETURN p.name
LIMIT 5","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$a isa adult_video;
cast_for (actor: $p, film: $a);
select $p;
distinct;
limit 5;
fetch { ""name"": $p.person_name };"
795,Who are the first 3 actors with roles in both movies and adult films?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE EXISTS {(p)-[:CAST_FOR]->(:Adult)}
RETURN p.name
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$a isa adult_video;
cast_for (actor: $p, film: $a);
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
821,Who are the first 3 directors who have worked on both movies and adult films?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie)
WHERE (p)-[:CREW_FOR]->(:Adult)
  AND exists{ (p)-[:CREW_FOR {job: 'Director'}]->(:Movie) }
  AND exists{ (p)-[:CREW_FOR {job: 'Director'}]->(:Adult) }
RETURN p.name
LIMIT 3","match
$p isa person;
$r1 isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$m isa movie;
$r2 isa crew_for (crew_member: $p, film: $a), has job ""Director"";
$a isa adult_video;
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
80,List all movies that have a backdrop path available.,"MATCH (m:Movie)
WHERE m.backdrop_path IS NOT NULL
RETURN m.title","match
$m isa movie, has backdrop_path $bp;
fetch { ""title"": $m.title };"
228,List the first 3 movies with a backdrop path that includes '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'.,"MATCH (m:Movie)
WHERE m.backdrop_path IS NOT NULL AND m.backdrop_path CONTAINS '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has backdrop_path $bp;
$bp like "".*9FBwqcd9IRruEDUrTdcaafOMKUq.*"";
limit 3;
fetch { ""title"": $m.title };"
312,Which 3 videos have the most associated cast members?,"MATCH (v:Video)<-[:CAST_FOR]-(p:Person)
RETURN v.title AS video, count(p) AS cast_members
ORDER BY cast_members DESC
LIMIT 3","match
$v isa video;
$p isa person;
cast_for (actor: $p, film: $v);
reduce $cast_members = count($p) groupby $v;
sort $cast_members desc;
limit 3;
fetch { ""video"": $v.title, ""cast_members"": $cast_members };"
362,Name the top 5 movies that have been produced in more than 3 countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS countryCount
WHERE countryCount > 3
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $country_count = count($c) groupby $m;
match
$country_count > 3;
$m has popularity $pop;
sort $pop desc;
limit 5;
fetch { ""title"": $m.title };"
457,Name the first 5 movies that have been rated by at least 50 users.,"MATCH (m:Movie)<-[r:RATED]-(:User)
WITH m, count(r) AS num_ratings
WHERE num_ratings >= 50
RETURN m.title
ORDER BY num_ratings DESC
LIMIT 5","match
$m isa movie;
$r isa rated (rated_media: $m);
reduce $num_ratings = count($r) groupby $m;
match
$num_ratings >= 50;
sort $num_ratings desc;
limit 5;
fetch { ""title"": $m.title };"
504,Which movies have been produced in the 'United States of America' and have an adult rating?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WHERE exists {(u:User)-[:RATED]->(a:Adult)<-[:RATED]-(u)-[:RATED]->(m)} 
RETURN m.title","match
$m isa movie;
$co isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $co);
$u isa user;
$a isa adult_video;
rated (reviewer: $u, rated_media: $a);
rated (reviewer: $u, rated_media: $m);
select $m;
distinct;
fetch { ""title"": $m.title };"
527,Which movies have a runtime longer than the average runtime of all movies?,"MATCH (m:Movie)
WITH m, avg(m.runtime) AS avg_runtime
WHERE m.runtime > avg_runtime
RETURN m.title, m.runtime
ORDER BY m.runtime DESC","with fun avg_movie_runtime() -> double:
  match $m isa movie, has runtime $r;
  return mean($r);

match
$m isa movie, has runtime $r;
let $avg = avg_movie_runtime();
$r > $avg;
sort $r desc;
fetch { ""title"": $m.title, ""runtime"": $r };"
607,"Which 3 production companies are associated with the most number of genres across movies, videos, and adult films?","MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m)
WHERE m:Movie OR m:Video OR m:Adult
WITH c, count(distinct m) AS num_genres
RETURN c.name AS company, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$c isa production_company;
produced_by (media: $m, producer: $c);
in_genre (media: $m, genre: $g);
select $c, $g;
distinct;
reduce $num_genres = count($g) groupby $c;
sort $num_genres desc;
limit 3;
fetch { ""company"": $c.production_company_name, ""num_genres"": $num_genres };"
622,Which 3 people have acted in the most number of videos?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video)
WITH p, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3
RETURN p.name AS person, videoCount","match
$p isa person;
$v isa video;
cast_for (actor: $p, film: $v);
reduce $video_count = count($v) groupby $p;
sort $video_count desc;
limit 3;
fetch { ""person"": $p.person_name, ""videoCount"": $video_count };"
809,Who are the first 3 actors by number of roles in videos with a status of 'Released'?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video {status: 'Released'})
RETURN p.name AS actor, count(*) AS num_roles
ORDER BY num_roles DESC
LIMIT 3","match
$p isa person;
$v isa video, has status ""Released"";
cast_for (actor: $p, film: $v);
reduce $num_roles = count($v) groupby $p;
sort $num_roles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""num_roles"": $num_roles };"
831,Who are the first 3 actors to have starred in at least 3 movies from the 'Toy Story Collection'?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WITH p, count(m) AS num_movies
WHERE num_movies >= 3
RETURN p.name
ORDER BY num_movies DESC
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
reduce $num_movies = count($m) groupby $p;
match
$num_movies >= 3;
sort $num_movies desc;
limit 3;
fetch { ""name"": $p.person_name };"
833,Who are the first 3 actors with the most roles in videos released after 2010?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video)
WHERE v.release_date > date('2010-01-01')
WITH p, count(v) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name AS actor, roles","match
$p isa person;
$v isa video, has release_date $rd;
$rd > 2010-01-01T00:00:00;
cast_for (actor: $p, film: $v);
reduce $roles = count($v) groupby $p;
sort $roles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""roles"": $roles };"
843,Who are the first 3 directors with movies in at least three different genres?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WITH p, count(distinct m.id) AS num_movies, collect(distinct m.id) AS movie_ids
WHERE num_movies >= 3
WITH p, num_movies, movie_ids
UNWIND movie_ids AS movie_id
MATCH (m:Movie {id: movie_id})-[:IN_GENRE]->(g:Genre)
WITH p, num_movies, collect(distinct g.name) AS genres
WHERE size(genres) >= 3
RETURN p.name AS director, num_movies, genres
ORDER BY num_movies DESC
LIMIT 3","match
$p isa person;
$cf isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$m isa movie;
in_genre (media: $m, genre: $g);
select $p, $g;
distinct;
reduce $num_genres = count($g) groupby $p;
match
$num_genres >= 3;
sort $num_genres desc;
limit 3;
fetch { ""director"": $p.person_name, ""num_genres"": $num_genres };"
853,List the first 3 actors who have appeared in at least three movies with different original languages.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(DISTINCT m.original_language) AS num_languages
WHERE num_languages >= 3
RETURN p.name
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
original_language (media: $m, language: $l);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages >= 3;
limit 3;
fetch { ""name"": $p.person_name };"
897,List the top 3 actors who have appeared in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(m) AS numMovies
WHERE numMovies > 0
MATCH (p)-[:CAST_FOR]->(v:Video) 
WITH p, numMovies, count(v) AS numVideos
WHERE numVideos > 0
RETURN p.name AS actor, numMovies, numVideos
ORDER BY numMovies + numVideos DESC
LIMIT 3","with fun movie_count($p: person) -> integer:
  match cast_for (actor: $p, film: $m); $m isa movie;
  return count;

with fun video_count($p: person) -> integer:
  match cast_for (actor: $p, film: $v); $v isa video;
  return count;

match
$p isa person;
let $num_movies = movie_count($p);
let $num_videos = video_count($p);
$num_movies > 0;
$num_videos > 0;
let $total = $num_movies + $num_videos;
sort $total desc;
limit 3;
fetch { ""actor"": $p.person_name, ""numMovies"": $num_movies, ""numVideos"": $num_videos };"
796,List the first 3 actors with roles in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE exists{ (p)-[:CAST_FOR]->(:Video) }
RETURN p.name
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$v isa video;
cast_for (actor: $p, film: $v);
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
225,What are the first 5 movies that have a genre change from their original genre in a collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE EXISTS {
  (m)-[:IN_GENRE]->(g1:Genre)
  WHERE NOT EXISTS {
    (c)-[:IN_GENRE]->(g2:Genre)
    WHERE g1.name = g2.name
  }
}
RETURN m.title, c.name
LIMIT 5","match
$m isa movie;
$c isa collection;
in_collection (media: $m, collection: $c);
in_genre (media: $m, genre: $g);
not { in_genre (media: $c, genre: $g); };
select $m, $c;
distinct;
limit 5;
fetch { ""title"": $m.title, ""collection"": $c.collection_name };"
524,Which movies have been produced by companies based in 'France'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)-[:PRODUCED_IN_COUNTRY]->(country:Country {name: 'France'})
RETURN m.title","match
$m isa movie;
$co isa country, has country_name ""France"";
produced_in_country (media: $m, country: $co);
fetch { ""title"": $m.title };"
902,"List the top 5 movies with the most diverse cast, measured by the number of different countries actors come from.","MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, size(collect(distinct p.country)) AS num_countries
ORDER BY num_countries DESC
LIMIT 5
RETURN m.title AS movie, num_countries AS number_of_countries","match
$m isa movie;
$p isa person;
cast_for (actor: $p, film: $m);
born_in (person: $p, country: $co);
select $m, $co;
distinct;
reduce $num_countries = count($co) groupby $m;
sort $num_countries desc;
limit 5;
fetch { ""movie"": $m.title, ""number_of_countries"": $num_countries };"
