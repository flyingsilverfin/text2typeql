domain,original_index,question,cypher,typeql
twitter,0,Which users follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS follower","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""follower"": $u.screen_name };"
twitter,1,List all tweets tagged with the hashtag 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t","match
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,2,Find all users who have more than 30000 followers.,"MATCH (u:User)
WHERE u.followers > 30000
RETURN u","match
$u isa user, has followers $f;
$f > 30000;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""followers"": $f };"
twitter,3,What are the profile image URLs of users located in 'Graphs Are Everywhere'?,"MATCH (u:User)
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.profile_image_url","match
$u isa user, has location ""Graphs Are Everywhere"";
fetch { ""profile_image_url"": $u.profile_image_url };"
twitter,4,Retrieve the top 5 most recent tweets.,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5","match
$t isa tweet, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
twitter,5,Which users are mentioned in the tweet with ID 1371846247913512966?,"MATCH (t:Tweet {id: 1371846247913512966})-[:MENTIONS]->(u:User)
RETURN u.name AS user","match
$t isa tweet, has tweet_id 1371846247913512966;
$u isa user;
mentions (source_tweet: $t, mentioned_user: $u);
fetch { ""user"": $u.name };"
twitter,6,List all users who follow 'Neo4j' and have a betweenness greater than 1000000.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.betweenness > 1000000
RETURN u","match
$u isa user, has betweenness $b;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
$b > 1000000;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""betweenness"": $b };"
twitter,7,What are the URLs of the links contained in tweets from 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""url"": $l.link_url };"
twitter,8,Show the top 3 users with the highest number of statuses.,"MATCH (u:User)
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
$u isa user, has statuses $s;
sort $s desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""statuses"": $s };"
twitter,9,Find all tweets that retweet the tweet with ID 690028662083612672.,"MATCH (t:Tweet)-[:RETWEETS]->(retweeted:Tweet {id: 690028662083612672})
RETURN t","match
$t isa tweet;
$retweeted isa tweet, has tweet_id 690028662083612672;
retweets (retweeting_tweet: $t, original_tweet: $retweeted);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,10,Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
$sc > 0.5;
fetch { ""screen_name"": $u.screen_name, ""score"": $sc };"
twitter,11,List the names of users who have interacted with 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'})<-[:INTERACTS_WITH]-(u:User)
RETURN u.name","match
$me isa me, has name ""Neo4j"";
$u isa user;
interacts_with (interactor: $u, target: $me);
fetch { ""name"": $u.name };"
twitter,12,How many users does 'Neo4j' follow?,"MATCH (me:Me {name: 'Neo4j'})
RETURN me.following AS following","match
$me isa me, has name ""Neo4j"";
fetch { ""following"": $me.following };"
twitter,13,Display tweets that use the source named 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t","match
$t isa tweet;
$s isa source, has source_name ""Buffer"";
using (tweet_content: $t, platform: $s);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,14,Find all tweets posted by 'Neo4j' between January and February 2021.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= date('2021-01-01') AND t.created_at < date('2021-03-01') 
RETURN t","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
$ca >= 2021-01-01T00:00:00;
$ca < 2021-03-01T00:00:00;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
twitter,15,What are the names of all hashtags used in tweets from 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN DISTINCT h.name","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$h isa hashtag;
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
fetch { ""name"": $h.hashtag_name };"
twitter,16,List all tweets that reply to the tweet with ID 1371815021265747970.,"MATCH (repliedTweet:Tweet)-[:REPLY_TO]->(originalTweet:Tweet {id: 1371815021265747970})
RETURN repliedTweet","match
$replying isa tweet;
$original isa tweet, has tweet_id 1371815021265747970;
reply_to (replying_tweet: $replying, original_tweet: $original);
fetch { ""text"": $replying.text, ""tweet_id"": $replying.tweet_id, ""created_at"": $replying.created_at };"
twitter,17,Which users are amplified by 'Me'?,"MATCH (me:Me)-[:AMPLIFIES]->(user:User)
RETURN user.name AS user, user.screen_name AS handle","match
$me isa me;
$user isa user;
amplifies (amplifier: $me, amplified_user: $user);
fetch { ""user"": $user.name, ""handle"": $user.screen_name };"
twitter,18,Retrieve the top 5 tweets with the most favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 5;
fetch { ""text"": $t.text, ""favorites"": $f };"
twitter,19,Show all users followed by 'Me' with more than 10000 followers.,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
WHERE u.followers > 10000
RETURN u.name, u.screen_name, u.followers","match
$me isa me;
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
$f > 10000;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,20,How many followers does the user with screen name 'neo4j' have?,"MATCH (u:User {screen_name: 'neo4j'})
RETURN u.followers AS followers","match
$u isa user, has screen_name ""neo4j"";
fetch { ""followers"": $u.followers };"
twitter,21,What is the location of the user with the highest betweenness value?,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.location
ORDER BY u.betweenness DESC
LIMIT 1","match
$u isa user, has betweenness $b;
sort $b desc;
limit 1;
fetch { ""location"": $u.location };"
twitter,22,List the screen names of users who follow at least 100 other users.,"MATCH (u:User)
WHERE u.following >= 100
RETURN u.screen_name","match
$u isa user, has following $f;
$f >= 100;
fetch { ""screen_name"": $u.screen_name };"
twitter,23,Which users have posted tweets containing the link 'https://twitter.com/i/web/status/13718150212657479'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link {url: 'https://twitter.com/i/web/status/13718150212657479'})
RETURN u.name, u.screen_name","match
$u isa user;
$t isa tweet;
$l isa link, has link_url ""https://twitter.com/i/web/status/13718150212657479"";
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name };"
twitter,24,Retrieve the top 3 users sorted by their following count in descending order.,"MATCH (u:User)
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
$u isa user, has following $f;
sort $f desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""following"": $f };"
twitter,25,Identify the users who are mentioned and retweeted in the same tweet.,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)-[:MENTIONS]->(u)
RETURN u.name AS user, t.text AS tweet_text, retweeted_tweet.text AS retweeted_tweet_text","match
$u isa user;
$t isa tweet;
$retweeted isa tweet;
mentions (source_tweet: $t, mentioned_user: $u);
retweets (retweeting_tweet: $t, original_tweet: $retweeted);
mentions (source_tweet: $retweeted, mentioned_user: $u);
fetch { ""user"": $u.name, ""tweet_text"": $t.text, ""retweeted_tweet_text"": $retweeted.text };"
twitter,26,Find tweets that mention 'Neo4j' and are tagged with 'education'.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE t.text CONTAINS 'Neo4j'
RETURN t","match
$t isa tweet, has text $txt;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
fetch { ""text"": $txt, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,27,Show the sources used by tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'}), 
      (t)-[:USING]->(s:Source)
RETURN DISTINCT s.name AS source","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
$s isa source;
mentions (source_tweet: $t, mentioned_user: $u);
using (tweet_content: $t, platform: $s);
fetch { ""source"": $s.source_name };"
twitter,28,What is the text of the most favorited tweet?,"MATCH (t:Tweet)
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 1","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 1;
fetch { ""tweet_text"": $t.text };"
twitter,29,List all users retweeted by 'Me'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN DISTINCT retweetedUser","match
$me isa me;
$tweet isa tweet;
$retweetedTweet isa tweet;
$retweetedUser isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
posts (author: $retweetedUser, content: $retweetedTweet);
fetch { ""screen_name"": $retweetedUser.screen_name, ""name"": $retweetedUser.name };"
twitter,30,List the top 5 users by number of followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
$u isa user, has followers $f;
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,31,Which users have more than 10000 followers and less than 15000 statuses?,"MATCH (u:User)
WHERE u.followers > 10000 AND u.statuses < 15000
RETURN u.screen_name AS username, u.followers AS followerCount, u.statuses AS statusesCount","match
$u isa user, has followers $f, has statuses $s;
$f > 10000;
$s < 15000;
fetch { ""username"": $u.screen_name, ""followerCount"": $f, ""statusesCount"": $s };"
twitter,32,Find the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""favorites"": $f };"
twitter,33,Who are the top 5 most followed users that Neo4j follows?,"MATCH (me:Me)-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
$me isa me;
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 5;
fetch { ""user"": $followed.screen_name, ""follower_count"": $f };"
twitter,34,List 3 users who follow Neo4j and have a location specified as 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {name: 'Neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$me isa me, has name ""Neo4j"";
follows (follower: $u, followed: $me);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""location"": $u.location };"
twitter,35,What are the names of the top 5 users with the highest betweenness centrality?,"MATCH (u:User)
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""name"": $u.name };"
twitter,36,Identify 5 users who follow more than 5000 users but have fewer than 10000 followers.,"MATCH (u:User)
WHERE u.following > 5000 AND u.followers < 10000
RETURN u.screen_name, u.following, u.followers
LIMIT 5","match
$u isa user, has following $fg, has followers $fr;
$fg > 5000;
$fr < 10000;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""following"": $fg, ""followers"": $fr };"
twitter,37,Find 3 tweets that contain links and were created in 2021.,"MATCH (t:Tweet)-[:CONTAINS]->(:Link)
WHERE t.created_at >= date('2021-01-01') AND t.created_at < date('2022-01-01') 
RETURN t
LIMIT 3","match
$t isa tweet, has created_at $ca;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
limit 3;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
twitter,38,Which 5 users are most similar to Neo4j based on the SIMILAR_TO score?,"MATCH (me:Me {name: 'Neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user;
$s isa similar_to (source_user: $u, similar_user: $me), has score $sc;
sort $sc desc;
limit 5;
fetch { ""user"": $u.screen_name, ""similarity"": $sc };"
twitter,39,List the top 3 hashtags used in tweets posted by users from 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$t isa tweet;
$h isa hashtag;
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
twitter,40,What are the top 3 sources used in the tweets that mention Neo4j?,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})-[:POSTS]->(t)
MATCH (t)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
$s isa source;
mentions (source_tweet: $t, mentioned_user: $u);
using (tweet_content: $t, platform: $s);
reduce $count = count($t) groupby $s;
sort $count desc;
limit 3;
fetch { ""source"": $s.source_name, ""count"": $count };"
twitter,41,Who are the 5 users with the most interactions with other users?,"MATCH (u:User)-[i:INTERACTS_WITH]->(other:User)
RETURN u.name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
$u isa user;
$other isa user;
$i isa interacts_with (interactor: $u, target: $other);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""user"": $u.name, ""interactions"": $interactions };"
twitter,43,Which 3 users amplified Neo4j the most?,"MATCH (me:Me)<-[:AMPLIFIES]-(u:User)
RETURN u.screen_name AS user, count(*) AS amplifications
ORDER BY amplifications DESC
LIMIT 3","match
$me isa me;
$u isa user;
$a isa amplifies (amplifier: $u, amplified_user: $me);
reduce $amplifications = count($a) groupby $u;
sort $amplifications desc;
limit 3;
fetch { ""user"": $u.screen_name, ""amplifications"": $amplifications };"
twitter,45,Who are the top 3 users that Neo4j has retweeted mentions from?,"MATCH (me:Me {screen_name: 'neo4j'})-[:RT_MENTIONS]->(user:User)
WITH user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN user.screen_name AS user, mentions","match
$me isa me, has screen_name ""neo4j"";
$user isa user;
$r isa rt_mentions (mentioner: $me, mentioned_user: $user);
reduce $mentions = count($r) groupby $user;
sort $mentions desc;
limit 3;
fetch { ""user"": $user.screen_name, ""mentions"": $mentions };"
twitter,46,List 3 users who have posted tweets tagging the hashtag 'education'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN u.name, u.screen_name, t.text
LIMIT 3","match
$u isa user;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""text"": $t.text };"
twitter,47,Which 3 tweets posted by Neo4j have the most replies?,"MATCH (me:Me {name: 'Neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)<-[:REPLY_TO]-() }
RETURN tweet.text AS tweet_text, count{(tweet)<-[:REPLY_TO]-()} AS reply_count
ORDER BY reply_count DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$tweet isa tweet;
$reply isa tweet;
posts (author: $me, content: $tweet);
reply_to (original_tweet: $tweet, replying_tweet: $reply);
reduce $reply_count = count($reply) groupby $tweet;
sort $reply_count desc;
limit 3;
fetch { ""tweet_text"": $tweet.text, ""reply_count"": $reply_count };"
twitter,48,Identify the top 5 tweets that mention Neo4j and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(:Me)
WHERE (t)-[:CONTAINS]->(:Link)
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
$me isa me;
$l isa link;
mentions (source_tweet: $t, mentioned_user: $me);
contains (containing_tweet: $t, contained_link: $l);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text };"
twitter,49,What are the 3 most common hashtags in tweets that have been retweeted more than 100 times?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 100
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $hashtag_count = count groupby $hashtag;
sort $hashtag_count desc;
limit 3;
fetch {
  ""hashtag"": $hashtag.hashtag_name,
  ""count"": $hashtag_count
};"
twitter,50,List the tweets containing the link 'https://twitter.com/i/web/status/13718150212657479' and were created in March 2021.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link {url: 'https://twitter.com/i/web/status/13718150212657479'})
WHERE t.created_at >= date('2021-03-01') AND t.created_at < date('2021-04-01') 
RETURN t","match
$t isa tweet, has created_at $ca;
$l isa link, has link_url ""https://twitter.com/i/web/status/13718150212657479"";
contains (containing_tweet: $t, contained_link: $l);
$ca >= 2021-03-01T00:00:00;
$ca < 2021-04-01T00:00:00;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
twitter,51,Which 3 users have the most followers among those who have interacted with Neo4j?,"MATCH (u:User)-[:INTERACTS_WITH]->(:Me {name: 'Neo4j'})
RETURN u.screen_name AS user, u.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 3","match
$u isa user, has followers $f;
$me isa me, has name ""Neo4j"";
interacts_with (interactor: $u, target: $me);
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""followerCount"": $f };"
twitter,52,Identify the top 5 tweets with texts containing the word 'education'.,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'education'
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has text $txt, has favorites $f;
$txt like ""%education%"";
sort $f desc;
limit 5;
fetch { ""text"": $txt, ""favorites"": $f };"
twitter,53,Find the 3 most recent tweets by Neo4j.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 3","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
sort $ca desc;
limit 3;
fetch { ""text"": $t.text, ""created_at"": $ca };"
twitter,54,Which 3 users with the highest betweenness have tweeted about 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$u isa user, has betweenness $b;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
sort $b desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
twitter,55,List the top 3 sources used by tweets mentioning 'Neo4j' and containing a hashtag.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'}),
      (t)-[:TAGS]->(:Hashtag),
      (t)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$t isa tweet;
$u isa user, has name ""Neo4j"";
$h isa hashtag;
$s isa source;
mentions (source_tweet: $t, mentioned_user: $u);
tags (tagged_tweet: $t, tag: $h);
using (tweet_content: $t, platform: $s);
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 3;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
twitter,56,Who are the top 5 users followed by Neo4j that have tweeted more than 1000 times?,"MATCH (me:Me {name: 'Neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > 1000
RETURN u.name, u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user, has statuses $s;
follows (follower: $me, followed: $u);
$s > 1000;
sort $s desc;
limit 5;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""statuses"": $s };"
twitter,57,Find the top 3 users who amplified tweets by Neo4j and have a high betweenness score.,"MATCH (me:Me {name: 'Neo4j'})<-[:AMPLIFIES]-(u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name AS user, u.betweenness AS betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$u isa user, has betweenness $b;
amplifies (amplifier: $u, amplified_user: $me);
sort $b desc;
limit 3;
fetch { ""user"": $u.screen_name, ""betweenness"": $b };"
twitter,58,Which 3 tweets by Neo4j have the most favorites and were posted in 2020?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.created_at >= date('2020-01-01') AND tweet.created_at < date('2021-01-01') 
RETURN tweet.text AS tweet_text, tweet.favorites AS num_favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca, has favorites $f;
posts (author: $me, content: $tweet);
$ca >= 2020-01-01T00:00:00;
$ca < 2021-01-01T00:00:00;
sort $f desc;
limit 3;
fetch { ""tweet_text"": $tweet.text, ""num_favorites"": $f };"
twitter,59,List the 3 tweets by Neo4j that have been retweeted by users with more than 10000 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {
  (tweet)<-[:RETWEETS]-(:Tweet)<-[:POSTS]-(retweeter:User)
  WHERE retweeter.followers > 10000
}
RETURN tweet.text
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
$f > 10000;
limit 3;
fetch { ""text"": $tweet.text };"
twitter,60,What are the names of the top 5 users with the highest betweenness?,"MATCH (u:User)
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""name"": $u.name };"
twitter,61,List the screen names of the first 3 users who have the most followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 3","match
$u isa user, has followers $f;
sort $f desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,62,Who are the top 5 users based on the number of statuses they have posted?,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses AS status_count
ORDER BY u.statuses DESC
LIMIT 5","match
$u isa user, has statuses $s;
sort $s desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""status_count"": $s };"
twitter,63,Identify the top 3 users by the number of people they are following.,"MATCH (u:User)
RETURN u.screen_name AS user, u.following AS following
ORDER BY u.following DESC
LIMIT 3","match
$u isa user, has following $f;
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""following"": $f };"
twitter,64,Who are the three users with the most mentions in tweets?,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)
RETURN u.name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
$u isa user;
$t isa tweet;
$m isa mentions (source_tweet: $t, mentioned_user: $u);
reduce $mentions = count($m) groupby $u;
sort $mentions desc;
limit 3;
fetch { ""user"": $u.name, ""mentions"": $mentions };"
twitter,65,List the first 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 5;
fetch { ""text"": $t.text, ""favorites"": $f };"
twitter,66,What are the top 3 sources used most frequently in tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$t isa tweet;
$s isa source;
using (tweet_content: $t, platform: $s);
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 3;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
twitter,67,Which 5 users have posted the most tweets?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 5
RETURN u.screen_name AS user, num_tweets","match
$u isa user;
$t isa tweet;
posts (author: $u, content: $t);
reduce $num_tweets = count($t) groupby $u;
sort $num_tweets desc;
limit 5;
fetch { ""user"": $u.screen_name, ""num_tweets"": $num_tweets };"
twitter,68,Identify the top 3 hashtags used in tweets.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
twitter,69,What are the top 5 most recent tweets based on the creation date?,"MATCH (t:Tweet)
RETURN t
ORDER BY t.created_at DESC
LIMIT 5","match
$t isa tweet, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $ca };"
twitter,70,List the URLs of the top 3 tweets containing links.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS url
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
sort $f desc;
limit 3;
fetch { ""url"": $l.link_url };"
twitter,71,Who are the top 3 users most similar to 'Neo4j' based on the SIMILAR_TO score?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 3;
fetch { ""similar_user"": $u.screen_name, ""similarity"": $sc };"
twitter,72,What are the first 3 locations where the most users are based?,"MATCH (u:User)
WHERE u.location IS NOT NULL
RETURN u.location, count(u) AS num_users
ORDER BY num_users DESC
LIMIT 3","match
$u isa user, has location $loc;
reduce $num_users = count($u) groupby $loc;
sort $num_users desc;
limit 3;
fetch { ""location"": $loc, ""num_users"": $num_users };"
twitter,73,List the top 5 tweets that have been retweeted the most times.,"MATCH (t:Tweet)-[:RETWEETS]->(retweet:Tweet)
RETURN t.text AS tweet_text, count(retweet) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 5","match
$t isa tweet, has text $txt;
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $count = count($rt) groupby $txt;
sort $count desc;
limit 5;
fetch { ""tweet_text"": $txt, ""retweet_count"": $count };"
twitter,74,Which 5 tweets have the most replies?,"MATCH (t:Tweet)
WHERE exists{ (t)<-[:REPLY_TO]-() }
RETURN t, count{(t)<-[:REPLY_TO]-()} AS replies
ORDER BY replies DESC
LIMIT 5","match
$t isa tweet;
$reply isa tweet;
reply_to (original_tweet: $t, replying_tweet: $reply);
reduce $replies = count($reply) groupby $t;
sort $replies desc;
limit 5;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""replies"": $replies };"
twitter,76,Who are the top 5 users mentioned in the most tweets?,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)
RETURN u.name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$u isa user;
$t isa tweet;
mentions (source_tweet: $t, mentioned_user: $u);
reduce $mentions = count($t) groupby $u;
sort $mentions desc;
limit 5;
fetch { ""user"": $u.name, ""mentions"": $mentions };"
twitter,78,What are the names of the top 5 users interacting most frequently with others?,"MATCH (u:User)-[i:INTERACTS_WITH]->(other)
RETURN u.name AS name, count(i) AS interactions 
ORDER BY interactions DESC
LIMIT 5","match
$u isa user;
$other isa user;
$i isa interacts_with (interactor: $u, target: $other);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""name"": $u.name, ""interactions"": $interactions };"
twitter,79,Identify the top 3 tweets with links pointing to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text AS tweet_text, l.url AS link_url
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link, has link_url $url;
contains (containing_tweet: $t, contained_link: $l);
$url like ""https://twitter.com%"";
sort $f desc;
limit 3;
fetch { ""tweet_text"": $t.text, ""link_url"": $url };"
twitter,80,Which 5 tweets contain the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text AS tweet_text
LIMIT 5","match
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
limit 5;
fetch { ""tweet_text"": $t.text };"
twitter,81,"List the top 5 tweets by the total interaction (mentions, retweets, replies).","MATCH (t:Tweet)
OPTIONAL MATCH (t)<-[:MENTIONS]-(mention)
OPTIONAL MATCH (t)<-[:RETWEETS]-(retweet) 
OPTIONAL MATCH (t)<-[:REPLY_TO]-(reply)
RETURN t.text AS tweet, 
       count(mention) AS mentions,
       count(retweet) AS retweets, 
       count(reply) AS replies,
       (count(mention) + count(retweet) + count(reply)) AS totalInteractions
ORDER BY totalInteractions DESC
LIMIT 5","match
$tweet isa tweet;
$rel isa $t;
{
  $t label mentions;
  $rel links (source_tweet: $tweet);
} or {
  $t label retweets;
  $rel links (original_tweet: $tweet);
} or {
  $t label reply_to;
  $rel links (original_tweet: $tweet);
};
reduce $count = count groupby $tweet;
sort $count desc;
limit 5;
fetch {
  ""tweet"": $tweet.text,
  ""count"": $count
};"
twitter,82,Who are the first 3 users followed by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$followed isa user;
follows (follower: $me, followed: $followed);
limit 3;
fetch { ""screen_name"": $followed.screen_name };"
twitter,83,What are the top 3 most common tweet sources for the user 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$s isa source;
posts (author: $u, content: $t);
using (tweet_content: $t, platform: $s);
reduce $count = count($t) groupby $s;
sort $count desc;
limit 3;
fetch { ""source"": $s.source_name, ""count"": $count };"
twitter,84,Identify the top 5 users with the most similar profiles to 'Neo4j' based on betweenness and following.,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score IS NOT NULL
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 5;
fetch { ""user"": $u.screen_name, ""similarity"": $sc };"
twitter,85,Which 3 tweets have the highest aggregation of favorites and retweets?,"MATCH (t:Tweet)
OPTIONAL MATCH (t)-[:RETWEETS]->(r:Tweet)
RETURN t, t.favorites + count(r) AS score
ORDER BY score DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet);
reduce $retweets = count groupby $tweet;
match
$tweet has favorites $favorites;
let $total = $favorites + $retweets;
sort $total desc;
limit 3;
fetch {
  ""tweet"": $tweet.text,
  ""total"": $total
};"
twitter,86,List the top 5 users who mostly tweet about 'education'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5
RETURN u.screen_name AS user, tweet_count","match
$u isa user;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
reduce $tweet_count = count($t) groupby $u;
sort $tweet_count desc;
limit 5;
fetch { ""user"": $u.screen_name, ""tweet_count"": $tweet_count };"
twitter,87,What are the top 3 most used hashtags in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $count = count($tweet) groupby $hashtag;
sort $count desc;
limit 3;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
twitter,88,Identify the top 5 tweets mentioning 'Neo4j' with the greatest number of favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has text $txt, has favorites $f;
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
$txt like ""%Neo4j%"";
sort $f desc;
limit 5;
fetch { ""tweet_text"": $txt, ""num_favorites"": $f };"
twitter,89,Who are the first 5 users retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweetedTweet isa tweet;
$retweetedUser isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
posts (author: $retweetedUser, content: $retweetedTweet);
limit 5;
fetch { ""screen_name"": $retweetedUser.screen_name };"
twitter,90,Which users have a betweenness higher than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u","match
$u isa user, has betweenness $b;
$b > 300000000;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""betweenness"": $b };"
twitter,91,List all users who follow 'neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name };"
twitter,92,Which tweets mention the user with the screen name 'neo4j'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
RETURN t","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,93,Find the top 5 most recent tweets by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 5","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""created_at"": $ca };"
twitter,94,What are the top 3 hashtags used by 'neo4j' in their tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $count = count($tweet) groupby $hashtag;
sort $count desc;
limit 3;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
twitter,95,Who are the top 5 followers of 'neo4j' by number of followers?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
RETURN follower.screen_name AS follower, follower.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$follower isa user, has followers $f;
follows (follower: $follower, followed: $me);
sort $f desc;
limit 5;
fetch { ""follower"": $follower.screen_name, ""followerCount"": $f };"
twitter,96,List all the sources used by 'neo4j' for tweeting.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN DISTINCT source.name","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$source isa source;
posts (author: $me, content: $tweet);
using (tweet_content: $tweet, platform: $source);
fetch { ""name"": $source.source_name };"
twitter,97,Which users are followed by 'neo4j' and have more than 10000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.followers > 10000
RETURN u.screen_name, u.followers","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
$f > 10000;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,98,Find tweets that contain links and were posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""link_url"": $l.link_url };"
twitter,99,Who does 'neo4j' interact with most frequently?,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 1","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$i isa interacts_with (interactor: $me, target: $u);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 1;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""interactions"": $interactions };"
twitter,100,List the top 3 users similar to 'neo4j' by similarity score.,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 3;
fetch { ""similar_user"": $u.screen_name, ""similarity"": $sc };"
twitter,102,List the top 5 tweets by 'neo4j' with the most favorites.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
twitter,103,Who are the top 3 users amplified by 'Me'?,"MATCH (me:Me)-[:AMPLIFIES]->(u:User)
RETURN u.name, u.screen_name
ORDER BY u.followers DESC
LIMIT 3","match
$me isa me;
$u isa user, has followers $f;
amplifies (amplifier: $me, amplified_user: $u);
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name };"
twitter,104,List all tweets that 'neo4j' has replied to.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet, repliedTo","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$repliedTo isa tweet;
posts (author: $me, content: $tweet);
reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
fetch { ""reply_text"": $tweet.text, ""original_text"": $repliedTo.text };"
twitter,105,Which users follow 'neo4j' and are located in 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
$u isa user, has location ""Graphs Are Everywhere"";
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""location"": $u.location };"
twitter,107,Which users mentioned by 'neo4j' in tweets have the highest betweenness?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.screen_name AS user, mentioned.betweenness AS betweenness
ORDER BY mentioned.betweenness DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$mentioned isa user, has betweenness $b;
posts (author: $me, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
sort $b desc;
limit 10;
fetch { ""user"": $mentioned.screen_name, ""betweenness"": $b };"
twitter,108,Which users following 'neo4j' have tweeted about 'education'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}),
      (u)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN u.screen_name AS user, t.text AS tweet","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
follows (follower: $u, followed: $me);
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
fetch { ""user"": $u.screen_name, ""tweet"": $t.text };"
twitter,109,"Who are the top 3 users that 'neo4j' interacts with, sorted by interaction frequency?","MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$i isa interacts_with (interactor: $me, target: $u);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
twitter,110,Which tweets by 'neo4j' contain the hashtag 'education'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet.text","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag, has hashtag_name ""education"";
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
fetch { ""text"": $tweet.text };"
twitter,111,List all the links contained in tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""url"": $l.link_url };"
twitter,112,What are the profile image URLs of users who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u.profile_image_url","match
$u isa user;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""profile_image_url"": $u.profile_image_url };"
twitter,113,Which users followed by 'neo4j' have the highest betweenness values?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(follower:User)
RETURN follower.screen_name, follower.betweenness
ORDER BY follower.betweenness DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$follower isa user, has betweenness $b;
follows (follower: $me, followed: $follower);
sort $b desc;
limit 10;
fetch { ""screen_name"": $follower.screen_name, ""betweenness"": $b };"
twitter,115,How many users does 'neo4j' amplify?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN count(user) AS amplified_users","match
$me isa me, has screen_name ""neo4j"";
$user isa user;
amplifies (amplifier: $me, amplified_user: $user);
reduce $amplified_users = count($user);
fetch { ""amplified_users"": $amplified_users };"
twitter,116,Which tweets made by 'neo4j' were retweeted by users with more than 10000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
WHERE retweeter.followers > 10000
RETURN tweet.text, retweet.text, retweeter.screen_name, retweeter.followers","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
$f > 10000;
fetch { ""tweet_text"": $tweet.text, ""retweet_text"": $retweet.text, ""retweeter_screen_name"": $retweeter.screen_name, ""followers"": $f };"
twitter,117,List the top 5 users who have mentioned 'neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$u isa user;
$t isa tweet;
$me isa me, has screen_name ""neo4j"";
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
reduce $mentions = count($t) groupby $u;
sort $mentions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""mentions"": $mentions };"
twitter,119,Find the top 5 tweets mentioning 'neo4j' with the most favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.text CONTAINS 'neo4j'
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has text $txt, has favorites $f;
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
$txt like ""%neo4j%"";
sort $f desc;
limit 5;
fetch { ""tweet_text"": $txt, ""num_favorites"": $f };"
twitter,120,Which tweets by 'neo4j' use the source named 'Buffer'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$source isa source, has source_name ""Buffer"";
posts (author: $me, content: $tweet);
using (tweet_content: $tweet, platform: $source);
fetch { ""text"": $tweet.text, ""tweet_id"": $tweet.tweet_id, ""created_at"": $tweet.created_at };"
twitter,121,List all the hashtags used in tweets that mention 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:TAGS]->(h:Hashtag)
RETURN DISTINCT h.name","match
$t isa tweet;
$u isa user, has screen_name ""neo4j"";
$h isa hashtag;
mentions (source_tweet: $t, mentioned_user: $u);
tags (tagged_tweet: $t, tag: $h);
fetch { ""name"": $h.hashtag_name };"
twitter,122,Which users followed by 'neo4j' also follow 'Me'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(u:User)-[:FOLLOWS]->(neo4j:User {screen_name: 'neo4j'})
RETURN u.screen_name AS user","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $me);
follows (follower: $me, followed: $u);
fetch { ""user"": $u.screen_name };"
twitter,123,Find the tweets where 'neo4j' has been mentioned by users with more than 10000 followers.,"MATCH (u:User {screen_name: 'neo4j'})<-[:MENTIONS]-(t:Tweet)<-[:POSTS]-(mentioner:User)
WHERE mentioner.followers > 10000
RETURN t, mentioner","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$mentioner isa user, has followers $f;
mentions (source_tweet: $t, mentioned_user: $u);
posts (author: $mentioner, content: $t);
$f > 10000;
fetch { ""text"": $t.text, ""mentioner_screen_name"": $mentioner.screen_name, ""mentioner_followers"": $f };"
twitter,124,List the URLs of tweets posted by 'neo4j' that contain links.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$l isa link;
posts (author: $u, content: $t);
contains (containing_tweet: $t, contained_link: $l);
fetch { ""url"": $l.link_url };"
twitter,125,What are the names of the top 3 users with the most followers who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u.name AS name, u.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
$u isa user, has followers $f;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""followers"": $f };"
twitter,126,Find the top 5 users who have retweeted tweets made by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
RETURN retweeter.screen_name AS retweeter, count(*) AS retweets
ORDER BY retweets DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
reduce $retweets = count($retweet) groupby $retweeter;
sort $retweets desc;
limit 5;
fetch { ""retweeter"": $retweeter.screen_name, ""retweets"": $retweets };"
twitter,127,List all the tweets by 'neo4j' that reply to another tweet.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet.text AS tweet, repliedTo.id_str AS in_reply_to_tweet_id","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$repliedTo isa tweet;
posts (author: $me, content: $tweet);
reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
fetch { ""tweet"": $tweet.text, ""in_reply_to_tweet_id"": $repliedTo.id_str };"
twitter,128,Who are the users that 'neo4j' mentions most frequently in their tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned, count(*) AS num_mentions
ORDER BY num_mentions DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$mentioned isa user;
posts (author: $me, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
reduce $num_mentions = count($tweet) groupby $mentioned;
sort $num_mentions desc;
limit 10;
fetch { ""screen_name"": $mentioned.screen_name, ""name"": $mentioned.name, ""num_mentions"": $num_mentions };"
twitter,130,List the top 3 most followed users who mention 'neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WITH u, count(t) AS mentions
ORDER BY u.followers DESC
LIMIT 3
RETURN u.screen_name AS user, u.followers AS followers, mentions","match
$u isa user, has followers $f;
$t isa tweet;
$neo isa user, has screen_name ""neo4j"";
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $neo);
reduce $mentions = count($t) groupby $u, $f;
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""followers"": $f, ""mentions"": $mentions };"
twitter,131,Which users followed by 'neo4j' have tweeted the most?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS num_tweets
ORDER BY num_tweets DESC
RETURN u.screen_name AS user, num_tweets
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$t isa tweet;
follows (follower: $me, followed: $u);
posts (author: $u, content: $t);
reduce $num_tweets = count($t) groupby $u;
sort $num_tweets desc;
limit 10;
fetch { ""user"": $u.screen_name, ""num_tweets"": $num_tweets };"
twitter,132,Find the top 5 tweets by 'neo4j' tagged with a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN tweet.text AS tweet, hashtag.name AS hashtag
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
sort $f desc;
limit 5;
fetch { ""tweet"": $tweet.text, ""hashtag"": $hashtag.hashtag_name };"
twitter,133,Who are the top 3 users that 'neo4j' has the highest similarity scores with?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(other:User)
RETURN other.screen_name AS similar_user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$other isa user;
$s isa similar_to (source_user: $me, similar_user: $other), has score $sc;
sort $sc desc;
limit 3;
fetch { ""similar_user"": $other.screen_name, ""similarity"": $sc };"
twitter,134,What are the most common locations of users who follow 'neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL
RETURN u.location, count(*) AS num_users
ORDER BY num_users DESC
LIMIT 10","match
$u isa user, has location $loc;
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
reduce $num_users = count($u) groupby $loc;
sort $num_users desc;
limit 10;
fetch { ""location"": $loc, ""num_users"": $num_users };"
twitter,135,Which tweets by 'neo4j' have the highest number of favorites?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
twitter,137,Who are the top 5 users that follow both 'neo4j' and 'Me'?,"MATCH (u:User)-[:FOLLOWS]->(:User {screen_name: 'neo4j'}), 
      (u)-[:FOLLOWS]->(:Me)
RETURN u.screen_name AS user, u.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
$u isa user, has screen_name $sn, has followers $fc;
$neo4j isa user, has screen_name ""neo4j"";
$me isa me;
follows (follower: $u, followed: $neo4j);
follows (follower: $u, followed: $me);
sort $fc desc;
limit 5;
fetch { ""user"": $sn, ""followerCount"": $fc };"
twitter,139,List the top 5 users with the highest number of followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
$u isa user, has followers $f;
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,140,Which three users have tweeted the most as of the latest date in the dataset?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE t.created_at IS NOT NULL
WITH u, count(t) AS num_tweets, max(t.created_at) AS latest_tweet
RETURN u.screen_name AS user, num_tweets, latest_tweet
ORDER BY num_tweets DESC
LIMIT 3","match
$u isa user;
$t isa tweet;
posts (author: $u, content: $t);
reduce $num_tweets = count($t) groupby $u;
sort $num_tweets desc;
limit 3;
fetch { ""user"": $u.screen_name, ""num_tweets"": $num_tweets };"
twitter,141,Identify the top 5 tweets with the highest favorite counts.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 5;
fetch { ""text"": $t.text, ""favorites"": $f };"
twitter,142,What are the names of the top 3 users who have a betweenness greater than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u.name
ORDER BY u.betweenness DESC
LIMIT 3","match
$u isa user, has betweenness $b;
$b > 300000000;
sort $b desc;
limit 3;
fetch { ""name"": $u.name };"
twitter,143,Which three tweets have the most mentions of other users?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WITH t, count(u) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN t.text AS tweet_text, mentions","match
$t isa tweet;
$u isa user;
mentions (source_tweet: $t, mentioned_user: $u);
reduce $mentions = count($u) groupby $t;
sort $mentions desc;
limit 3;
fetch { ""tweet_text"": $t.text, ""mentions"": $mentions };"
twitter,144,List the top 5 most recent tweets based on the 'created_at' date.,"MATCH (t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 5","match
$t isa tweet, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""text"": $t.text, ""created_at"": $ca };"
twitter,145,What are the three most commonly used hashtags in tweets?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
twitter,146,Identify the top 5 users based on the number of posts they have made.,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS num_posts
ORDER BY num_posts DESC
LIMIT 5
RETURN u.screen_name AS user, num_posts","match
$u isa user;
$t isa tweet;
posts (author: $u, content: $t);
reduce $num_posts = count($t) groupby $u;
sort $num_posts desc;
limit 5;
fetch { ""user"": $u.screen_name, ""num_posts"": $num_posts };"
twitter,147,Which three users are most similar to 'Neo4j' based on the 'SIMILAR_TO' score?,"MATCH (me:Me {screen_name: 'neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $u, similar_user: $me), has score $sc;
sort $sc desc;
limit 3;
fetch { ""user"": $u.screen_name, ""similarity"": $sc };"
twitter,148,List the URLs of the top 5 most linked-to external sites in tweets.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS url, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$t isa tweet;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
reduce $count = count($t) groupby $l;
sort $count desc;
limit 5;
fetch { ""url"": $l.link_url, ""count"": $count };"
twitter,149,What are the names of the top 3 sources most used in tweeting?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$t isa tweet;
$s isa source;
using (tweet_content: $t, platform: $s);
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 3;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
twitter,150,Which three users have the highest 'betweenness' metric in the network?,"MATCH (u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$u isa user, has betweenness $b;
sort $b desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
twitter,151,Find the top 5 hashtags mentioned by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $mentions = count($tweet) groupby $hashtag;
sort $mentions desc;
limit 5;
fetch { ""hashtag"": $hashtag.hashtag_name, ""mentions"": $mentions };"
twitter,152,Who are the top 3 users that 'Neo4j' follows?,"MATCH (me:Me {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.name AS user, followed.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 3;
fetch { ""user"": $followed.name, ""followers"": $f };"
twitter,153,List the screen names of the top 5 users followed by the most number of other users.,"MATCH (u:User)<-[:FOLLOWS]-(follower:User)
WITH u, count(follower) AS follower_count
ORDER BY follower_count DESC
LIMIT 5
RETURN u.screen_name AS screen_name, follower_count","match
$u isa user;
$follower isa user;
follows (follower: $follower, followed: $u);
reduce $follower_count = count($follower) groupby $u;
sort $follower_count desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""follower_count"": $follower_count };"
twitter,154,Which three tweets have the highest retweet counts?,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has text $txt;
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $count = count($rt) groupby $txt;
sort $count desc;
limit 3;
fetch { ""text"": $txt, ""retweet_count"": $count };"
twitter,155,Identify the top 5 users who are followed by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 5;
fetch { ""user"": $followed.screen_name, ""followerCount"": $f };"
twitter,156,What are the top 3 locations where the most active users are based?,"MATCH (u:User)
WHERE u.location IS NOT NULL
WITH u.location AS location, count(u) AS num_users, sum(u.statuses) AS total_statuses
RETURN location, num_users, total_statuses
ORDER BY total_statuses DESC
LIMIT 3","match
$u isa user, has location $loc, has statuses $s;
reduce $total_statuses = sum($s), $num_users = count($u) groupby $loc;
sort $total_statuses desc;
limit 3;
fetch { ""location"": $loc, ""num_users"": $num_users, ""total_statuses"": $total_statuses };"
twitter,157,Which three tweets contain the word 'graph' in their text?,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'graph'
RETURN t
LIMIT 3","match
$t isa tweet, has text $txt;
$txt like ""%graph%"";
limit 3;
fetch { ""text"": $txt, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,158,List the top 5 tweets which mention the user with the highest followers.,"MATCH (u:User)-[:MENTIONS]-(t:Tweet)
WHERE u.followers IS NOT NULL
WITH u, t
ORDER BY u.followers DESC
LIMIT 1
MATCH (t:Tweet)-[:MENTIONS]->(u) 
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 5","match
$u isa user, has followers $f;
$t isa tweet, has favorites $fav;
mentions (source_tweet: $t, mentioned_user: $u);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text };"
twitter,159,Who are the top 3 users that have interacted the most with 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[i:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$i isa interacts_with (interactor: $u, target: $me);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
twitter,160,What are the names of the top 3 hashtags used in tweets about technology?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'technology'
RETURN h.name as hashtag, count(*) as count
ORDER BY count DESC
LIMIT 3","match
$t isa tweet, has text $txt;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%technology%"";
reduce $count = count($t) groupby $h;
sort $count desc;
limit 3;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
twitter,161,Which three users have posted the most about 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN u.name, u.screen_name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
$u isa user;
$t isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $u, content: $t);
tags (tagged_tweet: $t, tag: $h);
reduce $tweet_count = count($t) groupby $u;
sort $tweet_count desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""tweet_count"": $tweet_count };"
twitter,162,Who are the top 3 users that 'Neo4j' has retweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)<-[:POSTS]-(retweeted_user:User)
RETURN retweeted_user.screen_name AS retweeted_user, count(*) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweeted_tweet isa tweet;
$retweeted_user isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
posts (author: $retweeted_user, content: $retweeted_tweet);
reduce $retweet_count = count($tweet) groupby $retweeted_user;
sort $retweet_count desc;
limit 3;
fetch { ""retweeted_user"": $retweeted_user.screen_name, ""retweet_count"": $retweet_count };"
twitter,164,What are the top 3 external sources linked in tweets about software?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'software'})
MATCH (t)-[:CONTAINS]->(l:Link)
WITH l.url AS url, count(*) AS count
ORDER BY count DESC
LIMIT 3
RETURN url, count","match
$t isa tweet;
$h isa hashtag, has hashtag_name ""software"";
$l isa link;
tags (tagged_tweet: $t, tag: $h);
contains (containing_tweet: $t, contained_link: $l);
reduce $count = count($t) groupby $l;
sort $count desc;
limit 3;
fetch { ""url"": $l.link_url, ""count"": $count };"
twitter,165,Which three tweets have the highest replies?,"MATCH (t:Tweet)-[:REPLY_TO]->(reply:Tweet)
RETURN t, count(reply) AS replies
ORDER BY replies DESC
LIMIT 3","match
$t isa tweet;
$reply isa tweet;
reply_to (original_tweet: $t, replying_tweet: $reply);
reduce $replies = count($reply) groupby $t;
sort $replies desc;
limit 3;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""replies"": $replies };"
twitter,166,List the top 5 tweets by 'Neo4j' based on favorite counts.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
twitter,167,What are the top 5 users with the highest betweenness scores?,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
twitter,168,List the first 3 users who have more than 10000 followers.,"MATCH (u:User)
WHERE u.followers > 10000
RETURN u.name, u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 3","match
$u isa user, has followers $f;
$f > 10000;
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,169,Which users follow 'Neo4j' and have a location specified as 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
$u isa user, has location ""Graphs Are Everywhere"";
$me isa me, has screen_name ""neo4j"";
follows (follower: $u, followed: $me);
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""location"": $u.location };"
twitter,170,Find the first 3 tweets that have been retweeted more than 100 times.,"MATCH (t:Tweet)
WHERE t.favorites > 100
RETURN t
ORDER BY t.favorites DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
sort $count desc;
limit 3;
fetch {
  ""tweet"": $tweet.text,
  ""retweets"": $count
};"
twitter,171,Identify the top 5 tweets tagged with the hashtag 'education'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$t isa tweet, has favorites $f;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text, ""favorites"": $f };"
twitter,172,Who are the top 5 most followed users that 'Neo4j' follows?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 5;
fetch { ""user"": $followed.screen_name, ""follower_count"": $f };"
twitter,173,List the first 3 tweets posted using the source named 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t.text AS tweet_text
ORDER BY t.created_at
LIMIT 3","match
$t isa tweet, has created_at $ca;
$s isa source, has source_name ""Buffer"";
using (tweet_content: $t, platform: $s);
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $t.text };"
twitter,175,Identify the first 3 users who mentioned 'Neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
RETURN u.name, u.screen_name, t.text
LIMIT 3","match
$u isa user;
$t isa tweet;
$me isa me, has name ""Neo4j"";
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""text"": $t.text };"
twitter,176,What are the first 3 tweets that contain a link starting with 'https://twitter.com'?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text, l.url
LIMIT 3","match
$t isa tweet;
$l isa link, has link_url $url;
contains (containing_tweet: $t, contained_link: $l);
$url like ""https://twitter.com%"";
limit 3;
fetch { ""text"": $t.text, ""url"": $url };"
twitter,177,List the top 5 users by the number of statuses they have posted.,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses AS status_count
ORDER BY u.statuses DESC
LIMIT 5","match
$u isa user, has statuses $s;
sort $s desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""status_count"": $s };"
twitter,178,Who are the top 3 users followed by 'Me' with the highest betweenness scores?,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
$me isa me;
$u isa user, has betweenness $b;
follows (follower: $me, followed: $u);
sort $b desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
twitter,179,List the first 3 tweets that 'Neo4j' has retweeted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)
RETURN retweeted.text
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweeted isa tweet;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
limit 3;
fetch { ""text"": $retweeted.text };"
twitter,180,Which tweets mention 'Neo4j' and contain a hashtag? Show the first 3.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag)
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text
LIMIT 3","match
$t isa tweet, has text $txt;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
limit 3;
fetch { ""tweet_text"": $txt };"
twitter,182,List the first 3 users who interact most frequently with 'Neo4j' based on the INTERACTS_WITH relationship.,"MATCH (u:User)-[i:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
interacts_with (interactor: $u, target: $me);
reduce $interactions = count($u) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
twitter,183,Which users have amplified 'Neo4j' and also follow more than 1000 users? List the first 3.,"MATCH (me:Me {name: 'Neo4j'})<-[:AMPLIFIES]-(u:User)
WHERE u.following > 1000
RETURN u.name, u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
$me isa me, has name ""Neo4j"";
$u isa user, has following $f;
amplifies (amplifier: $u, amplified_user: $me);
$f > 1000;
sort $f desc;
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""following"": $f };"
twitter,184,Identify the top 5 users who have a profile image URL ending with 'normal.jpg' and follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {name: 'Neo4j'})
WHERE u.profile_image_url ENDS WITH 'normal.jpg'
RETURN u.screen_name, u.profile_image_url
ORDER BY u.followers DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user, has profile_image_url $purl, has followers $f;
follows (follower: $u, followed: $me);
$purl like ""%normal.jpg"";
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""profile_image_url"": $purl };"
twitter,185,List the first 3 tweets that reply to another tweet and were created before March 2021.,"MATCH (t:Tweet)-[:REPLY_TO]->(replied_to:Tweet)
WHERE t.created_at < date(""2021-03-01"")
RETURN t, replied_to
LIMIT 3","match
$t isa tweet, has created_at $ca;
$replied_to isa tweet;
reply_to (replying_tweet: $t, original_tweet: $replied_to);
$ca < 2021-03-01T00:00:00;
limit 3;
fetch { ""tweet_text"": $t.text, ""tweet_created"": $ca, ""replied_to_text"": $replied_to.text };"
twitter,186,What are the top 5 hashtags used in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $count = count($tweet) groupby $hashtag;
sort $count desc;
limit 5;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
twitter,187,Identify the first 3 links contained in tweets that have been favorited more than 200 times.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE t.favorites > 200
RETURN l.url
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
$f > 200;
limit 3;
fetch { ""url"": $l.link_url };"
twitter,188,Who are the top 3 users that 'Neo4j' follows and who also follow 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:FOLLOWS]->(me)
RETURN u.screen_name AS user, u.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
follows (follower: $u, followed: $me);
sort $f desc;
limit 3;
fetch { ""user"": $u.screen_name, ""followers"": $f };"
twitter,189,List the first 3 tweets created by users located in 'Graphs Are Everywhere' and posted after December 2020.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
WHERE t.created_at > date('2020-12-31')
RETURN t.text, t.created_at
ORDER BY t.created_at
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$t isa tweet, has created_at $ca;
posts (author: $u, content: $t);
$ca > 2020-12-31T00:00:00;
sort $ca asc;
limit 3;
fetch { ""text"": $t.text, ""created_at"": $ca };"
twitter,190,"Which users follow 'Neo4j' and have a betweenness score higher than 300,000,000? Show the top 5.","MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.betweenness > 300000000
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has betweenness $b;
follows (follower: $u, followed: $me);
$b > 300000000;
sort $b desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
twitter,191,Identify the first 3 users who have retweeted tweets mentioning 'Neo4j'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
RETURN DISTINCT u.name, u.screen_name
LIMIT 3","match
$u isa user;
$t isa tweet;
$rt isa tweet;
$mentioned isa user, has name ""Neo4j"";
posts (author: $u, content: $t);
retweets (retweeting_tweet: $t, original_tweet: $rt);
mentions (source_tweet: $rt, mentioned_user: $mentioned);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name };"
twitter,192,What are the top 5 tweets by favorites that were posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me;
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
twitter,193,List the first 3 users who have been retweeted by 'Neo4j' and have more than 500 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
WHERE retweetedUser.followers > 500
RETURN retweetedUser.screen_name, retweetedUser.followers
ORDER BY retweetedUser.followers DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweetedTweet isa tweet;
$retweetedUser isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
posts (author: $retweetedUser, content: $retweetedTweet);
$f > 500;
sort $f desc;
limit 3;
fetch { ""screen_name"": $retweetedUser.screen_name, ""followers"": $f };"
twitter,194,Which tweets posted by 'Neo4j' include links and were created in January 2021? Show the first 3.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
WHERE tweet.created_at >= date('2021-01-01') AND tweet.created_at < date('2021-02-01') 
RETURN tweet.text, tweet.created_at, link.url
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$link isa link;
posts (author: $me, content: $tweet);
contains (containing_tweet: $tweet, contained_link: $link);
$ca >= 2021-01-01T00:00:00;
$ca < 2021-02-01T00:00:00;
limit 3;
fetch { ""text"": $tweet.text, ""created_at"": $ca, ""url"": $link.link_url };"
twitter,195,What are the top 5 tweets that 'Neo4j' has amplified?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:POSTS]-(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$t isa tweet, has favorites $f;
amplifies (amplifier: $me, amplified_user: $u);
posts (author: $u, content: $t);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $t.text, ""favorites"": $f };"
twitter,196,Identify the first 3 users who mention 'Neo4j' and have a location of 'Graphs Are Everywhere'.,"MATCH (u:User)
WHERE u.location = 'Graphs Are Everywhere'
  AND EXISTS {
    (u)-[:POSTS]->(:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
  }
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$tweet isa tweet;
$me isa me, has name ""Neo4j"";
posts (author: $u, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $me);
limit 3;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""location"": $u.location };"
twitter,197,List the top 5 most recent tweets that 'Neo4j' has posted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.created_at
ORDER BY tweet.created_at DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
posts (author: $me, content: $tweet);
sort $ca desc;
limit 5;
fetch { ""text"": $tweet.text, ""created_at"": $ca };"
twitter,198,What are the first 3 tweets that 'Neo4j' has mentioned other users in and were created in 2021?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE tweet.created_at >= date('2021-01-01') AND tweet.created_at < date('2022-01-01') 
RETURN tweet.text AS tweet_text, tweet.created_at AS created_at, collect(mentioned.screen_name) AS mentioned_users
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$mentioned isa user;
posts (author: $me, content: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $tweet.text, ""created_at"": $ca, ""mentioned_user"": $mentioned.screen_name };"
twitter,199,Identify the top 5 users who have a following between 5000 and 15000 and follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.following >= 5000 AND u.following <= 15000
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has following $f;
follows (follower: $u, followed: $me);
$f >= 5000;
$f <= 15000;
sort $f desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""following"": $f };"
twitter,201,List the top 5 tweets that have replied to 'Neo4j' and contain a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:REPLY_TO]-(tweet:Tweet)-[:TAGS]->(:Hashtag)
RETURN tweet.text AS tweet_text, tweet.favorites AS favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$myTweet isa tweet;
$tweet isa tweet, has favorites $f;
$h isa hashtag;
posts (author: $me, content: $myTweet);
reply_to (original_tweet: $myTweet, replying_tweet: $tweet);
tags (tagged_tweet: $tweet, tag: $h);
sort $f desc;
limit 5;
fetch { ""tweet_text"": $tweet.text, ""favorites"": $f };"
twitter,202,What are the first 3 tweets by 'Neo4j' that have been retweeted by other users with more than 10000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.text IS NOT NULL
WITH me, tweet
MATCH (tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
WHERE retweeter.followers > 10000
RETURN tweet.text AS tweet_text, count{(tweet)<-[:RETWEETS]-(:Tweet)} AS retweet_count
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$retweet isa tweet;
$retweeter isa user, has followers $f;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
posts (author: $retweeter, content: $retweet);
$f > 10000;
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $tweet.text };"
twitter,203,Identify the top 5 hashtags used in tweets that 'Neo4j' has retweeted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweeted_tweet)-[:TAGS]->(hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweeted_tweet isa tweet;
$hashtag isa hashtag;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
tags (tagged_tweet: $retweeted_tweet, tag: $hashtag);
reduce $count = count($retweeted_tweet) groupby $hashtag;
sort $count desc;
limit 5;
fetch { ""hashtag"": $hashtag.hashtag_name, ""count"": $count };"
twitter,204,List the first 3 users that 'Neo4j' follows with the highest number of tweets.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE exists{ (followed)-[:POSTS]->(:Tweet) }
RETURN followed.screen_name AS user, count{(followed)-[:POSTS]->(:Tweet)} AS num_tweets
ORDER BY num_tweets DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$followed isa user;
$t isa tweet;
follows (follower: $me, followed: $followed);
posts (author: $followed, content: $t);
reduce $num_tweets = count($t) groupby $followed;
sort $num_tweets desc;
limit 3;
fetch { ""user"": $followed.screen_name, ""num_tweets"": $num_tweets };"
twitter,205,Which users have mentioned 'Neo4j' in their tweets and have a following of more than 20000? Show the top 5.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
WHERE u.following > 20000
RETURN u.name, u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user, has following $f;
$t isa tweet;
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
$f > 20000;
sort $f desc;
limit 5;
fetch { ""name"": $u.name, ""screen_name"": $u.screen_name, ""following"": $f };"
twitter,206,What are the top 5 tweets that link to URLs starting with 'https://' and were posted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
WHERE link.url STARTS WITH 'https://'
RETURN tweet.text, link.url
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
$link isa link, has link_url $url;
posts (author: $me, content: $tweet);
contains (containing_tweet: $tweet, contained_link: $link);
$url like ""https://%"";
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""url"": $url };"
twitter,207,Identify the first 3 tweets mentioning 'Neo4j' that also tag a hashtag and were created in 2021.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag)
WHERE t.text CONTAINS 'Neo4j' AND t.created_at >= date('2021-01-01') AND t.created_at < date('2022-01-01') 
RETURN t
ORDER BY t.created_at
LIMIT 3","match
$t isa tweet, has text $txt, has created_at $ca;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""text"": $txt, ""created_at"": $ca };"
twitter,208,List the top 5 users followed by 'Neo4j' who have a screen_name starting with 'n'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.screen_name STARTS WITH 'n'
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has screen_name $sn, has followers $f;
follows (follower: $me, followed: $u);
$sn like ""n%"";
sort $f desc;
limit 5;
fetch { ""screen_name"": $sn, ""followers"": $f };"
twitter,209,Which users follow 'Neo4j' and have tweeted more than 500 times? Show the first 3.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.statuses > 500
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has statuses $s;
follows (follower: $u, followed: $me);
$s > 500;
sort $s desc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""statuses"": $s };"
twitter,210,What are the first 3 tweets that 'Neo4j' has retweeted and were tagged with 'education'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN retweeted.text AS retweeted_tweet
ORDER BY tweet.created_at DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$retweeted isa tweet;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
tags (tagged_tweet: $retweeted, tag: $h);
sort $ca desc;
limit 3;
fetch { ""retweeted_tweet"": $retweeted.text };"
twitter,211,Identify the top 5 users who interact with 'Neo4j' and have a location specified as 'Graphs Are Everywhere'.,"MATCH (u:User)-[:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL AND u.location = 'Graphs Are Everywhere'
RETURN u.screen_name AS user, u.location AS location
ORDER BY count{(u)-[:INTERACTS_WITH]->(me)} DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has location ""Graphs Are Everywhere"";
interacts_with (interactor: $u, target: $me);
reduce $interactions = count($u) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""location"": $u.location };"
twitter,212,List the top 5 tweets that include a link and were posted by users following 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$neo4j isa user, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $neo4j);
$t isa tweet, has text $txt, has favorites $fav;
posts (author: $u, content: $t);
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
sort $fav desc;
limit 5;
fetch { ""tweet_text"": $txt, ""favorites"": $fav };"
twitter,213,What are the first 3 tweets posted by 'Neo4j' that include a source named 'Buffer'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$source isa source, has source_name ""Buffer"";
posts (author: $me, content: $tweet);
using (tweet_content: $tweet, platform: $source);
sort $ca asc;
limit 3;
fetch { ""text"": $tweet.text };"
twitter,215,List the first 3 users who follow 'Neo4j' and have a betweenness score of exactly 349332601.0.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.betweenness = 349332601.0
RETURN u.screen_name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has betweenness 349332601.0;
follows (follower: $u, followed: $me);
limit 3;
fetch { ""screen_name"": $u.screen_name };"
twitter,216,Which users followed by 'Neo4j' have posted tweets mentioning 'Neo4j'? Show the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(me)
RETURN u.screen_name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$t isa tweet;
follows (follower: $me, followed: $u);
posts (author: $u, content: $t);
mentions (source_tweet: $t, mentioned_user: $me);
reduce $mentions = count($t) groupby $u;
sort $mentions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""mentions"": $mentions };"
twitter,217,What are the top 5 tweets by 'Neo4j' that contain the hashtag 'education' and were created in 2021?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE tweet.created_at >= date('2021-01-01') AND tweet.created_at < date('2022-01-01') 
RETURN tweet.text AS tweet_text, tweet.created_at AS created_at, tweet.favorites AS favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca, has favorites $f;
$h isa hashtag, has hashtag_name ""education"";
posts (author: $me, content: $tweet);
tags (tagged_tweet: $tweet, tag: $h);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $f desc;
limit 5;
fetch { ""tweet_text"": $tweet.text, ""created_at"": $ca, ""favorites"": $f };"
twitter,219,List the top 5 users that 'Neo4j' retweeted and who have a following of more than 10000.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)
WHERE u.following > 10000
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $orig);
$u isa user, has screen_name $sn, has following $fg;
posts (author: $u, content: $orig);
$fg > 10000;
sort $fg desc;
limit 5;
fetch { ""screen_name"": $sn, ""following"": $fg };"
twitter,220,Which users have a profile image URL and follow 'Neo4j'? Show the first 3.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.profile_image_url IS NOT NULL
RETURN u.screen_name, u.profile_image_url
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has profile_image_url $purl;
follows (follower: $u, followed: $me);
limit 3;
fetch { ""screen_name"": $u.screen_name, ""profile_image_url"": $purl };"
twitter,221,List the first 3 tweets that include a link to 'https://twitter.com' and were favorited more than 100 times.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com' AND t.favorites > 100
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$l isa link, has link_url $url;
contains (containing_tweet: $t, contained_link: $l);
$url like ""https://twitter.com%"";
$f > 100;
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""favorites"": $f };"
twitter,223,Identify the first 3 tweets that 'Neo4j' has retweeted and were posted by users with a profile image URL ending in 'normal.jpg'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)<-[:POSTS]-(user:User)
WHERE user.profile_image_url ENDS WITH 'normal.jpg'
RETURN retweeted_tweet, user
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca;
$retweeted_tweet isa tweet;
$user isa user, has profile_image_url $purl;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
posts (author: $user, content: $retweeted_tweet);
$purl like ""%normal.jpg"";
sort $ca asc;
limit 3;
fetch { ""retweeted_text"": $retweeted_tweet.text, ""user_screen_name"": $user.screen_name };"
twitter,224,List the top 5 tweets that 'Neo4j' has mentioned and were created after January 2021.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.created_at >= date('2021-01-01')
RETURN tweet.text AS tweet_text, tweet.created_at
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has created_at $ca, has favorites $f;
posts (author: $me, content: $tweet);
$ca >= 2021-01-01T00:00:00;
sort $f desc;
limit 5;
fetch { ""tweet_text"": $tweet.text, ""created_at"": $ca };"
twitter,225,Who are the top 5 users with the highest betweenness?,"MATCH (u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
$u isa user, has betweenness $b;
sort $b desc;
limit 5;
fetch { ""screen_name"": $u.screen_name, ""betweenness"": $b };"
twitter,226,List the first 3 users with the lowest number of followers.,"MATCH (u:User)
WHERE u.followers IS NOT NULL
RETURN u.screen_name, u.followers
ORDER BY u.followers
LIMIT 3","match
$u isa user, has followers $f;
sort $f asc;
limit 3;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,227,What are the names of the top 5 users with the most following?,"MATCH (u:User)
RETURN u.name, u.following
ORDER BY u.following DESC
LIMIT 5","match
$u isa user, has following $f;
sort $f desc;
limit 5;
fetch { ""name"": $u.name, ""following"": $f };"
twitter,228,Identify the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""favorites"": $f };"
twitter,229,Which users follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS follower","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $me);
fetch { ""follower"": $u.screen_name };"
twitter,230,What are the first 3 tweets containing the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN t.text AS tweet_text
ORDER BY t.created_at
LIMIT 3","match
$t isa tweet, has created_at $ca;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
sort $ca asc;
limit 3;
fetch { ""tweet_text"": $t.text };"
twitter,231,Who are the first 3 users mentioned in tweets on '2021-03-16'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
WHERE t.created_at >= datetime('2021-03-16') AND t.created_at < datetime('2021-03-17') 
RETURN u.name
LIMIT 3","match
$t isa tweet, has created_at $ca;
$u isa user;
mentions (source_tweet: $t, mentioned_user: $u);
$ca >= 2021-03-16T00:00:00;
$ca < 2021-03-17T00:00:00;
limit 3;
fetch { ""name"": $u.name };"
twitter,232,List the top 5 tweets by 'Neo4j' based on favorites.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
posts (author: $me, content: $tweet);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
twitter,233,What are the first 3 sources used by the most popular tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, max(t.favorites) AS max_favorites
ORDER BY max_favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$s isa source;
using (tweet_content: $t, platform: $s);
reduce $max_favorites = max($f) groupby $s;
sort $max_favorites desc;
limit 3;
fetch { ""source"": $s.source_name, ""max_favorites"": $max_favorites };"
twitter,234,Who are the top 5 users most similar to 'Neo4j' based on the SIMILAR_TO score?,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
$me isa me, has name ""Neo4j"";
$u isa user;
$sim isa similar_to (source_user: $me, similar_user: $u), has score $score;
sort $score desc;
limit 5;
fetch { ""user"": $u.name, ""similarity"": $score };"
twitter,235,What are the urls for the top 3 links contained in the most retweeted tweets?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WITH l, count{(t)-[:RETWEETS]->(:Tweet)} AS retweets
ORDER BY retweets DESC
LIMIT 3
RETURN l.url","match
$t isa tweet;
$l isa link;
$rt isa tweet;
contains (containing_tweet: $t, contained_link: $l);
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $retweets = count($rt) groupby $l;
sort $retweets desc;
limit 3;
fetch { ""url"": $l.link_url };"
twitter,236,Which users are followed by 'neo4j' and have more than 500 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.followers > 500
RETURN u.screen_name, u.followers","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has followers $f;
follows (follower: $me, followed: $u);
$f > 500;
fetch { ""screen_name"": $u.screen_name, ""followers"": $f };"
twitter,237,List the first 3 tweets retweeted by users located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(rt:Tweet)
RETURN rt.text AS retweeted_tweet
ORDER BY rt.created_at DESC
LIMIT 3","match
$u isa user, has location ""Graphs Are Everywhere"";
$t isa tweet;
$rt isa tweet, has created_at $ca;
posts (author: $u, content: $t);
retweets (retweeting_tweet: $t, original_tweet: $rt);
sort $ca desc;
limit 3;
fetch { ""retweeted_tweet"": $rt.text };"
twitter,238,Who are the top 5 users interacting with 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
interacts_with (interactor: $u, target: $me);
reduce $interactions = count($u) groupby $u;
sort $interactions desc;
limit 5;
fetch { ""user"": $u.screen_name, ""interactions"": $interactions };"
twitter,239,Which tweets mention 'Neo4j' and were created after '2021-01-01'?,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {name: 'Neo4j'})
WHERE t.created_at > date('2021-01-01')
RETURN t","match
$t isa tweet, has created_at $ca;
$u isa user, has name ""Neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
$ca > 2021-01-01T00:00:00;
fetch { ""text"": $t.text, ""created_at"": $ca };"
twitter,240,List the first 3 users that 'Neo4j' amplifies.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user.screen_name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$user isa user;
amplifies (amplifier: $me, amplified_user: $user);
limit 3;
fetch { ""screen_name"": $user.screen_name };"
twitter,241,What are the first 3 tweets replied to by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN repliedTo.text AS replied_to_tweet
ORDER BY tweet.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $replied_to);
  $tweet has created_at $created_at;
  $replied_to has text $text;
sort $created_at asc;
limit 3;
fetch { ""replied_to_tweet"": $text };"
twitter,242,Identify the top 5 hashtags used in tweets from '2020-12-06'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.created_at >= datetime('2020-12-06') AND t.created_at < datetime('2020-12-07') 
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $t isa tweet, has created_at $created_at;
  $created_at >= 2020-12-06T00:00:00;
  $created_at < 2020-12-07T00:00:00;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,243,List the first 3 tweets that link to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text AS tweet_text
LIMIT 3","match
  $t isa tweet, has text $text;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
  $url like ""^https://twitter\\.com.*"";
limit 3;
fetch { ""tweet_text"": $text };"
twitter,244,What are the profile images of the top 5 users by followers?,"MATCH (u:User)
WHERE u.profile_image_url IS NOT NULL
RETURN u.profile_image_url AS profile_image
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has profile_image_url $profile_image, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""profile_image"": $profile_image };"
twitter,246,List the first 3 tweets with a creation date on '2021-03-16'.,"MATCH (t:Tweet)
WHERE t.created_at >= datetime('2021-03-16') AND t.created_at < datetime('2021-03-17') 
RETURN t
LIMIT 3","match
  $t isa tweet, has created_at $created_at, has tweet_id $id, has text $text;
  $created_at >= 2021-03-16T00:00:00;
  $created_at < 2021-03-17T00:00:00;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text, ""created_at"": $created_at };"
twitter,247,Identify the top 5 users by betweenness and name starting with 'N'.,"MATCH (u:User)
WHERE u.name STARTS WITH 'N'
RETURN u.name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has name $name, has betweenness $betweenness;
  $name like ""^N.*"";
sort $betweenness desc;
limit 5;
fetch { ""name"": $name, ""betweenness"": $betweenness };"
twitter,248,What are the top 5 links contained in the tweets posted by users with fewer than 100 followers?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
WHERE u.followers < 100
RETURN l.url, count(*) as count
ORDER BY count DESC
LIMIT 5","match
  $u isa user, has followers $followers;
  $followers < 100;
  posts (author: $u, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
reduce $count = count($t) groupby $url;
sort $count desc;
limit 5;
fetch { ""url"": $url, ""count"": $count };"
twitter,249,Which tweets by 'Neo4j' mention at least one other user?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {(tweet)-[:MENTIONS]->(:User)}
RETURN tweet.text","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $u);
  $tweet has text $text;
fetch { ""text"": $text };"
twitter,250,List the first 3 tweets that retweet tweets created on '2020-12-06'.,"MATCH (t1:Tweet)-[:RETWEETS]->(t2:Tweet)
WHERE t2.created_at >= date('2020-12-06') AND t2.created_at < date('2020-12-07') 
RETURN t1
LIMIT 3","match
  $t1 isa tweet, has tweet_id $id, has text $text;
  retweets (retweeting_tweet: $t1, original_tweet: $t2);
  $t2 has created_at $created_at;
  $created_at >= 2020-12-06T00:00:00;
  $created_at < 2020-12-07T00:00:00;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,251,Who are the users that 'Neo4j' mentions in tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
RETURN user.name AS mentioned_user","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $user);
  $user has name $name;
fetch { ""mentioned_user"": $name };"
twitter,252,Identify the top 5 tweets with text containing 'critical service'.,"MATCH (t:Tweet)
WHERE t.text CONTAINS 'critical service'
RETURN t
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites, has tweet_id $id;
  $text like "".*critical service.*"";
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
twitter,253,List the profile URLs of the top 3 users by betweenness.,"MATCH (u:User)
WHERE u.profile_image_url IS NOT NULL
RETURN u.profile_image_url
ORDER BY u.betweenness DESC
LIMIT 3","match
  $u isa user, has profile_image_url $profile_image_url, has betweenness $betweenness;
sort $betweenness desc;
limit 3;
fetch { ""profile_image_url"": $profile_image_url };"
twitter,254,What are the top 5 hashtags in tweets containing the word 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'education'
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $t isa tweet, has text $text;
  $text like "".*education.*"";
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,255,Which users with over 10000 followers are located in 'Graphs Are Everywhere'?,"MATCH (u:User)
WHERE u.followers > 10000 AND u.location = 'Graphs Are Everywhere'
RETURN u.name, u.screen_name, u.followers","match
  $u isa user, has followers $followers, has location ""Graphs Are Everywhere"", has name $name, has screen_name $sn;
  $followers > 10000;
fetch { ""name"": $name, ""screen_name"": $sn, ""followers"": $followers };"
twitter,256,List the first 3 tweets posted by 'Neo4j' using the source 'Buffer'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name ""Buffer"";
  $tweet has text $text;
limit 3;
fetch { ""text"": $text };"
twitter,257,Identify the top 5 users who have exactly 663 followers.,"MATCH (u:User)
WHERE u.followers = 663
RETURN u.screen_name, u.name
ORDER BY u.screen_name
LIMIT 5","match
  $u isa user, has followers 663, has screen_name $sn, has name $name;
sort $sn asc;
limit 5;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,258,What are the top 3 tweets by favorites posted from 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $u isa user, has location ""Graphs Are Everywhere"";
  posts (author: $u, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,259,Which users with a profile image URL containing 'horned_reaper' follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.profile_image_url CONTAINS 'horned_reaper'
RETURN u","match
  $u isa user, has profile_image_url $profile_url, has screen_name $sn, has name $name;
  $profile_url like "".*horned_reaper.*"";
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,260,List the first 3 hashtags used in tweets mentioning 'Neo4j'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'Neo4j'
RETURN h.name
LIMIT 3","match
  $t isa tweet, has text $text;
  $text like "".*Neo4j.*"";
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
limit 3;
fetch { ""name"": $name };"
twitter,261,Who are the top 5 users followed by 'Neo4j' based on betweenness score?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.betweenness AS betweenness
ORDER BY followed.betweenness DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""user"": $sn, ""betweenness"": $betweenness };"
twitter,262,Identify the top 3 tweets that contain links to 'https://twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url STARTS WITH 'https://twitter.com'
RETURN t.text AS tweet_text, l.url AS link_url
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
  $url like ""^https://twitter\\.com.*"";
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""link_url"": $url };"
twitter,263,List the first 3 tweets that 'Neo4j' retweets on '2021-03-16'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweet:Tweet)
WHERE tweet.created_at >= datetime('2021-03-16') AND tweet.created_at < datetime('2021-03-17') 
RETURN retweet
ORDER BY retweet.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  $tweet has created_at $created_at;
  $created_at >= 2021-03-16T00:00:00;
  $created_at < 2021-03-17T00:00:00;
  retweets (retweeting_tweet: $tweet, original_tweet: $retweet);
  $retweet has tweet_id $id, has text $text, has created_at $rt_created;
sort $rt_created asc;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,264,What are the top 5 sources used in tweets by users located in 'Sweden'?,"MATCH (u:User {location: 'Sweden'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $u isa user, has location ""Sweden"";
  posts (author: $u, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""source"": $name, ""count"": $count };"
twitter,265,List the top 5 users with the highest betweenness.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
twitter,266,Find all tweets posted by 'Neo4j' containing a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN t, h","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $t has text $text, has tweet_id $id;
  $h has hashtag_name $hashtag;
fetch { ""tweet_id"": $id, ""text"": $text, ""hashtag"": $hashtag };"
twitter,267,Display the first 3 users followed by 'Neo4j' who have more than 10000 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.followers > 10000
RETURN followed.screen_name, followed.followers
ORDER BY followed.followers DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has followers $followers;
  $followers > 10000;
sort $followers desc;
limit 3;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,268,Show the top 5 tweets with the most favorites that were posted using 'Buffer'.,"MATCH (t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  using (tweet_content: $t, platform: $s);
  $s has source_name ""Buffer"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""num_favorites"": $favorites };"
twitter,269,Identify the first 3 hashtags used in tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'Neo4j'
RETURN h.name AS hashtag
LIMIT 3","match
  $t isa tweet, has text $text;
  $text like "".*Neo4j.*"";
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
limit 3;
fetch { ""hashtag"": $name };"
twitter,270,List all tweets by 'Neo4j' that reply to another tweet.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(replied_to:Tweet)
RETURN t, replied_to","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  reply_to (replying_tweet: $t, original_tweet: $replied_to);
  $t has text $text1, has tweet_id $id1;
  $replied_to has text $text2, has tweet_id $id2;
fetch { ""tweet_id"": $id1, ""tweet_text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
twitter,271,Show the top 5 users that 'Neo4j' interacts with based on the number of interactions.,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $me, target: $u);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,272,List the first 3 links contained in tweets posted by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
limit 3;
fetch { ""url"": $url };"
twitter,273,Find the top 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,274,Who are the top 3 users most similar to 'Neo4j' based on similarity score?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $u has screen_name $sn;
sort $score desc;
limit 3;
fetch { ""user"": $sn, ""similarity"": $score };"
twitter,275,Identify the first 3 tweets by 'Neo4j' that retweet another user's tweets.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:RETWEETS]->(retweeted:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  retweets (retweeting_tweet: $t, original_tweet: $retweeted);
  $t has text $text, has created_at $created_at;
sort $created_at asc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,276,Show all tweets that mention 'Neo4j' and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE exists{ (t)-[:CONTAINS]->(:Link) }
RETURN t","match
  $t isa tweet, has text $text, has tweet_id $id;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  contains (containing_tweet: $t, contained_link: $l);
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,277,List the first 3 users who follow 'Neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
  $u isa user, has location ""Graphs Are Everywhere"", has name $name, has screen_name $sn;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn, ""location"": ""Graphs Are Everywhere"" };"
twitter,278,Display the top 5 most recent tweets by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at desc;
limit 5;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,279,Who are the top 3 users followed by 'Me' with the highest betweenness?,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 3","match
  $me isa me;
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 3;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
twitter,280,Identify all tweets by 'Neo4j' that mention a user with at least 5000 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(user:User)
WHERE user.followers >= 5000
RETURN tweet, user","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $user);
  $user has followers $followers, has screen_name $usn, has name $uname;
  $followers >= 5000;
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text, ""mentioned_user"": $usn, ""mentioned_name"": $uname };"
twitter,281,Show the first 3 hashtags tagged in tweets that have been retweeted more than 100 times.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 100
RETURN h.name
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
tags (tagged_tweet: $tweet, tag: $hashtag);
limit 3;
fetch {
  ""hashtag"": $hashtag.hashtag_name
};"
twitter,282,List the top 5 sources used in tweets posted by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 5;
fetch { ""source"": $name, ""tweet_count"": $count };"
twitter,283,Find all tweets by 'Neo4j' that mention 'Me'.,"MATCH (neo4j:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(me:Me)
RETURN tweet","match
  $neo4j isa me, has screen_name ""neo4j"";
  posts (author: $neo4j, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned isa me;
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,286,Show the first 3 tweets that 'Me' has retweeted.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)
RETURN retweetedTweet.text AS RetweetedTweet
ORDER BY tweet.created_at DESC
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  $tweet has created_at $created_at;
  $retweetedTweet has text $text;
sort $created_at desc;
limit 3;
fetch { ""RetweetedTweet"": $text };"
twitter,288,Identify the first 3 users who interact with 'Neo4j' and have a similar location.,"MATCH (me:Me {name: 'Neo4j'})<-[:INTERACTS_WITH]-(u:User)
WHERE u.location IS NOT NULL AND u.location = me.location
WITH u
ORDER BY u.screen_name
LIMIT 3
RETURN u.screen_name AS user, u.location AS location","match
  $me isa me, has name ""Neo4j"", has location $loc;
  interacts_with (interactor: $u, target: $me);
  $u isa user, has screen_name $sn, has location $loc;
sort $sn asc;
limit 3;
fetch { ""user"": $sn, ""location"": $loc };"
twitter,289,Show the top 5 tweets by 'Neo4j' that were posted from a location outside 'Graphs Are Everywhere'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE me.location <> 'Graphs Are Everywhere'
RETURN tweet.text, tweet.created_at
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"", has location $loc;
  not { $me has location ""Graphs Are Everywhere""; };
  posts (author: $me, content: $tweet);
  $tweet has text $text, has created_at $created_at, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,290,Who are the top 3 users that 'Neo4j' amplifies the most?,"MATCH (me:Me {screen_name: 'neo4j'})-[a:AMPLIFIES]->(u:User)
RETURN u.screen_name AS user, count(a) AS amplifications
ORDER BY amplifications DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $a isa amplifies (amplifier: $me, amplified_user: $u);
  $u has screen_name $sn;
reduce $count = count($a) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""amplifications"": $count };"
twitter,291,List the first 3 tweets by 'Me' that contain a link.,"MATCH (m:Me)-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text, l.url
ORDER BY t.created_at
LIMIT 3","match
  $m isa me;
  posts (author: $m, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $t has text $text, has created_at $created_at;
  $l has link_url $url;
sort $created_at asc;
limit 3;
fetch { ""text"": $text, ""url"": $url };"
twitter,292,Find all tweets by 'Neo4j' that were posted on or after '2021-01-01'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.created_at >= date('2021-01-01')
RETURN t","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has created_at $created_at, has text $text, has tweet_id $id;
  $created_at >= 2021-01-01T00:00:00;
fetch { ""tweet_id"": $id, ""text"": $text, ""created_at"": $created_at };"
twitter,293,Display the top 5 users who follow both 'Neo4j' and 'Me'.,"MATCH (u:User)-[:FOLLOWS]->(:User {screen_name: 'neo4j'})
WHERE (u)-[:FOLLOWS]->(:Me)
RETURN u.screen_name, u.name
ORDER BY u.followers DESC
LIMIT 5","match
  $neo4j isa user, has screen_name ""neo4j"";
  $me isa me;
  follows (follower: $u, followed: $neo4j);
  follows (follower: $u, followed: $me);
  $u has screen_name $sn, has name $name, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,295,Show all hashtags that have appeared in more than 5 tweets mentioning 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(h:Hashtag)
WITH h, count(tweet) AS tweet_count
WHERE tweet_count > 5
RETURN h.name AS hashtag, tweet_count
ORDER BY tweet_count DESC","match
  $tweet isa tweet, has text $text;
  $text like "".*Neo4j.*"";
  tags (tagged_tweet: $tweet, tag: $tag);
reduce $count = count groupby $tag;
match
  $count > 5;
fetch {
  ""tag"": $tag.hashtag_name,
  ""appearances_with_neo4j"": $count
};"
twitter,296,List the top 5 users who have a similar betweenness to 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'}), (u:User)
WHERE u.betweenness IS NOT NULL
WITH me, u
ORDER BY abs(me.betweenness - u.betweenness) 
LIMIT 5
RETURN u.name AS user, u.betweenness AS betweenness","match
$neo4j isa me, has name ""Neo4j"", has betweenness $neo4j_betweenness;
$user isa user, has betweenness $betweenness;
not { $neo4j is $user; };
let $difference = abs($betweenness - $neo4j_betweenness);
sort $difference asc;
limit 5;
fetch {
  ""user"": $user.name
};"
twitter,297,Find the first 3 tweets by 'Neo4j' that were favorited more than 300 times.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 300
RETURN t
ORDER BY t.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has favorites $favorites, has created_at $created_at, has text $text, has tweet_id $id;
  $favorites > 300;
sort $created_at asc;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
twitter,298,Display all tweets by 'Neo4j' that mention at least two different users.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE size([(tweet)-[:MENTIONS]->(u:User) | u]) >= 2
RETURN tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $u1);
  mentions (source_tweet: $tweet, mentioned_user: $u2);
  not { $u1 is $u2; };
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,299,Identify the first 3 users followed by 'Me' who are located in the same location as 'Me'.,"MATCH (me:Me)-[:FOLLOWS]->(u:User)
WHERE u.location = me.location
RETURN u.name, u.screen_name, u.location
LIMIT 3","match
  $me isa me, has location $loc;
  follows (follower: $me, followed: $u);
  $u has name $name, has screen_name $sn, has location $loc;
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn, ""location"": $loc };"
twitter,300,Show the top 5 tweets that 'Me' has replied to.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN repliedTo, tweet
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me;
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has favorites $favorites, has text $text1, has tweet_id $id1;
  $repliedTo has text $text2, has tweet_id $id2;
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id1, ""tweet_text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
twitter,302,Find the top 5 tweets by 'Neo4j' that contain the hashtag '#education'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name ""education"";
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,303,Display the first 3 users who mention 'Neo4j' in their tweets and have a similar profile image.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
WHERE u.profile_image_url IS NOT NULL
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.name, u.screen_name, u.profile_image_url, mentions","match
  $u isa user, has name $name, has screen_name $sn, has profile_image_url $img;
  posts (author: $u, content: $t);
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
reduce $count = count($t) groupby $name, $sn, $img;
sort $count desc;
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn, ""profile_image_url"": $img, ""mentions"": $count };"
twitter,304,Identify all tweets by 'Neo4j' that were posted using a source other than 'Buffer'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
WHERE source.name <> 'Buffer'
RETURN tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
  not { $source has source_name ""Buffer""; };
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,306,Find all tweets by 'Neo4j' that tag a hashtag and mention a user.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE (t)-[:TAGS]->(:Hashtag) AND (t)-[:MENTIONS]->(:User)
RETURN t","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  mentions (source_tweet: $t, mentioned_user: $u);
  $t has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,307,Display the first 3 users with the highest following who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $following desc;
limit 3;
fetch { ""screen_name"": $sn, ""following"": $following };"
twitter,309,Identify the first 3 tweets by 'Neo4j' that contain a link to an external website.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text, l.url
ORDER BY t.created_at
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $t has text $text, has created_at $created_at;
  $l has link_url $url;
sort $created_at asc;
limit 3;
fetch { ""text"": $text, ""url"": $url };"
twitter,310,Show all tweets that 'Me' has amplified.,"MATCH (me:Me)-[:AMPLIFIES]->(u:User)<-[:POSTS]-(t:Tweet)
RETURN t","match
  $me isa me;
  amplifies (amplifier: $me, amplified_user: $u);
  posts (author: $u, content: $t);
  $t has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,311,List the first 3 hashtags appearing in the latest tweets by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name
ORDER BY t.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $t has created_at $created_at;
  $h has hashtag_name $name;
sort $created_at desc;
limit 3;
fetch { ""name"": $name };"
twitter,312,Find the top 5 tweets mentioning 'Neo4j' with the most favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $text like "".*Neo4j.*"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""num_favorites"": $favorites };"
twitter,313,Display all tweets by 'Neo4j' that mention a user and contain a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {(tweet)-[:MENTIONS]->(:User)} 
  AND exists {(tweet)-[:TAGS]->(:Hashtag)}
RETURN tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $u);
  tags (tagged_tweet: $tweet, tag: $h);
  $tweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,314,Who are the top 3 users with the most statuses who follow 'Neo4j'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has statuses $statuses;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $statuses desc;
limit 3;
fetch { ""screen_name"": $sn, ""statuses"": $statuses };"
twitter,315,What are the top 5 users with the highest number of followers?,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,316,Which users follow 'Neo4j' and have more than 500 followers?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.followers > 500
RETURN u.screen_name, u.followers","match
  $u isa user, has screen_name $sn, has followers $followers;
  $followers > 500;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,317,List the top 3 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,318,What are the top 5 tweets by 'Neo4j' based on favorites count?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,319,Who are the top 3 users that 'Neo4j' follows?,"MATCH (me:Me {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.name AS user, followed.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $me isa me, has name ""Neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has name $name, has followers $followers;
sort $followers desc;
limit 3;
fetch { ""user"": $name, ""followers"": $followers };"
twitter,320,What are the names of the top 3 hashtags used in tweets?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $t isa tweet;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,321,Which tweets contain links and have more than 100 favorites?,"MATCH (t:Tweet)-[:CONTAINS]->(:Link)
WHERE t.favorites > 100
RETURN t","match
  $t isa tweet, has favorites $favorites, has text $text, has tweet_id $id;
  $favorites > 100;
  contains (containing_tweet: $t, contained_link: $l);
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
twitter,322,Who are the top 5 users most similar to 'Neo4j' based on the similarity score?,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.name AS user, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $u has name $name;
sort $score desc;
limit 5;
fetch { ""user"": $name, ""similarity"": $score };"
twitter,323,What are the top 3 sources used in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""source"": $name, ""tweet_count"": $count };"
twitter,324,Which users have a betweenness higher than 1000000?,"MATCH (u:User)
WHERE u.betweenness > 1000000
RETURN u","match
  $u isa user, has screen_name $sn, has name $name, has betweenness $betweenness;
  $betweenness > 1000000;
fetch { ""screen_name"": $sn, ""name"": $name, ""betweenness"": $betweenness };"
twitter,325,Find the top 3 users based on the number of statuses they have posted.,"MATCH (u:User)
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has statuses $statuses;
sort $statuses desc;
limit 3;
fetch { ""screen_name"": $sn, ""statuses"": $statuses };"
twitter,326,What are the 3 most recent tweets posted by any user?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.created_at AS created_at
ORDER BY t.created_at DESC
LIMIT 3","match
  $u isa user;
  posts (author: $u, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""tweet_text"": $text, ""created_at"": $created_at };"
twitter,327,List the top 3 tweets that mention 'Neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,328,Who are the top 5 followers of 'Neo4j' based on the number of statuses they have?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
RETURN follower.screen_name AS follower, follower.statuses AS num_statuses
ORDER BY follower.statuses DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  $follower has screen_name $sn, has statuses $statuses;
sort $statuses desc;
limit 5;
fetch { ""follower"": $sn, ""num_statuses"": $statuses };"
twitter,329,What are the top 3 tweets retweeted by other users?,"MATCH (t:Tweet)<-[:RETWEETS]-(retweeted:Tweet)
RETURN t, count(retweeted) AS retweets
ORDER BY retweets DESC
LIMIT 3","match
  $t isa tweet, has text $text, has tweet_id $id;
  retweets (original_tweet: $t, retweeting_tweet: $retweeted);
reduce $count = count($retweeted) groupby $id, $text;
sort $count desc;
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text, ""retweets"": $count };"
twitter,330,Which users have the highest following to follower ratio?,"MATCH (u:User)
WHERE u.followers IS NOT NULL AND u.following IS NOT NULL
RETURN u.screen_name AS user, 
       toFloat(u.following) / u.followers AS followingToFollowerRatio
ORDER BY followingToFollowerRatio DESC
LIMIT 10","with fun follower_count($user: user) -> integer:
  match follows (followed: $user);
  return count;
with fun follows_count($user: user) -> integer:
  match follows (follower: $user);
  return count;
match
$user isa user;
let $followers = follower_count($user);
let $follows = follows_count($user);
$followers > 0;
$follows > 0;
let $ratio = $follows / $followers;
sort $ratio desc;
limit 10;
fetch {
  ""user"": $user.name,
  ""ratio"": $ratio
};"
twitter,331,List the top 5 users based on betweenness centrality.,"MATCH (u:User)
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
twitter,332,What are the top 3 locations from where the most tweets originate?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL
RETURN u.location, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $u isa user, has location $location;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $location;
sort $count desc;
limit 3;
fetch { ""location"": $location, ""tweet_count"": $count };"
twitter,333,Which tweets from 'Neo4j' mention other users and what are these users' screen names?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN tweet.text AS tweet, mentioned.screen_name AS mentioned_user","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $tweet has text $text;
  $mentioned has screen_name $sn;
fetch { ""tweet"": $text, ""mentioned_user"": $sn };"
twitter,334,Who are the top 3 users that have interacted with 'Neo4j' the most?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $u, target: $me);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,336,What are the top 3 hashtags associated with tweets that have been retweeted more than 50 times?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 50
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$tweet isa tweet;
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 50;
tags (tagged_tweet: $tweet, tag: $hashtag);
reduce $hashtag_count = count groupby $hashtag;
sort $hashtag_count desc;
limit 3;
fetch {
  ""hashtag"": $hashtag.hashtag_name,
  ""count"": $hashtag_count
};"
twitter,338,List the top 3 users with the lowest number of followers who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.followers IS NOT NULL
RETURN u.screen_name, u.followers
ORDER BY u.followers
LIMIT 3","match
  $u isa user, has screen_name $sn, has followers $followers;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $followers asc;
limit 3;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,339,What are the top 3 tweets with the least favorites posted by 'Neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS num_favorites
ORDER BY t.favorites
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites asc;
limit 3;
fetch { ""tweet_text"": $text, ""num_favorites"": $favorites };"
twitter,340,Who are the top 3 users based on the number of users they interact with?,"MATCH (u:User)-[:INTERACTS_WITH]->(other:User)
WITH u, count(other) AS num_interactions
ORDER BY num_interactions DESC
LIMIT 3
RETURN u.name AS user, num_interactions","match
  $u isa user, has name $name;
  interacts_with (interactor: $u, target: $other);
reduce $count = count($other) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""num_interactions"": $count };"
twitter,341,What are the top 5 tweets containing the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,342,Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score","match
  $me isa me, has screen_name ""neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $score > 0.5;
  $u has screen_name $sn;
fetch { ""screen_name"": $sn, ""score"": $score };"
twitter,343,Who are the top 3 users that 'Neo4j' has amplified?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(user:User)
RETURN user.screen_name, user.name
ORDER BY user.followers DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  amplifies (amplifier: $me, amplified_user: $user);
  $user has screen_name $sn, has name $name, has followers $followers;
sort $followers desc;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,344,List the top 5 tweets that contain links and are posted by 'Neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  contains (containing_tweet: $tweet, contained_link: $link);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,345,What are the top 3 tweets that 'Neo4j' has retweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)
RETURN retweetedTweet.text AS RetweetedTweet, retweetedTweet.favorites AS Favorites
ORDER BY retweetedTweet.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  $retweetedTweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""RetweetedTweet"": $text, ""Favorites"": $favorites };"
twitter,346,Which users have 'Neo4j' mentioned in its tweets the most?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'})
RETURN u.name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 10","match
  $u isa user, has name $name;
  posts (author: $u, content: $t);
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
reduce $count = count($t) groupby $name;
sort $count desc;
limit 10;
fetch { ""user"": $name, ""mentions"": $count };"
twitter,347,List the top 3 tweets from users located in 'Graphs Are Everywhere'.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $u isa user, has location ""Graphs Are Everywhere"";
  posts (author: $u, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,348,What are the top 5 tweets by favorites that contain the hashtag 'education'?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,349,Which users follow 'Neo4j' and are from 'Graphs Are Everywhere'?,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,351,Who are the top 3 users that 'Neo4j' retweets mentions from?,"MATCH (me:Me {screen_name: 'neo4j'})-[:RT_MENTIONS]->(user:User)
RETURN user.screen_name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $rt isa rt_mentions (mentioner: $me, mentioned_user: $user);
  $user has screen_name $sn;
reduce $count = count($rt) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""mentions"": $count };"
twitter,352,What are the top 3 tweets by 'Neo4j' that reply to other tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet.text AS tweet, repliedTo.id_str AS in_reply_to
ORDER BY tweet.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has text $text, has favorites $favorites;
  $repliedTo has id_str $id_str;
sort $favorites desc;
limit 3;
fetch { ""tweet"": $text, ""in_reply_to"": $id_str };"
twitter,354,What are the names of the top 3 sources from tweets retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  using (tweet_content: $retweetedTweet, platform: $source);
  $source has source_name $name;
reduce $count = count($retweetedTweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""source"": $name, ""count"": $count };"
twitter,355,Who are the 3 users with the most tweets that contain the hashtag 'education'?,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3
RETURN u.name AS user, tweet_count","match
  $u isa user, has name $name;
  posts (author: $u, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""tweet_count"": $count };"
twitter,356,List the top 5 tweets that 'Neo4j' has replied to.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN repliedTo, tweet
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has text $text1, has tweet_id $id1, has favorites $favorites;
  $repliedTo has text $text2, has tweet_id $id2;
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id1, ""tweet_text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
twitter,357,What are the top 3 tweets tagged with 'education' that have been retweeted by others?,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE exists{ (t)<-[:RETWEETS]-(:Tweet) }
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
  retweets (original_tweet: $t, retweeting_tweet: $rt);
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,358,Which users from 'Graphs Are Everywhere' have posted the most tweets?,"MATCH (u:User {location: 'Graphs Are Everywhere'})
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN u.screen_name AS user, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 10","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 10;
fetch { ""user"": $sn, ""num_tweets"": $count };"
twitter,359,Which users have a betweenness greater than 300 million?,"MATCH (u:User)
WHERE u.betweenness > 3.0E8
RETURN u.screen_name, u.betweenness","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
  $betweenness > 300000000.0;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
twitter,360,List the top 5 users by number of followers.,"MATCH (u:User)
RETURN u.screen_name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,361,Who are the first 3 users that a specific user identified by screen name 'neo4j' follows?,"MATCH (me:User {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name, followed.name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has name $name;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,362,Find all tweets containing the hashtag 'education' and show the first 5.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag {name: 'education'})
RETURN t.text
LIMIT 5","match
  $t isa tweet, has text $text;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
limit 5;
fetch { ""text"": $text };"
twitter,363,Which users are mentioned in the tweets posted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN DISTINCT mentioned","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn, has name $name;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,364,Show the top 3 most recent tweets by date.,"MATCH (t:Tweet)
RETURN t.text, t.created_at
ORDER BY t.created_at DESC
LIMIT 3","match
  $t isa tweet, has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,365,Which users have posted tweets with more than 100 favorites?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE t.favorites > 100
RETURN u.screen_name AS user, t.text AS tweet, t.favorites AS favorites","match
  $u isa user, has screen_name $sn;
  posts (author: $u, content: $t);
  $t has favorites $favorites, has text $text;
  $favorites > 100;
fetch { ""user"": $sn, ""tweet"": $text, ""favorites"": $favorites };"
twitter,366,List all sources used for tweets and show the first 5.,"MATCH (t:Tweet)-[:USING]->(s:Source)
RETURN DISTINCT s.name
LIMIT 5","match
  $t isa tweet;
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
limit 5;
fetch { ""name"": $name };"
twitter,367,Who are the users that have been retweeted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name AS retweeted_user, retweetedTweet.text AS retweeted_tweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  posts (author: $retweetedUser, content: $retweetedTweet);
  $retweetedUser has screen_name $sn;
  $retweetedTweet has text $text;
fetch { ""retweeted_user"": $sn, ""retweeted_tweet"": $text };"
twitter,368,Find the top 5 tweets with the highest number of favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,369,What are the top 3 hashtags used in tweets posted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:TAGS]->(hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,370,Which users have the highest betweenness and list the top 5.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
twitter,371,Display the first 3 tweets that mention 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
RETURN t.text AS tweet_text
LIMIT 3","match
  $t isa tweet, has text $text;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
limit 3;
fetch { ""tweet_text"": $text };"
twitter,372,What are the top 5 locations from where users have tweeted?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.location IS NOT NULL
RETURN u.location, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 5","match
  $u isa user, has location $location;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $location;
sort $count desc;
limit 5;
fetch { ""location"": $location, ""num_tweets"": $count };"
twitter,373,List all the tweets that link to a URL containing 'twitter.com'.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WHERE l.url CONTAINS 'twitter.com'
RETURN t","match
  $t isa tweet, has text $text, has tweet_id $id;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
  $url like "".*twitter\\.com.*"";
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,374,Which users interact most frequently with 'neo4j' and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})<-[i:INTERACTS_WITH]-(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $u, target: $me);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,375,Show the tweets that replied to a tweet by 'neo4j' and list the first 3.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:REPLY_TO]-(reply:Tweet)
RETURN reply.text, reply.created_at
ORDER BY reply.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $reply, original_tweet: $tweet);
  $reply has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,376,What are the top 3 tweets by number of retweets?,"MATCH (t:Tweet)
RETURN t.text AS tweet_text, count{(t)<-[:RETWEETS]-(:Tweet)} AS retweets
ORDER BY retweets DESC
LIMIT 3","match
  $t isa tweet, has text $text;
  retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $count = count($rt) groupby $text;
sort $count desc;
limit 3;
fetch { ""tweet_text"": $text, ""retweets"": $count };"
twitter,377,Find all tweets from users located in 'Graphs Are Everywhere' and show the first 5.,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN t
LIMIT 5","match
  $u isa user, has location ""Graphs Are Everywhere"";
  posts (author: $u, content: $t);
  $t has text $text, has tweet_id $id;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,378,Who are the top 5 users similar to 'neo4j' based on the similarity score?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $u has screen_name $sn;
sort $score desc;
limit 5;
fetch { ""similar_user"": $sn, ""similarity"": $score };"
twitter,379,List all the links contained in tweets posted by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
fetch { ""url"": $url };"
twitter,380,Find tweets mentioning any user and list the top 5.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User)
RETURN t.text AS tweet_text, u.screen_name AS mentioned_user
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  mentions (source_tweet: $t, mentioned_user: $u);
  $u has screen_name $sn;
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""mentioned_user"": $sn };"
twitter,381,What are the top 3 sources from which 'neo4j' has tweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN source.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""source"": $name, ""tweet_count"": $count };"
twitter,382,Display the first 3 tweets from 'neo4j' that contain a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(:Hashtag)
RETURN t.text AS tweet_text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $t has text $text;
limit 3;
fetch { ""tweet_text"": $text };"
twitter,383,Who are the first 3 users that 'neo4j' has retweeted?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  posts (author: $retweetedUser, content: $retweetedTweet);
  $retweetedUser has screen_name $sn;
limit 3;
fetch { ""screen_name"": $sn };"
twitter,384,Find the top 5 users by number of statuses posted.,"MATCH (u:User)
WHERE u.statuses IS NOT NULL
RETURN u.screen_name, u.statuses AS status_count
ORDER BY status_count DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has statuses $statuses;
sort $statuses desc;
limit 5;
fetch { ""screen_name"": $sn, ""status_count"": $statuses };"
twitter,385,Which tweets from 'neo4j' contain a link to an external website?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN tweet.text, link.url","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  contains (containing_tweet: $tweet, contained_link: $link);
  $tweet has text $text;
  $link has link_url $url;
fetch { ""text"": $text, ""url"": $url };"
twitter,386,List the first 3 users followed by 'neo4j' with a betweenness of zero.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.betweenness = 0
RETURN followed.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has betweenness 0.0;
limit 3;
fetch { ""screen_name"": $sn };"
twitter,387,Show the tweets with a favorite count between 50 and 100 and list the first 5.,"MATCH (t:Tweet)
WHERE t.favorites >= 50 AND t.favorites <= 100
RETURN t
LIMIT 5","match
  $t isa tweet, has favorites $favorites, has text $text, has tweet_id $id;
  $favorites >= 50;
  $favorites <= 100;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
twitter,388,What are the top 5 most active users in terms of tweeting from 'Graphs Are Everywhere'?,"MATCH (u:User {location: 'Graphs Are Everywhere'})-[:POSTS]->(t:Tweet)
RETURN u.screen_name AS user, count(t) AS num_tweets
ORDER BY num_tweets DESC
LIMIT 5","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""num_tweets"": $count };"
twitter,389,Which users mentioned by 'neo4j' in tweets have more followers than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.followers > me.followers
RETURN mentioned.screen_name, mentioned.followers","match
  $me isa me, has screen_name ""neo4j"", has followers $me_followers;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn, has followers $m_followers;
  $m_followers > $me_followers;
fetch { ""screen_name"": $sn, ""followers"": $m_followers };"
twitter,391,Find the first 3 tweets where 'neo4j' is mentioned and the tweet is a retweet.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE exists{ (t)-[:RETWEETS]->(:Tweet) }
RETURN t
LIMIT 3","match
  $t isa tweet, has text $text, has tweet_id $id;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  retweets (retweeting_tweet: $t, original_tweet: $rt);
limit 3;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,392,Which users does 'neo4j' interact with the most and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $me, target: $u);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,393,List the first 3 users similar to 'neo4j' with a similarity score above 0.5.,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score
ORDER BY s.score DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $score > 0.5;
  $u has screen_name $sn;
sort $score desc;
limit 3;
fetch { ""screen_name"": $sn, ""score"": $score };"
twitter,394,Show the top 5 users that have posted tweets using the source 'Buffer'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN u.screen_name AS user, count(t) AS tweets
ORDER BY tweets DESC
LIMIT 5","match
  $u isa user, has screen_name $sn;
  posts (author: $u, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name ""Buffer"";
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""tweets"": $count };"
twitter,395,Which tweets have been retweeted by 'neo4j' and contain a hashtag?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)-[:TAGS]->(:Hashtag)
RETURN retweetedTweet","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  tags (tagged_tweet: $retweetedTweet, tag: $h);
  $retweetedTweet has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,396,"List the first 3 tweets from users who follow more than 10,000 users.","MATCH (u:User)-[:POSTS]->(t:Tweet)
WHERE u.following > 10000
RETURN u.screen_name, t.text
ORDER BY t.created_at
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $following > 10000;
  posts (author: $u, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at asc;
limit 3;
fetch { ""screen_name"": $sn, ""text"": $text };"
twitter,397,Show the first 3 users followed by 'neo4j' who also follow 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)-[:FOLLOWS]->(me)
RETURN follower
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  follows (follower: $me, followed: $follower);
  $follower has screen_name $sn, has name $name;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,398,What are the top 5 tweets by 'neo4j' with the most replies?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists {(tweet)<-[:REPLY_TO]-(:Tweet)}
WITH tweet, count{(tweet)<-[:REPLY_TO]-(:Tweet)} AS replies
RETURN tweet.text AS tweet, replies
ORDER BY replies DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $reply, original_tweet: $tweet);
  $tweet has text $text;
reduce $count = count($reply) groupby $text;
sort $count desc;
limit 5;
fetch { ""tweet"": $text, ""replies"": $count };"
twitter,399,Find all users who follow 'neo4j' and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'}) 
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,400,Which tweets posted by 'neo4j' have been retweeted by other users?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)<-[:RETWEETS]-(:Tweet) }
RETURN tweet.text, tweet.created_at
ORDER BY tweet.created_at DESC","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  $tweet has text $text, has created_at $created_at;
sort $created_at desc;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,401,Show the top 5 tweets that reply to another tweet and contain a link.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE exists{ (t)-[:CONTAINS]->(:Link) }
RETURN t.text AS tweet_text, t.created_at AS created_at
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has created_at $created_at, has favorites $favorites;
  reply_to (replying_tweet: $t, original_tweet: $orig);
  contains (containing_tweet: $t, contained_link: $l);
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""created_at"": $created_at };"
twitter,402,Find the first 3 users who follow 'neo4j' and have a betweenness greater than 100 million.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.betweenness > 1E8
RETURN u
LIMIT 3","match
  $u isa user, has screen_name $sn, has name $name, has betweenness $betweenness;
  $betweenness > 100000000.0;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,403,List the first 3 tweets by 'neo4j' that have been tagged with a hashtag and mention another user.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:TAGS]->(:Hashtag) } 
  AND exists{ (tweet)-[:MENTIONS]->(:User) }
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $h);
  mentions (source_tweet: $tweet, mentioned_user: $u);
  $tweet has text $text;
limit 3;
fetch { ""text"": $text };"
twitter,404,Which users followed by 'neo4j' have posted tweets mentioning 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(follower:User)-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(me) 
RETURN follower.screen_name AS follower, tweet.text AS tweet","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $follower);
  posts (author: $follower, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $me);
  $follower has screen_name $sn;
  $tweet has text $text;
fetch { ""follower"": $sn, ""tweet"": $text };"
twitter,405,Show the tweets that 'neo4j' has retweeted from users with a lower follower count.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)<-[:POSTS]-(user:User)
WHERE user.followers < me.followers
RETURN user.screen_name, retweeted.text","match
  $me isa me, has screen_name ""neo4j"", has followers $me_followers;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
  posts (author: $user, content: $retweeted);
  $user has screen_name $sn, has followers $u_followers;
  $u_followers < $me_followers;
  $retweeted has text $text;
fetch { ""screen_name"": $sn, ""text"": $text };"
twitter,406,What are the top 5 locations of users who interact with 'neo4j'?,"MATCH (u:User)-[:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL
RETURN u.location, count(*) AS num_users
ORDER BY num_users DESC
LIMIT 5","match
  $u isa user, has location $location;
  $me isa me, has screen_name ""neo4j"";
  interacts_with (interactor: $u, target: $me);
reduce $count = count($u) groupby $location;
sort $count desc;
limit 5;
fetch { ""location"": $location, ""num_users"": $count };"
twitter,408,Find the first 3 users who have retweeted tweets posted by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
RETURN DISTINCT retweeter.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
  posts (author: $retweeter, content: $retweet);
  $retweeter has screen_name $sn;
limit 3;
fetch { ""screen_name"": $sn };"
twitter,409,Which tweets posted by 'neo4j' mention a user with a follower count greater than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE mentioned.followers > me.followers
RETURN tweet.text, mentioned.screen_name, mentioned.followers","match
  $me isa me, has screen_name ""neo4j"", has followers $me_followers;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn, has followers $m_followers;
  $m_followers > $me_followers;
  $tweet has text $text;
fetch { ""text"": $text, ""screen_name"": $sn, ""followers"": $m_followers };"
twitter,410,Display the first 3 tweets by 'neo4j' that use the source 'Buffer'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name ""Buffer"";
  $tweet has text $text;
limit 3;
fetch { ""text"": $text };"
twitter,411,Who are the top 5 users followed by 'neo4j' with the highest betweenness?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.betweenness AS betweenness
ORDER BY followed.betweenness DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""user"": $sn, ""betweenness"": $betweenness };"
twitter,412,List the first 3 tweets where 'neo4j' is mentioned and the tweet has been favorited more than 50 times.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.favorites > 50
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $favorites > 50;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,413,What are the top 5 hashtags in tweets retweeted by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  tags (tagged_tweet: $retweetedTweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($retweetedTweet) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,414,Find all tweets from users who follow 'neo4j' and list the top 5.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
$neo4j isa user, has screen_name ""neo4j"";
$u isa user;
follows (follower: $u, followed: $neo4j);
$t isa tweet, has text $txt, has favorites $fav;
posts (author: $u, content: $t);
sort $fav desc;
limit 5;
fetch { ""text"": $txt, ""favorites"": $fav };"
twitter,415,Which users followed by 'neo4j' have a higher status count than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > me.statuses
RETURN u.screen_name, u.statuses","match
  $me isa me, has screen_name ""neo4j"", has statuses $me_statuses;
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has statuses $u_statuses;
  $u_statuses > $me_statuses;
fetch { ""screen_name"": $sn, ""statuses"": $u_statuses };"
twitter,416,Show the first 3 tweets from users who have interacted with 'neo4j'.,"MATCH (u:User)-[:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
MATCH (u)-[:POSTS]->(t:Tweet)
RETURN u.screen_name, t.text
ORDER BY t.created_at
LIMIT 3","match
  $u isa user, has screen_name $sn;
  $me isa me, has screen_name ""neo4j"";
  interacts_with (interactor: $u, target: $me);
  posts (author: $u, content: $t);
  $t has text $text, has created_at $created_at;
sort $created_at asc;
limit 3;
fetch { ""screen_name"": $sn, ""text"": $text };"
twitter,417,List the first 3 users similar to 'neo4j' with a similarity score below 0.5.,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score < 0.5
RETURN u.screen_name, s.score
ORDER BY s.score
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $score < 0.5;
  $u has screen_name $sn;
sort $score asc;
limit 3;
fetch { ""screen_name"": $sn, ""score"": $score };"
twitter,418,Which tweets posted by 'neo4j' have been tagged with 'education'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag {name: 'education'})
RETURN tweet.text","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name ""education"";
  $tweet has text $text;
fetch { ""text"": $text };"
twitter,420,Find the first 3 tweets by 'neo4j' that reply to another tweet.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:REPLY_TO]->(replied_to:Tweet)
RETURN t, replied_to
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  reply_to (replying_tweet: $t, original_tweet: $replied_to);
  $t has text $text1, has tweet_id $id1;
  $replied_to has text $text2, has tweet_id $id2;
limit 3;
fetch { ""tweet_id"": $id1, ""text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
twitter,421,Who are the top 5 users that 'neo4j' mentions the most in tweets?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.screen_name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has screen_name $sn;
reduce $count = count($tweet) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""mentions"": $count };"
twitter,422,List all tweets by 'neo4j' that have more than 200 favorites and show the first 5.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE t.favorites > 200
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has favorites $favorites;
  $favorites > 200;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,423,Which users does 'neo4j' amplify the most and list the top 5?,"MATCH (me:Me {screen_name: 'neo4j'})-[a:AMPLIFIES]->(u:User)
RETURN u.screen_name AS user, count(a) AS amplifications
ORDER BY amplifications DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $a isa amplifies (amplifier: $me, amplified_user: $u);
  $u has screen_name $sn;
reduce $count = count($a) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""amplifications"": $count };"
twitter,424,Find the first 3 users who have mentioned 'neo4j' in tweets and follow 'neo4j'.,"MATCH (u:User)-[:MENTIONS]->(:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(u)
RETURN u.name, u.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $u isa user, has name $name, has screen_name $sn;
  mentions (source_tweet: $t, mentioned_user: $me);
  posts (author: $u, content: $t);
  follows (follower: $u, followed: $me);
limit 3;
fetch { ""name"": $name, ""screen_name"": $sn };"
twitter,426,Who are the top 5 users that 'neo4j' retweets the most?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)<-[:POSTS]-(retweetedUser:User)
RETURN retweetedUser.screen_name AS retweeted_user, count(*) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  posts (author: $retweetedUser, content: $retweetedTweet);
  $retweetedUser has screen_name $sn;
reduce $count = count($tweet) groupby $sn;
sort $count desc;
limit 5;
fetch { ""retweeted_user"": $sn, ""retweet_count"": $count };"
twitter,427,Show the tweets where 'neo4j' is mentioned and the tweet has a favorite count over 100.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'}) 
WHERE t.favorites > 100
RETURN t","match
  $t isa tweet, has text $text, has tweet_id $id, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $favorites > 100;
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
twitter,428,Find all users who mention 'neo4j' in their tweets and are located in 'Graphs Are Everywhere'.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE u.location = 'Graphs Are Everywhere'
RETURN u","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
  posts (author: $u, content: $t);
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,429,Which tweets by 'neo4j' have been retweeted more than 50 times?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.favorites > 50
RETURN tweet.text, tweet.favorites","match
$me isa me, has screen_name ""neo4j"";
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 50;
fetch {
  ""tweet"": $tweet.text,
  ""retweets"": $count
};"
twitter,430,List the first 3 users followed by 'neo4j' who have posted a tweet with more than 50 favorites.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)-[:POSTS]->(tweet:Tweet)
WHERE tweet.favorites > 50
RETURN followed.screen_name, tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  posts (author: $followed, content: $tweet);
  $tweet has favorites $favorites, has text $text;
  $favorites > 50;
  $followed has screen_name $sn;
sort $favorites desc;
limit 3;
fetch { ""screen_name"": $sn, ""text"": $text, ""favorites"": $favorites };"
twitter,432,Find the first 3 users who have amplified tweets posted by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)<-[:AMPLIFIES]-(user:User)
RETURN user.screen_name, user.name
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $rt);
$user isa user, has screen_name $sn, has name $n;
posts (author: $user, content: $rt);
limit 3;
fetch { ""screen_name"": $sn, ""name"": $n };"
twitter,433,What are the top 5 sources used in tweets that mention 'neo4j'?,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'}), 
      (t)-[:USING]->(s:Source)
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
  $t isa tweet;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""source"": $name, ""tweet_count"": $count };"
twitter,434,List all tweets by 'neo4j' that reply to another tweet and contain a hashtag.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE EXISTS {(t)-[:REPLY_TO]->(:Tweet)}
  AND EXISTS {(t)-[:TAGS]->(:Hashtag)}
RETURN t","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  reply_to (replying_tweet: $t, original_tweet: $rt);
  tags (tagged_tweet: $t, tag: $h);
  $t has text $text, has tweet_id $id;
fetch { ""tweet_id"": $id, ""text"": $text };"
twitter,436,Show the first 3 tweets from 'neo4j' that have been amplified by other users.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)<-[:RETWEETS]-(:Tweet) }
RETURN tweet.text, tweet.created_at
ORDER BY tweet.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  $tweet has text $text, has created_at $created_at;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""created_at"": $created_at };"
twitter,438,Which users followed by 'neo4j' have a location of 'Graphs Are Everywhere' and list the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.location = 'Graphs Are Everywhere'
RETURN u.screen_name, u.location
ORDER BY u.followers DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  $u has location ""Graphs Are Everywhere"", has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""location"": ""Graphs Are Everywhere"" };"
twitter,439,List the first 3 users who follow 'neo4j' and have been mentioned in tweets by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
WHERE EXISTS {
  (me)-[:POSTS]->(:Tweet)-[:MENTIONS]->(follower)
}
RETURN follower.screen_name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $follower);
  $follower has screen_name $sn;
limit 3;
fetch { ""screen_name"": $sn };"
twitter,441,Find all tweets that 'neo4j' has retweeted from users located in 'Graphs Are Everywhere' and show the first 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted_tweet:Tweet)<-[:POSTS]-(user:User {location: 'Graphs Are Everywhere'})
RETURN retweeted_tweet.text, user.screen_name
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweeted_tweet);
  posts (author: $user, content: $retweeted_tweet);
  $user has location ""Graphs Are Everywhere"", has screen_name $sn;
  $retweeted_tweet has text $text;
limit 5;
fetch { ""text"": $text, ""screen_name"": $sn };"
twitter,442,Which users followed by 'neo4j' have tweeted using the source 'Buffer' and list the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:USING]->(s:Source {name: 'Buffer'})
RETURN u.screen_name, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  posts (author: $u, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name ""Buffer"";
  $u has screen_name $sn;
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 5;
fetch { ""screen_name"": $sn, ""tweet_count"": $count };"
twitter,443,List the first 3 tweets from 'neo4j' that contain links to external websites.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t.text, l.url
ORDER BY t.created_at DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  contains (containing_tweet: $t, contained_link: $l);
  $t has text $text, has created_at $created_at;
  $l has link_url $url;
sort $created_at desc;
limit 3;
fetch { ""text"": $text, ""url"": $url };"
twitter,444,What are the names of the top 5 users with the highest number of followers?,"MATCH (u:User)
RETURN u.name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has name $name, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""name"": $name, ""followers"": $followers };"
twitter,445,List the top 3 tweets with the most favorites.,"MATCH (t:Tweet)
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,446,Which users are followed by 'Neo4j' and have more than 1000 followers?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.followers > 1000
RETURN u.screen_name, u.followers","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has followers $followers;
  $followers > 1000;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,447,Find the top 5 users with the highest betweenness centrality.,"MATCH (u:User)
WHERE u.betweenness IS NOT NULL
RETURN u.screen_name, u.betweenness
ORDER BY u.betweenness DESC
LIMIT 5","match
  $u isa user, has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 5;
fetch { ""screen_name"": $sn, ""betweenness"": $betweenness };"
twitter,448,Who are the top 3 users that 'Neo4j' interacts with most frequently?,"MATCH (me:Me {screen_name: 'neo4j'})-[i:INTERACTS_WITH]->(u:User)
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $me, target: $u);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,449,What are the names of the top 3 hashtags used in tweets by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  tags (tagged_tweet: $tweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,450,Which sources are used in the top 5 most favorited tweets?,"MATCH (t:Tweet)-[:USING]->(s:Source)
WITH t, s
ORDER BY t.favorites DESC
LIMIT 5
RETURN DISTINCT s.name AS source","match
  $t isa tweet, has favorites $favorites;
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
sort $favorites desc;
limit 5;
fetch { ""source"": $name };"
twitter,451,List the top 3 tweets that mention 'Neo4j' and have more than 100 favorites.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {screen_name: 'neo4j'})
WHERE t.favorites > 100
RETURN t.text, t.favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
  $favorites > 100;
sort $favorites desc;
limit 3;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,452,What are the locations of the top 5 users by number of statuses posted?,"MATCH (u:User)
WHERE u.location IS NOT NULL
RETURN u.location, u.statuses
ORDER BY u.statuses DESC
LIMIT 5","match
  $u isa user, has location $location, has statuses $statuses;
sort $statuses desc;
limit 5;
fetch { ""location"": $location, ""statuses"": $statuses };"
twitter,453,Who has 'Neo4j' retweeted the most? List the top 3 users.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweet:Tweet)<-[:POSTS]-(user:User)
RETURN user.screen_name AS retweeted_user, count(*) AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweet);
  posts (author: $user, content: $retweet);
  $user has screen_name $sn;
reduce $count = count($tweet) groupby $sn;
sort $count desc;
limit 3;
fetch { ""retweeted_user"": $sn, ""retweet_count"": $count };"
twitter,454,Find the top 5 tweets with links and sort them by number of favorites.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN t, l
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has tweet_id $id, has favorites $favorites;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
sort $favorites desc;
limit 5;
fetch { ""tweet_id"": $id, ""text"": $text, ""url"": $url, ""favorites"": $favorites };"
twitter,455,What are the screen names of the top 3 users who have posted the most tweets?,"MATCH (u:User)-[:POSTS]->(t:Tweet)
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3
RETURN u.screen_name AS screen_name, tweet_count","match
  $u isa user, has screen_name $sn;
  posts (author: $u, content: $t);
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 3;
fetch { ""screen_name"": $sn, ""tweet_count"": $count };"
twitter,456,Which hashtags have been tagged in tweets that have more than 200 favorites? List the top 3.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.favorites > 200
RETURN h.name AS hashtag, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3","match
  $t isa tweet, has favorites $favorites;
  $favorites > 200;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""tweet_count"": $count };"
twitter,457,List the top 3 users with the lowest following counts who follow 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.following IS NOT NULL
RETURN u.screen_name, u.following
ORDER BY u.following
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $following asc;
limit 3;
fetch { ""screen_name"": $sn, ""following"": $following };"
twitter,458,Which users have a similar score greater than 0.5 with 'Neo4j'? List the top 3.,"MATCH (me:Me {name: 'Neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.name, s.score
ORDER BY s.score DESC
LIMIT 3","match
  $me isa me, has name ""Neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $score > 0.5;
  $u has name $name;
sort $score desc;
limit 3;
fetch { ""name"": $name, ""score"": $score };"
twitter,459,Who are the top 5 most followed users that 'Neo4j' amplifies?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)
RETURN u.screen_name AS user, u.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  amplifies (amplifier: $me, amplified_user: $u);
  $u has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""user"": $sn, ""followerCount"": $followers };"
twitter,460,List the profile image URLs of the top 3 users who have mentioned 'Neo4j' in their tweets.,"MATCH (u:User)-[:POSTS]->(t:Tweet)-[:MENTIONS]->(:Me {name: 'Neo4j'})
WITH u, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN u.profile_image_url","match
  $u isa user, has profile_image_url $img;
  posts (author: $u, content: $t);
  $me isa me, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
reduce $count = count($t) groupby $img;
sort $count desc;
limit 3;
fetch { ""profile_image_url"": $img };"
twitter,461,What are the URLs of the top 3 most favorited tweets containing links?,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
RETURN l.url AS url, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $t isa tweet, has favorites $favorites;
  contains (containing_tweet: $t, contained_link: $l);
  $l has link_url $url;
sort $favorites desc;
limit 3;
fetch { ""url"": $url, ""favorites"": $favorites };"
twitter,462,Who are the top 3 followers of 'Neo4j' based on betweenness centrality?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:FOLLOWS]-(follower:User)
WHERE follower.betweenness IS NOT NULL
RETURN follower.screen_name AS follower, follower.betweenness AS betweenness
ORDER BY follower.betweenness DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $follower, followed: $me);
  $follower has screen_name $sn, has betweenness $betweenness;
sort $betweenness desc;
limit 3;
fetch { ""follower"": $sn, ""betweenness"": $betweenness };"
twitter,463,List the names of the top 5 tweets that reply to another tweet and have more than 50 favorites.,"MATCH (t:Tweet)-[:REPLY_TO]->(:Tweet)
WHERE t.favorites > 50
RETURN t.text AS tweet_text
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  $favorites > 50;
  reply_to (replying_tweet: $t, original_tweet: $rt);
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text };"
twitter,464,What are the top 3 locations where users who interact with 'Neo4j' are based?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
WHERE u.location IS NOT NULL
RETURN u.location, count(*) AS num_users
ORDER BY num_users DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  interacts_with (interactor: $u, target: $me);
  $u has location $location;
reduce $count = count($u) groupby $location;
sort $count desc;
limit 3;
fetch { ""location"": $location, ""num_users"": $count };"
twitter,465,Which users followed by 'Neo4j' have posted the most about a specific hashtag? List the top 3.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE h.name = 'education'
WITH u, count(t) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 3
RETURN u.screen_name AS user, tweet_count","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  posts (author: $u, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
  $u has screen_name $sn;
reduce $count = count($t) groupby $sn;
sort $count desc;
limit 3;
fetch { ""user"": $sn, ""tweet_count"": $count };"
twitter,466,Find the top 5 tweets by 'Neo4j' using a specific source.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source)
RETURN tweet.text AS tweet, source.name AS source
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $tweet has text $text, has favorites $favorites;
  $source has source_name $name;
sort $favorites desc;
limit 5;
fetch { ""tweet"": $text, ""source"": $name };"
twitter,467,What are the top 3 hashtags used in the tweets that have been retweeted by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)-[:TAGS]->(hashtag:Hashtag)
RETURN hashtag.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  tags (tagged_tweet: $retweetedTweet, tag: $hashtag);
  $hashtag has hashtag_name $name;
reduce $count = count($retweetedTweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,468,List the top 3 tweets from 'Neo4j' that have been retweeted more than 100 times.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE tweet.favorites > 100
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
reduce $count = count groupby $tweet;
match
$count > 100;
sort $count desc;
limit 3;
fetch {
  ""tweet"": $tweet.text,
  ""retweets"": $count
};"
twitter,469,Which users have 'Neo4j' mentioned the most in tweets? List the top 3.,"MATCH (u:User)<-[:MENTIONS]-(t:Tweet)<-[:POSTS]-(:Me {name: 'Neo4j'})
RETURN u.name AS user, count(t) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $me isa me, has name ""Neo4j"";
  posts (author: $me, content: $t);
  mentions (source_tweet: $t, mentioned_user: $u);
  $u has name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""mentions"": $count };"
twitter,470,Find the top 5 users who follow 'Neo4j' and are from the same location as 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(:Me {screen_name: 'neo4j'})
WHERE u.location IS NOT NULL AND u.location = 'Graphs Are Everywhere'
RETURN u.screen_name, u.name, u.followers
ORDER BY u.followers DESC
LIMIT 5","match
  $u isa user, has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name, has followers $followers;
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $u, followed: $me);
sort $followers desc;
limit 5;
fetch { ""screen_name"": $sn, ""name"": $name, ""followers"": $followers };"
twitter,471,List the names of the top 5 users who have the highest scores of being similar to 'Neo4j'.,"MATCH (me:Me {name: 'Neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.name AS name, s.score AS similarity
ORDER BY similarity DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  $s isa similar_to (source_user: $u, similar_user: $me), has score $score;
  $u has name $name;
sort $score desc;
limit 5;
fetch { ""name"": $name, ""similarity"": $score };"
twitter,472,Who are the top 3 users that 'Neo4j' follows and have tweeted more than 500 times?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(u:User)
WHERE u.statuses > 500
RETURN u.screen_name, u.statuses
ORDER BY u.statuses DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $u);
  $u has screen_name $sn, has statuses $statuses;
  $statuses > 500;
sort $statuses desc;
limit 3;
fetch { ""screen_name"": $sn, ""statuses"": $statuses };"
twitter,473,Who are the top 5 users that a specific user named 'Neo4j' follows?,"MATCH (me:User {name: 'Neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.name, followed.screen_name, followed.followers
ORDER BY followed.followers DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has name $name, has screen_name $sn, has followers $followers;
sort $followers desc;
limit 5;
fetch { ""name"": $name, ""screen_name"": $sn, ""followers"": $followers };"
twitter,474,List the first 3 users followed by a user with the screen name 'thobe'.,"MATCH (u:User {screen_name: 'thobe'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name, followed.name
LIMIT 3","match
  $u isa user, has screen_name ""thobe"";
  follows (follower: $u, followed: $followed);
  $followed has screen_name $sn, has name $name;
limit 3;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,475,What are the top 3 tweets posted by the user with the screen name 'neo4j'?,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  $t has text $text, has favorites $favorites;
sort $favorites desc;
limit 3;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,476,Which users have a betweenness greater than 300000000?,"MATCH (u:User)
WHERE u.betweenness > 300000000
RETURN u","match
  $u isa user, has screen_name $sn, has name $name, has betweenness $betweenness;
  $betweenness > 300000000;
fetch { ""screen_name"": $sn, ""name"": $name, ""betweenness"": $betweenness };"
twitter,477,Identify the first 3 users followed by 'Neo4j' who have more than 500 followers.,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
WHERE followed.followers > 500
RETURN followed.screen_name, followed.followers
ORDER BY followed.followers DESC
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $followed);
  $followed has screen_name $sn, has followers $followers;
  $followers > 500;
sort $followers desc;
limit 3;
fetch { ""screen_name"": $sn, ""followers"": $followers };"
twitter,478,List the top 5 tweets that mention the user with the screen name 'neo4j'.,"MATCH (t:Tweet)-[:MENTIONS]->(u:User {screen_name: 'neo4j'})
RETURN t.text AS tweet_text, t.favorites AS favorites
ORDER BY t.favorites DESC
LIMIT 5","match
  $t isa tweet, has text $text, has favorites $favorites;
  $me isa me, has screen_name ""neo4j"";
  mentions (source_tweet: $t, mentioned_user: $me);
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""favorites"": $favorites };"
twitter,479,What are the top 5 hashtags used in tweets by the user named 'Neo4j'?,"MATCH (u:User {name: 'Neo4j'})-[:POSTS]->(t:Tweet)-[:TAGS]->(h:Hashtag)
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $me isa me, has name ""Neo4j"";
  posts (author: $me, content: $t);
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name $name;
reduce $count = count($t) groupby $name;
sort $count desc;
limit 5;
fetch { ""hashtag"": $name, ""count"": $count };"
twitter,480,List the first 3 sources used in tweets posted by 'Neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)-[:USING]->(s:Source)
RETURN DISTINCT s.name
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $t);
  using (tweet_content: $t, platform: $s);
  $s has source_name $name;
limit 3;
fetch { ""name"": $name };"
twitter,481,Who are the top 5 users interacting with 'Neo4j' via the INTERACTS_WITH relationship?,"MATCH (u:User)-[i:INTERACTS_WITH]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name AS user, count(i) AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $u, target: $me);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,482,Which users are similar to 'Neo4j' with a similarity score above 0.5?,"MATCH (me:Me {screen_name: 'neo4j'})-[s:SIMILAR_TO]->(u:User)
WHERE s.score > 0.5
RETURN u.screen_name, s.score","match
  $me isa me, has screen_name ""neo4j"";
  $s isa similar_to (source_user: $me, similar_user: $u), has score $score;
  $score > 0.5;
  $u has screen_name $sn;
fetch { ""screen_name"": $sn, ""score"": $score };"
twitter,483,Show the first 3 tweets that 'Neo4j' retweets.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet)-[:RETWEETS]->(retweetedTweet)
RETURN retweetedTweet.text AS retweeted_tweet_text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  $retweetedTweet has text $text;
limit 3;
fetch { ""retweeted_tweet_text"": $text };"
twitter,484,Which users are amplified by 'Me' according to the AMPLIFIES relationship?,"MATCH (me:Me)-[:AMPLIFIES]->(u:User)
RETURN u.name AS user, u.screen_name AS handle","match
  $me isa me;
  amplifies (amplifier: $me, amplified_user: $u);
  $u has name $name, has screen_name $sn;
fetch { ""user"": $name, ""handle"": $sn };"
twitter,485,List the top 3 users who follow 'Me' and also have a following count over 10000.,"MATCH (u:User)-[:FOLLOWS]->(:Me)
WHERE u.following > 10000
RETURN u.screen_name, u.following
ORDER BY u.following DESC
LIMIT 3","match
  $u isa user, has screen_name $sn, has following $following;
  $following > 10000;
  $me isa me;
  follows (follower: $u, followed: $me);
sort $following desc;
limit 3;
fetch { ""screen_name"": $sn, ""following"": $following };"
twitter,486,Who are the top 3 users mentioned in tweets posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
RETURN mentioned.name AS user, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  $mentioned has name $name;
reduce $count = count($tweet) groupby $name;
sort $count desc;
limit 3;
fetch { ""user"": $name, ""mentions"": $count };"
twitter,487,What are the first 3 links contained in tweets posted by 'Me'?,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
RETURN link.url
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  contains (containing_tweet: $tweet, contained_link: $link);
  $link has link_url $url;
limit 3;
fetch { ""url"": $url };"
twitter,488,Identify the first 3 tweets posted by 'Me' that reply to another tweet.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:REPLY_TO]->(repliedTo:Tweet)
RETURN tweet, repliedTo
ORDER BY tweet.created_at
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  reply_to (replying_tweet: $tweet, original_tweet: $repliedTo);
  $tweet has text $text1, has tweet_id $id1, has created_at $created_at;
  $repliedTo has text $text2, has tweet_id $id2;
sort $created_at asc;
limit 3;
fetch { ""tweet_id"": $id1, ""text"": $text1, ""replied_to_id"": $id2, ""replied_to_text"": $text2 };"
twitter,489,List the top 5 tweets by 'Me' using a specific source named 'Buffer'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:USING]->(source:Source {name: 'Buffer'})
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me;
  posts (author: $me, content: $tweet);
  using (tweet_content: $tweet, platform: $source);
  $source has source_name ""Buffer"";
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,490,Which users does 'Neo4j' follow that have a location set to 'Graphs Are Everywhere'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(user:User)
WHERE user.location = 'Graphs Are Everywhere'
RETURN user","match
  $me isa me, has screen_name ""neo4j"";
  follows (follower: $me, followed: $user);
  $user has location ""Graphs Are Everywhere"", has screen_name $sn, has name $name;
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,491,List the first 3 tweets containing a hashtag named 'education'.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
RETURN t.text AS tweet_text
LIMIT 3","match
  $t isa tweet, has text $text;
  tags (tagged_tweet: $t, tag: $h);
  $h has hashtag_name ""education"";
limit 3;
fetch { ""tweet_text"": $text };"
twitter,492,Who are the top 5 users that 'Neo4j' interacts with and also follows?,"MATCH (me:Me {screen_name: 'neo4j'})-[:INTERACTS_WITH]->(u:User)
WHERE (me)-[:FOLLOWS]->(u)
RETURN u.screen_name as user, count(u) as interactions
ORDER BY interactions DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  $i isa interacts_with (interactor: $me, target: $u);
  follows (follower: $me, followed: $u);
  $u has screen_name $sn;
reduce $count = count($i) groupby $sn;
sort $count desc;
limit 5;
fetch { ""user"": $sn, ""interactions"": $count };"
twitter,42,List the top 3 tweets that retweet content from Neo4j.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)
WHERE me.screen_name IS NOT NULL
RETURN tweet.text AS tweet_text, retweeted.text AS retweeted_text, tweet.favorites AS favorites
ORDER BY tweet.favorites DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$original_tweet isa tweet;
$retweeting_tweet isa tweet, has favorites $f;
posts (author: $me, content: $original_tweet);
retweets (original_tweet: $original_tweet, retweeting_tweet: $retweeting_tweet);
sort $f desc;
limit 3;
fetch { ""tweet_text"": $retweeting_tweet.text, ""retweeted_text"": $original_tweet.text, ""favorites"": $f };"
twitter,44,Find the top 5 tweets by Neo4j that have been retweeted and mention another user.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:MENTIONS]->(:User) }
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet, has favorites $f;
$mentioned isa user;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet);
mentions (source_tweet: $tweet, mentioned_user: $mentioned);
sort $f desc;
limit 5;
fetch { ""text"": $tweet.text, ""favorites"": $f };"
twitter,75,Identify the top 3 users who have amplified the most tweets.,"MATCH (u:User)<-[:AMPLIFIES]-(me:Me)
WITH u, count(me) AS amplifications
ORDER BY amplifications DESC
LIMIT 3
RETURN u.name AS user, amplifications","match
$me isa me, has name $n;
amplifies (amplifier: $me, amplified_user: $u);
reduce $count = count($u) groupby $n;
sort $count desc;
limit 3;
fetch { ""user"": $n, ""amplifications"": $count };"
twitter,77,List the first 3 tweets that mention the user with the highest betweenness.,"MATCH (u:User)-[:MENTIONS]-(t:Tweet)
WHERE u.betweenness IS NOT NULL
WITH u, t
ORDER BY u.betweenness DESC
LIMIT 1
MATCH (t2:Tweet)-[:MENTIONS]->(u) 
RETURN t2.text
LIMIT 3","with fun max_betweenness() -> double:
  match $u isa user, has betweenness $b;
  return max($b);
match
$u isa user, has betweenness $b;
$b == max_betweenness();
$t isa tweet;
mentions (source_tweet: $t, mentioned_user: $u);
limit 3;
fetch { ""text"": $t.text };"
twitter,101,Which users have retweeted 'neo4j''s tweets the most?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)<-[:RETWEETS]-(retweet:Tweet)<-[:POSTS]-(retweeter:User)
RETURN retweeter.screen_name AS retweeter, count(*) AS retweets
ORDER BY retweets DESC
LIMIT 10","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$retweet isa tweet;
$retweeter isa user;
posts (author: $me, content: $tweet);
retweets (retweeting_tweet: $retweet, original_tweet: $tweet);
posts (author: $retweeter, content: $retweet);
reduce $retweets = count($retweet) groupby $retweeter;
sort $retweets desc;
limit 10;
fetch { ""retweeter"": $retweeter.screen_name, ""retweets"": $retweets };"
twitter,106,What are the profile URLs of the top 3 users followed by 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.profile_image_url
ORDER BY followed.followers DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$followed isa user, has followers $f;
follows (follower: $me, followed: $followed);
sort $f desc;
limit 3;
fetch { ""url"": $followed.url };"
twitter,114,Find the top 3 tweets with the most retweets made by 'neo4j'.,"MATCH (u:User {screen_name: 'neo4j'})-[:POSTS]->(t:Tweet)
WHERE exists{ (t)-[:RETWEETS]->(:Tweet) }
RETURN t.text AS tweet_text, count{(t)-[:RETWEETS]->(:Tweet)} AS retweet_count
ORDER BY retweet_count DESC
LIMIT 3","match
$u isa user, has screen_name ""neo4j"";
$t isa tweet;
$rt isa tweet;
posts (author: $u, content: $t);
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $retweet_count = count($rt) groupby $t;
sort $retweet_count desc;
limit 3;
fetch { ""tweet_text"": $t.text, ""retweet_count"": $retweet_count };"
twitter,118,What are the locations of the top 3 users who interact with 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:INTERACTS_WITH]-(u:User)
WHERE u.location IS NOT NULL
RETURN u.location AS location, count(*) AS interactions
ORDER BY interactions DESC
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$u isa user, has location $loc;
$i isa interacts_with (interactor: $u, target: $me);
reduce $interactions = count($i) groupby $u;
sort $interactions desc;
limit 3;
fetch { ""location"": $u.location, ""interactions"": $interactions };"
twitter,129,Which tweets by 'neo4j' have been retweeted and also contain a link?,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:CONTAINS]->(:Link) }
RETURN tweet.text, tweet.created_at","match
$me isa me, has screen_name ""neo4j"";
$tweet isa tweet;
$l isa link;
posts (author: $me, content: $tweet);
retweets (original_tweet: $tweet);
contains (containing_tweet: $tweet, contained_link: $l);
fetch { ""text"": $tweet.text, ""created_at"": $tweet.created_at };"
twitter,136,List the tweets by 'neo4j' that have been retweeted by more than 5 different users.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE count{(tweet)<-[:RETWEETS]-(:Tweet)<-[:POSTS]-(:User)} > 5
RETURN tweet.text, count{(tweet)<-[:RETWEETS]-(:Tweet)<-[:POSTS]-(:User)} AS retweets","with fun retweeting_users($tweet: tweet) -> integer:
  match
    retweets (original_tweet: $tweet, retweeting_tweet: $retweet);
    posts (author: $retweeter, content: $retweet);
  select $retweeter;
  distinct;
  return count;
match
$me isa user, has screen_name ""neo4j"";
posts (author: $me, content: $tweet);
let $count = retweeting_users($tweet);
$count > 5;
fetch {
  ""tweet_text"": $tweet.text,
  ""retweets"": $count
};"
twitter,138,Find the top 3 tweets that mention 'neo4j' and are tagged with 'education'.,"MATCH (t:Tweet)-[:TAGS]->(:Hashtag {name: 'education'})
WHERE t.text CONTAINS 'neo4j'
RETURN t
ORDER BY t.favorites DESC
LIMIT 3","match
$t isa tweet, has favorites $f;
$h isa hashtag, has hashtag_name ""education"";
tags (tagged_tweet: $t, tag: $h);
$u isa user, has screen_name ""neo4j"";
mentions (source_tweet: $t, mentioned_user: $u);
sort $f desc;
limit 3;
fetch { ""text"": $t.text, ""tweet_id"": $t.tweet_id, ""created_at"": $t.created_at };"
twitter,163,Identify the top 5 tweets linking to the most popular external sources.,"MATCH (t:Tweet)-[:CONTAINS]->(l:Link)
WITH t, l.url AS url, count(*) AS link_count
ORDER BY link_count DESC
LIMIT 5
RETURN t.text AS tweet_text, url, link_count","with fun link_popularity($link: link) -> integer:
  match contains (contained_link: $link);
  return count;
match
$t isa tweet;
$l isa link;
contains (containing_tweet: $t, contained_link: $l);
let $link_count = link_popularity($l);
sort $link_count desc;
limit 5;
fetch { ""tweet_text"": $t.text, ""url"": $l.link_url, ""link_count"": $link_count };"
twitter,174,Which users are most similar to 'Neo4j' based on the SIMILAR_TO relationship score? Show the top 5.,"MATCH (me:Me {screen_name: 'neo4j'})<-[s:SIMILAR_TO]-(u:User)
RETURN u.screen_name AS similar_user, s.score AS similarity
ORDER BY s.score DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$u isa user;
$s isa similar_to (source_user: $me, similar_user: $u), has score $sc;
sort $sc desc;
limit 5;
fetch { ""similar_user"": $u.screen_name, ""similarity"": $sc };"
twitter,181,What are the top 5 sources used in tweets that have been retweeted more than 50 times?,"MATCH (t:Tweet)-[:USING]->(s:Source)
WHERE t.favorites > 50
RETURN s.name AS source, count(*) AS tweet_count
ORDER BY tweet_count DESC
LIMIT 5","match
$t isa tweet;
$s isa source;
using (tweet_content: $t, platform: $s);
retweets (original_tweet: $t, retweeting_tweet: $rt);
reduce $retweet_count = count($rt) groupby $t, $s;
match $retweet_count > 50;
reduce $tweet_count = count($t) groupby $s;
sort $tweet_count desc;
limit 5;
fetch { ""source"": $s.source_name, ""tweet_count"": $tweet_count };"
twitter,200,Which users have retweeted 'Neo4j' and have a profile image URL? List the first 3.,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)<-[:RETWEETS]-(retweeter:User)
WHERE retweeter.profile_image_url IS NOT NULL
RETURN retweeter.screen_name, retweeter.profile_image_url
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$original_tweet isa tweet;
$rt isa tweet;
$retweeter isa user, has profile_image_url $purl;
posts (author: $me, content: $original_tweet);
retweets (original_tweet: $original_tweet, retweeting_tweet: $rt);
posts (author: $retweeter, content: $rt);
limit 3;
fetch { ""screen_name"": $retweeter.screen_name, ""profile_image_url"": $purl };"
twitter,214,Identify the top 5 hashtags used in tweets that mention 'Neo4j' and were created in 2021.,"MATCH (t:Tweet)-[:TAGS]->(h:Hashtag)
WHERE t.text CONTAINS 'Neo4j' AND date(t.created_at) >= date('2021-01-01')
RETURN h.name AS hashtag, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$t isa tweet, has text $txt, has created_at $ca;
$h isa hashtag;
tags (tagged_tweet: $t, tag: $h);
$txt like ""%Neo4j%"";
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
reduce $count = count($t) groupby $h;
sort $count desc;
limit 5;
fetch { ""hashtag"": $h.hashtag_name, ""count"": $count };"
twitter,218,Identify the first 3 tweets that 'Neo4j' has amplified and were posted in 2021.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:MENTIONS]-(t:Tweet)
WHERE t.created_at >= date('2021-01-01') AND t.created_at < date('2022-01-01') 
RETURN t
ORDER BY t.created_at
LIMIT 3","match
$me isa me, has screen_name ""neo4j"";
$original isa tweet, has created_at $ca;
$retweet isa tweet;
posts (author: $me, content: $retweet);
retweets (retweeting_tweet: $retweet, original_tweet: $original);
$ca >= 2021-01-01T00:00:00;
$ca < 2022-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""text"": $original.text, ""created_at"": $ca };"
twitter,245,Which users with a location of 'Sweden' follow more than 10 users?,"MATCH (u:User)
WHERE u.location = 'Sweden' AND count{(u)-[:FOLLOWS]->(:User)} > 10
RETURN u","match
  $u isa user, has location ""Sweden"";
  follows (follower: $u, followed: $f);
reduce $count = count($f) groupby $u;
match $count > 10;
fetch { ""screen_name"": $u.screen_name, ""name"": $u.name, ""following_count"": $count };"
twitter,284,Display the first 3 tweets by 'Neo4j' that were amplified by 'Me'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User {screen_name: 'Neo4j'})<-[:POSTS]-(t:Tweet)
RETURN t.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  $u isa user, has screen_name ""Neo4j"";
  amplifies (amplifier: $me, amplified_user: $u);
  posts (author: $u, content: $t);
limit 3;
fetch { ""text"": $t.text };"
twitter,287,List all users who have both posted a tweet mentioning 'Neo4j' and have been mentioned by 'Neo4j' in a tweet.,"MATCH (u:User)
WHERE exists{ (u)-[:POSTS]->(:Tweet)-[:TAGS]->(:Hashtag {name: 'Neo4j'}) } 
  AND exists{ (:Tweet)-[:MENTIONS]->(u)<-[:POSTS]-(:Me {screen_name: 'neo4j'}) }
RETURN u","match
  $u isa user, has screen_name $sn, has name $name;
  $neo4j isa user, has screen_name ""neo4j"";
  posts (author: $u, content: $ut);
  mentions (source_tweet: $ut, mentioned_user: $neo4j);
  posts (author: $neo4j, content: $nt);
  mentions (source_tweet: $nt, mentioned_user: $u);
fetch { ""screen_name"": $sn, ""name"": $name };"
twitter,301,List all users who have been retweeted by 'Neo4j' at least twice.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweeted:Tweet)<-[:POSTS]-(user:User)
WITH user, count(retweeted) AS retweet_count
WHERE retweet_count >= 2
RETURN user.screen_name, retweet_count","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweeted);
  posts (author: $user, content: $retweeted);
  $user has screen_name $sn;
reduce $count = count($retweeted) groupby $user, $sn;
match $count >= 2;
fetch { ""screen_name"": $sn, ""retweet_count"": $count };"
twitter,305,Show the first 3 tweets mentioning 'Neo4j' that have been retweeted by 'Me'.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)-[:RETWEETS]->(retweetedTweet:Tweet)
WHERE retweetedTweet.text CONTAINS 'Neo4j'
RETURN retweetedTweet.text AS tweet_text
LIMIT 3","match
  $me isa me;
  posts (author: $me, content: $tweet);
  retweets (retweeting_tweet: $tweet, original_tweet: $retweetedTweet);
  mentions (source_tweet: $retweetedTweet, mentioned_user: $neo4j);
  $neo4j has screen_name ""Neo4j"";
  $retweetedTweet has text $text;
limit 3;
fetch { ""tweet_text"": $text };"
twitter,337,Which tweets have been replied to and have more than 50 favorites?,"MATCH (t:Tweet)-[:REPLY_TO]->(replied_to_tweet:Tweet)
WHERE t.favorites > 50
RETURN t, replied_to_tweet","match
  $t isa tweet, has favorites $favorites, has text $text, has tweet_id $id;
  $favorites > 50;
  reply_to (original_tweet: $t, replying_tweet: $reply);
fetch { ""tweet_id"": $id, ""text"": $text, ""favorites"": $favorites };"
twitter,350,List the 3 most recent tweets that mention 'Neo4j' and contain a link.,"MATCH (t:Tweet)-[:MENTIONS]->(:User {name: 'Neo4j'}), (t)-[:CONTAINS]->(:Link)
WHERE t.text CONTAINS 'Neo4j'
RETURN t.text AS tweet_text, t.created_at
ORDER BY t.created_at DESC
LIMIT 3","match
  $t isa tweet, has text $text, has created_at $created_at;
  $u isa user, has name ""Neo4j"";
  mentions (source_tweet: $t, mentioned_user: $u);
  contains (containing_tweet: $t, contained_link: $l);
sort $created_at desc;
limit 3;
fetch { ""tweet_text"": $text, ""created_at"": $created_at };"
twitter,390,Show the first 3 tweets that 'neo4j' has amplified.,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:POSTS]-(t:Tweet)
RETURN t.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  amplifies (amplifier: $me, amplified_user: $u);
  posts (author: $u, content: $t);
  $t has text $text;
limit 3;
fetch { ""text"": $text };"
twitter,407,List all tweets from 'neo4j' that have been amplified and show the first 5.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (me)-[:AMPLIFIES]->(:User) }
RETURN tweet.text
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet);
  $tweet has text $text;
limit 5;
fetch { ""text"": $text };"
twitter,419,Show the top 5 tweets that contain links and are retweeted by 'neo4j'.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:CONTAINS]->(link:Link)
WHERE exists{ (tweet)<-[:RETWEETS]-(:Tweet) }
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $rt);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  contains (containing_tweet: $tweet, contained_link: $link);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,425,List the first 3 tweets from 'neo4j' that have been retweeted and mention another user.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:MENTIONS]->(:User) }
RETURN tweet.text
LIMIT 3","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  mentions (source_tweet: $tweet, mentioned_user: $u);
limit 3;
fetch { ""text"": $tweet.text };"
twitter,431,Show the top 5 tweets by 'neo4j' that have been retweeted and contain a link.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:CONTAINS]->(:Link) }
RETURN tweet.text AS text, tweet.favorites AS favorites
ORDER BY favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  contains (containing_tweet: $tweet, contained_link: $l);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,435,Which users mentioned in 'neo4j' tweets have more following than 'neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})<-[:MENTIONS]-(tweet:Tweet)<-[:POSTS]-(user:User)
WHERE user.following > me.following
RETURN user.screen_name, user.following","match
  $me isa me, has screen_name ""neo4j"", has following $me_following;
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $user);
  $user has screen_name $sn, has following $u_following;
  $u_following > $me_following;
fetch { ""screen_name"": $sn, ""following"": $u_following };"
twitter,437,Find the top 5 tweets by 'neo4j' that mention another user and have been retweeted.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)-[:MENTIONS]->(mentioned:User)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) }
RETURN tweet.text AS tweet_text, mentioned.screen_name AS mentioned_user
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  mentions (source_tweet: $tweet, mentioned_user: $mentioned);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  $tweet has text $text, has favorites $favorites;
  $mentioned has screen_name $sn;
sort $favorites desc;
limit 5;
fetch { ""tweet_text"": $text, ""mentioned_user"": $sn };"
twitter,440,Show the top 5 tweets by 'neo4j' that have been retweeted and tag a hashtag.,"MATCH (me:Me {screen_name: 'neo4j'})-[:POSTS]->(tweet:Tweet)
WHERE exists{ (tweet)-[:RETWEETS]->(:Tweet) } 
  AND exists{ (tweet)-[:TAGS]->(:Hashtag) }
RETURN tweet.text, tweet.favorites
ORDER BY tweet.favorites DESC
LIMIT 5","match
  $me isa me, has screen_name ""neo4j"";
  posts (author: $me, content: $tweet);
  retweets (original_tweet: $tweet, retweeting_tweet: $rt);
  tags (tagged_tweet: $tweet, tag: $h);
  $tweet has text $text, has favorites $favorites;
sort $favorites desc;
limit 5;
fetch { ""text"": $text, ""favorites"": $favorites };"
twitter,308,Who are the top 5 most recent users followed by 'Neo4j'?,"MATCH (me:Me {screen_name: 'neo4j'})-[:FOLLOWS]->(followed:User)
RETURN followed.screen_name AS user, followed.followers AS followers
ORDER BY followed.followers DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$rel isa follows (follower: $me, followed: $followed);
$rel has followed_at $fa;
$followed has screen_name $sn;
sort $fa desc;
limit 5;
fetch {
  ""user"": $sn
};"
twitter,335,List the 5 most recent users who started following 'Neo4j'.,"MATCH (u:User)-[:FOLLOWS]->(me:Me {screen_name: 'neo4j'})
RETURN u.screen_name, u.name
ORDER BY u.following DESC
LIMIT 5","match
$me isa me, has screen_name ""neo4j"";
$f isa follows (follower: $u, followed: $me);
$f has followed_at $fa;
$u has screen_name $sn;
sort $fa desc;
limit 5;
fetch {
  ""screen_name"": $sn,
  ""name"": $u.name
};"
twitter,353,Which tweets have been amplified by 'Neo4j' and have more than 100 favorites?,"MATCH (me:Me {screen_name: 'neo4j'})-[:AMPLIFIES]->(u:User)<-[:MENTIONS]-(t:Tweet)
WHERE t.favorites > 100
RETURN t","match
$me isa me, has screen_name ""neo4j"";
amplifies (amplifier: $me, amplified_user: $u);
mentions (source_tweet: $t, mentioned_user: $u);
$t has favorites $fav;
$fav > 100;
fetch {
  ""tweet"": $t.text,
  ""favorites"": $t.favorites
};"
twitter,294,Identify the first 3 tweets by 'Me' that have been mentioned by another user.,"MATCH (me:Me)-[:POSTS]->(tweet:Tweet)<-[:MENTIONS]-(user:User)
RETURN tweet.text, user.screen_name
ORDER BY tweet.created_at
LIMIT 3","match
$me isa me;
posts (author: $me, content: $t);
mentions (source_tweet: $t, mentioned_user: $u);
not { $u isa me; };
$t has created_at $ca;
sort $ca asc;
limit 3;
fetch {
  ""text"": $t.text,
  ""screen_name"": $u.screen_name
};"
twitch,0,What are the first 3 games played by the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:PLAYS]->(g:Game)
RETURN g.name AS game
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"", has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""game"": $gn };"
twitch,1,List the top 5 streams that have a total view count greater than 5000000.,"MATCH (s:Stream)
WHERE s.total_view_count > 5000000
RETURN s.name AS stream_name, s.total_view_count AS view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 5000000;
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""view_count"": $tvc };"
twitch,2,Which users are moderators for the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:MODERATOR]-(u:User)
RETURN u.name AS user","match
  $s isa stream, has name ""9linda"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
fetch { ""user"": $un };"
twitch,3,Find the top 3 languages used by streams with more than 1000000 followers.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 1000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 1000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
twitch,4,What are the first 3 streams that have a follower count between 20000 and 50000?,"MATCH (s:Stream)
WHERE s.followers >= 20000 AND s.followers <= 50000
RETURN s.name, s.followers
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 20000;
  $f <= 50000;
sort $f desc;
limit 3;
fetch { ""name"": $sn, ""followers"": $f };"
twitch,5,List the names of the first 5 streams that were created before 2015.,"MATCH (s:Stream)
WHERE s.createdAt < date(""2015-01-01"")
RETURN s.name
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca < 2015-01-01;
sort $ca asc;
limit 5;
fetch { ""name"": $sn };"
twitch,6,Who are the top 3 VIPs in the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:VIP]-(vip:User)
RETURN vip.name AS vip, vip.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $s isa stream, has name ""summit1g"";
  vip_status (channel_with_vips: $s, vip_channel: $vip);
  $vip has name $vn, has followers $f;
sort $f desc;
limit 3;
fetch { ""vip"": $vn, ""followers"": $f };"
twitch,7,What are the first 3 teams associated with the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:HAS_TEAM]->(t:Team)
RETURN t.name
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"";
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
limit 3;
fetch { ""name"": $tn };"
twitch,8,Which streams are chatters in the stream with the name '9linda'?,"MATCH (s:Stream)<-[:CHATTER]-(chatter:Stream)
WHERE s.name = '9linda'
RETURN chatter","match
  $s isa stream, has name ""9linda"";
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
fetch { ""name"": $chatter.name };"
twitch,9,List the first 5 users who are chatters in more than one stream.,"MATCH (u:User)-[:CHATTER]->(:Stream)
WITH u, count(DISTINCT u) AS num_streams
WHERE num_streams > 1
RETURN u.name, u.id
LIMIT 5","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $count = count($s) groupby $un;
sort $count desc;
limit 5;"
twitch,10,Which game is the most commonly played among the top 5 streams by follower count?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, s
ORDER BY s.followers DESC
LIMIT 5
RETURN g.name AS game, count(*) AS count
ORDER BY count DESC
LIMIT 1","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $f desc;
limit 5;
fetch { ""game"": $gn };"
twitch,11,What are the names of the first 3 users who are both moderators and VIPs for any stream?,"MATCH (u:User)
WHERE exists{ (u)-[:MODERATOR]->(:Stream) } 
  AND exists{ (u)-[:VIP]->(:Stream) }
RETURN u.name
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s1);
  vip_status (vip_user: $u, channel_with_vips: $s2);
limit 3;
fetch { ""name"": $un };"
twitch,12,List the first 5 streams that have the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name, s.url
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
limit 5;
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,13,Who are the top 3 moderators for the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name AS moderator, m.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
sort $f desc;
limit 3;
fetch { ""moderator"": $mn };"
twitch,14,What are the first 5 streams created in 2021?,"MATCH (s:Stream)
WHERE s.createdAt >= date(""2021-01-01"") AND s.createdAt < date(""2022-01-01"")
RETURN s.name AS streamName, s.createdAt
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca >= 2021-01-01;
  $ca < 2022-01-01;
sort $ca asc;
limit 5;
fetch { ""streamName"": $sn, ""createdAt"": $ca };"
twitch,15,List the first 3 users who are VIPs in the stream 'itsbigchase'.,"MATCH (u:User)-[:VIP]->(s:Stream {name: 'itsbigchase'})
RETURN u.name AS user
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""user"": $un };"
twitch,16,Which user has moderated the most streams?,"MATCH (u:User)-[m:MODERATOR]->(s:Stream)
WITH u, count(m) AS num_moderated
ORDER BY num_moderated DESC
LIMIT 1
RETURN u.name AS user, num_moderated","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated = count($s) groupby $un;
sort $num_moderated desc;
limit 1;"
twitch,17,What are the first 3 streams that have a description containing the word 'hilarious'?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'hilarious'
RETURN s
LIMIT 3","match
  $s isa stream, has description $d;
  $d like ""%hilarious%"";
limit 3;
fetch { ""name"": $s.name, ""description"": $d };"
twitch,18,List the top 5 streams with the highest total view count.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,19,What are the names of the first 3 languages spoken in streams with a total view count over 10000000?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN l.name AS language
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
sort $tvc desc;
limit 3;
fetch { ""language"": $ln };"
twitch,20,How many unique games are played by streams with more than 500000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 500000
RETURN count(DISTINCT g.name) AS unique_games_played","match
  $s isa stream, has followers $f;
  $f > 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $unique_games_played = count($gn);"
twitch,21,List the first 3 games played on streams that were created in 2019.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt >= date(""2019-01-01"") AND s.createdAt < date(""2020-01-01"")
RETURN g.name AS game
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca >= 2019-01-01;
  $ca < 2020-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""game"": $gn };"
twitch,22,What are the first 5 streams that a user named 'itsbigchase' moderates?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s.name AS stream_name
LIMIT 5","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderating_user: $u, moderated_channel: $s);
  $s has name $sn;
limit 5;
fetch { ""stream_name"": $sn };"
twitch,23,Who are the top 3 chatters in the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:CHATTER]-(chatter)
RETURN chatter.name AS chatter, chatter.id AS chatter_id
ORDER BY chatter.total_view_count DESC
LIMIT 3","match
  $s isa stream, has name ""summit1g"";
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
  $chatter has name $cn, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""chatter"": $cn };"
twitch,24,List the first 3 games played by streams that have a follower count under 1000.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers < 1000
RETURN g.name AS game
ORDER BY s.followers
LIMIT 3","match
  $s isa stream, has followers $f;
  $f < 1000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $f asc;
limit 3;
fetch { ""game"": $gn };"
twitch,25,Which streams are part of the team 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
fetch { ""stream_name"": $sn };"
twitch,27,Who are the top 3 users who chatter in the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
MATCH (u:User)-[:CHATTER]->(s)
RETURN u.name AS user, s.name AS stream
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
sort $tvc desc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,28,List the first 3 games played by streams that have a URL containing 'twitch.tv'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.url CONTAINS 'twitch.tv'
RETURN DISTINCT g.name
LIMIT 3","match
  $s isa stream, has url $u;
  $u like ""%twitch.tv%"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""name"": $gn };"
twitch,29,What are the names of the first 5 users who are moderators in the stream '9linda'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream {name: '9linda'})
RETURN u.name
LIMIT 5","match
  $s isa stream, has name ""9linda"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
twitch,30,How many streams have a follower count between 10000 and 50000?,"MATCH (s:Stream)
WHERE s.followers >= 10000 AND s.followers <= 50000
RETURN count(s)","match
  $s isa stream, has followers $f;
  $f >= 10000;
  $f <= 50000;
reduce $count = count($s);"
twitch,31,List the first 3 streams that have a description mentioning 'game'.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'game'
RETURN s.name, s.description
LIMIT 3","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%game%"";
limit 3;
fetch { ""name"": $sn, ""description"": $d };"
twitch,32,Which streams have the user 'itsbigchase' as a VIP?,"MATCH (u:User {name: 'itsbigchase'})-[:VIP]->(s:Stream)
RETURN s.name AS stream_name, s.url AS stream_url","match
  $u isa user, has name ""itsbigchase"";
  vip_status (vip_user: $u, channel_with_vips: $s);
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,33,List the top 5 games played by the streams created in the first half of 2020.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt >= datetime(""2020-01-01"") AND s.createdAt < datetime(""2020-07-01"") 
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 5","match
  $s isa stream, has created_at $ca;
  $ca >= 2020-01-01;
  $ca < 2020-07-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 5;"
twitch,34,What are the first 3 languages used by streams with a follower count of exactly 33366?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers = 33366
RETURN l.name
LIMIT 3","match
  $s isa stream, has followers 33366;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""name"": $ln };"
twitch,35,Who are the top 3 VIPs in the streams that were created in 2018?,"MATCH (s:Stream)-[:VIP]->(vip:User)
WHERE s.createdAt >= date(""2018-01-01"") AND s.createdAt < date(""2019-01-01"")
RETURN vip.name AS vip, count(*) AS vipCount
ORDER BY vipCount DESC
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca >= 2018-01-01;
  $ca < 2019-01-01;
  vip_status (channel_with_vips: $s, vip_user: $vip);
  $vip has name $vn;
reduce $vipCount = count($s) groupby $vn;
sort $vipCount desc;
limit 3;"
twitch,36,List the first 5 streams that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
limit 5;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,37,Which teams are associated with the top 3 streams by total view count?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, t
ORDER BY s.total_view_count DESC
LIMIT 3
RETURN t.name AS team_name, s.name AS stream_name, s.total_view_count","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
sort $tvc desc;
limit 3;
fetch { ""team_name"": $tn, ""stream_name"": $sn, ""total_view_count"": $tvc };"
twitch,38,What are the first 3 streams that have a user named 'itsbigchase' as a chatter?,"MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
limit 3;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,39,List the names of the first 5 users who are chatters in the stream 'summit1g'.,"MATCH (u:User)-[:CHATTER]->(s:Stream {name: 'summit1g'})
RETURN u.name
LIMIT 5","match
  $s isa stream, has name ""summit1g"";
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
twitch,40,Which streams are chatters in the stream with the most followers?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (chatter:Stream)-[:CHATTER]->(s)
RETURN chatter","match
  $s isa stream, has followers $f;
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
sort $f desc;
limit 1;
fetch { ""name"": $chatter.name };"
twitch,41,List the first 5 users who are moderators in streams that play 'Grand Theft Auto V'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(:Game {name: 'Grand Theft Auto V'})
RETURN u.name AS user
LIMIT 5","match
  $g isa game, has name ""Grand Theft Auto V"";
  game_play (streaming_channel: $s, played_game: $g);
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 5;
fetch { ""user"": $un };"
twitch,42,What are the names of the first 3 games played by streams that have a URL ending in 'itsbigchase'?,"MATCH (s:Stream {url: 'https://www.twitch.tv/itsbigchase'})-[:PLAYS]->(g:Game)
RETURN g.name
LIMIT 3","match
  $s isa stream, has url ""https://www.twitch.tv/itsbigchase"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""name"": $gn };"
twitch,43,Who are the top 3 users who are VIPs in the stream with the name '9linda'?,"MATCH (s:Stream {name: '9linda'})<-[:VIP]-(u:User)
RETURN u.name AS user, u.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $s isa stream, has name ""9linda"";
  vip_status (channel_with_vips: $s, vip_channel: $vip);
  $vip has name $vn, has followers $f;
sort $f desc;
limit 3;
fetch { ""user"": $vn, ""followers"": $f };"
twitch,44,List the first 5 streams that have been VIP in more than one stream.,"MATCH (s:Stream)-[:VIP]->(:Stream)
WITH s, count(s) AS vip_count
WHERE vip_count > 1
RETURN s.name AS stream_name, s.url AS stream_url
ORDER BY vip_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  vip_status (vip_channel: $s, channel_with_vips: $target);
reduce $vip_count = count($target) groupby $sn, $su;
sort $vip_count desc;
limit 5;"
twitch,45,Which streams have a language named after a country code 'en'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,46,"List the first 3 streams that were created on or before January 1, 2010.","MATCH (s:Stream)
WHERE s.createdAt <= datetime(""2010-01-01"")
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca <= 2010-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""created_at"": $ca };"
twitch,47,What are the first 5 streams that have the most chatters?,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $c);
reduce $chatter_count = count($c) groupby $sn;
sort $chatter_count desc;
limit 5;"
twitch,48,Who are the top 3 moderators in the stream with the lowest follower count?,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WITH s, m
ORDER BY s.followers ASC, count{(m)-[:MODERATOR]->(s)} DESC
LIMIT 1
WITH s
MATCH (s)<-[:MODERATOR]-(moderator:User)
RETURN moderator.name AS moderator, moderator.followers AS followers
ORDER BY followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
sort $f asc;
limit 3;
fetch { ""moderator"": $mn };"
twitch,49,List the first 5 streams that have a follower count exactly 5898590.,"MATCH (s:Stream)
WHERE s.followers = 5898590
RETURN s
LIMIT 5","match
  $s isa stream, has followers 5898590;
limit 5;
fetch { ""name"": $s.name, ""followers"": $s.followers };"
twitch,50,What are the names of the first 3 languages spoken by the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3","match
  $s isa stream, has name ""itsbigchase"";
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""name"": $ln };"
twitch,51,Which streams have more than 5000000 followers?,"MATCH (s:Stream)
WHERE s.followers > 5000000
RETURN s.name AS stream_name, s.followers","match
  $s isa stream, has name $sn, has followers $f;
  $f > 5000000;
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,52,List the top 5 streams by total view count.,"MATCH (s:Stream)
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,53,What are the names of games played by streams with more than 1 million total views?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN DISTINCT g.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,54,Which streams have moderators who are also users?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
RETURN s, u","match
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""stream"": $s.name, ""user"": $u.name };"
twitch,55,Identify the streams that are part of the 'ESO Stream Team'.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,56,Which users are VIPs in more than one stream?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS num_vip_streams
WHERE num_vip_streams > 1
RETURN u.name AS user, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_vip_streams = count($s) groupby $un;
sort $num_vip_streams desc;"
twitch,57,What languages are used by streams that have over 10000 followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN DISTINCT l.name","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""name"": $ln };"
twitch,58,Find streams that were created after 2015 and have at least one chatter who is a user.,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2015-01-01')
AND exists{ (s)<-[:CHATTER]-(:User) }
RETURN s","match
  $s isa stream, has created_at $ca;
  $ca > 2015-01-01;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""name"": $s.name, ""created_at"": $ca };"
twitch,59,Can you list streams that have a follower count between 1000 and 5000?,"MATCH (s:Stream)
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s.name AS stream_name, s.followers","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 1000;
  $f <= 5000;
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,60,What are the names of teams associated with streams created before 2018?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt < date(""2018-01-01"")
RETURN t.name","match
  $s isa stream, has created_at $ca;
  $ca < 2018-01-01;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
twitch,61,Which games are played by the top 3 streams based on followers count?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, g
ORDER BY s.followers DESC
LIMIT 3
RETURN g.name AS game","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $f desc;
limit 3;
fetch { ""game"": $gn };"
twitch,62,Which users are moderators in at least two different streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams >= 2
RETURN u.name as user, num_streams as streams_moderated","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;"
twitch,63,What are the names of streams that play 'Rust' and have more than 5000 followers?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 5000
RETURN s.name","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
  $f > 5000;
fetch { ""name"": $sn };"
twitch,64,How many streams have a moderator who is also a stream?,"MATCH (s:Stream)-[:MODERATOR]->(m:Stream)
RETURN count(s) AS num_streams_with_stream_moderator","match
  moderation (moderating_channel: $m, moderated_channel: $s);
reduce $num_streams_with_stream_moderator = count($s);"
twitch,65,List all streams that have a VIP who is a user.,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s","match
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,66,Name the languages spoken in streams with a total view count exceeding 10 million.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN DISTINCT l.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""name"": $ln };"
twitch,67,Who are the moderators of the stream named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})<-[:MODERATOR]-(m:User)
RETURN m.name AS moderator","match
  $s isa stream, has name ""summit1g"";
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
fetch { ""moderator"": $mn };"
twitch,68,Identify streams that have more than one language associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 1
RETURN s","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;"
twitch,69,Which users are chatters in more than three streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS num_streams
WHERE num_streams > 3
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;"
twitch,70,List the streams that have the most followers who also play 'Grand Theft Auto V'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Grand Theft Auto V'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 10","match
  $g isa game, has name ""Grand Theft Auto V"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
sort $f desc;
limit 10;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,71,Which streams were created in 2019 and have a description longer than 50 characters?,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2019-01-01') AND s.createdAt < datetime('2020-01-01')
  AND s.description IS NOT NULL AND size(s.description) > 50
RETURN s","match
  $s isa stream, has created_at $ca, has description $d;
  $ca >= 2019-01-01;
  $ca < 2020-01-01;
fetch { ""name"": $s.name, ""description"": $d };"
twitch,72,Find the streams that are moderated by users named 'itsbigchase'.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderating_user: $u, moderated_channel: $s);
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,73,What are the top 3 games played by streams with a total view count less than 500000?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count < 500000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc < 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 3;"
twitch,74,Who are the VIP users in streams that have over 1000000 followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE s.followers > 1000000
RETURN u.name AS vip_user, s.name AS stream","match
  $s isa stream, has followers $f, has name $sn;
  $f > 1000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""vip_user"": $un, ""stream"": $sn };"
twitch,75,List the names of streams that have both English and Russian languages associated.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l1:Language {name: 'en'})
WHERE exists{ (s)-[:HAS_LANGUAGE]->(:Language {name: 'ru'}) }
RETURN s.name","match
  $l1 isa language, has name ""en"";
  $l2 isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  $s has name $sn;
fetch { ""name"": $sn };"
twitch,76,List the top 5 streams with the highest follower count.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,77,Which 3 games are the most played by streams with over 1 million followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 1000000
WITH g, count(*) as playCount
RETURN g.name as game, playCount
ORDER BY playCount DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $playCount = count($s) groupby $gn;
sort $playCount desc;
limit 3;"
twitch,78,Find the top 5 streams with the most total view count that use English language.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,79,Which 3 users are moderators for the most streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;"
twitch,80,What are the top 3 most common games played by streams created before 2010?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt < datetime('2010-01-01')
RETURN g.name AS game, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca < 2010-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $count = count($s) groupby $gn;
sort $count desc;
limit 3;"
twitch,81,List the 3 teams with the most associated streams.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $stream_count = count($s) groupby $tn;
sort $stream_count desc;
limit 3;"
twitch,82,Which 3 streams have the highest number of VIP users?,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 3;"
twitch,83,What are the names of the top 5 oldest teams in the graph?,"MATCH (t:Team)
RETURN t.name
ORDER BY t.createdAt
LIMIT 5","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $tn };"
twitch,84,"List the top 3 languages used by streams with over 10,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
twitch,85,Who are the top 3 users who chatter the most with other users?,"MATCH (u:User)-[c:CHATTER]->(u2:User)
WITH u, count(c) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3
RETURN u.name AS user, chatter_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, user_with_chatters: $u2);
reduce $chatter_count = count($u2) groupby $un;
sort $chatter_count desc;
limit 3;"
twitch,86,List the 3 streams with the lowest follower count but with over 1 million total views.,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
  $tvc > 1000000;
sort $f asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,87,What are the top 3 games played by streams that also have a moderator relationship with a user?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:MODERATOR]->(u:User)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  moderation (moderated_channel: $s, moderating_user: $u);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;"
twitch,88,Which 3 users have VIP status on the most streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
ORDER BY vip_count DESC
LIMIT 3
RETURN u.name AS user, vip_count","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $vip_count = count($s) groupby $un;
sort $vip_count desc;
limit 3;"
twitch,89,List the top 5 streams that have created the most chatter relationships.,"MATCH (s:Stream)
RETURN s.name AS stream, count{(s)-[:CHATTER]->(:User)} AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;"
twitch,90,Which 3 games are mostly played by streams with a total view count exceeding 100 million?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 100000000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 100000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 3;"
twitch,91,Find the top 5 users who moderate the highest number of other users.,"MATCH (u:User)-[:MODERATOR]->(otherUser:User)
WITH u, count(otherUser) AS num_moderated_users
ORDER BY num_moderated_users DESC
LIMIT 5
RETURN u.name AS user, num_moderated_users","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_user: $other);
reduce $num_moderated_users = count($other) groupby $un;
sort $num_moderated_users desc;
limit 5;"
twitch,92,What are the 3 most common languages for streams that have been created after 2015?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.createdAt > datetime('2015-01-01')
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca > 2015-01-01;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
twitch,93,List the top 5 streams with the most chatter interactions.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, s.url AS url, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn, $su;
sort $chatter_count desc;
limit 5;"
twitch,94,Which 3 teams were created most recently?,"MATCH (t:Team)
RETURN t.name AS team, t.createdAt AS created
ORDER BY t.createdAt DESC
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""team"": $tn, ""created"": $ca };"
twitch,95,Find the 3 streams that play the least common games based on follower count.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, count(s) AS streamCount, max(s.followers) AS maxFollowers
ORDER BY streamCount ASC
LIMIT 3
MATCH (s:Stream)-[:PLAYS]->(g)
RETURN s.name AS streamName, s.followers, g.name AS gameName
ORDER BY s.followers DESC","match
  $s isa stream, has name $sn, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streamCount = count($s) groupby $gn;
sort $streamCount asc;
limit 3;"
twitch,96,List the top 5 oldest streams in the graph.,"MATCH (s:Stream)
RETURN s.name, s.createdAt
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca };"
twitch,97,What are the top 3 most viewed games by streams that have a team?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_TEAM]->(:Team)
WITH g.name AS game, sum(s.total_view_count) AS total_views
RETURN game, total_views
ORDER BY total_views DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  team_membership (member_stream: $s, organization: $t);
  $s has total_view_count $tvc;
  $g has name $gn;
reduce $total_views = sum($tvc) groupby $gn;
sort $total_views desc;
limit 3;"
twitch,98,List the 3 languages spoken by the least number of streams.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(s) AS stream_count
ORDER BY stream_count
LIMIT 3","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $stream_count = count($s) groupby $ln;
sort $stream_count asc;
limit 3;"
twitch,100,Find the top 5 games played by streams that also chatter with other streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:CHATTER]->(:Stream)
WITH g, count(*) AS count
RETURN g.name AS game, count
ORDER BY count DESC
LIMIT 5","match
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (chatting_channel: $s, channel_with_chatters: $s2);
  $g has name $gn;
reduce $count = count($s) groupby $gn;
sort $count desc;
limit 5;"
twitch,101,What are the top 3 most recent streams to reach over 1 million followers?,"MATCH (s:Stream)
WHERE s.followers > 1000000
RETURN s.name AS stream_name, s.createdAt AS created_at, s.followers
ORDER BY s.createdAt DESC
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca, has followers $f;
  $f > 1000000;
sort $ca desc;
limit 3;
fetch { ""stream_name"": $sn, ""created_at"": $ca, ""followers"": $f };"
twitch,102,Which 3 users are VIPs on the most diverse set of streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_streams
RETURN u.name, num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 3;"
twitch,103,Which streams have a total view count over 1 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000
RETURN s.name, s.total_view_count","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
twitch,106,Identify streams that have moderators who are also VIPs.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)-[:VIP]->(s)
RETURN s.name AS stream, m.name AS moderator_and_vip","match
  moderation (moderated_channel: $s, moderating_user: $m);
  vip_status (channel_with_vips: $s, vip_user: $m);
  $s has name $sn;
  $m has name $mn;
fetch { ""stream"": $sn, ""moderator_and_vip"": $mn };"
twitch,107,Which streams are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, t.name AS team","match
  $t isa team, has name $tn, has created_at $ca;
  $ca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
fetch { ""stream"": $sn, ""team"": $tn };"
twitch,108,What are the top 5 languages used by streams with more than 10000 followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 5;"
twitch,109,Which streams have chatters who are also moderators?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(s)
RETURN DISTINCT s","match
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $s.name };"
twitch,110,How many streams have played the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN count(s) AS num_streams_playing_rust","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_streams_playing_rust = count($s);"
twitch,111,List all teams associated with streams having more than 50000 followers.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.followers > 50000
RETURN DISTINCT t.name","match
  $s isa stream, has followers $f;
  $f > 50000;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
twitch,112,What are the descriptions of streams that play 'Call of Duty: Warzone'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Call of Duty: Warzone'})
WHERE s.description IS NOT NULL
RETURN s.description","match
  $g isa game, has name ""Call of Duty: Warzone"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has description $d;
fetch { ""description"": $d };"
twitch,114,Find streams that have a follower count between 1000 and 5000.,"MATCH (s:Stream)
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s","match
  $s isa stream, has followers $f;
  $f >= 1000;
  $f <= 5000;
fetch { ""name"": $s.name, ""followers"": $f };"
twitch,115,List the top 5 streams with the highest follower counts.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,116,Which games are played by streams that also have an 'en' language setting?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN DISTINCT g.name","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,117,Find streams that are moderated by users who are also chatters.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)-[:CHATTER]->(s)
RETURN s, u","match
  moderation (moderated_channel: $s, moderating_user: $u);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $s has name $sn;
  $u has name $un;
fetch { ""stream"": $sn, ""user"": $un };"
twitch,118,What is the URL of the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
RETURN s.url","match
  $s isa stream, has total_view_count $tvc, has url $u;
sort $tvc desc;
limit 1;
fetch { ""url"": $u };"
twitch,119,List all languages spoken on streams with a total view count over 500000.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 500000
RETURN DISTINCT l.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""name"": $ln };"
twitch,121,What are the names of teams associated with streams created after 2018?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt > date(""2018-01-01"")
RETURN t.name","match
  $s isa stream, has created_at $ca;
  $ca > 2018-01-01;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
twitch,122,How many streams have a description containing the word 'strategy'?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'strategy'
RETURN count(s)","match
  $s isa stream, has description $d;
  $d like ""%strategy%"";
reduce $count = count($s);"
twitch,123,Identify the streams that have the most moderators.,"MATCH (s:Stream)
OPTIONAL MATCH (s)-[:MODERATOR]->(m:User)
WITH s, count(m) AS moderatorCount
RETURN s.name AS streamName, moderatorCount
ORDER BY moderatorCount DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  try { moderation (moderated_channel: $s, moderating_user: $m); };
reduce $moderatorCount = count($m) groupby $sn;
sort $moderatorCount desc;
limit 10;
fetch { ""streamName"": $sn, ""moderatorCount"": $moderatorCount };"
twitch,124,List the games played by streams with the lowest follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers IS NOT NULL
WITH g, min(s.followers) AS minFollowers
MATCH (s2:Stream)-[:PLAYS]->(g)
WHERE s2.followers = minFollowers
RETURN g.name AS game, minFollowers AS lowestFollowerCount","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $minFollowers = min($f) groupby $gn;
sort $minFollowers asc;
limit 10;"
twitch,125,Which streams are part of the team 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name, s.url AS stream_url","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,126,List the top 5 users who are chatters in the most streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 5;"
twitch,127,Identify streams where the same user is both a chatter and a moderator.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(s)
RETURN s.name AS stream, u.name AS user","match
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has name $sn;
  $u has name $un;
fetch { ""stream"": $sn, ""user"": $un };"
twitch,128,Which streams have chatters who have less than 1000 followers?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE u.followers < 1000
RETURN s, u","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_channel: $c);
  $c has name $cn, has followers $f;
  $f < 1000;
fetch { ""stream"": $sn, ""chatter"": $cn };"
twitch,130,Find streams that play 'Rust' and have more than 10000 followers.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 10000
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 10000;
fetch { ""name"": $s.name, ""followers"": $f };"
twitch,131,List the top 5 streams with the highest number of followers.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,132,Which 3 games have the most streams associated with them?,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
RETURN g.name AS game, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streamCount = count($s) groupby $gn;
sort $streamCount desc;
limit 3;"
twitch,133,"What are the top 5 languages used by streams with more than 100,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 100000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 100000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 5;"
twitch,134,Identify the first 3 teams that were created in the database.,"MATCH (t:Team)
RETURN t.name AS team, t.createdAt AS created_at
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca asc;
limit 3;
fetch { ""team"": $tn, ""created_at"": $ca };"
twitch,135,Which 3 users are moderators for the most number of streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;"
twitch,136,Find the top 5 streams with the highest total view count.,"MATCH (s:Stream)
RETURN s.name, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
twitch,137,What are the names of the top 3 streams that have a VIP user?,"MATCH (s:Stream)<-[:VIP]-(:User)
RETURN s.name AS stream_name
ORDER BY s.total_view_count DESC
LIMIT 3","match
  vip_status (channel_with_vips: $s, vip_user: $u);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream_name"": $sn };"
twitch,138,List the top 5 streams that play 'Rust' and have more than 5000 followers.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 5000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
  $f > 5000;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,139,Which 3 users have VIP status in the most streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
ORDER BY vip_count DESC
LIMIT 3
RETURN u.name AS user, vip_count","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $vip_count = count($s) groupby $un;
sort $vip_count desc;
limit 3;"
twitch,140,What are the top 5 oldest streams based on the 'createdAt' property?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.createdAt AS created_at
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""stream_name"": $sn, ""created_at"": $ca };"
twitch,141,Find the first 3 languages that are most frequently associated with streams.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $frequency = count($s) groupby $ln;
sort $frequency desc;
limit 3;"
twitch,143,List the top 5 games played by streams with over 1 million total views.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 5","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 5;"
twitch,144,Which 3 users are chatters in the most number of different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
RETURN u.name AS user, count(distinct s) AS num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 3;"
twitch,145,What are the top 5 teams by the number of streams they are associated with?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 5;"
twitch,146,List the top 5 streams that have a 'createdAt' date after 2019.,"MATCH (s:Stream)
WHERE s.createdAt > date('2019-01-01')
RETURN s.name, s.createdAt, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca, has total_view_count $tvc;
  $ca > 2019-01-01;
sort $tvc desc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca, ""total_view_count"": $tvc };"
twitch,147,What are the top 3 most common games played by streams with a 'ru' language setup?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'ru'})
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;"
twitch,148,Which 3 streams have the highest follower count but the lowest total view count?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count, s.total_view_count AS view_count
ORDER BY s.followers DESC, s.total_view_count ASC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
sort $f desc, $tvc asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f, ""view_count"": $tvc };"
twitch,149,Identify the top 5 streams that have users as VIPs.,"MATCH (s:Stream)<-[:VIP]-(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 5;"
twitch,150,What are the names of the first 3 streams moderated by 'itsbigchase'?,"MATCH (u:User {name: 'itsbigchase'})-[:MODERATOR]->(s:Stream)
RETURN s.name
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderating_user: $u, moderated_channel: $s);
  $s has name $sn;
limit 3;
fetch { ""name"": $sn };"
twitch,151,List the 3 games most commonly played by streams with an English language setup.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;"
twitch,153,Find the top 5 streams by oldest to newest based on the 'createdAt' property.,"MATCH (s:Stream)
WHERE s.createdAt IS NOT NULL
RETURN s
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca };"
twitch,154,"Which 3 languages are least common among streams with more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
WITH l, count(*) as count
ORDER BY count
LIMIT 3
RETURN l.name as language, count","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count asc;
limit 3;"
twitch,155,List the top 5 users who have the role of chatter in the highest number of other user's streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)<-[:CHATTER]-(other:User)
WHERE u <> other
WITH u, count(distinct s) as chatter_count
ORDER BY chatter_count DESC
LIMIT 5
RETURN u.name as user, chatter_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  chat_activity (chatting_user: $other, channel_with_chatters: $s);
  not { $u is $other; };
reduce $chatter_count = count($s) groupby $un;
sort $chatter_count desc;
limit 5;"
twitch,156,What are the three most common teams that streams belong to?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN t.name AS team, count(*) AS num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 3;"
twitch,157,Which streams have a VIP relationship with more than three different users?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, count(u) AS vip_count
WHERE vip_count > 3
RETURN s.name AS stream_name, vip_count","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;"
twitch,158,List the top 5 streams that have been added to the most teams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN s.name AS stream, count(t) AS team_count
ORDER BY team_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
reduce $team_count = count($t) groupby $sn;
sort $team_count desc;
limit 5;"
twitch,159,"What are the first 3 streams to play 'Rust' with more than 100,000 total views?","MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.total_view_count > 100000
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.createdAt
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has total_view_count $tvc, has created_at $ca;
  $tvc > 100000;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,160,Which 3 users have served as moderators for the oldest streams in the database?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
WITH s, u
ORDER BY s.createdAt
LIMIT 3
RETURN u.name AS user, s.name AS stream, s.createdAt AS streamCreatedAt","match
  $s isa stream, has name $sn, has created_at $ca;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
sort $ca asc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn, ""streamCreatedAt"": $ca };"
twitch,161,List the top 5 streams that are part of a team created before 2015.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $t isa team, has created_at $ca;
  $ca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,162,What are the names of the first 3 streams that have a moderator with more than 5000 followers?,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WHERE m.followers > 5000
RETURN s.name
LIMIT 3","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has followers $f;
  $f > 5000;
limit 3;
fetch { ""name"": $sn };"
twitch,163,Which 3 streams have the most unique games played?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as uniqueGames
RETURN s.name as streamName, uniqueGames
ORDER BY uniqueGames DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $uniqueGames = count($g) groupby $sn;
sort $uniqueGames desc;
limit 3;"
twitch,164,List the top 5 streams that have had more than three different languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(distinct l) as languageCount
WHERE languageCount > 3
RETURN s.name as streamName, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;
limit 5;"
twitch,165,"What are the first 3 users who are VIPs in streams with more than 10,000 total views?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 10000
RETURN u.name AS user, s.name AS stream
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc, has name $sn;
  $tvc > 10000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $tvc desc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,166,List the top 5 oldest teams based on the 'createdAt' property.,"MATCH (t:Team)
RETURN t.name AS team, t.createdAt
ORDER BY t.createdAt
LIMIT 5","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""team"": $tn, ""createdAt"": $ca };"
twitch,167,Which 3 streams have the most users as chatters?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 3;"
twitch,168,List the first 3 games played by streams with the highest follower counts.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS game, max(s.followers) AS max_followers
ORDER BY max_followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $max_followers = max($f) groupby $gn;
sort $max_followers desc;
limit 3;"
twitch,169,What are the top 5 streams that have VIP relationships with other streams?,"MATCH (s:Stream)-[:VIP]->(otherStream:Stream)
RETURN s.name AS stream, count(otherStream) AS vip_count
ORDER BY vip_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  vip_status (vip_channel: $s, channel_with_vips: $other);
reduce $vip_count = count($other) groupby $sn;
sort $vip_count desc;
limit 5;"
twitch,170,Which 3 users have the most moderator relationships with other users?,"MATCH (u:User)-[r:MODERATOR]->(otherUser:User)
RETURN u.name AS user, count(r) AS num_moderator_relationships
ORDER BY num_moderator_relationships DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_user: $other);
reduce $num_moderator_relationships = count($other) groupby $un;
sort $num_moderator_relationships desc;
limit 3;"
twitch,171,List the top 5 streams that have chatters with more than 5000 followers.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE u.followers > 5000
RETURN s.name AS stream, s.url AS url, s.followers AS followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $url, has followers $sf;
  chat_activity (channel_with_chatters: $s, chatting_channel: $c);
  $c has followers $cf;
  $cf > 5000;
sort $sf desc;
limit 5;
fetch { ""stream"": $sn, ""url"": $url, ""followers"": $sf };"
twitch,172,What are the first 3 streams that have a language setup other than 'en' or 'ru'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name <> 'en' AND l.name <> 'ru'
RETURN s.name AS stream, l.name AS language
LIMIT 3","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
  not { $ln == ""en""; };
  not { $ln == ""ru""; };
limit 3;
fetch { ""stream"": $sn, ""language"": $ln };"
twitch,174,"List the top 5 games associated with streams that have more than 10,000 total views.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 10000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 5","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 5;"
twitch,175,Which 3 users are VIPs in the most number of different users' streams?,"MATCH (u:User)-[:VIP]->(s:Stream)<-[:VIP]-(other:User)
WITH u, count(DISTINCT other) AS num_vip_streams
RETURN u.name AS user, num_vip_streams
ORDER BY num_vip_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
  vip_status (vip_user: $other, channel_with_vips: $s);
  not { $u is $other; };
reduce $num_vip_streams = count($other) groupby $un;
sort $num_vip_streams desc;
limit 3;"
twitch,176,List the first 3 streams that were created after 2020.,"MATCH (s:Stream)
WHERE s.createdAt > date(""2020-01-01"")
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca > 2020-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""createdAt"": $ca };"
twitch,177,"What are the top 5 teams by number of associated streams with over 10,000 followers?","MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WHERE s.followers > 10000
WITH t, count(s) as numStreams
ORDER BY numStreams DESC
LIMIT 5
RETURN t.name as team, numStreams","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
  $s has followers $f;
  $f > 10000;
reduce $numStreams = count($s) groupby $tn;
sort $numStreams desc;
limit 5;"
twitch,178,Which 3 languages are associated with the streams that have the least followers?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH l, min(s.followers) AS minFollowers
RETURN l.name AS language, minFollowers
ORDER BY minFollowers
LIMIT 3","match
  $s isa stream, has followers $f;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $minFollowers = min($f) groupby $ln;
sort $minFollowers asc;
limit 3;"
twitch,179,List the top 5 streams that have the most number of languages associated.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN s.name AS stream, count(l) AS num_languages
ORDER BY num_languages DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $num_languages = count($l) groupby $sn;
sort $num_languages desc;
limit 5;"
twitch,181,"Which 3 streams have the least followers but are associated with a game with more than 100,000 total views?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE g.name IS NOT NULL
WITH s, sum(s.total_view_count) AS game_views
WHERE game_views > 100000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
  game_play (streaming_channel: $s, played_game: $g);
  $tvc > 100000;
sort $f asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,183,What are the first 3 streams to have a team relationship with 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name, s.createdAt AS created_at
ORDER BY s.createdAt
LIMIT 3","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has created_at $ca;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""created_at"": $ca };"
twitch,185,List the top 5 users who are moderators in the most number of streams with an 'en' language setup.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5
RETURN u.name AS user, num_moderated_streams","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;"
twitch,186,What are the top 5 oldest streams by the 'createdAt' property that are still active?,"MATCH (s:Stream)
WHERE s.createdAt IS NOT NULL
RETURN s
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""name"": $s.name, ""createdAt"": $ca };"
twitch,187,Which 3 games are played by streams with the highest ratio of followers to total view counts?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH g, s.followers * 1.0 / s.total_view_count AS follower_view_ratio
RETURN g.name AS game, max(follower_view_ratio) AS max_ratio
ORDER BY max_ratio DESC
LIMIT 3","match
$stream isa stream, has followers $followers, has total_view_count $views;
game_play (streaming_channel: $stream, played_game: $game);
$views > 0;
let $ratio = $followers / $views;
sort $ratio desc;
limit 3;
fetch {
  ""game"": $game.name,
  ""ratio"": $ratio
};"
twitch,188,List the first 3 streams that were created in 2018.,"MATCH (s:Stream)
WHERE s.createdAt >= datetime('2018-01-01') AND s.createdAt < datetime('2019-01-01')
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca;
  $ca >= 2018-01-01;
  $ca < 2019-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""createdAt"": $ca };"
twitch,189,Which 3 streams have the most users as VIPs?,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 3;"
twitch,190,List the top 5 streams that are associated with teams and have more than 10000 followers.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.followers > 10000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f > 10000;
  team_membership (member_stream: $s, organization: $t);
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,191,What are the first 3 streams that have a chatter who is also a moderator?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE exists{ (u)-[:MODERATOR]->(s) }
RETURN s.name AS stream, s.url AS url
LIMIT 3","match
  $s isa stream, has name $sn, has url $su;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
limit 3;
fetch { ""stream"": $sn, ""url"": $su };"
twitch,192,List the first 3 streams that have a language set to 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
limit 3;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,193,What are the top 5 games played by streams with more than 5000 followers?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 5000
RETURN g.name AS game, count(*) AS stream_count
ORDER BY stream_count DESC
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 5000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 5;"
twitch,194,Which streams have a total view count above 1 million and are associated with the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.total_view_count > 1000000
RETURN s.name AS stream_name, s.total_view_count AS view_count","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
fetch { ""stream_name"": $sn, ""view_count"": $tvc };"
twitch,195,Identify the first 3 users who are moderators for streams with a description containing 'Belarus'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.description CONTAINS 'Belarus'
RETURN u.name, u.id
LIMIT 3","match
  $s isa stream, has description $d;
  $d like ""%Belarus%"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 3;
fetch { ""name"": $un };"
twitch,196,Find the top 5 streams that are playing the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,197,List the first 3 streams that have at least one VIP who is also a user.,"MATCH (s:Stream)-[:VIP]->(u:User)
RETURN s.name AS stream, u.name AS vip_user
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""stream"": $sn, ""vip_user"": $un };"
twitch,198,What are the first 3 streams that have a language set to 'ru'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN s.name, s.url
LIMIT 3","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
limit 3;
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,199,"Which users are VIPs in streams with a total view count exceeding 500,000?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u.name AS user, s.name AS stream","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 500000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,200,"What are the top 5 games played by streams created after January 1, 2015?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt > datetime(""2015-01-01"")
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 5","match
  $s isa stream, has created_at $ca;
  $ca > 2015-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 5;"
twitch,201,Identify the first 3 streams that have moderators with a follower count over 1000.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WHERE m.followers > 1000
RETURN s.name AS stream, m.name AS moderator
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca;
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has name $mn, has followers $f;
  $f > 1000;
sort $ca asc;
limit 3;
fetch { ""stream"": $sn, ""moderator"": $mn };"
twitch,202,List the top 5 most followed streams that are linked to the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,203,Which streams have a follower count between 1000 and 5000 and play the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers >= 1000 AND s.followers <= 5000
RETURN s.name AS stream, s.followers AS followerCount","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
  $f >= 1000;
  $f <= 5000;
fetch { ""stream"": $sn, ""followerCount"": $f };"
twitch,204,Find the first 3 users who are moderators of more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name, u.id
ORDER BY num_moderated_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;"
twitch,205,What are the top 5 streams with the highest total view count and are associated with the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,206,Identify the first 3 languages associated with streams that have a description containing 'coverage'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.description CONTAINS 'coverage'
RETURN l.name AS language
LIMIT 3","match
  $s isa stream, has description $d;
  $d like ""%coverage%"";
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""language"": $ln };"
twitch,207,List the first 3 streams that have chatters who are also streams.,"MATCH (s:Stream)<-[:CHATTER]-(chatter:User)
WHERE exists{ (chatter:Stream) }
RETURN s.name AS stream, chatter.name AS chatter
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
  $chatter has name $cn;
limit 3;
fetch { ""stream"": $sn, ""chatter"": $cn };"
twitch,208,"Which streams have a total view count below 50,000 and are associated with the language 'ru'?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.total_view_count < 50000
RETURN s","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  $s has total_view_count $tvc;
  $tvc < 50000;
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
twitch,209,"Identify the first 3 teams that are linked to streams with over 10,000 followers.","MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WHERE s.followers > 10000
RETURN t.name AS team_name
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
  $s has followers $f;
  $f > 10000;
sort $ca asc;
limit 3;
fetch { ""team_name"": $tn };"
twitch,210,What are the top 5 streams created before 2010?,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s.name AS stream, s.createdAt AS created
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca < 2010-01-01;
sort $ca asc;
limit 5;
fetch { ""stream"": $sn, ""created"": $ca };"
twitch,211,List the first 3 streams that have VIPs who are users with a name containing 'chase'.,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.name CONTAINS 'chase'
RETURN s.name AS stream, u.name AS vip
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
  $un like ""%chase%"";
limit 3;
fetch { ""stream"": $sn, ""vip"": $un };"
twitch,212,Which users are chatters in streams with a description containing 'inclusive'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.description CONTAINS 'inclusive'
RETURN u","match
  $s isa stream, has description $d;
  $d like ""%inclusive%"";
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""name"": $u.name };"
twitch,213,Identify the first 3 streams that have moderators named 'itsbigchase'.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User {name: 'itsbigchase'})
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 3","match
  $m isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $m);
limit 3;
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,214,List the top 5 streams with the lowest follower count that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers IS NOT NULL
RETURN s.name AS stream, s.followers AS followerCount
ORDER BY followerCount ASC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
sort $f asc;
limit 5;
fetch { ""stream"": $sn, ""followerCount"": $f };"
twitch,215,What are the first 3 streams with the most VIPs linked to them?,"MATCH (s:Stream)<-[:VIP]-()
RETURN s.name AS stream, count(*) AS vipCount
ORDER BY vipCount DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $v);
reduce $vipCount = count($v) groupby $sn;
sort $vipCount desc;
limit 3;"
twitch,216,Which streams have at least one user named 'itsbigchase' as a chatter?,"MATCH (s:Stream)
WHERE exists{ (u:User {name: 'itsbigchase'})-[:CHATTER]->(s) }
RETURN s","match
  $u isa user, has name ""itsbigchase"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
fetch { ""name"": $s.name };"
twitch,217,Identify the first 3 users who are VIPs in streams with a name containing 'big'.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.name CONTAINS 'big'
RETURN u.name AS user, s.name AS stream
LIMIT 3","match
  $s isa stream, has name $sn;
  $sn like ""%big%"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,218,"List the top 5 streams that have chatters with a total view count over 10,000.","MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE u.total_view_count > 10000
RETURN s.name AS stream_name, s.total_view_count AS stream_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $stvc;
  chat_activity (channel_with_chatters: $s, chatting_channel: $c);
  $c has total_view_count $ctvc;
  $ctvc > 10000;
sort $stvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""stream_views"": $stvc };"
twitch,219,"Which streams have a follower count above 10,000 and are associated with a game named 'Rust'?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 10000
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 10000;
fetch { ""name"": $s.name, ""followers"": $f };"
twitch,220,Identify the first 3 streams that play a game and have a VIP who is a user.,"MATCH (s:Stream)-[:PLAYS]->(:Game), (s)-[:VIP]->(u:User)
RETURN s, u
LIMIT 3","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 3;
fetch { ""stream"": $sn, ""user"": $un };"
twitch,221,List the first 3 streams that are linked to the game 'Rust' and have been created after 2018.,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.createdAt > date('2018-01-01')
RETURN s
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has created_at $ca;
  $ca > 2018-01-01;
limit 3;
fetch { ""name"": $s.name, ""created_at"": $ca };"
twitch,222,What are the top 5 most viewed streams that have a language set to 'en'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,223,Which streams have a description containing 'premiere' and have at least 5000 followers?,"MATCH (s:Stream)
WHERE s.description CONTAINS 'premiere' AND s.followers >= 5000
RETURN s","match
  $s isa stream, has description $d, has followers $f;
  $d like ""%premiere%"";
  $f >= 5000;
fetch { ""name"": $s.name, ""description"": $d, ""followers"": $f };"
twitch,224,Identify the first 3 streams that have chatters who are users with a follower count below 3000.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
WHERE u.followers < 3000
RETURN s.name AS stream_name, s.url AS stream_url
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has url $url, has created_at $ca;
  chat_activity (channel_with_chatters: $s, chatting_channel: $c);
  $c has followers $f;
  $f < 3000;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""stream_url"": $url };"
twitch,225,List the top 5 streams that are linked to teams created before 2015.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $t isa team, has created_at $ca;
  $ca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,226,What are the first 3 streams with a moderator named 'itsbigchase'?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has name $sn;
limit 3;
fetch { ""stream_name"": $sn };"
twitch,228,Identify the first 3 streams that have a language set to 'ru' and a moderator with a follower count above 5000.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'ru'})
MATCH (s)-[:MODERATOR]->(m:User)
WHERE m.followers > 5000
RETURN s
LIMIT 3","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
  $l has name ""ru"";
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has followers $f;
  $f > 5000;
limit 3;
fetch { ""stream"": $sn };"
twitch,229,List the top 5 streams that have at least one user as a chatter and are associated with the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE exists{ (s)<-[:CHATTER]-(:User) }
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,230,What are the first 3 streams that have a team with a creation date after 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01')
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $tca;
  $tca > 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
sort $tca asc;
limit 3;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $tca };"
twitch,231,Which streams have a total view count above 1 million and a moderator named 'creightonolsen'?,"MATCH (s:Stream)
WHERE s.total_view_count > 1000000 AND
      exists{ (s)-[:MODERATOR]->(:User {name: 'creightonolsen'}) }
RETURN s","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  $u isa user, has name ""creightonolsen"";
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
twitch,232,Identify the first 3 streams that have chatters who are streams created before 2017.,"MATCH (s:Stream)<-[:CHATTER]-(chatter:Stream)
WHERE chatter.createdAt < date(""2017-01-01"")
RETURN s.name as stream, s.createdAt as streamCreated
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $sca;
  chat_activity (channel_with_chatters: $s, chatting_channel: $chatter);
  $chatter has created_at $cca;
  $cca < 2017-01-01;
sort $sca asc;
limit 3;
fetch { ""stream"": $sn, ""streamCreated"": $sca };"
twitch,233,List the top 5 streams with moderators who are users and have a follower count above 2000.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.followers > 2000
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $sf;
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has followers $mf;
  $mf > 2000;
sort $sf desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $sf };"
twitch,234,What are the first 3 streams that have a VIP named 'itsbigchase'?,"MATCH (s:Stream)<-[:VIP]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name
LIMIT 3","match
  $u isa user, has name ""itsbigchase"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $s has name $sn;
limit 3;
fetch { ""stream_name"": $sn };"
twitch,235,"Which streams have a total view count below 10,000 and are linked to a language named 'en'?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count < 10000
RETURN s","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has total_view_count $tvc;
  $tvc < 10000;
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
twitch,236,Identify the first 3 streams that play a game named 'Rust' and have a VIP who is a user.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE exists{ (s)-[:VIP]->(:User) }
RETURN s
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $u);
limit 3;
fetch { ""name"": $s.name };"
twitch,237,List the top 5 streams that have chatters named 'itsbigchase'.,"MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream, s.url AS url
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $u isa user, has name ""itsbigchase"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  $s has name $sn, has url $su, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""url"": $su };"
twitch,238,What are the first 3 streams that were created after 2015 and have a follower count above 1000?,"MATCH (s:Stream)
WHERE s.createdAt > datetime('2015-01-01') AND s.followers > 1000
RETURN s
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has created_at $ca, has followers $f;
  $ca > 2015-01-01;
  $f > 1000;
sort $ca asc;
limit 3;
fetch { ""name"": $s.name, ""created_at"": $ca, ""followers"": $f };"
twitch,239,Which streams have a follower count exceeding 2000 and are playing a game named 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.followers > 2000
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 2000;
fetch { ""name"": $s.name, ""followers"": $f };"
twitch,240,"Identify the first 3 users who are moderators for streams with a total view count exceeding 500,000.","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u.name, u.id
ORDER BY u.createdAt
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 3;
fetch { ""name"": $un };"
twitch,241,List the top 5 streams with the most chatters who are users.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;"
twitch,242,What are the first 3 streams that have a language set to 'en' and a VIP who is a user?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WHERE EXISTS {
  (s)-[:VIP]->(:User)
}
RETURN s
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  vip_status (channel_with_vips: $s, vip_user: $u);
limit 3;
fetch { ""name"": $s.name };"
twitch,243,"Which streams have a description containing 'casual play' and a total view count above 100,000?","MATCH (s:Stream)
WHERE s.description CONTAINS 'casual play' AND s.total_view_count > 100000
RETURN s","match
  $s isa stream, has description $d, has total_view_count $tvc;
  $d like ""%casual play%"";
  $tvc > 100000;
fetch { ""name"": $s.name, ""description"": $d, ""total_view_count"": $tvc };"
twitch,244,Identify the first 3 streams that have a team named 'ESO Stream Team' and a follower count below 5000.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
WHERE s.followers < 5000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.createdAt
LIMIT 3","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn, has followers $f, has created_at $ca;
  $f < 5000;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,245,List the top 5 streams that have a moderator named 'itsbigchase' and were created before 2018.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
WHERE s.createdAt < date('2018-01-01')
RETURN s.name AS stream, s.createdAt AS createdAt
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has name $sn, has created_at $ca, has total_view_count $tvc;
  $ca < 2018-01-01;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""createdAt"": $ca };"
twitch,246,"What are the first 3 streams with a language named 'ru' and a total view count below 10,000?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.total_view_count < 10000
RETURN s.name, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
  $tvc < 10000;
sort $tvc desc;
limit 3;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
twitch,247,What are the names of the first 5 streams created before 2010?,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s.name
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  $ca < 2010-01-01;
sort $ca asc;
limit 5;
fetch { ""name"": $sn };"
twitch,248,List the top 3 games with the most streams playing them.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
RETURN g.name AS game, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $stream_count = count($s) groupby $gn;
sort $stream_count desc;
limit 3;"
twitch,249,Which 5 streams have the highest total view count?,"MATCH (s:Stream)
RETURN s.name, s.total_view_count
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 5;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
twitch,250,Name the top 5 users who are moderators for more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;"
twitch,251,What are the first 3 languages spoken by streams with over 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN l.name AS language
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
sort $tvc desc;
limit 3;
fetch { ""language"": $ln };"
twitch,252,Which streams are part of a team created after 2015 and list the first 5.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01')
RETURN s.name AS stream, t.name AS team
LIMIT 5","match
  $t isa team, has name $tn, has created_at $ca;
  $ca > 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
limit 5;
fetch { ""stream"": $sn, ""team"": $tn };"
twitch,253,"What are the descriptions of the first 3 streams with fewer than 100,000 followers?","MATCH (s:Stream)
WHERE s.followers < 100000
RETURN s.description
LIMIT 3","match
  $s isa stream, has followers $f, has description $d;
  $f < 100000;
limit 3;
fetch { ""description"": $d };"
twitch,254,List the top 5 teams by the number of streams they have.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 5;"
twitch,255,Which users are VIPs for the first 5 streams with the most followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, u
ORDER BY s.followers DESC
LIMIT 5
RETURN s.name AS stream, collect(u.name) AS vips","match
  $s isa stream, has name $sn, has followers $f;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""vip"": $un };"
twitch,256,Identify the top 3 streams that have the language 'en'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,257,What are the top 5 streams by followers that play the game 'Dota 2'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Dota 2'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $g isa game, has name ""Dota 2"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,258,"List all the games that have been played by streams with more than 5 million total views, showing the first 3.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 5000000
RETURN g.name AS game
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 5000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""game"": $gn };"
twitch,259,Who are the first 5 moderators for the stream with the highest total view count?,"MATCH (s:Stream)
WITH s
ORDER BY s.total_view_count DESC
LIMIT 1
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name AS moderator
LIMIT 5","match
  $s isa stream, has total_view_count $tvc;
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
sort $tvc desc;
limit 5;
fetch { ""moderator"": $mn };"
twitch,260,What are the URLs of the first 3 streams that have no chatters?,"MATCH (s:Stream)
WHERE NOT exists{ (s)<-[:CHATTER]-() }
RETURN s.url
LIMIT 3","match
  $s isa stream, has url $u;
  not { chat_activity (channel_with_chatters: $s); };
limit 3;
fetch { ""url"": $u };"
twitch,261,Name the first 5 streams that have no moderators and no VIPs.,"MATCH (s:Stream)
WHERE NOT exists{ (s)<-[:MODERATOR]-() } 
  AND NOT exists{ (s)<-[:VIP]-() }
RETURN s.name
LIMIT 5","match
  $s isa stream, has name $sn;
  not { moderation (moderated_channel: $s); };
  not { vip_status (channel_with_vips: $s); };
limit 5;
fetch { ""name"": $sn };"
twitch,262,"Which users have moderated the most streams, and list the top 3.","MATCH (u:User)-[m:MODERATOR]->(s:Stream)
WITH u, count(m) AS num_moderated
ORDER BY num_moderated DESC
LIMIT 3
RETURN u.name AS user, num_moderated","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated = count($s) groupby $un;
sort $num_moderated desc;
limit 3;"
twitch,263,List the first 3 users who are both moderators and VIPs in different streams.,"MATCH (u:User)-[:MODERATOR]->(s1:Stream), (u)-[:VIP]->(s2:Stream)
WHERE s1 <> s2
RETURN DISTINCT u.name AS user
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s1);
  vip_status (vip_user: $u, channel_with_vips: $s2);
  not { $s1 is $s2; };
limit 3;
fetch { ""user"": $un };"
twitch,264,What are the first 5 streams that have a language not listed in 'en' or 'ja'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name <> 'en' AND l.name <> 'ja'
RETURN s.name, l.name
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
  not { $ln == ""en""; };
  not { $ln == ""ja""; };
limit 5;
fetch { ""stream"": $sn, ""language"": $ln };"
twitch,266,"Name the first 5 users who are chatters in streams with more than 500,000 followers.","MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.followers > 500000
RETURN u.name
LIMIT 5","match
  $s isa stream, has followers $f;
  $f > 500000;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
twitch,267,List the top 5 games by the number of languages they are streamed in.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH g, count(distinct l) as languageCount
RETURN g.name as game, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $g has name $gn;
reduce $languageCount = count($l) groupby $gn;
sort $languageCount desc;
limit 5;"
twitch,268,Which 3 teams were created most recently and have at least one stream associated with them?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS stream_count
WHERE stream_count > 0
RETURN t.name AS team_name, t.createdAt AS created_at
ORDER BY t.createdAt DESC
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
sort $ca desc;
limit 3;
fetch { ""team_name"": $tn, ""created_at"": $ca };"
twitch,269,What are the first 3 streams that have been played continuously since their creation date without changing the game?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, g, s.createdAt AS createdAt
ORDER BY createdAt
WITH s, g, createdAt, count(DISTINCT g) AS numGames
WHERE numGames = 1
RETURN s.name AS streamName, g.name AS gameName, createdAt
ORDER BY createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""streamName"": $sn, ""gameName"": $gn, ""createdAt"": $ca };"
twitch,270,"Which streams have a follower count between 10,000 and 50,000, listing the first 5?","MATCH (s:Stream)
WHERE s.followers >= 10000 AND s.followers <= 50000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 10000;
  $f <= 50000;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,271,Name the top 3 users who are VIPs in the stream with the most followers.,"MATCH (s:Stream)-[:VIP]->(u:User)
WITH s, u
ORDER BY s.followers DESC
LIMIT 1
RETURN u.name AS user
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $f desc;
limit 3;
fetch { ""user"": $un };"
twitch,272,"List the first 3 streams that have VIP relationships only with other streams, not users.","MATCH (s:Stream)
WHERE exists {(s)-[:VIP]->(:Stream)}
  AND NOT exists {(s)-[:VIP]->(:User)}
RETURN s
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (vip_channel: $s, channel_with_vips: $other);
  not { vip_status (channel_with_vips: $s, vip_user: $u); };
limit 3;
fetch { ""name"": $sn };"
twitch,273,Who are the first 5 users chatting in streams labeled with the game 'Rust'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user
LIMIT 5","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""user"": $un };"
twitch,274,What are the first 3 streams that have a team with a creation date before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $tca;
  $tca < 2015-01-01;
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
sort $tca asc;
limit 3;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $tca };"
twitch,275,"Which streams play 'VALORANT' and have over one million total views, listing the first 5?","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'VALORANT'})
WHERE s.total_view_count > 1000000
RETURN s.name AS stream, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $g isa game, has name ""VALORANT"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""total_views"": $tvc };"
twitch,276,Who are the first 3 stream moderators who have been in that role since before 2015?,"MATCH (s:Stream)-[:MODERATOR]->(m:User)
WHERE m.createdAt < date('2015-01-01')
RETURN m.name AS moderator, m.createdAt AS modSince
ORDER BY m.createdAt
LIMIT 3","match
  $s isa stream;
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has name $mn, has created_at $ca;
  $ca < 2015-01-01T00:00:00;
sort $ca asc;
limit 3;
fetch { ""moderator"": $mn, ""modSince"": $ca };"
twitch,277,List the first 5 streams that have changed their primary game at least once.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) AS num_games
WHERE num_games > 1
RETURN s.name AS stream_name, s.url AS stream_url
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has url $su, has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g1);
  game_play (streaming_channel: $s, played_game: $g2);
  not { $g1 is $g2; };
sort $ca asc;
limit 5;
fetch { ""stream_name"": $sn, ""stream_url"": $su };"
twitch,278,What are the names of the first 3 teams with streams playing 'Rust' and having over a million followers?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 1000000
RETURN t.name
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has followers $f;
  $f > 1000000;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
limit 3;
fetch { ""name"": $tn };"
twitch,279,Which streams have the description mentioning 'professional' and list the first 3.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'professional'
RETURN s.name, s.description
LIMIT 3","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%professional%"";
limit 3;
fetch { ""name"": $sn, ""description"": $d };"
twitch,280,What are the first 5 user names who are chatters in streams playing 'Dota 2'?,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(:Game {name: 'Dota 2'})
RETURN u.name
LIMIT 5","match
  $g isa game, has name ""Dota 2"";
  game_play (streaming_channel: $s, played_game: $g);
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
twitch,281,"How many languages are used by streams with a total view count over 10 million, listing the first 3?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 10000000
RETURN l.name AS language
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
limit 3;
fetch { ""language"": $ln };"
twitch,283,List the first 3 games played by streams with a language 'ja'.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ja'})
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game
LIMIT 3","match
  $l isa language, has name ""ja"";
  language_usage (channel: $s, used_language: $l);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
limit 3;
fetch { ""game"": $gn };"
twitch,284,"List the first 5 streams with a follower count exactly at 100,000.","MATCH (s:Stream)
WHERE s.followers = 100000
RETURN s.name, s.url, s.followers
LIMIT 5","match
  $s isa stream, has name $sn, has url $u, has followers 100000;
limit 5;
fetch { ""name"": $sn, ""url"": $u, ""followers"": 100000 };"
twitch,285,What are the first 3 streams that have been in the same team since their creation and still active?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt = t.createdAt
RETURN s.name AS stream_name, t.name AS team_name
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $sca;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn, has created_at $sca;
sort $sca asc;
limit 3;
fetch { ""stream_name"": $sn, ""team_name"": $tn };"
twitch,287,Who are the first 5 users who have been moderators in streams with a language other than 'en'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE l.name <> 'en'
RETURN u.name AS user, u.createdAt AS created_at
ORDER BY u.createdAt
LIMIT 5","match
  $m isa stream, has name $mn, has created_at $ca;
  moderation (moderating_channel: $m, moderated_channel: $s);
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
  not { $ln == ""en""; };
sort $ca asc;
limit 5;
fetch { ""user"": $mn, ""created_at"": $ca };"
twitch,289,"Which streams are the first 3 that have a VIP user with over 500,000 followers?","MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.followers > 500000
RETURN s.name AS stream_name, u.name AS vip_user
ORDER BY u.followers DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_channel: $v);
  $v has name $vn, has followers $f;
  $f > 500000;
sort $f desc;
limit 3;
fetch { ""stream_name"": $sn, ""vip_user"": $vn };"
twitch,290,What are the first 5 streams that have a user who is both a moderator and a VIP?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)-[:VIP]->(s)
RETURN s.name AS stream, u.name AS user
LIMIT 5","match
  moderation (moderated_channel: $s, moderating_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
  $s has name $sn;
  $u has name $un;
limit 5;
fetch { ""stream"": $sn, ""user"": $un };"
twitch,292,Who are the first 5 chatters in the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)<-[:CHATTER]-(chatter:User)
RETURN chatter.name
LIMIT 5","match
  $s isa stream, has followers $f;
  chat_activity (channel_with_chatters: $s, chatting_user: $chatter);
  $chatter has name $cn;
sort $f desc;
limit 5;
fetch { ""name"": $cn };"
twitch,293,List the first 3 streams with the oldest teams associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt
ORDER BY t.createdAt
LIMIT 3","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn, has created_at $tca;
sort $tca asc;
limit 3;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $tca };"
twitch,294,Which 3 users have chatted in the most streams and what are their names?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3
RETURN u.name AS user_name, stream_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $stream_count = count($s) groupby $un;
sort $stream_count desc;
limit 3;"
twitch,295,What are the URLs of the first 3 streams with the most languages spoken?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 3
RETURN s.url AS streamURL","match
  $s isa stream, has url $u;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $u;
sort $languageCount desc;
limit 3;"
twitch,296,List the first 5 streams that have been moderated by the same user for over 5 years.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE u.createdAt < datetime() - duration('P5Y')
WITH s, u
ORDER BY s.createdAt
LIMIT 5
RETURN s.name AS stream, u.name AS moderator","match
  $s isa stream, has name $sn, has created_at $sca;
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has name $mn, has created_at $mca;
  $mca < 2016-01-01T00:00:00;
sort $sca asc;
limit 5;
fetch { ""stream"": $sn, ""moderator"": $mn };"
twitch,297,Who are the first 3 VIPs in streams with a total view count exceeding 10 million?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE s.total_view_count > 10000000
RETURN u.name AS vip_name
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 10000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $tvc desc;
limit 3;
fetch { ""vip_name"": $un };"
twitch,298,"Which streams with a description mentioning 'streaming' have the most followers, listing the first 5?","MATCH (s:Stream)
WHERE s.description CONTAINS 'streaming'
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has description $d, has followers $f;
  $d like ""%streaming%"";
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,299,Name the first 5 streams with the lowest follower count and still active.,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers ASC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f asc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,301,List the first 5 games with streams that have been active for over 10 years.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
WHERE s.createdAt < datetime() - duration('P10Y')
RETURN g.name AS game, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $g isa game, has name $gn;
  game_play (streaming_channel: $s, played_game: $g);
  $s has created_at $ca;
  $ca < 2011-01-01T00:00:00;
limit 5;
fetch { ""game"": $gn };"
twitch,302,Who are the first 3 users who have VIP status in streams playing 'Rust'?,"MATCH (u:User)-[:VIP]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user, s.name AS stream
ORDER BY s.createdAt
LIMIT 3","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn, has created_at $ca;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $ca asc;
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,303,Which are the first 5 streams that have more than one language associated with them?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 1
RETURN s.name as streamName, s.url as streamUrl, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  not { $l1 is $l2; };
limit 5;
fetch { ""streamName"": $sn, ""streamUrl"": $su };"
twitch,305,What are the top 3 streams by total view count that also have a team associated with them?,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
sort $tvc desc;
limit 3;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,307,List the first 3 teams with the most streams playing 'Dota 2'.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)-[:PLAYS]->(:Game {name: 'Dota 2'})
RETURN t.name AS team, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $g isa game, has name ""Dota 2"";
  game_play (streaming_channel: $s, played_game: $g);
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
reduce $stream_count = count($s) groupby $tn;
sort $stream_count desc;
limit 3;"
twitch,308,"Which users are chatters in the most streams, listing the first 5.","MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5
RETURN u.name AS user, stream_count","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
reduce $stream_count = count($s) groupby $un;
sort $stream_count desc;
limit 5;"
twitch,309,Name the first 3 streams that have had the same game since creation and more than 5 million total views.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 5000000
WITH s, g, s.createdAt AS createdAt
ORDER BY createdAt
LIMIT 3
RETURN s.name AS stream, g.name AS game","match
  $s isa stream, has name $sn, has total_view_count $tvc, has created_at $ca;
  $tvc > 5000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""stream"": $sn, ""game"": $gn };"
twitch,310,List the first 5 streams that have a description mentioning 'channel'.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'channel'
RETURN s.name, s.description
LIMIT 5","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%channel%"";
limit 5;
fetch { ""name"": $sn, ""description"": $d };"
twitch,311,Who are the first 5 users who are moderators in streams with over a million followers?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.followers > 1000000
RETURN u.name AS user, s.name AS stream
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f > 1000000;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
sort $f desc;
limit 5;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,312,What are the top 3 streams that have changed their language at least once?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 1
RETURN s.name as streamName, s.url as streamUrl, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $s isa stream, has name $sn, has url $su;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  not { $l1 is $l2; };
limit 3;
fetch { ""streamName"": $sn, ""streamUrl"": $su };"
twitch,313,Which streams have no team associated and list the first 5.,"MATCH (s:Stream)
WHERE NOT exists((s)-[:HAS_TEAM]->(:Team))
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 5","match
  $s isa stream, has name $sn, has url $su;
  not { team_membership (member_stream: $s); };
limit 5;
fetch { ""stream_name"": $sn, ""stream_url"": $su };"
twitch,315,Name the first 5 users who are VIPs in streams with descriptions mentioning 'fun'.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.description CONTAINS 'fun'
RETURN u.name
LIMIT 5","match
  $s isa stream, has description $d;
  $d like ""%fun%"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
limit 5;
fetch { ""name"": $un };"
twitch,317,List the first 5 streams where the game name and the stream name are the same.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.name = g.name
RETURN s.name AS stream_name, g.name AS game_name
LIMIT 5","match
  $s isa stream, has name $n;
  $g isa game, has name $n;
  game_play (streaming_channel: $s, played_game: $g);
limit 5;
fetch { ""stream_name"": $n, ""game_name"": $n };"
twitch,318,"Who are the first 5 users who have been VIPs in streams with fewer than 10,000 followers?","MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.followers < 10000
RETURN u.name AS user, s.name AS stream
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f, has created_at $ca;
  $f < 10000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
sort $ca asc;
limit 5;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,319,What are the first 3 streams that have a user chatter who also has a moderator role in another stream?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(otherStream:Stream)
RETURN s.name AS stream, u.name AS chatter
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderating_user: $u, moderated_channel: $other);
  $u has name $un;
sort $ca asc;
limit 3;
fetch { ""stream"": $sn, ""chatter"": $un };"
twitch,324,What are the URLs of the first 3 streams with the most chatters?,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.url AS stream_url, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has url $u;
  chat_activity (channel_with_chatters: $s, chatting_user: $c);
reduce $chatter_count = count($c) groupby $u;
sort $chatter_count desc;
limit 3;"
twitch,325,Who are the first 5 moderators in streams that play 'VALORANT'?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'VALORANT'})
MATCH (s)-[:MODERATOR]->(m:User)
RETURN m.name AS moderator
ORDER BY m.name
LIMIT 5","match
  $g isa game, has name ""VALORANT"";
  game_play (streaming_channel: $s, played_game: $g);
  moderation (moderated_channel: $s, moderating_user: $m);
  $m has name $mn;
limit 5;
fetch { ""moderator"": $mn };"
twitch,326,List the first 5 streams that have been in the same language and game for over 5 years.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language), (s)-[:PLAYS]->(g:Game)
WHERE s.createdAt < datetime() - duration('P5Y')
RETURN s.name AS stream, l.name AS language, g.name AS game
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
  $ca < 2016-01-01T00:00:00;
sort $ca asc;
limit 5;
fetch { ""stream"": $sn, ""language"": $ln, ""game"": $gn };"
twitch,327,Which streams have the description mentioning 'enjoy' and list the first 3.,"MATCH (s:Stream)
WHERE s.description CONTAINS 'enjoy'
RETURN s.name, s.description
LIMIT 3","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%enjoy%"";
limit 3;
fetch { ""name"": $sn, ""description"": $d };"
twitch,328,What are the first 5 streams that have a moderator with the same name as the stream's user?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE s.name = u.name
RETURN s.name AS stream_name, s.url AS stream_url
LIMIT 5","match
  $s isa stream, has name $n, has url $u;
  moderation (moderated_channel: $s, moderating_user: $usr);
  $usr has name $n;
limit 5;
fetch { ""stream_name"": $n, ""stream_url"": $u };"
twitch,329,Name the first 3 users who are chatters in the most streams with different games.,"MATCH (u:User)-[:CHATTER]->(s:Stream)-[:PLAYS]->(g:Game)
WITH u, count(DISTINCT g) AS num_games
ORDER BY num_games DESC
LIMIT 3
RETURN u.name AS user, num_games","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_games = count($g) groupby $un;
sort $num_games desc;
limit 3;"
twitch,330,List the first 5 streams that have a team and a game that both have the letter 'E' in them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team), (s)-[:PLAYS]->(g:Game)
WHERE t.name CONTAINS 'E' AND g.name CONTAINS 'E'
RETURN s.name AS stream, t.name AS team, g.name AS game
LIMIT 5","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
  $tn like ""%E%"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
  $gn like ""%E%"";
limit 5;
fetch { ""stream"": $sn, ""team"": $tn, ""game"": $gn };"
twitch,332,"What are the first 5 streams that have been active for over 5 years and have over 100,000 followers?","MATCH (s:Stream)
WHERE s.createdAt < datetime() - duration('P5Y') AND s.followers > 100000
RETURN s.name AS stream_name, s.createdAt AS created_at, s.followers AS follower_count
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca, has followers $f;
  $ca < 2016-01-01T00:00:00;
  $f > 100000;
sort $ca asc;
limit 5;
fetch { ""stream_name"": $sn, ""created_at"": $ca, ""follower_count"": $f };"
twitch,333,"Which streams have a follower count between 200,000 and 500,000, listing the first 5?","MATCH (s:Stream)
WHERE s.followers >= 200000 AND s.followers <= 500000
RETURN s.name AS stream_name, s.followers
ORDER BY s.followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  $f >= 200000;
  $f <= 500000;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,334,Who are the first 5 users who are chatters and VIPs in the same streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)<-[:VIP]-(u)
RETURN DISTINCT u.name AS user
LIMIT 5","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  vip_status (vip_user: $u, channel_with_vips: $s);
limit 5;
fetch { ""user"": $un };"
twitch,335,List the first 3 streams that have a moderator with a name starting with 'G'.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WHERE m.name STARTS WITH 'G'
RETURN s.name AS stream, m.name AS moderator
LIMIT 3","match
  $s isa stream, has name $sn;
  $m isa user, has name $mn;
  moderation (moderated_channel: $s, moderating_user: $m);
  $mn like ""^G.*"";
limit 3;
fetch { ""stream"": $sn, ""moderator"": $mn };"
twitch,336,Who are the first 5 users who have moderated streams with descriptions mentioning 'professional'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.description CONTAINS 'professional'
RETURN u.name AS user, s.name AS stream
ORDER BY u.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has description $d;
  $d like ""%professional%"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
limit 5;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,337,List the first 5 streams where the user and moderator have the same name.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
WHERE s.name = u.name
RETURN s.name, s.url
LIMIT 5","match
  $s isa stream, has name $n, has url $u;
  moderation (moderated_channel: $s, moderating_user: $usr);
  $usr has name $n;
limit 5;
fetch { ""name"": $n, ""url"": $u };"
twitch,338,Which streams have a total view count of over 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 10000000
RETURN s.name, s.total_view_count","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 10000000;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
twitch,339,List the top 5 streams by follower count.,"MATCH (s:Stream)
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,340,"What are the names of games played by streams with more than 100,000 followers?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 100000
RETURN DISTINCT g.name","match
  $s isa stream, has followers $f;
  $f > 100000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,341,"Which users are moderators for streams with more than 500,000 total views?","MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 500000
RETURN u.name AS user, s.name AS stream, s.total_view_count AS views","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 500000;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn, ""views"": $tvc };"
twitch,342,What are the descriptions of streams that play the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
WHERE s.description IS NOT NULL
RETURN s.description","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has description $d;
fetch { ""description"": $d };"
twitch,343,Which streams have 'en' as their language and more than 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.total_view_count > 1000000
RETURN s.name AS stream_name, s.total_view_count AS total_views","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,344,List the names of all teams created before 2015.,"MATCH (t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN t.name","match
  $t isa team, has name $tn, has created_at $ca;
  $ca < 2015-01-01;
fetch { ""name"": $tn };"
twitch,345,Which streams are part of the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s.name AS stream_name","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  $s has name $sn;
fetch { ""stream_name"": $sn };"
twitch,346,What are the URLs of the top 3 streams by total view count?,"MATCH (s:Stream)
RETURN s.url AS stream_url
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has url $u, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream_url"": $u };"
twitch,349,Find streams that have both 'MODERATOR' and 'VIP' relationships.,"MATCH (s:Stream)
WHERE exists{ (s)-[:MODERATOR]->(:User) } AND exists{ (s)-[:VIP]->(:User) }
RETURN s","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $m);
  vip_status (channel_with_vips: $s, vip_user: $v);
fetch { ""name"": $sn };"
twitch,350,"Which games are played by streams that have a total view count greater than 500,000?","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 500000
RETURN DISTINCT g.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,351,How many users are moderators for the stream 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})<-[:MODERATOR]-(u:User)
RETURN count(u) AS num_moderators","match
  $s isa stream, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderators = count($u);"
twitch,352,"What are the first 3 languages spoken in streams with more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;"
twitch,353,"Which streams were created between 2015 and 2020 and have more than 100,000 followers?","MATCH (s:Stream)
WHERE s.createdAt >= datetime('2015-01-01') AND s.createdAt < datetime('2021-01-01')
  AND s.followers > 100000
RETURN s","match
  $s isa stream, has created_at $ca, has followers $f;
  $ca >= 2015-01-01;
  $ca < 2021-01-01;
  $f > 100000;
fetch { ""name"": $s.name, ""created_at"": $ca, ""followers"": $f };"
twitch,354,Identify streams that were created on or after 2018 and are part of teams.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.createdAt >= date(""2018-01-01"")
RETURN s","match
  $s isa stream, has created_at $ca;
  $ca >= 2018-01-01;
  team_membership (member_stream: $s, organization: $t);
fetch { ""name"": $s.name, ""created_at"": $ca };"
twitch,355,What are the follower counts of streams that play 'Rust' and have 'en' as their language?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'}), 
      (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WHERE s.followers IS NOT NULL
RETURN s.name AS stream, s.followers AS followerCount","match
  $g isa game, has name ""Rust"";
  $l isa language, has name ""en"";
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has followers $f;
fetch { ""stream"": $sn, ""followerCount"": $f };"
twitch,357,What are the names of users who have moderated other users?,"MATCH (u:User)-[:MODERATOR]->(otherUser:User)
RETURN DISTINCT u.name","match
  moderation (moderating_user: $u, moderated_user: $other);
  $u has name $un;
fetch { ""name"": $un };"
twitch,358,Which streams have no team associations?,"MATCH (s:Stream)
WHERE NOT exists{ (s)-[:HAS_TEAM]->(:Team) }
RETURN s","match
  $s isa stream, has name $sn;
  not { team_membership (member_stream: $s); };
fetch { ""name"": $sn };"
twitch,359,Find the descriptions of streams that have chatted with the user '9linda'.,"MATCH (s:Stream)-[:CHATTER]->(:User {name: '9linda'})
WHERE s.description IS NOT NULL
RETURN s.description","match
  $s isa stream, has description $d;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  $u has name ""9linda"";
fetch { ""description"": $d };"
twitch,360,Which teams were formed in 2020?,"MATCH (t:Team)
WHERE t.createdAt >= date(""2020-01-01"") AND t.createdAt < date(""2021-01-01"")
RETURN t.name AS team","match
  $t isa team, has name $tn, has created_at $ca;
  $ca >= 2020-01-01;
  $ca < 2021-01-01;
fetch { ""team"": $tn };"
twitch,361,How many languages are associated with streams that have over 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN count(distinct l) as num_languages","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  language_usage (channel: $s, used_language: $l);
reduce $num_languages = count($l);"
twitch,362,What is the total view count of streams that are moderated by 'itsbigchase'?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN sum(s.total_view_count) AS total_views","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
  $s has total_view_count $tvc;
reduce $total_views = sum($tvc);"
twitch,363,"Which streams have the user 'creightonolsen' as a chatter and have more than 100,000 views?","MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'creightonolsen'})
WHERE s.total_view_count > 100000
RETURN s","match
  $u isa user, has name ""creightonolsen"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
  $s has total_view_count $tvc;
  $tvc > 100000;
fetch { ""name"": $s.name, ""total_view_count"": $tvc };"
twitch,364,List the streams where 'romandoduik' is a chatter.,"MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'romandoduik'})
RETURN s.name AS stream_name, s.url AS stream_url","match
  $u isa user, has name ""romandoduik"";
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
fetch { ""stream_name"": $s.name, ""stream_url"": $s.url };"
twitch,365,Which users are moderators in streams that play 'Rust'?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user, s.name AS stream","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  $s has name $sn;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,366,How many streams has each team associated with them?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;"
twitch,367,What are the properties of the stream with the highest number of followers?,"MATCH (s:Stream)
RETURN s
ORDER BY s.followers DESC
LIMIT 1","match
  $s isa stream, has followers $f;
sort $f desc;
limit 1;
fetch { ""name"": $s.name, ""followers"": $f, ""total_view_count"": $s.total_view_count };"
twitch,368,List all games that have been played by streams associated with the 'ESO Stream Team'.,"MATCH (team:Team {name: 'ESO Stream Team'})<-[:HAS_TEAM]-(stream:Stream)-[:PLAYS]->(game:Game)
RETURN DISTINCT game.name","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,369,"Which language is most commonly associated with streams that have more than 500,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 500000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 1","match
  $s isa stream, has followers $f;
  $f > 500000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 1;"
twitch,370,Identify streams that have a creation date before 2010.,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s","match
  $s isa stream, has created_at $ca;
  $ca < 2010-01-01;
fetch { ""name"": $s.name, ""created_at"": $ca };"
twitch,371,Which streams have users with the role of both VIP and moderator?,"MATCH (s:Stream)
WHERE exists{ (s)<-[:VIP]-(:User)-[:MODERATOR]->(s) }
RETURN s","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $sn };"
twitch,372,List the top 5 users by the number of streams they moderate.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;"
twitch,373,What are the descriptions of the streams with the oldest creation dates?,"MATCH (s:Stream)
WITH s
ORDER BY s.createdAt
LIMIT 5
RETURN s.description","match
  $s isa stream, has description $d, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""description"": $d };"
twitch,374,Which games are played by streams that are part of teams created after 2017?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2017-01-01')
WITH s
MATCH (s)-[:PLAYS]->(g:Game)
RETURN DISTINCT g.name","match
  $t isa team, has created_at $ca;
  $ca > 2017-01-01;
  team_membership (member_stream: $s, organization: $t);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,375,How many streams are associated with each language?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(s) AS streamCount
ORDER BY streamCount DESC","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $streamCount = count($s) groupby $ln;
sort $streamCount desc;"
twitch,376,List the top 3 streams that have the most chatters.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $c);
reduce $chatter_count = count($c) groupby $sn;
sort $chatter_count desc;
limit 3;"
twitch,377,Which users have been VIPs in streams with a total view count over 5 million?,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 5000000
RETURN u.name AS user, s.name AS stream, s.total_view_count AS views","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 5000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn, ""views"": $tvc };"
twitch,378,Find streams where 'itsbigchase' is a moderator.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""name"": $s.name, ""url"": $s.url };"
twitch,379,What are the follower counts for streams that have 'ru' as their language?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
RETURN s.name AS stream_name, s.followers AS follower_count","match
  $l isa language, has name ""ru"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn, has followers $f;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,380,List all users who have chatted with the stream 'itsbigchase'.,"MATCH (u:User)-[:CHATTER]->(s:Stream {name: 'itsbigchase'})
RETURN u","match
  $s isa stream, has name ""itsbigchase"";
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""name"": $u.name };"
twitch,381,Which streams are connected to the game 'Rust' and have at least one VIP?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE exists{ (s)<-[:VIP]-() }
RETURN s","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $v);
fetch { ""name"": $s.name };"
twitch,382,What are the URLs of streams where 'itsbigchase' is a moderator?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s.url","match
  $u isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""url"": $s.url };"
twitch,383,What are the properties of the streams where '9linda' is a VIP?,"MATCH (s:Stream)<-[:VIP]-(:User {name: '9linda'})
RETURN s.createdAt, s.id, s.description, s.url, s.name, s.followers, s.total_view_count","match
  $u isa user, has name ""9linda"";
  vip_status (vip_user: $u, channel_with_vips: $s);
fetch { ""name"": $s.name, ""url"": $s.url, ""description"": $s.description, ""followers"": $s.followers, ""total_view_count"": $s.total_view_count };"
twitch,384,What are the names of the top 5 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,385,Which games have been played by streams with more than 1 million total views?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN DISTINCT g.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,386,List the names of 3 streams that are conducted in the English language.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
RETURN s.name
LIMIT 3","match
  $l isa language, has name ""en"";
  language_usage (channel: $s, used_language: $l);
  $s has name $sn;
limit 3;
fetch { ""name"": $sn };"
twitch,387,Which streams have moderators who are also users?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
RETURN s, u","match
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""stream"": $s.name, ""user"": $u.name };"
twitch,388,What are the names of the 3 newest teams in the database?,"MATCH (t:Team)
RETURN t.name
ORDER BY t.createdAt DESC
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""name"": $tn };"
twitch,389,How many streams are associated with the game 'Rust'?,"MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Rust'})
RETURN count(s) AS num_streams","match
  $g isa game, has name ""Rust"";
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_streams = count($s);"
twitch,390,What are the URLs of the top 3 streams by total view count?,"MATCH (s:Stream)
RETURN s.url AS stream_url
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has url $u, has total_view_count $tvc;
sort $tvc desc;
limit 3;
fetch { ""stream_url"": $u };"
twitch,391,Which users are moderators in more than one stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;"
twitch,392,List the streams that have more than 5 million followers.,"MATCH (s:Stream)
WHERE s.followers > 5000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers DESC","match
  $s isa stream, has name $sn, has followers $f;
  $f > 5000000;
sort $f desc;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,393,What are the names of streams that play 'Grand Theft Auto V' and have English as their language?,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Grand Theft Auto V'})
WHERE (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
RETURN s.name","match
  $g isa game, has name ""Grand Theft Auto V"";
  $l isa language, has name ""en"";
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $s has name $sn;
fetch { ""name"": $sn };"
twitch,394,Which users are VIPs in the stream named 'itsbigchase'?,"MATCH (s:Stream {name: 'itsbigchase'})<-[:VIP]-(u:User)
RETURN u.name AS user","match
  $s isa stream, has name ""itsbigchase"";
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un };"
twitch,395,How many streams are part of the 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN count(s)","match
  $t isa team, has name ""ESO Stream Team"";
  team_membership (member_stream: $s, organization: $t);
reduce $count = count($s);"
twitch,396,Which games are played by the oldest streams in the database?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, g
ORDER BY s.createdAt
LIMIT 1
RETURN g.name AS game","match
  $s isa stream, has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 1;
fetch { ""game"": $gn };"
twitch,397,Find 3 languages spoken in streams with the highest number of followers.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, max(s.followers) AS max_followers
ORDER BY max_followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $max_followers = max($f) groupby $ln;
sort $max_followers desc;
limit 3;"
twitch,398,What are the names of users who are both moderators and VIPs in any stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)<-[:VIP]-(u)
RETURN DISTINCT u.name","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s, moderating_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""name"": $un };"
twitch,399,List the top 5 streams based on their creation date.,"MATCH (s:Stream)
RETURN s.name, s.createdAt
ORDER BY s.createdAt DESC
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca desc;
limit 5;
fetch { ""name"": $sn, ""createdAt"": $ca };"
twitch,400,What are the descriptions of the streams with the least followers?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s.description
ORDER BY s.followers
LIMIT 1","match
  $s isa stream, has description $d, has followers $f;
sort $f asc;
limit 1;
fetch { ""description"": $d };"
twitch,401,Which teams were created before 2015?,"MATCH (t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN t.name AS team, t.createdAt AS createdAt","match
  $t isa team, has created_at $ca, has name $n;
  $ca < 2015-01-01;
fetch { ""team"": $n, ""createdAt"": $ca };"
twitch,402,How many users are chatters in more than one stream?,"MATCH (u:User)-[:CHATTER]->(:Stream)
WITH u, count(DISTINCT u) AS stream_count
WHERE stream_count > 1
RETURN count(u) AS user_count","match
  $u isa user;
  chat_activity (channel_with_chatters: $s1, chatting_user: $u);
  chat_activity (channel_with_chatters: $s2, chatting_user: $u);
  not { $s1 is $s2; };
reduce $count = count($u);"
twitch,403,List streams that have a total view count greater than 500 million.,"MATCH (s:Stream)
WHERE s.total_view_count > 500000000
RETURN s.name AS stream_name, s.total_view_count AS view_count
ORDER BY s.total_view_count DESC","match
  $s isa stream, has total_view_count $tvc, has name $n;
  $tvc > 500000000;
sort $tvc desc;
fetch { ""stream_name"": $n, ""view_count"": $tvc };"
twitch,404,What are the follower counts for streams named 'summit1g'?,"MATCH (s:Stream {name: 'summit1g'})
RETURN s.name AS stream_name, s.followers AS follower_count","match
  $s isa stream, has name ""summit1g"", has followers $f;
fetch { ""stream_name"": ""summit1g"", ""follower_count"": $f };"
twitch,405,Find the streams by 'itsbigchase' and list their games.,"MATCH (s:Stream {name: 'itsbigchase'})-[:PLAYS]->(g:Game)
RETURN s.name AS stream, g.name AS game","match
  $s isa stream, has name ""itsbigchase"";
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""stream"": ""itsbigchase"", ""game"": $gn };"
twitch,406,What are the total view counts for streams that have moderators?,"MATCH (s:Stream)-[:MODERATOR]->(:User)
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY total_views DESC","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  moderation (moderated_channel: $s, moderating_user: $u);
sort $tvc desc;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,407,List the names of users who are VIPs in more than 3 streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
WHERE vip_count > 3
RETURN u.name","match
$user isa user;
vip_status (vip_user: $user, channel_with_vips: $stream);
reduce $count = count groupby $user;
match
$count > 3;
fetch {
  ""user"": $user.name
};"
twitch,408,Which streams have chatters that are also streams?,"MATCH (s1:Stream)-[:CHATTER]->(s2:Stream)
RETURN s1, s2","match
  $s1 isa stream, has name $n1;
  $s2 isa stream, has name $n2;
  chat_activity (chatting_channel: $s2, channel_with_chatters: $s1);
fetch { ""stream1"": $n1, ""stream2"": $n2 };"
twitch,409,Name the games played by streams that have a follower count over 2 million.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 2000000
RETURN DISTINCT g.name","match
  $s isa stream, has followers $f;
  $f > 2000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""game"": $gn };"
twitch,410,What are the URLs for streams that are part of teams created in 2020?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt >= date(""2020-01-01"") AND t.createdAt < date(""2021-01-01"")
RETURN s.url","match
  $s isa stream, has url $u;
  $t isa team, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
  $ca >= 2020-01-01;
  $ca < 2021-01-01;
fetch { ""url"": $u };"
twitch,411,List the top 3 teams by the number of associated streams.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 3","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $stream_count = count($s) groupby $tn;
sort $stream_count desc;
limit 3;
fetch { ""team"": $tn, ""stream_count"": $stream_count };"
twitch,412,"How many streams have the language 'de' and more than 10,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'de'})
WHERE s.followers > 10000
RETURN count(s)","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name ""de"";
reduce $count = count($s);"
twitch,413,What are the names of streams with the oldest creation dates and their associated games?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, g
ORDER BY s.createdAt
LIMIT 1
RETURN s.name AS stream_name, g.name AS game_name","match
  $s isa stream, has name $sn, has created_at $ca;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 1;
fetch { ""stream_name"": $sn, ""game_name"": $gn };"
twitch,414,List the top 5 streams with the highest follower count.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,415,Which streams have a total view count greater than 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 10000000
RETURN s.name, s.total_view_count","match
  $s isa stream, has name $n, has total_view_count $tvc;
  $tvc > 10000000;
fetch { ""name"": $n, ""total_view_count"": $tvc };"
twitch,416,"Identify 3 games most played by streams with more than 100,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 100000
WITH g, count(*) as playCount
ORDER BY playCount DESC
LIMIT 3
RETURN g.name as game, playCount","match
  $s isa stream, has followers $f;
  $f > 100000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $playCount = count($s) groupby $gn;
sort $playCount desc;
limit 3;
fetch { ""game"": $gn, ""playCount"": $playCount };"
twitch,417,What are the top 3 most common languages used by streams?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
reduce $count = count($s) groupby $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
twitch,418,"Find the streams that have 'en' as their language and more than 500,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.followers > 500000
RETURN s","match
  $s isa stream, has name $sn, has followers $f, has url $u, has total_view_count $tvc;
  $f > 500000;
  language_usage (channel: $s, used_language: $l);
  $l has name ""en"";
fetch { ""name"": $sn, ""followers"": $f, ""url"": $u, ""total_view_count"": $tvc };"
twitch,419,Which users are moderators for more than one stream? List the top 3.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s1, moderating_user: $u);
  moderation (moderated_channel: $s2, moderating_user: $u);
  not { $s1 is $s2; };
reduce $num_moderated = count($s1) groupby $un;
sort $num_moderated desc;
limit 3;
fetch { ""user"": $un, ""num_moderated_streams"": $num_moderated };"
twitch,420,Display the top 5 streams that play the game 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Rust"";
sort $f desc;
limit 5;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,421,Show 3 streams that were created before 2010.,"MATCH (s:Stream)
WHERE s.createdAt < date(""2010-01-01"")
RETURN s.name, s.createdAt, s.url
LIMIT 3","match
  $s isa stream, has name $n, has created_at $ca, has url $u;
  $ca < 2010-01-01;
limit 3;
fetch { ""name"": $n, ""createdAt"": $ca, ""url"": $u };"
twitch,422,Which streams are part of a team created after 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2015-01-01')
RETURN s.name AS stream, t.name AS team","match
  $s isa stream, has name $sn;
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
  $ca > 2015-01-01;
fetch { ""stream"": $sn, ""team"": $tn };"
twitch,424,What are the top 5 streams by total view count that also have a team?,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,425,List the games played by streams that have a description containing 'game play'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.description CONTAINS 'game play'
RETURN DISTINCT g.name","match
  $s isa stream, has description $d;
  $d like "".*game play.*"";
  (streaming_channel: $s, played_game: $g) isa game_play;
fetch { ""game"": $g }; "
twitch,426,"Which streams have a language set to 'ru' and more than 20,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'ru'})
WHERE s.followers > 20000
RETURN s.name AS stream_name, s.followers","match
  $s isa stream, has name $sn, has followers $f;
  $f > 20000;
  language_usage (channel: $s, used_language: $l);
  $l has name ""ru"";
fetch { ""stream_name"": $sn, ""followers"": $f };"
twitch,427,Identify 3 users who are VIPs for streams with a total view count over 1 million.,"MATCH (u:User)-[:VIP]->(s:Stream)
WHERE s.total_view_count > 1000000
RETURN u.name AS user, s.name AS stream
LIMIT 3","match
  $u isa user, has name $un;
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
  vip_status (channel_with_vips: $s, vip_user: $u);
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,428,Show the top 3 streams with the most moderators.,"MATCH (s:Stream)
WITH s, size([(s)<-[:MODERATOR]-(m) | m]) AS num_moderators
ORDER BY num_moderators DESC
LIMIT 3
RETURN s.name AS stream_name, num_moderators","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $m);
reduce $num_moderators = count($m) groupby $sn;
sort $num_moderators desc;
limit 3;
fetch { ""stream_name"": $sn, ""num_moderators"": $num_moderators };"
twitch,429,Find out which 3 games are most frequently associated with streams having a 'VIP' relationship.,"MATCH (s:Stream)-[:VIP]->(:User)
MATCH (s)-[:PLAYS]->(g:Game)
RETURN g.name AS game, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  vip_status (channel_with_vips: $s, vip_user: $u);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $frequency = count($s) groupby $gn;
sort $frequency desc;
limit 3;
fetch { ""game"": $gn, ""frequency"": $frequency };"
twitch,430,Which streams have the most chatters? List the top 5.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;
fetch { ""stream"": $sn, ""chatter_count"": $chatter_count };"
twitch,431,Find 3 teams that have been associated with streams since before 2017.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WHERE t.createdAt < date(""2017-01-01"")
RETURN t.name AS team, t.createdAt AS createdAt
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
  $ca < 2017-01-01;
sort $ca asc;
limit 3;
fetch { ""team"": $tn, ""createdAt"": $ca };"
twitch,432,Show the top 3 teams by the number of streams they are associated with.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_streams = count($s) groupby $tn;
sort $num_streams desc;
limit 3;
fetch { ""team"": $tn, ""num_streams"": $num_streams };"
twitch,433,What are the names of the 3 users who chatter the most across different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) as num_streams
ORDER BY num_streams DESC
LIMIT 3
RETURN u.name","match
  $u isa user, has name $un;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 3;
fetch { ""name"": $un };"
twitch,434,List the streams that have moderators who are also VIPs in other streams.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)-[:VIP]->(otherStream:Stream)
RETURN s.name AS stream, m.name AS moderator, otherStream.name AS vipInStream","match
  $s isa stream, has name $sn;
  $m isa user, has name $mn;
  $otherStream isa stream, has name $osn;
  moderation (moderated_channel: $s, moderating_user: $m);
  vip_status (channel_with_vips: $otherStream, vip_user: $m);
  not { $s is $otherStream; };
fetch { ""stream"": $sn, ""moderator"": $mn, ""vipInStream"": $osn };"
twitch,435,Identify the 3 streams with the most user moderators.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
RETURN s.name AS stream, count(u) AS num_moderators
ORDER BY num_moderators DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderators = count($u) groupby $sn;
sort $num_moderators desc;
limit 3;
fetch { ""stream"": $sn, ""num_moderators"": $num_moderators };"
twitch,436,Find the top 5 streams where the streamer plays 'Just Chatting'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Just Chatting'})
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Just Chatting"";
sort $tvc desc;
limit 5;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,437,Show streams that feature more than 3 games.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(g) AS gameCount
WHERE gameCount > 3
RETURN s","match
$stream isa stream;
game_play (streaming_channel: $stream, played_game: $game);
reduce $count = count groupby $stream;
match
$count > 3;
fetch {
  ""stream"": $stream.name
};"
twitch,439,List the 3 oldest teams based on creation date linked to streams.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
RETURN t.name AS team, t.createdAt AS createdAt
ORDER BY t.createdAt
LIMIT 3","match
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
sort $ca asc;
limit 3;
fetch { ""team"": $tn, ""createdAt"": $ca };"
twitch,440,What are the top 5 games played by streams created before 2015?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.createdAt < date(""2015-01-01"")
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 5","match
  $s isa stream, has created_at $ca;
  $ca < 2015-01-01;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 5;
fetch { ""game"": $gn, ""streams"": $streams };"
twitch,441,Identify streams with more than 5 million total views that play 'VALORANT'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'VALORANT'})
WHERE s.total_view_count > 5000000
RETURN s","match
  $s isa stream, has name $sn, has total_view_count $tvc, has url $u, has followers $f;
  $tvc > 5000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""VALORANT"";
fetch { ""name"": $sn, ""total_view_count"": $tvc, ""url"": $u, ""followers"": $f };"
twitch,443,List the URLs of the 3 newest streams in the database.,"MATCH (s:Stream)
RETURN s.url AS stream_url
ORDER BY s.createdAt DESC
LIMIT 3","match
  $s isa stream, has url $u, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""stream_url"": $u };"
twitch,444,Which streams are linked to a team named 'ESO Stream Team'?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team {name: 'ESO Stream Team'})
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
  $t has name ""ESO Stream Team"";
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,445,Find streams that have at least 3 languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS languageCount
WHERE languageCount >= 3
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  language_usage (channel: $s, used_language: $l3);
  not { $l1 is $l2; };
  not { $l1 is $l3; };
  not { $l2 is $l3; };
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,446,Which users are chatters in more than 3 different streams? List the top 5.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams > 3
RETURN u.name, num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $u isa user, has name $un;
  chat_activity (channel_with_chatters: $s1, chatting_user: $u);
  chat_activity (channel_with_chatters: $s2, chatting_user: $u);
  chat_activity (channel_with_chatters: $s3, chatting_user: $u);
  chat_activity (channel_with_chatters: $s4, chatting_user: $u);
  not { $s1 is $s2; };
  not { $s1 is $s3; };
  not { $s1 is $s4; };
  not { $s2 is $s3; };
  not { $s2 is $s4; };
  not { $s3 is $s4; };
reduce $num_streams = count($s1) groupby $un;
sort $num_streams desc;
limit 5;
fetch { ""name"": $un, ""num_streams"": $num_streams };"
twitch,447,Show the streams that have the highest number of different games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as num_games
RETURN s.name as stream_name, num_games
ORDER BY num_games DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_games = count($g) groupby $sn;
sort $num_games desc;
limit 10;
fetch { ""stream_name"": $sn, ""num_games"": $num_games };"
twitch,448,Find the streams where the streamer has more than 1 million followers and plays 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 1000000
RETURN s","match
  $s isa stream, has name $sn, has followers $f, has url $u, has total_view_count $tvc;
  $f > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Rust"";
fetch { ""name"": $sn, ""followers"": $f, ""url"": $u, ""total_view_count"": $tvc };"
twitch,449,Display streams that have a language set to 'en' and were created before 2012.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language {name: 'en'})
WHERE s.createdAt < date('2012-01-01')
RETURN s","match
  $s isa stream, has name $sn, has created_at $ca, has url $u, has followers $f, has total_view_count $tvc;
  $ca < 2012-01-01;
  language_usage (channel: $s, used_language: $l);
  $l has name ""en"";
fetch { ""name"": $sn, ""created_at"": $ca, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,450,Which streams have both a 'MODERATOR' and a 'VIP' relationship with the same user?,"MATCH (s:Stream)-[:MODERATOR]->(u:User)<-[:VIP]-(s)
RETURN s.name AS stream, u.name AS user","match
  $s isa stream, has name $sn;
  $u isa user, has name $un;
  moderation (moderated_channel: $s, moderating_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""stream"": $sn, ""user"": $un };"
twitch,451,Find the 3 streams with the newest creation dates.,"MATCH (s:Stream)
RETURN s.name, s.createdAt
ORDER BY s.createdAt DESC
LIMIT 3","match
  $s isa stream, has name $n, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""name"": $n, ""createdAt"": $ca };"
twitch,452,List the top 5 users who are moderators for the most streams.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;
fetch { ""user"": $un, ""num_moderated_streams"": $num_moderated_streams };"
twitch,453,Which streams have a user named 'itsbigchase' as a VIP?,"MATCH (s:Stream)<-[:VIP]-(u:User {name: 'itsbigchase'})
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  vip_status (channel_with_vips: $s, vip_user: $user);
  $user has name ""itsbigchase"";
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,455,Show the streams that have more than 2 languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) as languageCount
WHERE languageCount > 2
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  language_usage (channel: $s, used_language: $l3);
  not { $l1 is $l2; };
  not { $l1 is $l3; };
  not { $l2 is $l3; };
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,456,List the streams with the highest number of chatters who are also streamers.,"MATCH (s:Stream)<-[:CHATTER]-(chatter:User)
WHERE exists{ (chatter)-[:CHATTER]->(:Stream) }
RETURN s.name AS stream, count(chatter) AS chatter_streamers
ORDER BY chatter_streamers DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  $chatter isa user;
  chat_activity (channel_with_chatters: $s, chatting_user: $chatter);
  chat_activity (chatting_user: $chatter, channel_with_chatters: $other);
  not { $s is $other; };
reduce $chatter_streamers = count($chatter) groupby $sn;
sort $chatter_streamers desc;
limit 10;
fetch { ""stream"": $sn, ""chatter_streamers"": $chatter_streamers };"
twitch,457,Find the 3 streams that have a 'CHATTER' relationship with users who are not streamers.,"MATCH (s:Stream)-[:CHATTER]->(u:User)
WHERE NOT EXISTS {(u)-[:CHATTER]->(:Stream)}
RETURN s, u
LIMIT 3","match
  $s isa stream, has name $sn, has url $url, has followers $f, has total_view_count $tvc;
  $u isa user, has name $un;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  not { 
    chat_activity (chatting_user: $u, channel_with_chatters: $other);
    not { $s is $other; };
  };
limit 3;
fetch { ""stream"": $sn, ""user"": $un };"
twitch,458,Which streams have the most 'CHATTER' relationships? List the top 5.,"MATCH (s:Stream)
RETURN s.name AS stream, count{(s)<-[:CHATTER]-()}  AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;
fetch { ""stream"": $sn, ""chatter_count"": $chatter_count };"
twitch,460,List the 3 games most frequently played by streams with VIP users.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:VIP]->(:User)
WITH g, count(*) AS playCount
ORDER BY playCount DESC
LIMIT 3
RETURN g.name AS game, playCount","match
  game_play (streaming_channel: $s, played_game: $g);
  vip_status (channel_with_vips: $s, vip_user: $u);
  $g has name $gn;
reduce $playCount = count($s) groupby $gn;
sort $playCount desc;
limit 3;
fetch { ""game"": $gn, ""playCount"": $playCount };"
twitch,461,Find the streams with the most unique games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as uniqueGamesPlayed
RETURN s.name as streamName, uniqueGamesPlayed
ORDER BY uniqueGamesPlayed DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $uniqueGamesPlayed = count($g) groupby $sn;
sort $uniqueGamesPlayed desc;
limit 10;
fetch { ""streamName"": $sn, ""uniqueGamesPlayed"": $uniqueGamesPlayed };"
twitch,462,Which streams have a moderator named 'itsbigchase'?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  moderation (moderated_channel: $s, moderating_user: $user);
  $user has name ""itsbigchase"";
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,463,Show the 3 streams with the least followers.,"MATCH (s:Stream)
RETURN s.name AS stream, s.followers AS followers
ORDER BY s.followers
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
sort $f asc;
limit 3;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,464,List the top 5 languages spoken by streams with a moderator relationship.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language), (s)-[:MODERATOR]->()
RETURN l.name AS language, count(*) AS num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  language_usage (channel: $s, used_language: $l);
  moderation (moderated_channel: $s, moderating_user: $m);
  $l has name $ln;
reduce $num_streams = count($s) groupby $ln;
sort $num_streams desc;
limit 5;
fetch { ""language"": $ln, ""num_streams"": $num_streams };"
twitch,465,Find streams where the user 'itsbigchase' is both a moderator and a chatter.,"MATCH (s:Stream)
WHERE exists{ (s)-[:MODERATOR]->(:User {name: 'itsbigchase'}) } 
  AND exists{ (s)-[:CHATTER]->(:User {name: 'itsbigchase'}) }
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  $user isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $user);
  chat_activity (channel_with_chatters: $s, chatting_user: $user);
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,466,Which streams have the highest number of unique games played?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as numGames
ORDER BY numGames DESC
RETURN s.name as stream, numGames
LIMIT 10","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $numGames = count($g) groupby $sn;
sort $numGames desc;
limit 10;
fetch { ""stream"": $sn, ""numGames"": $numGames };"
twitch,467,Identify 5 streams where users are both VIPs and moderators.,"MATCH (s:Stream)
WHERE exists{ (s)<-[:VIP]-(:User)-[:MODERATOR]->(s) }
RETURN s.name
LIMIT 5","match
  $s isa stream, has name $sn;
  $u isa user;
  vip_status (channel_with_vips: $s, vip_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
limit 5;
fetch { ""name"": $sn };"
twitch,468,List the 3 streams where the streamer has the longest ongoing stream based on the creation date.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.createdAt AS created_at
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 3;
fetch { ""stream_name"": $sn, ""created_at"": $ca };"
twitch,469,Show the top 5 streams with the most user chatters.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 5;
fetch { ""stream"": $sn, ""chatter_count"": $chatter_count };"
twitch,470,Find 3 streams with the most varied language settings.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(distinct l) as numLanguages
ORDER BY numLanguages DESC
LIMIT 3
RETURN s.name as streamName, numLanguages","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $numLanguages = count($l) groupby $sn;
sort $numLanguages desc;
limit 3;
fetch { ""streamName"": $sn, ""numLanguages"": $numLanguages };"
twitch,471,Which streams have a user as both a VIP and a MODERATOR?,"MATCH (s:Stream)<-[:VIP]-(u:User)-[:MODERATOR]->(s)
RETURN s.name AS stream, u.name AS user","match
  $s isa stream, has name $sn;
  $u isa user, has name $un;
  vip_status (channel_with_vips: $s, vip_user: $u);
  moderation (moderated_channel: $s, moderating_user: $u);
fetch { ""stream"": $sn, ""user"": $un };"
twitch,472,"List the streams that play a game named 'Just Chatting' and have more than 100,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game {name: 'Just Chatting'})
WHERE s.followers > 100000
RETURN s","match
  $s isa stream, has name $sn, has followers $f, has url $u, has total_view_count $tvc;
  $f > 100000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Just Chatting"";
fetch { ""name"": $sn, ""followers"": $f, ""url"": $u, ""total_view_count"": $tvc };"
twitch,474,Show the top 5 users who are VIPs in the most streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
ORDER BY vip_count DESC
LIMIT 5
RETURN u.name AS user, vip_count","match
  $u isa user, has name $un;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($s) groupby $un;
sort $vip_count desc;
limit 5;
fetch { ""user"": $un, ""vip_count"": $vip_count };"
twitch,475,List the 3 streams with the highest number of games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN s.name AS stream, count(g) AS num_games
ORDER BY num_games DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $num_games = count($g) groupby $sn;
sort $num_games desc;
limit 3;
fetch { ""stream"": $sn, ""num_games"": $num_games };"
twitch,476,Find the top 5 streams that have been active the longest based on the creation date.,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.createdAt AS created_at
ORDER BY s.createdAt
LIMIT 5","match
  $s isa stream, has name $sn, has created_at $ca;
sort $ca asc;
limit 5;
fetch { ""stream_name"": $sn, ""created_at"": $ca };"
twitch,477,Identify the streams with more than 3 VIP users.,"MATCH (s:Stream)
WHERE size([(s)<-[:VIP]-(:User) | 1]) > 3
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  vip_status (channel_with_vips: $s, vip_user: $u1);
  vip_status (channel_with_vips: $s, vip_user: $u2);
  vip_status (channel_with_vips: $s, vip_user: $u3);
  vip_status (channel_with_vips: $s, vip_user: $u4);
  not { $u1 is $u2; };
  not { $u1 is $u3; };
  not { $u1 is $u4; };
  not { $u2 is $u3; };
  not { $u2 is $u4; };
  not { $u3 is $u4; };
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,478,Which streams have the most distinct moderators? List the top 5.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
RETURN s.name AS stream, count(DISTINCT m) AS num_moderators
ORDER BY num_moderators DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $m);
reduce $num_moderators = count($m) groupby $sn;
sort $num_moderators desc;
limit 5;
fetch { ""stream"": $sn, ""num_moderators"": $num_moderators };"
twitch,479,Show the top 3 streams that have been followed by more than 2 million users.,"MATCH (s:Stream)
WHERE s.followers > 2000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
  $f > 2000000;
sort $f desc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,480,List the 3 newest games introduced to streams.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN g.name AS game, min(s.createdAt) AS first_played
ORDER BY first_played DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  $s has created_at $ca;
  $g has name $gn;
reduce $first_played = min($ca) groupby $gn;
sort $first_played desc;
limit 3;
fetch { ""game"": $gn, ""first_played"": $first_played };"
twitch,481,Identify the streams with the most followers who play 'Rust'.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN s.name AS stream, s.followers AS followers
ORDER BY followers DESC
LIMIT 10","match
  $s isa stream, has name $sn, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Rust"";
sort $f desc;
limit 10;
fetch { ""stream"": $sn, ""followers"": $f };"
twitch,482,Show the streams with the most languages.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN s.name AS stream, collect(l.name) AS languages, count(l) AS languageCount
ORDER BY languageCount DESC","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;
fetch { ""stream"": $sn, ""languageCount"": $languageCount };"
twitch,483,"List the streams that are moderated by users with more than 10,000 followers.","MATCH (s:Stream)<-[:MODERATOR]-(u:User)
WHERE u.followers > 10000
RETURN s","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_channel: $m);
  $m has followers $f;
  $f > 10000;
fetch { ""stream"": $sn };"
twitch,484,Find the 3 streams with the most distinct languages used.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN s.name AS stream, collect(DISTINCT l.name) AS languages, count(DISTINCT l) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;
limit 3;
fetch { ""stream"": $sn, ""languageCount"": $languageCount };"
twitch,485,Which streams have a user named 'itsbigchase' as a moderator and a chatter?,"MATCH (s:Stream)
WHERE exists{ (s)<-[:MODERATOR]-(:User {name: 'itsbigchase'}) }
AND exists{ (s)<-[:CHATTER]-(:User {name: 'itsbigchase'}) }
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  $user isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $user);
  chat_activity (channel_with_chatters: $s, chatting_user: $user);
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,486,Show the top 5 games played by streams with the most language diversity.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language)
WITH g, s, count(distinct l) as languageCount
ORDER BY languageCount DESC
RETURN g.name as game, languageCount
  ORDER BY languageCount DESC
  LIMIT 5","match
  game_play (streaming_channel: $s, played_game: $g);
  language_usage (channel: $s, used_language: $l);
  $g has name $gn;
reduce $languageCount = count($l) groupby $gn;
sort $languageCount desc;
limit 5;
fetch { ""game"": $gn, ""languageCount"": $languageCount };"
twitch,487,List the 3 streams that have been followed by more than 1 million users.,"MATCH (s:Stream)
WHERE s.followers > 1000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
  $f > 1000000;
sort $f desc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,488,Identify the streams with the highest total view count that have a user moderator.,"MATCH (s:Stream)-[:MODERATOR]->(u:User)
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY s.total_view_count DESC
LIMIT 10","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  moderation (moderated_channel: $s, moderating_user: $u);
sort $tvc desc;
limit 10;
fetch { ""stream"": $sn, ""views"": $tvc };"
twitch,489,Which streams have the most followers but fewer than 1 million total views?,"MATCH (s:Stream)
WHERE s.total_view_count < 1000000
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY s.followers DESC
LIMIT 10","match
  $s isa stream, has name $sn, has followers $f, has total_view_count $tvc;
  $tvc < 1000000;
sort $f desc;
limit 10;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,490,Show the 3 streams with the most users as chatters.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 3;
fetch { ""stream"": $sn, ""chatter_count"": $chatter_count };"
twitch,492,Find the 3 streams that have the most distinct games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as numGames
ORDER BY numGames DESC
LIMIT 3
RETURN s.name as streamName, numGames","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $numGames = count($g) groupby $sn;
sort $numGames desc;
limit 3;
fetch { ""streamName"": $sn, ""numGames"": $numGames };"
twitch,493,Which streams have the highest number of user VIPs?,"MATCH (s:Stream)<-[:VIP]-(u:User)
RETURN s.name AS stream, count(u) AS vip_count
ORDER BY vip_count DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $vip_count = count($u) groupby $sn;
sort $vip_count desc;
limit 10;
fetch { ""stream"": $sn, ""vip_count"": $vip_count };"
twitch,494,List the top 5 streams that have the most user moderators.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
RETURN s.name AS stream, count(u) AS num_moderators
ORDER BY num_moderators DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderators = count($u) groupby $sn;
sort $num_moderators desc;
limit 5;
fetch { ""stream"": $sn, ""num_moderators"": $num_moderators };"
twitch,495,Identify the top 3 users who are chatters in the most streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(s) AS num_streams
ORDER BY num_streams DESC
LIMIT 3
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $num_streams = count($s) groupby $un;
sort $num_streams desc;
limit 3;
fetch { ""user"": $un, ""num_streams"": $num_streams };"
twitch,496,Show the streams that have the most teams associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN s.name AS stream, count(t) AS team_count
ORDER BY team_count DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
reduce $team_count = count($t) groupby $sn;
sort $team_count desc;
limit 10;
fetch { ""stream"": $sn, ""team_count"": $team_count };"
twitch,497,List the 3 streams with the most distinct teams associated.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN s.name AS stream, collect(DISTINCT t.name) AS teams, count(DISTINCT t) AS num_teams
ORDER BY num_teams DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
reduce $num_teams = count($t) groupby $sn;
sort $num_teams desc;
limit 3;
fetch { ""stream"": $sn, ""num_teams"": $num_teams };"
twitch,498,Find the streams that have a user named 'itsbigchase' as a chatter and a VIP.,"MATCH (s:Stream)
WHERE exists{ (u:User {name: 'itsbigchase'})-[:CHATTER]->(s) }
  AND exists{ (u:User {name: 'itsbigchase'})-[:VIP]->(s) }
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  $user isa user, has name ""itsbigchase"";
  chat_activity (channel_with_chatters: $s, chatting_user: $user);
  vip_status (channel_with_vips: $s, vip_user: $user);
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,499,Which streams have the most languages? List the top 5.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN s.name AS stream, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;
limit 5;
fetch { ""stream"": $sn, ""languageCount"": $languageCount };"
twitch,500,Show the streams with the most distinct moderators.,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WITH s, count(distinct m) AS num_moderators
RETURN s.name AS stream, num_moderators
ORDER BY num_moderators DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $m);
reduce $num_moderators = count($m) groupby $sn;
sort $num_moderators desc;
limit 10;
fetch { ""stream"": $sn, ""num_moderators"": $num_moderators };"
twitch,501,Identify the streams where 'itsbigchase' is both a moderator and VIP.,"MATCH (s:Stream)
WHERE exists{ (s)-[:MODERATOR]->(:User {name: 'itsbigchase'}) } 
  AND exists{ (s)-[:VIP]->(:User {name: 'itsbigchase'}) }
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  $user isa user, has name ""itsbigchase"";
  moderation (moderated_channel: $s, moderating_user: $user);
  vip_status (channel_with_vips: $s, vip_user: $user);
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,502,Which streams have a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS stream, t.name AS team, t.createdAt AS teamCreatedAt","match
  $s isa stream, has name $sn;
  $t isa team, has name $tn, has created_at $ca;
  team_membership (member_stream: $s, organization: $t);
  $ca < 2015-01-01;
fetch { ""stream"": $sn, ""team"": $tn, ""teamCreatedAt"": $ca };"
twitch,503,Show the 3 newest teams associated with streams.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
RETURN t.name AS team, t.createdAt AS created
ORDER BY t.createdAt DESC
LIMIT 3","match
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn, has created_at $ca;
sort $ca desc;
limit 3;
fetch { ""team"": $tn, ""created"": $ca };"
twitch,504,List the top 5 streams by number of games played.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
RETURN s.name AS stream, count(g) AS games_played
ORDER BY games_played DESC
LIMIT 5","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $games_played = count($g) groupby $sn;
sort $games_played desc;
limit 5;
fetch { ""stream"": $sn, ""games_played"": $games_played };"
twitch,505,Find the streams with the most user chatters.,"MATCH (s:Stream)<-[:CHATTER]-(u:User)
RETURN s.name AS stream, count(u) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 10;
fetch { ""stream"": $sn, ""chatter_count"": $chatter_count };"
twitch,506,Which streams have the most distinct games played? List the top 5.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WITH s, count(distinct g) as numGames
ORDER BY numGames DESC
LIMIT 5
RETURN s.name as stream, numGames as distinctGamesPlayed","match
  $s isa stream, has name $sn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $numGames = count($g) groupby $sn;
sort $numGames desc;
limit 5;
fetch { ""stream"": $sn, ""distinctGamesPlayed"": $numGames };"
twitch,507,Show the streams that have the most distinct languages.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(distinct l) as languageCount
RETURN s.name as streamName, languageCount
ORDER BY languageCount DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  language_usage (channel: $s, used_language: $l);
reduce $languageCount = count($l) groupby $sn;
sort $languageCount desc;
limit 10;
fetch { ""streamName"": $sn, ""languageCount"": $languageCount };"
twitch,508,List the streams with the most distinct teams associated.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH s, count(distinct t) as teamCount
RETURN s.name as streamName, teamCount
ORDER BY teamCount DESC
LIMIT 10","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
reduce $teamCount = count($t) groupby $sn;
sort $teamCount desc;
limit 10;
fetch { ""streamName"": $sn, ""teamCount"": $teamCount };"
twitch,509,What are the names of the top 5 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,510,Which streams have a total view count greater than 5 million but less than 10 million?,"MATCH (s:Stream)
WHERE s.total_view_count > 5000000 AND s.total_view_count < 10000000
RETURN s","match
  $s isa stream, has name $sn, has total_view_count $tvc, has url $u, has followers $f;
  $tvc > 5000000;
  $tvc < 10000000;
fetch { ""name"": $sn, ""total_view_count"": $tvc, ""url"": $u, ""followers"": $f };"
twitch,511,"List the names of the top 3 games most frequently played by streams with over 500,000 followers.","MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers > 500000
WITH g.name AS game, count(*) AS playCount
RETURN game, playCount
ORDER BY playCount DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 500000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
reduce $playCount = count($s) groupby $gn;
sort $playCount desc;
limit 3;
fetch { ""game"": $gn, ""playCount"": $playCount };"
twitch,512,Which languages are used by streams that have more than 1 million total views?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.total_view_count > 1000000
RETURN DISTINCT l.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
fetch { ""language"": $ln };"
twitch,513,Name the top 3 users who are moderators for more than one stream.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s1, moderating_user: $u);
  moderation (moderated_channel: $s2, moderating_user: $u);
  not { $s1 is $s2; };
reduce $num_moderated_streams = count($s1) groupby $un;
sort $num_moderated_streams desc;
limit 3;
fetch { ""user"": $un, ""num_moderated_streams"": $num_moderated_streams };"
twitch,514,"What are the names of streams that play the game 'Rust' and have more than 100,000 followers?","MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
WHERE s.followers > 100000
RETURN s.name","match
  $s isa stream, has name $sn, has followers $f;
  $f > 100000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Rust"";
fetch { ""name"": $sn };"
twitch,515,Which streams have been created after 2018 and are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.createdAt > date(""2018-01-01"") AND t.createdAt < date(""2015-01-01"")
RETURN s, t","match
  $s isa stream, has name $sn, has created_at $sca, has url $u, has followers $f, has total_view_count $tvc;
  $t isa team, has name $tn, has created_at $tca;
  team_membership (member_stream: $s, organization: $t);
  $sca > 2018-01-01;
  $tca < 2015-01-01;
fetch { ""stream"": $sn, ""stream_created"": $sca, ""team"": $tn, ""team_created"": $tca };"
twitch,516,List the names of the top 5 users who are VIPs in the most number of different streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_vip_streams
ORDER BY num_vip_streams DESC
LIMIT 5
RETURN u.name as user_name, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (channel_with_vips: $s, vip_user: $u);
reduce $num_vip_streams = count($s) groupby $un;
sort $num_vip_streams desc;
limit 5;
fetch { ""user_name"": $un, ""num_vip_streams"": $num_vip_streams };"
twitch,517,"What are the names of streams that have the language 'en' and more than 50,000 followers?","MATCH (s:Stream)-[:HAS_LANGUAGE]->(:Language {name: 'en'})
WHERE s.followers > 50000
RETURN s.name","match
  $s isa stream, has name $sn, has followers $f;
  $f > 50000;
  language_usage (channel: $s, used_language: $l);
  $l has name ""en"";
fetch { ""name"": $sn };"
twitch,518,Which teams are associated with more than three different streams?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(distinct s) as num_streams
WHERE num_streams > 3
RETURN t.name as team_name, num_streams","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s1, organization: $t);
  team_membership (member_stream: $s2, organization: $t);
  team_membership (member_stream: $s3, organization: $t);
  team_membership (member_stream: $s4, organization: $t);
  not { $s1 is $s2; };
  not { $s1 is $s3; };
  not { $s1 is $s4; };
  not { $s2 is $s3; };
  not { $s2 is $s4; };
  not { $s3 is $s4; };
reduce $num_streams = count($s1) groupby $tn;
fetch { ""team_name"": $tn, ""num_streams"": $num_streams };"
twitch,519,List the names of games played by streams that have chatters also listed as VIPs.,"MATCH (s:Stream)-[:CHATTER]->(u:User)<-[:VIP]-(s)
MATCH (s)-[:PLAYS]->(g:Game)
RETURN DISTINCT g.name","match
  $s isa stream;
  $u isa user;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""name"": $gn };"
twitch,520,What are the names of the top 5 users who are moderators in streams that have more than 1 million total views?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WHERE s.total_view_count > 1000000
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 5
RETURN u.name AS user_name, num_moderated_streams","match
  $u isa user, has name $un;
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 5;
fetch { ""user_name"": $un, ""num_moderated_streams"": $num_moderated_streams };"
twitch,521,List the names of the top 3 streams that have the most chatters.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream_name, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
reduce $chatter_count = count($u) groupby $sn;
sort $chatter_count desc;
limit 3;
fetch { ""stream_name"": $sn, ""chatter_count"": $chatter_count };"
twitch,522,Name the streams that have a user named 'itsbigchase' as a moderator.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User {name: 'itsbigchase'})
RETURN s.name AS stream_name","match
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name ""itsbigchase"";
fetch { ""stream_name"": $sn };"
twitch,523,Which streams have chatters who are also moderators in other streams?,"MATCH (s:Stream)<-[:CHATTER]-(u:User)-[:MODERATOR]->(otherStream:Stream)
WHERE otherStream <> s
RETURN s.name AS stream, u.name AS chatter_and_moderator","match
  $s isa stream, has name $sn;
  $u isa user, has name $un;
  $otherStream isa stream;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  moderation (moderated_channel: $otherStream, moderating_user: $u);
  not { $s is $otherStream; };
fetch { ""stream"": $sn, ""chatter_and_moderator"": $un };"
twitch,524,List the top 5 streams by total view count that have a team associated with them.,"MATCH (s:Stream)-[:HAS_TEAM]->(:Team)
WHERE s.total_view_count IS NOT NULL
RETURN s.name AS stream_name, s.total_view_count AS total_views
ORDER BY s.total_view_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  team_membership (member_stream: $s, organization: $t);
sort $tvc desc;
limit 5;
fetch { ""stream_name"": $sn, ""total_views"": $tvc };"
twitch,525,Which games are played by streams that have at least two different languages associated with them?,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)-[:HAS_LANGUAGE]->(l:Language)
WHERE exists {
  (s)-[:HAS_LANGUAGE]->(:Language)
  WHERE NOT (l)-->(s)
}
RETURN DISTINCT g.name AS game","match
  $s isa stream;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
  language_usage (channel: $s, used_language: $l1);
  language_usage (channel: $s, used_language: $l2);
  not { $l1 is $l2; };
fetch { ""game"": $gn };"
twitch,526,Name the streams that are VIPs in the stream named 'itsbigchase'.,"MATCH (s:Stream)-[:VIP]->(stream:Stream {name: 'itsbigchase'})
RETURN s.name AS stream_name","match
  $target isa stream, has name ""itsbigchase"";
  vip_status (channel_with_vips: $target, vip_channel: $s);
  $s has name $sn;
fetch { ""stream_name"": $sn };"
twitch,527,"List the names of the top 3 teams associated with streams that have more than 500,000 total views.","MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE s.total_view_count > 500000
RETURN t.name AS team_name
ORDER BY s.total_view_count DESC
LIMIT 3","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 500000;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
sort $tvc desc;
limit 3;
fetch { ""team_name"": $tn };"
twitch,528,Which streams have users named 'gonsabellla' as a VIP?,"MATCH (s:Stream)-[:VIP]->(u:User {name: 'gonsabellla'})
RETURN s","match
  $s isa stream, has name $sn, has url $u, has followers $f, has total_view_count $tvc;
  vip_status (channel_with_vips: $s, vip_user: $user);
  $user has name ""gonsabellla"";
fetch { ""name"": $sn, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,529,Name the top 3 games played by streams that also have chatters who are VIPs.,"MATCH (s:Stream)-[:PLAYS]->(g:Game), (s)<-[:CHATTER]-(:User)-[:VIP]->(:Stream)
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
  vip_status (vip_user: $u);
reduce $streams = count($s) groupby $gn;
sort $streams desc;
limit 3;
fetch { ""game"": $gn, ""streams"": $streams };"
twitch,530,"List the streams that have chatters with the name 'itsbigchase' and more than 100,000 total views.","MATCH (s:Stream)<-[:CHATTER]-(u:User {name: 'itsbigchase'})
WHERE s.total_view_count > 100000
RETURN s","match
  $s isa stream, has name $sn, has total_view_count $tvc, has url $u, has followers $f;
  $tvc > 100000;
  chat_activity (channel_with_chatters: $s, chatting_user: $user);
  $user has name ""itsbigchase"";
fetch { ""name"": $sn, ""total_view_count"": $tvc, ""url"": $u, ""followers"": $f };"
twitch,531,Which streams created in 2020 have users who are both moderators and VIPs?,"MATCH (s:Stream)
WHERE s.createdAt >= date(""2020-01-01"") AND s.createdAt < date(""2021-01-01"")
AND exists {
  (s)-[:MODERATOR]->(u:User)<-[:VIP]-(s)
}
RETURN s","match
  $s isa stream, has name $sn, has created_at $ca, has url $u, has followers $f, has total_view_count $tvc;
  $ca >= 2020-01-01;
  $ca < 2021-01-01;
  $user isa user;
  moderation (moderated_channel: $s, moderating_user: $user);
  vip_status (channel_with_vips: $s, vip_user: $user);
fetch { ""name"": $sn, ""created_at"": $ca, ""url"": $u, ""followers"": $f, ""total_view_count"": $tvc };"
twitch,532,Name the top 5 users who have chatted in more than three streams.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams > 3
RETURN u.name, num_streams
ORDER BY num_streams DESC
LIMIT 5","match
  $u isa user, has name $un;
  chat_activity (channel_with_chatters: $s1, chatting_user: $u);
  chat_activity (channel_with_chatters: $s2, chatting_user: $u);
  chat_activity (channel_with_chatters: $s3, chatting_user: $u);
  chat_activity (channel_with_chatters: $s4, chatting_user: $u);
  not { $s1 is $s2; };
  not { $s1 is $s3; };
  not { $s1 is $s4; };
  not { $s2 is $s3; };
  not { $s2 is $s4; };
  not { $s3 is $s4; };
reduce $num_streams = count($s1) groupby $un;
sort $num_streams desc;
limit 5;
fetch { ""name"": $un, ""num_streams"": $num_streams };"
twitch,533,List the streams that have the same game played by both itsbigchase and 9linda.,"MATCH (s1:Stream)<-[:CHATTER]-(u1:User {name: 'itsbigchase'})-[:PLAYS]->(g:Game)<-[:PLAYS]-(u2:User {name: '9linda'})-[:CHATTER]->(s2:Stream)
WHERE s1 = s2
RETURN s1","match
  $s1 isa stream, has name ""itsbigchase"";
  $s2 isa stream, has name ""9linda"";
  game_play (streaming_channel: $s1, played_game: $g);
  game_play (streaming_channel: $s2, played_game: $g);
  $g has name $gn;
fetch { ""game"": $gn };"
twitch,534,"Which streams have a user named 'tranth' as a VIP and have more than 10,000 followers?","MATCH (s:Stream)-[:VIP]->(u:User {name: 'tranth'})
WHERE s.followers > 10000
RETURN s","match
  $s isa stream, has name $sn, has followers $f, has url $u, has total_view_count $tvc;
  $f > 10000;
  vip_status (channel_with_vips: $s, vip_user: $user);
  $user has name ""tranth"";
fetch { ""name"": $sn, ""followers"": $f, ""url"": $u, ""total_view_count"": $tvc };"
twitch,536,List the names of teams that have been involved with streams that play 'Just Chatting' and have total views over 1 million.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'Just Chatting'}), 
      (s)-[:HAS_TEAM]->(t:Team)
WHERE s.total_view_count > 1000000
RETURN DISTINCT t.name","match
  $s isa stream, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Just Chatting"";
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn;
fetch { ""name"": $tn };"
twitch,537,Which streams are moderated by users who are also VIPs in the same stream?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)-[:VIP]->(s)
RETURN s.name AS stream, u.name AS user","match
  $s isa stream, has name $sn;
  $u isa user, has name $un;
  moderation (moderated_channel: $s, moderating_user: $u);
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""stream"": $sn, ""user"": $un };"
twitch,538,What are the top 3 streams with the highest follower counts?,"MATCH (s:Stream)
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
sort $f desc;
limit 3;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,539,Which streams have a total view count greater than 1 million and what games are they playing?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.total_view_count > 1000000
RETURN s.name AS stream, g.name AS game","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 1000000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
fetch { ""stream"": $sn, ""game"": $gn };"
twitch,540,"List the first 3 languages used by streams that have more than 10,000 followers.","MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.followers > 10000
RETURN l.name AS language
ORDER BY s.followers DESC
LIMIT 3","match
  $s isa stream, has followers $f;
  $f > 10000;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
sort $f desc;
limit 3;
fetch { ""language"": $ln };"
twitch,541,Which users are moderators for more than one stream?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 1
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s1, moderating_user: $u);
  moderation (moderated_channel: $s2, moderating_user: $u);
  not { $s1 is $s2; };
reduce $num_moderated_streams = count($s1) groupby $un;
fetch { ""user"": $un, ""num_moderated_streams"": $num_moderated_streams };"
twitch,542,What are the names of the top 5 most followed streams that have been created since 2018?,"MATCH (s:Stream)
WHERE s.createdAt >= date('2018-01-01')
RETURN s.name AS stream_name, s.followers AS follower_count
ORDER BY follower_count DESC
LIMIT 5","match
  $s isa stream, has name $sn, has followers $f, has created_at $ca;
  $ca >= 2018-01-01;
sort $f desc;
limit 5;
fetch { ""stream_name"": $sn, ""follower_count"": $f };"
twitch,543,Identify the first 3 games played by streams that have at least 5000 followers.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.followers >= 5000
WITH g, s
ORDER BY s.createdAt
RETURN g.name AS game, collect(s.name)[0..2] AS streams
LIMIT 3","match
  $s isa stream, has followers $f, has created_at $ca;
  $f >= 5000;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
sort $ca asc;
limit 3;
fetch { ""game"": $gn };"
twitch,544,Which stream has the lowest total view count and what language is it using?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, l
ORDER BY s.total_view_count ASC
LIMIT 1
RETURN s.name AS stream_name, l.name AS language","match
  $s isa stream, has name $sn, has total_view_count $tvc;
  language_usage (channel: $s, used_language: $l);
  $l has name $ln;
sort $tvc asc;
limit 1;
fetch { ""stream_name"": $sn, ""language"": $ln };"
twitch,545,List the top 3 users who chatter in more than one stream.,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams > 1
RETURN u.name, num_streams
ORDER BY num_streams DESC
LIMIT 3","match
  $u isa user, has name $un;
  chat_activity (channel_with_chatters: $s1, chatting_user: $u);
  chat_activity (channel_with_chatters: $s2, chatting_user: $u);
  not { $s1 is $s2; };
reduce $num_streams = count($s1) groupby $un;
sort $num_streams desc;
limit 3;
fetch { ""name"": $un, ""num_streams"": $num_streams };"
twitch,546,What are the names and URLs of the first 3 streams that are part of a team created before 2015?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt < date(""2015-01-01"")
RETURN s.name AS streamName, s.url AS streamURL
LIMIT 3","match
  $s isa stream, has name $sn, has url $u;
  team_membership (member_stream: $s, organization: $t);
  $t has created_at $ca;
  $ca < 2015-01-01;
limit 3;
fetch { ""streamName"": $sn, ""streamURL"": $u };"
twitch,547,Which streams have VIP users and what are the names of these VIPs?,"MATCH (s:Stream)-[:VIP]->(vip:User)
RETURN s.name AS stream, vip.name AS vip","match
  $s isa stream, has name $sn;
  vip_status (channel_with_vips: $s, vip_user: $vip);
  $vip has name $vn;
fetch { ""stream"": $sn, ""vip"": $vn };"
twitch,548,Identify the top 5 teams by the number of associated streams they have.,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 5
RETURN t.name AS team_name, stream_count","match
  $t isa team, has name $tn;
  team_membership (member_stream: $s, organization: $t);
reduce $stream_count = count($s) groupby $tn;
sort $stream_count desc;
limit 5;
fetch { ""team_name"": $tn, ""stream_count"": $stream_count };"
twitch,549,List the first 3 users who are moderators for streams playing 'Rust'.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)-[:PLAYS]->(:Game {name: 'Rust'})
RETURN u.name AS user, s.name AS stream
LIMIT 3","match
  $u isa user, has name $un;
  $s isa stream, has name $sn;
  moderation (moderated_channel: $s, moderating_user: $u);
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""Rust"";
limit 3;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,550,What are the top 3 streams with the least followers that still have moderators?,"MATCH (s:Stream)
WHERE exists{ (s)<-[:MODERATOR]-() }
RETURN s.name AS stream, s.followers AS followerCount
ORDER BY followerCount ASC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
  moderation (moderated_channel: $s, moderating_user: $m);
sort $f asc;
limit 3;
fetch { ""stream"": $sn, ""followerCount"": $f };"
twitch,551,Which games are played by streams that have both English and German-speaking users?,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE exists{ (s)-[:HAS_LANGUAGE]->(:Language {name: 'en'}) } 
  AND exists{ (s)-[:HAS_LANGUAGE]->(:Language {name: 'de'}) }
RETURN DISTINCT g.name","match
  $s isa stream;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
  language_usage (channel: $s, used_language: $l1);
  $l1 has name ""en"";
  language_usage (channel: $s, used_language: $l2);
  $l2 has name ""de"";
fetch { ""game"": $gn };"
twitch,552,List the top 3 streams that have the most chatters.,"MATCH (s:Stream)<-[:CHATTER]-()
RETURN s.name AS stream, s.url AS url, count(*) AS chatter_count
ORDER BY chatter_count DESC
LIMIT 3","match
  $s isa stream, has name $sn, has url $u;
  chat_activity (channel_with_chatters: $s, chatting_user: $chatter);
reduce $chatter_count = count($chatter) groupby $sn, $u;
sort $chatter_count desc;
limit 3;
fetch { ""stream"": $sn, ""url"": $u, ""chatter_count"": $chatter_count };"
twitch,553,Which users are chatters in streams that have over 10000 total views?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WHERE s.total_view_count > 10000
RETURN u.name AS user, s.name AS stream, s.total_view_count AS views","match
  $u isa user, has name $un;
  $s isa stream, has name $sn, has total_view_count $tvc;
  $tvc > 10000;
  chat_activity (channel_with_chatters: $s, chatting_user: $u);
fetch { ""user"": $un, ""stream"": $sn, ""views"": $tvc };"
twitch,554,What are the names of the first 3 languages used by streams with a description containing 'strategy'?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WHERE s.description CONTAINS 'strategy'
RETURN l.name
LIMIT 3","match
  $s isa stream, has description $d;
  $d like "".*strategy.*"";
  (channel: $s, used_language: $l) isa language_usage;
limit 3;
fetch { ""language"": $l.name };"
twitch,555,Identify the first 3 streams that play 'DayZ' and their respective follower counts.,"MATCH (s:Stream)-[:PLAYS]->(:Game {name: 'DayZ'})
RETURN s.name AS stream, s.followers AS followerCount
ORDER BY followerCount DESC
LIMIT 3","match
  $s isa stream, has name $sn, has followers $f;
  game_play (streaming_channel: $s, played_game: $g);
  $g has name ""DayZ"";
sort $f desc;
limit 3;
fetch { ""stream"": $sn, ""followerCount"": $f };"
twitch,556,What are the descriptions of streams that are moderated by users with names starting with 'c'?,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
WHERE u.name STARTS WITH 'c' AND s.description IS NOT NULL
RETURN s.description","match
  $s isa stream, has description $d;
  moderation (moderated_channel: $s, moderating_user: $u);
  $u has name $un;
  $un like ""^c.*"";
fetch { ""description"": $d };"
twitch,557,How many streams does each game have associated with it? List the top 5 games based on this count.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
WITH g.name AS game, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 5
RETURN game, streamCount","match
  $g isa game, has name $gn;
  game_play (streaming_channel: $s, played_game: $g);
reduce $streamCount = count($s) groupby $gn;
sort $streamCount desc;
limit 5;
fetch { ""game"": $gn, ""streamCount"": $streamCount };"
twitch,558,What are the first 3 streams that were created after 2019 and their total view count?,"MATCH (s:Stream)
WHERE s.createdAt > date('2019-01-01')
RETURN s.name, s.total_view_count
ORDER BY s.createdAt
LIMIT 3","match
  $s isa stream, has name $sn, has total_view_count $tvc, has created_at $ca;
  $ca > 2019-01-01;
sort $ca asc;
limit 3;
fetch { ""name"": $sn, ""total_view_count"": $tvc };"
twitch,559,Which streams are part of teams created after 2018 and what are the team names?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WHERE t.createdAt > datetime('2018-01-01')
RETURN s.name AS stream, t.name AS team","match
  $s isa stream, has name $sn;
  team_membership (member_stream: $s, organization: $t);
  $t has name $tn, has created_at $ca;
  $ca > 2018-01-01;
fetch { ""stream"": $sn, ""team"": $tn };"
twitch,560,List the top 3 users who have moderated the most streams.,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
ORDER BY num_moderated_streams DESC
LIMIT 3
RETURN u.name AS user, num_moderated_streams","match
  $u isa user, has name $un;
  moderation (moderated_channel: $s, moderating_user: $u);
reduce $num_moderated_streams = count($s) groupby $un;
sort $num_moderated_streams desc;
limit 3;
fetch { ""user"": $un, ""num_moderated_streams"": $num_moderated_streams };"
twitch,104,List the games that have been played by more than five different streams.,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)
WITH g, count(distinct s) as numStreams
WHERE numStreams > 5
RETURN g.name as game, numStreams
ORDER BY numStreams DESC","match
  game_play (streaming_channel: $s, played_game: $g);
  $g has name $gn;
select $s, $gn;
distinct;
reduce $numStreams = count($s) groupby $gn;
match $numStreams > 5;
sort $numStreams desc;
fetch {
  ""game"": $gn,
  ""numStreams"": $numStreams
};"
twitch,105,What are the names of users who are moderators for more than three streams?,"MATCH (u:User)-[:MODERATOR]->(s:Stream)
WITH u, count(s) AS num_moderated_streams
WHERE num_moderated_streams > 3
RETURN u.name AS user_name","match
  $u isa user, has name $un;
  moderation (moderating_user: $u, moderated_channel: $s);
reduce $num_moderated_streams = count($s) groupby $u;
match $num_moderated_streams > 3;
fetch { ""user_name"": $u.name };"
twitch,113,Which users are VIPs on at least two different streams?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_vip_streams
WHERE num_vip_streams >= 2
RETURN u.name as user, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
select $u, $un, $s;
distinct;
reduce $num_vip_streams = count($s) groupby $u, $un;
match $num_vip_streams >= 2;
fetch {
  ""user"": $un,
  ""num_vip_streams"": $num_vip_streams
};"
twitch,120,Which users are chatters on more than five different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) AS num_streams
WHERE num_streams > 5
RETURN u.name AS user, num_streams","match
  $u isa user, has name $un;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
select $u, $un, $s;
distinct;
reduce $num_streams = count($s) groupby $u, $un;
match $num_streams > 5;
fetch {
  ""user"": $un,
  ""num_streams"": $num_streams
};"
twitch,129,How many users have VIP status in more than one stream?,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(s) AS vip_count
WHERE vip_count > 1
RETURN count(u) AS user_count","match
  $u isa user;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $vip_count = count($s) groupby $u;
match $vip_count > 1;
reduce $user_count = count($u);"
twitch,347,Which users have chatted with more than 5 different streams?,"MATCH (u:User)-[:CHATTER]->(s:Stream)
WITH u, count(distinct s) as num_streams
WHERE num_streams > 5
RETURN u.name as user, num_streams as streams_chatted_with","match
  $u isa user, has name $un;
  $s isa stream;
  chat_activity (chatting_user: $u, channel_with_chatters: $s);
select $u, $s, $un;
distinct;
reduce $num_streams = count($s) groupby $u, $un;
match $num_streams > 5;
fetch {
  ""user"": $un,
  ""streams_chatted_with"": $num_streams
};"
twitch,348,List all users who are VIPs in at least two different streams.,"MATCH (u:User)-[:VIP]->(s:Stream)
WITH u, count(distinct s) as num_vip_streams
WHERE num_vip_streams >= 2
RETURN u.name as user, num_vip_streams","match
  $u isa user, has name $un;
  vip_status (vip_user: $u, channel_with_vips: $s);
reduce $num_vip_streams = count($s) groupby $u, $un;
match $num_vip_streams >= 2;
fetch {
  ""user"": $un,
  ""num_vip_streams"": $num_vip_streams
};"
twitch,356,Which users are VIPs for the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)<-[:VIP]-(u:User)
RETURN u.name AS user, s.name AS stream","with fun max_followers() -> integer:
  match $s isa stream, has followers $f;
  return max($f);
match
  $s isa stream, has name $sn, has followers $f;
  let $max = max_followers();
  $f == $max;
  vip_status (channel_with_vips: $s, vip_user: $u);
  $u has name $un;
fetch { ""user"": $un, ""stream"": $sn };"
twitch,454,Identify the top 3 games played by streams with a description containing 'hilarious moments'.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE s.description CONTAINS 'hilarious moments'
RETURN g.name AS game, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $s isa stream, has description $d;
  $d like "".*hilarious moments.*"";
  game_play (streaming_channel: $s, played_game: $g);
reduce $count = count($s) groupby $g;
sort $count desc;
limit 3;
fetch { ""game"": $g.name, ""count"": $count };"
twitch,99,Which 3 users have moderated the most streams and users combined?,"MATCH (u:User)-[:MODERATOR]->(s)
WHERE s:Stream OR s:User
WITH u, count(s) AS moderations
RETURN u.name AS user, moderations
ORDER BY moderations DESC
LIMIT 3","match
$u isa user;
$rel isa moderation (moderating_user: $u);
reduce $count = count($rel) groupby $u;
sort $count desc;
limit 3;
fetch { ""user"": $u.name, ""moderations"": $count };"
twitch,152,Which 3 streams have the highest ratio of followers to total view count?,"MATCH (s:Stream)
WHERE s.followers IS NOT NULL AND s.total_view_count IS NOT NULL
RETURN s.name AS stream, toFloat(s.followers) / s.total_view_count AS follower_to_view_ratio
ORDER BY follower_to_view_ratio DESC
LIMIT 3","match
$s isa stream, has followers $f, has total_view_count $v;
$v > 0;
let $ratio = $f / $v;
sort $ratio desc;
limit 3;
fetch { ""stream"": $s.name, ""ratio"": $ratio };"
twitch,459,Show the streams that have been moderated by a user more than once.,"MATCH (s:Stream)<-[:MODERATOR]-(u:User)
WITH s, u, count(*) AS modCount
WHERE modCount > 1
RETURN s, u, modCount","match
$s isa stream; $u isa user;
$rel isa moderation (moderated_channel: $s, moderating_user: $u);
reduce $count = count($rel) groupby $s, $u;
match $count > 1;
fetch { ""stream"": $s.name, ""user"": $u.name, ""count"": $count };"
twitch,320,List the first 5 streams that have the most languages associated with them.,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
RETURN s.name AS stream, collect(l.name) AS languages
ORDER BY size(collect(l.name)) DESC
LIMIT 5","with fun language_count($s: stream) -> integer:
  match language_usage (channel: $s, used_language: $l);
  return count;

match
$s isa stream;
let $lc = language_count($s);
sort $lc desc;
limit 5;
fetch { ""stream"": $s.name, ""languages"": $lc };"
twitch,306,Who are the first 5 moderators in streams that have changed games at least twice?,"MATCH (s:Stream)-[:PLAYS]->(:Game)
WITH s, count(DISTINCT s) AS gameCount
WHERE gameCount >= 2
MATCH (s)<-[:MODERATOR]-(m:User)
RETURN m.name AS moderator
ORDER BY m.name
LIMIT 5","with fun game_count($s: stream) -> integer:
  match game_play (streaming_channel: $s, played_game: $g);
  return count;

match
$s isa stream;
let $gc = game_count($s);
$gc >= 2;
moderation (moderated_channel: $s, moderating_user: $m);
$m has name $n;
sort $n asc;
limit 5;
fetch { ""moderator"": $m.name };"
twitch,438,Which users are VIPs for the stream with the highest follower count?,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)<-[:VIP]-(u:User)
RETURN u.name AS user, s.name AS stream","with fun max_followers() -> integer:
  match $s isa stream, has followers $f;
  return max($f);

match
$s isa stream, has followers $f;
let $max = max_followers();
$f == $max;
vip_status (channel_with_vips: $s, vip_user: $u);
fetch { ""user"": $u.name, ""stream"": $s.name };"
twitch,535,Name the top 3 users who are moderators in the stream with the highest follower count.,"MATCH (s:Stream)
WITH s
ORDER BY s.followers DESC
LIMIT 1
MATCH (s)<-[:MODERATOR]-(u:User)
RETURN u.name
ORDER BY u.followers DESC
LIMIT 3","with fun max_followers() -> integer:
  match $s isa stream, has followers $f;
  return max($f);

match
$s isa stream, has followers $f;
let $max = max_followers();
$f == $max;
moderation (moderated_channel: $s, moderating_user: $u);
limit 3;
fetch { ""user"": $u.name };"
twitch,314,Who are the first 3 moderators for the oldest stream?,"MATCH (s:Stream)<-[:MODERATOR]-(m:User)
WITH s, m
ORDER BY s.createdAt
LIMIT 1
RETURN s.name AS stream, collect(m.name)[..3] AS moderators","with fun oldest_stream_date() -> datetime:
  match $s isa stream, has created_at $d;
  return min($d);

match
$s isa stream, has created_at $d;
let $oldest = oldest_stream_date();
$d == $oldest;
moderation (moderated_channel: $s, moderating_user: $m);
limit 3;
fetch { ""stream"": $s.name, ""moderator"": $m.name };"
twitch,331,Who are the first 3 VIPs in streams with the most languages spoken?,"MATCH (s:Stream)-[:HAS_LANGUAGE]->(l:Language)
WITH s, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 1
MATCH (s)-[:VIP]->(vip:User)
RETURN vip.name
LIMIT 3","with fun language_count($s: stream) -> integer:
  match language_usage (channel: $s, used_language: $l);
  return count;

with fun max_language_count() -> integer:
  match $s isa stream;
  let $c = language_count($s);
  return max($c);

match
$s isa stream;
let $lc = language_count($s);
let $max_lc = max_language_count();
$lc == $max_lc;
vip_status (channel_with_vips: $s, vip_user: $vip);
limit 3;
fetch { ""vip"": $vip.name };"
twitch,265,"Which game has the fewest streams playing it, listing the first 3 streams?","MATCH (g:Game)<-[:PLAYS]-(s:Stream)
WITH g, count(s) AS streamCount
ORDER BY streamCount
LIMIT 1
MATCH (g)<-[:PLAYS]-(s:Stream)
RETURN g.name AS game, s.name AS stream
LIMIT 3","with fun stream_count($g: game) -> integer:
  match game_play (streaming_channel: $s, played_game: $g);
  return count;

with fun min_stream_count() -> integer:
  match $g isa game;
  let $c = stream_count($g);
  $c > 0;
  return min($c);

match
$g isa game;
let $count = stream_count($g);
let $min = min_stream_count();
$count == $min;
game_play (streaming_channel: $s, played_game: $g);
limit 3;
fetch { ""game"": $g.name, ""stream"": $s.name };"
twitch,291,Which game is streamed by the most teams and list the first 3 teams?,"MATCH (g:Game)<-[:PLAYS]-(s:Stream)<-[:HAS_TEAM]-(t:Team)
WITH g, count(distinct t) as teamCount, collect(t.name) as teams
ORDER BY teamCount DESC
LIMIT 1
RETURN g.name as game, teamCount, teams[..3] as topTeams","with fun team_count($g: game) -> integer:
  match
  game_play (streaming_channel: $s, played_game: $g);
  team_membership (member_stream: $s, organization: $t);
  return count;

with fun max_team_count() -> integer:
  match $g isa game;
  let $c = team_count($g);
  return max($c);

match
$g isa game;
let $tc = team_count($g);
let $max = max_team_count();
$tc == $max;
game_play (streaming_channel: $s, played_game: $g);
team_membership (member_stream: $s, organization: $t);
limit 3;
fetch { ""game"": $g.name, ""team"": $t.name };"
twitch,300,What are the first 3 streams that are part of a team with the most streams?,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH t, count(s) AS streamCount
ORDER BY streamCount DESC
LIMIT 1
MATCH (s:Stream)-[:HAS_TEAM]->(t)
RETURN s.name AS streamName
LIMIT 3","with fun team_stream_count($t: team) -> integer:
  match team_membership (member_stream: $s, organization: $t);
  return count;

with fun max_team_stream_count() -> integer:
  match $t isa team;
  let $c = team_stream_count($t);
  return max($c);

match
$t isa team;
let $sc = team_stream_count($t);
let $max = max_team_stream_count();
$sc == $max;
team_membership (member_stream: $s, organization: $t);
limit 3;
fetch { ""stream"": $s.name };"
twitch,473,Which streams are part of a team with the most streams associated?,"MATCH (t:Team)<-[:HAS_TEAM]-(s:Stream)
WITH t, count(s) AS stream_count
ORDER BY stream_count DESC
LIMIT 1
MATCH (t)<-[:HAS_TEAM]-(stream:Stream)
RETURN stream","with fun team_stream_count($t: team) -> integer:
  match team_membership (member_stream: $s, organization: $t);
  return count;

with fun max_team_stream_count() -> integer:
  match $t isa team;
  let $c = team_stream_count($t);
  return max($c);

match
$t isa team;
let $sc = team_stream_count($t);
let $max = max_team_stream_count();
$sc == $max;
team_membership (member_stream: $s, organization: $t);
fetch { ""stream"": $s.name };"
twitch,491,List the top 5 streams that are part of the team with the newest creation date.,"MATCH (s:Stream)-[:HAS_TEAM]->(t:Team)
WITH t
ORDER BY t.createdAt DESC
LIMIT 1
MATCH (s:Stream)-[:HAS_TEAM]->(t)
RETURN s.name AS stream, s.total_view_count AS views
ORDER BY views DESC
LIMIT 5","with fun newest_team_date() -> datetime:
  match $t isa team, has created_at $d;
  return max($d);

match
$t isa team, has created_at $d;
let $newest = newest_team_date();
$d == $newest;
team_membership (member_stream: $s, organization: $t);
$s has total_view_count $v;
sort $v desc;
limit 5;
fetch { ""stream"": $s.name, ""views"": $v };"
twitch,321,"Which streams have been moderated by users with the most followers, listing the top 3?","MATCH (s:Stream)<-[:MODERATOR]-(u:User)
WITH s, max(u.followers) AS max_followers
ORDER BY max_followers DESC
LIMIT 3
RETURN s.name AS stream, max_followers","match
$s isa stream, has followers $f;
moderation (moderated_channel: $s, moderating_user: $u);
reduce $max_f = max($f) groupby $s;
sort $max_f desc;
limit 3;
fetch { ""stream"": $s.name, ""max_followers"": $max_f };"
twitch,323,"List the first 3 games that have been featured in streams with a team having over 1,000 followers.","MATCH (s:Stream)-[:HAS_TEAM]->(t:Team), (s)-[:PLAYS]->(g:Game)
WHERE t.followers > 1000
RETURN g.name AS game
ORDER BY g.name
LIMIT 3","match
  $s isa stream;
  $t isa team, has followers $f;
  $f > 1000;
  team_membership (member_stream: $s, organization: $t);
  $g isa game, has name $gn;
  game_play (streaming_channel: $s, played_game: $g);
sort $gn asc;
limit 3;
fetch {
  ""game"": $gn
};"
twitch,423,"List the streams that have VIP users with less than 10,000 followers.","MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.followers < 10000
RETURN s","match
  $s isa stream;
  $u isa user, has followers $f;
  $f < 10000;
  vip_status (channel_with_vips: $s, vip_user: $u);
fetch {
  ""stream"": $s.name
};"
twitch,184,Which 3 streams have the most VIP users who also have more than 5000 followers?,"MATCH (s:Stream)-[:VIP]->(u:User)
WHERE u.followers > 5000
WITH s, count(u) AS vipCount
RETURN s.name AS streamName, vipCount
ORDER BY vipCount DESC
LIMIT 3","with fun vip_high_followers_count($s: stream) -> integer:
  match
    $u isa user, has followers $f;
    $f > 5000;
    vip_status (channel_with_vips: $s, vip_user: $u);
  return count;
match
$s isa stream;
let $count = vip_high_followers_count($s);
$count > 0;
sort $count desc;
limit 3;
fetch { ""stream"": $s.name, ""vip_count"": $count };"
twitch,142,What are the top 5 streams with the longest descriptions?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s.name, s.description
ORDER BY size(s.description) DESC
LIMIT 5","match
$s isa stream, has description $d;
sort $d desc;
limit 5;
fetch { ""stream"": $s.name, ""description"": $d };"
twitch,442,Show the 3 streams that have the longest descriptions.,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s.name, s.description
ORDER BY size(s.description) DESC
LIMIT 3","match
$s isa stream, has description $d;
sort $d desc;
limit 3;
fetch { ""stream"": $s.name, ""description"": $d };"
twitch,173,Which 3 streams have the most complex descriptions based on word count?,"MATCH (s:Stream)
WHERE s.description IS NOT NULL
RETURN s.name, s.description, size(split(s.description, ' ')) AS word_count
ORDER BY word_count DESC
LIMIT 3","match
$s isa stream, has description $d;
sort $d desc;
limit 3;
fetch { ""stream"": $s.name, ""description"": $d };"
twitch,182,List the top 5 streams with the most complex URLs.,"MATCH (s:Stream)
WHERE s.url IS NOT NULL
RETURN s.url AS url, s.name AS name
ORDER BY size(s.url) DESC
LIMIT 5","match
$s isa stream, has url $u;
sort $u desc;
limit 5;
fetch { ""stream"": $s.name, ""url"": $u };"
twitch,288,List the top 3 games played by streams with a description length over 50 characters.,"MATCH (s:Stream)-[:PLAYS]->(g:Game)
WHERE size(s.description) > 50
RETURN g.name AS game, count(*) AS streams
ORDER BY streams DESC
LIMIT 3","match
$s isa stream, has description $d;
$d like "".{50,}"";
game_play (streaming_channel: $s, played_game: $g);
$g isa game;
reduce $count = count($s) groupby $g;
sort $count desc;
limit 3;
fetch { ""game"": $g.name, ""stream_count"": $count };"
movies,0,Which movies were released in 2003?,"MATCH (m:Movie)
WHERE m.released = 2003
RETURN m.title","match
  $m isa movie;
  $m has released 2003;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,1,List all movies with more than 1000 votes.,"MATCH (m:Movie)
WHERE m.votes > 1000
RETURN m.title, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $votesm > 1000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,2,What are the top 5 highest rated movies based on votes?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,3,Find the first 3 people born after 1960.,"MATCH (p:Person)
WHERE p.born > 1960
RETURN p
LIMIT 3","match
  $p isa person;
  $p has born $bornp;
  $bornp > 1960;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,4,Who reviewed movies with a rating higher than 90?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
RETURN p.name AS reviewer, m.title AS movie, r.rating AS rating","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 90;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""reviewer"": $namep,
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,5,List all movies directed by people born before 1950 limited to top 5.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1950
RETURN m.title
ORDER BY m.title
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp < 1950;
  $m has title $titlem;
sort $titlem asc;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,6,What are the roles of Keanu Reeves in the movies he acted in?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie)
RETURN m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has title $titlem;
fetch {
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,7,Find the first 3 movies produced by someone born in 1952.,"MATCH (p:Person {born: 1952})-[:PRODUCED]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has born 1952;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,8,Who acted in the movie with the tagline 'Welcome to the Real World'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Welcome to the Real World'})
RETURN p.name","match
  $p isa person;
  $m isa movie, has tagline ""Welcome to the Real World"";
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,9,"Display the top 5 movies that have been reviewed with the summary 'Dark, but compelling'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 5","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary, has rating $rating;
$summary == ""Dark, but compelling"";
sort $rating desc;
limit 5;
fetch {
  ""title"": $title,
  ""rating"": $rating
};"
movies,10,Which people have directed more than one movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS num_directed
WHERE num_directed > 1
RETURN p.name AS director, num_directed AS movies_directed","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has name $namep;
reduce $num_directed = count($m) groupby $namep;
match $num_directed > 1;
fetch {
  ""director"": $namep,
  ""movies_directed"": $num_directed
};"
movies,11,Show the top 3 movies with the lowest number of votes.,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,12,Who are the first 3 people to follow Keanu Reeves?,"MATCH (p:Person)-[:FOLLOWS]->(keanu:Person {name: 'Keanu Reeves'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $keanu isa person, has name ""Keanu Reeves"";
  (follower: $p, followed: $keanu) isa follows;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,14,What are the top 5 most recent movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,15,Find all movies with a released year in the 1990s.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,16,Who wrote the movie titled 'The Matrix'?,"MATCH (p:Person)-[:WROTE]->(m:Movie {title: 'The Matrix'})
RETURN p.name","match
  $p isa person;
  $m isa movie, has title ""The Matrix"";
  (writer: $p, film: $m) isa wrote;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,17,List the first 3 people born in 1964.,"MATCH (p:Person)
WHERE p.born = 1964
RETURN p.name
LIMIT 3","match
  $p isa person;
  $p has born 1964;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,18,Which movies have been reviewed with a rating less than 50?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating < 50
RETURN m.title, r.rating, r.summary","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $ratingr < 50;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr,
  ""summary"": $summaryr
};"
movies,19,Show the first 3 movies produced by Joel Silver.,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,20,What are the roles of Carrie-Anne Moss in 'The Matrix Revolutions'?,"MATCH (p:Person {name: 'Carrie-Anne Moss'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN r.roles","match
  $p isa person, has name ""Carrie-Anne Moss"";
  $m isa movie, has title ""The Matrix Revolutions"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
fetch {
  ""roles"": $rolesr
};"
movies,21,Which person reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 1
RETURN p.name AS person, num_reviews","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
reduce $num_reviews = count($r) groupby $namep;
sort $num_reviews desc;
limit 1;
fetch {
  ""person"": $namep,
  ""num_reviews"": $num_reviews
};"
movies,22,List top 5 oldest people in the database.,"MATCH (p:Person)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 5","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
sort $bornp asc;
limit 5;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,23,"Find all movies where Nancy Meyers was involved either by acting, directing, producing, or writing.","MATCH (p:Person {name: 'Nancy Meyers'})-[:ACTED_IN|DIRECTED|PRODUCED|WROTE]->(m:Movie)
RETURN m.title AS movie","match
  $p isa person, has name ""Nancy Meyers"";
  $m isa movie;
  {
    (actor: $p, film: $m) isa acted_in;
  } or {
    (director: $p, film: $m) isa directed;
  } or {
    (producer: $p, film: $m) isa produced;
  } or {
    (writer: $p, film: $m) isa wrote;
  };
  $m has title $titlem;
fetch {
  ""movie"": $titlem
};"
movies,25,Who are the first 3 actors in the movie titled 'Speed Racer'?,"MATCH (m:Movie {title: 'Speed Racer'})<-[:ACTED_IN]-(p:Person)
RETURN p.name
LIMIT 3","match
  $m isa movie, has title ""Speed Racer"";
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,27,Show the top 5 movies by the number of reviews they received.,"MATCH (m:Movie)<-[r:REVIEWED]-(:Person)
RETURN m.title AS movie, count(r) AS numReviews
ORDER BY numReviews DESC
LIMIT 5","match
  $m isa movie, has title $t;
  (reviewer: $p, film: $m) isa reviewed;
reduce $numReviews = count($p) groupby $t;
sort $numReviews desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numReviews"": $numReviews
};"
movies,28,Which people have produced and also reviewed the same movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,30,What are the birth years of people who have acted in movies released before 1980?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN DISTINCT p.born","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released $releasedm;
  $releasedm < 1980;
  $p has born $bornp;
fetch {
  ""born"": $bornp
};"
movies,31,Which movie has the lowest number of votes and was released after 2000?,"MATCH (m:Movie)
WHERE m.released > 2000 AND m.votes IS NOT NULL
RETURN m
ORDER BY m.votes
LIMIT 1","match
  $m isa movie;
  $m has votes $votesm;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
  $m has tagline $taglinem;
sort $votesm asc;
limit 1;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,32,Find all movies that have been produced by persons born after 1960 limited to top 5.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1960
RETURN m
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp > 1960;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
  $m has released $releasedm;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,33,"Who are the first 3 people to have reviewed a movie with the summary 'Silly, but fun'?","MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Silly, but fun'
RETURN p.name
LIMIT 3","match
$p isa person, has name $name;
$m isa movie;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Silly, but fun"";
limit 3;
fetch {
  ""name"": $name
};"
movies,34,List all movies with a tagline that includes the phrase 'Real World'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Real World'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""Real World"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,35,What are the first 3 movies reviewed by a person born in 1967?,"MATCH (p:Person {born: 1967})-[r:REVIEWED]->(m:Movie)
RETURN m.title
ORDER BY r.rating DESC
LIMIT 3","match
  $p isa person, has born 1967;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has title $titlem;
sort $ratingr desc;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,36,Show the top 5 movies with the most roles in their cast.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WITH m, size(r.roles) AS roleCount
ORDER BY roleCount DESC
LIMIT 5
RETURN m.title AS movie, roleCount AS `number of cast roles`","match
  $m isa movie, has title $t;
  (actor: $p, film: $m) isa acted_in;
reduce $roleCount = count($p) groupby $t;
sort $roleCount desc;
limit 5;
fetch {
  ""movie"": $t,
  ""roleCount"": $roleCount
};"
movies,38,List the first 3 movies with a tagline containing the word 'football'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'football'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""football"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,39,Who are the persons that have written and also acted in the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,40,Find all movies where a person named 'Nancy Meyers' acted.,"MATCH (p:Person {name: 'Nancy Meyers'})-[:ACTED_IN]->(m:Movie)
RETURN m","match
  $p isa person, has name ""Nancy Meyers"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
  $m has released $releasedm;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,41,Show the top 5 people by the number of movies they have produced.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name AS producer, count(m) AS num_movies_produced
ORDER BY num_movies_produced DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $num_movies_produced = count($m) groupby $namep;
sort $num_movies_produced desc;
limit 5;
fetch {
  ""producer"": $namep,
  ""num_movies_produced"": $num_movies_produced
};"
movies,42,Which movies have been reviewed with a rating exactly 75?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating = 75
RETURN m.title, r.summary, r.rating","match
  $m isa movie, has title $t;
  $r isa reviewed (reviewer: $p, film: $m), has rating 75, has summary $s;
fetch {
  ""title"": $t,
  ""summary"": $s,
  ""rating"": 75
};"
movies,43,List the first 3 movies that have been both produced and reviewed by people born before 1960.,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person), (m)<-[:REVIEWED]-(r:Person)
WHERE p.born < 1960 AND r.born < 1960
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $r isa person;
  (reviewer: $r, film: $m) isa reviewed;
  $p has born $bornp;
  $bornp < 1960;
  $r has born $bornr;
  $bornr < 1960;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,44,What are the roles of actors in the movie with the highest number of votes?,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE m.votes IS NOT NULL
WITH m, ai, p
ORDER BY m.votes DESC
LIMIT 1
RETURN m.title AS movie, p.name AS actor, ai.roles AS roles","match
  $m isa movie;
  $p isa person;
  $ai isa acted_in (actor: $p, film: $m), has roles $rolesai;
  $m has votes $votesm;
  $m has title $titlem;
  $p has name $namep;
sort $votesm desc;
limit 1;
fetch {
  ""movie"": $titlem,
  ""actor"": $namep,
  ""roles"": $rolesai
};"
movies,45,Who are the first 3 directors of movies released in the 2000s?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
RETURN d.name AS director
ORDER BY m.released
LIMIT 3","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $m has released $releasedm;
  $releasedm >= 2000;
  $releasedm < 2010;
  $d has name $named;
sort $releasedm asc;
limit 3;
fetch {
  ""director"": $named
};"
movies,46,List all movies directed by a person with the name 'Joel Silver'.,"MATCH (p:Person {name: 'Joel Silver'})-[:DIRECTED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,47,Find all people who have followed and been followed by the same person.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)-[:FOLLOWS]->(p1)
RETURN p1, p2","match
  $p1 isa person, has name $n1;
  $p2 isa person, has name $n2;
  (follower: $p1, followed: $p2) isa follows;
  (follower: $p2, followed: $p1) isa follows;
fetch {
  ""person1"": $n1,
  ""person2"": $n2
};"
movies,50,What are the first 3 movies with a released year of 2008?,"MATCH (m:Movie)
WHERE m.released = 2008
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has released 2008;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,51,Which person reviewed the movie with the lowest rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, m, r
ORDER BY r.rating ASC
LIMIT 1
RETURN p.name AS reviewer, m.title AS movie, r.rating AS rating","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has name $namep;
  $m has title $titlem;
sort $ratingr asc;
limit 1;
fetch {
  ""reviewer"": $namep,
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,53,Find the first 3 people who acted in a movie released in the 1990s.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,54,Who are the first 3 people to have produced a movie with more than 500 votes?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.votes > 500
RETURN p.name
ORDER BY m.votes DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has votes $votesm;
  $votesm > 500;
  $p has name $namep;
sort $votesm desc;
limit 3;
fetch {
  ""name"": $namep
};"
movies,55,List the top 5 movies with a released year before 1985.,"MATCH (m:Movie)
WHERE m.released < 1985
RETURN m.title, m.released
ORDER BY m.released
LIMIT 5","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm < 1985;
  $m has title $titlem;
sort $releasedm asc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,56,What are the first 3 movies that have a tagline containing the word 'journey'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""journey"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,57,Show the top 5 people by the number of movies they have directed.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS num_directed
ORDER BY num_directed DESC
LIMIT 5
RETURN p.name AS director, num_directed","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has name $namep;
reduce $num_directed = count($m) groupby $namep;
sort $num_directed desc;
limit 5;
fetch {
  ""director"": $namep,
  ""num_directed"": $num_directed
};"
movies,59,"List the first 3 movies with a review summary of 'Fun, but a little far fetched'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Fun, but a little far fetched'
RETURN m.title
LIMIT 3","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Fun, but a little far fetched"";
limit 3;
fetch {
  ""title"": $title
};"
movies,60,Find all people born in 1949 who have directed a movie.,"MATCH (p:Person)
WHERE p.born = 1949 AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p","match
  $p isa person;
  (director: $p) isa directed;
  $p has born 1949;
  $p has name $namep;
  $p has born $bornp;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,61,Who are the first 3 people who acted in a movie titled 'Something's Gotta Give'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: ""Something's Gotta Give""})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie, has title ""Something's Gotta Give"";
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,62,List all movies that were released in the year 2001.,"MATCH (m:Movie)
WHERE m.released = 2001
RETURN m.title","match
  $m isa movie;
  $m has released 2001;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,64,Show the first 3 people born in 1980 who have reviewed a movie.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born = 1980
RETURN p, m
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (reviewer: $p, film: $m) isa reviewed;
  $p has born 1980;
  $p has name $namep;
  $p has born $bornp;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
  $m has released $releasedm;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp,
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,65,Which movies have been reviewed and also acted in by the same person?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title, p.name","match
  $p isa person;
  $m isa movie;
  (reviewer: $p, film: $m) isa reviewed;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""title"": $titlem,
  ""name"": $namep
};"
movies,66,List the first 3 people who have directed a movie and also followed someone.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE exists{ (p)-[:FOLLOWS]->(:Person) }
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (follower: $p, followed: $other) isa follows;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,67,Find all movies with a tagline including the word 'compelling'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'compelling'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""compelling"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,68,Show the top 5 people who have reviewed the most movies.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 5
RETURN p.name AS person, num_reviews","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
reduce $num_reviews = count($r) groupby $namep;
sort $num_reviews desc;
limit 5;
fetch {
  ""person"": $namep,
  ""num_reviews"": $num_reviews
};"
movies,69,Which person has produced the most movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name AS producer, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $movie_count = count($m) groupby $namep;
sort $movie_count desc;
limit 1;
fetch {
  ""producer"": $namep,
  ""movie_count"": $movie_count
};"
movies,70,List the first 3 movies where someone named 'Carrie-Anne Moss' acted.,"MATCH (p:Person {name: 'Carrie-Anne Moss'})-[:ACTED_IN]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Carrie-Anne Moss"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,71,What are the first 3 movies with a released year of 1996?,"MATCH (m:Movie)
WHERE m.released = 1996
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has released 1996;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,73,List all movies with a rating of exactly 85 in the 'REVIEWED' relationship.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating = 85
RETURN m.title AS movie","match
  $m isa movie, has title $t;
  $r isa reviewed (reviewer: $p, film: $m), has rating 85;
fetch {
  ""movie"": $t
};"
movies,75,Who are the first 3 actors in the movie with the tagline 'Speed has no limits'?,"MATCH (m:Movie {tagline: 'Speed has no limits'})<-[:ACTED_IN]-(p:Person)
RETURN p.name
LIMIT 3","match
  $m isa movie, has tagline ""Speed has no limits"";
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,76,Show the top 5 movies reviewed by a person named 'Joel Silver'.,"MATCH (p:Person {name: 'Joel Silver'})-[r:REVIEWED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 5","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has title $titlem;
sort $ratingr desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,77,Which movies have been directed by persons born after 1970?,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person)
WHERE p.born > 1970
RETURN m.title, p.name, p.born","match
  $m isa movie;
  $p isa person;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1970;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""title"": $titlem,
  ""name"": $namep,
  ""born"": $bornp
};"
movies,78,List the first 3 movies that have been both acted in and reviewed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,79,What are the roles of actors in the movie titled 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS actor, r.roles AS roles","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
fetch {
  ""actor"": $namep,
  ""roles"": $rolesr
};"
movies,80,What are the titles of the top 5 movies released after 2000 with more than 1000 votes?,"MATCH (m:Movie)
WHERE m.released > 2000 AND m.votes > 1000
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has votes $votesm;
  $votesm > 1000;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,81,List the names of the first 3 people born after 1970 who acted in a movie released before 1980.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 1980
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp > 1970;
  $m has released $releasedm;
  $releasedm < 1980;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,82,"Which 3 movies reviewed with a rating above 90 have the tagline 'Dark, but compelling'?","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 90 AND m.tagline = 'Dark, but compelling'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 90;
  $m has tagline ""Dark, but compelling"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,84,What are the first 3 movies produced by someone born before 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp < 1960;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,85,List the top 5 movies with the highest votes that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,86,"Who are the first 3 people to review a movie with the tagline 'Fun, but a little far fetched'?","MATCH (p:Person)-[r:REVIEWED]->(m:Movie {tagline: 'Fun, but a little far fetched'})
RETURN p.name
ORDER BY r.rating
LIMIT 3","match
  $p isa person;
  $m isa movie, has tagline ""Fun, but a little far fetched"";
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has name $namep;
sort $ratingr asc;
limit 3;
fetch {
  ""name"": $namep
};"
movies,87,Name the top 5 actors who acted in a movie released in 1999.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released = 1999
RETURN p.name as actor, count(*) as appearances
ORDER BY appearances DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released 1999;
  $p has name $namep;
reduce $appearances = count($p) groupby $namep;
sort $appearances desc;
limit 5;
fetch {
  ""actor"": $namep,
  ""appearances"": $appearances
};"
movies,88,Find the first 3 movies where 'Keanu Reeves' acted.,"MATCH (p:Person {name: 'Keanu Reeves'})-[:ACTED_IN]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,89,Who are the top 3 people that follow someone born in 1961?,"MATCH (follower:Person)-[:FOLLOWS]->(followed:Person {born: 1961})
RETURN follower.name AS follower, followed.name AS followed
ORDER BY follower.name
LIMIT 3","match
  $follower isa person;
  $followed isa person, has born 1961;
  (follower: $follower, followed: $followed) isa follows;
  $follower has name $namefollower;
  $followed has name $namefollowed;
sort $namefollower asc;
limit 3;
fetch {
  ""follower"": $namefollower,
  ""followed"": $namefollowed
};"
movies,90,List the top 3 movies with the lowest votes that a person born in 1952 acted in.,"MATCH (p:Person {born: 1952})-[:ACTED_IN]->(m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 3","match
  $p isa person, has born 1952;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,91,Which 3 people reviewed the movie titled 'The Matrix Revolutions'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie, has title ""The Matrix Revolutions"";
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,92,Find the first 5 people born after 1980 who directed a movie released before 2000.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1980 AND m.released < 2000
RETURN p.name AS director, p.born AS birthYear, m.title AS movie, m.released AS releaseYear
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1980;
  $m has released $releasedm;
  $releasedm < 2000;
  $p has name $namep;
  $m has title $titlem;
limit 5;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp,
  ""movie"": $titlem,
  ""releaseYear"": $releasedm
};"
movies,94,What are the first 3 movies where someone born in 1996 acted?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born = 1996
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born 1996;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,95,Who are the top 5 producers of the movie with the title 'Speed Racer'?,"MATCH (m:Movie {title: 'Speed Racer'})<-[:PRODUCED]-(p:Person)
RETURN p.name AS producer
ORDER BY p.born DESC
LIMIT 5","match
  $m isa movie, has title ""Speed Racer"";
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
  $p has born $bornp;
sort $bornp desc;
limit 5;
fetch {
  ""producer"": $namep
};"
movies,96,List the first 3 people who wrote and also reviewed the same movie.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,97,What are the top 5 movies with the most roles for actors born after 1970?,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE p.born > 1970
WITH m, count(ai) AS roleCount
RETURN m.title AS movie, roleCount
ORDER BY roleCount DESC
LIMIT 5","match
  $m isa movie, has title $t;
  $p isa person, has born $b;
  $b > 1970;
  (actor: $p, film: $m) isa acted_in;
reduce $roleCount = count($p) groupby $t;
sort $roleCount desc;
limit 5;
fetch {
  ""movie"": $t,
  ""roleCount"": $roleCount
};"
movies,98,Which 3 people born before 1950 reviewed a movie with a rating less than 50?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born < 1950 AND r.rating < 50
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has born $bornp;
  $bornp < 1950;
  $ratingr < 50;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,99,Name the first 5 people who acted in a movie with a tagline mentioning 'Real World'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'Real World'
RETURN p.name
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $taglinem;
  $taglinem contains ""Real World"";
  $p has name $namep;
limit 5;
fetch {
  ""name"": $namep
};"
movies,100,What are the first 3 movies directed by someone who also reviewed them?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(d)
RETURN m.title
LIMIT 3","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  (reviewer: $d, film: $m) isa reviewed;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,101,List the top 5 movies with the tagline 'Welcome to the Real World' that were released after 1995.,"MATCH (m:Movie)
WHERE m.tagline = 'Welcome to the Real World' AND m.released > 1995
RETURN m.title, m.released, m.tagline
ORDER BY m.released DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline ""Welcome to the Real World"";
  $m has released $releasedm;
  $releasedm > 1995;
  $m has title $titlem;
  $m has tagline $taglinem;
sort $releasedm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm,
  ""tagline"": $taglinem
};"
movies,102,Who reviewed the movie titled 'Speed Racer' and what was their summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS reviewer, r.summary AS review_summary","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""review_summary"": $summaryr
};"
movies,103,Find the first 3 actors who acted in more than one movie with a tagline containing 'beginning'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'beginning'
WITH p, count(m) AS movieCount
WHERE movieCount > 1
RETURN p.name
LIMIT 3","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $tag;
  $tag like "".*beginning.*"";
reduce $movieCount = count($m) groupby $n;
match $movieCount > 1;
limit 3;
fetch {
  ""name"": $n
};"
movies,104,List the top 5 people who produced movies that received more than 2000 votes.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.votes > 2000
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS producer, num_movies","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  $m has votes $v;
  $v > 2000;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 5;
fetch {
  ""producer"": $n,
  ""num_movies"": $num_movies
};"
movies,105,Which 3 movies with a tagline containing 'journey' were reviewed with a rating above 85?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE m.tagline CONTAINS 'journey' AND r.rating > 85
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has tagline $taglinem;
  $taglinem contains ""journey"";
  $ratingr > 85;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,108,List the first 5 people born before 1980 who wrote a movie with a tagline mentioning 'speed'.,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born < 1980 AND m.tagline CONTAINS 'speed'
RETURN p.name, m.title, m.tagline
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $p has born $bornp;
  $bornp < 1980;
  $m has tagline $taglinem;
  $taglinem contains ""speed"";
  $p has name $namep;
  $m has title $titlem;
limit 5;
fetch {
  ""name"": $namep,
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,111,What are the top 5 movies with a tagline containing 'football' that were produced by someone born after 1960?,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person)
WHERE m.tagline CONTAINS 'football' AND p.born > 1960
RETURN m.title, m.tagline, m.released, p.name
ORDER BY m.released DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $m has tagline $taglinem;
  $taglinem contains ""football"";
  $p has born $bornp;
  $bornp > 1960;
  $m has title $titlem;
  $m has released $releasedm;
  $p has name $namep;
sort $releasedm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm,
  ""name"": $namep
};"
movies,113,Name the first 5 people who directed a movie with votes less than 50.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes < 50
RETURN p.name
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has votes $votesm;
  $votesm < 50;
  $p has name $namep;
limit 5;
fetch {
  ""name"": $namep
};"
movies,114,What are the first 3 movies where 'Joel Silver' acted?,"MATCH (p:Person {name: 'Joel Silver'})-[:ACTED_IN]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,115,List the top 5 movies directed by someone who also acted in them.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
WITH m, p
ORDER BY m.votes DESC
LIMIT 5
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $p has name $namep;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""person"": $namep
};"
movies,117,Find the first 3 actors who acted in a movie with a tagline containing 'Robin Williams'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'Robin Williams'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $taglinem;
  $taglinem contains ""Robin Williams"";
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,119,Name the top 5 directors of movies that have a tagline mentioning 'Real World'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Real World'
WITH m
MATCH (d:Person)-[:DIRECTED]->(m)
RETURN d.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $m has tagline $taglinem;
  $taglinem contains ""Real World"";
  $d has name $named;
reduce $num_movies = count($m) groupby $named;
sort $num_movies desc;
limit 5;
fetch {
  ""director"": $named,
  ""num_movies"": $num_movies
};"
movies,120,What are the first 3 movies with a tagline containing 'fun' that were directed by someone born after 1970?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WHERE m.tagline CONTAINS 'fun' AND d.born > 1970
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $m has tagline $taglinem;
  $taglinem contains ""fun"";
  $d has born $bornd;
  $bornd > 1970;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,123,Find the first 3 movies produced by 'Lana Wachowski'.,"MATCH (p:Person {name: 'Lana Wachowski'})-[:PRODUCED]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Lana Wachowski"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,127,What are the first 3 movies where someone named 'Keanu Reeves' was the producer?,"MATCH (p:Person {name: 'Keanu Reeves'})-[:PRODUCED]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,129,Who are the first 3 people born after 1975 who wrote a movie released after 2005?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born > 1975 AND m.released > 2005
RETURN p.name
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $p has born $bornp;
  $bornp > 1975;
  $m has released $releasedm;
  $releasedm > 2005;
  $p has name $namep;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep
};"
movies,130,What are the titles of the top 5 movies with the highest votes?,"MATCH (m:Movie)
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,131,List the names of 3 people who were born after 1970.,"MATCH (p:Person)
WHERE p.born > 1970
RETURN p.name
LIMIT 3","match
  $p isa person;
  $p has born $bornp;
  $bornp > 1970;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,132,Find the top 5 movies with the most number of reviews.,"MATCH (m:Movie)<-[r:REVIEWED]-(:Person)
RETURN m.title AS movie, count(r) AS numReviews
ORDER BY numReviews DESC
LIMIT 5","match
  $m isa movie, has title $t;
  (reviewer: $p, film: $m) isa reviewed;
reduce $numReviews = count($p) groupby $t;
sort $numReviews desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numReviews"": $numReviews
};"
movies,133,Who are the first 3 people that Keanu Reeves follows?,"MATCH (keanu:Person {name: 'Keanu Reeves'})-[:FOLLOWS]->(person:Person)
RETURN person.name
LIMIT 3","match
  $keanu isa person, has name ""Keanu Reeves"";
  $person isa person;
  (follower: $keanu, followed: $person) isa follows;
  $person has name $nameperson;
limit 3;
fetch {
  ""name"": $nameperson
};"
movies,134,What are the roles played by Laurence Fishburne in movies released before 2010?,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 2010
RETURN m.title, r.roles","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has released $releasedm;
  $releasedm < 2010;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""roles"": $rolesr
};"
movies,135,Which movie has the lowest number of votes and what is its tagline?,"MATCH (m:Movie)
WITH m
ORDER BY m.votes
LIMIT 1
RETURN m.title AS movie, m.tagline AS tagline","match
  $m isa movie;
  $m has title $titlem;
  $m has tagline $taglinem;
  $m has votes $votesm;
sort $votesm asc;
limit 1;
fetch {
  ""movie"": $titlem,
  ""tagline"": $taglinem
};"
movies,136,List the top 3 directors by the number of movies they have directed.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS num_movies_directed
ORDER BY num_movies_directed DESC
LIMIT 3","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $d has name $named;
reduce $num_movies_directed = count($m) groupby $named;
sort $num_movies_directed desc;
limit 3;
fetch {
  ""director"": $named,
  ""num_movies_directed"": $num_movies_directed
};"
movies,137,What are the names of the people who reviewed 'The Matrix' and what were their ratings?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS reviewer, r.rating AS rating","match
  $p isa person;
  $m isa movie, has title ""The Matrix"";
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""rating"": $ratingr
};"
movies,139,What are the top 5 movies with the highest average review rating?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avgRating = mean($r) groupby $t;
sort $avgRating desc;
limit 5;
fetch {
  ""movie"": $t,
  ""avgRating"": $avgRating
};"
movies,140,List the top 3 movies by Laurence Fishburne as an actor.,"MATCH (p:Person {name: 'Laurence Fishburne'})-[:ACTED_IN]->(m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 3","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,141,"What are the names of the movies that received a review summary 'Dark, but compelling'?","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Dark, but compelling"";

fetch {
  ""title"": $title
};"
movies,144,What are the first 3 most recent movies that have a tagline?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline, m.released
ORDER BY m.released DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,146,List 3 movies Laurence Fishburne has reviewed and their corresponding ratings.,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:REVIEWED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating
LIMIT 3","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has title $titlem;
limit 3;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,148,Which movies have a tagline containing the word 'real' and were released in the 2000s?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real' AND m.released >= 2000 AND m.released < 2010
RETURN m.title, m.tagline, m.released","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""real"";
  $m has released $releasedm;
  $releasedm >= 2000;
  $releasedm < 2010;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,149,What are the first 3 movies that received a review with a rating less than 50?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating < 50
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr < 50;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,150,List the top 5 oldest actors and the movies they have acted in.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, m
ORDER BY p.born
LIMIT 5
RETURN p.name AS actor, collect(m.title) AS movies","match
  $p isa person, has name $n, has born $b;
  (actor: $p, film: $m) isa acted_in;
  $m has title $t;
sort $b asc;
limit 5;
fetch {
  ""actor"": $n,
  ""movie"": $t
};"
movies,153,What is the average rating of movies reviewed by people born after 1980?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1980
RETURN avg(r.rating) AS average_rating","match
  $p isa person, has born $b;
  $b > 1980;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $average_rating = mean($r);
fetch {
  ""average_rating"": $average_rating
};"
movies,154,List the roles of actors in the top 5 movies with the most votes.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WITH m, p, ai
ORDER BY m.votes DESC
LIMIT 5
RETURN m.title AS movie, p.name AS actor, ai.roles AS roles","match
  $m isa movie;
  $p isa person;
  $ai isa acted_in (actor: $p, film: $m), has roles $rolesai;
  $m has title $titlem;
  $p has name $namep;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""actor"": $namep,
  ""roles"": $rolesai
};"
movies,155,Who are the first 3 people to have directed a movie with a tagline including the word 'beginning'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'beginning'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has tagline $taglinem;
  $taglinem contains ""beginning"";
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,156,What are the top 5 movies with the least votes and their release years?,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.released, m.votes
ORDER BY m.votes
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $m has title $titlem;
  $m has released $releasedm;
sort $votesm asc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm,
  ""votes"": $votesm
};"
movies,158,List the first 3 movies that Keanu Reeves has acted in with their release years.,"MATCH (p:Person {name: 'Keanu Reeves'})-[:ACTED_IN]->(m:Movie)
RETURN m.title AS movie, m.released AS year
ORDER BY m.released
LIMIT 3","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""year"": $releasedm
};"
movies,159,Who has directed the most movies released after 2000 and what are those movies?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2000
WITH d, count(m) AS num_movies, collect(m.title) AS movies
ORDER BY num_movies DESC
LIMIT 1
RETURN d.name AS director, num_movies, movies","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has released $r;
  $r > 2000;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,160,What are the taglines of the top 3 movies released in 1996?,"MATCH (m:Movie)
WHERE m.released = 1996
RETURN m.tagline
ORDER BY m.votes DESC
LIMIT 3","match
  $m isa movie;
  $m has released 1996;
  $m has tagline $taglinem;
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""tagline"": $taglinem
};"
movies,163,What is the average number of votes for movies released in the 1980s?,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released < 1990
RETURN avg(m.votes) AS average_votes_1980s","match
  $m isa movie, has released $r, has votes $v;
  $r >= 1980;
  $r < 1990;
reduce $average_votes_1980s = mean($v);
fetch {
  ""average_votes_1980s"": $average_votes_1980s
};"
movies,164,Who are the first 3 people born in the 1960s that Keanu Reeves follows?,"MATCH (keanu:Person {name: 'Keanu Reeves'})-[:FOLLOWS]->(person:Person)
WHERE person.born >= 1960 AND person.born < 1970
RETURN person.name
LIMIT 3","match
  $keanu isa person, has name ""Keanu Reeves"";
  $person isa person;
  (follower: $keanu, followed: $person) isa follows;
  $person has born $bornperson;
  $bornperson >= 1960;
  $bornperson < 1970;
  $person has name $nameperson;
limit 3;
fetch {
  ""name"": $nameperson
};"
movies,165,List the roles played by actors in the first 3 movies directed by Nancy Meyers.,"MATCH (d:Person {name: 'Nancy Meyers'})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Person)
RETURN m.title AS movie, a.name AS actor, a.roles AS roles
ORDER BY m.released
LIMIT 3","match
  $d isa person, has name ""Nancy Meyers"";
  (director: $d, film: $m) isa directed;
  $m has title $t, has released $r;
  $ai isa acted_in (actor: $a, film: $m), has roles $roles;
  $a has name $n;
sort $r asc;
limit 3;
fetch {
  ""movie"": $t,
  ""actor"": $n,
  ""roles"": $roles
};"
movies,166,What are the first 3 movies produced by Joel Silver and their respective release years?,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title AS movie, m.released AS year
ORDER BY m.released
LIMIT 3","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""year"": $releasedm
};"
movies,167,Which movies have the tagline 'Speed has no limits' and who are the producers?,"MATCH (m:Movie {tagline: 'Speed has no limits'})<-[:PRODUCED]-(p:Person)
RETURN m.title AS movie, p.name AS producer","match
  $m isa movie, has tagline ""Speed has no limits"";
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""producer"": $namep
};"
movies,168,What are the names of the people who wrote and also acted in the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name AS person","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
fetch {
  ""person"": $namep
};"
movies,169,List the first 3 movies reviewed by a person born before 1950 and their review summaries.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born < 1950
RETURN m.title AS movie, r.summary AS review
ORDER BY m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $p has born $bornp;
  $bornp < 1950;
  $m has title $titlem;
sort $titlem asc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""review"": $summaryr
};"
movies,173,List the movies that have been reviewed and also have a tagline including the word 'journey'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey' AND exists{(m)<-[:REVIEWED]-()}
RETURN m.title","match
  $m isa movie;
  (reviewer: $p, film: $m) isa reviewed;
  $m has tagline $taglinem;
  $taglinem contains ""journey"";
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,174,What are the top 5 reviewed movies by people born in the 1980s and their ratings?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born >= 1980 AND p.born < 1990
RETURN m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has born $bornp;
  $bornp >= 1980;
  $bornp < 1990;
  $m has title $titlem;
sort $ratingr desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,176,What are the names of the first 3 movies directed by a person born in 1949?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born = 1949
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born 1949;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,181,What are the first 3 movies with the highest ratings reviewed by people born after 1980?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1980
WITH m, max(r.rating) AS maxRating
ORDER BY maxRating DESC
LIMIT 3
RETURN m.title AS movie, maxRating AS rating","match
  $p isa person, has born $b;
  $b > 1980;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
  $m has title $t;
sort $r desc;
limit 3;
fetch {
  ""movie"": $t,
  ""rating"": $r
};"
movies,185,Which movies have been directed by a person born in 1970 and what are their titles?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born = 1970
RETURN m.title","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born 1970;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,187,What are the first 3 movies reviewed by people with a review summary 'Pretty funny at times' and their ratings?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Pretty funny at times'
RETURN m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 3","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary, has rating $rating;
$summary == ""Pretty funny at times"";
sort $rating desc;
limit 3;
fetch {
  ""title"": $title,
  ""rating"": $rating
};"
movies,188,Who directed the first 3 movies reviewed with a rating of 100 and what are their titles?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating = 100
WITH m
ORDER BY m.released
LIMIT 3
MATCH (d:Person)-[:DIRECTED]->(m)
RETURN d.name AS director, m.title AS movie","match
  $rev isa reviewed (reviewer: $rev_p, film: $m), has rating 100;
  (director: $d, film: $m) isa directed;
  $d has name $n;
  $m has title $t, has released $r;
sort $r asc;
limit 3;
fetch {
  ""director"": $n,
  ""movie"": $t
};"
movies,190,List the first 3 movies with a tagline including the word 'world' and their release years.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'world'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""world"";
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,192,What are the first 3 movies where Nancy Meyers was involved as a writer and their release years?,"MATCH (p:Person {name: 'Nancy Meyers'})-[:WROTE]->(m:Movie)
RETURN m.title AS movie, m.released AS year
ORDER BY m.released
LIMIT 3","match
  $p isa person, has name ""Nancy Meyers"";
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""year"": $releasedm
};"
movies,193,Who are the top 5 people who have acted in the most number of movies with a tagline?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5
RETURN p.name AS name, movieCount","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $tag;
reduce $movieCount = count($m) groupby $n;
sort $movieCount desc;
limit 5;
fetch {
  ""name"": $n,
  ""movieCount"": $movieCount
};"
movies,195,What are the first 3 movies produced by people born in the 1950s?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born >= 1950 AND p.born < 1960
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp >= 1950;
  $bornp < 1960;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,197,What is the average number of votes for movies directed by people born before 1950?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1950
RETURN avg(m.votes) AS average_votes","match
  $p isa person, has born $b;
  $b < 1950;
  (director: $p, film: $m) isa directed;
  $m has votes $v;
reduce $average_votes = mean($v);
fetch {
  ""average_votes"": $average_votes
};"
movies,200,Which movies have a person who both produced and reviewed them and what are their titles?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,202,List the top 5 movies with the highest number of different actors involved.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
RETURN m.title AS movie, count(p) AS num_actors
ORDER BY num_actors DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
reduce $num_actors = count($p) groupby $titlem;
sort $num_actors desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""num_actors"": $num_actors
};"
movies,203,Who are the first 3 oldest directors and the movies they have directed?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH d, collect(m.title) AS movies
ORDER BY d.born
LIMIT 3
RETURN d.name AS director, d.born AS birthYear, movies","match
  $d isa person, has name $n, has born $b;
  (director: $d, film: $m) isa directed;
  $m has title $t;
sort $b asc;
limit 3;
fetch {
  ""director"": $n,
  ""birthYear"": $b,
  ""movie"": $t
};"
movies,204,What are the first 3 movies with a review summary 'An amazing journey' and their ratings?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'An amazing journey'
RETURN m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 3","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary, has rating $rating;
$summary == ""An amazing journey"";
sort $rating desc;
limit 3;
fetch {
  ""title"": $title,
  ""rating"": $rating
};"
movies,206,What are the top 5 movies directed by people born in the 1960s and their release years?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN m.title AS movie, m.released AS year
ORDER BY m.votes DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp >= 1960;
  $bornp < 1970;
  $m has title $titlem;
  $m has released $releasedm;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""year"": $releasedm
};"
movies,207,List the first 3 movies reviewed by a person named 'Nancy Meyers' and their review summaries.,"MATCH (p:Person {name: 'Nancy Meyers'})-[r:REVIEWED]->(m:Movie)
RETURN m.title AS movie, r.summary AS review
ORDER BY m.title
LIMIT 3","match
  $p isa person, has name ""Nancy Meyers"";
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $m has title $titlem;
sort $titlem asc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""review"": $summaryr
};"
movies,208,What are the first 3 movies with a tagline including the word 'fun' and their release years?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'fun'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""fun"";
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,209,Who are the top 3 actors born after 1970 who acted in movies released before 2000?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 2000
RETURN p.name, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp > 1970;
  $m has released $releasedm;
  $releasedm < 2000;
  $p has name $namep;
reduce $numMovies = count($m) groupby $namep;
sort $numMovies desc;
limit 3;
fetch {
  ""name"": $namep,
  ""numMovies"": $numMovies
};"
movies,210,What are the top 5 movies with the most votes released after 2000?,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,211,List the first 3 people who directed and also acted in the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name, m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""name"": $namep,
  ""title"": $titlem
};"
movies,212,Who are the top 3 youngest directors of movies released in the 1990s?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p.name AS director, p.born AS birthYear
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $p has name $namep;
  $p has born $bornp;
sort $bornp desc;
limit 3;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp
};"
movies,213,Which movies released between 1980 and 1990 have been reviewed with a rating higher than 80?,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released <= 1990
AND EXISTS {
  (m)<-[:REVIEWED]-(r:Person)
  WHERE r.rating > 80
}
RETURN m.title, m.released","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1980;
  $releasedm <= 1990;
  (reviewer: $r, film: $m) isa reviewed, has rating $ratingr;
  $ratingr > 80;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,214,Name the first 3 actors who have acted in more than one movie with a tagline containing the word 'freedom'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'freedom'
WITH p, count(m) AS movieCount
WHERE movieCount > 1
RETURN p.name
LIMIT 3","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $tag;
  $tag like "".*freedom.*"";
reduce $movieCount = count($m) groupby $n;
match $movieCount > 1;
limit 3;
fetch {
  ""name"": $n
};"
movies,215,What are the top 3 movies with the lowest votes released before 1980?,"MATCH (m:Movie)
WHERE m.released < 1980 AND m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 3","match
  $m isa movie;
  $m has votes $votesm;
  $m has released $releasedm;
  $releasedm < 1980;
  $m has title $titlem;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,216,List the first 3 actors born before 1950 who reviewed a movie with a summary containing the word 'funny'.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born < 1950 AND p.summary CONTAINS 'funny'
RETURN p.name
ORDER BY p.born
LIMIT 3","match
  $p isa person, has name $n, has born $b;
  $b < 1950;
  $rev isa reviewed (reviewer: $p, film: $m), has summary $s;
  $s like "".*funny.*"";
sort $b asc;
limit 3;
fetch {
  ""name"": $n
};"
movies,217,Which directors were born after 1960 and directed a movie with a tagline containing the word 'speed'?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE d.born > 1960 AND m.tagline CONTAINS 'speed'
RETURN d.name AS director, m.title AS movie","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $d has born $bornd;
  $bornd > 1960;
  $m has tagline $taglinem;
  $taglinem contains ""speed"";
  $d has name $named;
  $m has title $titlem;
fetch {
  ""director"": $named,
  ""movie"": $titlem
};"
movies,218,List the first 3 movies that were both written and reviewed by the same person.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,219,"Who are the top 5 actors by number of movies acted in, with each movie having at least 100 votes?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.votes >= 100
WITH p, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN p.name AS actor, numMovies","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has votes $v;
  $v >= 100;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 5;
fetch {
  ""actor"": $n,
  ""numMovies"": $numMovies
};"
movies,221,Name the first 3 movies with a tagline that includes the word 'real' and were released before 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real' AND m.released < 2000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""real"";
  $m has released $releasedm;
  $releasedm < 2000;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,222,Which people have acted in and also reviewed the same movie? List the first 3.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,223,What are the top 5 movies with a tagline containing the word 'Houston'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Houston'
RETURN m.title, m.tagline, m.released, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""Houston"";
  $m has title $titlem;
  $m has released $releasedm;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm,
  ""votes"": $votesm
};"
movies,226,Which movies have been reviewed with a summary containing 'amazing journey' and have a rating less than 80?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'amazing journey' AND r.rating < 80
RETURN m.title AS movie, r.rating AS rating","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $summaryr contains ""amazing journey"";
  $ratingr < 80;
  $m has title $titlem;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,227,Name the first 3 people who produced a movie that they also acted in.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,228,Which movies released between 1990 and 2000 have more than 5000 votes?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
  AND m.votes > 5000
RETURN m.title, m.released, m.votes","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm <= 2000;
  $m has votes $votesm;
  $votesm > 5000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm,
  ""votes"": $votesm
};"
movies,229,List all movies directed by Lana Wachowski.,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person {name: 'Lana Wachowski'})
RETURN m.title","match
  $m isa movie;
  $p isa person, has name ""Lana Wachowski"";
  (director: $p, film: $m) isa directed;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,230,Find the top 3 actors by number of movies acted in from 1990 to 2000.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
WITH p, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN p.name AS actor, numMovies","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has released $r;
  $r >= 1990;
  $r <= 2000;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch {
  ""actor"": $n,
  ""numMovies"": $numMovies
};"
movies,231,What are the top 5 most voted movies?,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,232,Who are the actors that acted in 'The Matrix'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS actor","match
  $p isa person;
  $m isa movie, has title ""The Matrix"";
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
fetch {
  ""actor"": $namep
};"
movies,234,List all movies produced by Joel Silver.,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,235,Which movies were released in 1999?,"MATCH (m:Movie)
WHERE m.released = 1999
RETURN m.title","match
  $m isa movie;
  $m has released 1999;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,236,Who wrote the movie 'Speed Racer'?,"MATCH (p:Person)-[:WROTE]->(m:Movie {title: 'Speed Racer'})
RETURN p.name","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  (writer: $p, film: $m) isa wrote;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,237,Find all movies with a rating above 90.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 90
RETURN m.title, r.rating","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 90;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr
};"
movies,238,Show the top 3 movies with the lowest number of votes.,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,239,Which people were born between 1940 and 1960?,"MATCH (p:Person)
WHERE p.born >= 1940 AND p.born <= 1960
RETURN p.name AS name, p.born AS `birth year`","match
  $p isa person;
  $p has born $bornp;
  $bornp >= 1940;
  $bornp <= 1960;
  $p has name $namep;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,240,List all movies reviewed by people born after 1960.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1960
RETURN m.title AS movie, p.name AS reviewer, r.rating AS rating","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has born $bornp;
  $bornp > 1960;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""reviewer"": $namep,
  ""rating"": $ratingr
};"
movies,241,Who has directed more than one movie?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS num_directed
WHERE num_directed > 1
RETURN d.name AS director, num_directed AS movies_directed","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $d has name $named;
reduce $num_directed = count($m) groupby $named;
match $num_directed > 1;
fetch {
  ""director"": $named,
  ""movies_directed"": $num_directed
};"
movies,242,What are the roles played by Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS actor, m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title ""The Matrix"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""actor"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,243,List all movies with a tagline that includes 'Welcome'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Welcome'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""Welcome"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,246,Who are the people that Keanu Reeves follows?,"MATCH (keanu:Person {name: 'Keanu Reeves'})-[:FOLLOWS]->(person:Person)
RETURN person.name","match
  $keanu isa person, has name ""Keanu Reeves"";
  $person isa person;
  (follower: $keanu, followed: $person) isa follows;
  $person has name $nameperson;
fetch {
  ""name"": $nameperson
};"
movies,247,List all persons who have reviewed a movie with a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN p.name AS reviewer, m.title AS movie, r.rating AS rating","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr < 50;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""reviewer"": $namep,
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,249,"Find all movies with a summary 'Dark, but compelling'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has summary ""Dark, but compelling"";
fetch {
  ""title"": $t
};"
movies,250,List all movies with a vote count between 100 and 500.,"MATCH (m:Movie)
WHERE m.votes >= 100 AND m.votes <= 500
RETURN m.title, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $votesm >= 100;
  $votesm <= 500;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,252,What are the distinct summaries available for movie reviews?,"MATCH (:Person)-[r:REVIEWED]->(:Movie)
RETURN DISTINCT r.summary","match
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $p isa person;
  $m isa movie;
fetch {
  ""summary"": $summaryr
};"
movies,253,Which movies have been produced by more than one person?,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person)
WITH m, count(p) AS num_producers
WHERE num_producers > 1
RETURN m.title AS movie, num_producers","match
  $m isa movie;
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
reduce $num_producers = count($p) groupby $titlem;
match $num_producers > 1;
fetch {
  ""movie"": $titlem,
  ""num_producers"": $num_producers
};"
movies,254,List the top 5 movies with the highest release year.,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,257,What roles are available in the ACTED_IN relationship for movies released before 2000?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 2000
RETURN m.title, r.roles","match
  $p isa person;
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has released $releasedm;
  $releasedm < 2000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""roles"": $rolesr
};"
movies,258,Which people have both acted in and reviewed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,259,List all persons who have directed a movie and also follow someone.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE exists{ (p)-[:FOLLOWS]->(:Person) }
RETURN p.name","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (follower: $p, followed: $other) isa follows;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,262,Which movies have been reviewed with a rating of 100?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating = 100
RETURN m.title","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating 100;
fetch {
  ""title"": $t
};"
movies,264,Who are the top 5 persons with the most reviews written?,"MATCH (p:Person)-[r:REVIEWED]->()
RETURN p.name AS name, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 5","match
  $p isa person, has name $n;
  (reviewer: $p, film: $m) isa reviewed;
reduce $num_reviews = count($m) groupby $n;
sort $num_reviews desc;
limit 5;
fetch {
  ""name"": $n,
  ""num_reviews"": $num_reviews
};"
movies,266,Which people were born in the 1960s and have acted in movies?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN p.name AS person, collect(m.title) AS movies","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp >= 1960;
  $bornp < 1970;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movies"": $titlem
};"
movies,269,Find the top 5 movies with the lowest ratings in REVIEWS.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
RETURN m.title AS movie, avg(r.rating) AS averageRating
ORDER BY averageRating
LIMIT 5","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $averageRating = mean($r) groupby $t;
sort $averageRating asc;
limit 5;
fetch {
  ""movie"": $t,
  ""averageRating"": $averageRating
};"
movies,271,List all persons who have produced more than 3 movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS num_produced
WHERE num_produced > 3
RETURN p.name AS producer, num_produced AS movies_produced","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $num_produced = count($m) groupby $namep;
match $num_produced > 3;
fetch {
  ""producer"": $namep,
  ""movies_produced"": $num_produced
};"
movies,272,What are the roles played by Laurence Fishburne in 'The Matrix Revolutions'?,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN r.roles","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie, has title ""The Matrix Revolutions"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
fetch {
  ""roles"": $rolesr
};"
movies,273,Which movies have been acted in by persons born before 1950?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE p.born < 1950
RETURN m.title AS movie, p.name AS actor, p.born AS birthYear","match
  $m isa movie;
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp < 1950;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""actor"": $namep,
  ""birthYear"": $bornp
};"
movies,275,Who has directed the most movies released after 2000?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2000
WITH d, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 1
RETURN d.name AS director, num_movies","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has released $r;
  $r > 2000;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,279,List the top 3 actors with roles in movies released before 1980.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN p.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m);
  $m has released $releasedm;
  $releasedm < 1980;
  $p has name $namep;
reduce $roles = count($r) groupby $namep;
sort $roles desc;
limit 3;
fetch {
  ""actor"": $namep,
  ""roles"": $roles
};"
movies,281,"Find all movies with a summary 'Fun, but a little far fetched'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Fun, but a little far fetched'
RETURN m","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has summary ""Fun, but a little far fetched"";
fetch {
  ""title"": $t
};"
movies,282,Which actors have acted in both 'The Matrix' and 'Speed Racer'?,"MATCH (p:Person)-[:ACTED_IN]->(m1:Movie {title: 'The Matrix'}),
      (p)-[:ACTED_IN]->(m2:Movie {title: 'Speed Racer'})
RETURN p.name AS actor","match
  $p isa person;
  $m1 isa movie, has title ""The Matrix"";
  (actor: $p, film: $m1) isa acted_in;
  $m2 isa movie, has title ""Speed Racer"";
  (actor: $p, film: $m2) isa acted_in;
  $p has name $namep;
fetch {
  ""actor"": $namep
};"
movies,283,List all movies that Joel Silver has both produced and reviewed.,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
WHERE EXISTS {(p)-[:REVIEWED]->(m)}
RETURN m","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
  $m has released $releasedm;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,284,Who are the directors of movies with more than 1000 votes?,"MATCH (m:Movie)
WHERE m.votes > 1000
MATCH (d:Person)-[:DIRECTED]->(m)
RETURN d.name AS director, m.title AS movie","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $m has votes $votesm;
  $votesm > 1000;
  $d has name $named;
  $m has title $titlem;
fetch {
  ""director"": $named,
  ""movie"": $titlem
};"
movies,285,List the top 5 oldest movies in the database.,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,286,What are the roles played by actors in the movie 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS actor, r.roles AS roles","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
fetch {
  ""actor"": $namep,
  ""roles"": $rolesr
};"
movies,287,Which movies have been reviewed by more than two persons?,"MATCH (m:Movie)
WHERE size([(p)-[:REVIEWED]->(m) | p]) > 2
RETURN m.title","match
  $m isa movie, has title $t;
  (reviewer: $p, film: $m) isa reviewed;
reduce $count = count($p) groupby $t;
match $count > 2;
fetch {
  ""title"": $t
};"
movies,288,What are the top 5 movies released between 2000 and 2010?,"MATCH (m:Movie)
WHERE m.released >= 2000 AND m.released <= 2010
RETURN m.title, m.released, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 2000;
  $releasedm <= 2010;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm,
  ""votes"": $votesm
};"
movies,289,List 3 people born before 1960.,"MATCH (p:Person)
WHERE p.born < 1960
RETURN p.name
LIMIT 3","match
  $p isa person;
  $p has born $bornp;
  $bornp < 1960;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,290,Which movies have more than 5000 votes?,"MATCH (m:Movie)
WHERE m.votes > 5000
RETURN m.title, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $votesm > 5000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,291,Name 3 persons who acted in a movie released before 1980.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released $releasedm;
  $releasedm < 1980;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,292,Who are the top 5 directors of movies released after 1995?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 1995
WITH d, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN d.name AS director, num_movies","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has released $r;
  $r > 1995;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 5;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,293,What are the top 3 movies with the highest number of votes?,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,294,List 3 actors who have acted in more than one movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS num_movies
WHERE num_movies > 1
RETURN p.name AS actor
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
reduce $num_movies = count($m) groupby $namep;
match $num_movies > 1;
limit 3;
fetch {
  ""actor"": $namep
};"
movies,295,Which person has directed the most films? Limit to top 3.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name AS director, count(m) AS num_films_directed
ORDER BY num_films_directed DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has name $namep;
reduce $num_films_directed = count($m) groupby $namep;
sort $num_films_directed desc;
limit 3;
fetch {
  ""director"": $namep,
  ""num_films_directed"": $num_films_directed
};"
movies,296,Who are the people that Keanu Reeves follows?,"MATCH (keanu:Person {name: 'Keanu Reeves'})-[:FOLLOWS]->(person:Person)
RETURN person.name","match
  $keanu isa person, has name ""Keanu Reeves"";
  $person isa person;
  (follower: $keanu, followed: $person) isa follows;
  $person has name $nameperson;
fetch {
  ""name"": $nameperson
};"
movies,297,List three movies reviewed with a rating above 90.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 90
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 90;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,298,What are the roles of Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN r.roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title ""The Matrix"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
fetch {
  ""roles"": $rolesr
};"
movies,299,Who produced 'Speed Racer' and what year was it released?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS producer, m.released AS year","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
  $m has released $releasedm;
fetch {
  ""producer"": $namep,
  ""year"": $releasedm
};"
movies,300,Which movies did Lana Wachowski direct?,"MATCH (p:Person {name: 'Lana Wachowski'})-[:DIRECTED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Lana Wachowski"";
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,301,List the top 3 highest-rated movies by reviews.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
RETURN m.title AS movie, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avgRating = mean($r) groupby $t;
sort $avgRating desc;
limit 3;
fetch {
  ""movie"": $t,
  ""avgRating"": $avgRating
};"
movies,302,Name 3 people who were born after 1980 and have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1980
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1980;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,303,Who wrote 'Something's Gotta Give' and what is the movie's release year?,"MATCH (m:Movie {title: ""Something's Gotta Give""})<-[:WROTE]-(p:Person)
RETURN p.name AS writer, m.released AS releaseYear","match
  $m isa movie, has title ""Something's Gotta Give"";
  $p isa person;
  (writer: $p, film: $m) isa wrote;
  $p has name $namep;
  $m has released $releasedm;
fetch {
  ""writer"": $namep,
  ""releaseYear"": $releasedm
};"
movies,304,What are the top 3 least voted for movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,307,Who reviewed the movie with the highest rating and what was the summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, m, r
ORDER BY r.rating DESC
LIMIT 1
RETURN p.name AS reviewer, m.title AS movie, r.summary AS review_summary","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $p has name $namep;
  $m has title $titlem;
sort $ratingr desc;
limit 1;
fetch {
  ""reviewer"": $namep,
  ""movie"": $titlem,
  ""review_summary"": $summaryr
};"
movies,311,What are the roles played by actors in 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS actor, r.roles AS roles","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
fetch {
  ""actor"": $namep,
  ""roles"": $rolesr
};"
movies,313,How many people have directed more than two movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS num_directed
WHERE num_directed > 2
RETURN count(p) AS num_people_directed_more_than_two","match
  $p isa person, has name $n;
  (director: $p, film: $m) isa directed;
reduce $num_directed = count($m) groupby $n;
match $num_directed > 2;
reduce $num_people_directed_more_than_two = count($n);
fetch {
  ""num_people_directed_more_than_two"": $num_people_directed_more_than_two
};"
movies,315,Name 3 movies that Keanu Reeves has acted in.,"MATCH (p:Person {name: 'Keanu Reeves'})-[:ACTED_IN]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,316,What are the top 3 oldest movies in the database by release year?,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,317,What are the titles of the top 5 movies released in 1999?,"MATCH (m:Movie)
WHERE m.released = 1999
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has released 1999;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,318,List the first 3 movies reviewed by a person born in 1960.,"MATCH (p:Person {born: 1960})-[r:REVIEWED]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has born 1960;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,319,Which movies have a tagline containing the word 'freedom'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'freedom'
RETURN m.title","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""freedom"";
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,320,Find the top 5 movies with the highest votes released after 2000.,"MATCH (m:Movie)
WHERE m.released > 2000 AND m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,321,Who are the top 3 people born after 1970 who directed a movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1970
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1970;
  $p has name $namep;
sort $bornp desc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,322,List all movies released between 1990 and 2000 that have more than 100 votes.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
  AND m.votes IS NOT NULL AND m.votes > 100
RETURN m.title, m.released, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm <= 2000;
  $votesm > 100;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm,
  ""votes"": $votesm
};"
movies,323,What are the names of the first 5 people who acted in a movie with the tagline 'Everything is connected'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Everything is connected'})
RETURN p.name
LIMIT 5","match
  $p isa person;
  $m isa movie, has tagline ""Everything is connected"";
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
limit 5;
fetch {
  ""name"": $namep
};"
movies,324,Which top 3 movies released before 1985 were reviewed with a rating above 90?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE m.released < 1985 AND r.rating > 90
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has released $releasedm;
  $releasedm < 1985;
  $ratingr > 90;
  $m has title $titlem;
sort $ratingr desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr
};"
movies,325,List the first 5 movies produced by a person born in 1967.,"MATCH (p:Person {born: 1967})-[:PRODUCED]->(m:Movie)
RETURN m.title
LIMIT 5","match
  $p isa person, has born 1967;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,326,Name the top 3 directors of movies that had a tagline mentioning 'Houston'.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'Houston'
RETURN d.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $m has tagline $taglinem;
  $taglinem contains ""Houston"";
  $d has name $named;
reduce $num_movies = count($m) groupby $named;
sort $num_movies desc;
limit 3;
fetch {
  ""director"": $named,
  ""num_movies"": $num_movies
};"
movies,327,What are the names of the first 3 people who reviewed a movie titled 'Apollo 13'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Apollo 13'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie, has title ""Apollo 13"";
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,328,Which top 5 people have directed movies with more than 200 votes?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes > 200
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS director, num_movies","match
  $p isa person, has name $n;
  (director: $p, film: $m) isa directed;
  $m has votes $v;
  $v > 200;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 5;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,329,List the first 3 people who acted in a movie released in 2012.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released = 2012
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released 2012;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,330,What are the names of the top 5 people who followed someone born in 1956?,"MATCH (p:Person)-[:FOLLOWS]->(followed:Person {born: 1956})
RETURN p.name
ORDER BY p.name
LIMIT 5","match
  $p isa person;
  $followed isa person, has born 1956;
  (follower: $p, followed: $followed) isa follows;
  $p has name $namep;
sort $namep asc;
limit 5;
fetch {
  ""name"": $namep
};"
movies,331,Who are the top 3 producers of movies with a tagline including 'Speed'?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline CONTAINS 'Speed'
RETURN p.name AS producer, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has tagline $taglinem;
  $taglinem contains ""Speed"";
  $p has name $namep;
reduce $movieCount = count($m) groupby $namep;
sort $movieCount desc;
limit 3;
fetch {
  ""producer"": $namep,
  ""movieCount"": $movieCount
};"
movies,334,Name the first 3 people born before 1970 who produced a movie released after 2000.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1970 AND m.released > 2000
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp < 1970;
  $m has released $releasedm;
  $releasedm > 2000;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,335,Which top 5 movies received the highest ratings in reviews written by someone born in 1965?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born = 1965
WITH m, max(r.rating) AS maxRating
ORDER BY maxRating DESC
LIMIT 5
RETURN m.title AS movie, maxRating AS rating","match
  $p isa person, has born 1965;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
  $m has title $t;
sort $r desc;
limit 5;
fetch {
  ""movie"": $t,
  ""rating"": $r
};"
movies,336,List the first 3 movies with a tagline containing the word 'real' and released before 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real' AND m.released < 2000
RETURN m.title, m.tagline, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""real"";
  $m has released $releasedm;
  $releasedm < 2000;
  $m has title $titlem;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,337,What are the names of the top 5 people who acted in and also reviewed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
WITH p, count(*) AS count
ORDER BY count DESC
LIMIT 5
RETURN p.name","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
reduce $count = count($m) groupby $namep;
sort $count desc;
limit 5;
fetch {
  ""name"": $namep
};"
movies,338,List the first 3 movies directed by persons who were born after 1950 and before 1960.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1950 AND p.born < 1960
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1950;
  $bornp < 1960;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,340,List the top 5 movies with a tagline mentioning 'compelling' and having more than 50 votes.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'compelling' AND m.votes > 50
RETURN m.title, m.tagline, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""compelling"";
  $m has votes $votesm;
  $votesm > 50;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""votes"": $votesm
};"
movies,341,"Name the first 3 people who have reviewed a movie with a summary stating 'Silly, but fun'.","MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Silly, but fun'
RETURN p.name
LIMIT 3","match
$p isa person, has name $name;
$m isa movie;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Silly, but fun"";
limit 3;
fetch {
  ""name"": $name
};"
movies,342,Which top 3 movies have been both produced and reviewed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:REVIEWED]-(p)
WITH m, p
ORDER BY m.votes DESC
LIMIT 3
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
  $p has name $namep;
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""person"": $namep
};"
movies,344,Who are the top 3 people born after 1960 who have directed a movie titled 'V for Vendetta'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie {title: 'V for Vendetta'})
WHERE p.born > 1960
RETURN p.name
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $m isa movie, has title ""V for Vendetta"";
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1960;
  $p has name $namep;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep
};"
movies,346,What are the names of the top 5 people who have followed more than three other persons?,"MATCH (p:Person)-[:FOLLOWS]->(otherPerson:Person)
WITH p, count(otherPerson) AS followCount
WHERE followCount > 3
RETURN p.name
ORDER BY followCount DESC
LIMIT 5","match
  $p isa person;
  $otherPerson isa person;
  (follower: $p, followed: $otherPerson) isa follows;
  $p has name $namep;
reduce $followCount = count($otherPerson) groupby $namep;
match $followCount > 3;
sort $followCount desc;
limit 5;
fetch {
  ""name"": $namep
};"
movies,348,Who are the top 3 people who have acted in at least two movies with more than 100 votes each?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.votes > 100
WITH p, count(m) AS numMovies
WHERE numMovies >= 2
RETURN p.name
ORDER BY numMovies DESC
LIMIT 3","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has votes $v;
  $v > 100;
reduce $numMovies = count($m) groupby $n;
match $numMovies >= 2;
sort $numMovies desc;
limit 3;
fetch {
  ""name"": $n
};"
movies,349,List the first 5 movies where the tagline includes the word 'Houston' and the released year is before 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Houston' AND m.released < 2000
RETURN m.title, m.tagline, m.released
LIMIT 5","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""Houston"";
  $m has released $releasedm;
  $releasedm < 2000;
  $m has title $titlem;
limit 5;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,350,Name the first 3 people born before 1950 who have written a movie with a tagline mentioning 'journey'.,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born < 1950 AND m.tagline CONTAINS 'journey'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $p has born $bornp;
  $bornp < 1950;
  $m has tagline $taglinem;
  $taglinem contains ""journey"";
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,351,Which top 5 movies released between 1980 and 1990 have been reviewed with a summary mentioning 'compelling'?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE m.released >= 1980 AND m.released <= 1990
  AND r.summary CONTAINS 'compelling'
RETURN m.title, m.released, r.summary
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $m has released $releasedm;
  $releasedm >= 1980;
  $releasedm <= 1990;
  $summaryr contains ""compelling"";
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm,
  ""summary"": $summaryr
};"
movies,352,List the first 3 persons who have produced a movie with a tagline including 'real world' and released after 1995.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline CONTAINS 'real world' AND m.released > 1995
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has tagline $taglinem;
  $taglinem contains ""real world"";
  $m has released $releasedm;
  $releasedm > 1995;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,354,List the top 5 movies that have been directed by someone born in 1967.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WHERE d.born = 1967
RETURN m.title, m.tagline, m.released, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has born 1967;
  $m has title $titlem;
  $m has tagline $taglinem;
  $m has released $releasedm;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm,
  ""votes"": $votesm
};"
movies,355,Name the first 3 people who have reviewed a movie with a tagline stating 'Welcome to the Real World'.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE m.tagline = 'Welcome to the Real World'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (reviewer: $p, film: $m) isa reviewed;
  $m has tagline ""Welcome to the Real World"";
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,356,Which movies have more than 1000 votes?,"MATCH (m:Movie)
WHERE m.votes > 1000
RETURN m.title, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $votesm > 1000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,357,List all movies released after 2000.,"MATCH (m:Movie)
WHERE m.released > 2000
RETURN m.title, m.released","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,358,Who acted in 'The Matrix'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name","match
  $p isa person;
  $m isa movie, has title ""The Matrix"";
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,359,Find all directors of movies released before 1990.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released < 1990
RETURN p.name AS director, m.title AS movie, m.released AS year","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has released $releasedm;
  $releasedm < 1990;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""director"": $namep,
  ""movie"": $titlem,
  ""year"": $releasedm
};"
movies,360,Which persons have a birth year after 1950?,"MATCH (p:Person)
WHERE p.born > 1950
RETURN p","match
  $p isa person;
  $p has born $bornp;
  $bornp > 1950;
  $p has name $namep;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,361,What are the roles of Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS person, m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title ""The Matrix"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,362,How many movies has Keanu Reeves acted in?,"MATCH (p:Person {name: 'Keanu Reeves'})-[:ACTED_IN]->(m:Movie)
RETURN count(m) AS numMovies","match
  $p isa person, has name ""Keanu Reeves"";
  (actor: $p, film: $m) isa acted_in;
reduce $numMovies = count($m);
fetch {
  ""numMovies"": $numMovies
};"
movies,363,List movies with a tagline that includes the word 'world'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'world'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""world"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,364,Which movies were produced by Joel Silver?,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,365,What are the highest-rated reviews and which movies do they belong to?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating IS NOT NULL
WITH m, r
ORDER BY r.rating DESC
RETURN m.title AS movie, r.summary AS review, r.rating AS rating
LIMIT 5","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $m has title $titlem;
sort $ratingr desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""review"": $summaryr,
  ""rating"": $ratingr
};"
movies,366,List all the movies reviewed with a rating above 80.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 80
RETURN m.title, r.rating, r.summary","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $ratingr > 80;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr,
  ""summary"": $summaryr
};"
movies,367,Who has reviewed 'Speed Racer' and what was their rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS reviewer, r.rating AS rating","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""rating"": $ratingr
};"
movies,368,Find all the people who follow Keanu Reeves.,"MATCH (p:Person)-[:FOLLOWS]->(keanu:Person {name: 'Keanu Reeves'})
RETURN p","match
  $p isa person;
  $keanu isa person, has name ""Keanu Reeves"";
  (follower: $p, followed: $keanu) isa follows;
  $p has name $namep;
  $p has born $bornp;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,369,Who are the top 5 oldest actors in the database?,"MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name, p.born
ORDER BY p.born
LIMIT 5","match
  $p isa person;
  (actor: $p) isa acted_in;
  $p has name $namep;
  $p has born $bornp;
sort $bornp asc;
limit 5;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,370,List all the movies reviewed with the summary 'An amazing journey'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'An amazing journey'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""An amazing journey"";

fetch {
  ""title"": $title
};"
movies,371,Which person wrote the most movies?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
RETURN p.name AS person, count(m) AS movies_written
ORDER BY movies_written DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $p has name $namep;
reduce $movies_written = count($m) groupby $namep;
sort $movies_written desc;
limit 1;
fetch {
  ""person"": $namep,
  ""movies_written"": $movies_written
};"
movies,372,Who produced the most movies released after 2000?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released > 2000
WITH p, count(m) AS num_movies
RETURN p.name AS producer, num_movies
ORDER BY num_movies DESC
LIMIT 1","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  $m has released $r;
  $r > 2000;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""producer"": $n,
  ""num_movies"": $num_movies
};"
movies,373,List all movies with a release year in the 1980s.,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released < 1990
RETURN m.title, m.released","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1980;
  $releasedm < 1990;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,374,Who directed 'Speed Racer'?,"MATCH (m:Movie {title: 'Speed Racer'})<-[:DIRECTED]-(d:Person)
RETURN d.name AS director","match
  $m isa movie, has title ""Speed Racer"";
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has name $named;
fetch {
  ""director"": $named
};"
movies,375,Find all actors born in the 1960s.,"MATCH (p:Person)
WHERE p.born >= 1960 AND p.born < 1970
  AND exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name AS actor, p.born AS `birth year`","match
  $p isa person;
  (actor: $p) isa acted_in;
  $p has born $bornp;
  $bornp >= 1960;
  $bornp < 1970;
  $p has name $namep;
fetch {
  ""actor"": $namep,
  ""born"": $bornp
};"
movies,376,Who reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 1
RETURN p.name AS reviewer, num_reviews AS number_of_reviews","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
reduce $num_reviews = count($r) groupby $namep;
sort $num_reviews desc;
limit 1;
fetch {
  ""reviewer"": $namep,
  ""number_of_reviews"": $num_reviews
};"
movies,377,What are the different roles played by Laurence Fishburne in his career?,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie)
RETURN p.name AS actor, m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""actor"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,380,List all relationships of Lana Wachowski.,"MATCH (p:Person {name: 'Lana Wachowski'})-[r]->(m)
RETURN type(r) as relationship, m.title as movie","match
  $p isa person, has name ""Lana Wachowski"";
  { (director: $p, film: $m) isa directed; } or
  { (producer: $p, film: $m) isa produced; } or
  { (writer: $p, film: $m) isa wrote; };
  $m has title $t;
fetch {
  ""movie"": $t
};"
movies,381,Find movies with fewer than 50 votes.,"MATCH (m:Movie)
WHERE m.votes < 50
RETURN m.title, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $votesm < 50;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,383,"Which movies have been reviewed with the summary 'Dark, but compelling'?","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Dark, but compelling"";

fetch {
  ""title"": $title
};"
movies,384,Who was born in 1965 and has directed a movie?,"MATCH (p:Person)
WHERE p.born = 1965 AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name","match
  $p isa person;
  (director: $p) isa directed;
  $p has born 1965;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,385,List all movies with a released year divisible by 10.,"MATCH (m:Movie)
WHERE m.released % 10 = 0
RETURN m.title, m.released","match
  $m isa movie, has title $t, has released $r;
  $r % 10 == 0;
fetch {
  ""title"": $t,
  ""released"": $r
};"
movies,386,What are the summaries of reviews for movies released before 1985?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE m.released < 1985
RETURN m.title AS movie, r.summary AS review","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $m has released $releasedm;
  $releasedm < 1985;
  $m has title $titlem;
fetch {
  ""movie"": $titlem,
  ""review"": $summaryr
};"
movies,389,Who has produced movies but never acted in any?,"MATCH (p:Person)
WHERE exists{ (p)-[:PRODUCED]->(:Movie) }
  AND NOT exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  not { (actor: $p, film: $m2) isa acted_in; };
fetch {
  ""name"": $n
};"
movies,390,What roles did Laurence Fishburne play in 'The Matrix Revolutions'?,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN p.name AS actor, m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie, has title ""The Matrix Revolutions"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""actor"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,391,List the movies where the actors were born before 1950.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE p.born < 1950
RETURN m.title AS movie, collect(p.name) AS actors","match
  $m isa movie;
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp < 1950;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""actors"": $namep
};"
movies,393,"List all movies that have a 'Fun, but a little far fetched' review summary.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Fun, but a little far fetched'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Fun, but a little far fetched"";

fetch {
  ""title"": $title
};"
movies,394,List the movies directed by persons born after 1960.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > 1960
RETURN m.title","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp > 1960;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,397,Who has directed the most movies with a tagline containing 'limit'?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'limit'
WITH d, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 1
RETURN d.name AS director, num_movies","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has tagline $tag;
  $tag like "".*limit.*"";
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,398,Find all movies where Joel Silver acted.,"MATCH (p:Person {name: 'Joel Silver'})-[:ACTED_IN]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,400,List all persons who have not reviewed any movies.,"MATCH (p:Person)
WHERE NOT exists { (p)-[:REVIEWED]->(:Movie) }
RETURN p","match
  $p isa person, has name $n;
  not { (reviewer: $p, film: $m) isa reviewed; };
fetch {
  ""name"": $n
};"
movies,401,Who has produced the highest-rated reviewed movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[r:REVIEWED]-(reviewer:Person)
WITH p, m, max(r.rating) AS maxRating
ORDER BY maxRating DESC
LIMIT 1
RETURN p.name AS producer, m.title AS movie, maxRating AS rating","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  $rev isa reviewed (reviewer: $rev_p, film: $m), has rating $r;
  $m has title $t;
sort $r desc;
limit 1;
fetch {
  ""producer"": $n,
  ""movie"": $t,
  ""rating"": $r
};"
movies,402,What are the top 5 most frequently appearing review summaries?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN r.summary, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
reduce $frequency = count($p) groupby $summaryr;
sort $frequency desc;
limit 5;
fetch {
  ""summary"": $summaryr,
  ""frequency"": $frequency
};"
movies,403,List all persons who have directed and reviewed the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,404,Find all persons born in 1996.,"MATCH (p:Person)
WHERE p.born = 1996
RETURN p","match
  $p isa person;
  $p has born 1996;
  $p has name $namep;
  $p has born $bornp;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,405,Who has the most diverse roles across different movies?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(collect(distinct r.roles)) AS num_roles
RETURN p.name AS actor, num_roles
ORDER BY num_roles DESC
LIMIT 1","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $num_roles = count($r) groupby $n;
sort $num_roles desc;
limit 1;
fetch {
  ""actor"": $n,
  ""num_roles"": $num_roles
};"
movies,406,List all movies with a 'Pretty funny at times' review summary.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Pretty funny at times'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Pretty funny at times"";

fetch {
  ""title"": $title
};"
movies,407,Which directors have also acted in the movies they directed?,"MATCH (director:Person)-[:DIRECTED]->(movie:Movie)<-[:ACTED_IN]-(director)
RETURN director.name AS director, collect(movie.title) AS movies","match
  $director isa person;
  $movie isa movie;
  (director: $director, film: $movie) isa directed;
  (actor: $director, film: $movie) isa acted_in;
  $director has name $namedirector;
  $movie has title $titlemovie;
fetch {
  ""director"": $namedirector,
  ""movies"": $titlemovie
};"
movies,409,List the top 5 movies with the lowest votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $m has title $titlem;
sort $votesm asc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,411,Find the youngest person who has reviewed a movie released before 1990.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE m.released < 1990
RETURN p, r, m
ORDER BY p.born DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $m has released $releasedm;
  $releasedm < 1990;
  $p has name $namep;
  $p has born $bornp;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
sort $bornp desc;
limit 1;
fetch {
  ""name"": $namep,
  ""born"": $bornp,
  ""r"": $r,
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,412,Who has acted in the most movies released in the 1990s?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 1
RETURN p.name AS actor, num_movies","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has released $r;
  $r >= 1990;
  $r < 2000;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""actor"": $n,
  ""num_movies"": $num_movies
};"
movies,414,Which person reviewed 'The Matrix Revolutions' and what was their summary?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN p.name AS reviewer, r.summary AS review_summary","match
  $p isa person;
  $m isa movie, has title ""The Matrix Revolutions"";
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""review_summary"": $summaryr
};"
movies,415,Who are the people who have not acted in any movie?,"MATCH (p:Person)
WHERE NOT exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name","match
  $p isa person, has name $n;
  not { (actor: $p, film: $m) isa acted_in; };
fetch {
  ""name"": $n
};"
movies,416,List the movies that have been reviewed with a rating less than 50.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating < 50
RETURN m.title AS movie, r.rating AS rating","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr < 50;
  $m has title $titlem;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,417,Who directed the oldest movie in the database?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WITH m, d
ORDER BY m.released
LIMIT 1
RETURN d.name AS director, m.title AS movie, m.released AS year","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has name $named;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 1;
fetch {
  ""director"": $named,
  ""movie"": $titlem,
  ""year"": $releasedm
};"
movies,419,List top 5 movies reviewed by persons born before 1970.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born < 1970
RETURN m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has born $bornp;
  $bornp < 1970;
  $m has title $titlem;
sort $ratingr desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,420,Who has written the most movies released after 2000?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE m.released > 2000
WITH p, count(m) AS num_movies
RETURN p.name, num_movies
ORDER BY num_movies DESC
LIMIT 1","match
  $p isa person, has name $n;
  (writer: $p, film: $m) isa wrote;
  $m has released $r;
  $r > 2000;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""name"": $n,
  ""num_movies"": $num_movies
};"
movies,422,Which movies have been reviewed by persons following Keanu Reeves?,"MATCH (follower:Person)-[:FOLLOWS]->(:Person {name: 'Keanu Reeves'}),
      (follower)-[:REVIEWED]->(movie:Movie)
RETURN movie.title AS movie, follower.name AS reviewer","match
  $keanu isa person, has name ""Keanu Reeves"";
  $follower isa person;
  (follower: $follower, followed: $keanu) isa follows;
  $movie isa movie;
  (reviewer: $follower, film: $movie) isa reviewed;
  $movie has title $titlemovie;
  $follower has name $namefollower;
fetch {
  ""movie"": $titlemovie,
  ""reviewer"": $namefollower
};"
movies,423,Who has directed and reviewed the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,426,List all persons who have produced at least three movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS num_produced
WHERE num_produced >= 3
RETURN p.name AS producer, num_produced","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $num_produced = count($m) groupby $namep;
match $num_produced >= 3;
fetch {
  ""producer"": $namep,
  ""num_produced"": $num_produced
};"
movies,427,Which movie has the highest number of votes and was released in the 1990s?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m.title AS movie, m.votes AS votes
ORDER BY m.votes DESC
LIMIT 1","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 1;
fetch {
  ""movie"": $titlem,
  ""votes"": $votesm
};"
movies,430,Who are the top 3 actors with the most diverse roles?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(collect(distinct r.roles)) AS num_roles
ORDER BY num_roles DESC
LIMIT 3
RETURN p.name AS actor, num_roles AS number_of_distinct_roles","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $num_roles = count($r) groupby $n;
sort $num_roles desc;
limit 3;
fetch {
  ""actor"": $n,
  ""number_of_distinct_roles"": $num_roles
};"
movies,431,Which persons have directed the most movies with a tagline containing 'world'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'world'
WITH p, count(m) AS num_movies
RETURN p.name, num_movies
ORDER BY num_movies DESC
LIMIT 1","match
  $p isa person, has name $n;
  (director: $p, film: $m) isa directed;
  $m has tagline $tag;
  $tag like "".*world.*"";
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""name"": $n,
  ""num_movies"": $num_movies
};"
movies,432,Who has the most roles in movies released before 1985?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 1985
WITH p, count(r) AS numRoles
RETURN p.name AS name, numRoles
ORDER BY numRoles DESC
LIMIT 1","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has released $r;
  $r < 1985;
reduce $numRoles = count($m) groupby $n;
sort $numRoles desc;
limit 1;
fetch {
  ""name"": $n,
  ""numRoles"": $numRoles
};"
movies,433,List all movies reviewed with a summary containing 'journey'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'journey'
RETURN m.title AS movie","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""journey"";
  $m has title $titlem;
fetch {
  ""movie"": $titlem
};"
movies,434,Who has reviewed the most movies with a rating above 90?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 1
RETURN p.name AS reviewer, num_reviews AS number_of_reviews","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
  $r > 90;
reduce $num_reviews = count($m) groupby $n;
sort $num_reviews desc;
limit 1;
fetch {
  ""reviewer"": $n,
  ""number_of_reviews"": $num_reviews
};"
movies,435,List all movies where the producer has also acted.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title AS movie, p.name AS producer_actor","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""producer_actor"": $namep
};"
movies,436,Who has directed the most movies with at least three different actors?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Person)
WITH d, m, collect(a) AS actors
WHERE size(actors) >= 3
WITH d, count(m) AS num_movies
RETURN d.name AS director, num_movies
ORDER BY num_movies DESC
LIMIT 1","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  (actor: $a1, film: $m) isa acted_in;
  (actor: $a2, film: $m) isa acted_in;
  (actor: $a3, film: $m) isa acted_in;
  not { $a1 is $a2; };
  not { $a1 is $a3; };
  not { $a2 is $a3; };
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,437,Who reviewed 'The Matrix' and what was their rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS reviewer, r.rating AS rating","match
  $p isa person;
  $m isa movie, has title ""The Matrix"";
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""rating"": $ratingr
};"
movies,438,List the top 5 youngest people who have written a movie.,"MATCH (p:Person)-[:WROTE]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $p has name $namep;
  $p has born $bornp;
sort $bornp desc;
limit 5;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,439,Who has the most productions in movies released in the 2000s?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
WITH p, count(m) AS productions
RETURN p.name AS producer, productions
ORDER BY productions DESC
LIMIT 1","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  $m has released $r;
  $r >= 2000;
  $r < 2010;
reduce $productions = count($m) groupby $n;
sort $productions desc;
limit 1;
fetch {
  ""producer"": $n,
  ""productions"": $productions
};"
movies,440,Which movies have been produced by persons born in the 1950s?,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person)
WHERE p.born >= 1950 AND p.born < 1960
RETURN m.title AS movie","match
  $m isa movie;
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp >= 1950;
  $bornp < 1960;
  $m has title $titlem;
fetch {
  ""movie"": $titlem
};"
movies,441,Who are the top 5 actors with the most reviews for movies they acted in?,"MATCH (a:Person)-[:ACTED_IN]->(m:Movie)<-[r:REVIEWED]-(p:Person)
RETURN a.name AS actor, count(r) AS reviews
ORDER BY reviews DESC
LIMIT 5","match
  $a isa person, has name $n;
  (actor: $a, film: $m) isa acted_in;
  (reviewer: $rev_p, film: $m) isa reviewed;
reduce $reviews = count($m) groupby $n;
sort $reviews desc;
limit 5;
fetch {
  ""actor"": $n,
  ""reviews"": $reviews
};"
movies,442,List all movies with a tagline containing 'end'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'end'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""end"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,443,Who has the most directed movies without acting in any of them?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE NOT exists{ (d)-[:ACTED_IN]->() }
WITH d, count(m) AS directedCount
RETURN d.name AS director, directedCount
ORDER BY directedCount DESC
LIMIT 1","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  not { (actor: $d, film: $m2) isa acted_in; };
reduce $directedCount = count($m) groupby $n;
sort $directedCount desc;
limit 1;
fetch {
  ""director"": $n,
  ""directedCount"": $directedCount
};"
movies,444,List all persons born in 1970 and what movies they have produced.,"MATCH (p:Person {born: 1970})-[:PRODUCED]->(m:Movie)
RETURN p.name AS person, collect(m.title) AS produced_movies","match
  $p isa person, has born 1970;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""produced_movies"": $titlem
};"
movies,445,What are the titles of the top 5 movies with the highest number of votes?,"MATCH (m:Movie)
RETURN m.title
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,446,List the names of 3 persons who were born after 1980.,"MATCH (p:Person)
WHERE p.born > 1980
RETURN p.name
LIMIT 3","match
  $p isa person;
  $p has born $bornp;
  $bornp > 1980;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,447,Which movies were released between 1990 and 2000?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
RETURN m.title, m.released","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm <= 2000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,448,Name 3 movies that have the tagline 'Welcome to the Real World'.,"MATCH (m:Movie)
WHERE m.tagline = 'Welcome to the Real World'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline ""Welcome to the Real World"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,449,Who are the top 5 actors by the number of movies they acted in?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5
RETURN p.name AS actor, movieCount","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
reduce $movieCount = count($m) groupby $namep;
sort $movieCount desc;
limit 5;
fetch {
  ""actor"": $namep,
  ""movieCount"": $movieCount
};"
movies,450,Find 3 directors who directed movies released after 2000.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2000
RETURN d.name AS director, m.title AS movie
LIMIT 3","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $m has released $releasedm;
  $releasedm > 2000;
  $d has name $named;
  $m has title $titlem;
limit 3;
fetch {
  ""director"": $named,
  ""movie"": $titlem
};"
movies,451,What are the names of 3 persons who reviewed movies with a rating above 80?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 80
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 80;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,453,What are the top 3 movies by release year with a tagline containing 'freedom'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'freedom'
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""freedom"";
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,456,"Name 3 actors who have acted in a movie with the tagline 'Dark, but compelling'.","MATCH (p:Person)-[:ACTED_IN]->(m:Movie {tagline: 'Dark, but compelling'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie, has tagline ""Dark, but compelling"";
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,457,What are the top 3 highest rated reviews and which movies they are associated with?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN m.title AS movie, r.summary AS review, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $m has title $titlem;
sort $ratingr desc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""review"": $summaryr,
  ""rating"": $ratingr
};"
movies,458,Find 3 directors who have directed movies with fewer than 50 votes.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.votes < 50
RETURN d.name AS director, m.title AS movie, m.votes AS votes
LIMIT 3","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $m has votes $votesm;
  $votesm < 50;
  $d has name $named;
  $m has title $titlem;
limit 3;
fetch {
  ""director"": $named,
  ""movie"": $titlem,
  ""votes"": $votesm
};"
movies,460,"List 3 persons who have acted in, directed, and produced at least one movie each.","MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
  AND exists{ (p)-[:DIRECTED]->(:Movie) } 
  AND exists{ (p)-[:PRODUCED]->(:Movie) }
RETURN p.name
LIMIT 3","match
  $p isa person;
  (actor: $p) isa acted_in;
  (director: $p) isa directed;
  (producer: $p) isa produced;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,462,Name 3 movies with taglines that contain the word 'Speed'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Speed'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""Speed"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,463,List the top 5 most reviewed movies by the number of reviews.,"MATCH (m:Movie)<-[r:REVIEWED]-(:Person)
RETURN m.title AS movie, count(r) AS numReviews
ORDER BY numReviews DESC
LIMIT 5","match
  $m isa movie, has title $t;
  (reviewer: $p, film: $m) isa reviewed;
reduce $numReviews = count($p) groupby $t;
sort $numReviews desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numReviews"": $numReviews
};"
movies,464,Who are 3 actors who have acted in movies released before 1980?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released $releasedm;
  $releasedm < 1980;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,467,List 3 movies reviewed with the summary 'An amazing journey'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'An amazing journey'
RETURN m.title
LIMIT 3","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""An amazing journey"";
limit 3;
fetch {
  ""title"": $title
};"
movies,468,Which 3 directors have the highest average movie rating for movies they directed?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[r:REVIEWED]-(:Person)
WITH d, avg(r.rating) AS avg_rating
RETURN d.name AS director, avg_rating
ORDER BY avg_rating DESC
LIMIT 3","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avg_rating = mean($r) groupby $n;
sort $avg_rating desc;
limit 3;
fetch {
  ""director"": $n,
  ""avg_rating"": $avg_rating
};"
movies,472,Which 3 persons have reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 3
RETURN p.name AS person, num_reviews","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
reduce $num_reviews = count($r) groupby $namep;
sort $num_reviews desc;
limit 3;
fetch {
  ""person"": $namep,
  ""num_reviews"": $num_reviews
};"
movies,473,Find 3 persons who have directed movies released in the 1990s.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p.name AS director
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $p has name $namep;
limit 3;
fetch {
  ""director"": $namep
};"
movies,474,List 3 movies that have been reviewed with a summary mentioning 'funny'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'funny'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""funny"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,476,What are the 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,477,Name 3 persons who have produced the most movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $movie_count = count($m) groupby $namep;
sort $movie_count desc;
limit 3;
fetch {
  ""name"": $namep,
  ""movie_count"": $movie_count
};"
movies,479,What are the top 5 movies by vote count that have a tagline mentioning 'real'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'real'
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""real"";
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,480,Name 3 actors who have acted in movies with at least 1000 votes.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.votes >= 1000
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has votes $votesm;
  $votesm >= 1000;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,481,List the top 3 movies with the least votes.,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,482,Which 3 directors have directed the most movies released after 2005?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 2005
WITH d, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN d.name AS director, num_movies","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has released $r;
  $r > 2005;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 3;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,483,What are the names of 3 persons who reviewed movies with a rating lower than 60?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 60
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr < 60;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,485,Name 3 movies that were produced by persons born after 1970.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1970
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp > 1970;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,487,What are the 3 newest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,489,Name the first 3 movies to be reviewed with a rating of exactly 75.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating = 75
RETURN m.title
LIMIT 3","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating 75;
limit 3;
fetch {
  ""title"": $t
};"
movies,490,List 3 movies with at least 2 reviews with a summary mentioning 'compelling'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'compelling'
WITH m, count(r) AS reviewCount
WHERE reviewCount >= 2
RETURN m.title
LIMIT 3","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has summary $s;
  $s like "".*compelling.*"";
reduce $reviewCount = count($rev) groupby $t;
match $reviewCount >= 2;
limit 3;
fetch {
  ""title"": $t
};"
movies,491,Who are the top 3 producers by the number of movies they produced?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name AS producer, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $movie_count = count($m) groupby $namep;
sort $movie_count desc;
limit 3;
fetch {
  ""producer"": $namep,
  ""movie_count"": $movie_count
};"
movies,493,List the top 5 actors by the variety of roles they played in movies.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(collect(distinct r.roles)) as roleCount
ORDER BY roleCount DESC
LIMIT 5
RETURN p.name as actor, roleCount as numberOfRoles","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $roleCount = count($r) groupby $n;
sort $roleCount desc;
limit 5;
fetch {
  ""actor"": $n,
  ""numberOfRoles"": $roleCount
};"
movies,494,What are the 3 oldest persons in the database?,"MATCH (p:Person)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,497,List the titles of 3 movies that have been both acted in and reviewed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,498,What are the top 3 movies by number of votes that were produced by someone born before 1960?,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person)
WHERE p.born < 1960 AND exists((m)<-[:REVIEWED]-())
RETURN m.title AS movie, m.votes AS votes
ORDER BY m.votes DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp < 1960;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""votes"": $votesm
};"
movies,499,Name 3 persons who acted in the most movies with a tagline containing 'journey'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'journey'
WITH p, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN p.name","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $tag;
  $tag like "".*journey.*"";
reduce $movieCount = count($m) groupby $n;
sort $movieCount desc;
limit 3;
fetch {
  ""name"": $n
};"
movies,500,List the 3 movies with the highest number of distinct reviewers.,"MATCH (m:Movie)<-[:REVIEWED]-(p:Person)
RETURN m.title AS movie, count(DISTINCT p) AS numReviewers
ORDER BY numReviewers DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
reduce $numReviewers = count($p) groupby $titlem;
sort $numReviewers desc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""numReviewers"": $numReviewers
};"
movies,501,Which 3 persons have the most distinct roles in the ACTED_IN relationship?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(collect(distinct r.roles)) AS num_roles
ORDER BY num_roles DESC
LIMIT 3
RETURN p.name AS person, num_roles","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $num_roles = count($r) groupby $n;
sort $num_roles desc;
limit 3;
fetch {
  ""person"": $n,
  ""num_roles"": $num_roles
};"
movies,502,What are the 3 most common summaries in the REVIEWED relationship?,"MATCH (:Person)-[r:REVIEWED]->(:Movie)
RETURN r.summary, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $p isa person;
  $m isa movie;
reduce $count = count($r) groupby $summaryr;
sort $count desc;
limit 3;
fetch {
  ""summary"": $summaryr,
  ""count"": $count
};"
movies,504,List 3 directors who have never reviewed a movie.,"MATCH (d:Person)
WHERE (d)-[:DIRECTED]->(:Movie)
  AND NOT EXISTS {
    (d)-[:REVIEWED]->(:Movie)
  }
RETURN d.name AS director
LIMIT 3","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  not { (reviewer: $d, film: $m2) isa reviewed; };
limit 3;
fetch {
  ""director"": $n
};"
movies,505,Which 3 movies have been directed by persons born in the 1960s?,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person)
WHERE p.born >= 1960 AND p.born < 1970
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp >= 1960;
  $bornp < 1970;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,506,Who are the 3 persons with the most directed movies that have a tagline?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(m) AS directedCount
RETURN p.name, directedCount
ORDER BY directedCount DESC
LIMIT 3","match
  $p isa person, has name $n;
  (director: $p, film: $m) isa directed;
  $m has tagline $tag;
reduce $directedCount = count($m) groupby $n;
sort $directedCount desc;
limit 3;
fetch {
  ""name"": $n,
  ""directedCount"": $directedCount
};"
movies,507,Find 3 actors who have acted in movies with a tagline mentioning 'freedom'.,"MATCH (a:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'freedom'
RETURN a.name AS actor
LIMIT 3","match
  $a isa person;
  $m isa movie;
  (actor: $a, film: $m) isa acted_in;
  $m has tagline $taglinem;
  $taglinem contains ""freedom"";
  $a has name $namea;
limit 3;
fetch {
  ""actor"": $namea
};"
movies,508,List the 3 movies with the highest average review ratings.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN m.title AS movie, avgRating","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avgRating = mean($r) groupby $t;
sort $avgRating desc;
limit 3;
fetch {
  ""movie"": $t,
  ""avgRating"": $avgRating
};"
movies,510,Name 3 movies that have been reviewed with a summary containing 'romp'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'romp'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""romp"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,511,List the 3 movies with the lowest average ratings in the REVIEWED relationship.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WITH m, avg(r.rating) AS avgRating
RETURN m.title AS movie, avgRating
ORDER BY avgRating
LIMIT 3","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avgRating = mean($r) groupby $t;
sort $avgRating asc;
limit 3;
fetch {
  ""movie"": $t,
  ""avgRating"": $avgRating
};"
movies,512,Who are the 3 directors with the fewest produced movies?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS num_directed
ORDER BY num_directed
LIMIT 3
RETURN d.name AS director, num_directed AS movies_produced","match
  $d isa person;
  $m isa movie;
  (director: $d, film: $m) isa directed;
  $d has name $named;
reduce $num_directed = count($m) groupby $named;
sort $num_directed asc;
limit 3;
fetch {
  ""director"": $named,
  ""movies_produced"": $num_directed
};"
movies,513,What are the top 3 movies with the most distinct actors in the ACTED_IN relationship?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
RETURN m.title AS movie, count(DISTINCT p) AS numActors
ORDER BY numActors DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
reduce $numActors = count($p) groupby $titlem;
sort $numActors desc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""numActors"": $numActors
};"
movies,516,Which 3 persons follow the most directors?,"MATCH (p:Person)-[:FOLLOWS]->(d:Person)
WHERE EXISTS {(d)-[:DIRECTED]->(:Movie)}
WITH p, count(d) AS num_directors
ORDER BY num_directors DESC
LIMIT 3
RETURN p.name AS person, num_directors","match
  $p isa person, has name $n;
  (follower: $p, followed: $d) isa follows;
  (director: $d, film: $m) isa directed;
reduce $num_directors = count($d) groupby $n;
sort $num_directors desc;
limit 3;
fetch {
  ""person"": $n,
  ""num_directors"": $num_directors
};"
movies,517,What are the 3 newest relationships formed in the graph (any type)?,"MATCH ()-[r]-()
RETURN r, type(r)
ORDER BY id(r) DESC
LIMIT 3","match
  (actor: $p, film: $m) isa acted_in;
  $p has name $n;
  $m has title $t;
limit 3;
fetch {
  ""actor"": $n,
  ""movie"": $t
};"
movies,519,Find 3 movies that were both directed and reviewed by the same person.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN m.title, p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
  $p has name $namep;
limit 3;
fetch {
  ""title"": $titlem,
  ""name"": $namep
};"
movies,520,List 3 actors who have acted in movies with a tagline containing 'beginning'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'beginning'
RETURN p.name AS actor
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $taglinem;
  $taglinem contains ""beginning"";
  $p has name $namep;
limit 3;
fetch {
  ""actor"": $namep
};"
movies,521,Who are the 3 persons with the highest total ratings for movies they reviewed?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, sum(r.rating) AS totalRating
ORDER BY totalRating DESC
LIMIT 3
RETURN p.name AS reviewer, totalRating","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $totalRating = sum($r) groupby $n;
sort $totalRating desc;
limit 3;
fetch {
  ""reviewer"": $n,
  ""totalRating"": $totalRating
};"
movies,522,What are the top 3 movies with the most distinct taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY m.tagline
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $m has title $titlem;
sort $taglinem asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,524,List 3 movies that have been followed by the most persons.,"MATCH (m:Movie)<-[:REVIEWED]-(p:Person)
RETURN m.title AS movie, count(p) AS followers
ORDER BY followers DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
reduce $reviewers = count($p) groupby $titlem;
sort $reviewers desc;
limit 3;
fetch {
  ""movie"": $titlem,
  ""reviewers"": $reviewers
};"
movies,525,Which 3 directors have directed movies with the most distinct taglines?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH d, count(DISTINCT m.tagline) AS num_taglines
RETURN d.name AS director, num_taglines
ORDER BY num_taglines DESC
LIMIT 3","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has tagline $tag;
reduce $num_taglines = count($tag) groupby $n;
sort $num_taglines desc;
limit 3;
fetch {
  ""director"": $n,
  ""num_taglines"": $num_taglines
};"
movies,526,Find the 3 oldest movies reviewed by someone born after 1970.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1970
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has born $bornp;
  $bornp > 1970;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,528,Name 3 persons who have acted in movies with the most distinct titles.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
RETURN p.name, count(distinct m.title) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has title $t;
reduce $num_movies = count($t) groupby $n;
sort $num_movies desc;
limit 3;
fetch {
  ""name"": $n,
  ""num_movies"": $num_movies
};"
movies,529,What are the top 3 reviewed movies with summaries mentioning 'fun'?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'fun'
RETURN m.title, count(r) AS reviews
ORDER BY reviews DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""fun"";
  $m has title $titlem;
reduce $reviews = count($r) groupby $titlem;
sort $reviews desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""reviews"": $reviews
};"
movies,530,Who are the 3 persons with the most PRODUCED relationships?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name, count(m) AS produced_count
ORDER BY produced_count DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $produced_count = count($m) groupby $namep;
sort $produced_count desc;
limit 3;
fetch {
  ""name"": $namep,
  ""produced_count"": $produced_count
};"
movies,532,Which 3 persons have the most diverse roles across movies they acted in?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(collect(distinct r.roles)) AS num_roles
ORDER BY num_roles DESC
LIMIT 3
RETURN p.name AS person, num_roles AS number_of_distinct_roles","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $num_roles = count($r) groupby $n;
sort $num_roles desc;
limit 3;
fetch {
  ""person"": $n,
  ""number_of_distinct_roles"": $num_roles
};"
movies,533,What are the 3 most common taglines found in the movies?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.tagline, count(*) AS tagline_count
ORDER BY tagline_count DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
reduce $tagline_count = count($m) groupby $taglinem;
sort $tagline_count desc;
limit 3;
fetch {
  ""tagline"": $taglinem,
  ""tagline_count"": $tagline_count
};"
movies,535,List the first 3 movies to have been reviewed with a summary containing 'slapstick'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'slapstick'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""slapstick"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,536,Who are the top 3 producers by the number of movies with different taglines?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(DISTINCT m.tagline) AS num_taglines
RETURN p.name AS producer, num_taglines
ORDER BY num_taglines DESC
LIMIT 3","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  $m has tagline $tag;
reduce $num_taglines = count($tag) groupby $n;
sort $num_taglines desc;
limit 3;
fetch {
  ""producer"": $n,
  ""num_taglines"": $num_taglines
};"
movies,537,What are the 3 oldest movies produced by someone born after 1960?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born > 1960
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp > 1960;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,538,Name 3 persons who have reviewed the most movies released before 2000.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE m.released < 2000
WITH p, count(r) AS numReviews
ORDER BY numReviews DESC
LIMIT 3
RETURN p.name AS reviewer","match
  $p isa person, has name $n;
  (reviewer: $p, film: $m) isa reviewed;
  $m has released $r;
  $r < 2000;
reduce $numReviews = count($m) groupby $n;
sort $numReviews desc;
limit 3;
fetch {
  ""reviewer"": $n
};"
movies,539,Which movies has Keanu Reeves acted in?,"MATCH (p:Person {name: 'Keanu Reeves'})-[:ACTED_IN]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,540,List the directors of the movie 'The Matrix'.,"MATCH (m:Movie {title: 'The Matrix'})<-[:DIRECTED]-(d:Person)
RETURN d.name AS director","match
  $m isa movie, has title ""The Matrix"";
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has name $named;
fetch {
  ""director"": $named
};"
movies,541,Find the top 5 movies with the most votes.,"MATCH (m:Movie)
WHERE m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,542,Which actors were born after 1970 and acted in movies released before 2000?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 2000
RETURN p.name AS actor, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp > 1970;
  $m has released $releasedm;
  $releasedm < 2000;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""actor"": $namep,
  ""movie"": $titlem
};"
movies,543,What are the roles of Laurence Fishburne in 'The Matrix Revolutions'?,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix Revolutions'})
RETURN r.roles","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie, has title ""The Matrix Revolutions"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
fetch {
  ""roles"": $rolesr
};"
movies,544,List all movies produced by Joel Silver.,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,545,Which movie has the tagline 'Welcome to the Real World'?,"MATCH (m:Movie)
WHERE m.tagline = 'Welcome to the Real World'
RETURN m.title","match
  $m isa movie;
  $m has tagline ""Welcome to the Real World"";
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,547,List all reviewers of 'Speed Racer' and the ratings they gave.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS reviewer, r.rating AS rating","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""rating"": $ratingr
};"
movies,548,What is the highest rating given to any movie by any person?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
RETURN max(r.rating) AS highest_rating","match
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $highest_rating = max($r);
fetch {
  ""highest_rating"": $highest_rating
};"
movies,549,"Which movies have been reviewed with a summary 'Dark, but compelling'?","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Dark, but compelling"";

fetch {
  ""title"": $title
};"
movies,550,Find the top 5 movies with the least votes.,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,551,What are the top 3 oldest persons in the graph?,"MATCH (p:Person)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,553,Who are the top 3 followers of Keanu Reeves?,"MATCH (keanu:Person {name: 'Keanu Reeves'})<-[f:FOLLOWS]-(follower:Person)
RETURN follower.name
ORDER BY follower.born DESC
LIMIT 3","match
  $keanu isa person, has name ""Keanu Reeves"";
  $follower isa person;
  $f isa follows (follower: $follower, followed: $keanu);
  $follower has name $namefollower;
  $follower has born $bornfollower;
sort $bornfollower desc;
limit 3;
fetch {
  ""name"": $namefollower
};"
movies,554,What are the first 3 movies released after 2000 that Laurence Fishburne acted in?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person {name: 'Laurence Fishburne'})
WHERE m.released > 2000
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $p isa person, has name ""Laurence Fishburne"";
  (actor: $p, film: $m) isa acted_in;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,555,Which persons have only directed movies and never acted in any?,"MATCH (p:Person)
WHERE EXISTS {(p)-[:DIRECTED]->(:Movie)}
  AND NOT EXISTS {(p)-[:ACTED_IN]->(:Movie)}
RETURN p.name","match
  $p isa person, has name $n;
  (director: $p, film: $m) isa directed;
  not { (actor: $p, film: $m2) isa acted_in; };
fetch {
  ""name"": $n
};"
movies,558,Which movies released between 1990 and 2000 have been reviewed?,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
AND exists{ (m)<-[:REVIEWED]-() }
RETURN m","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm <= 2000;
  (reviewer: $r, film: $m) isa reviewed;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,559,List the top 5 most recent movies in the graph.,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has released $releasedm;
sort $releasedm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,560,Who reviewed 'The Matrix' and what summary did they provide?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS reviewer, r.summary AS review","match
  $p isa person;
  $m isa movie, has title ""The Matrix"";
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $p has name $namep;
fetch {
  ""reviewer"": $namep,
  ""review"": $summaryr
};"
movies,561,What are the combined total votes of all movies Joel Silver produced?,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN sum(m.votes) AS totalVotes","match
  $p isa person, has name ""Joel Silver"";
  (producer: $p, film: $m) isa produced;
  $m has votes $v;
reduce $totalVotes = sum($v);
fetch {
  ""totalVotes"": $totalVotes
};"
movies,562,"Find persons who have acted in, directed, and produced different movies.","MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) } 
  AND exists{ (p)-[:DIRECTED]->(:Movie) }
  AND exists{ (p)-[:PRODUCED]->(:Movie) }
RETURN p.name AS person","match
  $p isa person;
  (actor: $p) isa acted_in;
  (director: $p) isa directed;
  (producer: $p) isa produced;
  $p has name $namep;
fetch {
  ""person"": $namep
};"
movies,564,Who has reviewed the most number of movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 1
RETURN p.name AS reviewer, num_reviews","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
reduce $num_reviews = count($r) groupby $namep;
sort $num_reviews desc;
limit 1;
fetch {
  ""reviewer"": $namep,
  ""num_reviews"": $num_reviews
};"
movies,565,What are the first 3 movies with a rating greater than 85?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 85
RETURN m.title
ORDER BY r.rating DESC
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 85;
  $m has title $titlem;
sort $ratingr desc;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,566,Which persons born in the 1960s have directed movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN p.name AS director, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp >= 1960;
  $bornp < 1970;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""director"": $namep,
  ""movie"": $titlem
};"
movies,567,List all movies with a tagline that includes the word 'Real'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'Real'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""Real"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,568,How many different persons have reviewed 'Speed Racer'?,"MATCH (m:Movie {title: 'Speed Racer'})
MATCH (p:Person)-[:REVIEWED]->(m)
RETURN count(DISTINCT p) AS num_reviewers","match
  $m isa movie, has title ""Speed Racer"";
  (reviewer: $p, film: $m) isa reviewed;
reduce $num_reviewers = count($p);
fetch {
  ""num_reviewers"": $num_reviewers
};"
movies,569,What are the roles of Keanu Reeves in movies released in the 1990s?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $m has title $titlem;
fetch {
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,570,List the first 3 people born before 1950 who acted in movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < 1950
RETURN p.name, p.born
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp < 1950;
  $p has name $namep;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,571,Which movies have been acted in by persons born after 1970?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE p.born > 1970
RETURN m.title","match
  $m isa movie;
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp > 1970;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,572,How many movies has Lana Wachowski directed?,"MATCH (p:Person {name: 'Lana Wachowski'})-[:DIRECTED]->(m:Movie)
RETURN count(m) AS num_movies_directed","match
  $p isa person, has name ""Lana Wachowski"";
  (director: $p, film: $m) isa directed;
reduce $num_movies_directed = count($m);
fetch {
  ""num_movies_directed"": $num_movies_directed
};"
movies,573,What are the first 3 movies with a vote count less than 100?,"MATCH (m:Movie)
WHERE m.votes < 100
RETURN m.title
ORDER BY m.votes
LIMIT 3","match
  $m isa movie;
  $m has votes $votesm;
  $votesm < 100;
  $m has title $titlem;
sort $votesm asc;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,574,List the top 5 movies by release year in the 1980s.,"MATCH (m:Movie)
WHERE m.released >= 1980 AND m.released < 1990
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1980;
  $releasedm < 1990;
  $m has title $titlem;
sort $releasedm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,575,Which persons have the name 'Joel' and have produced a movie with more than 100 votes?,"MATCH (p:Person {name: 'Joel'})-[:PRODUCED]->(m:Movie)
WHERE m.votes > 100
RETURN p, m","match
  $p isa person, has name ""Joel"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has votes $votesm;
  $votesm > 100;
  $p has name $namep;
  $p has born $bornp;
  $m has title $titlem;
  $m has tagline $taglinem;
  $m has released $releasedm;
fetch {
  ""name"": $namep,
  ""born"": $bornp,
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,577,Which persons have reviewed movies with a rating of 100?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating = 100
RETURN p.name AS reviewer, m.title AS movie","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has rating 100;
  $m has title $t;
fetch {
  ""reviewer"": $n,
  ""movie"": $t
};"
movies,578,List the roles of Laurence Fishburne in movies with a release year after 2000.,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie)
WHERE m.released > 2000
RETURN m.title, r.roles","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""roles"": $rolesr
};"
movies,579,Who are the top 5 followers of Lana Wachowski?,"MATCH (p:Person)-[:FOLLOWS]->(lana:Person {name: 'Lana Wachowski'})
RETURN p.name AS follower
ORDER BY p.born DESC
LIMIT 5","match
  $p isa person;
  $lana isa person, has name ""Lana Wachowski"";
  (follower: $p, followed: $lana) isa follows;
  $p has name $namep;
  $p has born $bornp;
sort $bornp desc;
limit 5;
fetch {
  ""follower"": $namep
};"
movies,582,List the roles of Keanu Reeves in 'The Matrix'.,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN r.roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title ""The Matrix"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
fetch {
  ""roles"": $rolesr
};"
movies,583,Who has produced the most movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
RETURN p.name AS producer, count(m) AS num_movies_produced
ORDER BY num_movies_produced DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $num_movies_produced = count($m) groupby $namep;
sort $num_movies_produced desc;
limit 1;
fetch {
  ""producer"": $namep,
  ""num_movies_produced"": $num_movies_produced
};"
movies,585,Who are the top 3 producers of movies released before 1990?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released < 1990
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN p.name AS producer, num_movies","match
  $p isa person, has name $n;
  (producer: $p, film: $m) isa produced;
  $m has released $r;
  $r < 1990;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 3;
fetch {
  ""producer"": $n,
  ""num_movies"": $num_movies
};"
movies,586,What is the summary of the lowest-rated review of 'Speed Racer'?,"MATCH (m:Movie {title: 'Speed Racer'})<-[r:REVIEWED]-(p:Person)
RETURN r.summary AS summary
ORDER BY r.rating
LIMIT 1","match
  $m isa movie, has title ""Speed Racer"";
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
sort $ratingr asc;
limit 1;
fetch {
  ""summary"": $summaryr
};"
movies,587,List the top 5 movies that have not been reviewed.,"MATCH (m:Movie)
WHERE NOT EXISTS { (m)<-[:REVIEWED]-() }
RETURN m.title
LIMIT 5","match
  $m isa movie;
  not { (reviewer: $r, film: $m) isa reviewed; };
  $m has title $titlem;
limit 5;
fetch {
  ""title"": $titlem
};"
movies,588,"Which persons born after 1980 have acted in, directed, or produced any movies?","MATCH (p:Person)
WHERE p.born > 1980 AND (
  (p)-[:ACTED_IN]->(:Movie) OR
  (p)-[:DIRECTED]->(:Movie) OR
  (p)-[:PRODUCED]->(:Movie)
)
RETURN p","match
  $p isa person;
  $m isa movie;
  $p has born $bornp;
  $bornp > 1980;
  {
    (actor: $p, film: $m) isa acted_in;
  } or {
    (director: $p, film: $m) isa directed;
  } or {
    (producer: $p, film: $m) isa produced;
  };
  $p has name $namep;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,591,Who has directed the most movies with a release after 1995?,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 1995
WITH d, count(m) AS num_movies
RETURN d.name AS director, num_movies
ORDER BY num_movies DESC
LIMIT 1","match
  $d isa person, has name $n;
  (director: $d, film: $m) isa directed;
  $m has released $r;
  $r > 1995;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 1;
fetch {
  ""director"": $n,
  ""num_movies"": $num_movies
};"
movies,592,Which movies have 'Robin Williams' mentioned in the review summary?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'Robin Williams'
RETURN m.title","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""Robin Williams"";
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,593,Find the movies with a tagline containing 'beginning'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'beginning'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""beginning"";
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,595,What are the first 3 movies with a released year divisible by 10 and votes over 500?,"MATCH (m:Movie)
WHERE m.released % 10 = 0 AND m.votes > 500
RETURN m.title
ORDER BY m.released
LIMIT 3","match
  $m isa movie, has title $t, has released $r, has votes $v;
  $r % 10 == 0;
  $v > 500;
sort $r asc;
limit 3;
fetch {
  ""title"": $t
};"
movies,596,Which movies have been produced by persons born before 1960?,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person)
WHERE p.born < 1960
RETURN m.title AS movie, p.name AS producer, p.born AS `birth year`","match
  $m isa movie;
  $p isa person;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp < 1960;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""producer"": $namep,
  ""born"": $bornp
};"
movies,597,List all movies with more than 2000 votes.,"MATCH (m:Movie)
WHERE m.votes > 2000
RETURN m.title, m.votes","match
  $m isa movie;
  $m has votes $votesm;
  $votesm > 2000;
  $m has title $titlem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,598,Who reviewed movies with a summary mentioning 'funny'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary CONTAINS 'funny'
RETURN p.name AS reviewer","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""funny"";
  $p has name $namep;
fetch {
  ""reviewer"": $namep
};"
movies,599,List the top 5 movies with a tagline containing 'football'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'football'
RETURN m.title, m.tagline
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""football"";
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,600,Which persons have reviewed the most movies with a rating over 75?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 75
WITH p, count(r) AS numReviews
ORDER BY numReviews DESC
RETURN p.name AS reviewer, numReviews","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
  $r > 75;
reduce $numReviews = count($m) groupby $n;
sort $numReviews desc;
fetch {
  ""reviewer"": $n,
  ""numReviews"": $numReviews
};"
movies,601,List the roles of any person in movies with a title containing 'Matrix'.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.title CONTAINS 'Matrix'
RETURN p.name AS person, m.title AS movie, r.roles AS roles","match
  $p isa person;
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has title $titlem;
  $titlem contains ""Matrix"";
  $p has name $namep;
fetch {
  ""person"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,602,What is the average rating of movies reviewed by persons born after 1970?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1970
RETURN avg(r.rating) AS average_rating","match
  $p isa person, has born $b;
  $b > 1970;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $average_rating = mean($r);
fetch {
  ""average_rating"": $average_rating
};"
movies,604,Who are the followers of persons who have directed more than 3 movies?,"MATCH (director:Person)-[:DIRECTED]->(movie:Movie)
WITH director, count(movie) AS num_directed_movies
WHERE num_directed_movies > 3
MATCH (follower:Person)-[:FOLLOWS]->(director)
RETURN director.name AS director, follower.name AS follower","match
  $director isa person, has name $dn;
  (director: $director, film: $movie) isa directed;
  (follower: $follower, followed: $director) isa follows;
  $follower has name $fn;
reduce $num_directed_movies = count($movie) groupby $dn, $fn;
match $num_directed_movies > 3;
fetch {
  ""director"": $dn,
  ""follower"": $fn
};"
movies,606,Which movies have been reviewed with a rating exactly at 75?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating = 75
RETURN m.title, r.rating, r.summary","match
  $m isa movie, has title $t;
  $rev isa reviewed (reviewer: $p, film: $m), has rating 75, has summary $s;
fetch {
  ""title"": $t,
  ""rating"": 75,
  ""summary"": $s
};"
movies,607,List the first 3 movies released in the 21st century that Laurence Fishburne produced.,"MATCH (p:Person {name: 'Laurence Fishburne'})-[:PRODUCED]->(m:Movie)
WHERE m.released >= 2000
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
  $p isa person, has name ""Laurence Fishburne"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has released $releasedm;
  $releasedm >= 2000;
  $m has title $titlem;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,608,What are the roles of persons acting in movies with a tagline mentioning 'end'?,"MATCH (p:Person)-[ai:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'end'
RETURN p.name AS person, m.title AS movie, ai.roles AS roles","match
  $p isa person;
  $m isa movie;
  $ai isa acted_in (actor: $p, film: $m), has roles $rolesai;
  $m has tagline $taglinem;
  $taglinem contains ""end"";
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesai
};"
movies,609,"Who has produced, directed, and acted in the most movies?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie),
      (p)-[:DIRECTED]->(m),
      (p)-[:PRODUCED]->(m)
WITH p, count(m) AS movieCount
RETURN p.name AS person, movieCount
ORDER BY movieCount DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  (director: $p, film: $m) isa directed;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $movieCount = count($m) groupby $namep;
sort $movieCount desc;
limit 1;
fetch {
  ""person"": $namep,
  ""movieCount"": $movieCount
};"
movies,610,List all persons who have directed a movie with a released year divisible by 20.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released % 20 = 0
RETURN p.name AS director, m.title AS movie, m.released AS year","match
  $p isa person, has name $n;
  (director: $p, film: $m) isa directed;
  $m has title $t, has released $r;
  $r % 20 == 0;
fetch {
  ""director"": $n,
  ""movie"": $t,
  ""year"": $r
};"
movies,611,Which movies have taglines that include the word 'compelling'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'compelling'
RETURN m.title","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""compelling"";
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,612,List the roles of any person in movies released after 2010.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released > 2010
RETURN p.name AS person, m.title AS movie, r.roles AS roles","match
  $p isa person;
  $m isa movie;
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $m has released $releasedm;
  $releasedm > 2010;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,613,Who has the most directed movies in the database?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
RETURN p.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has name $namep;
reduce $num_movies = count($m) groupby $namep;
sort $num_movies desc;
limit 1;
fetch {
  ""director"": $namep,
  ""num_movies"": $num_movies
};"
movies,614,List movies where the reviewer gave a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN m.title AS movie, r.rating AS rating","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr < 50;
  $m has title $titlem;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,615,Who are the top 3 oldest persons who have reviewed a movie?,"MATCH (p:Person)-[:REVIEWED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $p has born $bornp;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,621,List all movies that have been reviewed with a summary including 'amazing journey'.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary CONTAINS 'amazing journey'
RETURN m.title","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $summaryr contains ""amazing journey"";
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,622,Who are the top 3 persons with the most roles in movies they have acted in?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(r.roles) AS role_count
ORDER BY role_count DESC
LIMIT 3
RETURN p.name AS person, role_count","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $role_count = count($r) groupby $n;
sort $role_count desc;
limit 3;
fetch {
  ""person"": $n,
  ""role_count"": $role_count
};"
movies,623,Which actors were born after 1970?,"MATCH (p:Person)
WHERE p.born > 1970 AND exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name AS actor, p.born AS `year born`","match
  $p isa person;
  (actor: $p) isa acted_in;
  $p has born $bornp;
  $bornp > 1970;
  $p has name $namep;
fetch {
  ""actor"": $namep,
  ""born"": $bornp
};"
movies,624,List top 3 movies released before 1980.,"MATCH (m:Movie)
WHERE m.released < 1980
RETURN m.title, m.released
ORDER BY m.votes DESC
LIMIT 3","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm < 1980;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,625,What are the titles of movies that have more than 1000 votes?,"MATCH (m:Movie)
WHERE m.votes > 1000
RETURN m.title","match
  $m isa movie;
  $m has votes $votesm;
  $votesm > 1000;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,626,Name 3 movies reviewed with a rating over 90.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 90
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr > 90;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,628,Find movies with the tagline 'Welcome to the Real World'.,"MATCH (m:Movie)
WHERE m.tagline = 'Welcome to the Real World'
RETURN m","match
  $m isa movie;
  $m has tagline ""Welcome to the Real World"";
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
  $m has released $releasedm;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,629,Who directed the movie 'The Matrix'?,"MATCH (m:Movie {title: 'The Matrix'})<-[:DIRECTED]-(d:Person)
RETURN d.name AS director","match
  $m isa movie, has title ""The Matrix"";
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has name $named;
fetch {
  ""director"": $named
};"
movies,630,List all the movies produced by Joel Silver.,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,631,What are the roles played by Keanu Reeves in 'The Matrix'?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN p.name AS actor, m.title AS movie, r.roles AS roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title ""The Matrix"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""actor"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesr
};"
movies,632,Top 5 movies by number of votes.,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,633,Who are the actors that have acted in both 'The Matrix' and 'Speed Racer'?,"MATCH (p:Person)-[:ACTED_IN]->(m1:Movie {title: 'The Matrix'}),
      (p)-[:ACTED_IN]->(m2:Movie {title: 'Speed Racer'})
RETURN p.name AS actor","match
  $p isa person;
  $m1 isa movie, has title ""The Matrix"";
  (actor: $p, film: $m1) isa acted_in;
  $m2 isa movie, has title ""Speed Racer"";
  (actor: $p, film: $m2) isa acted_in;
  $p has name $namep;
fetch {
  ""actor"": $namep
};"
movies,634,Show the first 3 people who have reviewed more than one movie.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WITH p, count(m) AS num_reviews
WHERE num_reviews > 1
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
reduce $num_reviews = count($m) groupby $namep;
match $num_reviews > 1;
limit 3;
fetch {
  ""name"": $namep
};"
movies,636,List all persons born before 1950.,"MATCH (p:Person)
WHERE p.born < 1950
RETURN p","match
  $p isa person;
  $p has born $bornp;
  $bornp < 1950;
  $p has name $namep;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,638,Find movies that were released between 1990 and 2000.,"MATCH (m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
RETURN m","match
  $m isa movie;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm <= 2000;
  $m has title $titlem;
  $m has votes $votesm;
  $m has tagline $taglinem;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,639,Who followed the most people born after 1980?,"MATCH (follower:Person)-[:FOLLOWS]->(followed:Person)
WHERE followed.born > 1980
WITH follower, count(followed) AS num_followed
RETURN follower.name AS follower, num_followed
ORDER BY num_followed DESC
LIMIT 1","match
  $follower isa person, has name $n;
  (follower: $follower, followed: $followed) isa follows;
  $followed has born $b;
  $b > 1980;
reduce $num_followed = count($followed) groupby $n;
sort $num_followed desc;
limit 1;
fetch {
  ""follower"": $n,
  ""num_followed"": $num_followed
};"
movies,640,What are the summaries of reviews for 'Speed Racer'?,"MATCH (m:Movie {title: 'Speed Racer'})<-[r:REVIEWED]-(p:Person)
RETURN r.summary AS summary","match
  $m isa movie, has title ""Speed Racer"";
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
fetch {
  ""summary"": $summaryr
};"
movies,641,List top 5 actors by number of movies acted in.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN p.name AS actor, numMovies","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
reduce $numMovies = count($m) groupby $namep;
sort $numMovies desc;
limit 5;
fetch {
  ""actor"": $namep,
  ""numMovies"": $numMovies
};"
movies,642,Who wrote and acted in the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,643,What is the average rating of movies reviewed by people born before 1970?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born < 1970
RETURN avg(r.rating) AS averageRating","match
  $p isa person, has born $b;
  $b < 1970;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $averageRating = mean($r);
fetch {
  ""averageRating"": $averageRating
};"
movies,644,Which movies have a vote count less than 50?,"MATCH (m:Movie)
WHERE m.votes < 50
RETURN m.title","match
  $m isa movie;
  $m has votes $votesm;
  $votesm < 50;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,645,List the people who have produced more than three movies.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS num_movies_produced
WHERE num_movies_produced > 3
RETURN p.name AS producer, num_movies_produced","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $num_movies_produced = count($m) groupby $namep;
match $num_movies_produced > 3;
fetch {
  ""producer"": $namep,
  ""num_movies_produced"": $num_movies_produced
};"
movies,646,What are the distinct roles played by Laurence Fishburne across all movies?,"MATCH (p:Person {name: 'Laurence Fishburne'})-[r:ACTED_IN]->(m:Movie)
UNWIND r.roles AS role
RETURN DISTINCT role","match
  $p isa person, has name ""Laurence Fishburne"";
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
fetch {
  ""role"": $r
};"
movies,649,What are the movies directed by Lana Wachowski?,"MATCH (p:Person {name: 'Lana Wachowski'})-[:DIRECTED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Lana Wachowski"";
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,650,List the actors born after 1980 who have acted in more than one movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1980
WITH p, count(m) AS numMovies
WHERE numMovies > 1
RETURN p.name AS actor, numMovies","match
  $p isa person, has name $n, has born $b;
  $b > 1980;
  (actor: $p, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
match $numMovies > 1;
fetch {
  ""actor"": $n,
  ""numMovies"": $numMovies
};"
movies,651,Which person has reviewed the most movies?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, count(r) AS num_reviews
ORDER BY num_reviews DESC
LIMIT 1
RETURN p.name AS person, num_reviews","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m);
  $p has name $namep;
reduce $num_reviews = count($r) groupby $namep;
sort $num_reviews desc;
limit 1;
fetch {
  ""person"": $namep,
  ""num_reviews"": $num_reviews
};"
movies,652,Name 3 movies with the lowest ratings in reviews.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
RETURN m.title, r.rating
ORDER BY r.rating
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has title $titlem;
sort $ratingr asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr
};"
movies,653,What is the average number of votes for movies released in the 2000s?,"MATCH (m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
RETURN avg(m.votes) AS average_votes","match
  $m isa movie, has released $r, has votes $v;
  $r >= 2000;
  $r < 2010;
reduce $average_votes = mean($v);
fetch {
  ""average_votes"": $average_votes
};"
movies,656,Name the people who have directed more than two movies.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WITH p, count(m) AS num_directed
WHERE num_directed > 2
RETURN p.name AS director","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has name $namep;
reduce $num_directed = count($m) groupby $namep;
match $num_directed > 2;
fetch {
  ""director"": $namep
};"
movies,658,"Which movies have been reviewed with a summary stating 'Dark, but compelling'?","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Dark, but compelling"";

fetch {
  ""title"": $title
};"
movies,660,Who are the top 3 actors in terms of the diversity of roles played?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(collect(distinct r.roles)) AS num_roles
ORDER BY num_roles DESC
LIMIT 3
RETURN p.name AS actor, num_roles AS number_of_distinct_roles","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $num_roles = count($r) groupby $n;
sort $num_roles desc;
limit 3;
fetch {
  ""actor"": $n,
  ""number_of_distinct_roles"": $num_roles
};"
movies,661,Find the people who have followed someone with the same birth year.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.born = p2.born
RETURN p1, p2","match
  $p1 isa person, has name $n1, has born $b;
  $p2 isa person, has name $n2, has born $b;
  (follower: $p1, followed: $p2) isa follows;
fetch {
  ""follower"": $n1,
  ""followed"": $n2,
  ""born"": $b
};"
movies,662,What are the movies released in 1999?,"MATCH (m:Movie)
WHERE m.released = 1999
RETURN m.title","match
  $m isa movie;
  $m has released 1999;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,663,Name the people who have produced movies with less than 100 votes.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.votes < 100
RETURN p.name","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has votes $votesm;
  $votesm < 100;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,664,What is the average release year of movies reviewed with a rating above 80?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 80
RETURN avg(m.released) AS average_release_year","match
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
  $r > 80;
  $m has released $rel;
reduce $average_release_year = mean($rel);
fetch {
  ""average_release_year"": $average_release_year
};"
movies,665,List the movies that have been followed by someone born in 1990.,"MATCH (p:Person)-[:FOLLOWS]->(follower:Person)-[:REVIEWED]->(m:Movie)
WHERE p.born = 1990
RETURN m.title","match
  $p isa person, has born 1990;
  $follower isa person;
  (follower: $p, followed: $follower) isa follows;
  $m isa movie;
  (reviewer: $follower, film: $m) isa reviewed;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,666,Who has acted in the highest number of unique movies?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 1
RETURN p.name AS name, numMovies","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
reduce $numMovies = count($m) groupby $namep;
sort $numMovies desc;
limit 1;
fetch {
  ""name"": $namep,
  ""numMovies"": $numMovies
};"
movies,667,What are the first 3 movies with the most roles listed?,"MATCH (m:Movie)<-[r:ACTED_IN]-()
RETURN m.title, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 3","match
  $m isa movie, has title $t;
  (actor: $p, film: $m) isa acted_in;
reduce $num_roles = count($p) groupby $t;
sort $num_roles desc;
limit 3;
fetch {
  ""movie"": $t,
  ""num_roles"": $num_roles
};"
movies,668,List the people born in the 1960s who have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
WHERE p.born >= 1960 AND p.born < 1970
RETURN p.name AS director, p.born AS birthYear","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp >= 1960;
  $bornp < 1970;
  $p has name $namep;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp
};"
movies,669,Name the top 5 movies with the most diverse cast in terms of roles.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WITH m, size(collect(distinct ai.roles)) AS role_diversity
RETURN m.title AS movie, role_diversity
ORDER BY role_diversity DESC
LIMIT 5","match
  $m isa movie, has title $t;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $role_diversity = count($r) groupby $t;
sort $role_diversity desc;
limit 5;
fetch {
  ""movie"": $t,
  ""role_diversity"": $role_diversity
};"
movies,670,What are the roles of actors in 'Speed Racer'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'Speed Racer'})
RETURN p.name AS actor, r.roles AS roles","match
  $p isa person;
  $m isa movie, has title ""Speed Racer"";
  $r isa acted_in (actor: $p, film: $m), has roles $rolesr;
  $p has name $namep;
fetch {
  ""actor"": $namep,
  ""roles"": $rolesr
};"
movies,671,List the movies where Joel Silver has a production role.,"MATCH (p:Person {name: 'Joel Silver'})-[:PRODUCED]->(m:Movie)
RETURN m.title","match
  $p isa person, has name ""Joel Silver"";
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
fetch {
  ""title"": $titlem
};"
movies,672,Who are the top 3 reviewers by average rating given?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3
RETURN p.name AS reviewer, avg_rating","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avg_rating = mean($r) groupby $n;
sort $avg_rating desc;
limit 3;
fetch {
  ""reviewer"": $n,
  ""avg_rating"": $avg_rating
};"
movies,674,List the first 3 persons who were born after 1950 and have directed a movie.,"MATCH (p:Person)
WHERE p.born > 1950 AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match
  $p isa person;
  (director: $p) isa directed;
  $p has born $bornp;
  $bornp > 1950;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,675,What are the top 5 movies with ratings between 70 and 85?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating >= 70 AND r.rating <= 85
RETURN m.title AS movie, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr >= 70;
  $ratingr <= 85;
  $m has title $titlem;
sort $ratingr desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,676,Which movies have more than 3 actors listed?,"MATCH (m:Movie)
WHERE size([(p)-[:ACTED_IN]->(m) | p]) > 3
RETURN m.title","match
  $m isa movie, has title $t;
  (actor: $p1, film: $m) isa acted_in;
  (actor: $p2, film: $m) isa acted_in;
  (actor: $p3, film: $m) isa acted_in;
  (actor: $p4, film: $m) isa acted_in;
  not { $p1 is $p2; };
  not { $p1 is $p3; };
  not { $p1 is $p4; };
  not { $p2 is $p3; };
  not { $p2 is $p4; };
  not { $p3 is $p4; };
fetch {
  ""title"": $t
};"
movies,677,Name the people who have followed more than 5 persons.,"MATCH (p:Person)-[:FOLLOWS]->(followed:Person)
WITH p, count(followed) AS num_followed
WHERE num_followed > 5
RETURN p.name AS person","match
  $p isa person;
  $followed isa person;
  (follower: $p, followed: $followed) isa follows;
  $p has name $namep;
reduce $num_followed = count($followed) groupby $namep;
match $num_followed > 5;
fetch {
  ""person"": $namep
};"
movies,678,List the movies directed by people born before 1970.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born < 1970
RETURN m.title AS movie","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $p has born $bornp;
  $bornp < 1970;
  $m has title $titlem;
fetch {
  ""movie"": $titlem
};"
movies,679,Who are the top 3 producers by number of movies produced?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN p.name AS producer, num_movies","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
reduce $num_movies = count($m) groupby $namep;
sort $num_movies desc;
limit 3;
fetch {
  ""producer"": $namep,
  ""num_movies"": $num_movies
};"
movies,680,"Name the first 3 movies reviewed with a summary 'Fun, but a little far fetched'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Fun, but a little far fetched'
RETURN m.title
LIMIT 3","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Fun, but a little far fetched"";
limit 3;
fetch {
  ""title"": $title
};"
movies,681,Which movies have been acted in by persons born after 1980?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE p.born > 1980
RETURN m.title AS movie, p.name AS actor, p.born AS actorBorn","match
  $m isa movie;
  $p isa person;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp > 1980;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""actor"": $namep,
  ""actorBorn"": $bornp
};"
movies,682,List the people who have written and reviewed the same movie.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,683,Who are the first 3 actors by the number of different movies acted in?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN p.name AS actor, numMovies","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
reduce $numMovies = count($m) groupby $namep;
sort $numMovies desc;
limit 3;
fetch {
  ""actor"": $namep,
  ""numMovies"": $numMovies
};"
movies,684,What are the distinct summaries of reviews for movies released after 2000?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE m.released > 2000
RETURN DISTINCT r.summary","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has summary $summaryr;
  $m has released $releasedm;
  $releasedm > 2000;
fetch {
  ""summary"": $summaryr
};"
movies,685,List the first 3 movies with a tagline containing the word 'journey'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""journey"";
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,686,Who has the most production credits in movies released in the 1990s?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
RETURN p.name AS producer, count(m) AS num_movies_produced
ORDER BY num_movies_produced DESC
LIMIT 1","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $p has name $namep;
reduce $num_movies_produced = count($m) groupby $namep;
sort $num_movies_produced desc;
limit 1;
fetch {
  ""producer"": $namep,
  ""num_movies_produced"": $num_movies_produced
};"
movies,688,What are the top 5 movies with the least votes?,"MATCH (m:Movie)
RETURN m.title, m.votes
ORDER BY m.votes
LIMIT 5","match
  $m isa movie;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm asc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,689,Which movies have been directed by someone who has also acted in them?,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person)-[:ACTED_IN]->(m)
RETURN m.title AS movie, p.name AS person","match
  $m isa movie;
  $p isa person;
  (director: $p, film: $m) isa directed;
  (actor: $p, film: $m) isa acted_in;
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""person"": $namep
};"
movies,690,List the actors who have roles in movies released after 2000.,"MATCH (p:Person)-[ai:ACTED_IN]->(m:Movie)
WHERE m.released > 2000
RETURN p.name AS actor, m.title AS movie, ai.roles AS roles","match
  $p isa person;
  $m isa movie;
  $ai isa acted_in (actor: $p, film: $m), has roles $rolesai;
  $m has released $releasedm;
  $releasedm > 2000;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""actor"": $namep,
  ""movie"": $titlem,
  ""roles"": $rolesai
};"
movies,693,List the movies produced by a person born in the 1950s.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born >= 1950 AND p.born < 1960
RETURN m.title AS movie","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has born $bornp;
  $bornp >= 1950;
  $bornp < 1960;
  $m has title $titlem;
fetch {
  ""movie"": $titlem
};"
movies,694,"Name the movies that have a review summary 'Silly, but fun'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Silly, but fun'
RETURN m.title","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Silly, but fun"";

fetch {
  ""title"": $title
};"
movies,695,List the first 3 directors born after 1960.,"MATCH (p:Person)
WHERE p.born > 1960
AND EXISTS {
  (p)-[:DIRECTED]->(:Movie)
}
RETURN p.name
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  (director: $p) isa directed;
  $p has born $bornp;
  $bornp > 1960;
  $p has name $namep;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep
};"
movies,696,Who has the highest average review rating?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH p, avg(r.rating) AS avg_rating
RETURN p.name, avg_rating
ORDER BY avg_rating DESC
LIMIT 1","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $r;
reduce $avg_rating = mean($r) groupby $n;
sort $avg_rating desc;
limit 1;
fetch {
  ""name"": $n,
  ""avg_rating"": $avg_rating
};"
movies,697,What are the first 3 movies with the most diverse taglines?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline
ORDER BY m.tagline DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $m has title $titlem;
sort $taglinem desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,698,List the people who have directed and reviewed the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,699,Who are the top 3 actors in terms of movies acted in from 1990 to 2000?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released <= 2000
WITH p, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN p.name AS actor, numMovies","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has released $r;
  $r >= 1990;
  $r <= 2000;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch {
  ""actor"": $n,
  ""numMovies"": $numMovies
};"
movies,700,Name the first 3 movies with a released year divisible by 10.,"MATCH (m:Movie)
WHERE m.released % 10 = 0
RETURN m.title
LIMIT 3","match
  $m isa movie, has title $t, has released $r;
  $r % 10 == 0;
limit 3;
fetch {
  ""title"": $t
};"
movies,701,Who are the first three actors born after 1970 who acted in a movie released before 1990?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born > 1970 AND m.released < 1990
RETURN p.name
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $p has born $bornp;
  $bornp > 1970;
  $m has released $releasedm;
  $releasedm < 1990;
  $p has name $namep;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep
};"
movies,702,What are the top five movies with a vote count greater than 500?,"MATCH (m:Movie)
WHERE m.votes > 500
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $votesm > 500;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,704,Find the first three movies reviewed with a rating above 90.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.rating > 90
RETURN m.title, r.rating, r.summary
LIMIT 3","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr, has summary $summaryr;
  $ratingr > 90;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr,
  ""summary"": $summaryr
};"
movies,705,Who are the top five people born before 1960 who produced more than one movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born < 1960
WITH p, count(m) AS num_movies
WHERE num_movies > 1
RETURN p.name, num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $p isa person, has name $n, has born $b;
  $b < 1960;
  (producer: $p, film: $m) isa produced;
reduce $num_movies = count($m) groupby $n;
match $num_movies > 1;
sort $num_movies desc;
limit 5;
fetch {
  ""name"": $n,
  ""num_movies"": $num_movies
};"
movies,706,Retrieve the top five movies released in the 2000s that were either directed or produced by the same person.,"MATCH (m:Movie)
WHERE m.released >= 2000 AND m.released < 2010
AND EXISTS {
  (p:Person)-[:DIRECTED]->(m)
  WHERE (p)-[:PRODUCED]->(m)
}
RETURN m.title, m.released
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $m has released $releasedm;
  $releasedm >= 2000;
  $releasedm < 2010;
  (director: $p, film: $m) isa directed;
  (producer: $p, film: $m) isa produced;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""released"": $releasedm
};"
movies,707,List the first three people who follow more than three other people.,"MATCH (p:Person)-[:FOLLOWS]->(f:Person)
WITH p, count(f) AS num_follows
WHERE num_follows > 3
RETURN p.name
LIMIT 3","match
  $p isa person;
  $f isa person;
  (follower: $p, followed: $f) isa follows;
  $p has name $namep;
reduce $num_follows = count($f) groupby $namep;
match $num_follows > 3;
limit 3;
fetch {
  ""name"": $namep
};"
movies,708,What are the top five movies that received the highest number of votes and were released after 2000?,"MATCH (m:Movie)
WHERE m.released > 2000 AND m.votes IS NOT NULL
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $m has votes $votesm;
  $m has released $releasedm;
  $releasedm > 2000;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,709,Who are the first three people who wrote a movie and were born in the 1950s?,"MATCH (p:Person)-[:WROTE]->(m:Movie)
WHERE p.born >= 1950 AND p.born < 1960
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  $p has born $bornp;
  $bornp >= 1950;
  $bornp < 1960;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,710,Find the first three movies with a tagline that includes the word 'journey' and were released before the year 2000.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'journey' AND m.released < 2000
RETURN m.title, m.tagline, m.released
ORDER BY m.released
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""journey"";
  $m has released $releasedm;
  $releasedm < 2000;
  $m has title $titlem;
sort $releasedm asc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,712,List the first three actors who acted in a movie released after 2010 and have a born year after 1980.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.released > 2010 AND p.born > 1980
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (actor: $p, film: $m) isa acted_in;
  $m has released $releasedm;
  $releasedm > 2010;
  $p has born $bornp;
  $bornp > 1980;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,713,"Retrieve the first three movies that were reviewed with the summary 'Dark, but compelling'.","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Dark, but compelling'
RETURN m.title
LIMIT 3","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""Dark, but compelling"";
limit 3;
fetch {
  ""title"": $title
};"
movies,715,Find the first three people who produced a movie and have a name starting with 'J'.,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
WHERE p.name STARTS WITH 'J'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
  $namep like ""J%"";
limit 3;
fetch {
  ""name"": $namep
};"
movies,716,What are the top five movies that were directed by someone born before 1960 and have a vote count less than 100?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WHERE d.born < 1960 AND m.votes < 100
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has born $bornd;
  $bornd < 1960;
  $m has votes $votesm;
  $votesm < 100;
  $m has title $titlem;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,718,Retrieve the top five people who have reviewed a movie with a rating less than 50.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.rating < 50
RETURN p.name AS reviewer, m.title AS movie, r.rating AS rating
ORDER BY r.rating ASC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $ratingr < 50;
  $p has name $namep;
  $m has title $titlem;
sort $ratingr asc;
limit 5;
fetch {
  ""reviewer"": $namep,
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,719,Who are the first three people who have directed and reviewed the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (reviewer: $p, film: $m) isa reviewed;
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,720,What are the top five movies where the person who directed the movie was born in the 1940s?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WHERE d.born >= 1940 AND d.born < 1950
RETURN m.title, m.votes
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $d isa person;
  (director: $d, film: $m) isa directed;
  $d has born $bornd;
  $bornd >= 1940;
  $bornd < 1950;
  $m has title $titlem;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""votes"": $votesm
};"
movies,721,"Find the first three movies that have been reviewed with the summary 'Silly, but fun' and were released in the 1990s.","MATCH (m:Movie)<-[:REVIEWED {summary: 'Silly, but fun'}]-()
WHERE m.released >= 1990 AND m.released < 2000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  (reviewer: $r, film: $m) isa reviewed, has summary ""Silly, but fun"";
  $m has released $releasedm;
  $releasedm >= 1990;
  $releasedm < 2000;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,723,Retrieve the top five oldest directors of movies released after 1990.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.released > 1990
RETURN p.name AS director, p.born AS birthYear
ORDER BY p.born
LIMIT 5","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $m has released $releasedm;
  $releasedm > 1990;
  $p has name $namep;
  $p has born $bornp;
sort $bornp asc;
limit 5;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp
};"
movies,724,Who are the first three actors who acted in more than three movies with a tagline containing the word 'limit'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'limit'
WITH p, count(m) AS movieCount
WHERE movieCount > 3
RETURN p.name
ORDER BY movieCount DESC
LIMIT 3","match
  $p isa person, has name $n;
  (actor: $p, film: $m) isa acted_in;
  $m has tagline $tag;
  $tag like "".*limit.*"";
reduce $movieCount = count($m) groupby $n;
match $movieCount > 3;
sort $movieCount desc;
limit 3;
fetch {
  ""name"": $n
};"
movies,725,What are the top five movies that have been both written and reviewed by the same person?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:REVIEWED]-(p)
WITH m, p
ORDER BY m.votes DESC
LIMIT 5
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  (writer: $p, film: $m) isa wrote;
  (reviewer: $p, film: $m) isa reviewed;
  $m has title $titlem;
  $p has name $namep;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""person"": $namep
};"
movies,726,Find the first three movies with a tagline including 'speed' and a vote count over 500.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'speed' AND m.votes > 500
RETURN m.title, m.tagline, m.votes
ORDER BY m.votes DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem contains ""speed"";
  $m has votes $votesm;
  $votesm > 500;
  $m has title $titlem;
sort $votesm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""votes"": $votesm
};"
movies,728,Retrieve the top five movies released before 1985 that were reviewed with a rating above 85.,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE m.released < 1985 AND r.rating > 85
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $r isa reviewed (reviewer: $p, film: $m), has rating $ratingr;
  $m has released $releasedm;
  $releasedm < 1985;
  $ratingr > 85;
  $m has title $titlem;
sort $ratingr desc;
limit 5;
fetch {
  ""title"": $titlem,
  ""rating"": $ratingr
};"
movies,13,List all people who have produced a movie and acted in another.,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name","match
  $p isa person;
  produced (producer: $p, film: $m1);
  acted_in (actor: $p, film: $m2);
  $p has name $name;
fetch {
  ""name"": $name
};"
movies,24,What are the first 3 movies with a tagline containing the word 'limits'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $tagline like "".*limits.*"";
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
movies,26,List all the relationships a person named 'Keanu Reeves' has with movies.,"MATCH (p:Person {name: 'Keanu Reeves'})-[r]->(m:Movie)
RETURN type(r) AS relationship, m.title AS movie","match
  $p isa person, has name ""Keanu Reeves"";
  $rel isa $rel_type ($p, $m);
  $m isa movie, has title $t;
  { $rel_type label acted_in; } or { $rel_type label directed; } or { $rel_type label produced; } or { $rel_type label wrote; } or { $rel_type label reviewed; };
fetch {
  ""relationship"": $rel_type,
  ""movie"": $t
};"
movies,29,List the first 3 people who have directed and written the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:WROTE]-(p)
RETURN p.name AS person
LIMIT 3","match
  $p isa person;
  $m isa movie;
  directed (director: $p, film: $m);
  wrote (writer: $p, film: $m);
  $p has name $namep;
limit 3;
fetch {
  ""person"": $namep
};"
movies,37,"Which person has acted in, directed, and produced the same movie?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WHERE exists{ (p)-[:PRODUCED]->(m) }
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,48,Which people have reviewed and also produced the movie titled 'The Matrix Revolutions'?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie {title: 'The Matrix Revolutions'})<-[:PRODUCED]-(p)
RETURN p.name","match
  $p isa person;
  $m isa movie, has title ""The Matrix Revolutions"";
  (reviewer: $p, film: $m) isa reviewed;
  (producer: $p, film: $m) isa produced;
  $p has name $namep;
fetch {
  ""name"": $namep
};"
movies,49,List the first 3 movies that have been acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
movies,52,List all movies with more than one role listed in the 'ACTED_IN' relationship.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WHERE size(r.roles) > 1
RETURN m.title, r.roles","match
  $m isa movie, has title $t;
  $ai isa acted_in (actor: $p, film: $m), has roles $r1, has roles $r2;
  $r1 != $r2;
fetch {
  ""title"": $t,
  ""roles"": [ $ai.roles ]
};"
movies,58,Which person has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name AS person, m.title AS movie, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has title $t;
reduce $count = count($r) groupby $n, $t;
sort $count desc;
limit 1;"
movies,63,What are the top 5 movies with the most roles listed in their 'ACTED_IN' relationship?,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
RETURN m.title, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 5","match
  $m isa movie, has title $t;
  $a isa acted_in (actor: $p, film: $m);
  $a has roles $r;
reduce $roleCount = count($r) groupby $t;
sort $roleCount desc;
limit 5;
fetch {
  ""movie"": $t,
  ""roleCount"": $roleCount
};"
movies,72,Who are the top 5 oldest directors in the database?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 5","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
  directed (director: $p, film: $m);
sort $bornp asc;
limit 5;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,74,Find the first 3 people who have written and directed the same movie.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  directed (director: $p, film: $m);
  $p has name $name;
  $m has title $title;
limit 3;
fetch {
  ""person"": $name,
  ""movie"": $title
};
"
movies,83,Name the first 5 people who directed a movie with a tagline containing the word 'limits'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name
LIMIT 5","match
  $p isa person;
  $m isa movie, has tagline $t;
  directed (director: $p, film: $m);
  $t like "".*limits.*"";
  $p has name $name;
limit 5;
fetch {
  ""name"": $name
};"
movies,93,"List the first 3 movies reviewed with a summary 'Silly, but fun' and a tagline containing 'world'.","MATCH (m:Movie)<-[:REVIEWED]-(p:Person)
WHERE m.tagline CONTAINS 'world' AND exists{(p)-[:REVIEWED]->(m) WHERE m.summary = 'Silly, but fun'}
RETURN m.title
LIMIT 3","match
  $m isa movie, has tagline $tagline, has title $title;
  $tagline like "".*world.*"";
  $rev isa reviewed (reviewer: $p, film: $m), has summary ""Silly, but fun"";
limit 3;
fetch {
  ""title"": $title
};"
movies,106,Name the top 5 people who followed and were followed by 'Laurence Fishburne'.,"MATCH (p:Person)-[:FOLLOWS]->(laurence:Person {name: 'Laurence Fishburne'})<-[:FOLLOWS]-(p)
RETURN p.name
LIMIT 5","match
  $p isa person;
  $laurence isa person, has name ""Laurence Fishburne"";
  follows (follower: $p, followed: $laurence);
  follows (follower: $laurence, followed: $p);
  $p has name $name;
limit 5;
fetch {
  ""name"": $name
};"
movies,107,What are the first 3 movies where someone born in 1965 directed a person born in 1952?,"MATCH (director:Person {born: 1965})-[:DIRECTED]->(movie:Movie)<-[:ACTED_IN]-(actor:Person {born: 1952})
RETURN movie.title
LIMIT 3","match
  $director isa person, has born 1965;
  $actor isa person, has born 1952;
  $movie isa movie, has title $title;
  directed (director: $director, film: $movie);
  acted_in (actor: $actor, film: $movie);
limit 3;
fetch {
  ""title"": $title
};"
movies,109,Who are the top 3 actors with the most roles in movies released before 1990?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released < 1990
WITH p, count(r) AS numRoles
ORDER BY numRoles DESC
LIMIT 3
RETURN p.name AS actor, numRoles","match
  $p isa person, has name $n;
  $rel isa acted_in (actor: $p, film: $m);
  $m has released $r;
  $r < 1990;
reduce $numRoles = count($rel) groupby $n;
sort $numRoles desc;
limit 3;
fetch {
  ""actor"": $n,
  ""numRoles"": $numRoles
};"
movies,110,List the first 3 people who produced and acted in the same movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  produced (producer: $p, film: $m);
limit 3;
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,112,Which 3 people born after 1970 reviewed a movie with a summary 'An amazing journey'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE p.born > 1970 AND r.summary = 'An amazing journey'
RETURN p.name
LIMIT 3","match
$p isa person, has name $name, has born $b;
$m isa movie;
$r isa reviewed (reviewer: $p, film: $m), has summary ""An amazing journey"";
$b > 1970;
limit 3;
fetch {
  ""name"": $name
};"
movies,116,Who are the first 3 people to review a movie with a summary 'Pretty funny at times'?,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'Pretty funny at times'
RETURN p.name
ORDER BY r.rating DESC
LIMIT 3","match
$p isa person, has name $name;
$m isa movie;
$r isa reviewed (reviewer: $p, film: $m), has summary ""Pretty funny at times"", has rating $rating;
sort $rating desc;
limit 3;
fetch {
  ""name"": $name
};"
movies,118,"Which 3 movies reviewed with a summary 'Dark, but compelling' were produced by someone born before 1960?","MATCH (m:Movie)<-[:REVIEWED {summary: 'Dark, but compelling'}]-()
MATCH (m)<-[:PRODUCED]-(p:Person)
WHERE p.born < 1960
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $r isa reviewed (reviewer: $reviewer, film: $m);
  $r has summary ""Dark, but compelling"";
  $p isa person;
  produced (producer: $p, film: $m);
  $p has born $bornp;
  $bornp < 1960;
  $m has title $titlem;
limit 3;
fetch {
  ""title"": $titlem
};"
movies,121,List the top 5 movies where the director and the main actor were born in the same decade.,"MATCH (actor:Person)-[:ACTED_IN]->(movie:Movie)<-[:DIRECTED]-(director:Person)
WHERE actor.born / 10 = director.born / 10
WITH movie, actor, director
ORDER BY movie.votes DESC
LIMIT 5
RETURN movie.title AS movie, actor.name AS actor, director.name AS director","match
  $actor isa person, has born $actor_born, has name $actor_name;
  $director isa person, has born $director_born, has name $director_name;
  $movie isa movie, has title $movie_title, has votes $votes;
  acted_in (actor: $actor, film: $movie);
  directed (director: $director, film: $movie);
let $actor_decade = $actor_born / 10;
let $director_decade = $director_born / 10;
match $actor_decade == $director_decade;
sort $votes desc;
limit 5;
fetch {
  ""movie"": $movie_title,
  ""actor"": $actor_name,
  ""director"": $director_name
};
"
movies,122,Who are the first 3 actors born after 1980 who acted in a movie produced by someone born before 1950?,"MATCH (a:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p:Person)
WHERE a.born > 1980 AND p.born < 1950
RETURN a.name AS actor, m.title AS movie
ORDER BY a.born
LIMIT 3","match
  $a isa person;
  $m isa movie;
  $p isa person;
  (actor: $a, film: $m) isa acted_in;
  (producer: $p, film: $m) isa produced;
  $a has born $borna;
  $borna > 1980;
  $p has born $bornp;
  $bornp < 1950;
  $a has name $namea;
  $m has title $titlem;
sort $borna asc;
limit 3;
fetch {
  ""actor"": $namea,
  ""movie"": $titlem
};"
movies,124,List the first 5 people who followed someone with the same birth year.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.born = p2.born
RETURN p1.name AS follower, p2.name AS followed
LIMIT 5","match
  $p1 isa person, has born $born;
  $p2 isa person, has born $born;
  follows (follower: $p1, followed: $p2);
limit 5;
fetch {
  ""follower"": $p1.name,
  ""followed"": $p2.name
};"
movies,125,Which 3 people born before 1950 acted in a movie with a tagline containing 'limits'?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < 1950 AND m.tagline CONTAINS 'limits'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  $p has born $bornp;
  $bornp < 1950;
  $m has tagline $tag;
  $tag like "".*limits.*"";
limit 3;
fetch {
  ""name"": $p.name
};"
movies,126,Name the top 5 directors who also reviewed the movies they directed.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(d)
RETURN d.name AS director, count(*) AS num_reviewed
ORDER BY num_reviewed DESC
LIMIT 5","match
  $d isa person;
  $m isa movie;
  directed (director: $d, film: $m);
  reviewed (reviewer: $d, film: $m);
  $d has name $named;
reduce $num_reviewed = count($m) groupby $named;
sort $num_reviewed desc;
limit 5;
fetch {
  ""director"": $named,
  ""num_reviewed"": $num_reviewed
};
"
movies,128,List the top 5 actors who acted in movies reviewed with a summary 'Slapstick redeemed only by the Robin Williams and '.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[r:REVIEWED]-(reviewer:Person)
WHERE r.summary = 'Slapstick redeemed only by the Robin Williams and '
RETURN p.name AS actor, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  $rev isa reviewed (reviewer: $reviewer, film: $m);
  $rev has summary ""Slapstick redeemed only by the Robin Williams and "";
  $p has name $actor_name;
reduce $movie_count = count($m) groupby $actor_name;
sort $movie_count desc;
limit 5;
fetch {
  ""actor"": $actor_name,
  ""movie_count"": $movie_count
};
"
movies,138,Which person has produced the most movies and what are those movies?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, collect(m) AS movies, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 1
RETURN p.name AS producer, [movie IN movies | movie.title] AS producedMovies","match
  $p isa person;
  produced (producer: $p, film: $m);
reduce $count = count($m) groupby $p;
sort $count desc;
limit 1;
match
  produced (producer: $p, film: $movie);
  $movie has title $t;
  $p has name $n;
fetch {
  ""producer"": $n,
  ""title"": $t
};"
movies,142,Which movies have been both written and directed by the same person and what are their titles?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $title;
fetch {
  ""title"": $title
};"
movies,143,How many different people have reviewed movies released before 1990?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE m.released < 1990
RETURN count(distinct p) AS num_reviewers","match
  $p isa person;
  reviewed (reviewer: $p, film: $m);
  $m has released $r;
  $r < 1990;
select $p;
distinct;
reduce $count = count;"
movies,145,Which person has acted in the most movies and what are those movies titles?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, collect(m.title) AS movies, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 1
RETURN p.name AS person, movies","with fun movie_count($p: person) -> integer: match acted_in (actor: $p); return count; match $p isa person; let $count = movie_count($p); sort $count desc; limit 1; match acted_in (actor: $p, film: $m); fetch { ""person"": $p.name, ""movie_title"": $m.title };"
movies,147,Who are the top 5 youngest producers in the database?,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
RETURN p.name AS producer, p.born AS birthYear
ORDER BY p.born DESC
LIMIT 5","match
  $p isa person;
  produced (producer: $p, film: $m);
  $p has born $bornp;
sort $bornp desc;
limit 5;
fetch {
  ""producer"": $p.name,
  ""birthYear"": $bornp
};"
movies,151,Which people follow Keanu Reeves and have also acted in a movie with him?,"MATCH (follower:Person)-[:FOLLOWS]->(keanu:Person {name: 'Keanu Reeves'}),
      (follower)-[:ACTED_IN]->(movie:Movie)<-[:ACTED_IN]-(keanu)
RETURN follower.name AS follower, movie.title AS movie","match
  $follower isa person;
  $keanu isa person, has name ""Keanu Reeves"";
  follows (follower: $follower, followed: $keanu);
  $movie isa movie;
  acted_in (actor: $follower, film: $movie);
  acted_in (actor: $keanu, film: $movie);
fetch {
  ""follower"": $follower.name,
  ""movie"": $movie.title
};"
movies,152,"What are the names of the first 3 people who have produced, directed, and written the same movie?","MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)-[:WROTE]->(m)
RETURN p.name
LIMIT 3","match
  $p isa person, has name $name;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
  wrote (writer: $p, film: $m);
limit 3;
fetch {
  ""name"": $name
};"
movies,157,Which people have reviewed the same movie and what were their review summaries?,"MATCH (p1:Person)-[r1:REVIEWED]->(m:Movie)<-[r2:REVIEWED]-(p2:Person)
WHERE p1 <> p2
RETURN p1.name AS Reviewer1, r1.summary AS Review1, p2.name AS Reviewer2, r2.summary AS Review2, m.title AS Movie","match
  $p1 isa person, has name $name1;
  $p2 isa person, has name $name2;
  $m isa movie, has title $title;
  $r1 isa reviewed (reviewer: $p1, film: $m), has summary $summary1;
  $r2 isa reviewed (reviewer: $p2, film: $m), has summary $summary2;
  not { $name1 == $name2; };
fetch {
  ""Reviewer1"": $name1,
  ""Review1"": $summary1,
  ""Reviewer2"": $name2,
  ""Review2"": $summary2,
  ""Movie"": $title
};"
movies,161,List the top 5 people who have produced the most number of movies with their birth years.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.born IS NOT NULL
RETURN p.name AS producer, p.born AS birthYear, count(m) AS numberOfMovies
ORDER BY numberOfMovies DESC
LIMIT 5","match
  $p isa person, has name $name, has born $birth;
  produced (producer: $p, film: $m);
reduce $numberOfMovies = count($m) groupby $p;
sort $numberOfMovies desc;
limit 5;
fetch {
  ""producer"": $p.name,
  ""birthYear"": $p.born,
  ""numberOfMovies"": $numberOfMovies
};"
movies,162,"Which movies have been reviewed with a summary 'Fun, but a little far fetched' and what were their ratings?","MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'Fun, but a little far fetched'
RETURN m.title AS movie, r.rating AS rating","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary ""Fun, but a little far fetched"", has rating $rating;

fetch {
  ""movie"": $title,
  ""rating"": $rating
};
"
movies,170,What are the top 5 movies with the most actors involved and their release years?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WITH m, count(p) AS actorCount, m.released AS releaseYear
RETURN m.title AS movie, releaseYear, actorCount
ORDER BY actorCount DESC
LIMIT 5","match
  $m isa movie;
  acted_in (actor: $p, film: $m);
reduce $actorCount = count($p) groupby $m;
sort $actorCount desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""releaseYear"": $m.released,
  ""actorCount"": $actorCount
};"
movies,171,List the first 3 movies that have been produced and directed by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
limit 3;
fetch {
  ""title"": $m.title
};
"
movies,172,What are the roles of Keanu Reeves in movies he reviewed with a rating above 90?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:REVIEWED]->(m:Movie)
WHERE r.rating > 90
MATCH (p)-[a:ACTED_IN]->(m)
RETURN m.title AS movie, a.roles AS roles","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title $title;
  $rev isa reviewed (reviewer: $p, film: $m), has rating $rating;
  $rating > 90;
  $act isa acted_in (actor: $p, film: $m), has roles $roles;
fetch {
  ""movie"": $title,
  ""roles"": $roles
};
"
movies,175,List the first 3 movies with roles that include 'Captain' and their actors.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE exists{ (m)<-[ai2:ACTED_IN]-() WHERE any(role IN ai2.roles WHERE role CONTAINS 'Captain') }
RETURN m.title AS movie, collect(p.name) AS actors
LIMIT 3","match
  $m isa movie, has title $title;
  $ai isa acted_in (film: $m), has roles $roles;
  $roles like "".*Captain.*"";
select $m, $title;
distinct;
limit 3;
match
  acted_in (film: $m, actor: $actor);
  $actor has name $actor_name;
fetch {
  ""movie"": $title,
  ""actor"": $actor_name
};"
movies,177,Who are the first 3 people to have reviewed and also produced the same movie?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  reviewed (reviewer: $p, film: $m);
  produced (producer: $p, film: $m);
limit 3;
fetch {
  ""name"": $p.name
};"
movies,178,What is the average age of directors of the top 5 voted movies?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WITH m, d
ORDER BY m.votes DESC
LIMIT 5
RETURN avg(date().year - d.born) AS averageDirectorAge","match
  $m isa movie, has votes $v;
  directed (director: $d, film: $m);
  $d has born $b;
  let $age = 2026 - $b;
sort $v desc;
limit 5;
reduce $avg_age = mean($age);"
movies,179,List the top 3 actors who have acted in movies with a tagline including the word 'limits'.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name AS actor, count(*) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $p isa person, has name $name;
  $m isa movie, has tagline $tag;
  $tag like "".*limits.*"";
  acted_in (actor: $p, film: $m);
reduce $movie_count = count($m) groupby $name;
sort $movie_count desc;
limit 3;
fetch {
  ""actor"": $name,
  ""movie_count"": $movie_count
};
"
movies,180,Which movies have a role listed as 'Hero' and who are the actors?,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE 'Hero' IN ai.roles
RETURN m.title AS movie, p.name AS actor","match
  $m isa movie, has title $titlem;
  $p isa person, has name $namep;
  $ai isa acted_in (actor: $p, film: $m), has roles $rolesai;
  $rolesai == ""Hero"";
fetch {
  ""movie"": $titlem,
  ""actor"": $namep
};"
movies,183,Who are the first 3 youngest actors to have directed a movie?,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name AS name, p.born AS birthYear
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  acted_in (actor: $p, film: $m1);
  directed (director: $p, film: $m2);
  $p has name $namep;
  $p has born $bornp;
sort $bornp desc;
limit 3;
fetch {
  ""name"": $namep,
  ""birthYear"": $bornp
};"
movies,184,What are the first 3 movies where Keanu Reeves and Laurence Fishburne acted together?,"MATCH (keanu:Person {name: 'Keanu Reeves'})-[:ACTED_IN]->(movie)<-[:ACTED_IN]-(laurence:Person {name: 'Laurence Fishburne'})
RETURN movie.title
LIMIT 3","match
  $keanu isa person, has name ""Keanu Reeves"";
  $laurence isa person, has name ""Laurence Fishburne"";
  acted_in (actor: $keanu, film: $movie);
  acted_in (actor: $laurence, film: $movie);
limit 3;
fetch {
  ""title"": $movie.title
};"
movies,186,List the roles of actors in the 3 movies with the highest number of actors involved.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WITH m, collect(p) AS actors
ORDER BY size(actors) DESC
LIMIT 3
UNWIND actors AS actor
MATCH (actor)-[r:ACTED_IN]->(m)
RETURN m.title AS movie, actor.name AS actor, r.roles AS roles","match
  $m isa movie, has title $t;
  acted_in (actor: $actor, film: $m);
reduce $count = count($actor) groupby $m;
sort $count desc;
limit 3;
match
  $ai isa acted_in (actor: $a, film: $m), has roles $roles;
  $a has name $n;
  $m has title $t;
fetch {
  ""movie"": $t,
  ""actor"": $n,
  ""roles"": $roles
};"
movies,189,What are the names of the top 3 oldest actors and the movies they have produced?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WITH p, m
ORDER BY p.born
LIMIT 3
RETURN p.name AS actor, collect(m.title) AS produced_movies","match
  $p isa person, has born $b;
  acted_in (actor: $p);
  produced (producer: $p);
select $p, $b;
distinct;
sort $b asc;
limit 3;
match
  produced (producer: $p, film: $m);
fetch {
  ""actor"": $p.name,
  ""produced_movies"": [ $m.title ]
};"
movies,191,Which movies released before 2000 have a person who both acted and directed in them?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)-[:DIRECTED]->(m)
WHERE m.released < 2000
RETURN m.title AS movie, p.name AS person","match
  $m isa movie, has released $released, has title $title;
  $p isa person, has name $name;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $released < 2000;
fetch {
  ""movie"": $title,
  ""person"": $name
};"
movies,194,List the first 3 movies with at least one role listed as 'Villain' and their actors.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE 'Villain' IN ai.roles
RETURN m.title AS movie, collect(p.name) AS actors
LIMIT 3","match
  $m isa movie, has title $title;
  $ai isa acted_in (actor: $p, film: $m), has roles ""Villain"";
  $p has name $name;
limit 3;
fetch {
  ""movie"": $title,
  ""actors"": $name
};
"
movies,196,Which movies have been reviewed with a summary 'The coolest football movie ever' and who reviewed them?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'The coolest football movie ever'
RETURN m.title AS movie, p.name AS reviewer","match
$m isa movie, has title $title;
$p isa person, has name $name;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary;
$summary == ""The coolest football movie ever"";

fetch {
  ""movie"": $title,
  ""reviewer"": $name
};
"
movies,198,Who are the first 3 people to have written and directed the same movie and what are those movies?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  directed (director: $p, film: $m);
limit 3;
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,199,List the top 5 movies with roles including 'Doctor' and the actors who played them.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE any(role IN p.roles WHERE role CONTAINS 'Doctor')
RETURN m.title AS movie, p.name AS actor
ORDER BY m.votes DESC
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $ai isa acted_in (actor: $p, film: $m);
  $ai has roles $r;
  $r like "".*Doctor.*"";
  $m has title $titlem;
  $p has name $namep;
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""movie"": $titlem,
  ""actor"": $namep
};"
movies,201,What are the first 3 movies where the directors were also actors and their titles?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  directed (director: $p, film: $m);
  acted_in (actor: $p, film: $m);
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
movies,205,List the roles of actors in the first 3 movies produced by a person born after 1980.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[ai:ACTED_IN]-(a:Person)
WHERE p.born > 1980
WITH m, ai
ORDER BY m.released
LIMIT 3
RETURN m.title AS movie, ai.roles AS roles","match
  $p isa person, has born $bornp;
  $bornp > 1980;
  $m isa movie, has released $releasedm;
  produced (producer: $p, film: $m);
  $ai isa acted_in (actor: $a, film: $m), has roles $rolesai;
sort $releasedm asc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""roles"": $rolesai
};"
movies,220,What are the first 3 movies produced by persons born before 1960 with a rating over 90?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[r:REVIEWED]-(reviewer:Person)
WHERE p.born < 1960 AND r.rating > 90
RETURN m.title
ORDER BY m.released
LIMIT 3","match
  $p isa person, has born $born;
  $born < 1960;
  produced (producer: $p, film: $m);
  $rev isa reviewed (film: $m), has rating $rating;
  $rating > 90;
  $m has title $title;
  $m has released $released;
sort $released asc;
limit 3;
fetch {
  ""title"": $title
};"
movies,224,List the first 3 people who have written and directed the same movie released after 2000.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
WHERE m.released > 2000
RETURN p.name, m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has released $released;
  $released > 2000;
limit 3;
fetch {
  ""name"": $p.name,
  ""title"": $m.title
};"
movies,225,Who are the top 3 actors with roles in the most diverse genres (based on taglines)?,"MATCH (a:Person)-[:ACTED_IN]->(m:Movie)
WITH a, count(DISTINCT m.tagline) AS num_genres
ORDER BY num_genres DESC
LIMIT 3
RETURN a.name AS actor, num_genres","match
  $a isa person, has name $n;
  acted_in (actor: $a, film: $m);
  $m has tagline $tag;
select $n, $tag;
distinct;
reduce $num_genres = count groupby $n;
sort $num_genres desc;
limit 3;
fetch {
  ""actor"": $n,
  ""num_genres"": $num_genres
};
"
movies,233,Which movies have a tagline containing the word 'limit'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limit'
RETURN m.title","match
  $m isa movie, has tagline $tagline;
  $tagline like "".*limit.*"";
fetch {
  ""title"": $m.title
};"
movies,244,Which movies have been both acted in and directed by the same person?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
fetch {
  ""movie"": $m.title,
  ""person"": $p.name
};"
movies,245,List the top 5 movies with the most roles listed in ACTED_IN relationship.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
RETURN m.title AS movie, size(r.roles) AS roleCount
ORDER BY roleCount DESC
LIMIT 5","match
  $m isa movie, has title $t;
  $ai isa acted_in (film: $m), has roles $r;
reduce $roleCount = count($r) groupby $t;
sort $roleCount desc;
limit 5;
fetch {
  ""movie"": $t,
  ""roleCount"": $roleCount
};"
movies,248,"Who has produced, directed, and acted in the same movie?","MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
WHERE exists{ (p)-[:ACTED_IN]->(m) }
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  (producer: $p, film: $m) isa produced;
  (director: $p, film: $m) isa directed;
  (actor: $p, film: $m) isa acted_in;
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,251,Who are the top 3 youngest directors in the database?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name AS director, p.born AS birthYear
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  directed (director: $p, film: $m);
  $p has name $namep;
  $p has born $bornp;
select $p, $namep, $bornp;
distinct;
sort $bornp desc;
limit 3;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp
};"
movies,255,Who has acted in movies directed by Lana Wachowski?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Person {name: 'Lana Wachowski'})
RETURN p.name AS actor, m.title AS movie","match
  $p isa person;
  $m isa movie;
  $d isa person, has name ""Lana Wachowski"";
  acted_in (actor: $p, film: $m);
  directed (director: $d, film: $m);
fetch {
  ""actor"": $p.name,
  ""movie"": $m.title
};"
movies,256,List the top 3 oldest actors in the database.,"MATCH (p:Person)
RETURN p.name, p.born
ORDER BY p.born
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
  acted_in (actor: $p, film: $m);
select $p, $namep, $bornp;
distinct;
sort $bornp asc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,260,Who has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name AS person, m.title AS movie, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m isa movie, has title $t;
reduce $count = count($r) groupby $p, $m, $n, $t;
sort $count desc;
limit 1;
fetch {
  ""person"": $n,
  ""movie"": $t,
  ""num_roles"": $count
};
"
movies,261,List all movies where the same person has acted and produced.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  produced (producer: $p, film: $m);
fetch {
  ""movie"": $m.title,
  ""person"": $p.name
};"
movies,263,"List the persons who have written, directed, and produced the same movie.","MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)-[:PRODUCED]->(m)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,265,What are the most common roles played by actors in movies from the 1990s?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.released >= 1990 AND m.released < 2000
UNWIND r.roles AS role
RETURN role, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 10","match
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has released $rel;
  $rel >= 1990;
  $rel < 2000;
reduce $count = count groupby $r;
sort $count desc;
limit 10;
fetch {
  ""role"": $r,
  ""frequency"": $count
};"
movies,268,Which movies have a tagline ending with 'world'?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL AND m.tagline =~ '.*world$'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $tagline like "".*world"";
  $m has title $title;
fetch {
  ""title"": $title,
  ""tagline"": $tagline
};
"
movies,270,Who are the actors in the movie with the highest number of votes?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE m.votes IS NOT NULL
WITH m, p
ORDER BY m.votes DESC
LIMIT 1
RETURN m.title AS movie, collect(p.name) AS actors","with fun max_votes() -> integer:
  match $m isa movie, has votes $v;
  return max($v);
match
  $m isa movie, has votes $v, has title $title;
  let $max = max_votes();
  $v == $max;
  acted_in (actor: $p, film: $m);
  $p has name $name;
fetch {
  ""movie"": $title,
  ""actor"": $name
};"
movies,274,List the top 3 movies reviewed by the youngest reviewers.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WITH m, p, r
ORDER BY p.born DESC
WITH m, collect(r)[0] AS review
RETURN m.title AS movie, review.rating AS rating
ORDER BY rating DESC
LIMIT 3","match
  $m isa movie, has title $title;
  $p isa person, has born $born;
  $r isa reviewed (reviewer: $p, film: $m), has rating $rating;
sort $born desc;
limit 3;
fetch {
  ""movie"": $title,
  ""rating"": $rating
};"
movies,276,What are the common roles for Keanu Reeves across all his movies?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie)
WITH p, collect(r.roles) AS rolesList
UNWIND rolesList AS roles
UNWIND roles AS role
RETURN p.name, role, count(*) AS times_played
ORDER BY times_played DESC","match
  $p isa person, has name ""Keanu Reeves"";
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $count = count($m) groupby $r;
sort $count desc;
fetch {
  ""role"": $r,
  ""times_played"": $count
};"
movies,277,List the top 5 movies with the most diverse cast in terms of birth years.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WITH m, collect(p.born) AS birthYears
RETURN m.title AS movie, size(apoc.coll.toSet(birthYears)) AS numUniqueBirthYears
ORDER BY numUniqueBirthYears DESC
LIMIT 5","match
  $m isa movie, has title $t;
  acted_in (actor: $p, film: $m);
  $p has born $b;
select $b, $m, $t;
distinct;
reduce $numUniqueBirthYears = count groupby $m, $t;
sort $numUniqueBirthYears desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numUniqueBirthYears"": $numUniqueBirthYears
};"
movies,278,Who has reviewed movies directed by Lana Wachowski?,"MATCH (reviewer:Person)-[:REVIEWED]->(movie:Movie)<-[:DIRECTED]-(director:Person {name: 'Lana Wachowski'})
RETURN reviewer.name AS reviewer, movie.title AS movie","match
  $reviewer isa person, has name $reviewer_name;
  $movie isa movie, has title $movie_title;
  $director isa person, has name ""Lana Wachowski"";
  directed (director: $director, film: $movie);
  reviewed (reviewer: $reviewer, film: $movie);
fetch {
  ""reviewer"": $reviewer_name,
  ""movie"": $movie_title
};"
movies,280,Which movies have been produced and directed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title, p.name","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
fetch {
  ""title"": $m.title,
  ""name"": $p.name
};"
movies,305,List 3 actors who also have roles as producers.,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
WHERE exists{ (p)-[:PRODUCED]->(:Movie) }
RETURN p.name AS actor_producer
LIMIT 3","match
  $p isa person;
  acted_in (actor: $p, film: $m1);
  produced (producer: $p, film: $m2);
  $p has name $name;
limit 3;
fetch {
  ""actor_producer"": $name
};"
movies,306,Which movies have a tagline containing the word 'limit'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limit'
RETURN m.title","match
  $m isa movie;
  $m has tagline $tagline;
  $tagline like "".*limit.*"";
fetch {
  ""title"": $m.title
};"
movies,308,List movies that have been both acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
fetch {
  ""movie"": $m.title,
  ""person"": $p.name
};
"
movies,309,Who are the top 3 youngest producers in the database?,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  produced (producer: $p, film: $m);
  $p has name $name;
  $p has born $born;
sort $born desc;
limit 3;
fetch {
  ""name"": $name,
  ""born"": $born
};"
movies,310,List 3 movies with the tagline including the word 'real'.,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'real'
RETURN m.title
LIMIT 3","match
  $m isa movie, has tagline $tag;
  $tag like "".*[Rr][Ee][Aa][Ll].*"";
limit 3;
fetch {
  ""title"": $m.title
};"
movies,312,Name 3 persons who have reviewed a movie and also acted in a different movie.,"MATCH (p:Person)-[:REVIEWED]->(:Movie)
WHERE exists {
  (p)-[:ACTED_IN]->(:Movie)
}
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m1 isa movie;
  $m2 isa movie;
  reviewed (reviewer: $p, film: $m1);
  acted_in (actor: $p, film: $m2);
  not { $m1 is $m2; };
  $p has name $name;
limit 3;
fetch {
  ""name"": $name
};"
movies,314,List the movies that have been produced and directed by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $title;
  $p has name $name;
fetch {
  ""movie"": $title,
  ""person"": $name
};"
movies,332,List the first 5 people who wrote a movie with a rating of at least 80 in a review.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[r:REVIEWED]-(reviewer:Person)
WHERE r.rating >= 80
RETURN p.name AS writer, m.title AS movie, r.rating AS rating
LIMIT 5","match
  $p isa person, has name $namep;
  $m isa movie, has title $titlem;
  wrote (writer: $p, film: $m);
  $r isa reviewed (reviewer: $reviewer, film: $m), has rating $ratingr;
  $ratingr >= 80;
limit 5;
fetch {
  ""writer"": $namep,
  ""movie"": $titlem,
  ""rating"": $ratingr
};"
movies,333,Which movies released between 2005 and 2010 have the tagline 'Speed has no limits'?,"MATCH (m:Movie)
WHERE m.released >= 2005 AND m.released <= 2010
  AND m.tagline = 'Speed has no limits'
RETURN m.title","match
  $m isa movie;
  $m has released $released;
  $released >= 2005;
  $released <= 2010;
  $m has tagline ""Speed has no limits"";
fetch {
  ""title"": $m.title
};"
movies,339,Who are the top 3 persons who have both directed and produced the same movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN p.name AS person, num_movies","match
  $p isa person;
  $m isa movie;
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
  $p has name $name;
reduce $num_movies = count($m) groupby $name;
sort $num_movies desc;
limit 3;
fetch {
  ""person"": $name,
  ""num_movies"": $num_movies
};"
movies,343,List the first 5 movies that have been acted in by someone with the role 'Captain' and reviewed with a rating below 60.,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE 'Captain' IN p.roles
WITH m
MATCH (m)<-[r:REVIEWED]-()
WHERE r.rating < 60
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $acted isa acted_in (actor: $p, film: $m);
  $acted has roles ""Captain"";
  $rev isa reviewed (film: $m);
  $rev has rating $r;
  $r < 60;
limit 5;
fetch {
  ""title"": $m.title
};"
movies,345,List the first 3 movies with a tagline containing 'limits' and released after 2005.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limits' AND m.released > 2005
RETURN m.title, m.tagline, m.released
LIMIT 3","match
  $m isa movie;
  $m has tagline $taglinem;
  $taglinem like "".*limits.*"";
  $m has released $releasedm;
  $releasedm > 2005;
limit 3;
fetch {
  ""title"": $m.title,
  ""tagline"": $taglinem,
  ""released"": $releasedm
};"
movies,378,"List top 3 people who have directed, produced, and acted in the same movie.","MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)-[:ACTED_IN]->(m)
WITH p, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3
RETURN p.name AS person, movieCount","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (producer: $p, film: $m) isa produced;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
reduce $movieCount = count($m) groupby $namep;
sort $movieCount desc;
limit 3;
fetch {
  ""person"": $namep,
  ""movieCount"": $movieCount
};"
movies,347,List the top 5 persons who reviewed movies with a summary stating 'An amazing journey' and a rating above 80.,"MATCH (p:Person)-[r:REVIEWED]->(m:Movie)
WHERE r.summary = 'An amazing journey' AND r.rating > 80
RETURN p.name AS reviewer, m.title AS movie
ORDER BY r.rating DESC
LIMIT 5","match
$m isa movie;
$p isa person, has name $name;
$r isa reviewed (reviewer: $p, film: $m), has summary $summary, has rating $rating;
$summary == ""An amazing journey"";
$rating > 80;
sort $rating desc;
limit 5;
fetch {
  ""reviewer"": $name,
  ""rating"": $rating
};"
movies,382,List all movies that were both acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""person"": $namep
};"
movies,353,Who are the top 3 directors of movies that have been reviewed with a summary stating 'Pretty funny at times'?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:REVIEWED]-(r:Person)
WHERE r.summary = 'Pretty funny at times'
RETURN p.name AS director, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  $rev isa reviewed (reviewer: $r, film: $m);
  $rev has summary ""Pretty funny at times"";
reduce $num_movies = count($m) groupby $p;
sort $num_movies desc;
limit 3;
fetch {
  ""director"": $p.name,
  ""num_movies"": $num_movies
};"
movies,392,Who are the top 5 youngest producers?,"MATCH (p:Person)-[:PRODUCED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 5","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
  produced (producer: $p, film: $m);
sort $bornp desc;
limit 5;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,387,"Who has acted in, directed, and produced the same movie?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WHERE exists{ (p)-[:PRODUCED]->(m) }
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,395,Who has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name AS person, m.title AS movie, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has title $t;
reduce $count = count($r) groupby $p, $n, $m, $t;
sort $count desc;
limit 1;
fetch {
  ""person"": $n,
  ""movie"": $t,
  ""num_roles"": $count
};"
movies,396,List all movie titles with exactly one word in the title.,"MATCH (m:Movie)
WHERE m.title =~ '^[\\w]+$'
RETURN m.title","match
  $m isa movie;
  $m has title $titlem;
  not { $titlem like "".* .*""; };
fetch {
  ""title"": $titlem
};"
movies,388,List all movies with more than 3 roles listed in their ACTED_IN relationships.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WHERE size(r.roles) > 3
RETURN m.title, r.roles","match
  $m isa movie, has title $t;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $count = count($r) groupby $ai, $t;
match $count > 3;
fetch {
  ""title"": $t,
  ""role_count"": $count
};"
movies,418,List all movies with taglines that start with 'The'.,"MATCH (m:Movie)
WHERE m.tagline STARTS WITH 'The'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has title $titlem;
  $m has tagline $taglinem;
  $taglinem like ""^The.*"";
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,413,List all movies where the producer and director are the same person.,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person)-[:PRODUCED]->(m)
RETURN m.title AS movie, p.name AS person","match
  $m isa movie;
  $p isa person;
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
  $m has title $title;
  $p has name $name;
fetch {
  ""movie"": $title,
  ""person"": $name
};"
movies,399,Who are the top 3 youngest directors?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name AS director, p.born AS birthYear
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
  directed (director: $p, film: $m);
sort $bornp desc;
limit 3;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp
};"
movies,410,Who has produced and written the same movie?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:WROTE]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  wrote (writer: $p, film: $m);
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,421,List all movies where the same person has acted and produced.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  produced (producer: $p, film: $m);
fetch {
  ""movie"": $m.title,
  ""person"": $p.name
};"
movies,428,Who has acted in movies directed by Lana Wachowski?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Person {name: 'Lana Wachowski'})
RETURN p.name AS actor, m.title AS movie","match
  $p isa person;
  $m isa movie;
  $d isa person, has name ""Lana Wachowski"";
  acted_in (actor: $p, film: $m);
  directed (director: $d, film: $m);
fetch {
  ""actor"": $p.name,
  ""movie"": $m.title
};"
movies,429,List all movies that have been reviewed and produced by the same person.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS movie","match
  $p isa person;
  $m isa movie;
  reviewed (reviewer: $p, film: $m);
  produced (producer: $p, film: $m);
  $m has title $title;
fetch {
  ""movie"": $title
};"
movies,425,"Who has the most movies with a 'Silly, but fun' review summary?","MATCH (p:Person)-[:REVIEWED]->(m:Movie)
WHERE p.name IS NOT NULL
WITH p, count(CASE WHEN m.summary = 'Silly, but fun' THEN 1 END) AS silly_reviews
RETURN p.name AS name, silly_reviews
ORDER BY silly_reviews DESC
LIMIT 1","match
  $p isa person, has name $n;
  $rev isa reviewed (reviewer: $p, film: $m), has summary ""Silly, but fun"";
reduce $silly_reviews = count($rev) groupby $n;
sort $silly_reviews desc;
limit 1;
fetch {
  ""name"": $n,
  ""silly_reviews"": $silly_reviews
};"
movies,424,List the movies with exactly two roles in their ACTED_IN relationships.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WHERE size(r.roles) = 2
RETURN m.title","match
  $rel isa acted_in (actor: $p, film: $m);
  $m has title $t;
  $rel has roles $r;
reduce $count = count($r) groupby $rel, $t;
match $count == 2;
fetch {
  ""title"": $t
};"
movies,452,Identify 3 movies that were both produced and directed by the same person.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title, p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $titlem;
  $p has name $namep;
limit 3;
fetch {
  ""title"": $titlem,
  ""name"": $namep
};"
movies,454,Which 3 people have the smallest age difference between them?,"MATCH (p1:Person), (p2:Person)
WHERE p1 <> p2 AND p1.born IS NOT NULL AND p2.born IS NOT NULL
WITH p1, p2, abs(p1.born - p2.born) AS ageDiff
ORDER BY ageDiff
LIMIT 3
RETURN p1.name AS person1, p2.name AS person2, ageDiff","match
  $p1 isa person, has name $n1, has born $b1;
  $p2 isa person, has name $n2, has born $b2;
  not { $p1 is $p2; };
let $ageDiff = abs($b1 - $b2);
sort $ageDiff asc;
limit 3;
fetch {
  ""person1"": $n1,
  ""person2"": $n2,
  ""ageDiff"": $ageDiff
};"
movies,455,List 3 movies with the most roles listed in the ACTED_IN relationship.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
RETURN m.title AS movie, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $rel isa acted_in (film: $m), has roles $r;
reduce $num_roles = count($r) groupby $t;
sort $num_roles desc;
limit 3;
fetch {
  ""movie"": $t,
  ""num_roles"": $num_roles
};"
movies,461,What are the common movies acted in by people who were born in the same decade?,"MATCH (p1:Person)-[:ACTED_IN]->(m:Movie)<-[:ACTED_IN]-(p2:Person)
WHERE p1 <> p2 AND p1.born >= 1920 AND p1.born < 2000 AND p2.born >= 1920 AND p2.born < 2000
      AND floor(p1.born / 10) = floor(p2.born / 10)
RETURN p1.name AS person1, p2.name AS person2, collect(m.title) AS common_movies","match
  $p1 isa person, has name $name1, has born $born1;
  $p2 isa person, has name $name2, has born $born2;
  $m isa movie, has title $title;
  acted_in (actor: $p1, film: $m);
  acted_in (actor: $p2, film: $m);
  $born1 >= 1920;
  $born1 < 2000;
  $born2 >= 1920;
  $born2 < 2000;
  not { $p1 is $p2; };
let $decade1 = $born1 / 10;
let $decade2 = $born2 / 10;
match $decade1 == $decade2;
fetch {
  ""person1"": $name1,
  ""person2"": $name2,
  ""common_movie"": $title
};"
movies,470,List the names of 3 persons who have the name starting with 'L'.,"MATCH (p:Person)
WHERE p.name STARTS WITH 'L'
RETURN p.name
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $namep like ""L.*"";
limit 3;
fetch {
  ""name"": $namep
};"
movies,469,Name 3 persons who have produced movies but have not directed any.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE NOT EXISTS { (p)-[:DIRECTED]->() }
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  not { directed (director: $p); };
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,465,What are the top 3 movies with the most diverse roles in the ACTED_IN relationship?,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WITH m, size(collect(distinct r.roles)) AS role_diversity
RETURN m.title AS movie, role_diversity
ORDER BY role_diversity DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
select $t, $r;
distinct;
reduce $role_diversity = count groupby $t;
sort $role_diversity desc;
limit 3;
fetch {
  ""movie"": $t,
  ""role_diversity"": $role_diversity
};"
movies,466,Who are the first 3 people to act in and review the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  reviewed (reviewer: $p, film: $m);
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,475,Who are the first 3 persons to have directed and acted in the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,488,"Which 3 persons have acted in, directed, and produced the same movie?","MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WHERE exists{ (p)-[:PRODUCED]->(m) }
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,492,Name 3 persons who have directed a movie with a tagline containing 'limits'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name
LIMIT 3","match
  $p isa person, has name $name;
  $m isa movie, has tagline $tagline;
  $tagline like "".*limits.*"";
  directed (director: $p, film: $m);
limit 3;
fetch {
  ""name"": $name
};"
movies,509,Which 3 persons have reviewed and produced the same movie?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name, m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  reviewed (reviewer: $p, film: $m);
  produced (producer: $p, film: $m);
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""name"": $namep,
  ""title"": $titlem
};"
movies,503,Name 3 actors who have acted in the least voted movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WITH p, min(m.votes) AS minVotes
ORDER BY minVotes
LIMIT 3
RETURN p.name AS actor","match
  $p isa person, has name $n;
  acted_in (actor: $p, film: $m);
  $m has votes $v;
reduce $min_votes = min($v) groupby $n;
sort $min_votes asc;
limit 3;
fetch {
  ""actor"": $n
};"
movies,495,Name 3 movies with a released year divisible by 3.,"MATCH (m:Movie)
WHERE m.released % 3 = 0
RETURN m.title
LIMIT 3","match
  $m isa movie, has title $t, has released $r;
  $r % 3 == 0;
limit 3;
fetch {
  ""title"": $t
};"
movies,496,Who are the 3 youngest directors in the database?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name, p.born
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
  directed (director: $p, film: $m);
select $p, $namep, $bornp;
distinct;
sort $bornp desc;
limit 3;
fetch {
  ""name"": $namep,
  ""born"": $bornp
};"
movies,514,Name the 3 persons who have appeared in the most REVIEWED movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:REVIEWED]-(:Person)
WITH p, count(m) AS reviewedMovies
ORDER BY reviewedMovies DESC
LIMIT 3
RETURN p.name AS name, reviewedMovies","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  reviewed (film: $m);
  $p has name $name;
reduce $reviewedMovies = count($m) groupby $name;
sort $reviewedMovies desc;
limit 3;
fetch {
  ""name"": $name,
  ""reviewedMovies"": $reviewedMovies
};"
movies,523,Name 3 persons who have acted in movies released in consecutive years.,"MATCH (p1:Person)-[:ACTED_IN]->(m1:Movie), 
      (p2:Person)-[:ACTED_IN]->(m2:Movie),
      (p3:Person)-[:ACTED_IN]->(m3:Movie)
WHERE m1.released = m2.released - 1 AND m2.released = m3.released - 1
      AND p1 <> p2 AND p1 <> p3 AND p2 <> p3
RETURN p1.name AS person1, p2.name AS person2, p3.name AS person3","match
  $p isa person;
  $m1 isa movie, has released $r1;
  $m2 isa movie, has released $r2;
  acted_in (actor: $p, film: $m1);
  acted_in (actor: $p, film: $m2);
  let $consecutive = $r1 + 1;
  $r2 == $consecutive;
limit 3;
fetch {
  ""name"": $p.name
};
"
movies,518,Name 3 people who have the most combined roles across all their ACTED_IN movies.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WITH p, size(r.roles) AS role_count
RETURN p.name, sum(role_count) AS total_roles
ORDER BY total_roles DESC
LIMIT 3","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $total_roles = count($r) groupby $p, $n;
sort $total_roles desc;
limit 3;
fetch {
  ""name"": $n,
  ""total_roles"": $total_roles
};"
movies,527,List the top 3 movies with roles played by persons born in the 1940s.,"MATCH (p:Person)-[ai:ACTED_IN]->(m:Movie)
WHERE p.born >= 1940 AND p.born < 1950
RETURN m.title AS movie, collect(ai.roles) AS roles
ORDER BY size(roles) DESC
LIMIT 3","match
  $p isa person, has born $b;
  $b >= 1940;
  $b < 1950;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $count = count($ai) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""role_count"": $count
};"
movies,515,List the first 3 movies where someone both acted in and directed.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
movies,552,List the movies that were written and directed by the same person.,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  directed (director: $p, film: $m);
fetch {
  ""movie"": $m.title,
  ""person"": $p.name
};"
movies,546,"Show top 3 persons who directed, produced, and acted in the same movie.","MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)-[:ACTED_IN]->(m)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match
  $p isa person;
  $m isa movie;
  (director: $p, film: $m) isa directed;
  (producer: $p, film: $m) isa produced;
  (actor: $p, film: $m) isa acted_in;
  $p has name $namep;
  $m has title $titlem;
limit 3;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,531,List the 3 movies with the highest number of votes and a tagline mentioning 'limit'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limit'
RETURN m.title, m.tagline, m.votes
ORDER BY m.votes DESC
LIMIT 3","match
  $m isa movie;
  $m has title $titlem;
  $m has tagline $taglinem;
  $taglinem like "".*limit.*"";
  $m has votes $votesm;
sort $votesm desc;
limit 3;
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem,
  ""votes"": $votesm
};"
movies,534,Name 3 directors who have directed movies with the least number of votes.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WITH d, min(m.votes) AS minVotes
ORDER BY minVotes
LIMIT 3
RETURN d.name AS director","match
  $d isa person, has name $n;
  directed (director: $d, film: $m);
  $m has votes $v;
reduce $minVotes = min($v) groupby $n;
sort $minVotes asc;
limit 3;"
movies,581,Which persons have acted in and directed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,580,What are the most common roles in movies released before 1980?,"MATCH (p:Person)-[ai:ACTED_IN]->(m:Movie)
WHERE m.released < 1980
UNWIND ai.roles AS role
RETURN role, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 10","match
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has released $rel;
  $rel < 1980;
reduce $count = count groupby $r;
sort $count desc;
limit 10;
fetch {
  ""role"": $r,
  ""frequency"": $count
};"
movies,563,List all movies with a release year divisible by 5.,"MATCH (m:Movie)
WHERE m.released % 5 = 0
RETURN m.title, m.released","match
  $m isa movie, has title $t, has released $r;
  $r % 5 == 0;
fetch {
  ""title"": $t,
  ""released"": $r
};"
movies,557,Who are the producers of movies with a tagline containing 'limits'?,"MATCH (m:Movie)<-[:PRODUCED]-(p:Person)
WHERE m.tagline CONTAINS 'limits'
RETURN p.name AS producer","match
  $m isa movie, has tagline $t;
  $t like "".*limits.*"";
  $p isa person, has name $name;
  produced (producer: $p, film: $m);
fetch {
  ""producer"": $name
};"
movies,594,Who are the top 3 youngest directors in the graph?,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name AS director, p.born AS birthYear
ORDER BY p.born DESC
LIMIT 3","match
  $p isa person;
  $p has name $namep;
  $p has born $bornp;
  directed (director: $p, film: $m);
sort $bornp desc;
limit 3;
fetch {
  ""director"": $namep,
  ""birthYear"": $bornp
};"
movies,590,List the top 3 pairs of persons who follow each other.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)-[:FOLLOWS]->(p1)
RETURN p1.name AS person1, p2.name AS person2
LIMIT 3","match
  $p1 isa person;
  $p2 isa person;
  follows (follower: $p1, followed: $p2);
  follows (follower: $p2, followed: $p1);
  $p1 has name $namep1;
  $p2 has name $namep2;
  $namep1 < $namep2;
limit 3;
fetch {
  ""person1"": $namep1,
  ""person2"": $namep2
};"
movies,584,List all movies with exactly 5 roles in the 'ACTED_IN' relationship.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WHERE size(r.roles) = 5
RETURN m.title","match
  $m isa movie, has title $t;
  $rel isa acted_in (actor: $p, film: $m), has roles $r;
reduce $role_count = count($r) groupby $rel, $t;
match $role_count == 5;
fetch {
  ""title"": $t
};
"
movies,616,What are the roles of Keanu Reeves in movies with a released year divisible by 5?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie)
WHERE m.released % 5 = 0
RETURN m.title, r.roles","match
  $p isa person, has name ""Keanu Reeves"";
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has title $t, has released $rel;
  $rel % 5 == 0;
fetch {
  ""title"": $t,
  ""roles"": $r
};"
movies,617,List all movies produced by persons who have also directed a movie with the same title.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE EXISTS {
  (p)-[:DIRECTED]->(m2:Movie)
  WHERE m.title = m2.title
}
RETURN m.title AS movie","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $title;
fetch {
  ""movie"": $title
};"
movies,605,List the top 5 movies by number of roles in the 'ACTED_IN' relationship.,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
RETURN m.title AS movie, size(r.roles) AS numRoles
ORDER BY numRoles DESC
LIMIT 5","match
  $m isa movie, has title $t;
  $rel isa acted_in (actor: $p, film: $m);
  $rel has roles $r;
reduce $roleCount = count($r) groupby $t;
sort $roleCount desc;
limit 5;
fetch {
  ""movie"": $t,
  ""roleCount"": $roleCount
};"
movies,647,List the movies with taglines that start with 'Everything'.,"MATCH (m:Movie)
WHERE m.tagline STARTS WITH 'Everything'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has title $titlem;
  $m has tagline $taglinem;
  $taglinem like ""Everything.*"";
fetch {
  ""title"": $titlem,
  ""tagline"": $taglinem
};"
movies,635,Which movies have been both produced and directed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has title $titlem;
  $p has name $namep;
fetch {
  ""movie"": $titlem,
  ""person"": $namep
};"
movies,627,Which person has both acted in and directed the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $p has name $namep;
  $m has title $titlem;
fetch {
  ""person"": $namep,
  ""movie"": $titlem
};"
movies,620,List the movies that have been both directed and produced by the same person.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS movie","match
  $p isa person;
  $m isa movie;
  directed (director: $p, film: $m);
  produced (producer: $p, film: $m);
  $m has title $titlem;
fetch {
  ""movie"": $titlem
};"
movies,637,What are the most common roles in the movie 'The Matrix Revolutions'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'The Matrix Revolutions'})
UNWIND r.roles AS role
RETURN role, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has title ""The Matrix Revolutions"";
reduce $frequency = count($ai) groupby $r;
sort $frequency desc;
limit 5;"
movies,655,Who are the people that have both written and produced the same movie?,"MATCH (p:Person)-[:WROTE]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name AS person, m.title AS movie","match
  $p isa person;
  $m isa movie;
  wrote (writer: $p, film: $m);
  produced (producer: $p, film: $m);
fetch {
  ""person"": $p.name,
  ""movie"": $m.title
};"
movies,654,List the movies where the tagline contains the word 'limits'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'limits'
RETURN m.title","match
  $m isa movie;
  $m has tagline $tagline;
  $tagline like "".*limits.*"";
fetch {
  ""title"": $m.title
};"
movies,659,List the movies that were both acted in and produced by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  produced (producer: $p, film: $m);
  $m has title $title;
  $p has name $name;
fetch {
  ""movie"": $title,
  ""person"": $name
};"
movies,648,Who has the most roles in a single movie?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN p.name AS person, m.title AS movie, size(r.roles) AS num_roles
ORDER BY num_roles DESC
LIMIT 1","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
  $m has title $t;
reduce $count = count($r) groupby $p, $m, $n, $t;
sort $count desc;
limit 1;
fetch {
  ""person"": $n,
  ""movie"": $t,
  ""num_roles"": $count
};"
movies,657,What are the top 5 reviewed movies by summary 'An amazing journey'?,"MATCH (m:Movie)<-[r:REVIEWED]-(p:Person)
WHERE r.summary = 'An amazing journey'
RETURN m.title, count(r) AS reviews
ORDER BY reviews DESC
LIMIT 5","match
$m isa movie, has title $title;
$p isa person;
$r isa reviewed (reviewer: $p, film: $m), has summary ""An amazing journey"";
reduce $reviews = count($r) groupby $m, $title;
sort $reviews desc;
limit 5;
fetch {
  ""title"": $title,
  ""reviews"": $reviews
};
"
movies,691,Name the first 3 people who have produced and acted in the same movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:PRODUCED]-(p)
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  produced (producer: $p, film: $m);
  $p has name $name;
limit 3;
fetch {
  ""name"": $name
};"
movies,703,List the first three people who directed a movie with a tagline containing the word 'real'.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE toLower(m.tagline) CONTAINS 'real'
RETURN p.name
LIMIT 3","match
  $p isa person, has name $name;
  $m isa movie, has tagline $tagline;
  directed (director: $p, film: $m);
  $tagline like "".*[Rr][Ee][Aa][Ll].*"";
limit 3;
fetch {
  ""name"": $name
};"
movies,673,Name the movies that have been both reviewed and produced by the same person.,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[:PRODUCED]-(p)
RETURN m.title","match
  $p isa person;
  $m isa movie;
  reviewed (reviewer: $p, film: $m);
  produced (producer: $p, film: $m);
  $m has title $title;
fetch {
  ""title"": $title
};"
movies,687,Name the people who have the role of both actor and director in the most movies.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WITH p, count(m) AS num_actor_director_movies
ORDER BY num_actor_director_movies DESC
LIMIT 1
RETURN p.name AS person, num_actor_director_movies","match
  $p isa person;
  $m isa movie;
  acted_in (actor: $p, film: $m);
  directed (director: $p, film: $m);
  $p has name $namep;
reduce $num_actor_director_movies = count($m) groupby $namep;
sort $num_actor_director_movies desc;
limit 1;
fetch {
  ""person"": $namep,
  ""num_actor_director_movies"": $num_actor_director_movies
};"
movies,692,What is the average number of roles per actor in 'The Matrix'?,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie {title: 'The Matrix'})
RETURN avg(size(r.roles)) AS avg_roles_per_actor","match
  $rel isa acted_in (actor: $p, film: $m);
  $m has title ""The Matrix"";
  $rel has roles $role;
reduce $role_count = count($role) groupby $p;
reduce $avg = mean($role_count);
fetch {
  ""avg_roles_per_actor"": $avg
};"
movies,717,List the first three movies that were produced by someone with a name ending in 'son' and released after 2000.,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)
WHERE p.name ENDS WITH 'son' AND m.released > 2000
RETURN m.title
LIMIT 3","match
  $p isa person, has name $name;
  $m isa movie, has released $released;
  produced (producer: $p, film: $m);
  $name like "".*son"";
  $released > 2000;
limit 3;
fetch {
  ""title"": $m.title
};"
movies,711,Which top five movies have been both produced and directed by the same person?,"MATCH (p:Person)-[:PRODUCED]->(m:Movie)<-[:DIRECTED]-(p)
WITH m, p
ORDER BY m.votes DESC
LIMIT 5
RETURN m.title AS movie, p.name AS person","match
  $p isa person;
  $m isa movie;
  produced (producer: $p, film: $m);
  directed (director: $p, film: $m);
  $m has votes $votesm;
sort $votesm desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""person"": $p.name
};"
movies,727,List the first three people who followed someone at least 20 years their junior.,"MATCH (p1:Person)-[:FOLLOWS]->(p2:Person)
WHERE p1.born - p2.born >= 20
RETURN p1.name AS follower, p2.name AS followed
LIMIT 3","match
  $p1 isa person, has born $born1, has name $name1;
  $p2 isa person, has born $born2, has name $name2;
  follows (follower: $p1, followed: $p2);
  let $age_diff = $born2 - $born1;
  $age_diff >= 20;
limit 3;
fetch {
  ""follower"": $name1,
  ""followed"": $name2
};"
movies,722,List the first three people who wrote a movie and also acted in a different movie.,"MATCH (p:Person)-[:WROTE]->(:Movie)
WHERE EXISTS {
  (p)-[:ACTED_IN]->(:Movie)
}
RETURN p.name
LIMIT 3","match
  $p isa person;
  wrote (writer: $p, film: $m1);
  acted_in (actor: $p, film: $m2);
  not { $m1 is $m2; };
  $p has name $namep;
limit 3;
fetch {
  ""name"": $namep
};"
movies,714,"Who are the top five actors with the most diverse range of roles, having acted in at least five different movies?","MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
WHERE m.title IS NOT NULL
WITH p, size(collect(distinct r.roles)) AS num_roles, count(distinct m) AS num_movies
WHERE num_movies >= 5
RETURN p.name AS actor, num_roles AS number_of_distinct_roles
ORDER BY num_roles DESC
LIMIT 5","match
  $p isa person, has name $n;
  $ai isa acted_in (actor: $p, film: $m), has roles $r;
reduce $num_movies = count($m), $num_roles = count($r) groupby $p, $n;
match $num_movies >= 5;
sort $num_roles desc;
limit 5;
fetch {
  ""actor"": $n,
  ""number_of_distinct_roles"": $num_roles
};"
movies,182,List the top 5 movies by the number of roles and their respective actors.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
RETURN m.title AS movie, collect(p.name) AS actors, size(ai.roles) AS numRoles
ORDER BY numRoles DESC
LIMIT 5","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
sort $count desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numRoles"": $count
};"
movies,471,What are the top 3 movies by the number of roles available in the ACTED_IN relationship?,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
RETURN m.title AS movie, size(r.roles) AS numRoles
ORDER BY numRoles DESC
LIMIT 3","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
sort $count desc;
limit 3;
fetch {
  ""movie"": $t,
  ""numRoles"": $count
};"
movies,478,List 3 movies with exactly 3 roles in the ACTED_IN relationship.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE size(ai.roles) = 3
RETURN m.title
LIMIT 3","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
  $count == 3;
limit 3;
fetch {
  ""movie"": $t
};"
movies,556,List all the movies where the roles list contains more than 4 characters.,"MATCH (m:Movie)<-[ai:ACTED_IN]-(p:Person)
WHERE EXISTS {
  (m)<-[ai2:ACTED_IN]-(p2:Person)
  WHERE size(ai2.roles) > 4
}
RETURN m.title AS movie, collect(p.name) AS actors","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
  $count > 4;
fetch {
  ""movie"": $t
};"
movies,576,What are the first 3 movies with the longest role lists in 'ACTED_IN' relationships?,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
RETURN m.title AS movie, size(r.roles) AS roleCount
ORDER BY roleCount DESC
LIMIT 3","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
sort $count desc;
limit 3;
fetch {
  ""movie"": $t,
  ""roleCount"": $count
};"
movies,603,Show the first 3 movies with the most complex role lists in the 'ACTED_IN' relationship.,"MATCH (p:Person)-[r:ACTED_IN]->(m:Movie)
RETURN m.title, r.roles
ORDER BY size(r.roles) DESC
LIMIT 3","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
sort $count desc;
limit 3;
fetch {
  ""movie"": $t,
  ""roleCount"": $count
};"
movies,589,What are the roles list sizes for each movie Keanu Reeves has acted in?,"MATCH (p:Person {name: 'Keanu Reeves'})-[r:ACTED_IN]->(m:Movie)
RETURN m.title, size(r.roles) AS roleCount","match
  $p isa person, has name ""Keanu Reeves"";
  $m isa movie, has title $t;
  $ai isa acted_in (film: $m, actor: $p);
  $ai has roles $r;
reduce $count = count($r) groupby $m, $t;
fetch {
  ""movie"": $t,
  ""roleCount"": $count
};"
movies,618,What are the top 3 shortest role lists in movies reviewed by persons born before 1960?,"MATCH (p:Person)-[:REVIEWED]->(m:Movie)<-[ai:ACTED_IN]-(a:Person)
WHERE p.born < 1960
RETURN m.title, ai.roles
ORDER BY size(ai.roles)
LIMIT 3","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $p isa person, has born $b;
  $b < 1960;
  reviewed (reviewer: $p, film: $m);
  $m isa movie, has title $t;
  let $count = role_count($m);
sort $count asc;
limit 3;
fetch {
  ""movie"": $t,
  ""roleCount"": $count
};"
movies,619,Which movie has the most roles in the 'ACTED_IN' relationship and what are those roles?,"MATCH (m:Movie)<-[r:ACTED_IN]-(p:Person)
WITH m, r
ORDER BY size(r.roles) DESC
LIMIT 1
RETURN m.title AS movie, r.roles AS roles","with fun role_count($m: movie) -> integer:
  match
    $ai isa acted_in (film: $m);
    $ai has roles $r;
  return count;
match
  $m isa movie, has title $t;
  let $count = role_count($m);
sort $count desc;
limit 1;
fetch {
  ""movie"": $t,
  ""roleCount"": $count
};"
neoflix,1,List the first 3 movies with a budget over 50 million.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 50000000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,2,What are the top 5 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,3,Name 3 movies directed by Pixar Animation Studios.,"MATCH (m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,4,Which movies have a runtime longer than 100 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 100
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 100;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,5,List the first 3 movies in the Toy Story Collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,6,What are the top 5 highest revenue-generating movies?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,8,Name 3 movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,9,Which movies are categorized under the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,10,What are the latest 3 movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,11,List the first 3 movies with a tagline containing the word 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*excitement.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,12,Which movies have been produced in the United States of America?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title","match
  $m isa movie;
  $c isa country, has country_name 'United States of America';
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,13,What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,14,Name 3 movies that have been translated into Kiswahili.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,15,Which movies feature the original language as 'en'?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {id: 'en'})
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_id 'en';
  $rel0 isa original_language (media: $m, language: $l);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,16,List the first 3 movies where Tom Hanks acted as a cast member.,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,17,Which movies are part of a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $c has backdrop_path $backdrop_path_c;
  $backdrop_path_c == ""/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg"";
fetch {
  ""title"": $title_m
};"
neoflix,18,What are the top 5 movies with the most votes?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,19,Name 3 movies with a release date after 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,20,Which movies have a homepage URL specified?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,22,Which movies are associated with the production company 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,23,What are the 3 most recent movies with a status of 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $m has release_date $release_date;
  $status == ""Released"";
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,24,Name 3 movies that Tom Hanks has a credit in as a crew member.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CREW_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,25,Which movies have a revenue greater than 300 million?,"MATCH (m:Movie)
WHERE m.revenue > 300000000
RETURN m.title, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $revenue > 300000000;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,26,List the first 3 movies with an average vote less than 5.,"MATCH (m:Movie)
WHERE m.average_vote < 5
RETURN m.title, m.average_vote
ORDER BY m.average_vote
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote < 5;
sort $average_vote asc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,27,Which movies have a runtime less than 85 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 85
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime < 85;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,28,What are the top 5 movies by budget size?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,30,Which movies have been rated by at least 100 users?,"MATCH (m:Movie)
WHERE m.vote_count >= 100
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count >= 100;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,33,What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,34,Name 3 movies that have been keyword-tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'based on novel';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,35,Which movies have a tagline that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*love.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,36,List the first 3 movies that have a vote count greater than 500.,"MATCH (m:Movie)
WHERE m.vote_count > 500
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 500;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,37,What are the top 5 movies with the lowest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,38,Name 3 movies with a budget of exactly 30 million.,"MATCH (m:Movie)
WHERE m.budget = 30000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $budget == 30000000;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""budget"": $budget };"
neoflix,39,Which movies feature music by a person named 'John Williams' as a crew member?,"MATCH (p:Person {name: 'John Williams'})-[:CREW_FOR]->(m:Movie)
WHERE p.name IS NOT NULL
RETURN m.title","match
  $p isa person, has person_name 'John Williams';
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $p has person_name $person_name_p;
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,40,List the top 5 movies by revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,41,Which movies have a budget greater than 50 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 50000000;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,42,Find all movies produced by Pixar Animation Studios.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,43,What are the top 3 most popular movies according to their popularity score?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,44,Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,45,Display the top 5 longest movies by runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,46,Which movies are part of the Toy Story Collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,47,List all movies that have the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,48,Which movies are released in the 'Animation' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,49,Which movies have a runtime longer than 120 minutes and are categorized under the 'Drama' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
  $m isa movie;
  $g isa genre, has genre_name 'Drama';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $runtime_m > 120;
fetch {
  ""title"": $title_m, ""runtime"": $runtime_m
};"
neoflix,51,List the top 5 movies that have a poster path available.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
neoflix,52,Which movies feature 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,54,Which movies have been rated exactly 5.0 by any user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title","match
  $m isa movie;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating == 5.0;
  $m has title $title;
fetch { ""title"": $title, ""rating"": $rating };"
neoflix,56,List the top 3 movies with the most revenue that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""revenue"": $revenue };"
neoflix,57,Which movies have a homepage listed in their properties?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,58,Find all movies where the original language is 'en' and have a tagline included.,"MATCH (m:Movie)
WHERE m.original_language = 'en' AND m.tagline IS NOT NULL
RETURN m","match
$m isa movie, has tagline $tagline;
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
fetch {
  ""movie"": $m.title
};"
neoflix,60,List the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
neoflix,64,List all movies where the overview mentions 'adventure'.,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m.title, m.overview","match
  $m isa movie;
  $m has overview $overview;
  $m has title $title;
  $overview like "".*adventure.*"";
fetch {
  ""title"": $title, ""overview"": $overview
};"
neoflix,65,Which movies have a status of 'Released' and a vote count of over 1000?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.vote_count > 1000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has status $status;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 1000;
  $status == ""Released"";
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,68,Which movies have a budget less than 10 million but a revenue greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue","match
  $m isa movie;
  $m has budget $budget;
  $m has revenue $revenue;
  $m has title $title;
  $budget < 10000000;
  $revenue > 100000000;
fetch {
  ""title"": $title, ""budget"": $budget, ""revenue"": $revenue
};"
neoflix,69,"Display movies that have been rated after January 1, 2015.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= date('2015-01-01')
RETURN m.title AS movie, r.rating AS rating, r.timestamp AS rated_at","match
  $m isa movie;
  $m has release_date $rd;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has timestamp $ts, has rating $rating;
  $m has title $title;
  $ts >= 2015-01-01;
fetch { ""title"": $title, ""release_date"": $rd, ""rating"": $rating, ""timestamp"": $ts };"
neoflix,71,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,72,Which movies are associated with the keyword 'space'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'space';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,73,Display the top 5 movies that were most recently released.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,74,Find all movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m","match
  $m isa movie, has title $title;
  $m has runtime $rt;
  $rt == 90;
limit 50;
fetch { ""title"": $title, ""runtime"": $rt };"
neoflix,75,Which movies have Tom Hanks credited as a producer?,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CREW_FOR {job: 'Producer'}]->(m:Movie)
RETURN m.title","match $p isa person, has person_name 'Tom Hanks'; $m isa movie; $r isa crew_for (crew_member: $p, film: $m), has job ""Producer""; $m has title $title_m; fetch { ""title"": $title_m };"
neoflix,76,List all genres that have been accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre","match
  $p isa package, has package_name 'Ultimate';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
neoflix,77,Display the top 3 movies with the least popularity.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity asc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,78,Which movies have a cast member who has also worked in the crew of the same movie?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)-[:CREW_FOR]->(m)
RETURN m.title AS movie, p.name AS person","match
  $m isa movie;
  $p isa person;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel1 isa cast_for (film: $m, actor: $p);
  $m has title $title_m;
  $p has person_name $person_name_p;
fetch {
  ""movie"": $title_m, ""person"": $person_name_p
};"
neoflix,82,Display the top 5 movies with the lowest average vote.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote asc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,83,Which movies are associated with a collection that has a poster path?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.poster_path IS NOT NULL
RETURN m.title, c.name, c.poster_path","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $c has poster_path $poster_path_c;
  $c has collection_name $collection_name_c;
fetch {
  ""title"": $title_m, ""name"": $collection_name_c, ""poster_path"": $poster_path_c
};"
neoflix,86,Display movies that have a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m.title, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,87,Find all adult movies that have been released.,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.release_date","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $a has release_date $release_date;
  $status == ""Released"";
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,88,List the top 3 adult movies by average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,89,"Which adult movies have a budget greater than 500,000 dollars?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget > 500000;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,90,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,91,Which movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,92,List all the languages spoken in the movie 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
  $m isa movie, has title 'Jumanji';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
fetch {
  ""language"": $language_name_l
};"
neoflix,93,What are the first 3 highest voted movies?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,94,Which movies were released after the year 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01')
RETURN m.title, m.release_date","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has title $title;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,96,Which movies are associated with the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,97,Can you find movies that are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,98,What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,99,Which movies have 'Tom Hanks' as a cast member?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,100,List all the genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
neoflix,101,Which production companies have produced movies with a budget over 50 million?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 50000000
RETURN DISTINCT c.name AS company","match $c isa production_company; $m isa movie; $c has production_company_name $production_company_name_c; $m has budget $budget_m; $budget_m > 50000000; fetch { ""company"": $production_company_name_c, ""name"": $production_company_name_c };"
neoflix,102,What are the languages available for the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
  $m isa movie, has title 'Toy Story';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
fetch {
  ""language"": $language_name_l
};"
neoflix,103,Which movies have a homepage listed?,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,104,List the first 5 movies sorted by popularity in descending order.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,105,What are the original titles of movies that have been translated to Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'})
WHERE m.original_language <> 'es'
RETURN m.original_title","match
$m isa movie, has original_title $original_title;
spoken_in_language (media: $m, language: $spanish);
$spanish has language_name ""Spanish"";
original_language (media: $m, language: $orig_lang);
not { $orig_lang has language_id ""es""; };
fetch {
  ""original_title"": $original_title
};"
neoflix,107,Which countries have produced movies with a revenue exceeding 200 million?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 200000000
RETURN DISTINCT c.name AS country","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has revenue $revenue_m;
  $c has country_name $country_name_c;
  $revenue_m > 200000000;
fetch {
  ""country"": $country_name_c, ""name"": $country_name_c
};"
neoflix,109,Which movies feature the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,112,List all movies that have been produced in 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN m.title","match
  $m isa movie;
  $c isa country, has country_name 'United States of America';
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,113,What are the first 3 oldest movies in the database?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,114,Which movies have the tagline 'Roll the dice and unleash the excitement!'?,"MATCH (m:Movie)
WHERE m.tagline = 'Roll the dice and unleash the excitement!'
RETURN m.title","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline == ""Roll the dice and unleash the excitement!"";
fetch {
  ""title"": $title
};"
neoflix,115,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,117,Who are the first 3 actors in the cast list of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CAST_FOR]-(p:Person)
RETURN p.name
ORDER BY p.id
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $p isa person;
  $rel0 isa cast_for (film: $m, actor: $p);
  $p has person_name $person_name_p;
  $p has person_id $person_id_p;
sort $person_id_p asc;
limit 3;
fetch {
  ""name"": $person_name_p
};"
neoflix,118,Who are the first 3 actors in the cast list of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CAST_FOR]-(p:Person)
RETURN p.name
ORDER BY p.id
LIMIT 3","match
  $m isa movie, has title ""Toy Story"";
  $c isa cast_for (actor: $p, film: $m), has cast_order $order;
  $p has person_name $name;
sort $order asc;
limit 3;
fetch { ""name"": $name };"
neoflix,120,Which videos have a runtime less than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v.title, v.runtime","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 30;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,121,What are the top 5 most popular videos?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,122,Which videos have been produced by 'Pixar Animation Studios'?,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
fetch {
  ""title"": $title_v
};"
neoflix,123,List all the keywords associated with the video 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $k isa keyword;
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $k has keyword_name $keyword_name_k;
fetch {
  ""keyword"": $keyword_name_k
};"
neoflix,125,Which adult films have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title, a.runtime","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 90;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,127,What are the original languages of the top 5 highest rated adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH a, l
ORDER BY a.average_vote DESC
LIMIT 5
RETURN a.title AS movie, l.name AS language","match
  $a isa adult_video;
  $l isa language;
  $rel0 isa original_language (media: $a, language: $l);
  $a has title $title_a;
  $a has average_vote $average_vote_a;
  $l has language_name $language_name_l;
sort $average_vote_a desc;
limit 5;
fetch {
  ""movie"": $title_a, ""language"": $language_name_l
};"
neoflix,128,Which adult films have been released after 2010?,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a.title, a.release_date","match
  $m isa adult_video;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has title $title;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,130,Which adult films are associated with the genre 'Horror'?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
RETURN a.title","match
  $a isa adult_video;
  $g isa genre, has genre_name 'Horror';
  $rel0 isa in_genre (media: $a, genre: $g);
  $a has title $title_a;
fetch {
  ""title"": $title_a
};"
neoflix,131,What are the first 3 most popular adult films based on popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 3","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,132,Which packages provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS package","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
fetch {
  ""package"": $package_name_p
};"
neoflix,135,Which genres are accessible through the 'Ultimate' package?,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre","match
  $p isa package, has package_name 'Ultimate';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
fetch {
  ""genre"": $genre_name_g
};"
neoflix,137,Which movies have Tom Hanks listed both in cast and crew?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)<-[:CREW_FOR]-(p)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $rel1 isa crew_for (film: $m, crew_member: $p);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,140,List all the movies that have a status of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $status == ""In Production"";
fetch {
  ""title"": $title
};"
neoflix,141,What are the original languages for the top 5 movies based on average vote?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH m, l
ORDER BY m.average_vote DESC
LIMIT 5
RETURN m.title AS movie, l.name AS original_language","match
  $m isa movie;
  $l isa language;
  $rel0 isa original_language (media: $m, language: $l);
  $m has title $title_m;
  $m has average_vote $average_vote_m;
  $l has language_name $language_name_l;
sort $average_vote_m desc;
limit 5;
fetch {
  ""movie"": $title_m, ""original_language"": $language_name_l
};"
neoflix,142,Which movies are tagged with 'adventure' and have a popularity above 15?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
WHERE m.popularity > 15
RETURN m.title, m.popularity","match
  $m isa movie;
  $k isa keyword, has keyword_name 'adventure';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has popularity $popularity_m;
  $m has title $title_m;
  $popularity_m > 15;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,143,What are the original languages for the top 5 movies based on average vote?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH m, l
ORDER BY m.average_vote DESC
LIMIT 5
RETURN m.title AS movie, l.name AS original_language","match
  $m isa movie, has title $title, has average_vote $vote;
  (media: $m, language: $l) isa original_language;
  $l has language_name $lang_name;
sort $vote desc;
limit 5;
fetch { ""movie"": $title, ""original_language"": $lang_name };"
neoflix,151,List the first 5 countries that have produced movies with an average vote above 7.0.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WHERE m.average_vote > 7.0
RETURN c.name AS country, avg(m.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  (media: $m, country: $c) isa produced_in_country;
  $m has average_vote $av;
  $av > 7.0;
limit 50;
fetch { ""country"": $cn };"
neoflix,152,Which production companies have produced movies that are part of a collection?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)<-[:PRODUCED_BY]-(p:ProductionCompany)
RETURN DISTINCT p.name AS ProductionCompany","match $c isa collection; $m isa movie; $p isa production_company; $rel0 isa in_collection (collection: $c, media: $m); $p has production_company_name $production_company_name_p; fetch { ""ProductionCompany"": $production_company_name_p, ""name"": $production_company_name_p };"
neoflix,153,What are the first 3 movies in the 'Toy Story Collection' based on release date?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 3;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m
};"
neoflix,154,Which movies have a cast member with the profile path ending in 'jpg'?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.profile_path ENDS WITH '.jpg'
RETURN m.title","match $m isa movie; $p isa person; $rel0 isa cast_for (film: $m, actor: $p); $m has title $title_m; $p has profile_path $profile_path_p; fetch { ""title"": $title_m };"
neoflix,155,List the first 3 movies with a revenue of zero.,"MATCH (m:Movie)
WHERE m.revenue = 0
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,156,Which movies have been rated by more than 5000 users?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,157,List the first 3 movies sorted by release date in ascending order.,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,158,What are the first 5 movies with the lowest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote asc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,159,Which movies have a tagline containing the word 'excitement'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*excitement.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,160,What are the first 3 countries with the most movies produced in the genre 'Drama'?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
RETURN c.name AS country, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  (media: $m, genre: $g) isa in_genre;
limit 30;
fetch { ""genre"": $gn };"
neoflix,161,Which videos have a budget less than 100000?,"MATCH (v:Video)
WHERE v.budget < 100000
RETURN v.title, v.budget","match
  $v isa video;
  $v has budget $budget;
  $v has title $title;
  $budget < 100000;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,162,List the first 3 videos with no revenue reported.,"MATCH (v:Video)
WHERE v.revenue IS NULL OR v.revenue = 0
RETURN v.title, v.revenue
LIMIT 3","match
  $m isa video;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,163,What are the top 5 most popular genres in adult films?,"MATCH (g:Genre)<-[:IN_GENRE]-(a:Adult)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa adult_video;
  (media: $m, genre: $g) isa in_genre;
limit 50;
fetch { ""genre"": $gn };"
neoflix,164,Which adult films have been produced by companies not based in the USA?,"MATCH (a:Adult)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE NOT EXISTS { (c)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'}) }
RETURN a.title AS `Adult Film`, c.name AS `Production Company`","match
  $a isa adult_video;
  $c isa production_company;
  $rel0 isa produced_by (media: $a, producer: $c);
  $a has title $title_a;
  $c has production_company_name $production_company_name_c;
fetch {
  ""title"": $title_a, ""name"": $production_company_name_c
};"
neoflix,165,List the first 3 adult films sorted by runtime in descending order.,"MATCH (a:Adult)
WHERE a.runtime IS NOT NULL
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,166,What are the first 5 adult films with the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,167,Which adult films feature the keyword 'murder'?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'murder'})
RETURN a.title","match
  $a isa adult_video;
  $k isa keyword, has keyword_name 'murder';
  $rel0 isa has_keyword (media: $a, keyword: $k);
  $a has title $title_a;
fetch {
  ""title"": $title_a
};"
neoflix,168,What are the first 3 videos that have been rated higher than 8.0?,"MATCH (v:Video)<-[r:RATED]-(u:User)
WHERE r.rating > 8.0
RETURN v.title, r.rating
ORDER BY r.rating DESC
LIMIT 3","match
  $m isa video;
  $m has title $title;
limit 3;
fetch { ""title"": $title };"
neoflix,169,List the top 5 longest running adult films.,"MATCH (a:Adult)
WHERE a.runtime IS NOT NULL
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 5","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,170,Which adult films have a homepage listed?,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title, a.homepage","match
  $a isa adult_video;
  $a has homepage $homepage;
  $a has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,171,What are the top 3 most budget-efficient adult films (highest revenue to budget ratio)?,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL AND a.revenue IS NOT NULL
RETURN a.title, a.revenue / a.budget AS efficiency
ORDER BY efficiency DESC
LIMIT 3","match $a isa adult_video; $a has budget $budget; $a has revenue $revenue; $a has title $title; limit 3; fetch { ""title"": $title, ""revenue"": $revenue, ""efficiency"": $budget };"
neoflix,172,Which adult films have been released with the status 'In Production'?,"MATCH (a:Adult)
WHERE a.status = 'In Production'
RETURN a.title","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $status == ""In Production"";
fetch {
  ""title"": $title
};"
neoflix,173,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,174,List the top 3 movies released in the United States of America.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has title $title; $m has release_date $release_date; $m has popularity $popularity; sort $popularity desc; limit 3; fetch { ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity };"
neoflix,175,Which 5 movies were produced by Pixar Animation Studios?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,176,Find the first 3 movies in the Toy Story Collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,177,Which 3 movies have the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,178,What are the first 5 movies rated by user with ID 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating
ORDER BY r.timestamp
LIMIT 5","match $u isa user, has user_id 1; $m isa movie; $r isa rated (reviewer: $u, rated_media: $m), has rating $rating; $m has title $title_m; limit 5; fetch { ""title"": $title_m, ""rating"": $rating };"
neoflix,179,List the top 5 highest voted movies on IMDb.,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,180,Which 3 highest budget movies were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""budget"": $budget };"
neoflix,181,What are the top 3 movies spoken in Kiswahili?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,182,Which 5 movies have Tom Hanks in the cast?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 5","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,183,List the first 3 movies directed by a person with gender 2.,"MATCH (p:Person {gender: 2})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
LIMIT 3","match $p isa person, has gender 2; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $m has title $title_m; limit 3; fetch { ""title"": $title_m };"
neoflix,184,What are the top 5 movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,185,Show the first 5 movies that have a popularity score over 15.,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has popularity $popularity;
  $m has title $title;
  $popularity > 15;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,186,Which 3 movies are part of genres with an ID between 15 and 50?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.id >= 15 AND g.id <= 50
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $g has genre_id $genre_id_g;
  $genre_id_g >= 15;
  $genre_id_g <= 50;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,187,List the top 5 movies that have been rated over 8.0.,"MATCH (m:Movie)
WHERE m.average_vote > 8.0
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 8.0;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,188,Which 3 movies have the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $k isa keyword, has keyword_name $kn;
  $m isa movie;
  (media: $m, keyword: $k) isa has_keyword;
limit 30;
fetch { ""keyword"": $kn };"
neoflix,189,Show the top 3 movies that were produced in multiple countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS numCountries
WHERE numCountries > 1
RETURN m.title AS movie, numCountries
ORDER BY numCountries DESC
LIMIT 3","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
reduce $count = count($c);
sort $count desc;
limit 3;
fetch {
  ""count"": $count
};"
neoflix,190,List the first 5 movies that have been tagged with 'based on novel'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'based on novel'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'based on novel';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,191,What are the top 5 movies that premiered in the last quarter of any year?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL AND m.release_date.month >= 10
RETURN m.title, m.release_date
ORDER BY m.popularity DESC
LIMIT 5","match $m isa movie; $m has release_date $release_date; $m has title $title; $m has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title, ""release_date"": $release_date };"
neoflix,192,Find the first 3 movies that feature both English and Spanish languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'})
WHERE EXISTS {
  (m)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'})
}
RETURN m.title
LIMIT 3","match $m isa movie; $l1 isa language, has language_name 'English'; $rel0 isa spoken_in_language (media: $m, language: $l1); $m has title $title_m; limit 3; fetch { ""title"": $title_m };"
neoflix,193,Which 5 movies were produced by companies with an ID over 1000?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.id > 1000
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $c has production_company_id $production_company_id_c;
  $production_company_id_c > 1000;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,194,List the top 3 oldest movies in the database.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,195,What are the top 5 movies with a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'adventure'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 5","match $m isa movie; $m has tagline $tagline; $m has title $title; $m has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title, ""tagline"": $tagline };"
neoflix,196,Which 3 movies have the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,197,Show the first 5 movies that were originally titled differently from their English title.,"MATCH (m:Movie)
WHERE m.title <> m.original_title
RETURN m.title AS title, m.original_title AS original_title
LIMIT 5","match $m isa movie; $m has title $title; $m has original_title $original_title; limit 5; fetch { ""title"": $title, ""original_title"": $original_title };"
neoflix,198,List the top 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,199,What are the first 5 movies that have no revenue recorded?,"MATCH (m:Movie)
WHERE m.revenue IS NULL
RETURN m.title
LIMIT 5","match $m isa movie; $m has revenue $revenue; $m has title $title; limit 5; fetch { ""title"": $title };"
neoflix,200,Which 5 movies have the most poster path variations?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, count(m.poster_path) AS poster_variations
ORDER BY poster_variations DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
limit 5;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
neoflix,202,List the first 3 videos with the highest average vote.,"MATCH (v:Video)
WHERE v.average_vote IS NOT NULL
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 3","match
  $v isa video;
  $v has average_vote $average_vote;
  $v has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,203,Which 5 videos have a runtime under 60 minutes?,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v.title, v.runtime
ORDER BY v.runtime
LIMIT 5","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 60;
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,204,Show the first 3 adult films that are spoken in Italian.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'it'})
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
  $a isa adult_video;
  $l isa language, has language_name 'it';
  $rel0 isa spoken_in_language (media: $a, language: $l);
  $a has title $title_a;
  $a has release_date $release_date_a;
sort $release_date_a asc;
limit 3;
fetch {
  ""title"": $title_a, ""release_date"": $release_date_a
};"
neoflix,205,List the top 5 adult films with a tagline containing 'murder'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'murder'
RETURN a.title, a.tagline
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $a has popularity $popularity;
  $tagline like "".*murder.*"";
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,206,What are the first 3 packages that provide access to the genre 'Animation'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name
LIMIT 3","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 3;
fetch {
  ""name"": $package_name_p
};"
neoflix,211,Show the top 5 most popular adult films based on their popularity score.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,212,List the first 3 adult films with the largest budget.,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,215,Show the first 5 videos produced by the company with ID 10.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {id: 10})
RETURN v.title, v.release_date, v.popularity
LIMIT 5","match
  $v isa video;
  $c isa production_company, has production_company_id 10;
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
  $v has release_date $release_date_v;
  $v has popularity $popularity_v;
limit 5;
fetch {
  ""title"": $title_v, ""release_date"": $release_date_v, ""popularity"": $popularity_v
};"
neoflix,219,Show the top 5 movies with the lowest average vote but highest revenue.,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.average_vote, m.revenue
ORDER BY m.average_vote ASC, m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has revenue $revenue;
  $m has title $title;
sort $average_vote asc, $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""revenue"": $revenue
};"
neoflix,220,List the first 3 people who have both acted in and produced a movie.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)<-[:CREW_FOR]-(p)
WHERE p.name IS NOT NULL
RETURN DISTINCT p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $rel1 isa crew_for (film: $m, crew_member: $p);
  $p has person_name $person_name_p;
limit 3;
fetch {
  ""name"": $person_name_p
};"
neoflix,232,List the top 3 highest grossing movies in the genre 'Action'.,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Action'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $g isa genre, has genre_name ""Action"";
  (media: $m, genre: $g) isa in_genre;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,233,What are the first 5 movies that have a character played by a person with gender 1?,"MATCH (p:Person)-[c:CAST_FOR]->(m:Movie)
WHERE p.gender = 1
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $p isa person;
  $cast isa cast_for (actor: $p, film: $m);
  $p has gender 1;
  $m has title $title;
limit 5;
fetch { ""title"": $title };"
neoflix,234,Show the top 5 oldest movies in the collection with the highest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.release_date, m.revenue
ORDER BY m.release_date, m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date asc, $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""revenue"": $revenue
};"
neoflix,235,List the first 3 movies that have a link to their homepage that includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $homepage like "".*disney.*"";
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,237,Show the first 5 movies where the production company's name includes 'Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.name CONTAINS 'Studios'
RETURN m.title, c.name
LIMIT 5","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $c has production_company_name $production_company_name_c;
  $production_company_name_c like "".*Studios.*"";
limit 5;
fetch {
  ""title"": $title_m, ""name"": $production_company_name_c
};"
neoflix,239,What are the first 5 adult films that have a runtime over 100 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 100
RETURN a.title
ORDER BY a.title
LIMIT 5","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 100;
sort $title asc;
limit 5;
fetch {
  ""title"": $title
};"
neoflix,241,Show the top 5 adult films with a poster path containing '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'.,"MATCH (a:Adult)
WHERE a.poster_path = '/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg'
RETURN a.title, a.release_date, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has poster_path $poster_path;
  $a has title $title;
  $a has release_date $release_date;
  $a has popularity $popularity;
  $poster_path == ""/tzVK7nTnzUiVeFSZhOAIHmrgXUS.jpg"";
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity
};"
neoflix,242,List the first 3 adult films with a tagline mentioning 'love'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'love'
RETURN a.title, a.tagline
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline like "".*love.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,243,What are the top 5 adult films with the highest number of votes?,"MATCH (a:Adult)
WHERE a.vote_count IS NOT NULL
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
  $a isa adult_video;
  $a has vote_count $vote_count;
  $a has title $title;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,244,Which 3 adult films have the lowest average votes but were produced in 'United States of America'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN a.title, a.average_vote
ORDER BY a.average_vote
LIMIT 3","match $a isa adult_video; $country isa country, has country_name 'United States of America'; (media: $a, country: $country) isa produced_in_country; $a has title $title; $a has average_vote $average_vote; sort $average_vote asc; limit 3; fetch { ""title"": $title, ""average_vote"": $average_vote };"
neoflix,246,"List the top 3 adult films with a budget under $10,000.","MATCH (a:Adult)
WHERE a.budget < 10000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget < 10000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,247,What are the top 5 movies sorted by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,248,List the first 3 movies released after 2010.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01')
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has title $title;
sort $rd asc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,249,Which 3 movies have the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,250,Name the top 5 oldest movies in the database.,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,251,What are the first 3 highest budget movies that were released?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has budget $budget;
  $m has title $title;
  $status == ""Released"";
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,252,List 5 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
limit 5;
fetch {
  ""title"": $title
};"
neoflix,254,Name the top 5 movies by vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,255,Which 3 movies have the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie, has title $title, has average_vote $vote;
sort $vote desc;
limit 3;
fetch { ""title"": $title, ""average_vote"": $vote };"
neoflix,256,List the top 5 movies that made the least revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,262,Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,263,What are the first 3 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,264,List the top 5 movies based on popularity.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,265,Which 3 movies have the least number of votes?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count asc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,268,Name the top 5 movies that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title, c.name
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has popularity $popularity_m;
  $c has collection_name $collection_name_c;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""name"": $collection_name_c
};"
neoflix,270,List 5 movies that have a poster path containing '/rh'.,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rh'
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $poster_path like "".*/rh.*"";
limit 5;
fetch {
  ""title"": $title
};"
neoflix,273,List the top 5 movies that have a homepage URL.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,274,Which 3 movies have the highest popularity but the least revenue?,"MATCH (m:Movie)
WHERE m.popularity IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.popularity, m.revenue
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3","match
  $m isa movie;
  $m has popularity $popularity;
  $m has revenue $revenue;
  $m has title $title;
sort $popularity desc, $revenue asc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity, ""revenue"": $revenue
};"
neoflix,276,What are the first 3 languages spoken in movies with a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN l.name AS language
ORDER BY language
LIMIT 3","match $m isa movie; $l isa language; $rel0 isa spoken_in_language (media: $m, language: $l); $m has budget $budget_m; $l has language_name $language_name_l; $budget_m > 50000000; limit 3; fetch { ""language"": $language_name_l };"
neoflix,278,Name the top 5 movies with 'Animated' as a keyword.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'Animated'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'Animated';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,279,What are the first 3 adult videos by revenue?,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3","match
  $a isa adult_video;
  $a has revenue $revenue;
  $a has title $title;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,280,List the top 5 adult videos by vote count.,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,281,Which 3 adult videos have the longest runtime?,"MATCH (a:Adult)
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has title $title;
  $a has runtime $runtime;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,282,Name the top 5 adult videos with the highest average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,283,"What are the first 3 adult videos with a budget over $500,000?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget > 500000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,284,List the 5 oldest adult videos based on release date.,"MATCH (a:Adult)
WHERE a.release_date IS NOT NULL
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 5","match
  $a isa adult_video;
  $a has release_date $release_date;
  $a has title $title;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,286,Name the top 5 adult videos that were produced in Italy.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN a.title
ORDER BY a.popularity DESC
LIMIT 5","match $a isa adult_video; $country isa country, has country_name 'Italy'; (media: $a, country: $country) isa produced_in_country; $a has title $title; $a has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title };"
neoflix,288,List 5 adult videos with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a.title, a.tagline
LIMIT 5","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline like "".*sex.*"";
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,289,Which 3 adult videos have the most provocative poster paths?,"MATCH (a:Adult)
WHERE a.poster_path IS NOT NULL
RETURN a.title, a.poster_path
ORDER BY a.popularity DESC
LIMIT 3","match
  $a isa adult_video;
  $a has poster_path $poster_path;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
neoflix,290,Name the top 5 adult videos with the least revenue.,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue
LIMIT 5","match
  $a isa adult_video;
  $a has revenue $revenue;
  $a has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,291,List the top 5 adult videos based on popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,293,Name the top 5 subscriptions by the duration of the package they are for.,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package)
RETURN s.id AS subscription_id, p.name AS package_name, p.duration AS package_duration
ORDER BY p.duration DESC
LIMIT 5","match
  $s isa subscription;
  $p isa package;
  $rel0 isa for_package (subscription: $s, package: $p);
  $s has subscription_id $subscription_id_s;
  $p has package_name $package_name_p;
  $p has package_duration $package_duration_p;
sort $package_duration_p desc;
limit 5;
fetch {
  ""subscription_id"": $subscription_id_s, ""package_name"": $package_name_p, ""package_duration"": $package_duration_p
};"
neoflix,294,What are the first 3 packages with the highest price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 3","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_price $package_price;
sort $package_price desc;
limit 3;
fetch {
  ""package"": $package_name, ""price"": $package_price
};"
neoflix,296,Which 3 genres are provided access to by the 'Gold' package?,"MATCH (p:Package {name: 'Gold'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $p isa package, has package_name 'Gold';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,297,Name the top 5 packages that provide access to the 'Animation' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 5","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
  $p has package_price $package_price_p;
sort $package_price_p desc;
limit 5;
fetch {
  ""package"": $package_name_p, ""price"": $package_price_p
};"
neoflix,310,What are the first 3 videos with the highest popularity?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,311,List the top 5 videos with the least revenue.,"MATCH (v:Video)
WHERE v.revenue IS NOT NULL
RETURN v.title, v.revenue
ORDER BY v.revenue
LIMIT 5","match
  $v isa video;
  $v has revenue $revenue;
  $v has title $title;
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,316,What are the top 5 movies with the highest average vote?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,317,List the first 3 movies produced in the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has title $title; limit 3; fetch { ""title"": $title };"
neoflix,318,Which 3 movies have a runtime longer than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,319,Identify the top 5 most popular videos as per the popularity metric.,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,320,What are the first 3 movies directed by a person named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
LIMIT 3","match $p isa person, has person_name 'John Doe'; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $m has title $title_m; limit 3; fetch { ""title"": $title_m };"
neoflix,321,Name the top 5 movies that were released after 2010 and have a budget over 100 million USD.,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.budget > 100000000
RETURN m.title, m.budget, m.release_date
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has budget $budget;
  $budget > 100000000;
  $m has title $title;
sort $budget desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""budget"": $budget };"
neoflix,322,Which 3 movies have more than 5000 vote counts?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,323,Can you list the first 3 genres associated with the movie titled 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,325,List the first 3 languages spoken in the movie titled 'Jumanji'.,"MATCH (m:Movie {title: 'Jumanji'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name
LIMIT 3","match
  $m isa movie, has title 'Jumanji';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
limit 3;
fetch {
  ""name"": $language_name_l
};"
neoflix,327,List the top 5 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $k isa keyword;
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $v has popularity $popularity_v;
  $k has keyword_name $keyword_name_k;
sort $popularity_v desc;
limit 5;
fetch {
  ""keyword"": $keyword_name_k
};"
neoflix,328,What are the first 3 collections that include movies with a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE m.poster_path = '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN c.name
LIMIT 3","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has poster_path $poster_path_m;
  $c has collection_name $collection_name_c;
  $poster_path_m == ""/rhIRbceoE9lR4veEXuwCC2wARtG.jpg"";
limit 3;
fetch {
  ""name"": $collection_name_c
};"
neoflix,329,Name the top 5 persons who have played the character 'Woody' in any movie.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character = 'Woody'
RETURN p.name
ORDER BY m.popularity DESC
LIMIT 5","match
  $p isa person, has person_name $pn;
  $m isa movie, has popularity $pop;
  $cast isa cast_for (actor: $p, film: $m), has character ""Woody"";
sort $pop desc;
limit 5;
fetch { ""name"": $pn };"
neoflix,332,What are the first 3 movies that have a revenue greater than 100 million USD and are in the genre 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Action'})
WHERE m.revenue > 100000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name 'Action';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has revenue $revenue_m;
  $m has title $title_m;
  $revenue_m > 100000000;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,333,Can you list the top 5 adult films with the highest popularity?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,334,Which 3 movies have Tom Hanks as a cast member and have been released after 1995?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
WHERE m.release_date > date('1995-01-01')
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 1995-01-01;
  $p isa person;
  $cast isa cast_for (actor: $p, film: $m);
  $p has person_name ""Tom Hanks"";
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,335,List the first 3 movies in the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,337,What are the first 3 movies with the status 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $status == ""In Production"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,338,List the top 5 movies that have been rated 10 by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 10
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating == 10;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""rating"": $rating, ""popularity"": $popularity };"
neoflix,340,List the first 3 movies that have the keyword 'space' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'space';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,342,Name the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,345,Which 3 movies have the highest revenue and are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has revenue $revenue_m;
sort $revenue_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""revenue"": $revenue_m
};"
neoflix,346,List the first 3 videos that have a budget less than 5000 USD.,"MATCH (v:Video)
WHERE v.budget < 5000
RETURN v.title, v.budget
LIMIT 3","match
  $v isa video;
  $v has budget $budget;
  $v has title $title;
  $budget < 5000;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,347,Name the top 5 most popular movies released before 2000.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
neoflix,348,What are the first 3 movies that have a tagline containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*adventure.*"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,350,Which 3 adult films have the tagline 'Humiliation. Rape. Murder. You know the drill.'?,"MATCH (a:Adult)
WHERE a.tagline = 'Humiliation. Rape. Murder. You know the drill.'
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline == ""Humiliation. Rape. Murder. You know the drill."";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,351,List the first 3 movies that have been produced by 'Pixar Animation Studios' and have a budget over 50 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has budget $budget_m;
  $m has title $title_m;
  $budget_m > 50000000;
sort $budget_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
neoflix,353,What are the first 3 videos that have a runtime shorter than 30 minutes?,"MATCH (v:Video)
WHERE v.runtime < 30
RETURN v.title, v.runtime
ORDER BY v.runtime
LIMIT 3","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 30;
sort $runtime asc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,354,"List the top 5 highest grossing movies that have been released on or after January 1, 2000.","MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 2000-01-01;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""revenue"": $revenue };"
neoflix,356,List the first 3 persons who have directed a movie with a budget over 150 million USD.,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.budget > 150000000
RETURN p.name
LIMIT 3","match $p isa person; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $p has person_name $person_name_p; $m has budget $budget_m; $budget_m > 150000000; limit 3; fetch { ""name"": $person_name_p };"
neoflix,358,What are the first 3 genres associated with the video titled 'Electrical Girl'?,"MATCH (v:Video {title: 'Electrical Girl'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $v isa video, has title 'Electrical Girl';
  $g isa genre;
  $rel0 isa in_genre (media: $v, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,360,Which 3 movies have been produced by a company named 'Warner Bros' and have a revenue over 200 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.name = 'Warner Bros' AND m.revenue > 200000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has revenue $revenue_m;
  $m has title $title_m;
  $c has production_company_name $production_company_name_c;
  $revenue_m > 200000000;
  $production_company_name_c == ""Warner Bros"";
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,361,List the first 3 languages used in movies with an original title 'Toy Story'.,"MATCH (m:Movie {original_title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language
LIMIT 3","match
  $m isa movie, has original_title 'Toy Story';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
limit 3;
fetch {
  ""language"": $language_name_l
};"
neoflix,363,What are the first 3 adult films that have a runtime longer than 90 minutes?,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title
ORDER BY a.title
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 90;
sort $title asc;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,367,What are the first 3 movies with the genre 'Drama' that have a budget less than 10 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
WHERE m.budget < 10000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $budget < 10000000;
  $g isa genre, has genre_name ""Drama"";
  (media: $m, genre: $g) isa in_genre;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""budget"": $budget };"
neoflix,369,Which 3 movies have a production company named 'Lucasfilm' associated with them?,"MATCH (m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany {name: 'Lucasfilm'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Lucasfilm';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,371,Name the top 5 most popular movies according to the vote count.,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,372,What are the first 3 movies that have a homepage URL containing 'disney'?,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $homepage like "".*disney.*"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,373,List the top 5 movies that have been produced by 'Universal Pictures'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Universal Pictures'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Universal Pictures';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,375,List the first 3 adult films that were released in the year 2000 or later.,"MATCH (a:Adult)
WHERE a.release_date >= date('2000-01-01')
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 3","match
  $m isa adult_video;
  $m has release_date $rd;
  $rd >= 2000-01-01;
  $m has title $title;
sort $rd asc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,378,"List the top 5 movies with a release date on or before December 31, 1990.","MATCH (m:Movie)
WHERE m.release_date <= date('1990-12-31')
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd <= 1990-12-31;
  $m has title $title;
sort $rd desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,379,List the top 5 videos that have a tagline including the word 'comedy'.,"MATCH (v:Video)
WHERE v.tagline CONTAINS 'comedy'
RETURN v.title, v.tagline
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has tagline $tagline;
  $v has title $title;
  $v has popularity $popularity;
  $tagline like "".*comedy.*"";
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,381,What are the first 3 movies that have a budget exactly 50 million USD?,"MATCH (m:Movie)
WHERE m.budget = 50000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $budget == 50000000;
  $m has title $title;
limit 3;
fetch { ""title"": $title, ""budget"": $budget };"
neoflix,383,Which 3 movies have an average vote greater than 8 and have been produced in 'France'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'France'})
WHERE m.average_vote > 8
RETURN m.title
LIMIT 3","match $m isa movie; $country isa country, has country_name 'France'; (media: $m, country: $country) isa produced_in_country; $m has average_vote $average_vote; $m has title $title; $average_vote > 8; limit 3; fetch { ""title"": $title };"
neoflix,384,List the top 5 movies that have a runtime exactly 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m.title, m.runtime
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $runtime == 90;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""runtime"": $runtime, ""popularity"": $popularity };"
neoflix,385,Name the top 5 videos that were released in the year 2010 or later.,"MATCH (v:Video)
WHERE v.release_date >= date('2010-01-01')
RETURN v.title
ORDER BY v.popularity DESC
LIMIT 5","match
  $m isa video;
  $m has release_date $rd;
  $rd >= 2010-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
neoflix,387,List the top 5 movies that were part of the 'Toy Story Collection' and have a runtime over 80 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WHERE m.runtime > 80
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $runtime_m > 80;
sort $runtime_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""runtime"": $runtime_m
};"
neoflix,388,Which 3 movies have been produced by 'Pixar Animation Studios' and have a runtime under 100 minutes?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime < 100
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $runtime_m < 100;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,389,List the top 5 highest budget movies in the 'Animation' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has budget $budget_m;
sort $budget_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
neoflix,390,Name the top 5 movies that have the keyword 'jealousy' associated with them.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,391,"What are the first 3 adult films with a budget over 500,000 USD?","MATCH (a:Adult)
WHERE a.budget > 500000
RETURN a.title
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget > 500000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,393,Which 3 videos have a homepage URL containing 'youtube'?,"MATCH (v:Video)
WHERE v.homepage CONTAINS 'youtube'
RETURN v.title
LIMIT 3","match
  $v isa video;
  $v has homepage $homepage;
  $v has title $title;
  $homepage like "".*youtube.*"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,398,Which 3 movies have a vote count over 2000 and a budget under 50 million USD?,"MATCH (m:Movie)
WHERE m.vote_count > 2000 AND m.budget < 50000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has budget $budget;
  $m has title $title;
  $vote_count > 2000;
  $budget < 50000000;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,399,List the first 3 movies that have a revenue over 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $revenue > 500000000;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,400,Name the top 5 most popular movies in the 'Science Fiction' genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Science Fiction'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name 'Science Fiction';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,401,List the first 5 movies with a budget over 20 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 20000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 20000000;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,402,Which 3 movies have the highest average vote above 8.0?,"MATCH (m:Movie)
WHERE m.average_vote > 8.0
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 8.0;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,404,What are the names of the top 3 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title AS movie, m.popularity AS popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
neoflix,405,Who are the first 3 actors cast in the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[:CAST_FOR]-(p:Person)
RETURN p.name
ORDER BY p.id
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $p isa person;
  $rel0 isa cast_for (film: $m, actor: $p);
  $p has person_name $person_name_p;
  $p has person_id $person_id_p;
sort $person_id_p asc;
limit 3;
fetch {
  ""name"": $person_name_p
};"
neoflix,407,List the first 3 countries where movies with a revenue greater than 100 million dollars were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 100000000
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has revenue $revenue_m;
  $c has country_name $country_name_c;
  $revenue_m > 100000000;
limit 3;
fetch {
  ""name"": $country_name_c
};"
neoflix,409,What are the top 5 keywords associated with the movie 'Waiting to Exhale'?,"MATCH (m:Movie {title: 'Waiting to Exhale'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie, has title 'Waiting to Exhale';
  $k isa keyword;
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has popularity $popularity_m;
  $k has keyword_name $keyword_name_k;
sort $popularity_m desc;
limit 5;
fetch {
  ""keyword"": $keyword_name_k
};"
neoflix,412,List the 5 most recent movies that have been added to the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 5","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m
};"
neoflix,415,List the top 5 movies that have been tagged with the keyword 'jealousy'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,416,What are the first 3 genres associated with the movie 'Jonah: A VeggieTales Movie'?,"MATCH (m:Movie {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Jonah: A VeggieTales Movie';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,419,Find the first 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'love'
RETURN m.title, m.tagline
LIMIT 5","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*love.*"";
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,423,List the top 3 most popular videos with a runtime under 90 minutes.,"MATCH (v:Video)
WHERE v.runtime < 90
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $v has popularity $popularity;
  $runtime < 90;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,426,Which 3 movies have the highest revenue and were released in the 'United States of America'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has title $title; $m has revenue $revenue; sort $revenue desc; limit 3; fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,427,List the first 5 movies that are part of a collection and have a revenue greater than 100 million dollars.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.revenue > 100000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie; $collection isa collection; (media: $m, collection: $collection) isa in_collection; $m has revenue $revenue; $m has title $title; $revenue > 100000000; sort $revenue desc; limit 5; fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,429,Name the first 3 adult films with the highest average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,431,List the top 5 movies that have been rated by users more than 1000 times.,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 1000;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,433,Which 3 movies have the longest runtime and were released after 2000?,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2000-01-01;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""runtime"": $runtime };"
neoflix,435,Name the first 5 genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 5","match
  $m isa movie, has title 'Toy Story';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 5;
fetch {
  ""name"": $genre_name_g
};"
neoflix,436,What are the 3 most popular movies in the genre 'Animation'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,438,List the first 5 movies that were produced in the country 'United States of America' and have a revenue over 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WHERE m.revenue > 50000000
RETURN m.title, m.revenue
LIMIT 5","match $m isa movie; $country isa country, has country_name 'United States of America'; (media: $m, country: $country) isa produced_in_country; $m has revenue $revenue; $m has title $title; $revenue > 50000000; limit 5; fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,440,Name the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget above 50 million dollars.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 50000000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has budget $budget_m;
  $m has title $title_m;
  $budget_m > 50000000;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,442,List the top 5 movies that have a runtime longer than 150 minutes and were released before 2010.,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.release_date < date('2010-01-01')
RETURN m.title, m.runtime, m.release_date
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2010-01-01;
  $m has runtime $runtime;
  $runtime > 150;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""runtime"": $runtime };"
neoflix,443,What are the first 3 genres associated with the movie 'Father of the Bride Part II'?,"MATCH (m:Movie {title: 'Father of the Bride Part II'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Father of the Bride Part II';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,446,Name the first 5 movies that have a homepage URL associated.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
limit 5;
fetch {
  ""title"": $title
};"
neoflix,447,What are the 3 most popular movies in the genre 'Comedy'?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  (media: $m, genre: $g) isa in_genre;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch { ""title"": $title, ""popularity"": $popularity };"
neoflix,449,List the first 5 movies that have a tagline and were released after 2010.,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m.title, m.tagline, m.release_date
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd > 2010-01-01;
  $m has title $title;
  $m has tagline $tagline;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd, ""tagline"": $tagline };"
neoflix,451,Name the first 3 adult films that were produced in the country 'Italy'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN a.title
LIMIT 3","match $a isa adult_video; $country isa country, has country_name 'Italy'; (media: $a, country: $country) isa produced_in_country; $a has title $title; limit 3; fetch { ""title"": $title };"
neoflix,453,List the top 5 highest revenue generating movies of all time.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,454,What are the first 3 genres associated with the video 'Jonah: A VeggieTales Movie'?,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $g isa genre;
  $rel0 isa in_genre (media: $v, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,455,Which 3 movies have the lowest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote IS NOT NULL
RETURN m.title, m.average_vote, m.release_date
ORDER BY m.average_vote
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has title $title;
  $m has average_vote $av;
sort $av asc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""average_vote"": $av };"
neoflix,456,List the top 5 movies with the longest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,458,What are the 3 most popular movies that have been released since 2015?,"MATCH (m:Movie)
WHERE m.release_date >= date('2015-01-01') AND m.popularity IS NOT NULL
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 2015-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch { ""title"": $title, ""release_date"": $rd, ""popularity"": $popularity };"
neoflix,460,List the first 5 videos that have a runtime under 60 minutes.,"MATCH (v:Video)
WHERE v.runtime < 60
RETURN v.title, v.runtime
LIMIT 5","match
  $v isa video;
  $v has runtime $runtime;
  $v has title $title;
  $runtime < 60;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,464,List the top 5 movies that have been part of at least one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match $m isa movie; $collection isa collection; (media: $m, collection: $collection) isa in_collection; $m has title $title; $m has popularity $popularity; sort $popularity desc; limit 5; fetch { ""title"": $title, ""popularity"": $popularity };"
neoflix,465,What are the first 3 genres associated with the movie 'Alex & Emma'?,"MATCH (m:Movie {title: 'Alex & Emma'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Alex & Emma';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,466,Which 3 movies have the highest vote count?,"MATCH (m:Movie)
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has vote_count $vote_count;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,467,List the top 5 adult films with the highest popularity.,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,468,Name the first 5 movies that have a release date before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01')
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd < 1990-01-01;
  $m has title $title;
limit 5;
fetch { ""title"": $title, ""release_date"": $rd };"
neoflix,469,What are the 3 most popular movies in the genre 'Thriller'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Thriller'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name 'Thriller';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,471,List the first 5 videos that were produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 5","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
limit 5;
fetch {
  ""title"": $title_v
};"
neoflix,473,Name the first 3 adult films that have a runtime longer than 90 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 90
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 90;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,474,Which 3 keywords are most commonly associated with movies that have an original language of 'en'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.original_language = 'en'
RETURN k.name, count(*) as count
ORDER BY count DESC
LIMIT 3","match
$m isa movie;
$k isa keyword;
has_keyword (media: $m, keyword: $k);
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
reduce $count = count groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
neoflix,475,Name the first 3 movies that have a poster path ending in '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'
RETURN m.title
LIMIT 3","match
  $m isa movie, has title $title, has poster_path $path;
  $path like "".*pQFoyx7rp09CJTAb932F2g8Nlho.jpg"";
limit 3;
fetch { ""title"": $title };"
neoflix,476,What are the first 3 genres associated with the movie 'Nil Battey Sannata'?,"MATCH (m:Movie {title: 'Nil Battey Sannata'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $m isa movie, has title 'Nil Battey Sannata';
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,477,Which 3 movies have the highest revenue and were released in the 'United Kingdom'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United Kingdom'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie; $country isa country, has country_name 'United Kingdom'; (media: $m, country: $country) isa produced_in_country; $m has title $title; $m has revenue $revenue; sort $revenue desc; limit 3; fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,478,Which movies have a revenue greater than 50 million USD?,"MATCH (m:Movie)
WHERE m.revenue > 50000000
RETURN m.title, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
  $revenue > 50000000;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,479,List all movies where Tom Hanks acted in.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,480,What are the top 5 most popular movies?,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,481,Which movies are part of the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,482,List all movies produced by 'Pixar Animation Studios'.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,483,What are the names of genres associated with movies having a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name","match
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has budget $budget_m;
  $g has genre_name $genre_name_g;
  $budget_m > 100000000;
fetch {
  ""name"": $genre_name_g
};"
neoflix,484,Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
  $u isa user, has user_id 1;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
  $m has title $title_m;
fetch {
  ""movie"": $title_m, ""rating"": $rating
};"
neoflix,485,What are the most recent three movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,486,List the movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,487,Which movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,488,Find all movies released before 2000 with an average vote greater than 8.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote > 8
RETURN m","match
  $m isa movie, has title $title;
  $m has release_date $rd;
  $rd < 2000-01-01;
  $m has average_vote $av;
  $av > 8;
limit 50;
fetch { ""title"": $title, ""release_date"": $rd, ""average_vote"": $av };"
neoflix,489,List all languages spoken in the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language","match
  $m isa movie, has title 'Toy Story';
  $l isa language;
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $l has language_name $language_name_l;
fetch {
  ""language"": $language_name_l
};"
neoflix,490,What are the original titles of movies that have been translated into Spanish?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'})
WHERE m.original_language <> 'es'
RETURN m.original_title","match
$m isa movie, has original_title $original_title;
spoken_in_language (media: $m, language: $spanish);
$spanish has language_name ""Spanish"";
original_language (media: $m, language: $orig_lang);
not { $orig_lang has language_id ""es""; };
fetch {
  ""original_title"": $original_title
};"
neoflix,491,Which countries have produced movies with a budget exceeding 10 million USD?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.budget > 10000000
RETURN DISTINCT c.name AS country","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has budget $budget_m;
  $c has country_name $country_name_c;
  $budget_m > 10000000;
fetch {
  ""country"": $country_name_c, ""name"": $country_name_c
};"
neoflix,492,List the names of all production companies involved with movies that grossed over 200 million USD.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE m.revenue > 200000000
RETURN DISTINCT c.name","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has revenue $revenue_m;
  $c has production_company_name $production_company_name_c;
  $revenue_m > 200000000;
fetch {
  ""name"": $production_company_name_c
};"
neoflix,495,What are the top 3 most voted movies in the database?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,496,Which movies have a poster path containing '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/rhIRbceoE9lR4veEXuwCC2wARtG.jpg'
RETURN m.title","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $poster_path == ""/rhIRbceoE9lR4veEXuwCC2wARtG.jpg"";
fetch {
  ""title"": $title
};"
neoflix,497,What are the names of people who have directed movies with a budget over 50 million USD?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.budget > 50000000
RETURN DISTINCT p.name","match $p isa person; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $p has person_name $person_name_p; $m has budget $budget_m; $budget_m > 50000000; fetch { ""name"": $person_name_p };"
neoflix,499,List all movies that are part of any collection and have a revenue less than 1 million USD.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.revenue < 1000000
RETURN m.title, m.revenue","match $m isa movie; $collection isa collection; (media: $m, collection: $collection) isa in_collection; $m has revenue $revenue; $m has title $title; $revenue < 1000000; fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,500,What are the names of all genres represented in the 'Toy Story Collection'?,"MATCH (c:Collection {name: 'Toy Story Collection'})<-[:IN_COLLECTION]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name","match
  $c isa collection, has collection_name 'Toy Story Collection';
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $rel1 isa in_collection (collection: $c, media: $m);
  $g has genre_name $genre_name_g;
fetch {
  ""name"": $genre_name_g
};"
neoflix,501,Which movies have an IMDb ID of 'tt0114709'?,"MATCH (m:Movie {imdb_id: 'tt0114709'})
RETURN m.title","match
  $m isa movie, has imdb_id 'tt0114709';
  $m has title $title;
fetch {
  ""title"": $title
};"
neoflix,502,What are the top 5 movies by revenue in descending order?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,503,List the movies with a tagline that includes 'excitement'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'excitement'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*excitement.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,505,List all movies that have a homepage URL defined.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,506,Which movies have been released with a status of 'In Production'?,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title, m.release_date, m.status","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $m has release_date $release_date;
  $status == ""In Production"";
fetch {
  ""title"": $title, ""release_date"": $release_date, ""status"": $status
};"
neoflix,507,Which movies have a runtime that is exactly 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime = 90
RETURN m.title","match
  $m isa movie;
  $m has runtime $runtime;
  $runtime == 90;
  $m has title $title;
fetch { ""title"": $title, ""runtime"": $runtime };"
neoflix,508,What are the top 3 most voted movies in the database?,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie, has title $title, has vote_count $votes;
sort $votes desc;
limit 3;
fetch { ""title"": $title, ""vote_count"": $votes };"
neoflix,513,What are the movies with a vote count greater than 5000?,"MATCH (m:Movie)
WHERE m.vote_count > 5000
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count > 5000;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,517,List the movies where the spoken language is 'Gaeilge'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_name 'Gaeilge';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,518,Which movies have a backdrop path of '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {backdrop_path: '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'})
RETURN m.title","match
  $m isa movie;
  $c isa collection, has backdrop_path '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,519,What are the three oldest movies in the database?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,520,List movies that are part of a genre with ID 10770.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {id: 10770})
RETURN m.title","match
  $m isa movie;
  $g isa genre, has genre_id 10770;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,521,Which movies have a status of 'Released' and a budget greater than 25 million USD?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget > 25000000
RETURN m.title, m.budget, m.status","match
  $m isa movie;
  $m has status $status;
  $m has budget $budget;
  $m has title $title;
  $budget > 25000000;
  $status == ""Released"";
fetch {
  ""title"": $title, ""budget"": $budget, ""status"": $status
};"
neoflix,525,List the movies that have been rated exactly 5.0.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title","match
  $m isa movie;
  $u isa user;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating == 5.0;
  $m has title $title;
fetch { ""title"": $title, ""rating"": $rating };"
neoflix,526,What are the movies directed by 'Christopher Nolan'?,"MATCH (p:Person {name: 'Christopher Nolan'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title","match $p isa person, has person_name 'Christopher Nolan'; $m isa movie; $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director""; $m has title $title_m; fetch { ""title"": $title_m };"
neoflix,530,List all movies that have a revenue of zero but have been highly rated.,"MATCH (m:Movie)
WHERE m.revenue = 0 AND m.average_vote >= 7.0
RETURN m.title, m.average_vote, m.revenue","match
  $m isa movie;
  $m has revenue $revenue;
  $revenue == 0;
  $m has title $title;
  $m has average_vote $av;
  $av >= 7.0;
fetch { ""title"": $title, ""revenue"": $revenue, ""average_vote"": $av };"
neoflix,531,Which movies have been associated with the keyword 'high school' and have an average vote above 6?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'high school'})
WHERE m.average_vote > 6
RETURN m.title, m.average_vote","match
  $m isa movie;
  $k isa keyword, has keyword_name 'high school';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has average_vote $average_vote_m;
  $m has title $title_m;
  $average_vote_m > 6;
fetch {
  ""title"": $title_m, ""average_vote"": $average_vote_m
};"
neoflix,532,What are the top 5 longest movies in the database?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,534,Which movies have been produced by 'Warner Bros.' and have a revenue over 500 million USD?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Warner Bros.'})
WHERE m.revenue > 500000000
RETURN m.title, m.revenue","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Warner Bros.';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has revenue $revenue_m;
  $m has title $title_m;
  $revenue_m > 500000000;
fetch {
  ""title"": $title_m, ""revenue"": $revenue_m
};"
neoflix,535,What are the three most recent movies that have a tagline?,"MATCH (m:Movie)
WHERE m.tagline IS NOT NULL
RETURN m.title, m.tagline, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline, ""release_date"": $release_date
};"
neoflix,536,List all movies that have an average_vote less than 3.,"MATCH (m:Movie)
WHERE m.average_vote < 3
RETURN m","match
  $m isa movie, has title $title;
  $m has average_vote $av;
  $av < 3;
limit 50;
fetch { ""title"": $title, ""average_vote"": $av };"
neoflix,537,Which movies have been involved in a collection with a backdrop path containing '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE c.backdrop_path = '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title","match
  $m isa movie;
  $c isa collection;
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $c has backdrop_path $backdrop_path_c;
  $backdrop_path_c == ""/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg"";
fetch {
  ""title"": $title_m
};"
neoflix,539,Which movies have been spoken in 'Kiswahili'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,540,What are the movies where 'Brad Pitt' has acted?,"MATCH (p:Person {name: 'Brad Pitt'})-[:CAST_FOR]->(m:Movie)
RETURN m.title","match
  $p isa person, has person_name 'Brad Pitt';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,541,Which movies have an overview that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE m.overview CONTAINS 'adventure'
RETURN m.title, m.overview","match
  $m isa movie;
  $m has overview $overview;
  $m has title $title;
  $overview like "".*adventure.*"";
fetch {
  ""title"": $title, ""overview"": $overview
};"
neoflix,544,What are the movies with a vote count less than 50?,"MATCH (m:Movie)
WHERE m.vote_count < 50
RETURN m.title, m.vote_count","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $vote_count < 50;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,545,List the movies where the original language is not English.,"MATCH (m:Movie)
WHERE m.original_language <> 'en'
RETURN m.title, m.original_language","match
$m isa movie, has title $title;
original_language (media: $m, language: $lang);
$lang has language_id $lang_id;
not { $lang_id == ""en""; };
fetch {
  ""title"": $title,
  ""language"": $lang_id
};"
neoflix,546,Which movies have a popularity score above 15?,"MATCH (m:Movie)
WHERE m.popularity > 15
RETURN m.title, m.popularity","match
  $m isa movie;
  $m has popularity $popularity;
  $m has title $title;
  $popularity > 15;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,547,What are the top 5 movies with the smallest budget?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
sort $budget asc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,548,List all movies that have a runtime greater than 150 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m.title, m.runtime","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 150;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,549,Which movies have been tagged with the keyword 'romance'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'romance'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'romance';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,551,List the movies with a revenue exceeding 100 million USD and a popularity below 10.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.popularity < 10
RETURN m.title, m.revenue, m.popularity","match
  $m isa movie;
  $m has revenue $revenue;
  $m has popularity $popularity;
  $m has title $title;
  $revenue > 100000000;
  $popularity < 10;
fetch {
  ""title"": $title, ""revenue"": $revenue, ""popularity"": $popularity
};"
neoflix,552,Which movies have a status of 'Released' and an average vote less than 4?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote < 4
RETURN m.title, m.average_vote","match
  $m isa movie;
  $m has status $status;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote < 4;
  $status == ""Released"";
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,555,Which movies have a tagline that includes 'surprise'?,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'surprise'
RETURN m.title, m.tagline","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*surprise.*"";
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,558,Which movies have a runtime less than 80 minutes and a budget over 20 million USD?,"MATCH (m:Movie)
WHERE m.runtime < 80 AND m.budget > 20000000
RETURN m.title, m.runtime, m.budget","match
  $m isa movie;
  $m has runtime $runtime;
  $m has budget $budget;
  $m has title $title;
  $runtime < 80;
  $budget > 20000000;
fetch {
  ""title"": $title, ""runtime"": $runtime, ""budget"": $budget
};"
neoflix,559,What are the top 3 movies by average vote in the database?,"MATCH (m:Movie)
WHERE m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,561,Which movies have a poster path containing '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg'
RETURN m.title","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $poster_path == ""/eoWvKD60lT95Ss1MYNgVExpo5iU.jpg"";
fetch {
  ""title"": $title
};"
neoflix,565,List the movies that have been tagged with the keyword 'explosive'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'explosive'})
RETURN m.title","match
  $m isa movie;
  $k isa keyword, has keyword_name 'explosive';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
fetch {
  ""title"": $title_m
};"
neoflix,568,What are the three highest budget movies produced by 'Disney'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE c.name CONTAINS 'Disney'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company;
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has budget $budget_m;
  $c has production_company_name $production_company_name_c;
  $production_company_name_c like "".*Disney.*"";
sort $budget_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
neoflix,569,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,570,List 3 movies that have a runtime greater than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,572,Find 3 movies that have 'Toy Story' in their title.,"MATCH (m:Movie)
WHERE m.title CONTAINS 'Toy Story'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $title like "".*Toy Story.*"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,573,What are the top 5 highest budget movies?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,578,List the 3 most recent movies in the 'Toy Story Collection'.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title, m.release_date
ORDER BY m.release_date DESC
LIMIT 3","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m
};"
neoflix,580,What are the first 3 keywords associated with the movie 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3","match
  $m isa movie, has title 'Toy Story';
  $k isa keyword;
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $k has keyword_name $keyword_name_k;
limit 3;
fetch {
  ""name"": $keyword_name_k
};"
neoflix,582,List the top 5 most popular movies according to their popularity score.,"MATCH (m:Movie)
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,583,What are the 3 longest movies in terms of runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has runtime $runtime;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,584,Which 3 movies have the highest average vote and more than 1000 votes?,"MATCH (m:Movie)
WHERE m.vote_count > 1000
RETURN m.title, m.average_vote, m.vote_count
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
  $m has average_vote $average_vote;
  $vote_count > 1000;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""vote_count"": $vote_count
};"
neoflix,586,Which 5 movies have been tagged with the keyword 'jealousy'?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,591,List the top 5 adult films by average vote.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,592,Which 3 adult films have the highest budget?,"MATCH (a:Adult)
WHERE a.budget IS NOT NULL
RETURN a.title, a.budget
ORDER BY a.budget DESC
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,597,List the first 3 video titles that have been produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 3","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has title $title_v;
limit 3;
fetch {
  ""title"": $title_v
};"
neoflix,598,Which 3 videos have the highest popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,599,What are the 3 longest videos in terms of runtime?,"MATCH (v:Video)
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3","match
  $v isa video;
  $v has title $title;
  $v has runtime $runtime;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,601,Which 3 collections include videos with an average vote above 7?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(v:Video)
WHERE v.average_vote > 7
RETURN c.name AS collection, avg(v.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  $m isa video;
  (media: $m, collection: $c) isa in_collection;
  $m has average_vote $av;
  $av > 7;
limit 30;
fetch { ""collection"": $cn };"
neoflix,603,List the first 3 packages that offer access to the 'Animation' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Animation'})
RETURN p.name AS package
LIMIT 3","match
  $p isa package;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 3;
fetch {
  ""package"": $package_name_p
};"
neoflix,604,Which 3 subscriptions will expire the soonest?,"MATCH (s:Subscription)
RETURN s
ORDER BY s.expiresAt
LIMIT 3","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
sort $exp asc;
limit 3;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
neoflix,605,What are the top 5 most expensive packages by price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 5","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_price $package_price;
sort $package_price desc;
limit 5;
fetch {
  ""package"": $package_name, ""price"": $package_price
};"
neoflix,606,List the first 3 genres that are accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $p isa package, has package_name 'Ultimate';
  $g isa genre;
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $g has genre_name $genre_name_g;
limit 3;
fetch {
  ""name"": $genre_name_g
};"
neoflix,611,List the first 3 video titles that have been produced by 'Pixar Animation Studios'.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN v.title
LIMIT 3","match
  $v isa video, has title $title;
  $pc isa production_company, has production_company_name ""Pixar Animation Studios"";
  (media: $v, producer: $pc) isa produced_by;
limit 3;
fetch { ""title"": $title };"
neoflix,612,List the first 3 adult films with a tagline containing the word 'sex'.,"MATCH (a:Adult)
WHERE a.tagline CONTAINS 'sex'
RETURN a.title, a.tagline
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline like "".*sex.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,617,What are the top 5 original titles of movies with an original language of 'en'?,"MATCH (m:Movie {original_language: 'en'})
RETURN m.original_title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie, has original_title $original_title, has popularity $popularity;
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
sort $popularity desc;
limit 5;
fetch {
  ""original_title"": $original_title
};"
neoflix,620,List the first 3 genres that are accessed by the 'Ultimate' package.,"MATCH (p:Package {name: 'Ultimate'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name
LIMIT 3","match
  $p isa package, has package_name ""Ultimate"";
  (package: $p, genre: $g) isa provides_access_to;
  $g has genre_name $name;
limit 3;
fetch { ""name"": $name };"
neoflix,623,What are the top 5 movies with the smallest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,630,List the first 3 movies in which 'Tom Hanks' has acted.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $rel0 isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,632,What are the top 5 most popular adult films?,"MATCH (a:Adult)
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,633,List the first 3 keywords associated with the video titled 'Jonah: A VeggieTales Movie'.,"MATCH (v:Video {title: 'Jonah: A VeggieTales Movie'})-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name
LIMIT 3","match
  $v isa video, has title 'Jonah: A VeggieTales Movie';
  $k isa keyword;
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $k has keyword_name $keyword_name_k;
limit 3;
fetch {
  ""name"": $keyword_name_k
};"
neoflix,635,What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.release_date
ORDER BY m.release_date
LIMIT 5","match
  $m isa movie;
  $m has title $title;
  $m has release_date $release_date;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,636,List the first 3 movies with taglines containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.tagline CONTAINS 'adventure'
RETURN m.title, m.tagline
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $tagline like "".*adventure.*"";
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,637,Which 3 adult films have the lowest average vote?,"MATCH (a:Adult)
RETURN a.title, a.average_vote
ORDER BY a.average_vote
LIMIT 3","match
  $a isa adult_video;
  $a has title $title;
  $a has average_vote $average_vote;
sort $average_vote asc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,638,List the first 3 genres that have movies with no keywords associated.,"MATCH (g:Genre)
WHERE NOT EXISTS {
  (g)<-[:IN_GENRE]-(:Movie)-[:HAS_KEYWORD]->(:Keyword)
}
RETURN g.name
LIMIT 3","match
  $g isa genre, has genre_name $name;
  (media: $m, genre: $g) isa in_genre;
  $m isa movie;
  not { (media: $m, keyword: $k) isa has_keyword; };
limit 3;
fetch { ""name"": $name };"
neoflix,647,What are the top 5 videos by vote count?,"MATCH (v:Video)
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,648,List the first 3 movies that have been both highly rated and have high revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.average_vote IS NOT NULL
RETURN m.title, m.revenue, m.average_vote
ORDER BY m.average_vote DESC, m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has revenue $revenue;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc, $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue, ""average_vote"": $average_vote
};"
neoflix,650,What are the top 5 adult films by vote count?,"MATCH (a:Adult)
RETURN a.title, a.vote_count
ORDER BY a.vote_count DESC
LIMIT 5","match
  $a isa adult_video;
  $a has title $title;
  $a has vote_count $vote_count;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,654,List the first 3 movies that were produced by 'Pixar Animation Studios' and have a budget over $100 million.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has budget $budget_m;
  $m has title $title_m;
  $budget_m > 100000000;
sort $budget_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""budget"": $budget_m
};"
neoflix,656,List the first 3 adult films with a runtime longer than 60 minutes.,"MATCH (a:Adult)
WHERE a.runtime > 60
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has runtime $runtime;
  $a has title $title;
  $runtime > 60;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,658,What are the top 5 longest running movies in the database?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,662,List the first 3 packages that provide access to the 'Drama' genre.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p.name AS package
LIMIT 3","match
  $p isa package;
  $g isa genre, has genre_name 'Drama';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 3;
fetch {
  ""package"": $package_name_p
};"
neoflix,664,What are the top 5 most popular packages based on duration?,"MATCH (p:Package)
RETURN p.name AS package, p.duration AS duration
ORDER BY duration DESC
LIMIT 5","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_duration $package_duration;
limit 5;
fetch {
  ""package"": $package_name, ""duration"": $package_duration
};"
neoflix,665,List the first 3 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title, m.homepage
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,667,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,668,List the first 3 movies where the budget was over 50 million USD.,"MATCH (m:Movie)
WHERE m.budget > 50000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 50000000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,669,Which 5 movies have the highest average vote and have been released?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.average_vote IS NOT NULL
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has status $status;
  $m has average_vote $average_vote;
  $m has title $title;
  $status == ""Released"";
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,670,Find the top 3 movies that have a runtime longer than 120 minutes.,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime > 120;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,671,What are the first 5 most popular movies with a popularity score above 20?,"MATCH (m:Movie)
WHERE m.popularity > 20
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has popularity $popularity;
  $m has title $title;
  $popularity > 20;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,672,List the top 3 movies that were released before the year 2000 and have an 'original_language' of 'en'.,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.original_language = 'en'
RETURN m.title, m.release_date, m.original_language
ORDER BY m.release_date DESC
LIMIT 3","match
$m isa movie, has title $title, has release_date $release_date;
original_language (media: $m, language: $lang);
$lang has language_id $lang_id;
$lang_id == ""en"";
$release_date < 2000-01-01;
sort $release_date desc;
limit 3;
fetch {
  ""title"": $title,
  ""release_date"": $release_date,
  ""language"": $lang_id
};"
neoflix,674,List the first 3 movies with the highest number of votes.,"MATCH (m:Movie)
WHERE m.vote_count IS NOT NULL
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $m has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,675,What are the top 5 movies with the lowest revenue and are still in 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match
  $m isa movie;
  $m has status $status;
  $m has revenue $revenue;
  $m has title $title;
  $status == ""Released"";
sort $revenue asc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,676,Which 3 movies have the longest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released'
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $m has runtime $runtime;
  $status == ""Released"";
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,677,List the top 3 movies with the largest budgets that have been released.,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has budget $budget;
  $m has title $title;
  $status == ""Released"";
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,679,Which 3 movies have the highest popularity but the lowest revenue?,"MATCH (m:Movie)
WHERE m.popularity IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.popularity, m.revenue
ORDER BY m.popularity DESC, m.revenue ASC
LIMIT 3","match
  $m isa movie;
  $m has popularity $popularity;
  $m has revenue $revenue;
  $m has title $title;
sort $popularity desc, $revenue asc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity, ""revenue"": $revenue
};"
neoflix,682,List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!',"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m.title
LIMIT 3","match
  $m isa movie, has tagline 'Roll the dice and unleash the excitement!';
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,684,Find the top 3 movies with a specific actor named 'Tom Hanks' in the cast.,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CAST_FOR]->(m:Movie)
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $p isa person, has person_name 'Tom Hanks';
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m);
  $m has title $title_m;
  $m has release_date $release_date_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m, ""popularity"": $popularity_m
};"
neoflix,685,What are the top 5 movies that were produced by 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,686,List the first 3 movies that have been translated into the language 'Kiswahili'.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Kiswahili'})
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Kiswahili';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,687,Which 3 movies are most commonly spoken in 'Gaeilge'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Gaeilge'})
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name 'Gaeilge';
  $rel0 isa spoken_in_language (media: $m, language: $l);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,689,What are the first 5 movies in the 'Toy Story Collection'?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
  $m isa movie;
  $c isa collection, has collection_name 'Toy Story Collection';
  $rel0 isa in_collection (media: $m, collection: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
sort $release_date_m asc;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,690,Which 3 movies have the most expensive poster paths registered?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL
RETURN m.title, m.poster_path
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $m has title $title;
  $m has budget $budget;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
neoflix,691,List the top 3 movies where the homepage URL includes 'disney'.,"MATCH (m:Movie)
WHERE m.homepage CONTAINS 'disney'
RETURN m.title, m.homepage
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
  $m has popularity $popularity;
  $homepage like "".*disney.*"";
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,693,List the first 3 movies that have an 'average_vote' greater than 8.,"MATCH (m:Movie)
WHERE m.average_vote > 8
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 8;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,694,Which 5 movies have the shortest runtime and are in the 'Released' status?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
  $m isa movie;
  $m has status $status;
  $m has runtime $runtime;
  $m has title $title;
  $status == ""Released"";
sort $runtime asc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,695,List the top 3 movies with the tagline 'What price would you put on your health?',"MATCH (m:Movie)
WHERE m.tagline = 'What price would you put on your health?'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has tagline $tagline;
  $m has title $title;
  $m has popularity $popularity;
  $tagline == ""What price would you put on your health?"";
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,697,List the top 3 movies that were produced by 'Pixar Animation Studios' and have a runtime longer than 90 minutes.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE m.runtime > 90
RETURN m.title, m.runtime
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has runtime $runtime_m;
  $m has title $title_m;
  $m has popularity $popularity_m;
  $runtime_m > 90;
sort $popularity_m desc;
limit 3;
fetch {
  ""title"": $title_m, ""runtime"": $runtime_m
};"
neoflix,699,List the first 3 movies that have a 'status' of 'In Production'.,"MATCH (m:Movie)
WHERE m.status = 'In Production'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has status $status;
  $m has title $title;
  $status == ""In Production"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,702,Which 5 videos have the highest average vote and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.average_vote
ORDER BY v.average_vote DESC
LIMIT 5","match
  $v isa video;
  $v has status $status;
  $v has title $title;
  $v has average_vote $average_vote;
  $status == ""Released"";
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,703,List the first 3 videos with a budget greater than 100000 USD.,"MATCH (v:Video)
WHERE v.budget > 100000
RETURN v.title, v.budget
ORDER BY v.budget DESC
LIMIT 3","match
  $v isa video;
  $v has budget $budget;
  $v has title $title;
  $budget > 100000;
sort $budget desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,705,List the top 3 videos that have the most votes.,"MATCH (v:Video)
WHERE v.vote_count IS NOT NULL
RETURN v.title, v.vote_count
ORDER BY v.vote_count DESC
LIMIT 3","match
  $v isa video;
  $v has vote_count $vote_count;
  $v has title $title;
sort $vote_count desc;
limit 3;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,706,Which 3 videos have the longest runtime and are in the 'Released' status?,"MATCH (v:Video)
WHERE v.status = 'Released'
RETURN v.title, v.runtime
ORDER BY v.runtime DESC
LIMIT 3","match
  $v isa video;
  $v has status $status;
  $v has title $title;
  $v has runtime $runtime;
  $status == ""Released"";
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,707,List the first 5 videos that have been translated into the language 'Azrbaycan'.,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language {name: 'Azrbaycan'})
RETURN v.title
LIMIT 5","match
  $v isa video;
  $l isa language, has language_name 'Azrbaycan';
  $rel0 isa spoken_in_language (media: $v, language: $l);
  $v has title $title_v;
limit 5;
fetch {
  ""title"": $title_v
};"
neoflix,708,What are the first 3 videos with a 'status' of 'In Production'?,"MATCH (v:Video)
WHERE v.status = 'In Production'
RETURN v.title
LIMIT 3","match
  $v isa video;
  $v has status $status;
  $v has title $title;
  $status == ""In Production"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,709,Which 3 adult films have the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,710,List the first 3 adult films with a budget less than 50000 USD.,"MATCH (a:Adult)
WHERE a.budget < 50000
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has budget $budget;
  $a has title $title;
  $budget < 50000;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,712,List the top 3 adult films that have been tagged with the keyword 'jealousy'.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword {name: 'jealousy'})
RETURN a.title, a.popularity
ORDER BY a.popularity DESC
LIMIT 3","match
  $a isa adult_video;
  $k isa keyword, has keyword_name 'jealousy';
  $rel0 isa has_keyword (media: $a, keyword: $k);
  $a has title $title_a;
  $a has popularity $popularity_a;
sort $popularity_a desc;
limit 3;
fetch {
  ""title"": $title_a, ""popularity"": $popularity_a
};"
neoflix,713,Which 3 adult films have the longest runtime and are in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.runtime
ORDER BY a.runtime DESC
LIMIT 3","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $a has runtime $runtime;
  $status == ""Released"";
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,714,List the first 5 adult films that have a homepage URL.,"MATCH (a:Adult)
WHERE a.homepage IS NOT NULL
RETURN a.title, a.homepage
LIMIT 5","match
  $a isa adult_video;
  $a has homepage $homepage;
  $a has title $title;
limit 5;
fetch {
  ""title"": $title, ""homepage"": $homepage
};"
neoflix,721,Which 3 packages have the highest price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 3","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_price $package_price;
sort $package_price desc;
limit 3;
fetch {
  ""package"": $package_name, ""price"": $package_price
};"
neoflix,723,What are the first 3 subscriptions that are about to expire?,"MATCH (s:Subscription)
RETURN s
ORDER BY s.expiresAt
LIMIT 3","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
sort $exp asc;
limit 3;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
neoflix,734,List the first 3 movies that have a specific keyword 'adventure' and are in the 'Released' status.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
WHERE m.status = 'Released'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $k isa keyword, has keyword_name 'adventure';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has status $status_m;
  $m has title $title_m;
  $status_m == ""Released"";
limit 3;
fetch {
  ""title"": $title_m
};"
neoflix,737,Which 3 packages have the highest price?,"MATCH (p:Package)
RETURN p.name AS package, p.price AS price
ORDER BY p.price DESC
LIMIT 3","match
  $p isa package, has package_name $name, has package_price $price;
sort $price desc;
limit 3;
fetch { ""package"": $name, ""price"": $price };"
neoflix,738,List the first 3 videos that have a specific keyword 'action' and are in the 'Released' status.,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword {name: 'action'})
WHERE v.status = 'Released'
RETURN v.title, v.release_date, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $k isa keyword, has keyword_name 'action';
  $rel0 isa has_keyword (media: $v, keyword: $k);
  $v has status $status_v;
  $v has title $title_v;
  $v has release_date $release_date_v;
  $v has popularity $popularity_v;
  $status_v == ""Released"";
sort $popularity_v desc;
limit 3;
fetch {
  ""title"": $title_v, ""release_date"": $release_date_v, ""popularity"": $popularity_v
};"
neoflix,739,What are the top 5 adult films with the lowest vote count and are still in the 'Released' status?,"MATCH (a:Adult)
WHERE a.status = 'Released'
RETURN a.title, a.vote_count
ORDER BY a.vote_count
LIMIT 5","match
  $a isa adult_video;
  $a has status $status;
  $a has title $title;
  $a has vote_count $vote_count;
  $status == ""Released"";
sort $vote_count asc;
limit 5;
fetch {
  ""title"": $title, ""vote_count"": $vote_count
};"
neoflix,740,List the first 3 movies that have an original language of 'es' and are in the 'Released' status.,"MATCH (m:Movie)
WHERE m.original_language = 'es' AND m.status = 'Released'
RETURN m.title
LIMIT 3","match
$m isa movie, has title $title, has status $status;
original_language (media: $m, language: $lang);
$lang has language_id ""es"";
$status == ""Released"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,743,What are the first 5 packages that provide access to the genre 'Drama'?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre {name: 'Drama'})
RETURN p.name AS package
LIMIT 5","match
  $p isa package;
  $g isa genre, has genre_name 'Drama';
  $rel0 isa provides_access_to (package: $p, genre: $g);
  $p has package_name $package_name_p;
limit 5;
fetch {
  ""package"": $package_name_p
};"
neoflix,746,List the top 3 videos that have been produced by 'Pixar Animation Studios' and have a runtime shorter than 50 minutes.,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
WHERE v.runtime < 50
RETURN v.title, v.runtime
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $v, producer: $c);
  $v has runtime $runtime_v;
  $v has title $title_v;
  $v has popularity $popularity_v;
  $runtime_v < 50;
sort $popularity_v desc;
limit 3;
fetch {
  ""title"": $title_v, ""runtime"": $runtime_v
};"
neoflix,748,List the first 3 adult films with a tagline 'Humiliation. Rape. Murder. You know the drill.',"MATCH (a:Adult)
WHERE a.tagline = 'Humiliation. Rape. Murder. You know the drill.'
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline == ""Humiliation. Rape. Murder. You know the drill."";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,755,What are the top 5 movies with a specific keyword 'space' and have been released?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'space'})
WHERE m.status = 'Released'
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'space';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has status $status_m;
  $m has title $title_m;
  $m has release_date $release_date_m;
  $m has popularity $popularity_m;
  $status_m == ""Released"";
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m, ""popularity"": $popularity_m
};"
neoflix,757,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,762,List the first 3 countries where movies with an average vote above 8 were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 8
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has average_vote $average_vote_m;
  $c has country_name $country_name_c;
  $average_vote_m > 8;
limit 3;
fetch {
  ""name"": $country_name_c
};"
neoflix,778,List the first 3 countries where movies with an average vote above 8 were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 8
RETURN DISTINCT c.name
LIMIT 3","match
  $m isa movie, has average_vote $vote;
  $vote > 8;
  (media: $m, country: $c) isa produced_in_country;
  $c has country_name $name;
limit 3;
fetch { ""name"": $name };"
neoflix,807,List the top 5 adult films with the highest average votes.,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,813,List the first 3 countries where the most non-English language movies are produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.original_language <> 'en'
RETURN c.name AS country, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
original_language (media: $m, language: $lang);
not { $lang has language_id ""en""; };
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""count"": $count
};"
neoflix,814,What are the top 5 most popular videos based on their popularity score?,"MATCH (v:Video)
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 5","match
  $v isa video;
  $v has title $title;
  $v has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,820,What are the top 3 highest revenue adult films?,"MATCH (a:Adult)
WHERE a.revenue IS NOT NULL
RETURN a.title, a.revenue
ORDER BY a.revenue DESC
LIMIT 3","match
  $a isa adult_video;
  $a has revenue $revenue;
  $a has title $title;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,822,Which 3 production companies have the most films with an original language of 'en'?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.original_language = 'en'
RETURN c.name AS company, count(*) AS num_films
ORDER BY num_films DESC
LIMIT 3","match
$m isa movie;
$c isa production_company;
produced_by (media: $m, producer: $c);
original_language (media: $m, language: $lang);
$lang has language_id ""en"";
reduce $count = count groupby $c;
sort $count desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""count"": $count
};"
neoflix,842,What are the top 3 countries producing the most movies with an average vote below 5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote < 5
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS country, movie_count","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has average_vote $average_vote_m;
  $c has country_name $country_name_c;
  $average_vote_m < 5;
reduce $count = count($m);
sort $count desc;
limit 3;
fetch {
  ""count"": $count
};"
neoflix,863,What are the top 5 movies by revenue that have a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $m has revenue $revenue;
  $runtime > 120;
sort $revenue desc;
limit 5;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,867,What are the first 3 genres associated with movies that have a popularity greater than 20?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.popularity > 20
RETURN g.name AS genre
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre;
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has popularity $popularity_m;
  $g has genre_name $genre_name_g;
  $popularity_m > 20;
sort $popularity_m desc;
limit 3;
fetch {
  ""genre"": $genre_name_g
};"
neoflix,868,List the 5 countries where movies with a revenue greater than 500 million USD were produced.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.revenue > 500000000
RETURN c.name AS country
LIMIT 5","match
  $m isa movie;
  $c isa country;
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has revenue $revenue_m;
  $c has country_name $country_name_c;
  $revenue_m > 500000000;
limit 5;
fetch {
  ""country"": $country_name_c
};"
neoflix,871,What are the first 3 collections that include movies with a budget over 50 million USD?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WHERE m.budget > 50000000
RETURN c.name
LIMIT 3","match
  $c isa collection;
  $m isa movie;
  $rel0 isa in_collection (collection: $c, media: $m);
  $c has collection_name $collection_name_c;
  $m has budget $budget_m;
  $budget_m > 50000000;
limit 3;
fetch {
  ""name"": $collection_name_c
};"
neoflix,880,"List the first 5 movies that have been tagged with a specific keyword, e.g., 'adventure'.","MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'adventure'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $k isa keyword, has keyword_name 'adventure';
  $rel0 isa has_keyword (media: $m, keyword: $k);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,882,"List the top 5 movies that have been produced by a specific company, e.g., 'Pixar Animation Studios'.","MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $c isa production_company, has production_company_name 'Pixar Animation Studios';
  $rel0 isa produced_by (media: $m, producer: $c);
  $m has title $title_m;
  $m has release_date $release_date_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""release_date"": $release_date_m, ""popularity"": $popularity_m
};"
neoflix,885,List the first 3 movies that have the tagline 'Roll the dice and unleash the excitement!'.,"MATCH (m:Movie {tagline: 'Roll the dice and unleash the excitement!'})
RETURN m.title
LIMIT 3","match
  $m isa movie, has tagline 'Roll the dice and unleash the excitement!';
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,888,Name the first 5 genres that videos with a popularity rating above 5 belong to.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.popularity > 5
RETURN g.name AS genre
LIMIT 5","match
  $v isa video;
  $g isa genre;
  $rel0 isa in_genre (media: $v, genre: $g);
  $v has popularity $popularity_v;
  $g has genre_name $genre_name_g;
  $popularity_v > 5;
limit 5;
fetch {
  ""genre"": $genre_name_g
};"
neoflix,889,What are the top 3 adult films with the highest average vote?,"MATCH (a:Adult)
WHERE a.average_vote IS NOT NULL
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 3","match
  $a isa adult_video;
  $a has average_vote $average_vote;
  $a has title $title;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,898,Name the first 5 movies that have a homepage listed.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has homepage $homepage;
  $m has title $title;
limit 5;
fetch {
  ""title"": $title
};"
neoflix,900,List the first 5 languages used in the original language of adult films.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN DISTINCT l.name AS language
LIMIT 5","match
  $a isa adult_video;
  $l isa language;
  $rel0 isa original_language (media: $a, language: $l);
  $l has language_name $language_name_l;
limit 5;
fetch {
  ""language"": $language_name_l, ""name"": $language_name_l
};"
neoflix,903,What are the first 3 collections that include videos?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(v:Video)
RETURN c.name AS collection
ORDER BY c.name
LIMIT 3","match
  $c isa collection;
  $v isa video;
  $rel0 isa in_collection (collection: $c, media: $v);
  $c has collection_name $collection_name_c;
sort $collection_name_c asc;
limit 3;
fetch {
  ""collection"": $collection_name_c
};"
neoflix,905,"List the first 3 adult films with a specific tagline, e.g., 'Trust Will Get You Killed'.","MATCH (a:Adult)
WHERE a.tagline = 'Trust Will Get You Killed'
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has tagline $tagline;
  $a has title $title;
  $tagline == ""Trust Will Get You Killed"";
limit 3;
fetch {
  ""title"": $title
};"
neoflix,907,List the top 3 movies with a budget over 100 million USD and an average vote above 7.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.average_vote > 7
RETURN m.title, m.budget, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has average_vote $average_vote;
  $m has title $title;
  $budget > 100000000;
  $average_vote > 7;
sort $average_vote desc;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget, ""average_vote"": $average_vote
};"
neoflix,908,"Name the first 5 movies that were produced by a specific country, e.g., 'France'.","MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'France'})
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $c isa country, has country_name 'France';
  $rel0 isa produced_in_country (media: $m, country: $c);
  $m has title $title_m;
limit 5;
fetch {
  ""title"": $title_m
};"
neoflix,914,"Name the top 5 movies that have been produced in a specific genre, e.g., 'Animation'.","MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name 'Animation';
  $rel0 isa in_genre (media: $m, genre: $g);
  $m has title $title_m;
  $m has popularity $popularity_m;
sort $popularity_m desc;
limit 5;
fetch {
  ""title"": $title_m, ""popularity"": $popularity_m
};"
neoflix,0,Which movies were released in 1995?,"MATCH (m:Movie)
WHERE m.release_date STARTS WITH '1995'
RETURN m.title, m.release_date","match $m isa movie, has release_date $release_date, has title $title; $release_date >= 1995-01-01T00:00:00; $release_date < 1996-01-01T00:00:00; fetch { ""title"": $title, ""release_date"": $release_date };"
neoflix,7,Which movies have been rated by user with ID 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
  $u isa user, has user_id ""1"";
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
  $m has title $title_m;
fetch {
  ""movie"": $title_m, ""rating"": $rating
};"
neoflix,21,List the first 3 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster_path $poster_path, has title $title;
$poster_path like "".*\\.jpg"";
limit 3;
fetch { ""title"": $title };"
neoflix,29,Name 3 movies spoken in more than one language.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
WHERE languageCount > 1
RETURN m.title
LIMIT 3","match
$m isa movie;
$l isa language;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
match $count > 1;
limit 3;
fetch { ""title"": $m.title };"
neoflix,31,List the first 3 movies with an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title, m.imdb_id
LIMIT 3","match
$m isa movie;
$m has imdb_id $imdb_id;
$imdb_id like ""tt.*"";
$m has title $title;
limit 3;
fetch { ""title"": $title, ""imdb_id"": $imdb_id };"
neoflix,32,Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 1
RETURN m.title AS movie, num_countries","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $num_countries = count($c) groupby $m;
match $num_countries > 1;
fetch {
  ""movie"": $m.title,
  ""num_countries"": $num_countries
};"
neoflix,50,Display movies that have been released in the 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE m.status = 'Released'
RETURN m","match
$m isa movie, has status ""Released"";
$c isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $c);
fetch {
  ""movie"": {
    ""title"": $m.title,
    ""status"": $m.status
  }
};"
neoflix,53,What are the movies directed by a person who has also acted in a movie?,"MATCH (director:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)<-[:CAST_FOR]-(actor:Person)
WHERE director = actor
RETURN m.title AS movie, director.name AS director","match
$p isa person, has person_name $name;
$m isa movie, has title $title;
$crew isa crew_for (crew_member: $p, film: $m), has job ""Director"";
cast_for (actor: $p, film: $any_movie);
fetch {
  ""movie"": $title,
  ""director"": $name
};"
neoflix,55,Display all movies that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has title $title;
fetch {
  ""title"": $title,
  ""release_date"": $rd
};"
neoflix,59,Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
WHERE languageCount > 3
RETURN m.title AS movie, languageCount AS translatedLanguages","match
$m isa movie, has title $title;
spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m, $title;
match $count > 3;
sort $title;
fetch {
  ""movie"": $title,
  ""translatedLanguages"": $count
};"
neoflix,61,Find all movies where Tom Hanks is listed first in the cast.,"MATCH (p:Person {name: 'Tom Hanks'})-[r:CAST_FOR]->(m:Movie)
WHERE r.order = 0
RETURN m","match
$p isa person, has person_name ""Tom Hanks"";
$rel isa cast_for (actor: $p, film: $m), has cast_order 0;
$m isa movie;
fetch {
  ""movie"": { ""title"": $m.title }
};"
neoflix,62,Which movies are associated with more than one production company?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
WITH m, count(c) AS num_companies
WHERE num_companies > 1
RETURN m.title AS movie, num_companies","match
$m isa movie;
produced_by (media: $m, producer: $c);
reduce $num_companies = count($c) groupby $m;
match $num_companies > 1;
fetch {
  ""movie"": $m.title,
  ""num_companies"": $num_companies
};"
neoflix,63,Display the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget / m.revenue AS budget_revenue_ratio
ORDER BY budget_revenue_ratio DESC
LIMIT 5","match
$m isa movie, has budget $budget, has revenue $revenue;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""budget_revenue_ratio"": $ratio
};"
neoflix,66,Identify all movies that were produced in a country other than the United States.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE c.name <> 'United States of America'
RETURN m.title, c.name","match
$m isa movie, has title $title;
$c isa country, has country_name $cname;
produced_in_country (media: $m, country: $c);
not { $cname == ""United States of America""; };
fetch {
  ""title"": $title,
  ""country"": $cname
};"
neoflix,67,List all movies that have been rated by user with ID 1.,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating","match
$u isa user, has user_id ""1"";
$r isa rated (reviewer: $u, rated_media: $m);
$m isa movie;
$r has rating $rating;
fetch {
  ""title"": $m.title,
  ""rating"": $rating
};"
neoflix,70,Which movies have the most keywords associated with them?,"MATCH (m:Movie)-[r:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(r) AS num_keywords
ORDER BY num_keywords DESC
LIMIT 10","match
$m isa movie, has title $t;
has_keyword (media: $m, keyword: $k);
reduce $num_keywords = count($k) groupby $m, $t;
sort $num_keywords desc;
limit 10;
fetch {
  ""movie"": $t,
  ""num_keywords"": $num_keywords
};"
neoflix,79,Find all movies where the original and spoken languages are different.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(origLang:Language)
WHERE exists {
  (m)-[:SPOKEN_IN_LANGUAGE]->(spokenLang:Language)
  WHERE spokenLang <> origLang
}
RETURN m.title AS movie, origLang.name AS originalLanguage,
       [(m)-[:SPOKEN_IN_LANGUAGE]->(sl:Language) | sl.name] AS spokenLanguages","match
$m isa movie;
original_language (media: $m, language: $origLang);
spoken_in_language (media: $m, language: $spokenLang);
$origLang has language_id $origId;
$spokenLang has language_id $spokenId;
$origId != $spokenId;
fetch {
  ""movie"": $m.title,
  ""originalLanguage"": $origLang.language_name,
  ""spokenLanguage"": $spokenLang.language_name
};"
neoflix,81,Which movies have more than three genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 3
RETURN m.title AS movie, genreCount","match
$m isa movie;
in_genre (media: $m, genre: $g);
reduce $genreCount = count($g) groupby $m;
match $genreCount > 3;
fetch {
  ""movie"": $m.title,
  ""genreCount"": $genreCount
};"
neoflix,84,List all movies produced in countries where the primary language is not English.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE NOT EXISTS {
  (m)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'English'})
}
RETURN m.title AS movie, c.name AS country","match
$m isa movie;
produced_in_country (media: $m, country: $c);
not { 
  original_language (media: $m, language: $l);
  $l has language_name ""English"";
};
fetch {
  ""movie"": $m.title,
  ""country"": $c.country_name
};"
neoflix,85,Which movies have the highest number of associated keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keywordCount
RETURN m.title AS movie, keywordCount
ORDER BY keywordCount DESC
LIMIT 10","match
$m isa movie, has title $title;
has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m, $title;
sort $keyword_count desc;
limit 10;
fetch {
  ""movie"": $title,
  ""keywordCount"": $keyword_count
};"
neoflix,95,How many movies have a budget greater than 100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN count(m)","match
$m isa movie, has budget $b;
$b > 100000000;
reduce $count = count($m);"
neoflix,106,Who are the top 5 most frequent directors in the movies dataset?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
RETURN p.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $p isa person, has person_name $pn;
  $m isa movie;
  crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $num_movies = count($m) groupby $p, $pn;
sort $num_movies desc;
limit 5;
fetch { ""director"": $pn, ""num_movies"": $num_movies };"
neoflix,108,List the first 3 production companies by the number of movies produced.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,110,What are the top 5 movies with the most user ratings?,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
  $m isa movie, has title $title;
  rated (reviewer: $u, rated_media: $m);
reduce $count = count groupby $m, $title;
sort $count desc;
limit 5;
fetch { ""title"": $title, ""num_ratings"": $count };"
neoflix,111,Which movies have been rated by user '1'?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
  $u isa user, has user_id ""1"";
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
  $m has title $title_m;
fetch {
  ""movie"": $title_m, ""rating"": $rating
};"
neoflix,116,List the first 5 movies that have been associated with more than one genre.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
WHERE genreCount > 1
RETURN m.title
LIMIT 5","match
$m isa movie;
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $count = count($g) groupby $m;
match $count > 1;
limit 5;
fetch { ""title"": $m.title };"
neoflix,119,List the first 3 genres most commonly found in videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn };"
neoflix,124,What are the top 3 countries by the number of adult films produced?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adult_film_count"": $count };"
neoflix,126,What are the top 3 countries by the number of adult films produced?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $name;
  produced_in_country (media: $a, country: $c);
  $a isa adult_video;
reduce $count = count($a) groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""country"": $name, ""adultFilmCount"": $count };"
neoflix,129,List the first 3 production companies that have produced the most adult films.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
WITH c, count(a) AS adultCount
ORDER BY adultCount DESC
LIMIT 3
RETURN c.name AS productionCompany, adultCount","match
  $c isa production_company, has production_company_name $name;
  $a isa adult_video;
  produced_by (producer: $c, media: $a);
reduce $count = count($a) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""productionCompany"": $name,
  ""adultCount"": $count
};"
neoflix,133,List the first 5 subscriptions that expire in 2020.,"MATCH (s:Subscription)
WHERE s.expiresAt >= date('2020-01-01') AND s.expiresAt < date('2021-01-01')
RETURN s
LIMIT 5","match
  $s isa subscription, has subscription_id $sid, has expires_at $exp;
  $exp >= 2020-01-01T00:00:00;
  $exp < 2021-01-01T00:00:00;
sort $exp asc;
limit 5;
fetch { ""subscription_id"": $sid, ""expires_at"": $exp };"
neoflix,134,What are the prices of the packages named 'Gold' and 'Platinum'?,"MATCH (p:Package)
WHERE p.name IN ['Gold', 'Platinum']
RETURN p.name AS package, p.price AS price","match
$p isa package;
$p has package_name $package_name;
$p has package_price $package_price;
{ $package_name == ""Gold""; } or { $package_name == ""Platinum""; };
fetch { ""package"": $package_name, ""price"": $package_price };"
neoflix,136,What are the top 3 videos rated by users?,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN v.title AS video, avg(r.rating) AS averageRating
ORDER BY averageRating DESC
LIMIT 3","match
  $v isa video, has title $title;
  $rel isa rated (rated_media: $v), has rating $rating;
reduce $avg = mean($rating) groupby $v, $title;
sort $avg desc;
limit 3;
fetch { ""video"": $title, ""averageRating"": $avg };"
neoflix,138,What are the top 3 movies by vote count that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has vote_count $vc;
sort $vc desc;
limit 3;
fetch { ""title"": $m.title, ""vote_count"": $vc };"
neoflix,139,Which movies have a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.budget, m.revenue","match
$m isa movie;
$m has revenue $revenue;
$m has budget $budget;
$revenue > $budget;
fetch {
  ""title"": $m.title,
  ""budget"": $budget,
  ""revenue"": $revenue
};"
neoflix,144,What are the first 5 production companies by the number of genres they produce movies in?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]->(:Movie)-[:IN_GENRE]->(g:Genre)
WITH c, count(distinct g) AS num_genres
ORDER BY num_genres DESC
LIMIT 5
RETURN c.name AS company, num_genres","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  $g isa genre;
  produced_by (media: $m, producer: $c);
  in_genre (media: $m, genre: $g);
select $c, $g, $name;
distinct;
reduce $num_genres = count($g) groupby $c, $name;
sort $num_genres desc;
limit 5;
fetch {
  ""company"": $name,
  ""num_genres"": $num_genres
};"
neoflix,145,Which movies have been produced in more than one country?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 1
RETURN m.title AS movie, num_countries","match $m isa movie; $c isa country; produced_in_country (media: $m, country: $c); reduce $num_countries = count($c) groupby $m; match $num_countries > 1; fetch { ""movie"": $m.title, ""num_countries"": $num_countries };"
neoflix,146,List the first 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
LIMIT 5","match
$m isa movie;
$m has poster_path $poster_path;
$poster_path like "".*\\.jpg"";
$m has title $title;
limit 5;
fetch { ""title"": $title, ""poster_path"": $poster_path };"
neoflix,147,What are the jobs of the first 3 crew members for the movie with the highest budget?,"MATCH (m:Movie)<-[r:CREW_FOR]-(p:Person)
WITH m, r, p
ORDER BY m.budget DESC
LIMIT 1
WITH m, collect({job: r.job, person: p}) AS crew
RETURN m.title AS movie, crew[0..2] AS crew_jobs","match
  $m isa movie, has budget $budget, has title $title;
  $r isa crew_for (film: $m, crew_member: $p), has job $job;
sort $budget desc;
limit 3;
fetch {
  ""movie"": $title,
  ""job"": $job
};"
neoflix,148,Which movies have been translated into more than three languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
WHERE languageCount > 3
RETURN m.title AS movie, languageCount AS translatedLanguages","match 
$m isa movie; 
$l isa language; 
spoken_in_language (media: $m, language: $l);
$m has title $title;
reduce $count = count($l) groupby $m, $title;
match $count > 3;
fetch { ""movie"": $title, ""translatedLanguages"": $count };"
neoflix,149,Which movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[r:HAS_KEYWORD]->(k:Keyword)
WITH m, count(r) AS num_keywords
RETURN m.title AS movie, num_keywords
ORDER BY num_keywords DESC
LIMIT 10","match
  $m isa movie;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 10;
fetch {
  ""movie"": $m.title,
  ""num_keywords"": $count
};"
neoflix,150,What are the first 3 movies with the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget / m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 3","match
$m isa movie;
$m has budget $budget;
$m has revenue $revenue;
$m has title $title;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""ratio"": $ratio
};"
neoflix,201,Show the top 3 movies that have been reviewed most recently by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, r.timestamp AS reviewedAt
ORDER BY r.timestamp DESC
LIMIT 3","match
$m isa movie, has title $title;
$u isa user;
$r isa rated (rated_media: $m, reviewer: $u), has timestamp $timestamp;
sort $timestamp desc;
limit 3;
fetch {
  ""movie"": $title,
  ""reviewedAt"": $timestamp
};"
neoflix,207,Which 5 subscriptions are linked to the 'Ultimate' package?,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package {name: 'Ultimate'})
RETURN s
LIMIT 5","match
  $s isa subscription;
  $p isa package, has package_name ""Ultimate"";
  for_package (subscription: $s, package: $p);
limit 5;
fetch { ""subscription"": $s.subscription_id };"
neoflix,208,List the top 3 genres most frequently associated with videos.,"MATCH (g:Genre)<-[:IN_GENRE]-(v:Video)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $frequency = count($v) groupby $g, $gn;
sort $frequency desc;
limit 3;
fetch { ""genre"": $gn, ""frequency"": $frequency };"
neoflix,209,What are the first 5 countries where most adult films are produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
neoflix,210,Which 3 languages are most common in adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa adult_video;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,213,What are the top 5 videos that have been rated by the most users?,"MATCH (v:Video)<-[r:RATED]-(u:User)
WITH v, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5
RETURN v.title AS video, numRatings","match
  $v isa video, has title $title;
  $u isa user;
  $r isa rated (rated_media: $v, reviewer: $u);
reduce $count = count($r) groupby $v, $title;
sort $count desc;
limit 5;
fetch {
  ""video"": $title,
  ""numRatings"": $count
};"
neoflix,214,Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
RETURN v.title AS video, keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""keywordCount"": $count
};"
neoflix,216,List the top 3 collections with the most movies included.,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  $m isa movie;
  in_collection (media: $m, collection: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 3;
fetch { ""collection"": $cn, ""num_movies"": $num_movies };"
neoflix,218,Which 3 production companies have produced the most movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch { ""company"": $name, ""num_movies"": $count };"
neoflix,221,What are the top 5 languages spoken in movies that have a budget over $50 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 50000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $m isa movie, has budget $budget;
  $budget > 50000000;
  spoken_in_language (media: $m, language: $l);
  $l has language_name $ln;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,222,Which 3 countries have produced the most movies in the genre 'Drama'?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
RETURN c.name AS country, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa movie;
  $g isa genre, has genre_name ""Drama"";
  produced_in_country (media: $m, country: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""num_movies"": $count };"
neoflix,223,Show the first 5 movies that have a character named 'Charlie Wilson' in their cast.,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.name = 'Tom Hanks' AND exists{ (p)-[:CAST_FOR {character: 'Charlie Wilson'}]->(m) }
RETURN m.title
LIMIT 5","match
$m isa movie;
$rel isa cast_for (actor: $p, film: $m);
$rel has character ""Charlie Wilson"";
$m has title $title;
limit 5;
fetch { ""title"": $title };"
neoflix,224,List the top 3 people with the most crew roles in movies.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
RETURN p.name AS person, count(r) AS num_crew_roles
ORDER BY num_crew_roles DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie;
  $rel isa crew_for (crew_member: $p, film: $m);
reduce $num_crew_roles = count($rel) groupby $p, $pn;
sort $num_crew_roles desc;
limit 3;
fetch { ""person"": $pn, ""num_crew_roles"": $num_crew_roles };"
neoflix,226,Which 3 movies have changed their status from 'In Production' to 'Released'?,"MATCH (m:Movie)
WHERE m.status = 'Released' AND exists {
  (m)-[:HAS_KEYWORD]->(:Keyword {name: 'in production'})
}
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has status ""Released"";
  $k isa keyword, has keyword_name ""in production"";
  has_keyword (media: $m, keyword: $k);
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,227,Show the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""poster_path"": $poster_path
};"
neoflix,229,What are the top 5 movies that have undergone a title change after release?,"MATCH (m:Movie)
WHERE m.title <> m.original_title
RETURN m.title AS title, m.original_title AS original_title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$m has title $title;
$m has original_title $original_title;
$m has popularity $popularity;
not { $title == $original_title; };
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title,
  ""original_title"": $original_title
};"
neoflix,230,Which 3 movies have the highest discrepancy between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie,
    has budget $budget,
    has revenue $revenue,
    has title $title;
let $discrepancy = $revenue - $budget;
sort $discrepancy desc;
limit 3;
fetch {
    ""title"": $title,
    ""budget"": $budget,
    ""revenue"": $revenue,
    ""discrepancy"": $discrepancy
};"
neoflix,231,Show the first 5 movies where the original language is not English but have English as a spoken language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(ol:Language)
WHERE ol.name <> 'English'
AND EXISTS {
  (m)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'English'})
}
RETURN m.title
LIMIT 5","match $m isa movie; $ol isa language, has language_name $ol_name; $ol_name != ""English""; original_language (media: $m, language: $ol); $english isa language, has language_name ""English""; spoken_in_language (media: $m, language: $english); $m has title $title; limit 5; fetch { ""title"": $title };"
neoflix,236,What are the top 5 movies with the most significant number of languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 5
RETURN m.title AS movie, languageCount AS spokenLanguages","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""spokenLanguages"": $count
};"
neoflix,238,List the top 3 videos that have a revenue of zero.,"MATCH (v:Video)
WHERE v.revenue = 0
RETURN v.title, v.popularity
ORDER BY v.popularity DESC
LIMIT 3","match
  $v isa video;
  $v has revenue $revenue;
  $revenue == 0.0;
  $v has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $v.title,
  ""popularity"": $popularity
};"
neoflix,245,Show the first 5 adult films based on their IMDB ID starting with 'tt007'.,"MATCH (a:Adult)
WHERE a.imdb_id STARTS WITH 'tt007'
RETURN a.title, a.imdb_id
ORDER BY a.imdb_id
LIMIT 5","match
$a isa adult_video;
$a has imdb_id $imdb_id;
$imdb_id like ""^tt007.*"";
$a has title $title;
sort $imdb_id asc;
limit 5;
fetch { ""title"": $title, ""imdb_id"": $imdb_id };"
neoflix,253,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch { ""movie"": $m.title, ""keywordCount"": $count };"
neoflix,257,Which 3 languages are spoken in the most number of movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""movieCount"": $count };"
neoflix,258,Name the top 5 production companies by the number of movies produced.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name };"
neoflix,259,What are the first 3 genres that have the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $movie_count = count($m) groupby $g, $gn;
sort $movie_count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $movie_count };"
neoflix,260,List 5 countries where the most movies were produced.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
reduce $movie_count = count($m) groupby $c, $cn;
sort $movie_count desc;
limit 5;
fetch { ""country"": $cn, ""movieCount"": $movie_count };"
neoflix,261,Which 3 collections contain the most movies?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  $m isa movie;
  in_collection (media: $m, collection: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 3;
fetch { ""collection"": $cn, ""num_movies"": $num_movies };"
neoflix,266,Name the top 5 movies with the most budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget / m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 5","match
$m isa movie, has budget $budget, has revenue $revenue, has title $title;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 5;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""ratio"": $ratio
};"
neoflix,267,List the top 5 languages based on the number of movies originally in that language.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  $m isa movie;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""movieCount"": $count };"
neoflix,269,What are the first 3 movies that are not part of any collection?,"MATCH (m:Movie)
WHERE NOT EXISTS {(m)-[:IN_COLLECTION]->(:Collection)}
RETURN m.title
LIMIT 3","match
$m isa movie;
not { in_collection (media: $m, collection: $c); };
limit 3;
fetch { ""title"": $m.title };"
neoflix,271,Which 3 movies have the most revenue among those released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,272,Name the top 5 movies with a tagline containing the word 'love'.,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'love'
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$m has tagline $tagline;
$tagline like ""(?i).*love.*"";
$m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $m.title };"
neoflix,275,Name the top 5 genres by the average votes of the movies in them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, avg(m.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 5
RETURN g.name AS genre, avg_vote","match
  $g isa genre, has genre_name $name;
  $m isa movie, has average_vote $vote;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($vote) groupby $g, $name;
sort $avg desc;
limit 5;
fetch {
  ""genre"": $name,
  ""avg_vote"": $avg
};"
neoflix,277,Which 3 countries have the least number of movies produced in them?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count asc;
limit 3;
fetch { ""country"": $cn, ""movieCount"": $count };"
neoflix,285,Which 3 adult videos have the most keywords associated with them?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS keywordCount
RETURN a.title, keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $a isa adult_video, has title $title;
  has_keyword (media: $a, keyword: $k);
reduce $keywordCount = count($k) groupby $a, $title;
sort $keywordCount desc;
limit 3;
fetch {
  ""title"": $title,
  ""keywordCount"": $keywordCount
};"
neoflix,287,What are the first 3 adult videos not produced in any country listed?,"MATCH (a:Adult)
WHERE NOT EXISTS {
  (a)-[:PRODUCED_IN_COUNTRY]->(:Country)
}
RETURN a.title
LIMIT 3","match
$a isa adult_video;
not { produced_in_country (media: $a, country: $c); };
limit 3;
fetch { ""title"": $a.title };"
neoflix,292,Which 3 packages provide access to the most genres?,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
WITH p, count(g) AS genreCount
RETURN p.name AS package, genreCount
ORDER BY genreCount DESC
LIMIT 3","match
  $p isa package, has package_name $name;
  provides_access_to (package: $p, genre: $g);
reduce $count = count($g) groupby $p, $name;
sort $count desc;
limit 3;
fetch {
  ""package"": $name,
  ""genreCount"": $count
};"
neoflix,295,List the top 5 packages by the number of subscriptions associated with them.,"MATCH (p:Package)<-[:FOR_PACKAGE]-(s:Subscription)
RETURN p.name AS package, count(s) AS subscriptions
ORDER BY subscriptions DESC
LIMIT 5","match
  $p isa package, has package_name $name;
  for_package (subscription: $s, package: $p);
reduce $count = count($s) groupby $p, $name;
sort $count desc;
limit 5;
fetch { ""package"": $name, ""subscriptions"": $count };"
neoflix,298,What are the first 3 movies with the most associated cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
RETURN m.title AS movie, count(p) AS cast_size
ORDER BY cast_size DESC
LIMIT 3","match
  $m isa movie;
  cast_for (actor: $p, film: $m);
reduce $cast_size = count($p) groupby $m;
sort $cast_size desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""cast_size"": $cast_size
};"
neoflix,299,List the top 5 movies with the most crew members in the 'Production' department.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WHERE exists{ (p)-[:CREW_FOR {department: 'Production'}]->(m) }
WITH m, count(p) AS crewCount
RETURN m.title AS movie, crewCount
ORDER BY crewCount DESC
LIMIT 5","match
  $m isa movie, has title $title;
  $rel isa crew_for (crew_member: $p, film: $m), has department ""Production"";
reduce $count = count($p) groupby $m, $title;
sort $count desc;
limit 5;
fetch {
  ""movie"": $title,
  ""crewCount"": $count
};"
neoflix,300,Which 3 movies have the highest number of associated languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
RETURN m.title AS movie, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""languageCount"": $count
};"
neoflix,301,Name the top 5 countries based on the number of languages spoken in their produced movies.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH c, count(distinct l) AS numLanguages
RETURN c.name AS country, numLanguages
ORDER BY numLanguages DESC
LIMIT 5","match
  $c isa country, has country_name $country_name;
  $m isa movie;
  $l isa language;
  spoken_in_language (media: $m, language: $l);
  produced_in_country (country: $c, media: $m);
select $c, $l, $country_name;
distinct;
reduce $num_languages = count groupby $c, $country_name;
sort $num_languages desc;
limit 5;
fetch {
  ""country"": $country_name,
  ""numLanguages"": $num_languages
};"
neoflix,302,What are the first 3 movies with the highest number of associated production companies?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN m.title AS movie, count(c) AS num_production_companies
ORDER BY num_production_companies DESC
LIMIT 3","match
  $m isa movie, has title $t;
  produced_by (media: $m, producer: $c);
reduce $count = count($c) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""num_production_companies"": $count };"
neoflix,303,List the top 5 movies that are rated by the most users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(u) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
$m isa movie, has title $title;
$u isa user;
rated (rated_media: $m, reviewer: $u);
reduce $num_ratings = count($u) groupby $m, $title;
sort $num_ratings desc;
limit 5;
fetch { ""title"": $title, ""num_ratings"": $num_ratings };"
neoflix,304,Which 3 movies have the most associated genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS movie, genreCount","match
$m isa movie;
$g isa genre;
in_genre (media: $m, genre: $g);
reduce $count = count($g) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""genreCount"": $count
};"
neoflix,305,Name the top 5 movies with the most associated collections.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
RETURN m.title, count(c) AS num_collections
ORDER BY num_collections DESC
LIMIT 5","match
  $m isa movie, has title $title;
  $c isa collection;
  in_collection (media: $m, collection: $c);
reduce $num_collections = count($c) groupby $m, $title;
sort $num_collections desc;
limit 5;
fetch { ""title"": $title, ""num_collections"": $num_collections };"
neoflix,306,What are the first 3 videos with the most associated keywords?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3
RETURN v.title AS video, keywordCount","match
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""keywordCount"": $count
};"
neoflix,307,List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN v.title AS video, count(c) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","match
  $v isa video, has title $title;
  produced_in_country (media: $v, country: $c);
reduce $count = count($c) groupby $v, $title;
sort $count desc;
limit 5;
fetch { ""video"": $title, ""numCountries"": $count };"
neoflix,308,Which 3 videos have the highest number of associated production companies?,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany)
WITH v, count(c) AS companyCount
RETURN v.title AS video, companyCount
ORDER BY companyCount DESC
LIMIT 3","match
  $v isa video;
  produced_by (media: $v, producer: $c);
reduce $count = count($c) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""companyCount"": $count
};"
neoflix,309,Name the top 5 videos with the most associated genres.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH v, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN v.title AS video, genreCount","match
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $count = count($g) groupby $v;
sort $count desc;
limit 5;
fetch {
  ""video"": $v.title,
  ""genreCount"": $count
};"
neoflix,313,Name the top 5 videos with the most crew members in the 'Production' department.,"MATCH (v:Video)<-[:CREW_FOR]-(p:Person)
WHERE EXISTS {
  (p)-[:CREW_FOR {department: 'Production'}]->(v)
}
WITH v, count(p) AS crewCount
RETURN v.title AS video, crewCount
ORDER BY crewCount DESC
LIMIT 5","match
  $v isa video, has title $title;
  $p isa person;
  $rel isa crew_for (crew_member: $p, film: $v), has department ""Production"";
reduce $count = count($p) groupby $v, $title;
sort $count desc;
limit 5;
fetch {
  ""video"": $title,
  ""crewCount"": $count
};"
neoflix,314,What are the first 3 videos with the highest number of associated languages?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH v, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 3
RETURN v.title AS video, languageCount","match
  $v isa video;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($l) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""languageCount"": $count
};"
neoflix,315,List the top 5 videos by the number of countries they were produced in.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(c) AS countryCount
ORDER BY countryCount DESC
LIMIT 5
RETURN v.title AS video, countryCount AS numberOfCountries","match
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($c) groupby $v;
sort $count desc;
limit 5;
fetch {
  ""video"": $v.title,
  ""numberOfCountries"": $count
};"
neoflix,324,What are the top 5 production companies that have produced the most number of movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 5;
fetch { ""company"": $cn, ""num_movies"": $num_movies };"
neoflix,326,Which 3 countries have produced the most number of videos?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $v isa video;
  $c isa country, has country_name $cn;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
neoflix,330,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $r isa rated (reviewer: $u, rated_media: $m);
  $m isa movie;
reduce $num_ratings = count($r) groupby $u;
sort $num_ratings desc;
limit 3;
fetch {
  ""user"": $u,
  ""num_ratings"": $num_ratings
};"
neoflix,331,List the top 5 genres that have been accessed by the package named 'Platinum'.,"MATCH (p:Package {name: 'Platinum'})-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre, count(*) AS accessCount
ORDER BY accessCount DESC
LIMIT 5","match
  $p isa package, has package_name ""Platinum"";
  $g isa genre, has genre_name $gn;
  provides_access_to (package: $p, genre: $g);
limit 5;
fetch { ""genre"": $gn };"
neoflix,336,Name the top 5 countries where the original language of the movie is Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {name: 'es'})
MATCH (m)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS spanishMovieCount
ORDER BY spanishMovieCount DESC
LIMIT 5","match
  $l isa language, has language_id ""es"";
  $m isa movie;
  original_language (media: $m, language: $l);
  $c isa country, has country_name $cn;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""spanishMovieCount"": $count };"
neoflix,339,Which 3 genres do the most movies belong to?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
neoflix,341,What are the top 5 languages spoken in the adult films?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $a, language: $l);
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,343,List the top 5 users who have rated videos the most.,"MATCH (u:User)-[r:RATED]->(v:Video)
RETURN u.id AS user, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
  $u isa user, has user_id $uid;
  $v isa video;
  rated (rated_media: $v, reviewer: $u);
reduce $num_ratings = count groupby $u, $uid;
sort $num_ratings desc;
limit 5;
fetch { ""user"": $uid, ""num_ratings"": $num_ratings };"
neoflix,344,What are the first 3 production companies that produced videos with zero revenue?,"MATCH (v:Video)-[:PRODUCED_BY]->(c:ProductionCompany)
WHERE v.revenue = 0
RETURN DISTINCT c.name
LIMIT 3","match
  $v isa video, has revenue 0;
  produced_by (media: $v, producer: $c);
  $c has production_company_name $name;
limit 3;
fetch { ""name"": $name };"
neoflix,349,List the top 5 countries that have produced the most movies in the 'Comedy' genre.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN c.name AS country, count(m) AS comedyMovies
ORDER BY comedyMovies DESC
LIMIT 5","match
  $g isa genre, has genre_name ""Comedy"";
  $m isa movie;
  in_genre (media: $m, genre: $g);
  $c isa country, has country_name $cn;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""comedyMovies"": $count };"
neoflix,352,Name the top 5 languages in which the most movies have been originally made.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $m isa movie;
  $l isa language, has language_name $ln;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""movieCount"": $count };"
neoflix,355,Which 3 movies have an average vote less than 5 and have been produced in the country with ID 'US'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {id: 'US'})
WHERE m.average_vote < 5
RETURN m.title
LIMIT 3","match
$m isa movie, has average_vote $average_vote, has title $title;
$country isa country, has country_id ""US"";
produced_in_country (media: $m, country: $country);
$average_vote < 5;
limit 3;
fetch { ""title"": $title };"
neoflix,357,Name the top 5 most frequently used keywords in videos.,"MATCH (k:Keyword)<-[:HAS_KEYWORD]-(v:Video)
RETURN k.name AS Keyword, count(*) AS Frequency
ORDER BY Frequency DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $count };"
neoflix,359,List the top 5 highest-rated movies by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 5
RETURN m.title AS movie, avg_rating","match
  $m isa movie, has title $title;
  $u isa user;
  $r isa rated (rated_media: $m, reviewer: $u), has rating $rating;
reduce $avg = mean($rating) groupby $m, $title;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $title,
  ""avg_rating"": $avg
};"
neoflix,364,List the top 5 movies with a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title, m.poster_path
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
neoflix,365,Which 3 persons have the most crew credits in movies released after 2010?,"MATCH (p:Person)-[c:CREW_FOR]->(m:Movie)
WHERE m.release_date > date('2010-01-01')
WITH p, count(c) AS crewCount
ORDER BY crewCount DESC
LIMIT 3
RETURN p.name AS person, crewCount","match
  $p isa person, has person_name $name;
  $m isa movie, has release_date $rd;
  $rd > 2010-01-01;
  $crew isa crew_for (crew_member: $p, film: $m);
reduce $crew_count = count($crew) groupby $p, $name;
sort $crew_count desc;
limit 3;
fetch { ""person"": $name, ""crew_count"": $crew_count };"
neoflix,366,List the first 3 genres where the most movies have been produced.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
neoflix,368,List the top 5 movies where the revenue exceeded the budget by over 100 million USD.,"MATCH (m:Movie)
WHERE m.revenue - m.budget > 100000000
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue - m.budget DESC
LIMIT 5","match
$m isa movie;
$m has revenue $revenue;
$m has budget $budget;
$m has title $title;
let $diff = $revenue - $budget;
$diff > 100000000;
sort $diff desc;
limit 5;
fetch {
  ""title"": $title,
  ""revenue"": $revenue,
  ""budget"": $budget
};"
neoflix,370,List the first 3 persons who have worked as producers in more than 5 movies.,"MATCH (p:Person)-[:CREW_FOR {job: 'Producer'}]->(m:Movie)
WITH p, count(m) AS num_movies
WHERE num_movies > 5
RETURN p.name
ORDER BY num_movies DESC
LIMIT 3","match
$p isa person, has person_name $name;
$m isa movie;
crew_for (crew_member: $p, film: $m), has job ""Producer"";
reduce $count = count($m) groupby $p, $name;
match $count > 5;
sort $count desc;
limit 3;
fetch { ""name"": $name };"
neoflix,374,Which 3 movies have the most languages spoken in them?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
RETURN m.title AS movie, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""languageCount"": $count
};"
neoflix,376,Name the top 5 movies that have an IMDb ID starting with 'tt'.,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt'
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$m has imdb_id $imdb_id;
$imdb_id like ""tt.*"";
$m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $m.title };"
neoflix,377,What are the first 3 movies that have been rated by the user with ID '1'?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title
ORDER BY r.timestamp
LIMIT 3","match
  $u isa user, has user_id ""1"";
  $r isa rated (reviewer: $u, rated_media: $m);
  $r has timestamp $ts;
  $m has title $title;
sort $ts asc;
limit 3;
fetch { ""title"": $title };"
neoflix,380,Name the top 5 production companies that have produced the highest grossing movies.,"MATCH (m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany)
WHERE m.revenue IS NOT NULL
RETURN c.name AS company, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has revenue $rev;
  produced_by (media: $m, producer: $c);
reduce $total_revenue = sum($rev) groupby $c, $cn;
sort $total_revenue desc;
limit 5;
fetch { ""company"": $cn, ""total_revenue"": $total_revenue };"
neoflix,382,List the top 5 countries where the most adult films have been produced.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 5","match
  $a isa adult_video;
  $c isa country, has country_name $cn;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
neoflix,386,What are the first 3 movies that have a poster path containing '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path = '/vzmL6fP7aPKNKPRTFnZmiUfciyV.jpg'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*/vzmL6fP7aPKNKPRTFnZmiUfciyV\\.jpg.*"";
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,392,List the top 5 movies with the most extensive production crew.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WITH m, count(p) AS crewSize
RETURN m.title AS movie, crewSize
ORDER BY crewSize DESC
LIMIT 5","match
$m isa movie;
crew_for (film: $m, crew_member: $p);
reduce $crewSize = count($p) groupby $m;
sort $crewSize desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""crewSize"": $crewSize
};"
neoflix,394,List the top 5 languages in which the most adult films have been originally made.,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  $l isa language;
  original_language (media: $a, language: $l);
reduce $count = count($a) groupby $l;
sort $count desc;
limit 5;
fetch { ""language"": $l.language_name, ""count"": $count };"
neoflix,395,Name the top 5 users who have given the lowest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avg_rating
ORDER BY avg_rating
LIMIT 5
RETURN u.id AS user_id, avg_rating","match
  $u isa user, has user_id $user_id;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating;
reduce $avg = mean($rating) groupby $u, $user_id;
sort $avg asc;
limit 5;
fetch {
  ""user_id"": $user_id,
  ""avg_rating"": $avg
};"
neoflix,396,What are the first 3 movies that have been rated 5 or higher by more than one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating >= 5
WITH m, count(u) AS num_users
WHERE num_users > 1
RETURN m.title
ORDER BY num_users DESC
LIMIT 3","match
  $m isa movie, has title $title;
  $r isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $rating >= 5.0;
reduce $count = count($u) groupby $m, $title;
match $count > 1;
sort $count desc;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,397,List the top 5 movies released in the 1990s.,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.release_date
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $rd;
  $rd >= 1990-01-01;
  $rd < 2000-01-01;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch { ""title"": $m.title, ""release_date"": $rd };"
neoflix,403,Find the top 5 genres by the number of movies associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""movieCount"": $count };"
neoflix,406,What are the first 5 production companies producing films in the 'Animation' genre?,"MATCH (g:Genre {name: 'Animation'})<-[:IN_GENRE]-(m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany)
RETURN c.name AS company
ORDER BY company
LIMIT 5","match
$g isa genre, has genre_name ""Animation"";
$m isa movie;
in_genre (genre: $g, media: $m);
$c isa production_company, has production_company_name $company;
produced_by (producer: $c, media: $m);
sort $company;
limit 5;
fetch {
  ""company"": $company
};"
neoflix,408,Which 3 languages are most common among movies with a popularity score above 10?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 10
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has popularity $pop;
  $pop > 10;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,410,Which 3 collections contain the most movies with a budget over 50 million dollars?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
WHERE m.budget > 50000000
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS collection, movie_count","match
  $c isa collection;
  $m isa movie;
  in_collection (collection: $c, media: $m);
  $m has budget $budget;
  $budget > 50000000;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""collection"": $c.collection_name,
  ""movie_count"": $count
};"
neoflix,411,Name the top 3 directors who have worked on movies with an average vote greater than 7.5.,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.average_vote > 7.5
WITH p, count(m) AS num_movies, avg(m.average_vote) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3
RETURN p.name AS director, num_movies, avg_rating","match
  $p isa person, has person_name $name;
  crew_for (crew_member: $p, film: $m) isa crew_for, has job ""Director"";
  $m isa movie, has average_vote $vote;
  $vote > 7.5;
reduce $num_movies = count($m), $avg_rating = mean($vote) groupby $p, $name;
sort $avg_rating desc;
limit 3;
fetch { ""director"": $name, ""num_movies"": $num_movies, ""avg_rating"": $avg_rating };"
neoflix,413,What are the top 3 highest-grossing movies directed by a person named 'Tom Hanks'?,"MATCH (p:Person {name: 'Tom Hanks'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$p isa person, has person_name ""Tom Hanks"";
$m isa movie;
crew_for (crew_member: $p, film: $m), has job ""Director"";
$m has revenue $revenue;
sort $revenue desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""revenue"": $revenue
};"
neoflix,414,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
neoflix,417,Name the top 5 movies with the most keywords associated.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5","match
  $m isa movie;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 5;
fetch { ""movie"": $m.title, ""keywordCount"": $count };"
neoflix,418,Which 3 countries have produced the most movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.runtime > 120
RETURN c.name AS country, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $m isa movie, has runtime $rt;
  $rt > 120;
  produced_in_country (media: $m, country: $c);
  $c has country_name $cn;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""numMovies"": $count };"
neoflix,420,List the top 3 languages spoken in the highest-grossing movies.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH l, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3
RETURN l.name AS language, total_revenue","match
  $m isa movie;
  $l isa language;
  spoken_in_language (media: $m, language: $l);
  $m has revenue $revenue;
reduce $total = sum($revenue) groupby $l;
sort $total desc;
limit 3;
fetch {
  ""language"": $l.language_name,
  ""total_revenue"": $total
};"
neoflix,422,Which 3 production companies have the highest total revenues from their movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN c.name AS company, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has revenue $rev;
  produced_by (media: $m, producer: $c);
reduce $total_revenue = sum($rev) groupby $c, $cn;
sort $total_revenue desc;
limit 3;
fetch { ""company"": $cn, ""total_revenue"": $total_revenue };"
neoflix,424,Name the first 5 movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 5","match
$m isa movie;
$m has poster_path $poster_path;
$poster_path like "".*\\.jpg"";
$m has title $title;
limit 5;
fetch { ""title"": $title };"
neoflix,425,What are the top 3 genres in which 'Pixar Animation Studios' has produced movies?,"MATCH (c:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $c isa production_company, has production_company_name ""Pixar Animation Studios"";
  $m isa movie;
  $g isa genre, has genre_name $gn;
  produced_by (media: $m, producer: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
neoflix,428,What are the top 3 languages for movies produced by 'Pixar Animation Studios'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany {name: 'Pixar Animation Studios'})
MATCH (m)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $pc isa production_company, has production_company_name ""Pixar Animation Studios"";
  $m isa movie;
  produced_by (media: $m, producer: $pc);
  $l isa language, has language_name $ln;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,430,Which 3 keywords are most commonly associated with movies that have a budget less than 1 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget < 1000000
RETURN k.name AS keyword, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $m isa movie, has budget $budget;
  $budget < 1000000;
  $k isa keyword, has keyword_name $kn;
  has_keyword (media: $m, keyword: $k);
reduce $frequency = count($m) groupby $k, $kn;
sort $frequency desc;
limit 3;
fetch { ""keyword"": $kn, ""frequency"": $frequency };"
neoflix,432,What are the first 3 production companies that have produced movies in more than one language?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH c, count(distinct l) as numLangs
WHERE numLangs > 1
RETURN c.name
LIMIT 3","match
  $c isa production_company;
  $m isa movie;
  $l isa language;
  produced_by (producer: $c, media: $m);
  original_language (media: $m, language: $l);
select $c, $l;
distinct;
reduce $count = count groupby $c;
match $count > 1;
limit 3;
fetch { ""name"": $c.production_company_name };"
neoflix,434,List the top 5 highest rated movies by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 5
RETURN m.title AS movie, avg_rating","match
  $m isa movie, has title $title;
  $u isa user;
  rated (rated_media: $m, reviewer: $u), has rating $rating;
reduce $avg = mean($rating) groupby $m, $title;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $title,
  ""avg_rating"": $avg
};"
neoflix,437,Which 3 production companies have produced films with a budget over 100 million dollars?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
RETURN c.name AS company, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has budget $budget;
  $budget > 100000000;
  produced_by (media: $m, producer: $c);
reduce $num_movies = count($m) groupby $c, $cn;
sort $num_movies desc;
limit 3;
fetch { ""company"": $cn, ""num_movies"": $num_movies };"
neoflix,439,"What are the top 3 languages spoken in the videos with a budget greater than 500,000 dollars?","MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.budget > 500000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $v isa video, has budget $budget;
  $budget > 500000;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,441,Which 3 keywords are most common in movies with an average vote below 5?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.average_vote < 5
WITH k, count(*) as count
ORDER BY count DESC
LIMIT 3
RETURN k.name AS keyword, count","match
  $m isa movie, has average_vote $avg;
  $avg < 5.0;
  $k isa keyword, has keyword_name $name;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($m) groupby $k, $name;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $name,
  ""count"": $count
};"
neoflix,445,List the top 5 adult films with the most keywords associated.,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WITH a, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5
RETURN a.title AS title, keywordCount","match
  $a isa adult_video, has title $title;
  has_keyword (media: $a, keyword: $k);
reduce $count = count($k) groupby $a, $title;
sort $count desc;
limit 5;
fetch {
  ""title"": $title,
  ""keywordCount"": $count
};"
neoflix,448,Which 3 production companies have produced the most movies in the genre 'Drama'?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
RETURN c.name AS company, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $g isa genre, has genre_name ""Drama"";
  $m isa movie;
  in_genre (media: $m, genre: $g);
  $c isa production_company, has production_company_name $cn;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""movie_count"": $count };"
neoflix,450,What are the top 3 languages spoken in movies that have a status of 'Released'?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.status = 'Released'
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has status ""Released"";
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,452,Which 3 keywords are most commonly associated with videos that have a budget over 1 million dollars?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WHERE v.budget > 1000000
WITH k, count(*) as count
ORDER BY count DESC
LIMIT 3
RETURN k.name AS keyword, count","match
  $v isa video, has budget $budget;
  $k isa keyword, has keyword_name $name;
  has_keyword (media: $v, keyword: $k);
  $budget > 1000000;
reduce $count = count($v) groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
neoflix,459,Which 3 production companies have produced films with a runtime longer than 180 minutes?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 180
RETURN c.name AS company, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $c isa production_company;
  $m isa movie, has runtime $rt;
  $rt > 180;
  produced_by (media: $m, producer: $c);
reduce $num_movies = count($m) groupby $c;
sort $num_movies desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""numMovies"": $num_movies
};"
neoflix,461,"What are the top 3 languages spoken in the adult films with a budget greater than 100,000 dollars?","MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.budget > 100000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $a isa adult_video, has budget $budget;
  $budget > 100000;
  spoken_in_language (media: $a, language: $l);
  $l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,462,Name the first 3 movies that have a poster path ending in '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH '/pQFoyx7rp09CJTAb932F2g8Nlho.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster_path $pp, has title $title;
$pp like "".*\\/pQFoyx7rp09CJTAb932F2g8Nlho\\.jpg"";
limit 3;
fetch { ""title"": $title };"
neoflix,463,Which 3 keywords are most commonly associated with movies that have a revenue over 200 million dollars?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 200000000
WITH k, count(*) as count
ORDER BY count DESC
LIMIT 3
RETURN k.name AS keyword, count","match
  $m isa movie, has revenue $revenue;
  $k isa keyword, has keyword_name $keyword_name;
  has_keyword (media: $m, keyword: $k);
  $revenue > 200000000;
reduce $count = count($m) groupby $k;
sort $count desc;
limit 3;
fetch {
  ""keyword"": $k.keyword_name,
  ""count"": $count
};"
neoflix,470,Which 3 production companies have the highest total budgets for their movies?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget IS NOT NULL
WITH c, sum(m.budget) AS totalBudget
RETURN c.name AS company, totalBudget
ORDER BY totalBudget DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has budget $budget;
  produced_by (producer: $c, media: $m);
reduce $total = sum($budget) groupby $c;
sort $total desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""totalBudget"": $total
};"
neoflix,472,What are the top 3 languages spoken in adult films with a vote count over 10?,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE a.vote_count > 10
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $a isa adult_video, has vote_count $vc;
  $vc > 10;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $a, language: $l);
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,493,Which genres are associated with movies directed by 'Steven Spielberg'?,"MATCH (p:Person {name: 'Steven Spielberg'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name AS genre","match
$p isa person, has person_name ""Steven Spielberg"";
crew_for (crew_member: $p, film: $m) isa crew_for, has job ""Director"";
$m isa movie;
in_genre (media: $m, genre: $g);
$g has genre_name $genre;
select $genre;
distinct;
fetch { ""genre"": $genre };"
neoflix,494,List all the movies where the character 'Woody' appears.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.character CONTAINS 'Woody'
RETURN m.title AS movie, r.character AS character","match
  $p isa person;
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m), has character $character;
  $character like "".*Woody.*"";
  $m has title $title;
fetch {
  ""movie"": $title,
  ""character"": $character
};"
neoflix,498,List the movies that have won awards and have an original language of Italian.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language {name: 'Italian'})
WHERE exists{ (m)-[:HAS_KEYWORD]->(:Keyword {name: 'award won'}) }
RETURN m.title","match
  $m isa movie;
  $l isa language, has language_name ""Italian"";
  original_language (media: $m, language: $l);
  $k isa keyword, has keyword_name ""award won"";
  has_keyword (media: $m, keyword: $k);
fetch {
  ""title"": $m.title
};"
neoflix,509,List the movies that have a budget of zero.,"MATCH (m:Movie)
WHERE m.budget = 0
RETURN m.title","match
$m isa movie, has budget $budget, has title $title;
$budget == 0;
fetch { ""title"": $title };"
neoflix,510,List the first 3 countries that have produced the most adult films.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
neoflix,511,Which movies have been most frequently rated by users?,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title AS movie, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 10","match
  $m isa movie, has title $title;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $m;
sort $count desc;
limit 10;
fetch {
  ""movie"": $m.title,
  ""num_ratings"": $count
};"
neoflix,512,List the top 3 highest-grossing movies of 1995.,"MATCH (m:Movie)
WHERE m.release_date STARTS WITH '1995' AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie;
$m has release_date $release_date;
$release_date >= 1995-01-01T00:00:00;
$release_date < 1996-01-01T00:00:00;
$m has title $title;
$m has revenue $revenue;
sort $revenue desc;
limit 3;
fetch { ""title"": $title, ""revenue"": $revenue };"
neoflix,514,Which movies are associated with the keyword 'family' and have a release date in the last 5 years?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword {name: 'family'})
WHERE m.release_date >= date() - duration('P5Y')
RETURN m.title, m.release_date","match
$m isa movie, has title $title, has release_date $release_date;
$k isa keyword, has keyword_name ""family"";
has_keyword (media: $m, keyword: $k);
$release_date >= 2020-01-01T00:00:00;
fetch {
  ""title"": $title,
  ""release_date"": $release_date
};"
neoflix,515,List the production companies that have produced movies with an original language of Spanish.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'es'})
MATCH (m)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN DISTINCT c.name","match
$m isa movie;
$lang isa language, has language_id ""es"";
original_language (media: $m, language: $lang);
$c isa production_company, has production_company_name $name;
produced_by (media: $m, producer: $c);
select $name;
distinct;
fetch { ""name"": $name };"
neoflix,516,Which movies have a popularity less than 5 and more than 2?,"MATCH (m:Movie)
WHERE m.popularity < 5 AND m.popularity > 2
RETURN m","match
  $m isa movie, has title $title;
  $m has popularity $pop;
  $pop < 5;
  $pop > 2;
limit 50;
fetch { ""title"": $title, ""popularity"": $pop };"
neoflix,522,List all movies that have an average vote of exactly 7.7.,"MATCH (m:Movie)
WHERE m.average_vote = 7.7
RETURN m.title","match
$m isa movie, has average_vote $av, has title $title;
$av == 7.7;
fetch { ""title"": $title };"
neoflix,523,What are the movies with a poster path that ends with 'T4B.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'T4B.jpg'
RETURN m.title","match
$m isa movie, has poster_path $poster_path, has title $title;
$poster_path like "".*T4B\\.jpg"";
fetch { ""title"": $title };"
neoflix,528,List the movies that have been produced in more than three countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS num_countries
WHERE num_countries > 3
RETURN m.title AS movie, num_countries","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $num_countries = count($c) groupby $m;
match $num_countries > 3;
$m has title $title;
fetch {
  ""movie"": $title,
  ""num_countries"": $num_countries
};"
neoflix,529,Which movies have a budget less than 1 million USD and have won an award?,"MATCH (m:Movie)
WHERE m.budget < 1000000 AND exists{ (m)<-[:AWARDED_TO]-() }
RETURN m","match
  $m isa movie;
  $m has budget $budget;
  $budget < 1000000;
  $k isa keyword, has keyword_name ""award won"";
  has_keyword (media: $m, keyword: $k);
fetch {
  ""title"": $m.title
};"
neoflix,533,List all movies where the spoken language includes both English and Spanish.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l1:Language {name: 'English'})
WHERE exists{ (m)-[:SPOKEN_IN_LANGUAGE]->(:Language {name: 'Spanish'}) }
RETURN m.title","match $m isa movie; $l1 isa language, has language_name ""English""; $l2 isa language, has language_name ""Spanish""; spoken_in_language (media: $m, language: $l1); spoken_in_language (media: $m, language: $l2); fetch { ""title"": $m.title };"
neoflix,538,List the movies that have a revenue greater than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.budget, m.revenue","match
$m isa movie;
$m has revenue $revenue;
$m has budget $budget;
$m has title $title;
$revenue > $budget;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue
};"
neoflix,542,List the movies with a release date on '1995-10-30'.,"MATCH (m:Movie)
WHERE m.release_date = date('1995-10-30')
RETURN m.title, m.release_date","match
$m isa movie;
$m has release_date $release_date;
$release_date == 1995-10-30;
$m has title $title;
fetch { ""title"": $title, ""release_date"": $release_date };"
neoflix,543,Which movies have a title that starts with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m.title","match
$m isa movie, has title $title;
$title like ""^The.*"";
fetch { ""title"": $title };"
neoflix,550,What are the movies that have been produced in 'China'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'China'})
RETURN m.title","match
  $m isa movie;
  $c isa country, has country_name ""China"";
  produced_in_country (media: $m, country: $c);
fetch {
  ""title"": $m.title
};"
neoflix,553,List the movies that have been rated 10 by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 10
RETURN m.title","match
  $m isa movie;
  $u isa user;
  rated (rated_media: $m, reviewer: $u), has rating 10.0;
  $m has title $title;
fetch {
  ""title"": $title
};"
neoflix,554,List the movies that have an average vote of 7.1.,"MATCH (m:Movie)
WHERE m.average_vote = 7.1
RETURN m.title","match
  $m isa movie;
  $m has average_vote $average_vote;
  $average_vote == 7.1;
fetch {
  ""title"": $m.title
};"
neoflix,556,What are the movies directed by a female from the 'Production' department?,"MATCH (p:Person {gender: 1})-[r:CREW_FOR {department: 'Production', job: 'Director'}]->(m:Movie)
RETURN m.title AS movie, p.name AS director","match
  $p isa person, has gender 1;
  $m isa movie;
  $r isa crew_for (crew_member: $p, film: $m);
  $r has job ""Director"", has department ""Production"";
fetch {
  ""movie"": $m.title,
  ""director"": $p.person_name
};"
neoflix,557,List all directors for the movie with an ID of 862.,"MATCH (m:Movie {id: 862})<-[:CREW_FOR]-(p:Person)
WHERE exists{ (p)-[:CREW_FOR {job: 'Director'}]->(m) }
RETURN p.name AS director","match
  $m isa movie, has movie_id 862;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  $p has person_name $name;
fetch {
  ""director"": $name
};"
neoflix,560,List the movies that have a release date in January 1995.,"MATCH (m:Movie)
WHERE m.release_date >= date('1995-01-01') AND m.release_date < date('1995-02-01')
RETURN m.title, m.release_date","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 1995-01-01T00:00:00;
  $release_date < 1995-02-01T00:00:00;
fetch {
  ""title"": $m.title,
  ""release_date"": $release_date
};"
neoflix,562,List all movies that have a budget greater than 100 million USD and were released after 2000.,"MATCH (m:Movie)
WHERE m.budget > 100000000 AND m.release_date > date('2000-01-01')
RETURN m.title, m.budget, m.release_date","match
  $m isa movie;
  $m has budget $budget;
  $m has release_date $release_date;
  $m has title $title;
  $budget > 100000000;
  $release_date > 2000-01-01;
fetch {
  ""title"": $title, ""budget"": $budget, ""release_date"": $release_date
};"
neoflix,563,Which movies have an IMDb ID that starts with 'tt00'?,"MATCH (m:Movie)
WHERE m.imdb_id STARTS WITH 'tt00'
RETURN m.title, m.imdb_id","match
  $m isa movie;
  $m has imdb_id $imdb_id;
  $imdb_id like ""^tt00.*"";
fetch {
  ""title"": $m.title,
  ""imdb_id"": $imdb_id
};"
neoflix,564,What are the movies with a runtime exactly equal to the runtime of 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'}), (other:Movie)
WHERE other.runtime = m.runtime AND other <> m
RETURN other.title, other.runtime","match
  $m isa movie, has title ""Toy Story"", has runtime $runtime;
  $other isa movie, has runtime $runtime, has title $title;
  not { $other is $m; };
fetch {
  ""title"": $title,
  ""runtime"": $runtime
};"
neoflix,567,List the movies that have a backdrop path of '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'.,"MATCH (m:Movie)
WHERE m.poster_path = '/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg'
RETURN m.title","match
  $m isa movie;
  $c isa collection, has backdrop_path ""/iWahPsY3hsKOizZHgzQcAxv4O3B.jpg"";
  in_collection (media: $m, collection: $c);
fetch {
  ""title"": $m.title
};"
neoflix,571,Which 5 movies were released after 2010 and have a vote count over 1000?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.vote_count > 1000
RETURN m.title, m.release_date, m.vote_count
ORDER BY m.vote_count DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $m has vote_count $vote_count;
  $m has title $title;
  $release_date > 2010-01-01T00:00:00;
  $vote_count > 1000;
sort $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""vote_count"": $vote_count
};"
neoflix,574,List the first 3 languages that have been used as original languages in more than 10 movies.,"MATCH (l:Language)<-[:ORIGINAL_LANGUAGE]-(m:Movie)
WITH l, count(m) AS movieCount
WHERE movieCount > 10
RETURN l.name AS language
ORDER BY movieCount DESC
LIMIT 3","match
  $l isa language, has language_name $name;
  $m isa movie;
  original_language (language: $l, media: $m);
reduce $count = count($m) groupby $l, $name;
match $count > 10;
sort $count desc;
limit 3;
fetch {
  ""language"": $name
};"
neoflix,575,Which 3 countries have produced more than 50 movies?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
WITH c, count(m) AS movieCount
WHERE movieCount > 50
RETURN c.name AS country, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $c isa country, has country_name $name;
  $m isa movie;
  produced_in_country (country: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
match $count > 50;
sort $count desc;
limit 3;
fetch {
  ""country"": $name,
  ""movieCount"": $count
};"
neoflix,576,What are the top 5 genres by the number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""movieCount"": $count };"
neoflix,577,Which 3 production companies have produced the most movies with a budget over $50 million?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 50000000
WITH c, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 3
RETURN c.name AS company, movie_count","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has budget $budget;
  $budget > 50000000;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""movie_count"": $count
};"
neoflix,579,Who are the top 5 actors by the number of movies they have appeared in?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WITH p, count(r) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS actor, num_movies","match
  $p isa person, has person_name $name;
  cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""num_movies"": $count
};"
neoflix,581,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
neoflix,585,List the first 3 movies that have a poster path starting with '/r'.,"MATCH (m:Movie)
WHERE m.poster_path STARTS WITH '/r'
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like ""/r.*"";
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,587,What are the 3 latest movies rated by user with id 1?,"MATCH (u:User {id: 1})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating, r.timestamp
ORDER BY r.timestamp DESC
LIMIT 3","match
  $u isa user, has user_id ""1"";
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m), has rating $rating, has timestamp $timestamp;
  $m has title $title;
sort $timestamp desc;
limit 3;
fetch {
  ""title"": $title,
  ""rating"": $rating,
  ""timestamp"": $timestamp
};"
neoflix,588,Which 3 genres are most frequently found in movies with a revenue greater than $100 million?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 100000000
WITH g, count(*) AS frequency
RETURN g.name AS genre, frequency
ORDER BY frequency DESC
LIMIT 3","match
  $m isa movie, has revenue $revenue;
  $g isa genre, has genre_name $name;
  in_genre (media: $m, genre: $g);
  $revenue > 100000000;
reduce $frequency = count($m) groupby $g, $name;
sort $frequency desc;
limit 3;
fetch {
  ""genre"": $name,
  ""frequency"": $frequency
};"
neoflix,589,List the top 5 production companies by the number of videos they have produced.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(v:Video)
RETURN c.name AS company, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $v isa video;
  produced_by (media: $v, producer: $c);
reduce $count = count($v) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name, ""videoCount"": $count };"
neoflix,590,Which 3 languages are most frequently spoken in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $v isa video;
  $l isa language, has language_name $ln;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""frequency"": $count };"
neoflix,593,What are the top 5 countries where adult films have been produced?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa adult_video;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""count"": $count };"
neoflix,595,Which 3 genres are most common in adult films?,"MATCH (a:Adult)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa adult_video;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
neoflix,596,What are the top 5 keywords found in videos?,"MATCH (k:Keyword)<-[:HAS_KEYWORD]-(v:Video)
RETURN k.name AS Keyword, count(*) AS Frequency
ORDER BY Frequency DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($v) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $count };"
neoflix,600,List the top 5 genres associated with the highest-grossing videos.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, sum(v.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN g.name AS genre, total_revenue","match
  $v isa video;
  $g isa genre;
  in_genre (media: $v, genre: $g);
  $v has revenue $revenue;
reduce $total = sum($revenue) groupby $g;
sort $total desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""total_revenue"": $total
};"
neoflix,602,What are the top 5 languages in which the most adult films are originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  $l isa language, has language_name $ln;
  original_language (media: $a, language: $l);
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,608,What are the top 5 countries by the number of genres produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m)<-[:IN_GENRE]-(g:Genre)
WITH c, count(distinct g) AS genreCount
RETURN c.name AS country, genreCount
ORDER BY genreCount DESC
LIMIT 5","match
  $c isa country, has country_name $country_name;
  $g isa genre;
  produced_in_country (media: $m, country: $c);
  in_genre (media: $m, genre: $g);
select $c, $g, $country_name;
distinct;
reduce $count = count($g) groupby $c, $country_name;
sort $count desc;
limit 5;
fetch {
  ""country"": $country_name,
  ""genreCount"": $count
};"
neoflix,609,List the first 3 movies that have no revenue reported.,"MATCH (m:Movie)
WHERE m.revenue IS NULL
RETURN m.title
LIMIT 3","match
  $m isa movie;
  not { $m has revenue $r; };
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,610,Which 3 videos have a poster path ending with 'jpg'?,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH 'jpg'
RETURN v.title
LIMIT 3","match
  $v isa video;
  $v has poster_path $poster_path;
  $poster_path like "".*jpg"";
limit 3;
fetch {
  ""title"": $v.title
};"
neoflix,613,Which 3 genres have the least movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count asc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
neoflix,614,What are the top 5 languages spoken in the highest-grossing movies?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  $m isa movie, has revenue $rev;
  spoken_in_language (media: $m, language: $l);
reduce $total_revenue = sum($rev) groupby $l, $ln;
sort $total_revenue desc;
limit 5;
fetch { ""language"": $ln, ""total_revenue"": $total_revenue };"
neoflix,615,List the first 3 people who have a profile path starting with '/p'.,"MATCH (p:Person)
WHERE p.profile_path STARTS WITH '/p'
RETURN p.name, p.profile_path
LIMIT 3","match
  $p isa person;
  $p has profile_path $profile_path;
  $p has person_name $person_name;
  $profile_path like ""/p.*"";
limit 3;
fetch {
  ""name"": $person_name,
  ""profile_path"": $profile_path
};"
neoflix,616,Which 3 keywords are most frequently associated with movies having a budget over $200 million?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 200000000
WITH k, count(*) as frequency
ORDER BY frequency DESC
LIMIT 3
RETURN k.name AS keyword, frequency","match
  $m isa movie, has budget $budget;
  $budget > 200000000;
  $k isa keyword, has keyword_name $name;
  has_keyword (media: $m, keyword: $k);
reduce $frequency = count($m) groupby $k, $name;
sort $frequency desc;
limit 3;
fetch {
  ""keyword"": $name,
  ""frequency"": $frequency
};"
neoflix,618,List the first 3 movies directed by a person named 'John Doe'.,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
LIMIT 3","match
  $p isa person, has person_name ""John Doe"";
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m), has job ""Director"";
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,619,Which 3 movies have the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has revenue $revenue;
  $m has title $title;
let $profit = $revenue - $budget;
sort $profit desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""profit"": $profit
};"
neoflix,621,List the first 3 movies that were rated exactly 5 stars by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $u isa user;
  rated (rated_media: $m, reviewer: $u), has rating 5.0;
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,624,List the first 3 genres that have movies with no keywords associated.,"MATCH (g:Genre)
WHERE NOT EXISTS {
  (g)<-[:IN_GENRE]-(:Movie)-[:HAS_KEYWORD]->(:Keyword)
}
RETURN g.name
LIMIT 3","match
  $g isa genre;
  in_genre (media: $m, genre: $g);
  $m isa movie;
  not { has_keyword (media: $m, keyword: $k); };
limit 3;
fetch {
  ""name"": $g.genre_name
};"
neoflix,625,Which 3 production companies have produced movies in more than 3 different languages?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WITH c, count(distinct l) AS numLangs
WHERE numLangs > 3
RETURN c.name, numLangs
ORDER BY numLangs DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  $l isa language;
  produced_by (media: $m, producer: $c);
  original_language (media: $m, language: $l);
select $l, $c, $name;
distinct;
reduce $num_langs = count groupby $c, $name;
match $num_langs > 3;
sort $num_langs desc;
limit 3;
fetch {
  ""name"": $name,
  ""numLangs"": $num_langs
};"
neoflix,626,What are the top 5 most frequently used keywords in adult films?,"MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
RETURN k.name AS keyword, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $a isa adult_video;
  $k isa keyword, has keyword_name $kn;
  has_keyword (media: $a, keyword: $k);
reduce $frequency = count($a) groupby $k, $kn;
sort $frequency desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $frequency };"
neoflix,627,List the first 3 adult films that have a revenue of 0.,"MATCH (a:Adult)
WHERE a.revenue = 0
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $a has revenue $revenue;
  $revenue == 0.0;
  $a has title $title;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,628,Which 3 videos have the most keywords associated with them?,"MATCH (v:Video)-[:HAS_KEYWORD]->(k:Keyword)
WITH v, count(k) AS keywordCount
RETURN v.title AS video, keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $v isa video;
  has_keyword (media: $v, keyword: $k);
reduce $count = count($k) groupby $v;
sort $count desc;
limit 3;
fetch {
  ""video"": $v.title,
  ""keywordCount"": $count
};"
neoflix,629,What are the top 5 countries by the number of videos produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""videoCount"": $count };"
neoflix,631,Which 3 genres are most common among movies released before 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.release_date < date('2000-01-01')
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has release_date $rd;
  $rd < 2000-01-01;
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
neoflix,634,Which 3 movies have been rated highest by users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $r isa rated (rated_media: $m), has rating $rating;
reduce $avg_rating = mean($rating) groupby $m, $t;
sort $avg_rating desc;
limit 3;
fetch { ""title"": $t, ""avg_rating"": $avg_rating };"
neoflix,639,List the first 3 countries that have produced the most adult films.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $a isa adult_video;
  produced_in_country (media: $a, country: $c);
reduce $count = count($a) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""adultFilmCount"": $count
};"
neoflix,640,Which 3 genres have the highest average votes in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.average_vote) AS avg_vote
RETURN g.name AS genre, avg_vote
ORDER BY avg_vote DESC
LIMIT 3","match
  $m isa movie, has average_vote $av;
  $g isa genre, has genre_name $name;
  in_genre (media: $m, genre: $g);
reduce $avg = mean($av) groupby $g;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""avg_vote"": $avg
};"
neoflix,641,What are the top 5 movies with the most keywords associated?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH m, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5
RETURN m.title AS movie, keywordCount","match
$m isa movie;
has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""keywordCount"": $count
};"
neoflix,642,List the first 3 videos that have been produced in more than one country.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH v, count(c) AS num_countries
WHERE num_countries > 1
RETURN v.title
LIMIT 3","match
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($c) groupby $v;
match $count > 1;
limit 3;
fetch {
  ""title"": $v.title
};"
neoflix,643,What are the top 5 countries by the number of videos produced there?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 5","match
  $c isa country, has country_name $name;
  produced_in_country (media: $v, country: $c);
  $v isa video;
reduce $count = count($v) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c.country_name, ""videoCount"": $count };"
neoflix,644,What are the top 5 most frequently spoken languages in videos?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $v isa video;
  spoken_in_language (media: $v, language: $l);
  $l has language_name $ln;
reduce $frequency = count($v) groupby $l, $ln;
sort $frequency desc;
limit 5;
fetch { ""language"": $ln, ""frequency"": $frequency };"
neoflix,645,List the first 3 movies that were part of more than one collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH m, count(c) AS num_collections
WHERE num_collections > 1
RETURN m.title
LIMIT 3","match
  $m isa movie;
  in_collection (media: $m, collection: $c);
reduce $count = count($c) groupby $m;
match $count > 1;
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,646,Which 3 movies have the most significant number of cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
RETURN m.title AS movie, count(p) AS cast_size
ORDER BY cast_size DESC
LIMIT 3","match
  $m isa movie, has title $t;
  cast_for (film: $m, actor: $p);
reduce $cast_size = count($p) groupby $m, $t;
sort $cast_size desc;
limit 3;
fetch { ""movie"": $t, ""cast_size"": $cast_size };"
neoflix,649,Which 3 people have the highest number of crew credits in movies?,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
RETURN p.name AS person, count(r) AS num_crew_credits
ORDER BY num_crew_credits DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie;
  crew_for (crew_member: $p, film: $m);
reduce $count = count($m) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""person"": $pn, ""num_crew_credits"": $count };"
neoflix,651,List the first 3 adult films that have been produced in the 'United States of America'.,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN a.title
LIMIT 3","match
  $a isa adult_video;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $a, country: $c);
limit 3;
fetch {
  ""title"": $a.title
};"
neoflix,652,Which 3 genres are most popular according to the popularity scores in movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 3","match
  $m isa movie, has popularity $pop;
  in_genre (media: $m, genre: $g);
  $g has genre_name $gn;
reduce $avg_pop = mean($pop) groupby $g, $gn;
sort $avg_pop desc;
limit 3;
fetch { ""genre"": $gn, ""avg_popularity"": $avg_pop };"
neoflix,653,What are the top 5 languages used in the original language of adult films?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $a isa adult_video;
  original_language (media: $a, language: $l);
  $l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,655,What are the top 5 most popular genres based on movie data?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $m isa movie;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""movieCount"": $count
};"
neoflix,657,Which 3 movies have the highest number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
RETURN m.title AS movie, languageCount
ORDER BY languageCount DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""languageCount"": $count
};"
neoflix,659,List the first 3 videos with no budget reported.,"MATCH (v:Video)
WHERE v.budget IS NULL
RETURN v.title, v.budget
LIMIT 3","match
  $v isa video;
  not { $v has budget $b; };
limit 3;
fetch {
  ""title"": $v.title,
  ""budget"": $v.budget
};"
neoflix,660,Which 3 movies have the highest number of production companies associated?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN m.title AS movie, count(c) AS num_production_companies
ORDER BY num_production_companies DESC
LIMIT 3","match
  $m isa movie, has title $t;
  produced_by (media: $m, producer: $c);
reduce $count = count($c) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""num_production_companies"": $count };"
neoflix,661,What are the top 5 genres associated with the highest average votes in videos?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WITH g, avg(v.average_vote) AS avg_vote
ORDER BY avg_vote DESC
LIMIT 5
RETURN g.name AS genre, avg_vote","match
  $v isa video, has average_vote $avg_vote;
  $g isa genre, has genre_name $name;
  in_genre (media: $v, genre: $g);
reduce $avg = mean($avg_vote) groupby $g, $name;
sort $avg desc;
limit 5;
fetch {
  ""genre"": $name,
  ""avg_vote"": $avg
};"
neoflix,663,Which 3 countries have produced the most videos?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $video_count = count($v) groupby $c;
sort $video_count desc;
limit 3;
fetch {
  ""country"": $c.country_name,
  ""video_count"": $video_count
};"
neoflix,673,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie, has title $t;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""keywordCount"": $count };"
neoflix,678,What are the first 5 movies that are part of a collection and have a budget greater than 10000000?,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.budget > 10000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has budget $budget;
  $m has title $title;
  $budget > 10000000;
  in_collection (media: $m, collection: $c);
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,680,List the top 3 movies which are in the genre 'Animation' and have been released.,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Animation'})
WHERE m.status = 'Released'
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $g isa genre, has genre_name ""Animation"";
  in_genre (media: $m, genre: $g);
  $m has status ""Released"";
  $m has title $title;
  $m has release_date $release_date;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity
};"
neoflix,681,What are the first 5 movies directed by a specific director named 'John Doe'?,"MATCH (p:Person {name: 'John Doe'})-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN m.title
ORDER BY m.release_date
LIMIT 5","match
  $p isa person, has person_name ""John Doe"";
  $m isa movie;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  $m has release_date $release_date;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $m.title
};"
neoflix,683,Which 5 movies have been rated by the most users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5","match
$m isa movie, has title $title;
rated (rated_media: $m, reviewer: $u);
$u isa user;
reduce $num_ratings = count($u) groupby $m, $title;
sort $num_ratings desc;
limit 5;
fetch { ""title"": $title, ""num_ratings"": $num_ratings };"
neoflix,688,List the top 3 movies that have been produced in the country 'United States of America'.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $m, country: $c);
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,692,What are the top 5 movies with a release date on or after '2000-01-01'?,"MATCH (m:Movie)
WHERE m.release_date >= date('2000-01-01')
RETURN m.title, m.release_date, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 2000-01-01T00:00:00;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date, ""popularity"": $popularity
};"
neoflix,696,What are the first 5 movies that have a main character named 'Charlie Wilson'?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WHERE p.name IS NOT NULL AND m.title IS NOT NULL
  AND exists{ (p)-[:CAST_FOR {character: 'Charlie Wilson'}]->(m) }
RETURN m.title
LIMIT 5","match
  $m isa movie, has title $title;
  $rel isa cast_for (actor: $p, film: $m), has character ""Charlie Wilson"";
limit 5;
fetch {
  ""title"": $title
};"
neoflix,698,Which 3 movies have been rated 5.0 by users and have a 'Released' status?,"MATCH (m:Movie {status: 'Released'})<-[r:RATED {rating: 5.0}]-(u:User)
RETURN m.title
LIMIT 3","match
  $m isa movie, has status ""Released"", has title $title;
  $u isa user;
  $r isa rated (rated_media: $m, reviewer: $u), has rating 5.0;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,700,What are the top 5 movies that have a genre of 'Comedy' and are rated above 6?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
WHERE m.average_vote > 6
RETURN m.title, m.average_vote
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  in_genre (media: $m, genre: $g);
  $m has average_vote $average_vote;
  $m has title $title;
  $average_vote > 6;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,701,List the first 3 videos that have a poster path ending in '.jpg'.,"MATCH (v:Video)
WHERE v.poster_path ENDS WITH '.jpg'
RETURN v.title, v.poster_path
LIMIT 3","match
  $v isa video;
  $v has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $v has title $title;
limit 3;
fetch {
  ""title"": $title, ""poster_path"": $poster_path
};"
neoflix,704,What are the top 5 videos produced in 'United States of America'?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
RETURN v.title, v.average_vote, v.vote_count
ORDER BY v.average_vote DESC, v.vote_count DESC
LIMIT 5","match
  $v isa video;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $v, country: $c);
  $v has title $title;
  $v has average_vote $average_vote;
  $v has vote_count $vote_count;
sort $average_vote desc, $vote_count desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""vote_count"": $vote_count
};"
neoflix,711,What are the top 5 adult films produced in 'Italy'?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN a.title, a.average_vote
ORDER BY a.average_vote DESC
LIMIT 5","match
  $a isa adult_video;
  $c isa country, has country_name ""Italy"";
  produced_in_country (media: $a, country: $c);
  $a has title $title;
  $a has average_vote $average_vote;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote
};"
neoflix,715,What are the top 3 genres that have the most movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
  $m isa movie;
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""movieCount"": $count };"
neoflix,716,List the first 3 production companies that have produced the most movies.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  produced_by (media: $m, producer: $c);
  $m isa movie;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""num_movies"": $count };"
neoflix,717,Which 3 countries have the most movies produced in them?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  produced_in_country (media: $m, country: $c);
  $m isa movie;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""movieCount"": $count };"
neoflix,718,List the first 5 languages that are most frequently used as the original language in movies.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  (media: $m, language: $l) isa original_language;
  $m isa movie;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,719,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  in_collection (media: $m, collection: $c);
  $m isa movie;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;"
neoflix,720,List the first 3 genres that are most frequently targeted by packages.,"MATCH (p:Package)-[:PROVIDES_ACCESS_TO]->(g:Genre)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  provides_access_to (package: $p, genre: $g);
reduce $frequency = count($p) groupby $g, $gn;
sort $frequency desc;
limit 3;
fetch { ""genre"": $gn, ""frequency"": $frequency };"
neoflix,722,List the top 5 packages by the duration they provide access.,"MATCH (p:Package)
RETURN p.name AS package, p.duration AS duration
ORDER BY duration DESC
LIMIT 5","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_duration $package_duration;
sort $package_duration desc;
limit 5;
fetch {
  ""package"": $package_name, ""duration"": $package_duration
};"
neoflix,724,List the first 3 languages that have been spoken in the most adult films.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $a isa adult_video;
  spoken_in_language (media: $a, language: $l);
  $l has language_name $ln;
reduce $count = count($a) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,725,Which 3 genres are most commonly associated with videos that have a budget over 100000 USD?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.budget > 100000
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  in_genre (media: $v, genre: $g);
  $v isa video, has budget $budget;
  $budget > 100000;
reduce $frequency = count($v) groupby $g, $gn;
sort $frequency desc;
limit 3;
fetch { ""genre"": $gn, ""frequency"": $frequency };"
neoflix,726,List the top 3 countries where the most videos have been produced.,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  produced_in_country (media: $v, country: $c);
  $v isa video;
reduce $count = count($v) groupby $cn;
sort $count desc;
limit 3;"
neoflix,727,What are the first 5 keywords most associated with movies that have a revenue above 1 million USD?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.revenue > 1000000
RETURN k.name, count(*) as count
ORDER BY count DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  has_keyword (media: $m, keyword: $k);
  $m isa movie, has revenue $revenue;
  $revenue > 1000000;
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""count"": $count };"
neoflix,728,List the first 3 genres that have the highest average rating across all movies.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.average_vote IS NOT NULL
WITH g, avg(m.average_vote) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3
RETURN g.name AS genre, avg_rating","match
  $g isa genre, has genre_name $name;
  $m isa movie, has average_vote $vote;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($vote) groupby $g, $name;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $name,
  ""avg_rating"": $avg
};"
neoflix,729,Which 3 production companies have produced the most adult films?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
RETURN c.name AS company, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa adult_video;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""num_adult_films"": $count };"
neoflix,730,List the top 3 people who have acted the most in released movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE m.status = 'Released'
WITH p, count(r) AS num_roles
ORDER BY num_roles DESC
LIMIT 3
RETURN p.name AS person, num_roles","match
  $p isa person, has person_name $name;
  $m isa movie, has status ""Released"";
  $r isa cast_for (actor: $p, film: $m);
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 3;
fetch {
  ""person"": $name,
  ""num_roles"": $count
};"
neoflix,731,What are the top 5 users who have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 5;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
neoflix,732,List the first 3 movies with the highest number of associated keywords and a budget above 50000 USD.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.budget > 50000
WITH m, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3
RETURN m.title AS movie, keywordCount","match
  $m isa movie, has budget $budget, has title $title;
  $budget > 50000;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m;
sort $count desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""keywordCount"": $count
};"
neoflix,733,Which 3 movies have the longest gap between their release date and the current date?,"MATCH (m:Movie)
WHERE m.release_date IS NOT NULL
RETURN m.title, m.release_date, duration.between(date(m.release_date), date()).days AS days_since_release
ORDER BY days_since_release DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has title $title;
sort $release_date asc;
limit 3;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,735,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection;
  in_collection (media: $m, collection: $c);
  $m isa movie;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""collection"": $c.collection_name, ""num_movies"": $count };"
neoflix,736,List the first 3 movies that are part of a collection and have a runtime less than 90 minutes.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
WHERE m.runtime < 90
RETURN m.title, m.runtime
LIMIT 3","match
  $m isa movie;
  $m has runtime $runtime;
  $m has title $title;
  $runtime < 90;
  in_collection (media: $m, collection: $c);
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,741,Which 3 genres are most commonly associated with videos that have a budget over 100000 USD?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.budget > 100000
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $v isa video, has budget $budget;
  $budget > 100000;
  in_genre (media: $v, genre: $g);
  $g has genre_name $name;
reduce $count = count($v) groupby $g;
sort $count desc;
limit 3;
fetch { ""genre"": $g.genre_name, ""frequency"": $count };"
neoflix,744,List the first 3 subscriptions that were initiated in 2020.,"MATCH (s:Subscription)-[:FOR_PACKAGE]->(p:Package)
WHERE s.expiresAt >= date('2020-01-01') AND s.expiresAt < date('2021-01-01')
RETURN s, p
ORDER BY s.expiresAt
LIMIT 3","match
  $s isa subscription, has expires_at $exp;
  $p isa package;
  for_package (subscription: $s, package: $p);
  $exp >= 2020-01-01T00:00:00;
  $exp < 2021-01-01T00:00:00;
sort $exp;
limit 3;
fetch { ""subscription"": $s, ""package"": $p };"
neoflix,745,Which 3 movies have the most cast members named 'Tom Hanks'?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person {name: 'Tom Hanks'})
RETURN m.title, count(p) AS num_tom_hanks
ORDER BY num_tom_hanks DESC
LIMIT 3","match
  $m isa movie;
  $p isa person, has person_name ""Tom Hanks"";
  cast_for (actor: $p, film: $m);
reduce $count = count($p) groupby $m;
sort $count desc;
limit 3;
fetch { ""title"": $m.title, ""num_tom_hanks"": $count };"
neoflix,747,What are the top 5 movies with an original title different from their title?,"MATCH (m:Movie)
WHERE m.original_title <> m.title
RETURN m.title, m.original_title
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has original_title $original_title;
  $m has title $title;
  $m has popularity $popularity;
  $original_title != $title;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""original_title"": $original_title
};"
neoflix,749,Which 3 languages are most frequently used in videos with a runtime over 100 minutes?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE v.runtime > 100
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $v isa video, has runtime $rt;
  original_language (media: $v, language: $l);
  $rt > 100;
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""frequency"": $count };"
neoflix,750,List the first 3 packages that provide the longest duration of access to movies.,"MATCH (p:Package)
RETURN p.name AS package, p.duration AS duration
ORDER BY duration DESC
LIMIT 3","match
  $p isa package;
  $p has package_name $package_name;
  $p has package_duration $package_duration;
sort $package_duration desc;
limit 3;
fetch {
  ""package"": $package_name, ""duration"": $package_duration
};"
neoflix,751,What are the first 5 movies that have a poster path ending in '.jpg'?,"MATCH (m:Movie)
WHERE m.poster_path IS NOT NULL AND m.poster_path ENDS WITH '.jpg'
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $m has title $title;
limit 5;
fetch {
  ""title"": $title
};"
neoflix,752,List the top 3 people who have the most credits as a producer.,"MATCH (p:Person)-[r:CREW_FOR]->(m)
WHERE r.job = 'Producer'
WITH p, count(r) AS num_credits
ORDER BY num_credits DESC
LIMIT 3
RETURN p.name AS person, num_credits","match
  $p isa person, has person_name $person_name;
  $r isa crew_for (crew_member: $p, film: $m), has job ""Producer"";
reduce $count = count($r) groupby $p, $person_name;
sort $count desc;
limit 3;
fetch {
  ""person"": $person_name,
  ""num_credits"": $count
};"
neoflix,753,Which 3 movies have the most distinct languages spoken?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(distinct l) as numLanguages
ORDER BY numLanguages DESC
LIMIT 3
RETURN m.title, numLanguages","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
  $m has title $title;
select $l, $m, $title;
distinct;
reduce $count = count($l) groupby $m, $title;
sort $count desc;
limit 3;
fetch {
  ""title"": $title,
  ""numLanguages"": $count
};"
neoflix,754,List the first 3 movies that have been rated exactly 10 times and have a budget greater than 100000 USD.,"MATCH (m:Movie)
WHERE m.budget > 100000 AND m.vote_count = 10
RETURN m.title, m.budget, m.vote_count
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has vote_count $vote_count;
  $m has title $title;
  $budget > 100000;
  $vote_count == 10;
limit 3;
fetch {
  ""title"": $title, ""budget"": $budget, ""vote_count"": $vote_count
};"
neoflix,756,"List the first 3 movies that have a release date on a specific day, say '1995-12-22'.","MATCH (m:Movie)
WHERE m.release_date = date('1995-12-22')
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has release_date 1995-12-22;
  $m has title $title;
limit 3;
fetch {
  ""title"": $title
};"
neoflix,758,List the first 3 genres most commonly associated with movies that have a budget over $50 million.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 50000000
WITH g, count(*) AS count
ORDER BY count DESC
LIMIT 3
RETURN g.name AS genre, count","match
  $m isa movie, has budget $budget;
  $g isa genre, has genre_name $genre_name;
  in_genre (media: $m, genre: $g);
  $budget > 50000000;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.genre_name,
  ""count"": $count
};"
neoflix,759,Which 3 movies have the most number of keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie, has title $t;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""keywordCount"": $count };"
neoflix,760,Who are the top 5 directors with the most films produced in the United States?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WITH p, count(m) AS num_films
ORDER BY num_films DESC
LIMIT 5
RETURN p.name AS director, num_films","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa country, has country_name ""United States of America"";
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  produced_in_country (media: $m, country: $c);
reduce $num_films = count($m) groupby $p, $name;
sort $num_films desc;
limit 5;
fetch {
  ""director"": $name,
  ""num_films"": $num_films
};"
neoflix,761,What are the top 3 languages spoken in movies that have a revenue greater than $100 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 100000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has revenue $rev;
  $rev > 100000000;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };
"
neoflix,763,Which 3 production companies have produced the most movies with a runtime longer than 120 minutes?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 120
WITH c, count(m) AS num_movies
RETURN c.name AS company, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  $runtime > 120;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,764,What are the top 5 most popular movies released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,765,Who are the first 3 actors by number of roles in movies with a status of 'Released'?,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie {status: 'Released'})
RETURN p.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has status ""Released"";
  $r isa cast_for (actor: $p, film: $m);
reduce $count = count($r) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""actor"": $pn, ""roles"": $count };"
neoflix,766,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 3;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
neoflix,767,What are the top 5 countries with the most movies produced?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)
RETURN c.name AS country, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""movieCount"": $count };"
neoflix,768,List the first 3 genres associated with the highest average movie budget.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.budget IS NOT NULL
WITH g, avg(m.budget) AS avgBudget
ORDER BY avgBudget DESC
LIMIT 3
RETURN g.name AS genre, avgBudget","match
  $g isa genre, has genre_name $name;
  $m isa movie, has budget $budget;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($budget) groupby $g, $name;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $name,
  ""avgBudget"": $avg
};"
neoflix,769,What are the top 3 collections with the most movies included?,"MATCH (c:Collection)<-[:IN_COLLECTION]-(m:Movie)
RETURN c.name AS collection, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa collection, has collection_name $cn;
  in_collection (media: $m, collection: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""collection"": $cn, ""num_movies"": $count };"
neoflix,770,Which 3 directors have worked on the highest-grossing movies?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
RETURN p.name AS director, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has revenue $rev;
  crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $total_revenue = sum($rev) groupby $p, $pn;
sort $total_revenue desc;
limit 3;
fetch { ""director"": $pn, ""total_revenue"": $total_revenue };"
neoflix,771,List the first 3 actors who have starred in the most movies within a single genre.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, g, count(m) AS movieCount
ORDER BY movieCount DESC
RETURN p.name AS actor, g.name AS genre, movieCount
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $g isa genre;
  cast_for (actor: $p, film: $m);
  in_genre (media: $m, genre: $g);
reduce $movieCount = count($m) groupby $p, $g;
sort $movieCount desc;
limit 3;
fetch {
  ""actor"": $p.person_name,
  ""genre"": $g.genre_name,
  ""movieCount"": $movieCount
};"
neoflix,772,What are the top 5 languages in which the most highly rated movies were originally made?,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(l:Language)
WHERE m.vote_count IS NOT NULL AND m.vote_count > 100
RETURN l.name AS language, avg(m.average_vote) AS avg_rating, count(*) AS num_movies
ORDER BY avg_rating DESC
LIMIT 5","match
  $m isa movie;
  $m has vote_count $vc;
  $vc > 100;
  $m has average_vote $av;
  $l isa language, has language_name $ln;
  original_language (media: $m, language: $l);
reduce $avg_rating = mean($av), $num_movies = count($m) groupby $l, $ln;
sort $avg_rating desc;
limit 5;
fetch { ""language"": $ln, ""avg_rating"": $avg_rating, ""num_movies"": $num_movies };"
neoflix,773,Which 3 production companies have the highest average revenue per movie?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.revenue IS NOT NULL
WITH c, avg(m.revenue) AS avg_revenue
RETURN c.name AS company, avg_revenue
ORDER BY avg_revenue DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has revenue $revenue;
  produced_by (producer: $c, media: $m);
reduce $avg = mean($revenue) groupby $c, $name;
sort $avg desc;
limit 3;
fetch {
  ""company"": $name,
  ""avg_revenue"": $avg
};"
neoflix,774,List the first 3 movies that have been rated by the highest number of users.,"MATCH (m:Movie)<-[r:RATED]-(:User)
WITH m, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN m.title AS movie, numRatings","match
  $m isa movie, has title $title;
  rated (reviewer: $u, rated_media: $m);
reduce $count = count groupby $m;
sort $count desc;
limit 3;
fetch { ""movie"": $m.title, ""numRatings"": $count };"
neoflix,775,What are the top 5 genres with the most movies having a runtime of less than 90 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime < 90
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5","match
  $g isa genre, has genre_name $gn;
  $m isa movie, has runtime $rt;
  $rt < 90;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""numMovies"": $count };"
neoflix,776,Who are the first 3 actors to appear in movies from at least two different genres?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH p, count(distinct g) AS genreCount
WHERE genreCount >= 2
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $g isa genre;
  cast_for (actor: $p, film: $m);
  in_genre (media: $m, genre: $g);
select $p, $g, $name;
distinct;
reduce $count = count($g) groupby $p, $name;
match $count >= 2;
limit 3;
fetch {
  ""name"": $name
};"
neoflix,777,Which 3 languages are most commonly found in movies with a poster path featuring '/9'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/9'
WITH m
MATCH (m)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has poster_path $path;
  $path like "".*/9.*"";
  spoken_in_language (media: $m, language: $l);
  $l has language_name $name;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""count"": $count };"
neoflix,779,What are the top 3 highest budget movies that have a poster path ending in 'jpg'?,"MATCH (m:Movie)
WHERE m.poster_path ENDS WITH 'jpg' AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
  $m isa movie;
  $m has poster_path $poster_path;
  $poster_path like "".*jpg"";
  $m has budget $budget;
sort $budget desc;
limit 3;
fetch {
  ""title"": $m.title, ""budget"": $budget
};"
neoflix,780,Which 3 directors have the most movies with an average vote higher than 7?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.average_vote > 7
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN p.name AS director, num_movies","match
  $p isa person, has person_name $name;
  $m isa movie, has average_vote $avg;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  $avg > 7;
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 3;
fetch {
  ""director"": $name,
  ""num_movies"": $count
};"
neoflix,781,List the first 3 countries where the most English language movies are produced.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'English'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS englishMovieCount
ORDER BY englishMovieCount DESC
LIMIT 3","match
  $m isa movie;
  $l isa language, has language_name ""English"";
  (media: $m, language: $l) isa original_language;
  $c isa country, has country_name $cn;
  (media: $m, country: $c) isa produced_in_country;
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""englishMovieCount"": $count };"
neoflix,782,What are the top 5 production companies by the number of movies with a runtime longer than 100 minutes?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 100
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  produced_by (producer: $c, media: $m);
  $runtime > 100;
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,783,List the first 3 actors who have played in movies with at least three different taglines.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.tagline IS NOT NULL
WITH p, count(DISTINCT m.tagline) AS num_taglines
WHERE num_taglines >= 3
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has tagline $tag;
  cast_for (actor: $p, film: $m);
select $p, $pn, $tag;
distinct;
reduce $count = count($tag) groupby $p, $pn;
match $count >= 3;
limit 3;
fetch { ""person_name"": $pn };"
neoflix,784,Which 3 genres have the most videos associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(v:Video)
RETURN g.name AS genre, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $v isa video;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""videoCount"": $count };"
neoflix,785,List the first 3 countries with the most videos produced.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
neoflix,786,What are the top 5 movies with the longest runtime and released after 2010?,"MATCH (m:Movie)
WHERE m.release_date > date('2010-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date > 2010-01-01;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 5;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,788,What are the top 5 genres of movies produced by Pixar Animation Studios?,"MATCH (c:ProductionCompany {name: 'Pixar Animation Studios'})-[:PRODUCED_BY]-(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $c isa production_company, has production_company_name ""Pixar Animation Studios"";
  $m isa movie;
  produced_by (media: $m, producer: $c);
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 5;
fetch { ""genre"": $gn, ""count"": $count };"
neoflix,789,List the first 3 movies with the most revenue that were released after the year 2000.,"MATCH (m:Movie)
WHERE m.release_date > date('2000-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date > 2000-01-01T00:00:00;
  $m has revenue $revenue;
  $m has title $title;
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,790,Who are the first 3 directors to have movies in more than one collection?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)-[:IN_COLLECTION]->(c:Collection)
WITH p, count(distinct c) AS num_collections
WHERE num_collections > 1
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa collection;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
  in_collection (media: $m, collection: $c);
select $p, $name, $c;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count > 1;
limit 3;
fetch {
  ""name"": $name
};"
neoflix,791,What are the top 5 languages in which the most adult films were originally made?,"MATCH (a:Adult)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
  $l isa language, has language_name $ln;
  $m isa adult_video;
  original_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 5;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,792,Which 3 production companies have produced the most adult films?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
RETURN c.name AS company, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa adult_video;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""company"": $cn, ""num_adult_films"": $count };"
neoflix,793,List the top 5 keywords associated with movies that have a runtime over 150 minutes.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.runtime > 150
RETURN k.name AS keyword, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $m isa movie, has runtime $rt;
  $rt > 150;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""frequency"": $count };"
neoflix,794,What are the top 3 countries producing the most adult films with a runtime over 60 minutes?,"MATCH (a:Adult)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE a.runtime > 60
RETURN c.name AS country, count(*) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa adult_video, has runtime $rt;
  $rt > 60;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
neoflix,797,List the first 3 countries where the most English language movies are produced.,"MATCH (m:Movie)-[:ORIGINAL_LANGUAGE]->(:Language {name: 'English'})-[:PRODUCED_IN_COUNTRY]->(c:Country)
RETURN c.name AS country, count(*) AS englishMovieCount
ORDER BY englishMovieCount DESC
LIMIT 3","match
  $m isa movie;
  original_language (media: $m, language: $l);
  $l has language_name ""English"";
  produced_in_country (media: $m, country: $c);
  $c has country_name $name_c;
reduce $count = count($m) groupby $c, $name_c;
sort $count desc;
limit 3;
fetch { ""country"": $name_c, ""englishMovieCount"": $count };"
neoflix,798,Which 3 production companies have produced movies with the highest average popularity?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
RETURN c.name AS company, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $cn;
  $m isa movie, has popularity $pop;
  produced_by (media: $m, producer: $c);
reduce $avg_pop = mean($pop) groupby $c, $cn;
sort $avg_pop desc;
limit 3;
fetch { ""company"": $cn, ""avg_popularity"": $avg_pop };"
neoflix,799,List the first 3 movies with the lowest revenue and released before 1990.,"MATCH (m:Movie)
WHERE m.release_date < date('1990-01-01') AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $m has revenue $revenue;
  $m has title $title;
  $release_date < 1990-01-01;
sort $revenue asc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,800,What are the top 5 most popular genres based on average movie popularity?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, avg(m.popularity) AS avg_popularity
ORDER BY avg_popularity DESC
LIMIT 5
RETURN g.name AS genre, avg_popularity","match
  $g isa genre, has genre_name $genre_name;
  $m isa movie, has popularity $popularity;
  in_genre (genre: $g, media: $m);
reduce $avg = mean($popularity) groupby $g, $genre_name;
sort $avg desc;
limit 5;
fetch {
  ""genre"": $genre_name,
  ""avg_popularity"": $avg
};"
neoflix,801,Who are the first 3 actors to star in movies from both the horror and comedy genres?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE (m)-[:IN_GENRE]->(:Genre {name: 'Horror'})
AND (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN p.name
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  cast_for (actor: $p, film: $m);
  $g1 isa genre, has genre_name ""Horror"";
  $g2 isa genre, has genre_name ""Comedy"";
  in_genre (media: $m, genre: $g1);
  in_genre (media: $m, genre: $g2);
limit 3;
fetch {
  ""name"": $name
};"
neoflix,802,Which 3 languages are most common in movies with a budget over $30 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.budget > 30000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has budget $budget;
  spoken_in_language (media: $m, language: $l);
  $budget > 30000000;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,803,List the first 3 genres of movies with the highest average vote count.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.vote_count) AS avg_votes
ORDER BY avg_votes DESC
LIMIT 3
RETURN g.name AS genre, avg_votes","match
  $m isa movie, has vote_count $vc;
  $g isa genre, has genre_name $gn;
  in_genre (media: $m, genre: $g);
reduce $avg = mean($vc) groupby $g, $gn;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $gn,
  ""avg_votes"": $avg
};"
neoflix,804,What are the top 5 movies with the highest budget that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01') AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 1990-01-01T00:00:00;
  $release_date < 2000-01-01T00:00:00;
  $m has budget $budget;
  $m has title $title;
sort $budget desc;
limit 5;
fetch {
  ""title"": $title, ""budget"": $budget
};"
neoflix,805,Who are the first 3 directors with movies that have a runtime of over 180 minutes?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.runtime > 180
RETURN p.name AS director
ORDER BY director
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel0 has job ""Director"";
  $p has person_name $person_name_p;
  $m has runtime $runtime_m;
  $runtime_m > 180;
sort $person_name_p asc;
limit 3;
fetch {
  ""director"": $person_name_p
};"
neoflix,806,Which 3 production companies have the most movies with a vote count over 1000?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.vote_count > 1000
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has vote_count $vc;
  $vc > 1000;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,808,What are the top 3 languages spoken in videos that have a revenue greater than $0?,"MATCH (v:Video)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE v.revenue > 0
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $v isa video, has revenue $rev;
  $rev > 0;
  spoken_in_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,810,List the first 3 genres with the most adult films associated.,"MATCH (g:Genre)<-[:IN_GENRE]-(a:Adult)
WITH g, count(a) AS adultCount
ORDER BY adultCount DESC
RETURN g.name AS genre, adultCount
LIMIT 3","match
  $g isa genre, has genre_name $genre_name;
  $a isa adult_video;
  in_genre (genre: $g, media: $a);
reduce $count = count($a) groupby $g, $genre_name;
sort $count desc;
limit 3;
fetch {
  ""genre"": $genre_name,
  ""adultCount"": $count
};"
neoflix,811,What are the top 5 movies with the most number of spoken languages?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH m, count(l) AS languageCount
ORDER BY languageCount DESC
LIMIT 5
RETURN m.title AS movie, languageCount AS spokenLanguages","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""spokenLanguages"": $count
};"
neoflix,812,Which 3 directors have worked on movies with the longest total runtime?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WITH p, sum(m.runtime) AS total_runtime
RETURN p.name AS director, total_runtime
ORDER BY total_runtime DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie, has runtime $runtime;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $total = sum($runtime) groupby $p, $name;
sort $total desc;
limit 3;
fetch {
  ""director"": $name,
  ""total_runtime"": $total
};"
neoflix,815,Who are the first 3 actors to have starred in at least 3 movies from the 'Toy Story Collection'?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WITH p, count(m) AS num_movies
WHERE num_movies >= 3
RETURN p.name
ORDER BY num_movies DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa collection, has collection_name ""Toy Story Collection"";
  cast_for (actor: $p, film: $m);
  in_collection (media: $m, collection: $c);
reduce $count = count($m) groupby $p, $name;
match $count >= 3;
sort $count desc;
limit 3;
fetch {
  ""name"": $name
};"
neoflix,816,Which 3 languages are spoken most commonly in movies with a runtime longer than 120 minutes?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.runtime > 120
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has runtime $rt;
  $rt > 120;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,817,List the first 3 genres that have the most movies featuring Tom Hanks.,"MATCH (p:Person {name: 'Tom Hanks'})-[:CAST_FOR]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS movie_count
ORDER BY movie_count DESC
LIMIT 3","match
  $p isa person, has person_name ""Tom Hanks"";
  $m isa movie;
  $g isa genre, has genre_name $gn;
  cast_for (actor: $p, film: $m);
  in_genre (media: $m, genre: $g);
reduce $movie_count = count($m) groupby $g, $gn;
sort $movie_count desc;
limit 3;
fetch { ""genre"": $gn, ""movie_count"": $movie_count };"
neoflix,818,What are the top 5 production companies by the number of comedy films produced?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN c.name AS company, count(*) AS comedyCount
ORDER BY comedyCount DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  produced_by (media: $m, producer: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name, ""comedyCount"": $count };"
neoflix,819,List the first 3 genres of movies with the highest average vote count.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.vote_count) AS avg_votes
ORDER BY avg_votes DESC
LIMIT 3
RETURN g.name AS genre, avg_votes","match
  $m isa movie, has vote_count $votes;
  in_genre (media: $m, genre: $g);
  $g has genre_name $name;
reduce $avg = mean($votes) groupby $g, $name;
sort $avg desc;
limit 3;
fetch { ""genre"": $name, ""avg_votes"": $avg };"
neoflix,823,List the top 5 keywords associated with the most commercially successful movies.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WITH k, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN k.name AS keyword, total_revenue","match
  $m isa movie;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
  $m has revenue $revenue;
reduce $total = sum($revenue) groupby $k;
sort $total desc;
limit 5;
fetch {
  ""keyword"": $k.keyword_name,
  ""total_revenue"": $total
};"
neoflix,824,What are the top 3 countries producing the most comedies?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN c.name AS country, count(*) AS comedyCount
ORDER BY comedyCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa movie;
  $g isa genre, has genre_name ""Comedy"";
  produced_in_country (media: $m, country: $c);
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;"
neoflix,825,Who are the first 3 actors who have starred in both comedies and dramas?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE (m)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
  AND (p)-[:CAST_FOR]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m1 isa movie;
  $m2 isa movie;
  $g1 isa genre, has genre_name ""Comedy"";
  $g2 isa genre, has genre_name ""Drama"";
  cast_for (actor: $p, film: $m1);
  cast_for (actor: $p, film: $m2);
  in_genre (media: $m1, genre: $g1);
  in_genre (media: $m2, genre: $g2);
  $p has person_name $name;
limit 3;
fetch {
  ""name"": $name
};"
neoflix,826,Which 3 languages are spoken in the most films with a poster featuring '/rh'?,"MATCH (m:Movie)
WHERE m.poster_path CONTAINS '/rh'
WITH m
MATCH (m)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has poster_path $path;
  $path like "".*/rh.*"";
  spoken_in_language (media: $m, language: $l);
  $l has language_name $name_l;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l.language_name, ""count"": $count };"
neoflix,827,List the first 3 genres of movies with the lowest average revenue.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, avg(m.revenue) AS avg_revenue
ORDER BY avg_revenue
RETURN g.name AS genre, avg_revenue
LIMIT 3","match
  $m isa movie, has revenue $revenue;
  $g isa genre, has genre_name $name;
  in_genre (media: $m, genre: $g);
reduce $avg = mean($revenue) groupby $g, $name;
sort $avg asc;
limit 3;
fetch {
  ""genre"": $name,
  ""avg_revenue"": $avg
};"
neoflix,828,What are the top 5 movies with a tagline that includes the word 'adventure'?,"MATCH (m:Movie)
WHERE toLower(m.tagline) CONTAINS 'adventure'
RETURN m.title, m.tagline
ORDER BY m.popularity DESC
LIMIT 5","match
  $m isa movie;
  $m has tagline $tagline;
  $tagline like ""(?i).*adventure.*"";
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 5;
fetch {
  ""title"": $title, ""tagline"": $tagline
};"
neoflix,829,Who are the first 3 directors of movies with a budget less than $5 million?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.budget < 5000000
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel0 has job ""Director"";
  $p has person_name $person_name_p;
  $m has budget $budget_m;
  $budget_m < 5000000;
limit 3;
fetch {
  ""name"": $person_name_p
};"
neoflix,830,Which 3 production companies have produced the most films with a release date before 1980?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.release_date < date('1980-01-01')
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has release_date $rd;
  produced_by (producer: $c, media: $m);
  $rd < 1980-01-01;
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,832,"What are the top 3 countries where the most videos with a budget over $500,000 are produced?","MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 500000
RETURN c.name AS country, count(*) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $v isa video, has budget $budget;
  $budget > 500000;
  produced_in_country (media: $v, country: $c);
reduce $video_count = count($v) groupby $cn;
sort $video_count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $video_count };"
neoflix,834,List the first 3 genres with the most movies released in the 21st century.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.release_date >= date('2000-01-01')
WITH g, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN g.name AS genre, num_movies","match
  $g isa genre, has genre_name $genre_name;
  $m isa movie, has release_date $release_date;
  in_genre (genre: $g, media: $m);
  $release_date >= 2000-01-01T00:00:00;
reduce $count = count($m) groupby $g, $genre_name;
sort $count desc;
limit 3;
fetch {
  ""genre"": $genre_name,
  ""num_movies"": $count
};"
neoflix,835,What are the top 5 movies with the most keywords?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 5","match
  $m isa movie, has title $title;
  has_keyword (media: $m, keyword: $k);
reduce $keyword_count = count($k) groupby $m, $title;
sort $keyword_count desc;
limit 5;
fetch { ""movie"": $title, ""keywordCount"": $keyword_count };"
neoflix,836,Which 3 directors have the highest average vote for their movies?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WITH p, avg(m.average_vote) AS avg_vote
RETURN p.name AS director, avg_vote
ORDER BY avg_vote DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie, has average_vote $avg_vote;
  $rel isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $avg = mean($avg_vote) groupby $p, $name;
sort $avg desc;
limit 3;
fetch {
  ""director"": $name,
  ""avg_vote"": $avg
};"
neoflix,837,List the first 3 movies with the most unique spoken languages.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN m.title AS movie, collect(DISTINCT l.name) AS languages, size(collect(DISTINCT l.name)) AS numLanguages
ORDER BY numLanguages DESC
LIMIT 3","match
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
reduce $num_languages = count($l) groupby $m;
sort $num_languages desc;
limit 3;
fetch {
  ""movie"": $m.title,
  ""numLanguages"": $num_languages
};"
neoflix,838,What are the top 5 countries with the most movies featuring an average vote over 7.5?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE m.average_vote > 7.5
RETURN c.name AS country, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie, has average_vote $av;
  $av > 7.5;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""num_movies"": $count };"
neoflix,839,Who are the first 3 actors to have roles in movies with at least five different production companies?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)<-[:PRODUCED_BY]-(c:ProductionCompany)
WITH p, count(DISTINCT c) AS num_companies
WHERE num_companies >= 5
RETURN p.name
ORDER BY num_companies DESC
LIMIT 3","match
  $p isa person, has person_name $name;
  $m isa movie;
  $c isa production_company;
  cast_for (actor: $p, film: $m);
  produced_by (media: $m, producer: $c);
select $p, $c, $name;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count >= 5;
sort $count desc;
limit 3;
fetch {
  ""name"": $name
};
"
neoflix,840,Which 3 languages are most commonly found in movies with a status of 'In Production'?,"MATCH (m:Movie {status: 'In Production'})-[:SPOKEN_IN_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $m isa movie, has status ""In Production"";
  $l isa language, has language_name $ln;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,841,List the top 5 adult films based on the number of different languages spoken.,"MATCH (a:Adult)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WITH a, count(distinct l) as numLanguages
ORDER BY numLanguages DESC
LIMIT 5
RETURN a.title as title, numLanguages","match
  $a isa adult_video, has title $title;
  spoken_in_language (media: $a, language: $l);
select $a, $title, $l;
distinct;
reduce $count = count($l) groupby $a, $title;
sort $count desc;
limit 5;
fetch {
  ""title"": $title,
  ""numLanguages"": $count
};"
neoflix,844,Which 3 production companies have produced the most movies with a popularity over 20?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.popularity > 20
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN c.name AS company, num_movies","match
  $c isa production_company;
  $m isa movie, has popularity $pop;
  $pop > 20;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch {
  ""company"": $c.production_company_name,
  ""num_movies"": $count
};"
neoflix,845,List the first 3 movies that have a homepage and were released after 2010.,"MATCH (m:Movie)
WHERE m.homepage IS NOT NULL AND m.release_date > date('2010-01-01')
RETURN m.title, m.homepage, m.release_date
LIMIT 3","match
  $m isa movie;
  $m has homepage $homepage;
  $m has release_date $release_date;
  $release_date > 2010-01-01;
  $m has title $title;
limit 3;
fetch {
  ""title"": $title, ""homepage"": $homepage, ""release_date"": $release_date
};"
neoflix,846,Who are the first 3 actors who starred in movies that won at least one Oscar?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.title IN ['The Lord of the Rings: The Return of the King', 'Titanic', 'Forrest Gump']
RETURN p.name
LIMIT 3","match
  $p isa person;
  $m isa movie;
  cast_for (actor: $p, film: $m);
  { $m has title ""The Lord of the Rings: The Return of the King""; } or
  { $m has title ""Titanic""; } or
  { $m has title ""Forrest Gump""; };
limit 3;
fetch {
  ""name"": $p.person_name
};"
neoflix,847,Which 3 languages are most commonly spoken in movies with an average vote below 4?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.average_vote < 4
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has average_vote $av;
  $av < 4;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,848,List the first 3 movies with the highest number of directors.,"MATCH (m:Movie)<-[:CREW_FOR]-(p:Person)
WHERE p.job = 'Director'
WITH m, count(p) AS num_directors
ORDER BY num_directors DESC
RETURN m.title AS movie, num_directors
LIMIT 3","match
  $m isa movie, has title $title;
  $crew isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($p) groupby $m, $title;
sort $count desc;
limit 3;
fetch { ""movie"": $title, ""num_directors"": $count };"
neoflix,849,What are the top 5 production companies with the most movies featuring a runtime over 150 minutes?,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 150
WITH c, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN c.name AS company, num_movies","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  produced_by (producer: $c, media: $m);
  $runtime > 150;
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,850,Who are the first 3 directors who have worked on movies with an average vote below 5?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WHERE m.average_vote < 5
RETURN p.name AS director
ORDER BY m.average_vote
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $rel0 isa crew_for (crew_member: $p, film: $m);
  $rel0 has job ""Director"";
  $p has person_name $person_name_p;
  $m has average_vote $average_vote_m;
  $average_vote_m < 5;
sort $average_vote_m asc;
limit 3;
fetch {
  ""director"": $person_name_p
};"
neoflix,851,What are the top 5 countries producing the most movies with a tagline that includes the word 'love'?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE toLower(m.tagline) CONTAINS 'love'
RETURN c.name AS country, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa movie;
  produced_in_country (media: $m, country: $c);
  $m has tagline $tag;
  $tag like "".*[Ll]ove.*"";
reduce $movie_count = count($m) groupby $cn;
sort $movie_count desc;
limit 5;"
neoflix,852,Which 3 production companies have the most movies with a runtime under 80 minutes?,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime < 80
WITH c, count(m) AS num_movies
RETURN c.name AS company, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $runtime;
  $runtime < 80;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};"
neoflix,854,What are the top 5 genres with the most movies having a poster path that starts with '/rh'?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.poster_path STARTS WITH '/rh'
RETURN g.name AS genre, count(m) AS movie_count
ORDER BY movie_count DESC
LIMIT 5","match
  $m isa movie, has poster_path $path;
  $path like ""/rh.*"";
  in_genre (media: $m, genre: $g);
  $g has genre_name $name;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch { ""genre"": $g.genre_name, ""movie_count"": $count };"
neoflix,856,Which 3 languages are most common in movies with a revenue over $200 million?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.revenue > 200000000
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie, has revenue $rev;
  $rev > 200000000;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,857,List the top 5 movies with the most production companies involved.,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)
RETURN m.title AS movie, count(c) AS numCompanies
ORDER BY numCompanies DESC
LIMIT 5","match
  $m isa movie;
  produced_by (media: $m, producer: $c);
reduce $num_companies = count($c) groupby $m;
sort $num_companies desc;
limit 5;
fetch { ""movie"": $m.title, ""numCompanies"": $num_companies };"
neoflix,858,What are the top 3 countries producing the most videos with a budget over $1 million?,"MATCH (v:Video)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WHERE v.budget > 1000000
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $v isa video, has budget $budget;
  $budget > 1000000;
  $c isa country, has country_name $cn;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
neoflix,859,Who are the first 3 actors to have appeared in movies from more than five different countries?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH p, count(distinct c) as numCountries
WHERE numCountries > 5
RETURN p.name
ORDER BY numCountries DESC
LIMIT 3","match
  $p isa person;
  $m isa movie;
  $c isa country;
  cast_for (actor: $p, film: $m);
  produced_in_country (media: $m, country: $c);
  $p has person_name $name;
select $p, $c, $name;
distinct;
reduce $count = count($c) groupby $p, $name;
match $count > 5;
sort $count desc;
limit 3;
fetch {
  ""name"": $name
};"
neoflix,860,List the first 3 genres with the most movies featuring a runtime over 200 minutes.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 200
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
  $g isa genre, has genre_name $gn;
  $m isa movie, has runtime $rt;
  $rt > 200;
  in_genre (media: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""numMovies"": $count };"
neoflix,861,What are the top 5 movies with the most spoken languages and released after 2015?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2015-01-01')
WITH m, count(l) AS languageCount
RETURN m.title, languageCount
ORDER BY languageCount DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date > 2015-01-01;
  spoken_in_language (media: $m, language: $l);
reduce $count = count($l) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""title"": $m.title,
  ""languageCount"": $count
};"
neoflix,862,Which 3 directors have the most films with a status of 'Released'?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie {status: 'Released'})
RETURN p.name AS director, count(m) AS num_released_movies
ORDER BY num_released_movies DESC
LIMIT 3","match
  $p isa person, has person_name $pn;
  $m isa movie, has status ""Released"";
  crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($m) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""director"": $pn, ""num_released_movies"": $count };"
neoflix,864,List the first 3 languages spoken in movies released after 2010.,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.release_date > date('2010-01-01')
RETURN l.name AS language
ORDER BY language
LIMIT 3","match
  $m isa movie;
  $l isa language;
  spoken_in_language (media: $m, language: $l);
  $m has release_date $release_date;
  $release_date > 2010-01-01;
  $l has language_name $language_name;
sort $language_name asc;
limit 3;
fetch {
  ""language"": $language_name
};"
neoflix,865,Which 5 movies have the highest average vote and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.average_vote IS NOT NULL
RETURN m.title, m.average_vote, m.release_date
ORDER BY m.average_vote DESC
LIMIT 5","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date < 2000-01-01;
  $m has average_vote $average_vote;
  $m has title $title;
sort $average_vote desc;
limit 5;
fetch {
  ""title"": $title, ""average_vote"": $average_vote, ""release_date"": $release_date
};"
neoflix,866,Name the top 3 production companies by the number of movies produced with a budget over 100 million USD.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(m:Movie)
WHERE m.budget > 100000000
WITH c, count(m) AS num_movies
RETURN c.name AS company, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has budget $budget;
  $budget > 100000000;
  produced_by (producer: $c, media: $m);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 3;
fetch {
  ""company"": $name,
  ""num_movies"": $count
};
"
neoflix,869,Which 3 movies have the most keywords associated with them?,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
RETURN m.title AS movie, count(k) AS keywordCount
ORDER BY keywordCount DESC
LIMIT 3","match
  $m isa movie, has title $t;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
reduce $count = count($k) groupby $m, $t;
sort $count desc;
limit 3;
fetch { ""movie"": $t, ""keywordCount"": $count };"
neoflix,870,List the top 5 actors by the number of movies they have cast in.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS actor, num_movies","match
  $p isa person, has person_name $name;
  cast_for (actor: $p, film: $m);
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""num_movies"": $count
};"
neoflix,872,Which 5 users have rated the highest number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 5
RETURN u, num_ratings","match
  $u isa user;
  $m isa movie;
  $r isa rated (reviewer: $u, rated_media: $m);
reduce $count = count($r) groupby $u;
sort $count desc;
limit 5;
fetch {
  ""user"": $u.user_id,
  ""num_ratings"": $count
};"
neoflix,873,Name the top 3 genres in videos that have a runtime less than 30 minutes.,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime < 30
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $v isa video, has runtime $rt;
  $rt < 30;
  $g isa genre, has genre_name $gn;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn };"
neoflix,874,List the first 5 production companies that produced videos with zero revenue.,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(v:Video)
WHERE v.revenue = 0
RETURN c.name
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $v isa video, has revenue $r;
  $r == 0.0;
  produced_by (producer: $c, media: $v);
limit 5;
fetch {
  ""name"": $name
};"
neoflix,875,What are the top 3 countries where adult films are produced the most?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $m isa adult_video;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
neoflix,876,"Which 5 keywords are most common in adult films with a budget less than 500,000 USD?","MATCH (a:Adult)-[:HAS_KEYWORD]->(k:Keyword)
WHERE a.budget < 500000
RETURN k.name, count(*) as count
ORDER BY count DESC
LIMIT 5","match
  $k isa keyword, has keyword_name $kn;
  $m isa adult_video, has budget $budget;
  has_keyword (media: $m, keyword: $k);
  $budget < 500000;
reduce $count = count($m) groupby $k, $kn;
sort $count desc;
limit 5;
fetch { ""keyword"": $kn, ""count"": $count };"
neoflix,877,List the top 3 movies with the highest revenue that are part of a collection.,"MATCH (m:Movie)-[:IN_COLLECTION]->(:Collection)
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
  $m isa movie;
  $m has title $title;
  $m has revenue $revenue;
  in_collection (media: $m, collection: $c);
sort $revenue desc;
limit 3;
fetch {
  ""title"": $title, ""revenue"": $revenue
};"
neoflix,878,"Name the first 5 movies that were rated by users on a specific date, e.g., '2020-01-01'.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE date(r.timestamp) = date('2020-01-01')
RETURN m.title
LIMIT 5","match
  $m isa movie;
  $u isa user;
  $r isa rated (rated_media: $m, reviewer: $u), has timestamp $timestamp;
  $timestamp >= 2020-01-01T00:00:00;
  $timestamp < 2020-01-02T00:00:00;
limit 5;
fetch {
  ""title"": $m.title
};"
neoflix,881,Which 3 languages are most frequently listed as the original language in videos?,"MATCH (v:Video)-[:ORIGINAL_LANGUAGE]->(l:Language)
RETURN l.name AS language, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  $v isa video;
  $l isa language, has language_name $ln;
  original_language (media: $v, language: $l);
reduce $count = count($v) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""frequency"": $count };"
neoflix,883,What are the first 3 genres associated with the highest-grossing movies?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
RETURN g.name AS genre, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match
  $m isa movie, has revenue $rev;
  in_genre (media: $m, genre: $g);
  $g has genre_name $name;
reduce $total = sum($rev) groupby $g, $name;
sort $total desc;
limit 3;
fetch { ""genre"": $name, ""total_revenue"": $total };"
neoflix,884,Name the top 5 directors who have worked on the most films.,"MATCH (p:Person)-[r:CREW_FOR]->(m:Movie)
WHERE r.job = 'Director'
WITH p, count(r) AS num_films
ORDER BY num_films DESC
LIMIT 5
RETURN p.name AS director, num_films","match
  $p isa person, has person_name $name;
  $r isa crew_for (crew_member: $p, film: $m), has job ""Director"";
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""director"": $name,
  ""num_films"": $count
};"
neoflix,886,Which 5 movies have the most cast members?,"MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
RETURN m.title AS movie, count(p) AS cast_size
ORDER BY cast_size DESC
LIMIT 5","match
  $m isa movie;
  cast_for (actor: $p, film: $m);
reduce $cast_size = count($p) groupby $m;
sort $cast_size desc;
limit 5;
fetch { ""movie"": $m.title, ""cast_size"": $cast_size };"
neoflix,887,List the top 3 countries by the number of videos produced.,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(v:Video)
RETURN c.name AS country, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $v isa video;
  produced_in_country (media: $v, country: $c);
reduce $count = count($v) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""country"": $cn, ""videoCount"": $count };"
neoflix,890,List the first 5 adult films released after 2010.,"MATCH (a:Adult)
WHERE a.release_date > date('2010-01-01')
RETURN a.title, a.release_date
ORDER BY a.release_date
LIMIT 5","match
  $a isa adult_video;
  $a has release_date $release_date;
  $a has title $title;
  $release_date > 2010-01-01;
sort $release_date asc;
limit 5;
fetch {
  ""title"": $title, ""release_date"": $release_date
};"
neoflix,891,Which 3 users have given the highest ratings to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.id AS user, avg(r.rating) AS avg_rating
ORDER BY avg_rating DESC
LIMIT 3","match
  $u isa user, has user_id $uid;
  $rel isa rated (rated_media: $m, reviewer: $u), has rating $rating;
  $m isa movie;
reduce $avg_rating = mean($rating) groupby $u, $uid;
sort $avg_rating desc;
limit 3;
fetch { ""user"": $uid, ""avg_rating"": $avg_rating };"
neoflix,892,List the top 5 actors based on the number of leading roles they have had in movies.,"MATCH (p:Person)-[r:CAST_FOR]->(m:Movie)
WHERE r.order = 0
WITH p, count(r) AS leadingRoles
ORDER BY leadingRoles DESC
LIMIT 5
RETURN p.name AS actor, leadingRoles","match
  $p isa person, has person_name $name;
  $m isa movie;
  $r isa cast_for (actor: $p, film: $m), has cast_order $order;
  $order == 0;
reduce $count = count($r) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""leadingRoles"": $count
};"
neoflix,893,What are the first 3 movies that were produced in the United States and have a vote count greater than 5000?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WHERE m.vote_count > 5000
RETURN m.title
LIMIT 3","match
  $m isa movie;
  $m has vote_count $vote_count;
  $vote_count > 5000;
  $c isa country, has country_name ""United States of America"";
  produced_in_country (media: $m, country: $c);
limit 3;
fetch {
  ""title"": $m.title
};"
neoflix,894,Name the top 5 production companies that have produced movies with a runtime longer than 150 minutes.,"MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m:Movie)
WHERE m.runtime > 150
RETURN c.name AS company, count(*) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match
  $c isa production_company, has production_company_name $name;
  $m isa movie, has runtime $rt;
  $rt > 150;
  produced_by (media: $m, producer: $c);
reduce $count = count($m) groupby $c, $name;
sort $count desc;
limit 5;
fetch { ""company"": $name, ""num_movies"": $count };"
neoflix,895,List the first 3 keywords associated with movies that have a poster path ending in '.jpg'.,"MATCH (m:Movie)-[:HAS_KEYWORD]->(k:Keyword)
WHERE m.poster_path ENDS WITH '.jpg'
RETURN k.name
LIMIT 3","match
  $m isa movie;
  $k isa keyword;
  has_keyword (media: $m, keyword: $k);
  $m has poster_path $poster_path;
  $poster_path like "".*\\.jpg"";
  $k has keyword_name $keyword_name;
limit 3;
fetch {
  ""name"": $keyword_name
};"
neoflix,896,Which 5 genres are most common among movies with a budget over 200 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 200000000
WITH g, count(*) AS count
ORDER BY count DESC
LIMIT 5
RETURN g.name AS genre, count","match
  $m isa movie, has budget $budget;
  $g isa genre, has genre_name $genre_name;
  in_genre (media: $m, genre: $g);
  $budget > 200000000;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 5;
fetch {
  ""genre"": $g.genre_name,
  ""count"": $count
};"
neoflix,899,What are the top 3 movies based on popularity that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.release_date >= date('1990-01-01') AND m.release_date < date('2000-01-01')
RETURN m.title, m.popularity
ORDER BY m.popularity DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date >= 1990-01-01;
  $release_date < 2000-01-01;
  $m has title $title;
  $m has popularity $popularity;
sort $popularity desc;
limit 3;
fetch {
  ""title"": $title, ""popularity"": $popularity
};"
neoflix,901,Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, m.budget/m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 3","match
  $m isa movie;
  $m has budget $budget;
  $m has revenue $revenue;
  $m has title $title;
let $ratio = $budget / $revenue;
sort $ratio desc;
limit 3;
fetch {
  ""title"": $title,
  ""budget"": $budget,
  ""revenue"": $revenue,
  ""ratio"": $ratio
};"
neoflix,906,Which 5 countries have produced the most adult films?,"MATCH (c:Country)<-[:PRODUCED_IN_COUNTRY]-(a:Adult)
RETURN c.name AS country, count(a) AS adultFilmCount
ORDER BY adultFilmCount DESC
LIMIT 5","match
  $c isa country, has country_name $cn;
  $m isa adult_video;
  produced_in_country (media: $m, country: $c);
reduce $count = count($m) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""country"": $cn, ""adultFilmCount"": $count };"
neoflix,909,What are the top 3 genres associated with videos that have a runtime over 100 minutes?,"MATCH (v:Video)-[:IN_GENRE]->(g:Genre)
WHERE v.runtime > 100
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $v isa video, has runtime $rt;
  $rt > 100;
  $g isa genre, has genre_name $gn;
  in_genre (media: $v, genre: $g);
reduce $count = count($v) groupby $g, $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn, ""count"": $count };"
neoflix,910,List the first 5 production companies that have produced the most adult films.,"MATCH (c:ProductionCompany)<-[:PRODUCED_BY]-(a:Adult)
WITH c, count(a) AS adultCount
ORDER BY adultCount DESC
LIMIT 5
RETURN c.name AS productionCompany, adultCount","match
  $c isa production_company, has production_company_name $name;
  $a isa adult_video;
  produced_by (producer: $c, media: $a);
reduce $count = count($a) groupby $c, $name;
sort $count desc;
limit 5;
fetch {
  ""productionCompany"": $name,
  ""adultCount"": $count
};"
neoflix,911,Which 3 movies have the longest runtime and were released before 2000?,"MATCH (m:Movie)
WHERE m.release_date < date('2000-01-01') AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
  $m isa movie;
  $m has release_date $release_date;
  $release_date < 2000-01-01;
  $m has runtime $runtime;
  $m has title $title;
sort $runtime desc;
limit 3;
fetch {
  ""title"": $title, ""runtime"": $runtime
};"
neoflix,912,List the top 5 actors by the number of movies they have cast in with a budget over 50 million USD.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE m.budget > 50000000
WITH p, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5
RETURN p.name AS actor, num_movies","match
  $p isa person, has person_name $name;
  $m isa movie, has budget $budget;
  cast_for (actor: $p, film: $m);
  $budget > 50000000;
reduce $count = count($m) groupby $p, $name;
sort $count desc;
limit 5;
fetch {
  ""actor"": $name,
  ""num_movies"": $count
};"
neoflix,913,What are the first 3 languages spoken in the most popular movies (popularity > 20)?,"MATCH (m:Movie)-[:SPOKEN_IN_LANGUAGE]->(l:Language)
WHERE m.popularity > 20
RETURN l.name AS language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
  $l isa language, has language_name $ln;
  $m isa movie;
  spoken_in_language (media: $m, language: $l);
  $m has popularity $pop;
  $pop > 20;
reduce $count = count($m) groupby $l, $ln;
sort $count desc;
limit 3;
fetch { ""language"": $ln, ""count"": $count };"
neoflix,594,List the first 3 users who rated the adult film titled 'Standoff'.,"MATCH (u:User)-[:RATED]->(a:Adult {title: 'Standoff'})
RETURN u
LIMIT 3","match
$u isa user;
$a isa adult_video, has title ""Standoff"";
rated (reviewer: $u, rated_media: $a);
limit 3;
fetch { ""user"": $u.user_id };"
neoflix,666,Which 3 adult films have been rated by the most users?,"MATCH (a:Adult)<-[r:RATED]-(u:User)
RETURN a.title, count(r) AS num_ratings
ORDER BY num_ratings DESC
LIMIT 3","match
$a isa adult_video;
$r isa rated (rated_media: $a);
reduce $num_ratings = count($r) groupby $a;
sort $num_ratings desc;
limit 3;
fetch { ""title"": $a.title, ""num_ratings"": $num_ratings };"
neoflix,742,List the top 3 adult films that have been rated exactly 3 times.,"MATCH (a:Adult)<-[r:RATED]-(u:User)
WITH a, count(r) AS ratingCount
WHERE ratingCount = 3
RETURN a.title AS title, a.release_date AS releaseDate
ORDER BY a.popularity DESC
LIMIT 3","match
$a isa adult_video;
$r isa rated (rated_media: $a);
reduce $rating_count = count($r) groupby $a;
match
$rating_count == 3;
$a has popularity $pop;
sort $pop desc;
limit 3;
fetch { ""title"": $a.title, ""releaseDate"": $a.release_date };"
neoflix,787,Who are the first 3 actors by number of roles in adult films?,"MATCH (p:Person)-[:CAST_FOR]->(a:Adult)
WITH p, count(a) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name AS actor, roles","match
$p isa person;
$a isa adult_video;
cast_for (actor: $p, film: $a);
reduce $roles = count($a) groupby $p;
sort $roles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""roles"": $roles };"
neoflix,855,Who are the first 3 directors to have made both adult films and videos?,"MATCH (p:Person)-[:CREW_FOR]->(a:Adult), (p)-[:CREW_FOR]->(v:Video)
WHERE a.id IS NOT NULL AND v.id IS NOT NULL
WITH p, count(DISTINCT a) AS numAdult, count(DISTINCT v) AS numVideo
WHERE numAdult > 0 AND numVideo > 0
RETURN p.name
LIMIT 3","match
$p isa person;
$a isa adult_video;
$r1 isa crew_for (crew_member: $p, film: $a), has job ""Director"";
$v isa video;
not { $v isa adult_video; };
$r2 isa crew_for (crew_member: $p, film: $v), has job ""Director"";
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
neoflix,879,What are the top 3 actors who have played in the most number of adult films?,"MATCH (p:Person)-[:CAST_FOR]->(a:Adult)
WITH p, count(a) AS num_adult_films
ORDER BY num_adult_films DESC
LIMIT 3
RETURN p.name AS actor, num_adult_films","match
$p isa person;
$a isa adult_video;
cast_for (actor: $p, film: $a);
reduce $num_adult_films = count($a) groupby $p;
sort $num_adult_films desc;
limit 3;
fetch { ""actor"": $p.person_name, ""num_adult_films"": $num_adult_films };"
neoflix,421,What are the first 5 actors who have starred in both a movie and an adult film?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE EXISTS {
  (p)-[:CAST_FOR]->(:Adult)
}
RETURN p.name
LIMIT 5","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$a isa adult_video;
cast_for (actor: $p, film: $a);
select $p;
distinct;
limit 5;
fetch { ""name"": $p.person_name };"
neoflix,795,Who are the first 3 actors with roles in both movies and adult films?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE EXISTS {(p)-[:CAST_FOR]->(:Adult)}
RETURN p.name
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$a isa adult_video;
cast_for (actor: $p, film: $a);
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
neoflix,821,Who are the first 3 directors who have worked on both movies and adult films?,"MATCH (p:Person)-[:CREW_FOR]->(m:Movie)
WHERE (p)-[:CREW_FOR]->(:Adult)
  AND exists{ (p)-[:CREW_FOR {job: 'Director'}]->(:Movie) }
  AND exists{ (p)-[:CREW_FOR {job: 'Director'}]->(:Adult) }
RETURN p.name
LIMIT 3","match
$p isa person;
$r1 isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$m isa movie;
$r2 isa crew_for (crew_member: $p, film: $a), has job ""Director"";
$a isa adult_video;
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
neoflix,80,List all movies that have a backdrop path available.,"MATCH (m:Movie)
WHERE m.backdrop_path IS NOT NULL
RETURN m.title","match
$m isa movie, has backdrop_path $bp;
fetch { ""title"": $m.title };"
neoflix,228,List the first 3 movies with a backdrop path that includes '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'.,"MATCH (m:Movie)
WHERE m.backdrop_path IS NOT NULL AND m.backdrop_path CONTAINS '/9FBwqcd9IRruEDUrTdcaafOMKUq.jpg'
RETURN m.title
LIMIT 3","match
$m isa movie, has backdrop_path $bp;
$bp like "".*9FBwqcd9IRruEDUrTdcaafOMKUq.*"";
limit 3;
fetch { ""title"": $m.title };"
neoflix,312,Which 3 videos have the most associated cast members?,"MATCH (v:Video)<-[:CAST_FOR]-(p:Person)
RETURN v.title AS video, count(p) AS cast_members
ORDER BY cast_members DESC
LIMIT 3","match
$v isa video;
$p isa person;
cast_for (actor: $p, film: $v);
reduce $cast_members = count($p) groupby $v;
sort $cast_members desc;
limit 3;
fetch { ""video"": $v.title, ""cast_members"": $cast_members };"
neoflix,362,Name the top 5 movies that have been produced in more than 3 countries.,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(c:Country)
WITH m, count(c) AS countryCount
WHERE countryCount > 3
RETURN m.title
ORDER BY m.popularity DESC
LIMIT 5","match
$m isa movie;
$c isa country;
produced_in_country (media: $m, country: $c);
reduce $country_count = count($c) groupby $m;
match
$country_count > 3;
$m has popularity $pop;
sort $pop desc;
limit 5;
fetch { ""title"": $m.title };"
neoflix,457,Name the first 5 movies that have been rated by at least 50 users.,"MATCH (m:Movie)<-[r:RATED]-(:User)
WITH m, count(r) AS num_ratings
WHERE num_ratings >= 50
RETURN m.title
ORDER BY num_ratings DESC
LIMIT 5","match
$m isa movie;
$r isa rated (rated_media: $m);
reduce $num_ratings = count($r) groupby $m;
match
$num_ratings >= 50;
sort $num_ratings desc;
limit 5;
fetch { ""title"": $m.title };"
neoflix,504,Which movies have been produced in the 'United States of America' and have an adult rating?,"MATCH (m:Movie)-[:PRODUCED_IN_COUNTRY]->(:Country {name: 'United States of America'})
WHERE exists {(u:User)-[:RATED]->(a:Adult)<-[:RATED]-(u)-[:RATED]->(m)} 
RETURN m.title","match
$m isa movie;
$co isa country, has country_name ""United States of America"";
produced_in_country (media: $m, country: $co);
$u isa user;
$a isa adult_video;
rated (reviewer: $u, rated_media: $a);
rated (reviewer: $u, rated_media: $m);
select $m;
distinct;
fetch { ""title"": $m.title };"
neoflix,527,Which movies have a runtime longer than the average runtime of all movies?,"MATCH (m:Movie)
WITH m, avg(m.runtime) AS avg_runtime
WHERE m.runtime > avg_runtime
RETURN m.title, m.runtime
ORDER BY m.runtime DESC","with fun avg_movie_runtime() -> double:
  match $m isa movie, has runtime $r;
  return mean($r);

match
$m isa movie, has runtime $r;
let $avg = avg_movie_runtime();
$r > $avg;
sort $r desc;
fetch { ""title"": $m.title, ""runtime"": $r };"
neoflix,607,"Which 3 production companies are associated with the most number of genres across movies, videos, and adult films?","MATCH (c:ProductionCompany)-[:PRODUCED_BY]-(m)
WHERE m:Movie OR m:Video OR m:Adult
WITH c, count(distinct m) AS num_genres
RETURN c.name AS company, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$c isa production_company;
produced_by (media: $m, producer: $c);
in_genre (media: $m, genre: $g);
select $c, $g;
distinct;
reduce $num_genres = count($g) groupby $c;
sort $num_genres desc;
limit 3;
fetch { ""company"": $c.production_company_name, ""num_genres"": $num_genres };"
neoflix,622,Which 3 people have acted in the most number of videos?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video)
WITH p, count(v) AS videoCount
ORDER BY videoCount DESC
LIMIT 3
RETURN p.name AS person, videoCount","match
$p isa person;
$v isa video;
cast_for (actor: $p, film: $v);
reduce $video_count = count($v) groupby $p;
sort $video_count desc;
limit 3;
fetch { ""person"": $p.person_name, ""videoCount"": $video_count };"
neoflix,809,Who are the first 3 actors by number of roles in videos with a status of 'Released'?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video {status: 'Released'})
RETURN p.name AS actor, count(*) AS num_roles
ORDER BY num_roles DESC
LIMIT 3","match
$p isa person;
$v isa video, has status ""Released"";
cast_for (actor: $p, film: $v);
reduce $num_roles = count($v) groupby $p;
sort $num_roles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""num_roles"": $num_roles };"
neoflix,831,Who are the first 3 actors to have starred in at least 3 movies from the 'Toy Story Collection'?,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)-[:IN_COLLECTION]->(c:Collection {name: 'Toy Story Collection'})
WITH p, count(m) AS num_movies
WHERE num_movies >= 3
RETURN p.name
ORDER BY num_movies DESC
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$c isa collection, has collection_name ""Toy Story Collection"";
in_collection (media: $m, collection: $c);
reduce $num_movies = count($m) groupby $p;
match
$num_movies >= 3;
sort $num_movies desc;
limit 3;
fetch { ""name"": $p.person_name };"
neoflix,833,Who are the first 3 actors with the most roles in videos released after 2010?,"MATCH (p:Person)-[:CAST_FOR]->(v:Video)
WHERE v.release_date > date('2010-01-01')
WITH p, count(v) AS roles
ORDER BY roles DESC
LIMIT 3
RETURN p.name AS actor, roles","match
$p isa person;
$v isa video, has release_date $rd;
$rd > 2010-01-01T00:00:00;
cast_for (actor: $p, film: $v);
reduce $roles = count($v) groupby $p;
sort $roles desc;
limit 3;
fetch { ""actor"": $p.person_name, ""roles"": $roles };"
neoflix,843,Who are the first 3 directors with movies in at least three different genres?,"MATCH (p:Person)-[:CREW_FOR {job: 'Director'}]->(m:Movie)
WITH p, count(distinct m.id) AS num_movies, collect(distinct m.id) AS movie_ids
WHERE num_movies >= 3
WITH p, num_movies, movie_ids
UNWIND movie_ids AS movie_id
MATCH (m:Movie {id: movie_id})-[:IN_GENRE]->(g:Genre)
WITH p, num_movies, collect(distinct g.name) AS genres
WHERE size(genres) >= 3
RETURN p.name AS director, num_movies, genres
ORDER BY num_movies DESC
LIMIT 3","match
$p isa person;
$cf isa crew_for (crew_member: $p, film: $m), has job ""Director"";
$m isa movie;
in_genre (media: $m, genre: $g);
select $p, $g;
distinct;
reduce $num_genres = count($g) groupby $p;
match
$num_genres >= 3;
sort $num_genres desc;
limit 3;
fetch { ""director"": $p.person_name, ""num_genres"": $num_genres };"
neoflix,853,List the first 3 actors who have appeared in at least three movies with different original languages.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(DISTINCT m.original_language) AS num_languages
WHERE num_languages >= 3
RETURN p.name
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
original_language (media: $m, language: $l);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages >= 3;
limit 3;
fetch { ""name"": $p.person_name };"
neoflix,897,List the top 3 actors who have appeared in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WITH p, count(m) AS numMovies
WHERE numMovies > 0
MATCH (p)-[:CAST_FOR]->(v:Video) 
WITH p, numMovies, count(v) AS numVideos
WHERE numVideos > 0
RETURN p.name AS actor, numMovies, numVideos
ORDER BY numMovies + numVideos DESC
LIMIT 3","with fun movie_count($p: person) -> integer:
  match cast_for (actor: $p, film: $m); $m isa movie;
  return count;

with fun video_count($p: person) -> integer:
  match cast_for (actor: $p, film: $v); $v isa video;
  return count;

match
$p isa person;
let $num_movies = movie_count($p);
let $num_videos = video_count($p);
$num_movies > 0;
$num_videos > 0;
let $total = $num_movies + $num_videos;
sort $total desc;
limit 3;
fetch { ""actor"": $p.person_name, ""numMovies"": $num_movies, ""numVideos"": $num_videos };"
neoflix,796,List the first 3 actors with roles in both movies and videos.,"MATCH (p:Person)-[:CAST_FOR]->(m:Movie)
WHERE exists{ (p)-[:CAST_FOR]->(:Video) }
RETURN p.name
LIMIT 3","match
$p isa person;
$m isa movie;
cast_for (actor: $p, film: $m);
$v isa video;
cast_for (actor: $p, film: $v);
select $p;
distinct;
limit 3;
fetch { ""name"": $p.person_name };"
neoflix,225,What are the first 5 movies that have a genre change from their original genre in a collection?,"MATCH (m:Movie)-[:IN_COLLECTION]->(c:Collection)
WHERE EXISTS {
  (m)-[:IN_GENRE]->(g1:Genre)
  WHERE NOT EXISTS {
    (c)-[:IN_GENRE]->(g2:Genre)
    WHERE g1.name = g2.name
  }
}
RETURN m.title, c.name
LIMIT 5","match
$m isa movie;
$c isa collection;
in_collection (media: $m, collection: $c);
in_genre (media: $m, genre: $g);
not { in_genre (media: $c, genre: $g); };
select $m, $c;
distinct;
limit 5;
fetch { ""title"": $m.title, ""collection"": $c.collection_name };"
neoflix,524,Which movies have been produced by companies based in 'France'?,"MATCH (m:Movie)-[:PRODUCED_BY]->(c:ProductionCompany)-[:PRODUCED_IN_COUNTRY]->(country:Country {name: 'France'})
RETURN m.title","match
$m isa movie;
$co isa country, has country_name ""France"";
produced_in_country (media: $m, country: $co);
fetch { ""title"": $m.title };"
neoflix,902,"List the top 5 movies with the most diverse cast, measured by the number of different countries actors come from.","MATCH (m:Movie)<-[:CAST_FOR]-(p:Person)
WITH m, size(collect(distinct p.country)) AS num_countries
ORDER BY num_countries DESC
LIMIT 5
RETURN m.title AS movie, num_countries AS number_of_countries","match
$m isa movie;
$p isa person;
cast_for (actor: $p, film: $m);
born_in (person: $p, country: $co);
select $m, $co;
distinct;
reduce $num_countries = count($co) groupby $m;
sort $num_countries desc;
limit 5;
fetch { ""movie"": $m.title, ""number_of_countries"": $num_countries };"
recommendations,0,What are the top 5 movies with a runtime greater than 120 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has runtime $r, has title $t;
$r > 120;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
recommendations,1,List the first 3 directors born before 1950.,"MATCH (d:Director)
WHERE d.born < date('1950-01-01')
RETURN d.name, d.born
ORDER BY d.born
LIMIT 3","match
$d isa person, has born $b, has name $n;
directed (director: $d, film: $m);
$b < 1950-01-01;
sort $b asc;
limit 3;
fetch { ""name"": $n, ""born"": $b };"
recommendations,2,Which 5 users have rated more than 20 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
WHERE numRatings > 20
RETURN u.name, numRatings
ORDER BY numRatings DESC
LIMIT 5","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $u, $n;
match $numRatings > 20;
sort $numRatings desc;
limit 5;
fetch { ""name"": $n, ""numRatings"": $numRatings };"
recommendations,3,Identify the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
match $numMovies > 10;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,4,What are the top 3 genres associated with movies released after 2000?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.year > 2000
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has year $y;
$y > 2000;
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $n;
sort $count desc;
limit 3;
fetch { ""genre"": $n, ""count"": $count };"
recommendations,5,List the first 3 movies with a budget over 100 million dollars.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has budget $b, has title $t;
$b > 100000000;
sort $b desc;
limit 3;
fetch { ""title"": $t, ""budget"": $b };"
recommendations,6,Which 5 directors have directed at least 5 movies with an IMDb rating above 7.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 7.0
WITH d, count(m) AS numMovies
WHERE numMovies >= 5
RETURN d.name AS director, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$d isa person, has name $n;
$m isa movie, has imdb_rating $r;
$r > 7.0;
directed (director: $d, film: $m);
reduce $num_movies = count($m) groupby $d, $n;
match $num_movies >= 5;
sort $num_movies desc;
limit 5;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
recommendations,7,Show the top 3 actors who have acted in movies that generated over 500 million in revenue.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
WITH a, count(m) AS numHighRevenueMovies
ORDER BY numHighRevenueMovies DESC
LIMIT 3
RETURN a.name AS actor, numHighRevenueMovies","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has revenue $rev;
$rev > 500000000;
reduce $numHighRevenueMovies = count($m) groupby $n;
sort $numHighRevenueMovies desc;
limit 3;
fetch { ""actor"": $n, ""numHighRevenueMovies"": $numHighRevenueMovies };"
recommendations,8,What are the first 5 movies that were rated by users named 'John Smith'?,"MATCH (u:User {name: 'John Smith'})-[r:RATED]->(m:Movie)
RETURN m.title
ORDER BY r.timestamp
LIMIT 5","match
$u isa user, has name ""John Smith"";
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has timestamp $ts;
sort $ts asc;
limit 5;
fetch { ""title"": $t };"
recommendations,9,List the top 3 users who have given the highest average ratings.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avg = mean($rating) groupby $u;
sort $avg desc;
limit 3;
fetch {
  ""user"": $u.name,
  ""avgRating"": $avg
};"
recommendations,10,Which 5 movies have the most number of votes on IMDb?,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,11,Identify the first 3 genres most frequently linked to movies directed by 'Steven Spielberg'.,"MATCH (d:Director {name: 'Steven Spielberg'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
$d isa person, has name ""Steven Spielberg"";
$g isa genre, has name $gn;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;
fetch {
  ""genre"": $gn,
  ""frequency"": $count
};"
recommendations,12,Show the top 5 movies with revenues exceeding 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
$r > 1000000000;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,13,List the first 3 actors who have played roles in both comedy and action movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Action']
WITH a, count(DISTINCT g.name) AS numGenres
WHERE numGenres = 2
RETURN a.name
LIMIT 3","match
$a isa person, has name $n;
$comedy isa genre, has name ""Comedy"";
$action isa genre, has name ""Action"";
acted_in (actor: $a, film: $m1);
acted_in (actor: $a, film: $m2);
in_genre (film: $m1, genre: $comedy);
in_genre (film: $m2, genre: $action);
limit 3;
fetch { ""name"": $n };"
recommendations,14,Which 5 directors were born in the USA and have directed at least 3 movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn CONTAINS 'USA'
WITH d, count(m) AS numMovies
WHERE numMovies >= 3
RETURN d.name, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$d isa person, has name $n, has born_in $b;
directed (director: $d, film: $m);
$b like ""%USA%"";
reduce $count = count($m) groupby $d, $n;
match $count >= 3;
sort $count desc;
limit 5;
fetch {
  ""name"": $n,
  ""numMovies"": $count
};"
recommendations,15,What are the top 3 movies with the highest IMDb ratings that were released in the 1990s?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.year >= 1990 AND m.year < 2000
RETURN m.title, m.imdbRating, m.year
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_rating $r, has year $y;
$y >= 1990;
$y < 2000;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""imdbRating"": $r, ""year"": $y };"
recommendations,16,List the first 5 movies that involve actors born in France.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor {bornIn: 'France'})
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t;
$a isa person, has born_in ""France"";
acted_in (actor: $a, film: $m);
limit 5;
fetch { ""title"": $t };"
recommendations,17,Show the top 3 highest-grossing movies of the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y >= 2000;
$y < 2010;
sort $r desc;
limit 3;
fetch { ""movie"": $t, ""revenue"": $r };"
recommendations,18,Identify the first 5 actors who have acted in movies with a budget less than 50 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 50000000
RETURN a.name
LIMIT 5","match
$a isa person, has name $n;
$m isa movie, has budget $b;
acted_in (actor: $a, film: $m);
$b < 50000000;
limit 5;
fetch { ""name"": $n };"
recommendations,19,What are the top 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.year
ORDER BY m.year
LIMIT 3","match
$m isa movie, has title $t, has year $y;
sort $y asc;
limit 3;
fetch { ""title"": $t, ""year"": $y };"
recommendations,20,List the first 5 directors who have a biography listed in the database.,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
LIMIT 5","match
$d isa person, has name $n, has bio $b;
directed (director: $d, film: $m);
limit 5;
fetch { ""name"": $n, ""bio"": $b };"
recommendations,24,List the top 3 movies that have been released on Christmas Day.,"MATCH (m:Movie)
WHERE m.released ENDS WITH ""12-25""
RETURN m.title, m.released, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has released $r, has imdb_rating $ir;
$r like ""%12-25"";
sort $ir desc;
limit 3;
fetch { ""title"": $t, ""released"": $r, ""imdbRating"": $ir };"
recommendations,25,Which 5 actors have the highest number of credited roles in the database?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
sort $count desc;
limit 5;
fetch {
  ""actor"": $n,
  ""roles"": $count
};"
recommendations,26,Identify the first 3 directors who have directed a movie with an IMDb rating lower than 4.0.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating < 4.0
RETURN d.name AS director, m.title AS movie, m.imdbRating AS rating
ORDER BY m.imdbRating
LIMIT 3","match
$d isa person, has name $dn;
$m isa movie, has title $t, has imdb_rating $r;
directed (director: $d, film: $m);
$r < 4.0;
sort $r asc;
limit 3;
fetch { ""director"": $dn, ""movie"": $t, ""rating"": $r };"
recommendations,27,Show the top 5 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r asc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
recommendations,29,What are the top 3 highest-budget films directed by directors born in the UK?,"MATCH (d:Director {bornIn: 'UK'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, m.budget AS budget
ORDER BY m.budget DESC
LIMIT 3","match
$d isa person, has born_in ""UK"";
$m isa movie, has title $t, has budget $b;
directed (director: $d, film: $m);
sort $b desc;
limit 3;
fetch { ""movie"": $t, ""budget"": $b };"
recommendations,30,List the top 5 oldest actors in the database.,"MATCH (a:Actor)
WHERE a.born IS NOT NULL
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match
$a isa person, has name $n, has born $b;
acted_in (actor: $a, film: $m);
sort $b asc;
limit 5;
fetch { ""name"": $n, ""born"": $b };"
recommendations,31,Which 5 users have rated the most number of 'Horror' movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Horror'})
RETURN u.name AS user, count(r) AS horror_movies_rated
ORDER BY horror_movies_rated DESC
LIMIT 5","match
$u isa user, has name $n;
$g isa genre, has name ""Horror"";
$r isa rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($r) groupby $u, $n;
sort $count desc;
limit 5;
fetch {
  ""user"": $n,
  ""horror_movies_rated"": $count
};"
recommendations,32,Identify the first 3 movies with the most number of genres associated.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS movie, genreCount","match
$m isa movie, has title $t;
in_genre (film: $m, genre: $g);
reduce $count = count($g) groupby $m, $t;
sort $count desc;
limit 3;
fetch {
  ""movie"": $t,
  ""genreCount"": $count
};"
recommendations,34,What are the first 5 movies where the main actor has also directed the film?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 5","match
$p isa person;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
limit 5;
fetch { ""title"": $t };"
recommendations,35,List the top 3 directors who have also acted in a movie they directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(d)
WITH d, count(*) AS both
ORDER BY both DESC
LIMIT 3
RETURN d.name AS director, both AS directedAndActedCount","match
$d isa person, has name $n;
directed (director: $d, film: $m);
acted_in (actor: $d, film: $m);
reduce $count = count($m) groupby $d;
sort $count desc;
limit 3;
fetch {
  ""director"": $d.name,
  ""directedAndActedCount"": $count
};"
recommendations,36,Identify the first 3 users who have rated movies released before 1980.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.year < 1980
WITH u, r, m
ORDER BY r.timestamp
RETURN u.name AS user, m.title AS movie, m.year AS year
LIMIT 3","match
$u isa user, has name $un;
$m isa movie, has title $t, has year $y;
$r isa rated (user: $u, film: $m), has timestamp $ts;
$y < 1980;
sort $ts asc;
limit 3;
fetch { ""user"": $un, ""movie"": $t, ""year"": $y };"
recommendations,37,Show the top 5 movies with the most IMDb votes released after 2010.,"MATCH (m:Movie)
WHERE m.year > 2010 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes, m.year
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v, has year $y;
$y > 2010;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v, ""year"": $y };"
recommendations,38,What are the first 5 movies with a plot containing the word 'adventure'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t, has plot $p;
$p like ""%adventure%"";
limit 5;
fetch { ""title"": $t };"
recommendations,39,List the top 3 movies with the most revenue that have a runtime under 90 minutes.,"MATCH (m:Movie)
WHERE m.runtime < 90 AND exists((m)<-[:RATED]-())
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has runtime $rt;
rated (user: $u, film: $m);
$rt < 90;
sort $rev desc;
limit 3;
fetch { ""movie"": $t, ""revenue"": $rev };"
recommendations,40,Which 5 directors have directed movies in more than 3 different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 5","match
$d isa person, has name $n;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
select $d, $n, $g;
distinct;
reduce $num_genres = count($g) groupby $d, $n;
match $num_genres > 3;
sort $num_genres desc;
limit 5;
fetch { ""director"": $n, ""num_genres"": $num_genres };"
recommendations,41,Identify the first 3 actors who have acted in movies with at least three different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 3
RETURN a.name AS actor
ORDER BY numDirectors DESC
LIMIT 3","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
directed (director: $d, film: $m);
select $a, $n, $d;
distinct;
reduce $numDirectors = count($d) groupby $a, $n;
match $numDirectors >= 3;
sort $numDirectors desc;
limit 3;
fetch { ""actor"": $n };"
recommendations,43,What are the first 5 movies to have a poster URL containing 'face'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m.title
LIMIT 5","match
$m isa movie, has title $t, has poster $p;
$p like ""%face%"";
limit 5;
fetch { ""title"": $t };"
recommendations,44,List the top 3 movies with a budget under 10 million that have generated over 100 million in revenue.,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has budget $b, has revenue $r;
$b < 10000000;
$r > 100000000;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
recommendations,45,Which 5 users have the most ratings in the 'Comedy' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN u.name AS user, count(r) AS comedyRatings
ORDER BY comedyRatings DESC
LIMIT 5","match
$u isa user, has name $n;
$g isa genre, has name ""Comedy"";
$r isa rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($r) groupby $u, $n;
sort $count desc;
limit 5;
fetch {
  ""user"": $n,
  ""comedyRatings"": $count
};"
recommendations,47,What are the names of the top 5 movies with a budget over 100 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title
ORDER BY m.budget DESC
LIMIT 5","match
$m isa movie, has title $t, has budget $b;
$b > 100000000;
sort $b desc;
limit 5;
fetch { ""title"": $t };"
recommendations,48,List the names of 3 directors who directed a movie released after 2010.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.released > '2010'
RETURN d.name
LIMIT 3","match
$d isa person, has name $n;
$m isa movie, has year $y;
directed (director: $d, film: $m);
$y > 2010;
limit 3;
fetch { ""name"": $n };"
recommendations,49,Who are the actors in the movie titled 'Open Season'?,"MATCH (m:Movie {title: 'Open Season'})<-[:ACTED_IN]-(a:Actor)
RETURN a.name AS actor","match
$m isa movie, has title ""Open Season"";
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
fetch { ""actor"": $n };"
recommendations,50,"Which movies have been rated by more than 600,000 IMDb users?","MATCH (m:Movie)
WHERE m.imdbVotes > 600000
RETURN m.title, m.imdbVotes","match
$m isa movie, has title $t, has imdb_votes $v;
$v > 600000;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,51,Name the top 5 highest-grossing movies directed by Harold Lloyd.,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match
$d isa person, has name ""Harold Lloyd"";
$m isa movie, has title $t, has revenue $r;
directed (director: $d, film: $m);
sort $r desc;
limit 5;
fetch { ""movie"": $t, ""revenue"": $r };"
recommendations,52,What are the three most recent movies added to the database?,"MATCH (m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match
$m isa movie, has title $t, has released $r;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""released"": $r };"
recommendations,53,List all genres associated with the movie 'Toy Story'.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
$m isa movie, has title ""Toy Story"";
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
fetch { ""genre"": $gn };"
recommendations,54,Who are the top 5 actors by the number of movies acted in the 'Adventure' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
WITH a, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5
RETURN a.name AS actor, movieCount","match
$a isa person, has name $n;
$g isa genre, has name ""Adventure"";
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $a;
sort $count desc;
limit 5;
fetch {
  ""actor"": $a.name,
  ""movieCount"": $count
};"
recommendations,55,What are the IMDb ratings of movies directed by Franois Lallement?,"MATCH (p:Person {name: 'Franois Lallement'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, m.imdbRating AS imdbRating","match
$d isa person, has name ""Franois Lallement"";
$m isa movie, has title $t, has imdb_rating $r;
directed (director: $d, film: $m);
fetch { ""movie"": $t, ""imdbRating"": $r };"
recommendations,56,Which users rated the movie with an IMDb ID '0787474'?,"MATCH (u:User)-[r:RATED]->(m:Movie {imdbId: '0787474'})
RETURN u.name AS user, r.rating AS rating","match
$m isa movie, has imdb_id ""0787474"";
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
fetch { ""user"": $n, ""rating"": $rating };"
recommendations,57,List the top 3 highest revenue movies released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y >= 2000;
$y < 2010;
sort $r desc;
limit 3;
fetch { ""movie"": $t, ""revenue"": $r };"
recommendations,58,What are the names of users who rated a movie from the 'Animation' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Animation'})
RETURN u.name","match
$u isa user, has name $n;
$g isa genre, has name ""Animation"";
rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""name"": $n };"
recommendations,59,Find the names of all directors who were born in France.,"MATCH (d:Director)
WHERE d.bornIn = 'France'
RETURN d.name","match
$d isa person, has name $n, has born_in ""France"";
directed (director: $d, film: $m);
fetch { ""name"": $n };"
recommendations,60,Which movies have a runtime longer than 180 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 180
RETURN m.title, m.runtime","match
$m isa movie, has title $t, has runtime $r;
$r > 180;
fetch { ""title"": $t, ""runtime"": $r };"
recommendations,61,Name the actors who have acted in movies with a budget less than 50 million dollars.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 50000000
RETURN DISTINCT a.name AS actor","match
$a isa person, has name $n;
$m isa movie, has budget $b;
acted_in (actor: $a, film: $m);
$b < 50000000;
fetch { ""actor"": $n };"
recommendations,62,List the movies that have been both directed and acted in by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
$p isa person, has name $n;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
fetch { ""movie"": $t, ""person"": $n };"
recommendations,64,Which movies have won more than 200 million dollars but were rated below 6.0 on IMDb?,"MATCH (m:Movie)
WHERE m.revenue > 200000000 AND m.imdbRating < 6.0
RETURN m.title, m.revenue, m.imdbRating","match
$m isa movie, has title $t, has revenue $r, has imdb_rating $ir;
$r > 200000000;
$ir < 6.0;
fetch { ""title"": $t, ""revenue"": $r, ""imdbRating"": $ir };"
recommendations,65,List the movies where the primary language is English and have a runtime of exactly 96 minutes.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND m.runtime = 96
RETURN m.title","match
$m isa movie, has title $t, has languages $l, has runtime $r;
$l like ""%English%"";
$r == 96;
fetch { ""title"": $t };"
recommendations,66,Name the top 5 movies with the most IMDb votes released before the year 2000.,"MATCH (m:Movie)
WHERE m.year < 2000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v, has year $y;
$y < 2000;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,67,Which genres have the most movies with a runtime over 120 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 120
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 10","match
$g isa genre, has name $gn;
$m isa movie, has runtime $r;
in_genre (film: $m, genre: $g);
$r > 120;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 10;
fetch {
  ""genre"": $g.name,
  ""numMovies"": $count
};"
recommendations,68,List the names of movies that have a plot mentioning 'friendship'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title","match
$m isa movie, has title $t, has plot $p;
$p like ""%friendship%"";
fetch { ""title"": $t };"
recommendations,70,Who are the directors of movies that have an IMDb rating greater than 8.0?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
WHERE m.imdbRating > 8.0
RETURN DISTINCT d.name AS director","match
$d isa person, has name $n;
$m isa movie, has imdb_rating $r;
directed (director: $d, film: $m);
$r > 8.0;
fetch { ""director"": $n };"
recommendations,71,List the movies that have been rated by user '1'.,"MATCH (u:User {userId: '1'})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating $rating;
fetch { ""title"": $t, ""rating"": $rating };"
recommendations,72,Which actors have appeared in movies released in the 'Comedy' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN DISTINCT a.name AS actor","match
$a isa person, has name $n;
$g isa genre, has name ""Comedy"";
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""actor"": $n };"
recommendations,73,"What are the names of the movies directed by persons born in 'Burchard, Nebraska, USA'?","MATCH (p:Person {bornIn: 'Burchard, Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title","match
$p isa person, has born_in ""Burchard, Nebraska, USA"";
$m isa movie, has title $t;
directed (director: $p, film: $m);
fetch { ""title"": $t };"
recommendations,74,Name the movies where the main language is not English and have a budget over 75 million dollars.,"MATCH (m:Movie)
WHERE m.languages[0] <> 'English' AND m.budget > 75000000
RETURN m.title","match
$m isa movie, has title $t, has languages $l, has budget $b;
not { $l like ""English%""; };
$b > 75000000;
fetch { ""title"": $t };"
recommendations,75,List the top 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
recommendations,76,Name genres in which Harold Lloyd has directed movies.,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name","match
$d isa person, has name ""Harold Lloyd"";
$g isa genre, has name $gn;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""name"": $gn };"
recommendations,77,Which users have rated movies directed by directors born after 1960?,"MATCH (u:User)-[:RATED]->(m:Movie)<-[:DIRECTED]-(d:Director)
WHERE d.born > date('1960-01-01')
RETURN DISTINCT u","match
$u isa user, has name $un;
$d isa person, has born $b;
rated (user: $u, film: $m);
directed (director: $d, film: $m);
$b > 1960-01-01;
fetch { ""user"": $un };"
recommendations,78,Name the movies that have posters ending with 'w5Lctmkc1yah215Luxmci4djaiW.jpg'.,"MATCH (m:Movie)
WHERE m.poster ENDS WITH 'w5Lctmkc1yah215Luxmci4djaiW.jpg'
RETURN m.title","match
$m isa movie, has title $t, has poster $p;
$p like ""%w5Lctmkc1yah215Luxmci4djaiW.jpg"";
fetch { ""title"": $t };"
recommendations,79,List the top 3 actors by the number of roles in movies released after 2010.,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year > 2010
RETURN a.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match
$a isa person, has name $n;
$m isa movie, has year $y;
$r isa acted_in (actor: $a, film: $m);
$y > 2010;
reduce $count = count($r) groupby $a;
sort $count desc;
limit 3;
fetch {
  ""actor"": $a.name,
  ""roles"": $count
};"
recommendations,80,Which movies have been rated by users named 'Omar Huffman'?,"MATCH (u:User {name: 'Omar Huffman'})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match
$u isa user, has name ""Omar Huffman"";
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating $rating;
fetch { ""movie"": $t, ""rating"": $rating };"
recommendations,81,Name the genres of movies that have a plot mentioning 'army'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.plot CONTAINS 'army'
RETURN DISTINCT g.name","match
$m isa movie, has plot $p;
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
$p like ""%army%"";
fetch { ""name"": $gn };"
recommendations,82,List movies with a revenue less than 20 million dollars and released before 1980.,"MATCH (m:Movie)
WHERE m.revenue < 20000000 AND m.released < '1980-01-01'
RETURN m.title, m.released, m.revenue","match
$m isa movie, has title $t, has revenue $r, has year $y;
$r < 20000000;
$y < 1980;
fetch { ""title"": $t, ""year"": $y, ""revenue"": $r };"
recommendations,83,What are the IMDb ratings of movies that have a plot mentioning 'evil exterminator'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil exterminator'
RETURN m.title, m.imdbRating","match
$m isa movie, has title $t, has plot $p, has imdb_rating $r;
$p like ""%evil exterminator%"";
fetch { ""title"": $t, ""imdbRating"": $r };"
recommendations,84,Name the movies that have been acted in and directed by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title","match
$p isa person;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
fetch { ""title"": $t };"
recommendations,85,Which movies have a runtime greater than 120 minutes and were released after 2000?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.year > 2000
RETURN m.title, m.runtime, m.year","match
$m isa movie, has title $t, has runtime $r, has year $y;
$r > 120;
$y > 2000;
fetch { ""title"": $t, ""runtime"": $r, ""year"": $y };"
recommendations,86,What are the top 5 highest-grossing movies that were released before 2010?,"MATCH (m:Movie)
WHERE m.released < '2010-01-01' AND exists {(m)<-[:ACTED_IN]-(:Person)}
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r, has year $y;
acted_in (actor: $a, film: $m);
$y < 2010;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,87,List 3 movies directed by 'Anthony Stacchi'.,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match
$d isa person, has name ""Anthony Stacchi"";
$m isa movie, has title $t;
directed (director: $d, film: $m);
limit 3;
fetch { ""title"": $t };"
recommendations,88,Which 5 actors have acted in the most movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a;
sort $count desc;
limit 5;
fetch {
  ""actor"": $a.name,
  ""movieCount"": $count
};"
recommendations,89,What are the top 3 genres by the number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.name,
  ""movieCount"": $count
};"
recommendations,90,Who are the top 5 directors by the number of movies they have directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
reduce $count = count($m) groupby $d;
sort $count desc;
limit 5;
fetch {
  ""director"": $d.name,
  ""numMovies"": $count
};"
recommendations,91,"What are the top 5 movies by IMDB rating that have more than 100,000 IMDB votes?","MATCH (m:Movie)
WHERE m.imdbVotes > 100000
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r, has imdb_votes $v;
$v > 100000;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r };"
recommendations,92,Which movies have been rated by user '1' and have a rating greater than 8?,"MATCH (u:User {userId: '1'})-[r:RATED]->(m:Movie)
WHERE r.rating > 8
RETURN m.title, r.rating","match
$u isa user, has user_id ""1"";
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m), has rating $r;
$r > 8;
fetch { ""title"": $t, ""rating"": $r };"
recommendations,93,List the movies that have grossed over 1 billion USD in revenue.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m.title, m.revenue","match
$m isa movie, has title $t, has revenue $r;
$r > 1000000000;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,94,What are the top 3 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""runtime"": $r };"
recommendations,95,Provide the names of 3 actors who have also directed movies.,"MATCH (p:Person)-[:ACTED_IN]->(:Movie)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match
$p isa person, has name $n;
acted_in (actor: $p, film: $m1);
directed (director: $p, film: $m2);
limit 3;
fetch { ""name"": $n };"
recommendations,98,List 3 movies that were released in the 1990s and have an IMDB rating above 7.,"MATCH (m:Movie)
WHERE m.year >= 1990 AND m.year < 2000
  AND m.imdbRating > 7
RETURN m.title, m.year, m.imdbRating
LIMIT 3","match
$m isa movie, has title $t, has year $y, has imdb_rating $r;
$y >= 1990;
$y < 2000;
$r > 7;
limit 3;
fetch { ""title"": $t, ""year"": $y, ""imdbRating"": $r };"
recommendations,99,Which directors were born in the USA?,"MATCH (d:Director)
WHERE d.bornIn CONTAINS 'USA'
RETURN d.name AS director, d.bornIn AS bornIn","match
$d isa person, has name $n, has born_in $b;
directed (director: $d, film: $m);
$b like ""%USA%"";
fetch { ""director"": $n, ""bornIn"": $b };"
recommendations,100,"What are the top 5 highest-rated movies by users, based on the average user rating?","MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating","match
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m), has rating $r;
reduce $avg = mean($r) groupby $m, $t;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $t,
  ""avgRating"": $avg
};"
recommendations,101,List the movies that have a budget greater than 200 million USD.,"MATCH (m:Movie)
WHERE m.budget > 200000000
RETURN m.title, m.budget","match
$m isa movie, has title $t, has budget $b;
$b > 200000000;
fetch { ""title"": $t, ""budget"": $b };"
recommendations,102,Which 3 movies feature both English and Japanese languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'Japanese' IN m.languages
RETURN m.title
LIMIT 3","match
$m isa movie, has title $t, has languages $l;
$l like ""%English%"";
$l like ""%Japanese%"";
limit 3;
fetch { ""title"": $t };"
recommendations,103,What are the top 3 movies by revenue released in 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y == 2014;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,104,Which actors have played in a movie and also directed a movie?,"MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
  AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name AS name","match
$p isa person, has name $n;
acted_in (actor: $p, film: $m1);
directed (director: $p, film: $m2);
fetch { ""name"": $n };"
recommendations,105,Who are the 5 most frequent actors in the 'Adventure' genre?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
WITH a, count(*) AS count
ORDER BY count DESC
LIMIT 5
RETURN a.name AS actor, count","match
$a isa person, has name $n;
$g isa genre, has name ""Adventure"";
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $a;
sort $count desc;
limit 5;
fetch {
  ""actor"": $a.name,
  ""count"": $count
};"
recommendations,106,List the 3 oldest directors based on their birth date.,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d.name, d.born
ORDER BY d.born
LIMIT 3","match
$d isa person, has name $n, has born $b;
directed (director: $d, film: $m);
sort $b asc;
limit 3;
fetch { ""name"": $n, ""born"": $b };"
recommendations,107,Which movies have both high revenue (over 500 million USD) and high imdbRating (above 8.0)?,"MATCH (m:Movie)
WHERE m.revenue > 500000000 AND m.imdbRating > 8.0
RETURN m.title, m.revenue, m.imdbRating","match
$m isa movie, has title $t, has revenue $r, has imdb_rating $ir;
$r > 500000000;
$ir > 8.0;
fetch { ""title"": $t, ""revenue"": $r, ""imdbRating"": $ir };"
recommendations,108,What are the most recent 3 movies directed by any director born in Canada?,"MATCH (d:Director {bornIn: 'Canada'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year
ORDER BY m.year DESC
LIMIT 3","match
$d isa person, has born_in ""Canada"";
$m isa movie, has title $t, has year $y;
directed (director: $d, film: $m);
sort $y desc;
limit 3;
fetch { ""title"": $t, ""year"": $y };"
recommendations,109,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match
$u isa user, has name $n;
rated (user: $u, film: $m);
reduce $count = count($m) groupby $u, $n;
sort $count desc;
limit 3;
fetch {
  ""user"": $n,
  ""numRatings"": $count
};"
recommendations,110,What are the top 3 highest budget movies that failed to gross more than their budget?,"MATCH (m:Movie)
WHERE m.revenue < m.budget
RETURN m.title, m.budget, m.revenue
ORDER BY m.budget DESC
LIMIT 3","match
$m isa movie, has title $t, has budget $b, has revenue $r;
$r < $b;
sort $b desc;
limit 3;
fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
recommendations,111,Which movies have been rated by more than 1000 users?,"MATCH (m:Movie)
WHERE m.imdbVotes > 1000
RETURN m.title, m.imdbVotes","match
$m isa movie, has title $t, has imdb_votes $v;
$v > 1000;
fetch {
  ""title"": $t,
  ""imdb_votes"": $v
};"
recommendations,113,What movies have a runtime longer than 120 minutes and were released after 2000?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.released > '2000-01-01'
RETURN m.title, m.released, m.runtime","match
$m isa movie, has title $t, has released $rel, has runtime $rt;
$rt > 120;
$rel > ""2000-01-01"";
fetch { ""title"": $t, ""released"": $rel, ""runtime"": $rt };"
recommendations,114,List the top 5 movies with the highest IMDb rating.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r };"
recommendations,115,What are the names of actors who have acted in more than five movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a;
match $count > 5;
fetch { ""name"": $a.name };"
recommendations,116,Which users have rated movies in the 'Adventure' genre?,"MATCH (u:User)-[r:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN u, r, m","match
$u isa user, has name $n;
$g isa genre, has name ""Adventure"";
rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
fetch { ""name"": $n };"
recommendations,117,What movies had a budget greater than 100 million dollars and were directed by a director born in the USA?,"MATCH (m:Movie)
WHERE m.budget > 100000000
AND exists {
  (d:Director)-[:DIRECTED]->(m)
  WHERE d.bornIn CONTAINS 'USA'
}
RETURN m.title, m.budget, m.year","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
$m has budget $b;
$b > 100000000;
reduce $num_high_budget_movies = count($m) groupby $n;
sort $num_high_budget_movies desc;
limit 10;
fetch { ""director"": $n, ""num_high_budget_movies"": $num_high_budget_movies };"
recommendations,118,Find all movies where the revenue was more than double the budget.,"MATCH (m:Movie)
WHERE m.revenue > 2 * m.budget
RETURN m.title, m.budget, m.revenue","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > ($bud * 2);
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
recommendations,119,What genres have more than ten movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
WHERE movieCount > 10
RETURN g.name AS genre, movieCount","match
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $g, $gn;
match $count > 10;
fetch {
  ""genre"": $gn,
  ""movieCount"": $count
};"
recommendations,120,Which movies have been rated by both user '1' and user '2'?,"MATCH (u1:User {userId: '1'})-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User {userId: '2'})
RETURN m.title","match
$u1 isa user, has user_id ""1"";
$u2 isa user, has user_id ""2"";
$m isa movie, has title $t;
(user: $u1, film: $m) isa rated;
(user: $u2, film: $m) isa rated;
fetch { ""title"": $t };"
recommendations,121,What are the names of directors who have directed both a 'Comedy' and a 'Drama' movie?,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
WHERE exists{ (d)-[:DIRECTED]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Drama'}) }
RETURN DISTINCT d.name","match
$d isa person, has name $n;
(director: $d, film: $m1) isa directed;
(film: $m1, genre: $g1) isa in_genre;
$g1 has name ""Comedy"";
(director: $d, film: $m2) isa directed;
(film: $m2, genre: $g2) isa in_genre;
$g2 has name ""Drama"";
fetch { ""director"": $n };"
recommendations,122,How many movies have been released in each year from 2010 to 2020?,"MATCH (m:Movie)
WHERE m.year >= 2010 AND m.year <= 2020
RETURN m.year AS year, count(m) AS numMovies
ORDER BY year","match
$m isa movie, has year $y;
$y >= 2010;
$y <= 2020;
reduce $count = count($m) groupby $y;
sort $y asc;
fetch { ""year"": $y, ""numMovies"": $count };"
recommendations,124,List the top 3 movies with the most IMDb votes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 3;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,125,Which directors have a bio that mentions 'Academy Award'?,"MATCH (d:Director)
WHERE d.bio CONTAINS 'Academy Award'
RETURN d.name, d.bio","match
$d isa person, has name $n, has bio $b;
directed (director: $d, film: $m);
$b like ""%Academy Award%"";
fetch { ""name"": $n };"
recommendations,126,What movies have both English and French as their languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m.title","match
$m isa movie, has title $t, has languages $l;
$l like ""%English%"";
$l like ""%French%"";
fetch { ""title"": $t };"
recommendations,127,How many users have rated the movie with the IMDb ID '0114709'?,"MATCH (m:Movie {imdbId: '0114709'})
MATCH (u:User)-[r:RATED]->(m)
RETURN count(u) AS numUsers","match
$m isa movie, has imdb_id ""0114709"";
rated (user: $u, film: $m);
reduce $count = count($u);"
recommendations,128,Which actor has the highest number of roles in movies released before 1980?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year < 1980
WITH a, count(r) AS numRoles
RETURN a.name AS actor, numRoles
ORDER BY numRoles DESC
LIMIT 1","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has year $y;
$y < 1980;
reduce $numRoles = count($m) groupby $n;
sort $numRoles desc;
limit 1;
fetch { ""actor"": $n, ""numRoles"": $numRoles };"
recommendations,129,Can you list all genres that a movie with the title 'Toy Story' falls under?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre","match
$m isa movie, has title ""Toy Story"";
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
fetch { ""genre"": $gn };"
recommendations,130,Which movies feature actors born in France?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor {bornIn: 'France'})
RETURN m.title, a.name","match
$a isa person, has name $n, has born_in ""France"";
$m isa movie, has title $t;
acted_in (actor: $a, film: $m);
fetch { ""title"": $t };"
recommendations,131,What are the top 5 highest-grossing movies of 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y == 2014;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,132,How many genres has each movie been classified under?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN m.title AS movie, count(g) AS genreCount","match
$m isa movie, has title $t;
in_genre (film: $m, genre: $g);
reduce $count = count($g) groupby $t;"
recommendations,133,Which movie had the largest number of actors participating?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 1","match
$m isa movie, has title $t;
acted_in (actor: $a, film: $m);
reduce $count = count($a) groupby $m, $t;
sort $count desc;
limit 1;
fetch {
  ""movie"": $t,
  ""numActors"": $count
};"
recommendations,134,List all movies directed by someone who was born after 1970.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE p.born > date('1970-01-01')
RETURN m.title AS movie, p.name AS director, p.born AS birthDate","match
$p isa person, has name $n, has born $b;
(director: $p, film: $m) isa directed;
$m has title $t;
$b > 1970-01-01;
fetch { ""movie"": $t, ""director"": $n, ""birthDate"": $b };"
recommendations,135,What is the average IMDb rating of movies with a runtime under 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating IS NOT NULL
RETURN avg(m.imdbRating) AS averageRating","match
$m isa movie, has runtime $rt, has imdb_rating $r;
$rt < 90;
reduce $averageRating = mean($r);
fetch { ""averageRating"": $averageRating };"
recommendations,136,Which movies have been rated exactly 5 by more than one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5
WITH m, count(u) AS numRatings
WHERE numRatings > 1
RETURN m.title AS movie, numRatings","match
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m), has rating $r;
$r == 5.0;
reduce $count = count($u) groupby $m, $t;
match $count > 1;
fetch {
  ""movie"": $t,
  ""numRatings"": $count
};"
recommendations,137,Find movies where the sum of the revenue and budget is more than 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue + m.budget > 1000000000
RETURN m.title, m.revenue, m.budget","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
($rev + $bud) > 1000000000;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
recommendations,139,List the top 5 movies by revenue that were released in the last five years of the schema's data range.,"MATCH (m:Movie)
WHERE m.released >= '2011'
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has released $rel;
$rel >= ""2011"";
sort $rev desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev };"
recommendations,140,Which users have rated a movie but have not rated any movie in the 'Sci-Fi' genre?,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE NOT exists {
  (u)-[:RATED]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Sci-Fi'})
}
RETURN u, m","match
$u isa user, has name $n;
rated (user: $u, film: $m);
$m has title $t;
not {
    rated (user: $u, film: $scifi_movie);
    in_genre (film: $scifi_movie, genre: $g);
    $g has name ""Sci-Fi"";
};
fetch { ""user"": $n, ""movie"": $t };"
recommendations,141,What are the different roles played by actors in the movie with the IMDb ID '0829150'?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie {imdbId: '0829150'})
RETURN a.name AS actor, r.role AS role","match
$m isa movie, has imdb_id ""0829150"";
(actor: $a, film: $m) isa acted_in, has character_role $role;
$a has name $n;
fetch { ""actor"": $n, ""role"": $role };"
recommendations,142,List all the movies that have been both directed and acted in by the same person.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match
$p isa person, has name $n;
$m isa movie, has title $t;
acted_in (actor: $p, film: $m);
directed (director: $p, film: $m);
fetch { ""title"": $t, ""person"": $n };"
recommendations,143,Which actor has the most diverse filmography in terms of genres acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
RETURN a.name AS actor, genreCount
ORDER BY genreCount DESC
LIMIT 1","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
select $a, $n, $g;
distinct;
reduce $count = count($g) groupby $a, $n;
sort $count desc;
limit 1;
fetch {
  ""actor"": $n,
  ""genreCount"": $count
};
"
recommendations,144,What are the names of the users who rated the movie 'Dracula Untold'?,"MATCH (m:Movie {title: 'Dracula Untold'})<-[r:RATED]-(u:User)
RETURN u.name","match
$m isa movie, has title ""Dracula Untold"";
$u isa user, has name $n;
(user: $u, film: $m) isa rated;
fetch { ""name"": $n };"
recommendations,145,Which directors have a poster URL that includes 'w440_and_h660_face'?,"MATCH (d:Director)
WHERE d.poster CONTAINS 'w440_and_h660_face'
RETURN d.name, d.poster","match
$d isa person, has name $n, has poster $p;
(director: $d, film: $m) isa directed;
$p like "".*w440_and_h660_face.*"";
fetch { ""name"": $n, ""poster"": $p };"
recommendations,146,List the movies that have a plot mentioning 'kingdom'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'kingdom'
RETURN m.title, m.plot","match
$m isa movie, has title $t, has plot $p;
$p like ""%kingdom%"";
fetch { ""title"": $t };"
recommendations,147,"What is the total revenue generated by movies directed by directors born in 'Burchard, Nebraska, USA'?","MATCH (d:Director {bornIn: 'Burchard, Nebraska, USA'})-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
RETURN sum(m.revenue) AS totalRevenue","match
$d isa person, has name $n, has born_in ""Burchard, Nebraska, USA"";
(director: $d, film: $m) isa directed;
$m has revenue $rev;
reduce $totalRevenue = sum($rev);
fetch { ""totalRevenue"": $totalRevenue };"
recommendations,149,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match
$m isa movie, has title $t, has runtime $r;
sort $r asc;
limit 3;
fetch { ""title"": $t, ""runtime"": $r };"
recommendations,151,"What are the IMDb IDs of movies that have more than 500,000 IMDb votes?","MATCH (m:Movie)
WHERE m.imdbVotes > 500000
RETURN m.imdbId","match
$m isa movie, has imdb_id $id, has imdb_votes $v;
$v > 500000;
fetch { ""imdbId"": $id };"
recommendations,152,Which movies have been acted in by persons born before 1900?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE p.born < date('1900-01-01')
RETURN m.title AS movie, p.name AS actor, p.born AS birthDate","match
$p isa person, has name $n, has born $b;
(actor: $p, film: $m) isa acted_in;
$m has title $t;
$b < 1900-01-01;
fetch { ""movie"": $t, ""actor"": $n, ""birthDate"": $b };"
recommendations,153,What are the top 5 movies by revenue released in 1995?,"MATCH (m:Movie)
WHERE m.year = 1995 AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has year 1995;
sort $rev desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev };"
recommendations,154,Which movies have a runtime longer than 150 minutes and less than 200 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 150 AND m.runtime < 200
RETURN m.title, m.runtime","match
$m isa movie, has title $t, has runtime $rt;
$rt > 150;
$rt < 200;
fetch { ""title"": $t, ""runtime"": $rt };"
recommendations,155,List the top 3 highest imdbRating movies that were released before the year 2000.,"MATCH (m:Movie)
WHERE m.released < '2000-01-01' AND exists((m)-[:IN_GENRE]->(:Genre))
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_rating $r, has released $rel;
(film: $m, genre: $g) isa in_genre;
$rel < ""2000-01-01"";
sort $r desc;
limit 3;
fetch { ""title"": $t, ""imdbRating"": $r };"
recommendations,157,Which directors have directed more than one movie in the 'Drama' genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Drama'})
WITH d, count(m) AS num_drama_movies
WHERE num_drama_movies > 1
RETURN d.name AS director, num_drama_movies","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
(film: $m, genre: $g) isa in_genre;
$g has name ""Drama"";
reduce $num_drama_movies = count($m) groupby $n;
sort $num_drama_movies desc;
limit 10;
fetch { ""director"": $n, ""num_drama_movies"": $num_drama_movies };"
recommendations,158,List the top 3 movies with the highest number of imdbVotes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 3;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,159,What are the top 5 movies with the most countries listed in their production?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries
ORDER BY size(m.countries) DESC
LIMIT 5","match
$m isa movie, has title $t, has countries $c;
reduce $count = count($c) groupby $m, $t;
sort $count desc;
limit 5;
fetch { ""title"": $t, ""country_count"": $count };"
recommendations,160,Which users have rated more than 5 movies with a rating above 7.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating > 7.0
WITH u, count(r) AS numHighRatings
WHERE numHighRatings > 5
RETURN u.name AS user, numHighRatings","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
$rating > 7.0;
reduce $numHighRatings = count($r) groupby $n;
sort $numHighRatings desc;
limit 10;
fetch { ""user"": $n, ""numHighRatings"": $numHighRatings };"
recommendations,161,List the top 3 genres with the most movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
reduce $movieCount = count($m) groupby $n;
sort $movieCount desc;
limit 3;
fetch { ""genre"": $n, ""movieCount"": $movieCount };"
recommendations,162,What are the 5 most recent movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: 'USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match
$d isa person, has born_in $b;
$m isa movie, has title $t, has year $y;
directed (director: $d, film: $m);
$b like ""%USA%"";
sort $y desc;
limit 5;
fetch { ""title"": $t, ""year"": $y };"
recommendations,163,Which actors have acted in both 'Comedy' and 'Drama' genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama'] 
WITH a, collect(distinct g.name) AS genres
WHERE size(genres) = 2
RETURN a.name AS actor","match
$a isa person, has name $n;
$g1 isa genre, has name ""Comedy"";
$g2 isa genre, has name ""Drama"";
acted_in (actor: $a, film: $m1);
acted_in (actor: $a, film: $m2);
in_genre (film: $m1, genre: $g1);
in_genre (film: $m2, genre: $g2);
fetch { ""name"": $n };"
recommendations,164,List the top 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
recommendations,165,Which movies have been rated by more than 1000 users?,"MATCH (m:Movie)
WHERE m.imdbVotes > 1000
RETURN m.title, m.imdbVotes","match
$m isa movie, has title $t, has imdb_votes $v;
$v > 1000;
fetch {
  ""title"": $t,
  ""imdbVotes"": $v
};"
recommendations,167,List the top 3 movies that have the highest revenue and were released in 2014.,"MATCH (m:Movie)
WHERE m.year = 2014
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has year 2014;
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev };"
recommendations,168,What are the top 5 directors by number of movies directed in the 'Action' genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Action'})
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match
$d isa person, has name $n;
$g isa genre, has name ""Action"";
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 5;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
recommendations,169,Which users have the highest average rating given to movies? (minimum 3 ratings),"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 3
RETURN u.name AS user, avgRating
ORDER BY avgRating DESC","match
$u isa user, has name $n;
$rel isa rated (user: $u, film: $m), has rating $r;
reduce $count = count($rel), $avg = mean($r) groupby $u, $n;
match $count >= 3;
sort $avg desc;
fetch { ""user"": $n, ""avgRating"": $avg };"
recommendations,170,List the genres that have movies with an imdbRating less than 4.0.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.imdbRating < 4.0
RETURN DISTINCT g.name","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
$m has imdb_rating $r;
$r < 4.0;
fetch { ""genre"": $n };"
recommendations,171,What are the 5 most recent movies with a runtime less than 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90
RETURN m.title, m.released, m.runtime
ORDER BY m.released DESC
LIMIT 5","match
$m isa movie, has title $t, has released $rel, has runtime $rt;
$rt < 90;
sort $rel desc;
limit 5;
fetch { ""title"": $t, ""released"": $rel, ""runtime"": $rt };"
recommendations,172,Which actors have the most roles in movies with a budget over 100 million dollars?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.budget > 100000000
WITH a, count(r) AS numRoles
ORDER BY numRoles DESC
RETURN a.name AS actor, numRoles
LIMIT 10","match
$a isa person, has name $n;
$m isa movie, has budget $b;
acted_in (actor: $a, film: $m);
$b > 100000000;
reduce $count = count($m) groupby $a;
sort $count desc;
limit 10;
fetch {
  ""actor"": $a.name,
  ""numRoles"": $count
};"
recommendations,173,List the top 3 movies with the lowest imdbVotes released after 2000.,"MATCH (m:Movie)
WHERE m.year > 2000 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes
LIMIT 3","match
$m isa movie, has title $t, has imdb_votes $v, has year $y;
$y > 2000;
sort $v asc;
limit 3;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,174,What are the top 5 actors by number of movies acted in with a revenue greater than 500 million dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has revenue $rev;
$rev > 500000000;
reduce $numHighRevenueMovies = count($m) groupby $n;
sort $numHighRevenueMovies desc;
limit 5;
fetch { ""actor"": $n, ""numHighRevenueMovies"": $numHighRevenueMovies };"
recommendations,176,List the top 3 movies with the smallest difference between budget and revenue.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget AS budget, m.revenue AS revenue, m.revenue - m.budget AS profit
ORDER BY profit
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit asc;
limit 3;
fetch { ""title"": $t, ""budget"": $bud, ""revenue"": $rev, ""profit"": $profit };"
recommendations,177,What are the top 5 movies with the highest number of actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5","match
$m isa movie, has title $t;
acted_in (actor: $a, film: $m);
reduce $count = count($a) groupby $m, $t;
sort $count desc;
limit 5;
fetch {
  ""movie"": $t,
  ""numActors"": $count
};"
recommendations,178,Which users have rated the same movie more than once?,"MATCH (u:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u)
WHERE r1.timestamp <> r2.timestamp
RETURN u.name AS user, m.title AS movie","match
$u isa user, has name $n;
$m isa movie, has title $t;
$rel isa rated (user: $u, film: $m);
reduce $count = count($rel) groupby $u, $m, $n, $t;
match $count > 1;
fetch { ""user"": $n, ""movie"": $t };"
recommendations,179,List the top 3 movies with the lowest imdbRating that have been rated by more than 500 users.,"MATCH (m:Movie)
WHERE m.imdbVotes > 500
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating
LIMIT 3","match
$m isa movie, has title $t, has imdb_rating $r, has imdb_votes $v;
$v > 500;
sort $r asc;
limit 3;
fetch { ""title"": $t, ""imdbRating"": $r };"
recommendations,180,What are the top 5 actors who have acted in movies directed by Denzel Washington?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director {name: 'Denzel Washington'})
RETURN a.name AS actor, count(*) AS appearances
ORDER BY appearances DESC
LIMIT 5","match
$d isa person, has name ""Denzel Washington"";
(director: $d, film: $m) isa directed;
(actor: $a, film: $m) isa acted_in;
$a has name $an;
reduce $appearances = count($m) groupby $an;
sort $appearances desc;
limit 5;
fetch { ""actor"": $an, ""appearances"": $appearances };"
recommendations,181,List the top 3 highest grossing movies of 2013.,"MATCH (m:Movie)
WHERE m.year = 2013 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $r, has year $y;
$y == 2013;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,182,What are the top 5 movies with the most distinct genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS distinctGenres","match
$m isa movie, has title $t;
in_genre (film: $m, genre: $g);
select $t, $g;
distinct;
reduce $count = count($g) groupby $t;
sort $count desc;
limit 5;
fetch {
  ""movie"": $t,
  ""distinctGenres"": $count
};"
recommendations,183,List the top 3 actors by number of movies acted in that were released in the 1990s.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released STARTS WITH '199'
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
$m isa movie, has year $y;
$y >= 1990;
$y < 2000;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,185,Which actors have acted in both high-budget (over 200 million dollars) and low-budget (under 10 million dollars) movies?,"MATCH (a:Actor)-[:ACTED_IN]->(highBudget:Movie), (a)-[:ACTED_IN]->(lowBudget:Movie)
WHERE highBudget.budget > 200000000 AND lowBudget.budget < 10000000
RETURN a.name AS actor, highBudget.title AS highBudgetMovie, lowBudget.title AS lowBudgetMovie","match
$a isa person, has name $n;
(actor: $a, film: $m1) isa acted_in;
$m1 has budget $b1, has title $t1;
$b1 > 200000000;
(actor: $a, film: $m2) isa acted_in;
$m2 has budget $b2, has title $t2;
$b2 < 10000000;
fetch { ""actor"": $n, ""highBudgetMovie"": $t1, ""lowBudgetMovie"": $t2 };"
recommendations,186,List the top 3 movies with a plot involving 'love' that have a runtime over 120 minutes.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love' AND m.runtime > 120
RETURN m.title, m.plot, m.runtime
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has title $t, has plot $p, has runtime $rt, has imdb_rating $r;
$p like "".*love.*"";
$rt > 120;
sort $r desc;
limit 3;
fetch { ""title"": $t, ""plot"": $p, ""runtime"": $rt };"
recommendations,187,What are the top 5 movies with the highest imdbRating that were released in the 21st century?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '20' AND exists((m)-[:IN_GENRE]->(:Genre))
RETURN m.title, m.imdbRating, m.year
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r, has year $y, has released $rel;
(film: $m, genre: $g) isa in_genre;
$rel like ""20%"";
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r, ""year"": $y };"
recommendations,189,List the top 3 actors with the highest average imdbRating across movies they've acted in (minimum 3 movies).,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating, count(m) AS numMovies
WHERE numMovies >= 3
RETURN a.name AS actor, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$a isa person, has name $n;
$m isa movie, has imdb_rating $r;
acted_in (actor: $a, film: $m);
reduce $count = count($m), $avg = mean($r) groupby $a, $n;
match $count >= 3;
sort $avg desc;
limit 3;
fetch {
  ""actor"": $n,
  ""avgRating"": $avg
};"
recommendations,190,List the names of the top 5 movies with the highest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $r };"
recommendations,191,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match
$m isa movie, has title $t, has runtime $r;
sort $r desc;
limit 5;
fetch { ""title"": $t, ""runtime"": $r };"
recommendations,192,Find the names of the top 5 movies with the lowest imdbRating.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title AS movie, m.imdbRating AS rating
ORDER BY m.imdbRating
LIMIT 5","match
$m isa movie, has title $t, has imdb_rating $r;
sort $r asc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r };"
recommendations,193,List the top 5 movies with the most imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match
$m isa movie, has title $t, has imdb_votes $v;
sort $v desc;
limit 5;
fetch { ""title"": $t, ""imdbVotes"": $v };"
recommendations,194,Find the names of the top 5 directors by the number of movies they have directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
reduce $count = count($m) groupby $d;
sort $count desc;
limit 5;
fetch {
  ""director"": $d.name,
  ""numMovies"": $count
};"
recommendations,195,What are the top 5 actors who acted in the most number of movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
sort $count desc;
limit 5;
fetch {
  ""actor"": $n,
  ""numMovies"": $count
};"
recommendations,196,List the names of the first 3 genres that have the most movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $gn;
in_genre (film: $m, genre: $g);
reduce $count = count($m) groupby $gn;
sort $count desc;
limit 3;
fetch { ""genre"": $gn };"
recommendations,197,Which 5 movies have been rated by the highest number of users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5","match
$m isa movie, has title $t;
rated (user: $u, film: $m);
reduce $count = count($u) groupby $m;
sort $count desc;
limit 5;
fetch {
  ""movie"": $m.title,
  ""numRatings"": $count
};"
recommendations,199,List the names of the top 3 users who have rated the most movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.name AS user, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match
$u isa user, has name $n;
rated (user: $u, film: $m);
reduce $count = count($m) groupby $n;
sort $count desc;
limit 3;
fetch { ""user"": $n };"
recommendations,201,Find the top 5 movies released most recently.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 5","match $m isa movie, has title $t, has released $r; sort $r desc; limit 5; fetch { ""title"": $t, ""released"": $r };"
recommendations,202,What are the top 3 oldest movies based on the 'year' property?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m.title, m.year
ORDER BY m.year
LIMIT 3","match $m isa movie, has title $t, has year $y; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y };"
recommendations,203,List the 5 oldest actors based on the 'born' property.,"MATCH (a:Actor)
WHERE a.born IS NOT NULL
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match $a isa person, has name $n, has born $b; acted_in (actor: $a, film: $m); sort $b asc; limit 5; fetch { ""name"": $n, ""born"": $b };"
recommendations,204,Who are the top 5 youngest directors based on the 'born' property?,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d.name, d.born
ORDER BY d.born DESC
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d, film: $m); sort $b desc; limit 5; fetch { ""name"": $n, ""born"": $b };"
recommendations,205,What are the top 5 movies with the highest budgets?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,206,List the top 5 movies with the smallest budgets.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match $m isa movie, has title $t, has budget $b; sort $b asc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,207,Which 5 actors have acted in movies with the highest average imdbRating?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
RETURN a.name, avgRating
ORDER BY avgRating DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
recommendations,208,Find the top 5 directors who have directed movies with the highest average imdbRating.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name AS director, avgRating","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
recommendations,209,List the top 5 users who have given the highest average ratings to movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $rel isa rated (user: $u, film: $m); $rel has rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
recommendations,210,What are the top 5 movies directed by Harold Lloyd?,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has name ""Harold Lloyd""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,211,List the first 3 genres that have movies with a runtime greater than 120 minutes.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 120
RETURN g.name AS genre
ORDER BY genre
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has runtime $r; $r > 120; sort $n asc; limit 3; fetch { ""genre"": $n };"
recommendations,212,Which 3 users rated the movie with the highest revenue?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE m.revenue IS NOT NULL
WITH m, u, r
ORDER BY m.revenue DESC
LIMIT 1
RETURN u.name AS user
LIMIT 3","match $m isa movie, has revenue $rev; rated (user: $u, film: $m); $u has name $n; sort $rev desc; limit 3; fetch { ""user"": $n };"
recommendations,213,Show the first 5 actors who acted in movies released in the year 2014.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie {year: 2014})
RETURN a.name AS actor, m.title AS movie
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has year 2014, has title $t; limit 5; fetch { ""actor"": $n, ""movie"": $t };"
recommendations,214,What are the top 3 movies with the highest imdbRating that were released in 1995?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995' AND exists((m)-[:IN_GENRE]->(:Genre))
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r, has released $rel; $rel like ""1995%""; in_genre (film: $m, genre: $g); sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,215,List the first 5 directors born in France.,"MATCH (d:Director {bornIn: 'France'})
RETURN d.name, d.born
ORDER BY d.born
LIMIT 5","match $d isa person, has name $n, has born $b, has born_in ""France""; directed (director: $d, film: $m); sort $b asc; limit 5; fetch { ""name"": $n, ""born"": $b };"
recommendations,216,Which 3 movies have the most number of votes cast by users?,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,217,Show the top 5 movies with a budget greater than 100 million USD.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b; $b > 100000000; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,218,What are the first 3 genres associated with movies that have been rated by at least 5 different users?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)<-[r:RATED]-(u:User)
WITH g, m, count(DISTINCT u) AS userCount
WHERE userCount >= 5
RETURN g.name AS genre
ORDER BY userCount DESC
LIMIT 3","match 
$m isa movie;
rated (film: $m, user: $u);
reduce $count = count($u) groupby $m;
match $count >= 5;
in_genre (film: $m, genre: $g);
$g has name $n;
sort $count desc;
limit 3;
fetch { ""genre"": $n };"
recommendations,220,Who are the top 3 actors based on the number of movies they have acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3
RETURN a.name AS actor, numMovies","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,221,What are the first 5 movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: 'USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 5","match $d isa person, has born_in ""USA""; directed (director: $d, film: $m); $m has title $t; limit 5; fetch { ""title"": $t };"
recommendations,222,Which 3 actors have acted in movies with a runtime less than 90 minutes?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.runtime < 90
RETURN a.name AS actor, m.title AS movie
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has runtime $r; $r < 90; $m has title $t; limit 3; fetch { ""actor"": $n, ""movie"": $t };"
recommendations,223,List the top 5 highest-grossing movies of 2006.,"MATCH (m:Movie)
WHERE m.year = 2006 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has year 2006, has revenue $rev, has title $t; sort $rev desc; limit 5; fetch { ""movie"": $t, ""revenue"": $rev };"
recommendations,224,Show the first 3 movies that have been rated below 3.0 by any user.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating < 3.0
RETURN m.title, r.rating, u.name
LIMIT 3","match $r isa rated, links (user: $u, film: $m), has rating $rating; $rating < 3.0; $m has title $t; $u has name $n; limit 3; fetch { ""title"": $t, ""rating"": $rating, ""user"": $n };"
recommendations,225,What are the first 5 movies with the most distinct genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS distinctGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $t; sort $count desc; limit 5;"
recommendations,226,Which 3 directors have directed movies in more than one genre?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(distinct g) AS num_genres
WHERE num_genres > 1
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
select $n, $g;
distinct;
reduce $count = count groupby $n;
match $count > 1;
sort $count desc;
limit 3;
fetch { ""director"": $n, ""num_genres"": $count };"
recommendations,227,List the first 5 actors who have a poster URL listed on their profile.,"MATCH (a:Actor)
WHERE a.poster IS NOT NULL
RETURN a.name, a.poster
LIMIT 5","match
$a isa person, has name $n, has poster $p;
(actor: $a, film: $m) isa acted_in;
limit 5;
fetch { ""name"": $n, ""poster"": $p };"
recommendations,228,Show the top 5 users by the number of movies they have rated.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,229,Which 3 movies have the highest budget-revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
recommendations,230,List the first 5 actors who were born before 1900.,"MATCH (a:Actor)
WHERE a.born < date('1900-01-01')
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match
$a isa person, has name $n, has born $b;
acted_in (actor: $a, film: $m);
$b < 1900-01-01;
sort $b asc;
limit 5;
fetch { ""name"": $n, ""born"": $b };"
recommendations,231,What are the top 3 genres in which movies with an imdbRating above 8.0 fall?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating > 8.0
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match $m isa movie, has imdb_rating $r; $r > 8.0; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,232,Which 5 movies have been directed by persons who also have an acting role in any movie?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS movie
LIMIT 5","match $p isa person, has name $n; directed (director: $p, film: $m); acted_in (actor: $p, film: $m2); $m has title $t; limit 5; fetch { ""movie"": $t };"
recommendations,233,Show the first 3 movies released in the USA that have a revenue exceeding 500 million USD.,"MATCH (m:Movie)
WHERE 'USA' IN m.countries AND m.revenue > 500000000
RETURN m.title, m.year, m.revenue
ORDER BY m.released
LIMIT 3","match $m isa movie, has countries $c, has revenue $r, has title $t, has year $y; $c contains ""USA""; $r > 500000000; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y, ""revenue"": $r };"
recommendations,234,List the 5 most recently released movies with a plot description available.,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.released, m.plot
ORDER BY m.released DESC
LIMIT 5","match $m isa movie, has title $t, has released $r, has plot $p; sort $r desc; limit 5; fetch { ""title"": $t, ""released"": $r, ""plot"": $p };"
recommendations,235,What are the first 3 directors who died after 2000?,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died
LIMIT 3","match $d isa person, has name $n, has died $d2; $d2 > 2000-01-01; directed (director: $d, film: $m); sort $d2 asc; limit 3; fetch { ""name"": $n, ""died"": $d2 };"
recommendations,236,Which 3 users have rated the oldest movies in the database?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, m
ORDER BY m.year
RETURN DISTINCT u.name AS user, m.title AS movie, m.year AS year
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); $m has title $t, has year $y; sort $y asc; limit 3; fetch { ""user"": $n, ""movie"": $t, ""year"": $y };"
recommendations,237,List the top 5 movies with the most user ratings.,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 5;"
recommendations,238,Show the first 5 genres of movies directed by directors who were born after 1960.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE d.born > date('1960-01-01')
RETURN DISTINCT g.name
LIMIT 5","match $d isa person, has born $b; $b > 1960-01-01; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name $n; limit 5; fetch { ""genre"": $n };"
recommendations,239,List the first 5 directors with the most diverse filmography based on genre diversity.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN d.name AS director, genreCount AS genreDiversity","match $d isa person, has name $n; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $n; sort $count desc; limit 5;"
recommendations,240,What are the top 3 movies with the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,241,Which 5 actors have acted in the most commercially successful movies (highest revenue)?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue IS NOT NULL
WITH a, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 5
RETURN a.name AS actor, total_revenue","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has revenue $r; reduce $total = sum($r) groupby $n; sort $total desc; limit 5;"
recommendations,243,List the top 5 movies with a plot involving a 'young boy' or 'orphan'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'young boy' OR m.plot CONTAINS 'orphan'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; { $p contains ""young boy""; } or { $p contains ""orphan""; }; sort $r desc; limit 5; fetch { ""title"": $t, ""plot"": $p };"
recommendations,244,What are the top 3 genres of movies that have a budget less than 50 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget < 50000000
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match $m isa movie, has budget $b; $b < 50000000; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,246,Show the first 3 movies that feature an actor from France.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE a.bornIn = 'France'
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; acted_in (actor: $a, film: $m); $a has born_in ""France""; limit 3; fetch { ""title"": $t };"
recommendations,247,List the top 5 users who have rated the most movies released before 2000.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.year < 2000
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); $m has year $y; $y < 2000; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,248,Which 3 movies have the lowest imdbVotes but a rating higher than 7.0?,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0
RETURN m.title, m.imdbVotes, m.imdbRating
ORDER BY m.imdbVotes
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v, has imdb_rating $r; $r > 7.0; sort $v asc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v, ""imdb_rating"": $r };"
recommendations,249,List the first 5 actors who have acted in movies directed by a director born in Nebraska.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'Nebraska'})
RETURN a.name AS actor, m.title AS movie, d.name AS director
LIMIT 5","match $a isa person, has name $an; acted_in (actor: $a, film: $m); directed (director: $d, film: $m); $d has born_in ""Nebraska"", has name $dn; $m has title $t; limit 5; fetch { ""actor"": $an, ""movie"": $t, ""director"": $dn };"
recommendations,250,What are the top 3 movies released during the Christmas season (December)?,"MATCH (m:Movie)
WHERE m.released STARTS WITH ""12-""
RETURN m.title, m.released, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has released $rel, has imdb_rating $r; $rel contains ""-12-""; sort $r desc; limit 3; fetch { ""title"": $t, ""released"": $rel, ""imdb_rating"": $r };"
recommendations,251,Which 5 directors have directed movies with the highest average imdbRating?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
RETURN d.name AS director, avgRating
ORDER BY avgRating DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 5;"
recommendations,252,Show the first 3 actors who starred in a movie with a budget over 200 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 200000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b > 200000000; limit 3; fetch { ""name"": $n };"
recommendations,254,Which 3 actors have the most roles listed in their ACTED_IN relationships?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(r) AS numRoles
ORDER BY numRoles DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,256,Show the top 5 actors who have acted in movies with at least three different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 3
RETURN a.name AS actor, numDirectors
ORDER BY numDirectors DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
directed (director: $d, film: $m);
select $a, $n, $d;
distinct;
reduce $count = count($d) groupby $a, $n;
match $count >= 3;
sort $count desc;
limit 5;
fetch { ""actor"": $n, ""numDirectors"": $count };"
recommendations,258,List the first 5 directors who have a biography listed in their profile.,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
LIMIT 5","match $d isa person, has name $n, has bio $b; directed (director: $d, film: $m); limit 5; fetch { ""name"": $n, ""bio"": $b };"
recommendations,259,What are the top 3 movies with the most significant difference between budget and revenue?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit desc;
limit 3;
fetch { ""title"": $t, ""profit"": $profit };"
recommendations,260,Which 5 actors were born in the USA and have acted in at least two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bornIn = 'USA'
WITH a, count(m) AS numMovies
WHERE numMovies >= 2
RETURN a.name, a.bornIn, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n, has born_in ""USA"";
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
match $count >= 2;
sort $count desc;
limit 5;
fetch {
  ""name"": $n,
  ""born_in"": ""USA"",
  ""numMovies"": $count
};"
recommendations,261,Show the first 3 movies that have a poster URL and were released after 2010.,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL AND m.released > '2010'
RETURN m.title, m.poster, m.released
LIMIT 3","match $m isa movie, has poster $p, has released $r, has title $t; $r > ""2010""; limit 3; fetch { ""title"": $t, ""poster"": $p, ""released"": $r };"
recommendations,262,List the top 5 movies that have been rated the most number of times.,"MATCH (m:Movie)<-[r:RATED]-(:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 5","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 5;"
recommendations,263,What are the first 3 genres in which Harold Lloyd has directed movies?,"MATCH (d:Director {name: 'Harold Lloyd'})-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name
LIMIT 3","match $d isa person, has name ""Harold Lloyd""; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name $n; limit 3; fetch { ""genre"": $n };"
recommendations,264,Which 3 users have given the highest average rating to movies they've rated?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $n; sort $avg desc; limit 3;"
recommendations,265,List the first 5 directors who have directed a movie with an imdbRating of 9 or higher.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating >= 9
RETURN DISTINCT d.name
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; $r >= 9.0; limit 5; fetch { ""director"": $n };"
recommendations,266,Show the top 5 movies with the most actors involved.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title AS movie, numActors","match $m isa movie, has title $t; acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $t; sort $count desc; limit 5;"
recommendations,267,Which 3 movies have been directed by directors who have also acted in movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 3","match $d isa person; directed (director: $d, film: $m); acted_in (actor: $d, film: $m2); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,268,List the first 5 movies that have a language listed as 'French'.,"MATCH (m:Movie)
WHERE 'French' IN m.languages
RETURN m.title
LIMIT 5","match $m isa movie, has title $t, has languages $l; $l contains ""French""; limit 5; fetch { ""title"": $t };"
recommendations,269,What are the top 3 directors who have directed movies with the most diverse set of actors?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(DISTINCT a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN d.name AS director, numActors","match $d isa person, has name $n; directed (director: $d, film: $m); acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $n; sort $count desc; limit 3;"
recommendations,271,Show the first 3 actors who have directed a movie.,"MATCH (p:Person)-[:DIRECTED]->(:Movie)
RETURN p.name AS actor, p.tmdbId
LIMIT 3","match
$p isa person, has name $n, has tmdb_id $t;
acted_in (actor: $p, film: $m1);
directed (director: $p, film: $m2);
limit 3;
fetch { ""actor"": $n, ""tmdb_id"": $t };"
recommendations,274,Show the top 5 genres of movies that have a runtime of exactly 90 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime = 90
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 5","match $m isa movie, has runtime 90; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,275,Which 3 movies have been rated by the oldest users in terms of account creation date?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, u, r.timestamp AS ratedAt
ORDER BY ratedAt
RETURN m.title AS movie, m.year AS year
  ORDER BY ratedAt
  LIMIT 3","match $m isa movie, has title $t, has year $y; $r isa rated, links (user: $u, film: $m), has timestamp $ts; sort $ts asc; limit 3; fetch { ""movie"": $t, ""year"": $y };"
recommendations,277,Which 5 directors have the most movies released in the 2000s?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has year $y; $y >= 2000; $y < 2010; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,278,Show the first 3 genres that have movies with both an English and French language option.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN g.name AS genre
LIMIT 3","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has languages ""English"";
$m has languages ""French"";
limit 3;
fetch { ""genre"": $n };"
recommendations,279,List the top 5 highest-rated movies by users named 'John'.,"MATCH (u:User {name: 'John'})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5","match $u isa user, has name ""John""; $r isa rated, links (user: $u, film: $m), has rating $rating; $m has title $t; reduce $avg = mean($rating) groupby $t; sort $avg desc; limit 5;"
recommendations,280,What are the first 3 movies with the highest number of genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title AS movie, genreCount","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $t; sort $count desc; limit 3;"
recommendations,281,Which 3 directors have directed the most movies with a runtime over 150 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 150
WITH d, count(m) AS numLongMovies
ORDER BY numLongMovies DESC
LIMIT 3
RETURN d.name AS director, numLongMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r > 150; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,282,Which 3 genres have the least number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3
RETURN g.name AS genre, movieCount","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count asc; limit 3;"
recommendations,283,List the first 5 movies with a plot involving an 'evil exterminator'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil exterminator'
RETURN m.title, m.plot
LIMIT 5","match $m isa movie, has title $t, has plot $p; $p contains ""evil exterminator""; limit 5; fetch { ""title"": $t, ""plot"": $p };"
recommendations,284,What are the top 3 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r asc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,286,Show the first 3 actors who have acted in movies with a budget under 10 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget < 10000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b < 10000000; limit 3; fetch { ""name"": $n };"
recommendations,287,List the top 5 movies that have been rated by users with the most distinct names.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, count(distinct u.name) AS distinctNames
RETURN m.title, distinctNames
ORDER BY distinctNames DESC
LIMIT 5","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 5;"
recommendations,289,Which 3 directors have directed both animated and non-animated movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:IN_GENRE]->(:Genre {name: 'Animation'}) }
  AND exists{ (m)-[:IN_GENRE]->(:Genre) WHERE NOT exists{ (m)-[:IN_GENRE]->(:Genre {name: 'Animation'}) } }
RETURN d.name AS director
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m1) isa directed;
(film: $m1, genre: $g1) isa in_genre;
$g1 has name ""Animation"";
(director: $d, film: $m2) isa directed;
(film: $m2, genre: $g2) isa in_genre;
not { $g2 has name ""Animation""; };
limit 3;
fetch { ""director"": $n };"
recommendations,290,List the first 5 movies with a director who has also acted in a movie.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 5","match $d isa person; directed (director: $d, film: $m); acted_in (actor: $d, film: $m2); $m has title $t; limit 5; fetch { ""title"": $t };"
recommendations,291,Show the top 5 genres of movies that have been rated by the most users.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)<-[r:RATED]-(u:User)
WITH g, count(distinct u) AS userCount
ORDER BY userCount DESC
LIMIT 5
RETURN g.name AS genre, userCount","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); rated (user: $u, film: $m); reduce $count = count($u) groupby $n; sort $count desc; limit 5;"
recommendations,292,Which 3 actors have the most diverse range of genres in the movies they've acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name AS actor, genreCount AS numGenres","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); reduce $count = count($g) groupby $n; sort $count desc; limit 3;"
recommendations,293,List the first 5 movies with the highest number of directors involved.,"MATCH (m:Movie)
WITH m, size([(d)-[:DIRECTED]->(m) | d]) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 5
RETURN m.title AS movie, numDirectors","match $m isa movie, has title $t; directed (director: $d, film: $m); reduce $count = count($d) groupby $t; sort $count desc; limit 5;"
recommendations,294,What are the top 3 movies with a plot involving a 'friendship'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; $p contains ""friendship""; sort $r desc; limit 3; fetch { ""title"": $t, ""plot"": $p };"
recommendations,295,Which 5 actors have acted in movies released in the most distinct years?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(DISTINCT m.year) AS num_years
ORDER BY num_years DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has year $y; reduce $count = count($y) groupby $n; sort $count desc; limit 5;"
recommendations,296,List the top 5 directors with the most movies that have an imdbRating of 6 or higher.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating >= 6
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; $r >= 6.0; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,297,What are the first 3 genres of movies that have been directed by directors born after 1980?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE d.born > date('1980-01-01')
RETURN g.name AS genre
ORDER BY genre
LIMIT 3","match $d isa person, has born $b; $b > 1980-01-01; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name $n; sort $n asc; limit 3; fetch { ""genre"": $n };"
recommendations,298,Which 3 users have rated movies with the most diverse range of imdbRatings?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, max(m.imdbRating) AS maxRating, min(m.imdbRating) AS minRating
RETURN u.name AS user, maxRating, minRating, maxRating - minRating AS ratingRange
ORDER BY ratingRange DESC
LIMIT 3","match
$u isa user, has name $n;
rated (user: $u, film: $m);
$m has imdb_rating $r;
reduce $maxRating = max($r), $minRating = min($r) groupby $u, $n;
match
let $ratingRange = $maxRating - $minRating;
sort $ratingRange desc;
limit 3;
fetch { ""user"": $n, ""maxRating"": $maxRating, ""minRating"": $minRating, ""ratingRange"": $ratingRange };"
recommendations,301,List the top 5 movies directed by a person named 'Graham Annable'.,"MATCH (p:Person {name: 'Graham Annable'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $p isa person, has name ""Graham Annable""; directed (director: $p, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,302,Which 3 users gave the highest ratings to the movie titled 'Toy Story'?,"MATCH (m:Movie {title: 'Toy Story'})<-[r:RATED]-(u:User)
RETURN u.name AS user, r.rating AS rating
ORDER BY r.rating DESC
LIMIT 3","match $m isa movie, has title ""Toy Story""; $r isa rated, links (user: $u, film: $m), has rating $rating; $u has name $n; sort $rating desc; limit 3; fetch { ""user"": $n, ""rating"": $rating };"
recommendations,303,Find the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
match $numMovies > 10;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,304,"What are the top 3 most profitable movies, considering the difference between revenue and budget?","MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL
RETURN m.title AS movie, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit desc;
limit 3;
fetch { ""title"": $t, ""profit"": $profit };"
recommendations,305,Which 3 movies have been rated by the most users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 3;"
recommendations,306,Name the top 5 directors born in the USA.,"MATCH (d:Director {bornIn: 'USA'})
RETURN d.name
ORDER BY d.born DESC
LIMIT 5","match $d isa person, has name $n, has born_in ""USA"", has born $b; directed (director: $d, film: $m); sort $b desc; limit 5; fetch { ""name"": $n };"
recommendations,307,List 3 movies released in 1995.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '1995'
RETURN m.title
LIMIT 3","match
$m isa movie, has released $r, has title $t;
$r like ""1995.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,308,What are the top 5 highest-grossing movies of 2014?,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has year 2014, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,309,Which 3 actors have played roles in both acting and directing for the same movie?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN p.name AS person, m.title AS movie
LIMIT 3","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""person"": $n, ""movie"": $t };"
recommendations,310,List the top 5 movies with an IMDb rating above 8.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 8.0
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; $r > 8.0; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,311,What are the top 3 genres with the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,312,Which 3 directors have the longest filmography in the database?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,313,List the top 5 movies that have been rated after 2015.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= 1420070400 // Unix timestamp for 2015-01-01
WITH m, avg(r.rating) AS avgRating, count(r) AS numRatings
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating, numRatings","match
$m isa movie, has title $t;
$r isa rated, links (user: $u, film: $m), has timestamp $ts, has rating $rating;
$ts >= 1451606400;
reduce $avg = mean($rating), $count = count($r) groupby $m, $t;
sort $avg desc;
limit 5;
fetch {
  ""movie"": $t,
  ""avgRating"": $avg,
  ""numRatings"": $count
};"
recommendations,314,Which 3 movies have the highest IMDb votes?,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,315,Name the top 5 actors who have acted in movies with a runtime longer than 150 minutes.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.runtime > 150
RETURN a.name, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has runtime $r; $r > 150; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,316,List 3 actors born in France who have directed a movie.,"MATCH (p:Person)
WHERE p.bornIn = 'France' AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n, has born_in ""France""; directed (director: $p, film: $m1); acted_in (actor: $p, film: $m2); limit 3; fetch { ""name"": $n };"
recommendations,317,What are the top 5 movies with a budget over $100 million?,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b; $b > 100000000; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,318,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,319,Name the top 5 movies with IMDb ratings lower than 5.0.,"MATCH (m:Movie)
WHERE m.imdbRating < 5.0
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; $r < 5.0; sort $r asc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,320,List the top 3 directors who died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died DESC
LIMIT 3","match $d isa person, has name $n, has died $d2; directed (director: $d, film: $m); $d2 > 2000-01-01; sort $d2 desc; limit 3; fetch { ""name"": $n, ""died"": $d2 };"
recommendations,321,What are the top 5 movies in the 'Adventure' genre with the highest revenue?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; in_genre (film: $m, genre: $g); $g has name ""Adventure""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,323,List the top 5 actors with the most roles in movies released before 1980.,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
WHERE m.year < 1980
WITH a, count(r) AS numRoles
ORDER BY numRoles DESC
LIMIT 5
RETURN a.name AS actor, numRoles","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has year $y; $y < 1980; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,324,Which 3 directors were born before 1900?,"MATCH (d:Director)
WHERE d.born < date('1900-01-01')
RETURN d.name, d.born
ORDER BY d.born
LIMIT 3","match $d isa person, has name $n, has born $b; directed (director: $d, film: $m); $b < 1900-01-01; sort $b asc; limit 3; fetch { ""name"": $n, ""born"": $b };"
recommendations,325,Name the top 5 most voted movies on IMDb released after 2010.,"MATCH (m:Movie)
WHERE m.year > 2010 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has imdb_votes $v; $y > 2010; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,326,List the 3 users who have given the lowest average ratings.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $n; sort $avg asc; limit 3;"
recommendations,328,Which 3 actors have the most roles in comedy movies?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
RETURN a.name AS actor, count(r) AS roles
ORDER BY roles DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); $g has name ""Comedy""; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,329,Name the top 5 movies that have been rated by users named 'Omar Huffman'.,"MATCH (u:User {name: 'Omar Huffman'})-[r:RATED]->(m:Movie)
RETURN m.title, r.rating
ORDER BY r.rating DESC
LIMIT 5","match $u isa user, has name ""Omar Huffman""; $r isa rated, links (user: $u, film: $m), has rating $rating; $m has title $t; sort $rating desc; limit 5; fetch { ""title"": $t, ""rating"": $rating };"
recommendations,330,List the top 3 movies with the shortest runtime.,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r asc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,331,What are the top 5 movies directed by directors born in Nebraska?,"MATCH (d:Director {bornIn: 'Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has born_in ""Nebraska, USA""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,332,Which 3 movies have the lowest revenue despite having a high IMDb rating (over 7.0)?,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 3","match $m isa movie, has title $t, has revenue $r, has imdb_rating $i; $i > 7.0; sort $r asc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,333,List the top 5 actors who have acted in movies directed by 'Anthony Stacchi'.,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN a.name AS actor, count(*) AS appearances
ORDER BY appearances DESC
LIMIT 5","match $d isa person, has name ""Anthony Stacchi""; directed (director: $d, film: $m); acted_in (actor: $a, film: $m); $a has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,334,Which 3 genres has 'Toy Story' been categorized under?,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name
LIMIT 3","match $m isa movie, has title ""Toy Story""; in_genre (film: $m, genre: $g); $g has name $n; limit 3; fetch { ""genre"": $n };"
recommendations,335,Name the top 5 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.budget / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 5;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
recommendations,336,What are the top 5 movies with the highest revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,337,Which three movies have the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,338,List the top 5 movies with the most number of IMDb votes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,339,What are the first 3 movies released after 2010?,"MATCH (m:Movie)
WHERE m.released > '2010-01-01'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match $m isa movie, has title $t, has released $r; $r > ""2010-01-01""; sort $r asc; limit 3; fetch { ""title"": $t, ""released"": $r };"
recommendations,340,Which three users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,341,List the top 3 directors by the number of movies directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS moviesDirected
ORDER BY moviesDirected DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,342,What are the top 3 genres by the number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,343,Which three actors have acted in the most movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,344,List the first 3 movies that have a budget greater than 100 million USD.,"MATCH (m:Movie)
WHERE m.budget > 100000000
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 3","match $m isa movie, has title $t, has budget $b; $b > 100000000; sort $b desc; limit 3; fetch { ""title"": $t, ""budget"": $b };"
recommendations,345,What are the top 3 highest rated movies by users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN m.title AS movie, avgRating AS `Average Rating`","match $m isa movie, has title $t; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $t; sort $avg desc; limit 3;"
recommendations,346,Which three movies have the highest IMDb rating?,"MATCH (m:Movie)
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,347,List the top 5 movies with the lowest revenue.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r asc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,348,What are the first 3 movies that were released in the USA?,"MATCH (m:Movie)
WHERE 'USA' IN m.countries
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
$m isa movie, has countries $c, has title $t, has released $r;
$c like "".*USA.*"";
sort $r asc;
limit 3;
fetch { ""title"": $t, ""released"": $r };"
recommendations,349,Which three directors were born in the USA?,"MATCH (d:Director)
WHERE d.bornIn CONTAINS 'USA'
RETURN d.name
LIMIT 3","match
$d isa person, has born_in $b, has name $n;
(director: $d, film: $m) isa directed;
$b like "".*USA.*"";
limit 3;
fetch { ""name"": $n };"
recommendations,350,List the top 3 actors by the number of IMDb votes they've received for their movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, sum(m.imdbVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_votes $v; reduce $total = sum($v) groupby $n; sort $total desc; limit 3;"
recommendations,351,What are the first 3 movies with a runtime less than 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime < 90
RETURN m.title
LIMIT 3","match $m isa movie, has title $t, has runtime $r; $r < 90; limit 3; fetch { ""title"": $t };"
recommendations,352,Which three users have the highest average rating given to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; reduce $avg = mean($rating) groupby $n; sort $avg desc; limit 3;"
recommendations,353,List the top 3 movies with a plot mentioning 'love'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has plot $p, has title $t, has imdb_rating $r;
$p like "".*love.*"";
sort $r desc;
limit 3;
fetch { ""title"": $t, ""plot"": $p };"
recommendations,354,What are the first 3 movies that have a revenue to budget ratio greater than 3?,"MATCH (m:Movie)
WHERE m.revenue > 3 * m.budget
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue / m.budget DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > ($bud * 3);
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
recommendations,356,List the top 5 movies released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has imdb_rating $r; $y >= 2000; $y < 2010; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,357,What are the first 3 movies with a title starting with 'The'?,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The'
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; $t like ""The%""; limit 3; fetch { ""title"": $t };"
recommendations,358,Which three directors have directed movies in more than 2 different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 2
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
directed (director: $d, film: $m);
in_genre (film: $m, genre: $g);
select $d, $n, $g;
distinct;
reduce $count = count($g) groupby $d, $n;
match $count > 2;
sort $count desc;
limit 3;
fetch {
  ""director"": $n,
  ""num_genres"": $count
};"
recommendations,359,List the top 3 genres that have movies with an average IMDb rating over 7.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH g, avg(m.imdbRating) AS avgRating
WHERE avgRating > 7
RETURN g.name AS genre, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has imdb_rating $r;
reduce $avg = mean($r) groupby $n;
match $avg > 7;
sort $avg desc;
limit 3;
fetch {
  ""genre"": $n,
  ""avgRating"": $avg
};"
recommendations,360,What are the first 3 movies where the main actor was born in France?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bornIn = 'France'
RETURN m.title
LIMIT 3","match $a isa person, has born_in ""France""; acted_in (actor: $a, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,362,List the top 3 movies that were most frequently rated by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $m isa movie, has title $t; rated (user: $u, film: $m); reduce $count = count($u) groupby $t; sort $count desc; limit 3;"
recommendations,363,What are the first 3 movies with an IMDb rating lower than 5?,"MATCH (m:Movie)
WHERE m.imdbRating < 5
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; $r < 5.0; sort $r asc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,364,Which three directors have directed movies with a total revenue over 500 million USD?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
WITH d, sum(m.revenue) AS total_revenue
WHERE total_revenue > 500000000
RETURN d.name AS director, total_revenue
ORDER BY total_revenue DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has revenue $r; reduce $total = sum($r) groupby $d, $n; match $total > 500000000; sort $total desc; limit 3; fetch { ""director"": $n, ""total_revenue"": $total };"
recommendations,365,What are the first 3 movies with a poster URL containing 'face'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster $p, has title $t;
$p like "".*face.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,366,Which three movies feature both American and Japanese actors?,"MATCH (m:Movie)
WHERE exists{ (a1:Actor)-[:ACTED_IN]->(m) WHERE a1.bornIn = 'USA' }
  AND exists{ (a2:Actor)-[:ACTED_IN]->(m) WHERE a2.bornIn = 'Japan' }
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; acted_in (actor: $a1, film: $m); acted_in (actor: $a2, film: $m); $a1 has born_in ""USA""; $a2 has born_in ""Japan""; limit 3; fetch { ""title"": $t };"
recommendations,367,List the first 3 directors who have died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died
LIMIT 3","match $d isa person, has name $n, has died $d2; directed (director: $d, film: $m); $d2 > 2000-01-01; sort $d2 asc; limit 3; fetch { ""name"": $n, ""died"": $d2 };"
recommendations,368,What are the first 3 movies with an IMDb rating greater than 8 and less than 9?,"MATCH (m:Movie)
WHERE m.imdbRating > 8 AND m.imdbRating < 9
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; $r > 8.0; $r < 9.0; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,369,Which three genres have the least number of movies associated with them?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3
RETURN g.name AS genre, movieCount","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); reduce $count = count($m) groupby $n; sort $count asc; limit 3;"
recommendations,370,What are the first 3 movies with a plot mentioning 'zombie'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'zombie'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*zombie.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,371,Which three directors have the highest average IMDb rating for their movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
RETURN d.name AS director, avgRating
ORDER BY avgRating DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 3;"
recommendations,372,List the top 3 actors born in the 1980s.,"MATCH (a:Actor)
WHERE a.born >= date('1980-01-01') AND a.born < date('1990-01-01')
RETURN a.name, a.born
ORDER BY a.born DESC
LIMIT 3","match $a isa person, has name $n, has born $b; acted_in (actor: $a, film: $m); $b >= 1980-01-01; $b < 1990-01-01; sort $b desc; limit 3; fetch { ""name"": $n, ""born"": $b };"
recommendations,373,What are the first 3 movies that have a language list containing 'Turkish'?,"MATCH (m:Movie)
WHERE 'Turkish' IN m.languages
RETURN m.title
LIMIT 3","match
$m isa movie, has languages $l, has title $t;
$l like "".*Turkish.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,374,Which three users have rated the oldest movies on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(m.year) AS avgYear
RETURN u.name, avgYear
ORDER BY avgYear
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); $m has year $y; reduce $avg = mean($y) groupby $n; sort $avg asc; limit 3;"
recommendations,375,List the top 3 movies with a release date on or before '2000-01-01'.,"MATCH (m:Movie)
WHERE m.released <= '2000-01-01'
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match $m isa movie, has title $t, has released $r; $r <= ""2000-01-01""; sort $r desc; limit 3; fetch { ""title"": $t, ""released"": $r };"
recommendations,376,What are the first 3 movies directed by a person who has also acted in movies?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 3","match $p isa person; directed (director: $p, film: $m); acted_in (actor: $p, film: $m2); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,378,List the top 3 actors who have directed movies they acted in.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
WITH p, count(m) AS both
ORDER BY both DESC
LIMIT 3
RETURN p.name AS name, both","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,379,What are the first 3 movies with a revenue greater than their budget?,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.revenue, m.budget
ORDER BY m.revenue DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > $bud;
sort $rev desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
recommendations,380,Which three genres have the highest average revenue per movie?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue IS NOT NULL
WITH g.name AS genre, avg(m.revenue) AS avgRevenue
RETURN genre, avgRevenue
ORDER BY avgRevenue DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (film: $m, genre: $g); $m has revenue $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 3;"
recommendations,381,List the top 3 directors who have directed the most successful movies in terms of revenue.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.revenue IS NOT NULL
WITH d, sum(m.revenue) AS total_revenue
ORDER BY total_revenue DESC
LIMIT 3
RETURN d.name AS director, total_revenue","match $d isa person, has name $n; directed (director: $d, film: $m); $m has revenue $r; reduce $total = sum($r) groupby $n; sort $total desc; limit 3;"
recommendations,382,Which three actors have the longest total screen time in movies?,"MATCH (a:Actor)-[r:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, sum(m.runtime) AS totalScreenTime
ORDER BY totalScreenTime DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has runtime $r; reduce $total = sum($r) groupby $n; sort $total desc; limit 3;"
recommendations,384,What are the first 3 movies that have a plot mentioning 'war'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'war'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*war.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,385,Which three users have rated the most number of actors?,"MATCH (u:User)-[:RATED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH u, count(distinct a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN u.name AS user, numActors","match $u isa user, has name $n; rated (user: $u, film: $m); acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $n; sort $count desc; limit 3;"
recommendations,386,List the top 3 movies that have been released on a leap year.,"MATCH (m:Movie)
WHERE m.released IS NOT NULL AND date(m.released).year % 4 = 0
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match
$m isa movie, has title $t, has released $rel, has year $y;
let $rem = $y % 4;
$rem == 0;
sort $rel desc;
limit 3;
fetch { ""title"": $t, ""released"": $rel };"
recommendations,387,What are the first 3 movies with the most number of associated actors?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 3","match $m isa movie, has title $t; acted_in (actor: $a, film: $m); reduce $count = count($a) groupby $t; sort $count desc; limit 3;"
recommendations,389,List the first 3 actors who have acted in a movie with a budget over 50 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 50000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b > 50000000; limit 3; fetch { ""name"": $n };"
recommendations,390,What are the top 5 movies that have a genre of 'Sci-Fi'?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Sci-Fi'})
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; in_genre (film: $m, genre: $g); $g has name ""Sci-Fi""; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,393,What are the first 3 movies that have a plot mentioning 'adventure'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*adventure.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,394,Which three genres are most common among movies with a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
WITH g, count(*) AS count
ORDER BY count DESC
LIMIT 3
RETURN g.name AS genre, count","match $m isa movie, has budget $b; $b > 100000000; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 3;"
recommendations,395,List the top 3 actors who have the highest average IMDb rating across their movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
RETURN a.name AS actor, avgRating
ORDER BY avgRating DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_rating $r; reduce $avg = mean($r) groupby $n; sort $avg desc; limit 3;"
recommendations,397,Which three users have rated movies in the most number of different genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS numGenres
ORDER BY numGenres DESC
LIMIT 3
RETURN u.name AS user, numGenres","match
$u isa user, has name $n;
rated (user: $u, film: $m);
in_genre (film: $m, genre: $g);
select $u, $n, $g;
distinct;
reduce $count = count($g) groupby $u, $n;
sort $count desc;
limit 3;
fetch {
  ""user"": $n,
  ""numGenres"": $count
};"
recommendations,398,List the top 3 movies that have been directed by actors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, count(*) AS actorDirectorCount
ORDER BY actorDirectorCount DESC
LIMIT 3","match $p isa person; acted_in (actor: $p); directed (director: $p, film: $m); $m has title $t; select $m, $p, $t; distinct; reduce $count = count($p) groupby $m, $t; sort $count desc; limit 3; fetch { ""movie"": $t, ""actorDirectorCount"": $count };"
recommendations,399,What are the first 3 movies with a plot mentioning 'family'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'family'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*family.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,402,List the first 3 actors who have acted in historical movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'History'})
RETURN a.name AS actor
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); $g has name ""History""; limit 3; fetch { ""actor"": $n };"
recommendations,403,What are the top 3 movies with a title ending in 'End'?,"MATCH (m:Movie)
WHERE m.title ENDS WITH 'End'
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_rating $r; $t like ""%End""; sort $r desc; limit 3; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,405,What are the first 3 movies with an IMDb rating above 7 and more than 100000 IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbRating > 7 AND m.imdbVotes > 100000
RETURN m.title, m.imdbRating, m.imdbVotes
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r, has imdb_votes $v; $r > 7.0; $v > 100000; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r, ""imdb_votes"": $v };"
recommendations,407,What are the first 3 movies with an actor who has a biography mentioning 'model'?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.bio CONTAINS 'model'
RETURN m.title
LIMIT 3","match
$a isa person, has bio $b;
(actor: $a, film: $m) isa acted_in;
$m has title $t;
$b like "".*model.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,408,Which three genres have the most movies with a runtime over 120 minutes?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.runtime > 120
RETURN g.name AS genre, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 3","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has runtime $r;
$r > 120;
reduce $count = count($m) groupby $g;
sort $count desc;
limit 3;
fetch {
  ""genre"": $g.name,
  ""numMovies"": $count
};"
recommendations,409,What are the first 3 movies with an actor born before 1900?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born < date('1900-01-01')
RETURN m.title
LIMIT 3","match $a isa person, has born $b; $b < 1900-01-01; acted_in (actor: $a, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,410,Which three movies have the highest difference in revenue and budget?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL
RETURN m.title AS movie, m.revenue - m.budget AS profit
ORDER BY profit DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
let $profit = $rev - $bud;
sort $profit desc;
limit 3;
fetch { ""title"": $t, ""profit"": $profit };"
recommendations,411,List the top 3 directors who have worked with the most number of actors.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE d.name IS NOT NULL AND a.name IS NOT NULL
WITH d, count(DISTINCT a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN d.name AS director, numActors","match
$d isa person, has name $n;
directed (director: $d, film: $m);
acted_in (actor: $a, film: $m);
select $a, $n;
distinct;
reduce $count = count($a) groupby $n;
sort $count desc;
limit 3;
fetch {
  ""director"": $n,
  ""numActors"": $count
};
"
recommendations,412,What are the first 3 movies with plots that involve a natural disaster?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'natural disaster'
RETURN m.title, m.plot
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*natural disaster.*"";
limit 3;
fetch { ""title"": $t, ""plot"": $p };"
recommendations,413,Which three users have rated the highest budget movies on average?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(m.budget) AS avgBudget
ORDER BY avgBudget DESC
LIMIT 3
RETURN u.name AS user, avgBudget","match
$u isa user, has name $n;
rated (user: $u, film: $m);
$m has budget $b;
reduce $avg = mean($b) groupby $u, $n;
sort $avg desc;
limit 3;
fetch {
  ""user"": $n,
  ""avgBudget"": $avg
};"
recommendations,414,List the top 3 actors who have acted in both 'Action' and 'Romance' genres.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Action', 'Romance']
WITH a, count(DISTINCT g) AS numGenres
WHERE numGenres = 2
RETURN a.name, a.tmdbId
ORDER BY a.name
LIMIT 3","match $a isa person, has name $n, has tmdb_id $t; acted_in (actor: $a, film: $m1); acted_in (actor: $a, film: $m2); in_genre (film: $m1, genre: $g1); in_genre (film: $m2, genre: $g2); $g1 has name ""Action""; $g2 has name ""Romance""; limit 3; fetch { ""name"": $n, ""tmdb_id"": $t };"
recommendations,415,What are the first 3 movies released in 'January'?,"MATCH (m:Movie)
WHERE m.released STARTS WITH 'January'
RETURN m.title, m.released
ORDER BY m.released
LIMIT 3","match
$m isa movie, has released $r, has title $t;
$r like ""January.*"";
sort $r asc;
limit 3;
fetch { ""title"": $t, ""released"": $r };"
recommendations,416,Which three directors have the longest average movie runtime?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, avg(m.runtime) AS avgRuntime
RETURN d.name AS director, avgRuntime
ORDER BY avgRuntime DESC
LIMIT 3","match
$d isa person, has name $n;
directed (director: $d, film: $m);
$m has runtime $r;
reduce $avg = mean($r) groupby $n;
sort $avg desc;
limit 3;
fetch {
  ""director"": $n,
  ""avgRuntime"": $avg
};"
recommendations,417,List the top 3 movies with a significant plot twist mentioned in the plot.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'twist'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has plot $p, has title $t, has imdb_rating $r;
$p like "".*twist.*"";
sort $r desc;
limit 3;
fetch { ""title"": $t, ""plot"": $p };"
recommendations,418,What are the first 3 movies with a revenue less than 1000 USD?,"MATCH (m:Movie)
WHERE m.revenue < 1000
RETURN m.title, m.revenue
ORDER BY m.revenue
LIMIT 3","match $m isa movie, has title $t, has revenue $r; $r < 1000; sort $r asc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,419,Which three users have rated the most diverse set of movies in terms of genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN u.name AS user, genreCount AS distinctGenresRated","match $u isa user, has name $n; rated (user: $u, film: $m); in_genre (film: $m, genre: $g); select $n, $g; distinct; reduce $count = count($g) groupby $n; sort $count desc; limit 3; fetch { ""user"": $n, ""distinctGenresRated"": $count };"
recommendations,420,List the top 3 actors who have the most diverse filmography in terms of genres they acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(DISTINCT g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name AS actor, genreCount AS numGenres","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
in_genre (film: $m, genre: $g);
select $a, $n, $g;
distinct;
reduce $count = count($g) groupby $a, $n;
sort $count desc;
limit 3;
fetch {
  ""actor"": $n,
  ""numGenres"": $count
};"
recommendations,421,What are the first 3 movies with a poster URL containing 'moon'?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'moon'
RETURN m.title
LIMIT 3","match
$m isa movie, has poster $p, has title $t;
$p like "".*moon.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,422,List the first 3 actors who have acted in a superhero movie.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(:Genre {name: 'Superhero'})
RETURN a.name AS actor
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); $g has name ""Superhero""; limit 3; fetch { ""actor"": $n };"
recommendations,424,Which three genres have the lowest average IMDb rating?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g, avg(m.imdbRating) AS avgRating
ORDER BY avgRating
LIMIT 3
RETURN g.name AS genre, avgRating","match
$g isa genre, has name $n;
in_genre (film: $m, genre: $g);
$m has imdb_rating $r;
reduce $avg = mean($r) groupby $n;
sort $avg asc;
limit 3;
fetch { ""genre"": $n, ""avgRating"": $avg };"
recommendations,425,List the top 3 movies that have been rated by over 1000 users.,"MATCH (m:Movie)<-[r:RATED]-()
WITH m, count(r) AS numRatings
WHERE numRatings > 1000
RETURN m.title, m.year, numRatings
ORDER BY numRatings DESC
LIMIT 3","match
$m isa movie, has title $t, has year $y;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $m, $t, $y;
match $numRatings > 1000;
sort $numRatings desc;
limit 3;
fetch { ""title"": $t, ""year"": $y, ""numRatings"": $numRatings };"
recommendations,426,What are the first 3 movies with a plot mentioning 'magic'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'magic'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*magic.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,427,Which three directors have the most movies with a runtime under 90 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime < 90
WITH d, count(m) AS numShortMovies
ORDER BY numShortMovies DESC
LIMIT 3
RETURN d.name AS director, numShortMovies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
$m has runtime $r;
$r < 90;
reduce $count = count($m) groupby $d, $n;
sort $count desc;
limit 3;
fetch {
  ""director"": $n,
  ""numShortMovies"": $count
};"
recommendations,428,Which movies have a runtime greater than 120 minutes and less than 180 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.runtime < 180
RETURN m.title, m.runtime
LIMIT 5","match $m isa movie, has title $t, has runtime $r; $r > 120; $r < 180; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,429,List all movies directed by a person born in France.,"MATCH (p:Person {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 5","match $p isa person, has born_in ""France""; directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t };"
recommendations,430,What are the top 5 highest-grossing movies released after 2010?,"MATCH (m:Movie)
WHERE m.released >= '2010-01-01' AND m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has revenue $r; $rel >= ""2010-01-01""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,431,Find all actors who acted in a movie that grossed over 500 million.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has revenue $r; $r > 500000000; limit 5; fetch { ""actor"": $n };"
recommendations,432,Which directors have directed more than three movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS num_movies
WHERE num_movies > 3
RETURN d.name AS director, num_movies","match
$d isa person, has name $n;
directed (director: $d, film: $m);
reduce $num_movies = count($m) groupby $d, $n;
match $num_movies > 3;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
recommendations,433,List all movies with an IMDb rating above 8.0 that were released after 2000.,"MATCH (m:Movie)
WHERE m.imdbRating > 8.0 AND m.year >= 2000
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r, has year $y; $r > 8.0; $y >= 2000; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,434,Which users have rated more than 50 movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
WHERE num_ratings > 50
RETURN u.name AS user, num_ratings","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $u, $n;
match $numRatings > 50;
fetch { ""user"": $n, ""numRatings"": $numRatings };"
recommendations,435,Which genres are associated with movies that have a budget over 100 million?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
RETURN DISTINCT g.name AS genre
LIMIT 5","match $m isa movie, has budget $b; $b > 100000000; in_genre (film: $m, genre: $g); $g has name $n; reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,436,List all actors born in the USA who have acted in more than 5 movies.,"MATCH (a:Actor {bornIn: 'USA'})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n, has born_in ""USA"";
acted_in (actor: $a, film: $m);
reduce $count = count($m) groupby $a, $n;
match $count > 5;
sort $count desc;
limit 5;
fetch {
  ""name"": $n,
  ""numMovies"": $count
};"
recommendations,437,What are the top 3 movies with the highest IMDb rating released before 1990?,"MATCH (m:Movie)
WHERE m.released < '1990-01-01' AND m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has released $rel, has imdb_rating $r; $rel < ""1990-01-01""; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,438,Which movies have been acted in and directed by the same person?,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title, p.name
LIMIT 5","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t, ""person"": $n };"
recommendations,439,Find all movies where the main language is English and have a budget over 50 million dollars.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND m.budget > 50000000
RETURN m","match
$m isa movie, has languages $l, has budget $b, has title $t, has url $u, has runtime $rt, has revenue $rev, has imdb_rating $ir, has released $rel, has countries $c, has plot $p, has imdb_votes $iv, has imdb_id $iid, has year $y, has poster $po, has movie_id $mid, has tmdb_id $tid;
$l like "".*English.*"";
$b > 50000000;
fetch { ""title"": $t, ""url"": $u, ""runtime"": $rt, ""revenue"": $rev, ""imdb_rating"": $ir, ""released"": $rel, ""countries"": $c, ""languages"": $l, ""plot"": $p, ""imdb_votes"": $iv, ""imdb_id"": $iid, ""year"": $y, ""poster"": $po, ""movie_id"": $mid, ""tmdb_id"": $tid, ""budget"": $b };"
recommendations,440,Which users have given a rating of less than 3.0 to any movie?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE r.rating < 3.0
RETURN u.name, m.title, r.rating
LIMIT 5","match $u isa user, has name $n; $r isa rated, links (user: $u, film: $m), has rating $rating; $rating < 3.0; $m has title $t; limit 5; fetch { ""user"": $n, ""movie"": $t, ""rating"": $rating };"
recommendations,441,List the top 5 movies with the most IMDb votes.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,442,Which movies feature both English and Spanish as languages?,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'Spanish' IN m.languages
RETURN m.title","match
$m isa movie, has languages $l, has title $t;
$l like "".*English.*"";
$l like "".*Spanish.*"";
fetch { ""title"": $t };"
recommendations,443,Find all directors who were born after 1970.,"MATCH (d:Director)
WHERE d.born > date('1970-01-01')
RETURN d.name, d.born
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d, film: $m); $b > 1970-01-01; limit 5; fetch { ""name"": $n, ""born"": $b };"
recommendations,444,Which actors have worked in both 'Animation' and 'Comedy' genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Animation'})
MATCH (a)-[:ACTED_IN]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Comedy'})
RETURN DISTINCT a.name
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m1); acted_in (actor: $a, film: $m2); in_genre (film: $m1, genre: $g1); in_genre (film: $m2, genre: $g2); $g1 has name ""Animation""; $g2 has name ""Comedy""; limit 5; fetch { ""actor"": $n };"
recommendations,445,List all movies that have grossed more than their budget.,"MATCH (m:Movie)
WHERE m.revenue > m.budget
RETURN m.title, m.revenue, m.budget","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > $bud;
sort $rev desc;
limit 10;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud };"
recommendations,446,What are the top 5 movies with the lowest budgets that have a runtime over 90 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 90 AND m.budget IS NOT NULL
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match $m isa movie, has title $t, has budget $b, has runtime $r; $r > 90; sort $b asc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,448,Which directors have a biography mentioning 'Academy Award'?,"MATCH (d:Director)
WHERE d.bio CONTAINS 'Academy Award'
RETURN d.name, d.bio","match
$d isa person, has bio $b, has name $n;
(director: $d, film: $m) isa directed;
$b like "".*Academy Award.*"";
fetch { ""name"": $n, ""bio"": $b };"
recommendations,449,List all movies directed by someone who has also acted in a movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN m.title
LIMIT 5","match $p isa person, has name $n; directed (director: $p, film: $m); acted_in (actor: $p, film: $m2); $m has title $t; limit 5; fetch { ""title"": $t };"
recommendations,451,Find all actors who have acted in a movie directed by someone born in France.,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)<-[:DIRECTED]-(director:Director {bornIn: 'France'})
RETURN actor.name, movie.title
LIMIT 5","match $actor isa person, has name $an; $director isa person, has name $dn; acted_in (actor: $actor, film: $movie); directed (director: $director, film: $movie); $director has born_in ""France""; $movie has title $t; limit 5; fetch { ""actor"": $an, ""movie"": $t };"
recommendations,452,Which movies have a plot mentioning 'war'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'war'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*war.*"";
fetch { ""title"": $t, ""plot"": $p };"
recommendations,453,List all genres that a specific movie 'Toy Story' belongs to.,"MATCH (m:Movie {title: 'Toy Story'})-[:IN_GENRE]->(g:Genre)
RETURN g.name","match $m isa movie, has title ""Toy Story""; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
recommendations,454,Find the top 5 movies by revenue that have a runtime under 100 minutes.,"MATCH (m:Movie)
WHERE m.runtime < 100
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r, has runtime $rt; $rt < 100; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,455,Which actors have the highest number of movies acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $count = count($m) groupby $n; sort $count desc; limit 5;"
recommendations,456,List all directors who have directed a movie in the Comedy genre.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Comedy'})
RETURN DISTINCT d.name
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); $g has name ""Comedy""; limit 5; fetch { ""director"": $n };"
recommendations,457,What are the top 3 movies with the highest budget that also have revenue data?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue
ORDER BY m.budget DESC
LIMIT 3","match $m isa movie, has title $t, has budget $b, has revenue $r; sort $b desc; limit 3; fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
recommendations,458,Which movies have been rated 5.0 by more than 10 users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
WITH m, count(u) AS numRatings
WHERE numRatings > 10
RETURN m.title, numRatings","match
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating 5.0;
reduce $numRatings = count($u) groupby $t;
sort $numRatings desc;
limit 10;
fetch { ""title"": $t, ""numRatings"": $numRatings };"
recommendations,459,List all movies where the main actor is also the director.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title, p.name
LIMIT 5","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t, ""person"": $n };"
recommendations,460,Find all movies with a poster URL that includes 'face' in it.,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face'
RETURN m","match
$m isa movie, has poster $p, has title $t, has url $u, has runtime $rt, has revenue $rev, has imdb_rating $ir, has released $rel, has countries $c, has languages $l, has plot $pl, has imdb_votes $iv, has imdb_id $iid, has year $y, has movie_id $mid, has tmdb_id $tid, has budget $b;
$p like "".*face.*"";
fetch { ""title"": $t, ""url"": $u, ""runtime"": $rt, ""revenue"": $rev, ""imdb_rating"": $ir, ""released"": $rel, ""countries"": $c, ""languages"": $l, ""plot"": $pl, ""imdb_votes"": $iv, ""imdb_id"": $iid, ""year"": $y, ""poster"": $p, ""movie_id"": $mid, ""tmdb_id"": $tid, ""budget"": $b };"
recommendations,461,Which movies have been released on a leap day?,"MATCH (m:Movie)
WHERE m.released =~ "".+02-29""
RETURN m.title, m.released","match $m isa movie, has released $r, has title $t; $r like "".*02-29.*""; fetch { ""title"": $t, ""released"": $r };"
recommendations,462,List all actors who have never acted in an 'Action' genre movie.,"MATCH (a:Actor)
WHERE NOT exists {
  (a)-[:ACTED_IN]->(:Movie)-[:IN_GENRE]->(:Genre {name: 'Action'})
}
RETURN a.name AS actor","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
not {
    (film: $m, genre: $g) isa in_genre;
    $g has name ""Action"";
};
fetch { ""actor"": $n };"
recommendations,463,Which director has the most diverse portfolio of movie genres directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 1","match $d isa person, has name $n; directed (director: $d, film: $m); in_genre (film: $m, genre: $g); reduce $num_genres = count($g) groupby $n; sort $num_genres desc; limit 1; fetch { ""director"": $n, ""num_genres"": $num_genres };"
recommendations,464,What are the top 5 movies with the shortest runtime?,"MATCH (m:Movie)
WHERE m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match $m isa movie, has title $t, has runtime $r; sort $r asc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,466,Which actors have played a role in movies with a budget over 200 million dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 200000000
RETURN a.name AS actor, m.title AS movie","match $a isa person, has name $an; acted_in (actor: $a, film: $m); $m has title $mt, has budget $b; $b > 200000000; fetch { ""actor"": $an, ""movie"": $mt };"
recommendations,468,List all users who have rated the same movie with different ratings.,"MATCH (u1:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User)
WHERE u1 <> u2 AND r1.rating <> r2.rating
RETURN u1.name AS User1, r1.rating AS User1Rating, 
       u2.name AS User2, r2.rating AS User2Rating,
       m.title AS Movie","match $r1 isa rated (user: $u1, film: $m), has rating $rating1; $r2 isa rated (user: $u2, film: $m), has rating $rating2; not { $u1 is $u2; }; not { $rating1 == $rating2; }; $u1 has name $n1; $u2 has name $n2; $m has title $t; fetch { ""User1"": $n1, ""User1Rating"": $rating1, ""User2"": $n2, ""User2Rating"": $rating2, ""Movie"": $t };"
recommendations,469,What are the top 3 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.year
ORDER BY m.year
LIMIT 3","match $m isa movie, has title $t, has year $y; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y };"
recommendations,470,Find all movies that have been acted in by an actor born before 1950.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born < date('1950-01-01')
RETURN m","match $a isa person, has born $b; $b < 1950-01-01; acted_in (actor: $a, film: $m); $m has title $t; fetch { ""title"": $t };"
recommendations,471,Which movies have a plot that includes the word 'love'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*love.*"";
fetch { ""title"": $t, ""plot"": $p };"
recommendations,472,List all movies that have been directed by a person who died before 2000.,"MATCH (m:Movie)<-[:DIRECTED]-(p:Person)
WHERE p.died < date('2000-01-01')
RETURN m.title, p.name, p.died","match $p isa person, has name $n, has died $d; $d < 2000-01-01; directed (director: $p, film: $m); $m has title $t; fetch { ""title"": $t, ""name"": $n, ""died"": $d };"
recommendations,474,Find all users who have rated movies from more than three different genres.,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN u","match
$u isa user, has name $n;
(user: $u, film: $m) isa rated;
(film: $m, genre: $g) isa in_genre;
$g has name $gn;
reduce $num_genres = count($gn) groupby $n;
sort $num_genres desc;
limit 10;
fetch { ""user"": $n };"
recommendations,475,Which actors have a biography mentioning 'Broadway'?,"MATCH (a:Actor)
WHERE a.bio CONTAINS 'Broadway'
RETURN a.name, a.bio","match
$a isa person, has bio $b, has name $n;
(actor: $a, film: $m) isa acted_in;
$b like "".*Broadway.*"";
fetch { ""name"": $n, ""bio"": $b };"
recommendations,476,List all movies with a revenue greater than 1 billion dollars.,"MATCH (m:Movie)
WHERE m.revenue > 1000000000
RETURN m.title, m.revenue","match $m isa movie, has title $t, has revenue $r; $r > 1000000000; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,478,Find all directors who have directed a movie in their country of birth.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn IN m.countries
RETURN DISTINCT d.name AS director, d.bornIn AS bornIn","match
$d isa person, has born_in $b, has name $n;
(director: $d, film: $m) isa directed;
$m has countries $c;
$b == $c;
fetch { ""director"": $n, ""bornIn"": $b };"
recommendations,479,Which movies have actors who have also directed a movie?,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)
WHERE exists{ (actor)-[:DIRECTED]->(:Movie) }
RETURN movie.title, actor.name","match $actor isa person, has name $an; acted_in (actor: $actor, film: $movie); directed (director: $actor); $movie has title $t; fetch { ""title"": $t, ""name"": $an };"
recommendations,480,List all movies that have an IMDb rating and were released in the year 2000.,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.year = 2000
RETURN m.title, m.imdbRating, m.year","match $m isa movie, has title $t, has imdb_rating $r, has year $y; $y == 2000; fetch { ""title"": $t, ""imdb_rating"": $r, ""year"": $y };"
recommendations,481,Find all movies that feature an actor born in Canada.,"MATCH (a:Actor {bornIn: 'Canada'})-[:ACTED_IN]->(m:Movie)
RETURN m","match $a isa person, has born_in ""Canada""; acted_in (actor: $a, film: $m); $m has title $t; fetch { ""title"": $t };"
recommendations,482,Which movies have been rated by users named 'John Smith'?,"MATCH (u:User {name: 'John Smith'})-[r:RATED]->(m:Movie)
RETURN m.title AS movie, r.rating AS rating","match $u isa user, has name ""John Smith""; $r isa rated (user: $u, film: $m), has rating $rating; $m has title $t; fetch { ""movie"": $t, ""rating"": $rating };"
recommendations,483,Which directors have directed both a comedy and a drama movie?,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Comedy'})
WHERE exists{ (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Drama'}) }
RETURN d.name AS director","match $d isa person, has name $n; directed (director: $d, film: $m1); in_genre (film: $m1, genre: $g1); $g1 has name ""Comedy""; directed (director: $d, film: $m2); in_genre (film: $m2, genre: $g2); $g2 has name ""Drama""; fetch { ""director"": $n };"
recommendations,485,Find all movies that have a movieId starting with '1' and have been rated by at least one user.,"MATCH (m:Movie)<-[:RATED]-(u:User)
WHERE m.movieId STARTS WITH '1'
RETURN m","match
$m isa movie, has movie_id $mid, has title $t;
$mid like ""1%"";
(user: $u, film: $m) isa rated;
fetch { ""title"": $t, ""movieId"": $mid };"
recommendations,486,Which actors have acted in movies that have a plot mentioning 'adventure'?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN a.name AS actor","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
$m has plot $p;
$p like "".*adventure.*"";
fetch { ""actor"": $n };"
recommendations,487,List all movies that have been released on Christmas Day.,"MATCH (m:Movie)
WHERE m.released ENDS WITH ""12-25""
RETURN m.title, m.released","match $m isa movie, has title $t, has released $r; $r like "".*12-25$""; fetch { ""title"": $t, ""released"": $r };"
recommendations,490,What are the top 3 movies with the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,491,Find all actors who have acted in a movie that has an IMDb rating of 9 or higher.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating >= 9
RETURN a.name AS actor, m.title AS movie, m.imdbRating AS rating","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has title $t, has imdb_rating $r; $r >= 9; fetch { ""actor"": $n, ""movie"": $t, ""rating"": $r };"
recommendations,492,Which movies have a plot that includes the word 'escape'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'escape'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*escape.*"";
fetch { ""title"": $t, ""plot"": $p };"
recommendations,493,List all genres associated with movies that have a runtime less than 80 minutes.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime < 80
RETURN DISTINCT g.name","match $m isa movie, has runtime $r; $r < 80; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
recommendations,494,Find the top 5 movies with the highest revenue that were released in the 1990s.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '199' AND m.revenue IS NOT NULL
RETURN m.title, m.released, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has revenue $rev; $rel like ""^199.*""; sort $rev desc; limit 5; fetch { ""title"": $t, ""released"": $rel, ""revenue"": $rev };"
recommendations,495,Which actors have worked in a movie with a director from the same country?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WHERE a.bornIn IS NOT NULL AND d.bornIn IS NOT NULL AND a.bornIn = d.bornIn
RETURN a.name AS actor, d.name AS director, a.bornIn AS country, m.title AS movie","match $a isa person, has name $an, has born_in $abc; acted_in (actor: $a, film: $m); directed (director: $d, film: $m); $d has name $dn, has born_in $dbc; $abc == $dbc; $m has title $t; fetch { ""actor"": $an, ""director"": $dn, ""country"": $abc, ""movie"": $t };"
recommendations,496,List all movies that have a director who has also acted in a movie.,"MATCH (d:Person)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title","match $d isa person; directed (director: $d, film: $m); acted_in (actor: $d); $m has title $t; fetch { ""title"": $t };"
recommendations,497,What are the top 3 movies with the lowest IMDb votes?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes
LIMIT 3","match $m isa movie, has title $t, has imdb_votes $v; sort $v asc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,499,List the top 5 oldest directors in the database.,"MATCH (d:Director)
WHERE d.born IS NOT NULL
RETURN d.name, d.born
ORDER BY d.born
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d); sort $b asc; limit 5; fetch { ""name"": $n, ""born"": $b };"
recommendations,500,Find all movies that have a plot mentioning 'hero'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'hero'
RETURN m","match $m isa movie, has title $t, has plot $p; $p contains ""hero""; fetch { ""title"": $t };"
recommendations,501,List all movies that have a language list including Japanese.,"MATCH (m:Movie)
WHERE 'Japanese' IN m.languages
RETURN m","match
$m isa movie, has languages $l, has title $t, has url $u, has runtime $rt, has revenue $rev, has imdb_rating $ir, has released $rel, has countries $c, has plot $p, has imdb_votes $iv, has imdb_id $iid, has year $y, has poster $po, has movie_id $mid, has tmdb_id $tid, has budget $b;
$l like "".*Japanese.*"";
fetch { ""title"": $t, ""url"": $u, ""runtime"": $rt, ""revenue"": $rev, ""imdb_rating"": $ir, ""released"": $rel, ""countries"": $c, ""languages"": $l, ""plot"": $p, ""imdb_votes"": $iv, ""imdb_id"": $iid, ""year"": $y, ""poster"": $po, ""movie_id"": $mid, ""tmdb_id"": $tid, ""budget"": $b };"
recommendations,502,Which directors have directed a movie that has been rated below 3.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating < 3.0
RETURN DISTINCT d.name AS director, m.title AS movie, r.rating AS rating","match $d isa person, has name $dn; directed (director: $d, film: $m); $r isa rated (film: $m), has rating $rating; $rating < 3.0; $m has title $t; fetch { ""director"": $dn, ""movie"": $t, ""rating"": $rating };"
recommendations,503,List all actors who have a poster URL that includes 'smile' in it.,"MATCH (a:Actor)
WHERE a.poster CONTAINS 'smile'
RETURN a.name, a.poster","match
$a isa person, has poster $p, has name $n;
(actor: $a, film: $m) isa acted_in;
$p like "".*smile.*"";
fetch { ""name"": $n, ""poster"": $p };"
recommendations,505,Find all directors who have directed a movie in a language other than English.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE NOT 'English' IN m.languages
RETURN DISTINCT d.name AS director","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
$m has languages $l;
not { $l like "".*English.*""; };
fetch { ""director"": $n };"
recommendations,507,Find all movies with an IMDb rating less than 5 that have been directed by a director born in the USA.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'USA'})
WHERE m.imdbRating < 5
RETURN m.title AS movie, m.imdbRating AS rating, d.name AS director","match $d isa person, has name $dn, has born_in ""USA""; directed (director: $d, film: $m); $m has title $t, has imdb_rating $r; $r < 5; fetch { ""movie"": $t, ""rating"": $r, ""director"": $dn };"
recommendations,508,Which movies have a plot that includes the word 'monster'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'monster'
RETURN m.title, m.plot","match
$m isa movie, has plot $p, has title $t;
$p like "".*monster.*"";
fetch { ""title"": $t, ""plot"": $p };"
recommendations,509,List all movies that have been acted in by an actor who has also directed a movie.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN m.title","match $p isa person; acted_in (actor: $p, film: $m); directed (director: $p); $m has title $t; fetch { ""title"": $t };"
recommendations,511,Find all actors who have acted in movies that have been released on New Year's Day.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released ENDS WITH ""01-01""
RETURN a.name AS actor, m.title AS movie, m.released AS releaseDate","match $a isa person, has name $an; acted_in (actor: $a, film: $m); $m has title $t, has released $r; $r like "".*01-01$""; fetch { ""actor"": $an, ""movie"": $t, ""releaseDate"": $r };"
recommendations,512,Which movies have been directed by directors who have also acted in movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS movie, d.name AS director","match $d isa person, has name $dn; directed (director: $d, film: $m); acted_in (actor: $d); $m has title $t; fetch { ""movie"": $t, ""director"": $dn };"
recommendations,513,List all movies that have a revenue greater than 100 million dollars and have been rated by more than 500 users.,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND m.imdbVotes > 500
RETURN m.title, m.revenue, m.imdbVotes","match
$m isa movie, has revenue $r, has title $t;
$r > 100000000;
rated (user: $u, film: $m);
reduce $count = count($u) groupby $m, $r, $t;
match $count > 500;
fetch { ""title"": $t, ""revenue"": $r, ""rating_count"": $count };"
recommendations,514,What are the top 5 movies by revenue?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,515,List the first 3 actors born in France.,"MATCH (a:Actor {bornIn: 'France'})
RETURN a.name
LIMIT 3","match $a isa person, has name $n, has born_in ""France""; acted_in (actor: $a); limit 3; fetch { ""name"": $n };"
recommendations,516,Which 5 movies have the highest imdbRating?,"MATCH (m:Movie)
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,517,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
recommendations,518,What are the top 5 longest movies by runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,519,List the first 3 directors born in the USA.,"MATCH (d:Director)
WHERE d.bornIn CONTAINS 'USA'
RETURN d.name, d.bornIn
LIMIT 3","match
$d isa person, has born_in $b, has name $n;
(director: $d, film: $m) isa directed;
$b like "".*USA.*"";
limit 3;
fetch { ""name"": $n, ""bornIn"": $b };"
recommendations,520,Which movies released after 2010 have a budget over 100 million? Limit to 5 movies.,"MATCH (m:Movie)
WHERE m.released > '2010' AND m.budget > 100000000
RETURN m.title, m.released, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has released $r, has budget $b; $r > ""2010""; $b > 100000000; sort $b desc; limit 5; fetch { ""title"": $t, ""released"": $r, ""budget"": $b };"
recommendations,521,What are the top 3 genres by number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
recommendations,522,List 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
acted_in (actor: $a, film: $m);
reduce $numMovies = count($m) groupby $a, $n;
match $numMovies > 10;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,523,Which 3 movies have been rated by the most users?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $m isa movie, has title $t; rated (film: $m, user: $u); reduce $numRatings = count($u) groupby $t; sort $numRatings desc; limit 3; fetch { ""title"": $t, ""numRatings"": $numRatings };"
recommendations,525,List the first 3 directors who have also acted in movies.,"MATCH (p:Person)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) } 
  AND exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n; directed (director: $p); acted_in (actor: $p); limit 3; fetch { ""name"": $n };"
recommendations,526,Which movies have a revenue to budget ratio greater than 2? Limit to 5 movies.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.revenue / m.budget > 2
RETURN m.title, m.revenue, m.budget, m.revenue / m.budget AS ratio
ORDER BY ratio DESC
LIMIT 5","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$bud > 0;
let $ratio = $rev / $bud;
$ratio > 2.0;
sort $ratio desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud, ""ratio"": $ratio };"
recommendations,527,What are the first 3 recent movies directed by directors born after 1970?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.born > date('1970-01-01')
RETURN m.title, m.released
ORDER BY m.released DESC
LIMIT 3","match $d isa person, has born $b; $b > 1970-01-01; directed (director: $d, film: $m); $m has title $t, has released $r; sort $r desc; limit 3; fetch { ""title"": $t, ""released"": $r };"
recommendations,528,List 5 movies that have both English and French as languages.,"MATCH (m:Movie)
WHERE 'English' IN m.languages AND 'French' IN m.languages
RETURN m.title
LIMIT 5","match
$m isa movie, has languages $l1, has languages $l2, has title $t;
$l1 like "".*English.*"";
$l2 like "".*French.*"";
limit 5;
fetch { ""title"": $t };"
recommendations,529,Which 3 users have the highest average movie rating?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated (user: $u), has rating $rating; reduce $avgRating = mean($rating) groupby $n; sort $avgRating desc; limit 3; fetch { ""user"": $n, ""avgRating"": $avgRating };"
recommendations,530,List the top 5 movies with the lowest imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v asc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,531,What are the first 3 movies directed by a person born in France?,"MATCH (p:Person {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match $p isa person, has born_in ""France""; directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,532,Which actors have a poster URL on IMDb? Limit to 5 actors.,"MATCH (a:Actor)
WHERE a.poster IS NOT NULL
RETURN a.name, a.poster
LIMIT 5","match $a isa person, has name $n, has poster $p; acted_in (actor: $a); limit 5; fetch { ""name"": $n, ""poster"": $p };"
recommendations,533,What are the first 3 movies with a plot containing the word 'friendship'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*friendship.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,534,Which 5 directors have directed the most movies with budgets over 50 million?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 50000000
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has budget $b; $b > 50000000; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""director"": $n, ""numMovies"": $numMovies };"
recommendations,535,List the first 3 actors who have acted in a movie released before 1950.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released < '1950'
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has released $r; $r < ""1950""; limit 3; fetch { ""name"": $n };"
recommendations,539,What are the first 3 movies where a director has also acted?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title
LIMIT 3","match $p isa person; directed (director: $p, film: $m); acted_in (actor: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,540,Which actors have directed a movie they acted in? Limit to 5 actors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(a)
RETURN a.name AS actor, m.title AS movie
LIMIT 5","match $a isa person, has name $n; acted_in (actor: $a, film: $m); directed (director: $a, film: $m); $m has title $t; limit 5; fetch { ""actor"": $n, ""movie"": $t };"
recommendations,541,List the top 5 highest-grossing movies of 2014.,"MATCH (m:Movie)
WHERE m.year = 2014 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has revenue $r; $y == 2014; sort $r desc; limit 5; fetch { ""movie"": $t, ""revenue"": $r };"
recommendations,542,What are the first 3 movies with an imdbRating greater than 8.5?,"MATCH (m:Movie)
WHERE m.imdbRating > 8.5
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has imdb_rating $r; $r > 8.5; sort $r desc; limit 3; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,544,List the first 3 movies with the highest budget to revenue ratio.,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS ratio
ORDER BY ratio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
recommendations,545,Which 5 movies have the most actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 5; fetch { ""movie"": $t, ""numActors"": $numActors };"
recommendations,546,List the top 5 directors by number of movies directed in the 1990s.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.year >= 1990 AND m.year < 2000
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has year $y; $y >= 1990; $y < 2000; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""director"": $n, ""numMovies"": $numMovies };"
recommendations,547,What are the first 3 movies with a runtime less than 90 minutes and an imdbRating over 7?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating > 7
RETURN m.title, m.runtime, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $rt, has imdb_rating $ir; $rt < 90; $ir > 7; sort $ir desc; limit 3; fetch { ""title"": $t, ""runtime"": $rt, ""imdb_rating"": $ir };"
recommendations,549,What are the first 3 movies with a poster URL from tmdb?,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL
RETURN m.title, m.poster
LIMIT 3","match
$m isa movie, has title $t, has poster $p;
limit 3;
fetch { ""title"": $t, ""poster"": $p };"
recommendations,550,Which 5 users have rated movies in the most diverse set of genres?,"MATCH (u:User)-[:RATED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH u, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN u.name AS user, genreCount AS distinctGenresRated","match $u isa user, has name $n; rated (user: $u, film: $m); in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $n; sort $genreCount desc; limit 5; fetch { ""user"": $n, ""distinctGenresRated"": $genreCount };"
recommendations,551,List the top 5 actors by number of different genres they've acted in.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN a.name AS actor, genreCount AS numberOfGenres","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $n; sort $genreCount desc; limit 5; fetch { ""actor"": $n, ""numberOfGenres"": $genreCount };"
recommendations,552,What are the first 3 most recently released movies with a revenue under 10 million?,"MATCH (m:Movie)
WHERE m.revenue < 10000000
RETURN m.title, m.released, m.revenue
ORDER BY m.released DESC
LIMIT 3","match $m isa movie, has title $t, has released $rel, has revenue $rev; $rev < 10000000; sort $rel desc; limit 3; fetch { ""title"": $t, ""released"": $rel, ""revenue"": $rev };"
recommendations,553,Which 5 movies have the highest average user rating? Limit to movies rated by at least 10 users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 10
RETURN m.title AS movie, avgRating
ORDER BY avgRating DESC
LIMIT 5","match
$m isa movie, has title $t;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avgRating = mean($rating), $numRatings = count($r) groupby $m, $t;
match $numRatings >= 10;
sort $avgRating desc;
limit 5;
fetch { ""movie"": $t, ""avgRating"": $avgRating };"
recommendations,554,List the first 3 directors who died after 2000.,"MATCH (d:Director)
WHERE d.died > date('2000-01-01')
RETURN d.name, d.died
ORDER BY d.died
LIMIT 3","match $d isa person, has name $n, has died $di; $di > 2000-01-01; directed (director: $d); sort $di asc; limit 3; fetch { ""name"": $n, ""died"": $di };"
recommendations,555,What are the top 5 movies that have the most votes on IMDb?,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,556,List the top 5 movies that have been rated the lowest by users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating
LIMIT 5
RETURN m.title AS movie, avgRating","match $m isa movie, has title $t; $r isa rated (film: $m), has rating $rating; reduce $avgRating = mean($rating) groupby $t; sort $avgRating asc; limit 5; fetch { ""movie"": $t, ""avgRating"": $avgRating };"
recommendations,557,Which 3 directors were born in the same country they directed their first movie?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.bornIn IS NOT NULL AND d.bornIn IN m.countries
WITH d, m
ORDER BY m.year
RETURN d.name AS director, d.bornIn AS bornCountry, m.title AS firstMovie
  LIMIT 3","with fun first_movie_year($d: person) -> integer:
  match 
    directed (director: $d, film: $m);
    $m has year $y;
  return min($y);
match
$d isa person, has born_in $b, has name $n;
directed (director: $d, film: $m);
$m has countries $c, has year $y, has title $t;
$b == $c;
let $first_year = first_movie_year($d);
$y == $first_year;
sort $y asc;
limit 3;
fetch { ""director"": $n, ""bornCountry"": $b, ""firstMovie"": $t };"
recommendations,560,List the first 3 actors who have a tmdbId but no imdbId.,"MATCH (a:Actor)
WHERE a.tmdbId IS NOT NULL AND a.imdbId IS NULL
RETURN a.name
LIMIT 3","match $a isa person, has name $n, has tmdb_id $t; acted_in (actor: $a); not { $a has imdb_id $i; }; limit 3; fetch { ""name"": $n };"
recommendations,562,List the first 3 movies where the main genre is 'Adventure'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title
LIMIT 3","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); $g has name ""Adventure""; limit 3; fetch { ""title"": $t };"
recommendations,563,What are the top 5 oldest movies in the database by release year?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m.title, m.year
ORDER BY m.year
LIMIT 5","match $m isa movie, has title $t, has year $y; sort $y asc; limit 5; fetch { ""title"": $t, ""year"": $y };"
recommendations,564,List the first 3 directors who have directed a movie without having a bio on their profile.,"MATCH (d:Director)-[:DIRECTED]->(:Movie)
WHERE d.bio IS NULL
RETURN d.name
LIMIT 3","match $d isa person, has name $n; directed (director: $d); not { $d has bio $b; }; limit 3; fetch { ""name"": $n };"
recommendations,565,Which 5 actors have the most roles listed as uncredited?,"MATCH (a:Actor)-[r:ACTED_IN]->(:Movie)
WHERE r.role CONTAINS 'uncredited'
RETURN a.name AS actor, count(r) AS uncreditedRoles
ORDER BY uncreditedRoles DESC
LIMIT 5","match $a isa person, has name $n; $r isa acted_in (actor: $a), has character_role $role; $role like "".*uncredited.*""; reduce $uncreditedRoles = count($r) groupby $a; sort $uncreditedRoles desc; limit 5; fetch { ""actor"": $a.name, ""uncreditedRoles"": $uncreditedRoles };"
recommendations,566,List the top 5 most reviewed movies on IMDb.,"MATCH (m:Movie)
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,567,What are the first 3 movies directed by a director born in Nebraska?,"MATCH (d:Director {bornIn: 'Nebraska, USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match $d isa person, has born_in ""Nebraska, USA""; directed (director: $d, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,568,Which 5 directors have directed the same movie?,"MATCH (d1:Director)-[:DIRECTED]->(m:Movie)<-[:DIRECTED]-(d2:Director)
WHERE d1 <> d2
RETURN d1.name AS director1, d2.name AS director2, m.title AS movie
LIMIT 5","match directed (director: $d1, film: $m); directed (director: $d2, film: $m); not { $d1 is $d2; }; $d1 has name $n1; $d2 has name $n2; $m has title $t; limit 5; fetch { ""director1"": $n1, ""director2"": $n2, ""movie"": $t };"
recommendations,569,List the first 3 actors who acted in a movie without having a born date listed.,"MATCH (a:Actor)-[:ACTED_IN]->(:Movie)
WHERE a.born IS NULL
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a); not { $a has born $b; }; limit 3; fetch { ""name"": $n };"
recommendations,571,List the first 3 users who rated a movie with a budget over 200 million.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.budget > 200000000
RETURN u.name AS user, m.title AS movie, r.rating AS rating
ORDER BY r.timestamp
LIMIT 3","match $u isa user, has name $n; $r isa rated (user: $u, film: $m), has rating $rating, has timestamp $ts; $m has title $t, has budget $b; $b > 200000000; sort $ts asc; limit 3; fetch { ""user"": $n, ""movie"": $t, ""rating"": $rating };"
recommendations,573,List the first 3 movies with a poster URL on tmdb but not on IMDb.,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL AND m.imdbId IS NULL
RETURN m.title, m.poster
LIMIT 3","match $m isa movie, has title $t, has poster $p; not { $m has imdb_id $i; }; limit 3; fetch { ""title"": $t, ""poster"": $p };"
recommendations,574,What are the top 5 movies with the most genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 5; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
recommendations,575,Which 5 movies have been directed by a person who also acted in them?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN m.title
LIMIT 5","match $p isa person; directed (director: $p, film: $m); acted_in (actor: $p, film: $m); $m has title $t; limit 5; fetch { ""title"": $t };"
recommendations,576,List the top 5 movies by number of actors born in the USA who acted in them.,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE a.bornIn = 'USA'
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); $a has born_in ""USA""; reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 5; fetch { ""movie"": $t, ""numActors"": $numActors };"
recommendations,578,Which 5 movies have the most diverse cast in terms of countries of origin?,"MATCH (m:Movie)<-[:ACTED_IN]-(p:Person)
WHERE p.bornIn IS NOT NULL
WITH m, count(DISTINCT p.bornIn) AS numCountries
ORDER BY numCountries DESC
LIMIT 5
RETURN m.title AS movie, numCountries AS distinctCountriesRepresented","match $m isa movie, has title $t; acted_in (film: $m, actor: $p); $p has born_in $b; reduce $numCountries = count($b) groupby $t; sort $numCountries desc; limit 5; fetch { ""movie"": $t, ""distinctCountriesRepresented"": $numCountries };"
recommendations,579,List the first 3 directors who have directed a movie with a runtime over 180 minutes.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 180
RETURN d.name AS director
ORDER BY director
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r > 180; sort $n asc; limit 3; fetch { ""director"": $n };"
recommendations,581,List the first 3 movies with an imdbId that starts with '07'.,"MATCH (m:Movie)
WHERE m.imdbId STARTS WITH '07'
RETURN m.title, m.imdbId
LIMIT 3","match $m isa movie, has title $t, has imdb_id $i; $i like ""^07.*""; limit 3; fetch { ""title"": $t, ""imdb_id"": $i };"
recommendations,582,Which 5 directors have the most distinct movies directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(DISTINCT m) AS num_movies
ORDER BY num_movies DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $num_movies = count($m) groupby $n; sort $num_movies desc; limit 5; fetch { ""director"": $n, ""num_movies"": $num_movies };"
recommendations,583,List the top 5 actors by number of movies they've acted in with a budget over 100 million.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.budget > 100000000
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has budget $b; $b > 100000000; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,586,List the first 3 movies released in the year 2000 or later with a rating under 5.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.imdbRating < 5
RETURN m.title, m.year, m.imdbRating
ORDER BY m.year
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_rating $r; $y >= 2000; $r < 5; sort $y asc; limit 3; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,587,What are the top 5 movies with the highest revenue in the Adventure genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Adventure'})
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; in_genre (film: $m, genre: $g); $g has name ""Adventure""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,588,List the first 3 actors who have died after 2000.,"MATCH (a:Actor)
WHERE a.died IS NOT NULL AND a.died > date('2000-01-01')
RETURN a.name, a.died
ORDER BY a.died
LIMIT 3","match $a isa person, has name $n, has died $d; acted_in (actor: $a); $d > 2000-01-01; sort $d asc; limit 3; fetch { ""name"": $n, ""died"": $d };"
recommendations,589,Which 5 directors have directed movies with the highest average imdbRating?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH d, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN d.name AS director, avgRating","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; reduce $avgRating = mean($r) groupby $n; sort $avgRating desc; limit 5; fetch { ""director"": $n, ""avgRating"": $avgRating };"
recommendations,592,List the first 3 movies where the main actor is also the director.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match $p isa person; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,594,List the top 5 actors by number of movies they've acted in that have been released on Christmas Day.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.released ENDS WITH ""12-25""
WITH a, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN a.name AS actor, numMovies","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has released $r; $r like "".*12-25$""; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,595,What are the first 3 movies with a plot containing the word 'evil'?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'evil'
RETURN m.title
LIMIT 3","match
$m isa movie, has plot $p, has title $t;
$p like "".*evil.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,596,Which 5 directors have the longest cumulative runtime of all movies they've directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, sum(m.runtime) AS totalRuntime
RETURN d.name AS director, totalRuntime
ORDER BY totalRuntime DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; reduce $totalRuntime = sum($r) groupby $n; sort $totalRuntime desc; limit 5; fetch { ""director"": $n, ""totalRuntime"": $totalRuntime };"
recommendations,597,Which movies have a runtime greater than 120 minutes and were released after 2010?,"MATCH (m:Movie)
WHERE m.runtime > 120 AND m.released > '2010-01-01'
RETURN m.title, m.released, m.runtime","match $m isa movie, has title $t, has released $rel, has runtime $rt; $rt > 120; $rel > ""2010-01-01""; fetch { ""title"": $t, ""released"": $rel, ""runtime"": $rt };"
recommendations,598,List all movies directed by a person born in France.,"MATCH (p:Person {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title AS movie, p.name AS director","match $p isa person, has name $n, has born_in ""France""; directed (director: $p, film: $m); $m has title $t; fetch { ""movie"": $t, ""director"": $n };"
recommendations,599,What are the top 5 highest-grossing movies of the 1990s?,"MATCH (m:Movie)
WHERE m.year >= 1990 AND m.year < 2000 AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has title $t, has year $y, has revenue $r; $y >= 1990; $y < 2000; sort $r desc; limit 5; fetch { ""movie"": $t, ""revenue"": $r };"
recommendations,600,Find all actors who have acted in more than one movie with an IMDb rating over 7.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating > 7
WITH a, count(m) AS numMovies
WHERE numMovies > 1
RETURN a.name AS actor, numMovies","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,601,Which directors have directed at least three movies with budgets over 100 million dollars?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 100000000
WITH d, count(m) AS num_high_budget_movies
WHERE num_high_budget_movies >= 3
RETURN d.name AS director, num_high_budget_movies","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
$m has budget $b;
$b > 100000000;
reduce $num_high_budget_movies = count($m) groupby $n;
sort $num_high_budget_movies desc;
limit 10;
fetch { ""director"": $n, ""num_high_budget_movies"": $num_high_budget_movies };"
recommendations,602,List the top 3 movies with the most IMDb votes released before 2000.,"MATCH (m:Movie)
WHERE m.year < 2000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_votes $v; $y < 2000; sort $v desc; limit 3; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,603,What are the genres of movies that have generated over 500 million dollars in revenue?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.revenue > 500000000
RETURN DISTINCT g.name","match $m isa movie, has revenue $r; $r > 500000000; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
recommendations,605,List all the directors who have both directed and acted in the same movie.,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(p)
RETURN p.name AS director, m.title AS movie","match $p isa person, has name $n; directed (director: $p, film: $m); acted_in (actor: $p, film: $m); $m has title $t; fetch { ""director"": $n, ""movie"": $t };"
recommendations,606,Find movies where the plot includes the word 'love' and were released on Valentine's Day.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'love' AND m.released ENDS WITH '02-14'
RETURN m.title, m.released, m.plot","match $m isa movie, has title $t, has released $r, has plot $p; $p contains ""love""; $r like "".*02-14$""; fetch { ""title"": $t, ""released"": $r, ""plot"": $p };"
recommendations,607,Which movies have a poster URL that contains 'face' and an IMDb rating above 8?,"MATCH (m:Movie)
WHERE m.poster CONTAINS 'face' AND m.imdbRating > 8
RETURN m.title, m.poster, m.imdbRating","match
$m isa movie, has poster $p, has title $t, has imdb_rating $r;
$p like "".*face.*"";
$r > 8.0;
fetch { ""title"": $t, ""poster"": $p, ""imdbRating"": $r };"
recommendations,608,List all genres associated with movies that have a budget less than 5 million dollars.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget < 5000000
RETURN DISTINCT g.name","match $m isa movie, has budget $b; $b < 5000000; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
recommendations,609,What are the top 5 movies by revenue that contain the word 'war' in their title?,"MATCH (m:Movie)
WHERE toLower(m.title) CONTAINS 'war'
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; $t like ""(?i).*war.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,610,Identify all actors who have played roles in movies directed by directors born in Nebraska.,"MATCH (actor:Actor)-[:ACTED_IN]->(movie:Movie)<-[:DIRECTED]-(director:Director)
WHERE director.bornIn = 'Nebraska'
RETURN actor.name AS actor, collect(movie.title) AS movies, collect(director.name) AS directors","match $actor isa person, has name $an; acted_in (actor: $actor, film: $movie); directed (director: $director, film: $movie); $director has born_in ""Nebraska"", has name $dn; $movie has title $t; fetch { ""actor"": $an, ""movie"": $t, ""director"": $dn };"
recommendations,611,Which movies have been rated exactly 5 stars by at least one user?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.rating = 5.0
RETURN m.title, m.year","match $m isa movie, has title $t, has year $y; $r isa rated (film: $m), has rating $rating; $rating == 5.0; fetch { ""title"": $t, ""year"": $y };"
recommendations,613,What are the movies with a budget over 200 million dollars and a revenue under 500 million dollars?,"MATCH (m:Movie)
WHERE m.budget > 200000000 AND m.revenue < 500000000
RETURN m.title, m.budget, m.revenue","match $m isa movie, has title $t, has budget $b, has revenue $r; $b > 200000000; $r < 500000000; fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
recommendations,614,Identify directors who have never directed a movie rated under 6 on IMDb.,"MATCH (d:Director)
WHERE NOT exists {
  (d)-[:DIRECTED]->(m:Movie)
  WHERE m.imdbRating < 6
}
RETURN d.name AS director","match $d isa person, has name $n; directed (director: $d); not { directed (director: $d, film: $m); $m has imdb_rating $r; $r < 6; }; fetch { ""director"": $n };"
recommendations,616,Find the top 3 movies with the shortest runtime and a revenue over 100 million dollars.,"MATCH (m:Movie)
WHERE m.revenue > 100000000
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 3","match $m isa movie, has title $t, has runtime $rt, has revenue $r; $r > 100000000; sort $rt asc; limit 3; fetch { ""title"": $t, ""runtime"": $rt };"
recommendations,617,What are the top 5 movies with the lowest IMDb ratings but highest revenues?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.imdbRating, m.revenue
ORDER BY m.imdbRating ASC, m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $ir, has revenue $r; sort $ir asc, $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $ir, ""revenue"": $r };"
recommendations,618,Identify movies that have been released in both English and French.,"MATCH (m:Movie)
WHERE 'en' IN m.languages AND 'fr' IN m.languages
RETURN m.title","match
$m isa movie, has languages $l1, has languages $l2, has title $t;
$l1 == ""en"";
$l2 == ""fr"";
fetch { ""title"": $t };"
recommendations,619,Which directors have the most movies with an IMDb rating over 8?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8
WITH d, count(m) AS numHighRatedMovies
ORDER BY numHighRatedMovies DESC
RETURN d.name AS director, numHighRatedMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r; $r > 8; reduce $numHighRatedMovies = count($m) groupby $n; sort $numHighRatedMovies desc; fetch { ""director"": $n, ""numHighRatedMovies"": $numHighRatedMovies };"
recommendations,620,List all users who have rated more than 50 movies.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS num_ratings
WHERE num_ratings > 50
RETURN u.name AS user, num_ratings","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $n;
sort $numRatings desc;
limit 5;
fetch { ""name"": $n, ""numRatings"": $numRatings };"
recommendations,621,What are the top 3 most popular movies among users named 'John'?,"MATCH (u:User {name: 'John'})-[r:RATED]->(m:Movie)
WITH m, avg(r.rating) AS avgRating, count(r) AS numRatings
ORDER BY avgRating DESC, numRatings DESC
RETURN m.title AS movie, avgRating, numRatings
LIMIT 3","match $u isa user, has name ""John""; $r isa rated (user: $u, film: $m), has rating $rating; $m has title $t; reduce $avgRating = mean($rating), $numRatings = count($r) groupby $t; sort $avgRating desc, $numRatings desc; limit 3; fetch { ""movie"": $t, ""avgRating"": $avgRating, ""numRatings"": $numRatings };"
recommendations,622,"Identify movies with more than 10,000 IMDb votes and a runtime under 90 minutes.","MATCH (m:Movie)
WHERE m.imdbVotes > 10000 AND m.runtime < 90
RETURN m.title, m.imdbVotes, m.runtime","match $m isa movie, has title $t, has imdb_votes $v, has runtime $r; $v > 10000; $r < 90; fetch { ""title"": $t, ""imdb_votes"": $v, ""runtime"": $r };"
recommendations,623,Which actors have acted in movies that grossed over 1 billion dollars?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 1000000000
RETURN a.name AS actor, m.title AS movie, m.revenue AS revenue","match $a isa person, has name $an; acted_in (actor: $a, film: $m); $m has title $t, has revenue $r; $r > 1000000000; fetch { ""actor"": $an, ""movie"": $t, ""revenue"": $r };"
recommendations,625,What are the movies that have a plot containing the word 'zombie' with an IMDb rating over 7?,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'zombie' AND m.imdbRating > 7
RETURN m.title, m.imdbRating, m.plot","match
$m isa movie, has plot $p, has title $t, has imdb_rating $r;
$p like "".*zombie.*"";
$r > 7.0;
fetch { ""title"": $t, ""imdbRating"": $r, ""plot"": $p };"
recommendations,627,Which movies have actors with a bio that includes 'Wikipedia' and a revenue over 300 million dollars?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE a.bio CONTAINS 'Wikipedia' AND m.revenue > 300000000
RETURN m.title, m.revenue, a.name, a.bio","match
$m isa movie, has title $t, has revenue $rev;
(actor: $a, film: $m) isa acted_in;
$a has bio $b, has name $n;
$b like "".*Wikipedia.*"";
$rev > 300000000;
fetch { ""title"": $t, ""revenue"": $rev, ""name"": $n, ""bio"": $b };"
recommendations,628,List the movies where the plot mentions 'friendship' and the budget was under 20 million dollars.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'friendship' AND m.budget < 20000000
RETURN m.title, m.plot, m.budget","match
$m isa movie, has plot $p, has title $t, has budget $b;
$p like "".*friendship.*"";
$b < 20000000;
fetch { ""title"": $t, ""plot"": $p, ""budget"": $b };"
recommendations,629,What are the top 5 highest-rated movies by users from the USA?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE u.name CONTAINS 'USA'
WITH m, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN m.title AS movie, avgRating","match
$m isa movie, has title $t;
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
$n like "".*USA.*"";
reduce $avg = mean($rating) groupby $t;
sort $avg desc;
limit 5;
fetch { ""movie"": $t, ""avgRating"": $avg };"
recommendations,630,Identify movies released in 'December' that have a genre of 'Horror'.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Horror' AND m.released STARTS WITH 'December'
RETURN m.title, m.released","match
$m isa movie, has title $t, has released $rel;
(film: $m, genre: $g) isa in_genre;
$g has name ""Horror"";
$rel like ""December%"";
fetch { ""title"": $t, ""released"": $rel };"
recommendations,632,List all movies with a title that starts with 'The' and have a poster URL ending with 'jpg'.,"MATCH (m:Movie)
WHERE m.title STARTS WITH 'The' AND m.poster ENDS WITH 'jpg'
RETURN m.title, m.poster","match $m isa movie, has title $t, has poster $p; $t like ""^The.*""; $p like "".*jpg$""; fetch { ""title"": $t, ""poster"": $p };"
recommendations,633,What are the genres associated with movies that have an IMDb rating exactly 6.5?,"MATCH (m:Movie {imdbRating: 6.5})-[:IN_GENRE]->(g:Genre)
RETURN DISTINCT g.name","match $m isa movie, has imdb_rating 6.5; in_genre (film: $m, genre: $g); $g has name $n; fetch { ""genre"": $n };"
recommendations,634,Identify all movies that have been directed by actors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, p.name AS person","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; fetch { ""movie"": $t, ""person"": $n };"
recommendations,635,Which movies have a director who was born after 1960 and have generated over 100 million in revenue?,"MATCH (m:Movie)
WHERE m.revenue > 100000000 AND exists {
  (d:Director)-[:DIRECTED]->(m)
  WHERE d.born > date('1960-01-01')  
}
RETURN m.title, m.revenue, m.year","match $m isa movie, has title $t, has revenue $r, has year $y; $r > 100000000; directed (director: $d, film: $m); $d has born $b; $b > 1960-01-01; fetch { ""title"": $t, ""revenue"": $r, ""year"": $y };"
recommendations,636,List the top 3 movies with the highest budgets that were released in the 2000s.,"MATCH (m:Movie)
WHERE m.year >= 2000 AND m.year < 2010
RETURN m.title AS movie, m.budget AS budget
ORDER BY m.budget DESC
LIMIT 3","match $m isa movie, has title $t, has budget $b, has year $y; $y >= 2000; $y < 2010; sort $b desc; limit 3; fetch { ""movie"": $t, ""budget"": $b };"
recommendations,637,What are the top 5 movies with the most revenue that are in the 'Sci-Fi' genre?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre {name: 'Sci-Fi'})
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; in_genre (film: $m, genre: $g); $g has name ""Sci-Fi""; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,639,Which directors have directed movies with a plot mentioning 'evil'?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.plot CONTAINS 'evil'
RETURN DISTINCT d.name AS director","match $d isa person, has name $n; directed (director: $d, film: $m); $m has plot $p; $p contains ""evil""; fetch { ""director"": $n };"
recommendations,640,List all actors who have acted in movies with at least two different directors.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(d:Director)
WITH a, count(DISTINCT d) AS numDirectors
WHERE numDirectors >= 2
RETURN a.name AS actor, numDirectors","match
$a isa person, has name $n;
$d isa person;
acted_in (actor: $a, film: $m);
directed (director: $d, film: $m);
select $a, $d;
distinct;
reduce $numDirectors = count($d) groupby $a;
match $numDirectors >= 2;
fetch { ""actor"": $a.name, ""numDirectors"": $numDirectors };"
recommendations,641,What are the top 3 movies with a revenue of exactly 50 million dollars?,"MATCH (m:Movie)
WHERE m.revenue = 50000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie, has title $t, has revenue $r; $r == 50000000; sort $r desc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,642,Identify movies that have been rated 10 times or more with a rating above 8.,"MATCH (m:Movie)
WHERE m.imdbRating > 8
  AND exists {
    MATCH (m)<-[r:RATED]-()
    WITH m, count(r) AS numRatings
    WHERE numRatings >= 10
  }
RETURN m","match
$m isa movie, has imdb_rating $ir;
$ir > 8;
$r isa rated (film: $m);
reduce $numRatings = count($r) groupby $m, $ir;
match $numRatings >= 10;
fetch { ""movie"": $m };"
recommendations,643,Which movies have actors who were born in Canada and have acted in a thriller genre?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Thriller'})
MATCH (a:Actor {bornIn: 'Canada'})-[:ACTED_IN]->(m)
RETURN m.title AS movie, collect(a.name) AS actors","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); $g has name ""Thriller""; acted_in (actor: $a, film: $m); $a has born_in ""Canada"", has name $an; fetch { ""movie"": $t, ""actor"": $an };"
recommendations,644,What are the top 5 movies with the highest imdbRating?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,645,Which 3 actors have acted in the most number of movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
RETURN a.name AS actor, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""actor"": $n, ""movieCount"": $movieCount };"
recommendations,646,List the top 5 directors by the number of movies they have directed.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
RETURN d.name AS director, count(m) AS numberOfMovies
ORDER BY numberOfMovies DESC
LIMIT 5","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $numberOfMovies = count($m) groupby $n; sort $numberOfMovies desc; limit 5; fetch { ""director"": $n, ""numberOfMovies"": $numberOfMovies };"
recommendations,647,What are the top 3 highest-grossing movies of all time?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 3","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 3; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,648,Which 3 movies have the longest runtime?,"MATCH (m:Movie)
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 3","match $m isa movie, has title $t, has runtime $r; sort $r desc; limit 3; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,649,List the top 5 movies with the largest budgets released before 2000.,"MATCH (m:Movie)
WHERE m.year < 2000 AND m.budget IS NOT NULL
RETURN m.title, m.budget, m.year
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b, has year $y; $y < 2000; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b, ""year"": $y };"
recommendations,650,Which 3 genres contain the most movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
recommendations,652,Which 3 users have rated the most number of movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
RETURN u.name AS user, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
recommendations,653,List the top 5 movies with the highest number of imdbVotes.,"MATCH (m:Movie)
WHERE m.imdbVotes IS NOT NULL
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,654,Which 3 actors were born in France and acted in more than one movie?,"MATCH (a:Actor {bornIn: 'France'})-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 1
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,655,What are the top 5 movies released in the 1990s by revenue?,"MATCH (m:Movie)
WHERE m.released STARTS WITH '199' AND m.revenue IS NOT NULL
RETURN m.title AS movie, m.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has revenue $r; $rel like ""^199.*""; sort $r desc; limit 5; fetch { ""movie"": $t, ""revenue"": $r };"
recommendations,656,Which 3 directors have directed movies with an imdbRating greater than 8.0?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.imdbRating > 8.0
RETURN d.name AS director, collect(m.title) AS movies
ORDER BY size(movies) DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has imdb_rating $r, has title $t; $r > 8.0; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 3; fetch { ""director"": $n, ""numMovies"": $numMovies };"
recommendations,658,Which 3 actors have acted in movies and also directed movies?,"MATCH (p:Person)
WHERE exists{ (p)-[:ACTED_IN]->(:Movie) } 
  AND exists{ (p)-[:DIRECTED]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n; acted_in (actor: $p); directed (director: $p); limit 3; fetch { ""name"": $n };"
recommendations,659,What are the top 5 oldest movies in the database by release year?,"MATCH (m:Movie)
WHERE m.year IS NOT NULL
RETURN m.title, m.year
ORDER BY m.year
LIMIT 5","match $m isa movie, has title $t, has year $y; sort $y asc; limit 5; fetch { ""title"": $t, ""year"": $y };"
recommendations,660,Which 3 genres are most common among movies with a budget over 100 million USD?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.budget > 100000000
WITH g, count(*) AS count
RETURN g.name AS genre, count
ORDER BY count DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has budget $b; $b > 100000000; reduce $count = count($m) groupby $n; sort $count desc; limit 3; fetch { ""genre"": $n, ""count"": $count };"
recommendations,661,List the top 5 movies with the smallest budgets that have an imdbRating over 7.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0
RETURN m.title, m.budget
ORDER BY m.budget
LIMIT 5","match $m isa movie, has title $t, has budget $b, has imdb_rating $r; $r > 7.0; sort $b asc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,662,Which 3 users have rated movies released before the year 2000?,"MATCH (u:User)-[:RATED]->(m:Movie)
WHERE m.year < 2000
RETURN u.name AS user
LIMIT 3","match $u isa user, has name $n; rated (user: $u, film: $m); $m has year $y; $y < 2000; limit 3; fetch { ""user"": $n };"
recommendations,663,What are the top 5 most recent movies in the database and their genres?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN m.title AS movie, m.year AS year, collect(g.name) AS genres
ORDER BY m.year DESC
LIMIT 5","match $m isa movie, has title $t, has year $y; in_genre (film: $m, genre: $g); $g has name $gn; sort $y desc; limit 5; fetch { ""movie"": $t, ""year"": $y, ""genre"": $gn };"
recommendations,664,Which 3 directors died after 2000 and directed more than two movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE d.died > date('2000-01-01')
WITH d, count(m) AS num_movies
WHERE num_movies > 2
RETURN d.name AS director, d.died AS died, num_movies
ORDER BY num_movies DESC
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
reduce $num_movies = count($m) groupby $n;
sort $num_movies desc;
limit 3;
fetch { ""director"": $n, ""num_movies"": $num_movies };"
recommendations,665,List the top 5 movies with a plot containing the word 'adventure'.,"MATCH (m:Movie)
WHERE toLower(m.plot) CONTAINS 'adventure'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; $p like ""(?i).*adventure.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""plot"": $p };"
recommendations,666,Which 3 actors have the highest average imdbRating for movies they acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating
RETURN a.name, avgRating
ORDER BY avgRating DESC
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_rating $r; reduce $avgRating = mean($r) groupby $n; sort $avgRating desc; limit 3; fetch { ""name"": $n, ""avgRating"": $avgRating };"
recommendations,667,What are the top 5 movies with runtime less than 90 minutes and imdbRating above 8.0?,"MATCH (m:Movie)
WHERE m.runtime < 90 AND m.imdbRating > 8.0
RETURN m.title, m.imdbRating, m.runtime
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r, has runtime $rt; $rt < 90; $r > 8.0; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r, ""runtime"": $rt };"
recommendations,668,Which 3 genres have the fewest movies associated with them in the database?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
ORDER BY movieCount
LIMIT 3
RETURN g.name AS genre, movieCount","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount asc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
recommendations,669,List the top 5 movies that have been rated by the highest number of different users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
RETURN m.title AS movie, count(DISTINCT u) AS numRaters
ORDER BY numRaters DESC
LIMIT 5","match $m isa movie, has title $t; rated (film: $m, user: $u); reduce $numRaters = count($u) groupby $t; sort $numRaters desc; limit 5; fetch { ""movie"": $t, ""numRaters"": $numRaters };"
recommendations,670,Which 3 actors have a poster listed and acted in at least two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.poster IS NOT NULL
WITH a, count(m) AS numMovies
WHERE numMovies >= 2
RETURN a.name, a.poster
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,671,What are the top 5 movies directed by directors born in the USA?,"MATCH (d:Director {bornIn: 'USA'})-[:DIRECTED]->(m:Movie)
RETURN m.title, m.year, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has born_in ""USA""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""title"": $t, ""year"": $y, ""imdb_rating"": $r };"
recommendations,672,Which 3 movies have the most diverse set of genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(distinct g) as genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN m.title as movie, genreCount as numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 3; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
recommendations,673,List the top 5 movies that have generated revenue more than 500 million USD.,"MATCH (m:Movie)
WHERE m.revenue > 500000000
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; $r > 500000000; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,674,Which 3 users have the highest average rating given to movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
ORDER BY avgRating DESC
LIMIT 3
RETURN u.name AS user, avgRating","match $u isa user, has name $n; $r isa rated (user: $u), has rating $rating; reduce $avgRating = mean($rating) groupby $n; sort $avgRating desc; limit 3; fetch { ""user"": $n, ""avgRating"": $avgRating };"
recommendations,675,What are the top 5 movies with the most actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH m, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 5
RETURN m.title AS movie, numActors","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 5; fetch { ""movie"": $t, ""numActors"": $numActors };"
recommendations,676,Which 3 directors have the longest total runtime for all their directed movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, sum(m.runtime) AS totalRuntime
RETURN d.name AS director, totalRuntime
ORDER BY totalRuntime DESC
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; reduce $totalRuntime = sum($r) groupby $n; sort $totalRuntime desc; limit 3; fetch { ""director"": $n, ""totalRuntime"": $totalRuntime };"
recommendations,677,List the top 5 movies that were released in languages other than English and have an imdbRating above 7.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 7.0 AND NOT 'English' IN m.languages
RETURN m.title, m.imdbRating, m.languages
ORDER BY m.imdbRating DESC
LIMIT 5","match
$m isa movie, has imdb_rating $r, has title $t, has languages $l;
$r > 7.0;
not { $l like "".*English.*""; };
sort $r desc;
limit 5;
fetch { ""title"": $t, ""imdbRating"": $r, ""languages"": $l };"
recommendations,678,Which 3 actors are born on or before 1900 and have acted in at least one movie?,"MATCH (a:Actor)
WHERE a.born <= date('1900-01-01') AND exists{ (a)-[:ACTED_IN]->(:Movie) }
RETURN a.name, a.born
LIMIT 3","match $a isa person, has name $n, has born $b; acted_in (actor: $a); $b <= 1900-01-01; limit 3; fetch { ""name"": $n, ""born"": $b };"
recommendations,679,What are the top 5 movies with the most budget and were released after 2010?,"MATCH (m:Movie)
WHERE m.released >= '2010'
RETURN m.title, m.budget
ORDER BY m.budget DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b, has released $r; $r >= ""2010""; sort $b desc; limit 5; fetch { ""title"": $t, ""budget"": $b };"
recommendations,680,Which 3 genres have movies with an average imdbRating above 7.5?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g.name AS genre, avg(m.imdbRating) AS avgRating
WHERE avgRating > 7.5
RETURN genre, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
$m has imdb_rating $r;
reduce $avgRating = mean($r) groupby $n;
sort $avgRating desc;
limit 3;
fetch { ""genre"": $n, ""avgRating"": $avgRating };"
recommendations,682,Which 3 directors have directed movies in more than three different genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
(film: $m, genre: $g) isa in_genre;
$g has name $gn;
reduce $num_genres = count($gn) groupby $n;
sort $num_genres desc;
limit 3;
fetch { ""director"": $n, ""num_genres"": $num_genres };"
recommendations,684,Which 3 actors have the lowest average imdbRating for movies they acted in and acted in more than three movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH a, avg(m.imdbRating) AS avgRating, count(m) AS numMovies
WHERE numMovies > 3
RETURN a.name AS actor, avgRating, numMovies
ORDER BY avgRating
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,685,List the top 5 movies with an imdbRating below 5.0 and a budget exceeding 50 million USD.,"MATCH (m:Movie)
WHERE m.imdbRating < 5.0 AND m.budget > 50000000
RETURN m.title, m.imdbRating, m.budget
ORDER BY m.imdbRating
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r, has budget $b; $r < 5.0; $b > 50000000; sort $r asc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r, ""budget"": $b };"
recommendations,686,Which 3 users have rated the same movie with different ratings?,"MATCH (u1:User)-[r1:RATED]->(m:Movie)<-[r2:RATED]-(u2:User), 
       (m)<-[r3:RATED]-(u3:User)
WHERE u1 <> u2 AND u1 <> u3 AND u2 <> u3
  AND r1.rating <> r2.rating
  AND r1.rating <> r3.rating
  AND r2.rating <> r3.rating
RETURN u1.name AS User1, r1.rating AS User1Rating,
       u2.name AS User2, r2.rating AS User2Rating,  
       u3.name AS User3, r3.rating AS User3Rating,
       m.title AS Movie
LIMIT 1","match $r1 isa rated (user: $u1, film: $m), has rating $rating1; $r2 isa rated (user: $u2, film: $m), has rating $rating2; $r3 isa rated (user: $u3, film: $m), has rating $rating3; not { $u1 is $u2; }; not { $u1 is $u3; }; not { $u2 is $u3; }; not { $rating1 == $rating2; }; not { $rating1 == $rating3; }; not { $rating2 == $rating3; }; $u1 has name $n1; $u2 has name $n2; $u3 has name $n3; $m has title $t; limit 1; fetch { ""User1"": $n1, ""User1Rating"": $rating1, ""User2"": $n2, ""User2Rating"": $rating2, ""User3"": $n3, ""User3Rating"": $rating3, ""Movie"": $t };"
recommendations,687,What are the top 5 movies with the most genres associated with them?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 5; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
recommendations,688,Which 3 directors have the most distinct actors worked with across all movies directed?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)<-[:ACTED_IN]-(a:Actor)
WITH d, count(distinct a) AS numActors
ORDER BY numActors DESC
LIMIT 3
RETURN d.name AS director, numActors","match $d isa person, has name $n; directed (director: $d, film: $m); acted_in (actor: $a, film: $m); reduce $numActors = count($a) groupby $n; sort $numActors desc; limit 3; fetch { ""director"": $n, ""numActors"": $numActors };"
recommendations,689,List the top 5 movies where actors also served as directors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title AS movie, collect(p.name) AS actor_directors
ORDER BY size(collect(p.name)) DESC
LIMIT 5","match $p isa person, has name $n; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 5; fetch { ""movie"": $t, ""actor_director"": $n };"
recommendations,690,Which 3 movies have the highest revenue to budget ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title AS movie, toFloat(m.revenue) / m.budget AS revenueToBudgetRatio
ORDER BY revenueToBudgetRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$bud > 0;
let $ratio = $rev / $bud;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""revenueToBudgetRatio"": $ratio };"
recommendations,691,What are the top 5 movies by revenue that were released in languages other than English?,"MATCH (m:Movie)
WHERE NOT 'English' IN m.languages
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match
$m isa movie, has revenue $rev, has title $t, has languages $l;
not { $l like "".*English.*""; };
sort $rev desc;
limit 5;
fetch { ""title"": $t, ""revenue"": $rev };"
recommendations,692,Which 3 actors have the most distinct genres of movies they've acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH a, count(distinct g) AS genreCount
ORDER BY genreCount DESC
LIMIT 3
RETURN a.name AS actor, genreCount","match $a isa person, has name $n; acted_in (actor: $a, film: $m); in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $n; sort $genreCount desc; limit 3; fetch { ""actor"": $n, ""genreCount"": $genreCount };"
recommendations,693,List the top 5 oldest directors based on their birth year who have directed at least one movie.,"MATCH (d:Director)-[:DIRECTED]->(:Movie)
WHERE d.born IS NOT NULL
RETURN d.name AS director, d.born AS birthDate
ORDER BY d.born
LIMIT 5","match $d isa person, has name $n, has born $b; directed (director: $d); sort $b asc; limit 5; fetch { ""director"": $n, ""birthDate"": $b };"
recommendations,694,Which 3 genres are most common in movies with a runtime over 120 minutes?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.runtime > 120
RETURN g.name AS genre, count(*) AS count
ORDER BY count DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has runtime $r; $r > 120; reduce $count = count($m) groupby $n; sort $count desc; limit 3; fetch { ""genre"": $n, ""count"": $count };"
recommendations,696,Which 3 actors have died and acted in more than two movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.died IS NOT NULL
WITH a, count(m) AS movieCount
WHERE movieCount > 2
RETURN a.name, a.died, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$a isa person, has name $n, has died $d;
(actor: $a, film: $m) isa acted_in;
reduce $movieCount = count($m) groupby $n, $d;
sort $movieCount desc;
limit 3;
fetch { ""name"": $n, ""died"": $d, ""movieCount"": $movieCount };"
recommendations,697,List the top 5 movies with the most distinct directors involved.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
RETURN m.title AS movie, count(distinct d) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 5","match $m isa movie, has title $t; directed (director: $d, film: $m); reduce $numDirectors = count($d) groupby $t; sort $numDirectors desc; limit 5; fetch { ""movie"": $t, ""numDirectors"": $numDirectors };"
recommendations,698,Which 3 movies released in the last 5 years of the database have the highest imdbVotes?,"MATCH (m:Movie)
WHERE m.year >= 2012 AND m.year <= 2016 AND m.imdbVotes IS NOT NULL
RETURN m.title, m.year, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 3","match $m isa movie, has title $t, has year $y, has imdb_votes $v; $y >= 2012; $y <= 2016; sort $v desc; limit 3; fetch { ""title"": $t, ""year"": $y, ""imdb_votes"": $v };"
recommendations,699,What are the top 5 movies that were directed by persons who were not primarily directors?,"MATCH (p:Person)-[:DIRECTED]->(m:Movie)
WHERE NOT exists{ (p)-[:ACTED_IN]->() }
WITH m, count(*) AS directorCount
ORDER BY directorCount DESC
LIMIT 5
RETURN m.title AS movie, directorCount AS timesDirected","match $p isa person; directed (director: $p, film: $m); not { acted_in (actor: $p); }; $m has title $t; reduce $count = count($m) groupby $t; sort $count desc; limit 5; fetch { ""movie"": $t, ""timesDirected"": $count };"
recommendations,700,Which 3 users have rated movies with an average rating below 3.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
WHERE avgRating < 3.0
RETURN u.name AS user, avgRating
ORDER BY avgRating
LIMIT 3","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avgRating = mean($rating) groupby $n;
sort $avgRating asc;
limit 3;
fetch { ""user"": $n, ""avgRating"": $avgRating };"
recommendations,701,List the top 5 movies that have the word 'love' in their plot description.,"MATCH (m:Movie)
WHERE toLower(m.plot) CONTAINS 'love'
RETURN m.title, m.plot
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has plot $p, has imdb_rating $r; $p like ""(?i).*love.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""plot"": $p };"
recommendations,702,Which 3 directors have directed the most movies with a budget over 200 million USD?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.budget > 200000000
WITH d, count(m) AS num_movies
ORDER BY num_movies DESC
LIMIT 3
RETURN d.name AS director, num_movies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has budget $b; $b > 200000000; reduce $num_movies = count($m) groupby $n; sort $num_movies desc; limit 3; fetch { ""director"": $n, ""num_movies"": $num_movies };"
recommendations,704,Which 3 actors have the highest total imdbVotes for all movies they acted in?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, sum(m.imdbVotes) AS totalVotes
ORDER BY totalVotes DESC
LIMIT 3
RETURN a.name AS actor, totalVotes","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has imdb_votes $v; reduce $totalVotes = sum($v) groupby $n; sort $totalVotes desc; limit 3; fetch { ""actor"": $n, ""totalVotes"": $totalVotes };"
recommendations,705,List the top 5 shortest movies with an imdbRating above 6.0.,"MATCH (m:Movie)
WHERE m.imdbRating > 6.0
RETURN m.title, m.runtime
ORDER BY m.runtime
LIMIT 5","match $m isa movie, has title $t, has runtime $r, has imdb_rating $ir; $ir > 6.0; sort $r asc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,706,Which 3 users have rated the most movies with an imdbRating below 5.0?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE m.imdbRating < 5.0
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); $m has imdb_rating $r; $r < 5.0; reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
recommendations,707,Which top 5 movies have a runtime longer than 150 minutes?,"MATCH (m:Movie)
WHERE m.runtime > 150
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match $m isa movie, has title $t, has runtime $r; $r > 150; sort $r desc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,708,List the top 3 directors born in the USA.,"MATCH (d:Director {bornIn: 'USA'})
RETURN d.name AS director, d.born AS birthDate
ORDER BY d.born DESC
LIMIT 3","match $d isa person, has name $n, has born $b, has born_in ""USA""; directed (director: $d); sort $b desc; limit 3; fetch { ""director"": $n, ""birthDate"": $b };"
recommendations,709,What are the first 3 movies released after 2010 with a budget over 100 million USD?,"MATCH (m:Movie)
WHERE m.released > '2010' AND m.budget > 100000000
RETURN m.title, m.released, m.budget
ORDER BY m.released
LIMIT 3","match $m isa movie, has title $t, has released $r, has budget $b; $r > ""2010""; $b > 100000000; sort $r asc; limit 3; fetch { ""title"": $t, ""released"": $r, ""budget"": $b };"
recommendations,710,Name the top 5 highest-grossing movies.,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL
RETURN m.title, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has revenue $r; sort $r desc; limit 5; fetch { ""title"": $t, ""revenue"": $r };"
recommendations,711,Which 3 users have rated the most movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, count(r) AS numRatings
ORDER BY numRatings DESC
LIMIT 3
RETURN u.name AS user, numRatings","match $u isa user, has name $n; rated (user: $u, film: $m); reduce $numRatings = count($m) groupby $n; sort $numRatings desc; limit 3; fetch { ""user"": $n, ""numRatings"": $numRatings };"
recommendations,712,List the top 5 actors who have acted in more than 10 movies.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, count(m) AS numMovies
WHERE numMovies > 10
RETURN a.name AS actor, numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 5;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,713,What are the top 3 genres by the number of movies?,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
RETURN g.name AS genre, count(m) AS movieCount
ORDER BY movieCount DESC
LIMIT 3","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); reduce $movieCount = count($m) groupby $n; sort $movieCount desc; limit 3; fetch { ""genre"": $n, ""movieCount"": $movieCount };"
recommendations,714,"Which top 5 movies have been rated by more than 500,000 users?","MATCH (m:Movie)
WHERE m.imdbVotes > 500000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; $v > 500000; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,715,List the first 3 movies directed by a director born in France.,"MATCH (d:Director {bornIn: 'France'})-[:DIRECTED]->(m:Movie)
RETURN m.title
LIMIT 3","match $d isa person, has born_in ""France""; directed (director: $d, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,716,What are the top 5 movies with an IMDb rating above 8?,"MATCH (m:Movie)
WHERE m.imdbRating > 8
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $r; $r > 8; sort $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $r };"
recommendations,717,Which 3 actors have played in both comedy and drama genres?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Comedy', 'Drama']
WITH a, collect(distinct g.name) AS genres
WHERE all(x IN ['Comedy', 'Drama'] WHERE x IN genres)
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m1); in_genre (film: $m1, genre: $g1); $g1 has name ""Comedy""; acted_in (actor: $a, film: $m2); in_genre (film: $m2, genre: $g2); $g2 has name ""Drama""; limit 3; fetch { ""name"": $n };"
recommendations,718,List the first 3 movies that have both English and French languages.,"MATCH (m:Movie)
WHERE 'en' IN m.languages AND 'fr' IN m.languages
RETURN m.title
LIMIT 3","match
$m isa movie, has languages $l, has title $t;
$l like "".*en.*"";
$l like "".*fr.*"";
limit 3;
fetch { ""title"": $t };"
recommendations,719,Which top 5 directors have the highest number of directed movies?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS numDirected
ORDER BY numDirected DESC
LIMIT 5
RETURN d.name AS director, numDirected AS numberOfMovies","match $d isa person, has name $n; directed (director: $d, film: $m); reduce $numDirected = count($m) groupby $n; sort $numDirected desc; limit 5; fetch { ""director"": $n, ""numberOfMovies"": $numDirected };"
recommendations,720,What are the first 3 movies with a revenue to budget ratio greater than 5?,"MATCH (m:Movie)
WHERE m.revenue IS NOT NULL AND m.budget IS NOT NULL AND m.revenue / m.budget > 5
RETURN m.title, m.revenue, m.budget, m.revenue / m.budget AS ratio
ORDER BY ratio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$bud > 0;
let $ratio = $rev / $bud;
$ratio > 5.0;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""revenue"": $rev, ""budget"": $bud, ""ratio"": $ratio };"
recommendations,721,List the top 5 movies that were released in the '90s.,"MATCH (m:Movie)
WHERE m.released STARTS WITH '199'
RETURN m.title, m.released, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has imdb_rating $r; $rel like ""^199.*""; sort $r desc; limit 5; fetch { ""title"": $t, ""released"": $rel, ""imdb_rating"": $r };"
recommendations,722,Which 3 actors were born after 1980 and have acted in more than 5 movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born > date('1980-01-01')
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name, a.born, numMovies
ORDER BY numMovies DESC
LIMIT 3","match
$a isa person, has name $n;
(actor: $a, film: $m) isa acted_in;
reduce $numMovies = count($m) groupby $n;
sort $numMovies desc;
limit 3;
fetch { ""actor"": $n, ""numMovies"": $numMovies };"
recommendations,723,List the first 3 users who have an average rating less than 3.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating
WHERE avgRating < 3
RETURN u.name AS user, avgRating
ORDER BY avgRating
LIMIT 3","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m), has rating $rating;
reduce $avgRating = mean($rating) groupby $n;
sort $avgRating asc;
limit 3;
fetch { ""user"": $n, ""avgRating"": $avgRating };"
recommendations,724,What are the top 5 genres in which movies have the highest average IMDb rating?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE m.imdbRating IS NOT NULL
WITH g.name AS genre, avg(m.imdbRating) AS avgRating
ORDER BY avgRating DESC
LIMIT 5
RETURN genre, avgRating","match $g isa genre, has name $n; in_genre (genre: $g, film: $m); $m has imdb_rating $r; reduce $avgRating = mean($r) groupby $n; sort $avgRating desc; limit 5; fetch { ""genre"": $n, ""avgRating"": $avgRating };"
recommendations,726,List the first 3 directors who have also acted in a movie.,"MATCH (p:Person)
WHERE exists{ (p)-[:DIRECTED]->(:Movie) } 
  AND exists{ (p)-[:ACTED_IN]->(:Movie) }
RETURN p.name
LIMIT 3","match $p isa person, has name $n; directed (director: $p); acted_in (actor: $p); limit 3; fetch { ""name"": $n };"
recommendations,727,What are the top 5 movies with IMDb votes greater than 100000?,"MATCH (m:Movie)
WHERE m.imdbVotes > 100000
RETURN m.title, m.imdbVotes
ORDER BY m.imdbVotes DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_votes $v; $v > 100000; sort $v desc; limit 5; fetch { ""title"": $t, ""imdb_votes"": $v };"
recommendations,728,Which 3 users have the highest average movie rating with at least 20 rated movies?,"MATCH (u:User)-[r:RATED]->(m:Movie)
WITH u, avg(r.rating) AS avgRating, count(r) AS numRatings
WHERE numRatings >= 20
RETURN u.name AS user, avgRating
ORDER BY avgRating DESC
LIMIT 3","match
$u isa user, has name $n;
$r isa rated (user: $u, film: $m);
reduce $numRatings = count($r) groupby $n;
sort $numRatings desc;
limit 3;
fetch { ""name"": $n, ""numRatings"": $numRatings };"
recommendations,729,What are the top 5 longest movies that have been released after 2000?,"MATCH (m:Movie)
WHERE m.released >= '2000-01-01' AND m.runtime IS NOT NULL
RETURN m.title, m.runtime
ORDER BY m.runtime DESC
LIMIT 5","match $m isa movie, has title $t, has released $rel, has runtime $r; $rel >= ""2000-01-01""; sort $r desc; limit 5; fetch { ""title"": $t, ""runtime"": $r };"
recommendations,730,Which 3 directors have directed movies in more than three genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WITH d, count(DISTINCT g) AS num_genres
WHERE num_genres > 3
RETURN d.name AS director, num_genres
ORDER BY num_genres DESC
LIMIT 3","match
$d isa person, has name $n;
(director: $d, film: $m) isa directed;
(film: $m, genre: $g) isa in_genre;
$g has name $gn;
reduce $num_genres = count($gn) groupby $n;
sort $num_genres desc;
limit 3;
fetch { ""director"": $n, ""num_genres"": $num_genres };"
recommendations,731,List the first 3 actors who have acted in movies with a revenue of over 500 million USD.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.revenue > 500000000
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); $m has revenue $r; $r > 500000000; limit 3; fetch { ""name"": $n };"
recommendations,732,What are the top 5 movies that have been directed by directors born in Nebraska?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'Nebraska, USA'})
RETURN m.title AS movie, m.year AS year, m.imdbRating AS rating
ORDER BY m.imdbRating DESC
LIMIT 5","match $d isa person, has born_in ""Nebraska, USA""; directed (director: $d, film: $m); $m has title $t, has year $y, has imdb_rating $r; sort $r desc; limit 5; fetch { ""movie"": $t, ""year"": $y, ""rating"": $r };"
recommendations,733,Which 3 movies have the highest number of actors involved?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
RETURN m.title AS movie, count(a) AS numActors
ORDER BY numActors DESC
LIMIT 3","match $m isa movie, has title $t; acted_in (film: $m, actor: $a); reduce $numActors = count($a) groupby $t; sort $numActors desc; limit 3; fetch { ""movie"": $t, ""numActors"": $numActors };"
recommendations,734,List the first 3 genres that have more than 50 movies associated with them.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WITH g, count(m) AS movieCount
WHERE movieCount > 50
RETURN g.name AS genre, movieCount
ORDER BY movieCount DESC
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
reduce $movieCount = count($m) groupby $n;
sort $movieCount desc;
limit 3;
fetch { ""genre"": $n, ""movieCount"": $movieCount };"
recommendations,735,What are the top 5 movies with the lowest IMDb rating but highest revenue?,"MATCH (m:Movie)
WHERE m.imdbRating IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.imdbRating, m.revenue
ORDER BY m.imdbRating ASC, m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has imdb_rating $ir, has revenue $r; sort $ir asc, $r desc; limit 5; fetch { ""title"": $t, ""imdb_rating"": $ir, ""revenue"": $r };"
recommendations,739,Which 3 directors have the most movies with a runtime over 180 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime > 180
WITH d, count(m) AS numLongMovies
ORDER BY numLongMovies DESC
LIMIT 3
RETURN d.name AS director, numLongMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r > 180; reduce $numLongMovies = count($m) groupby $n; sort $numLongMovies desc; limit 3; fetch { ""director"": $n, ""numLongMovies"": $numLongMovies };"
recommendations,741,What are the top 5 movies with a budget less than 10 million USD but revenue over 100 million USD?,"MATCH (m:Movie)
WHERE m.budget < 10000000 AND m.revenue > 100000000
RETURN m.title, m.budget, m.revenue
ORDER BY m.revenue DESC
LIMIT 5","match $m isa movie, has title $t, has budget $b, has revenue $r; $b < 10000000; $r > 100000000; sort $r desc; limit 5; fetch { ""title"": $t, ""budget"": $b, ""revenue"": $r };"
recommendations,742,List the first 3 movies with plots containing the word 'adventure'.,"MATCH (m:Movie)
WHERE m.plot CONTAINS 'adventure'
RETURN m.title, m.plot
LIMIT 3","match $m isa movie, has title $t, has plot $p; $p contains ""adventure""; limit 3; fetch { ""title"": $t, ""plot"": $p };"
recommendations,743,What are the top 5 oldest movies in the database?,"MATCH (m:Movie)
RETURN m.title, m.year
ORDER BY m.year
LIMIT 5","match $m isa movie, has title $t, has year $y; sort $y asc; limit 5; fetch { ""title"": $t, ""year"": $y };"
recommendations,744,Which 3 movies have the highest budget to revenue ratio?,"MATCH (m:Movie)
WHERE m.budget IS NOT NULL AND m.revenue IS NOT NULL
RETURN m.title, m.budget, m.revenue, toFloat(m.budget) / m.revenue AS budgetRevenueRatio
ORDER BY budgetRevenueRatio DESC
LIMIT 3","match
$m isa movie, has title $t, has revenue $rev, has budget $bud;
$rev > 0;
let $ratio = $bud / $rev;
sort $ratio desc;
limit 3;
fetch { ""title"": $t, ""budgetRevenueRatio"": $ratio };"
recommendations,745,List the first 3 directors who have directed both a comedy and a drama.,"MATCH (d:Director)-[:DIRECTED]->(m1:Movie)-[:IN_GENRE]->(g1:Genre {name: 'Comedy'}),
      (d)-[:DIRECTED]->(m2:Movie)-[:IN_GENRE]->(g2:Genre {name: 'Drama'})
RETURN d.name AS director
LIMIT 3","match $d isa person, has name $n; directed (director: $d, film: $m1); in_genre (film: $m1, genre: $g1); $g1 has name ""Comedy""; directed (director: $d, film: $m2); in_genre (film: $m2, genre: $g2); $g2 has name ""Drama""; limit 3; fetch { ""director"": $n };"
recommendations,746,What are the top 5 movies with the most number of genres associated?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH m, count(g) AS genreCount
ORDER BY genreCount DESC
LIMIT 5
RETURN m.title AS movie, genreCount AS numberOfGenres","match $m isa movie, has title $t; in_genre (film: $m, genre: $g); reduce $genreCount = count($g) groupby $t; sort $genreCount desc; limit 5; fetch { ""movie"": $t, ""numberOfGenres"": $genreCount };"
recommendations,747,List the first 3 actors who have acted in a movie without a poster link.,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE m.poster IS NULL
RETURN a.name
LIMIT 3","match $a isa person, has name $n; acted_in (actor: $a, film: $m); not { $m has poster $p; }; limit 3; fetch { ""name"": $n };"
recommendations,749,List the first 3 movies that have been directed by actors.,"MATCH (p:Person)-[:ACTED_IN]->(m:Movie)<-[:DIRECTED]-(p)
RETURN m.title
LIMIT 3","match $p isa person; acted_in (actor: $p, film: $m); directed (director: $p, film: $m); $m has title $t; limit 3; fetch { ""title"": $t };"
recommendations,750,What are the top 5 directors who have directed the most movies with a runtime under 90 minutes?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.runtime < 90
WITH d, count(m) AS numMovies
ORDER BY numMovies DESC
LIMIT 5
RETURN d.name AS director, numMovies","match $d isa person, has name $n; directed (director: $d, film: $m); $m has runtime $r; $r < 90; reduce $numMovies = count($m) groupby $n; sort $numMovies desc; limit 5; fetch { ""director"": $n, ""numMovies"": $numMovies };"
recommendations,752,List the first 3 genres with movies having an average IMDb rating under 5.,"MATCH (g:Genre)<-[:IN_GENRE]-(m:Movie)
WHERE m.imdbRating IS NOT NULL
WITH g, avg(m.imdbRating) AS avgRating
WHERE avgRating < 5
RETURN g.name AS genre, avgRating
ORDER BY avgRating
LIMIT 3","match
$g isa genre, has name $n;
(film: $m, genre: $g) isa in_genre;
$m has imdb_rating $r;
reduce $avgRating = mean($r) groupby $n;
sort $avgRating asc;
limit 3;
fetch { ""genre"": $n, ""avgRating"": $avgRating };"
recommendations,23,What are the first 5 genres associated with movies having the most languages available?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
RETURN g.name AS genre, max(size(m.languages)) AS maxLanguages
ORDER BY maxLanguages DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
reduce $max_langs = max($lang_count) groupby $g;
sort $max_langs desc;
limit 5;
fetch { ""genre"": $g.name, ""maxLanguages"": $max_langs };"
recommendations,33,Show the top 5 movies with the most languages spoken.,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie, has languages $lang;
let $lang_count = language_count($m);
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,96,Which 5 movies have the most diverse language offerings?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,166,What are the top 5 movies that have the most languages spoken in them?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,219,List the 5 movies with the most languages spoken.,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,245,Which 5 movies have been released in the most number of countries?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,270,Which 5 movies have the most distinct countries of release listed?,"MATCH (m:Movie)
RETURN m.title, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,276,What are the top 3 movies based on the number of different languages they have been released in?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,288,What are the first 3 movies that have been released in exactly three different countries?,"MATCH (m:Movie)
WHERE size(m.countries) = 3
RETURN m.title, m.released, m.countries
ORDER BY m.released
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie, has released $rel;
let $ctry_count = country_count($m);
$ctry_count == 3;
sort $rel;
limit 3;
fetch { ""title"": $m.title, ""released"": $rel };"
recommendations,299,List the first 5 movies with at least three different languages listed.,"MATCH (m:Movie)
WHERE size(m.languages) >= 3
RETURN m.title, m.languages
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count >= 3;
limit 5;
fetch { ""title"": $m.title };"
recommendations,322,Which 3 movies have the highest number of languages spoken?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,327,What are the top 5 movies with the most distinct countries of origin?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,361,Which three movies have the most diverse set of spoken languages?,"MATCH (m:Movie)
RETURN m.title, m.languages, size(m.languages) AS numLanguages
ORDER BY numLanguages DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,377,Which three movies have the most different countries listed?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,383,List the top 3 movies that have multiple languages but a single country of origin.,"MATCH (m:Movie)
WHERE size(m.languages) > 1 AND size(m.countries) = 1
RETURN m.title, m.languages, m.countries
ORDER BY m.imdbRating DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie, has imdb_rating $r;
let $lang_count = language_count($m);
let $ctry_count = country_count($m);
$lang_count > 1;
$ctry_count == 1;
sort $r desc;
limit 3;
fetch { ""title"": $m.title };"
recommendations,406,List the first 3 movies that were shot in more than five different locations.,"MATCH (m:Movie)
WHERE size(m.countries) > 5
RETURN m.title, m.countries
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 5;
limit 3;
fetch { ""title"": $m.title };"
recommendations,450,What are the top 3 movies with the most diverse set of spoken languages?,"MATCH (m:Movie)
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,467,List the movies that have been released in more than 5 countries.,"MATCH (m:Movie)
WHERE size(m.countries) > 5
RETURN m.title, m.countries","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 5;
fetch { ""title"": $m.title };"
recommendations,473,What are the top 5 movies by number of languages spoken in them?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,477,What are the top 3 movies with the most countries listed in their release?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries
ORDER BY size(m.countries) DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,504,What are the top 3 movies with the highest number of countries involved in their production?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,524,What are the top 5 movies with the most languages spoken?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,536,What are the top 5 movies with the highest number of countries involved?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 5","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 5;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,558,List the first 3 movies with exactly three languages spoken.,"MATCH (m:Movie)
WHERE size(m.languages) = 3
RETURN m.title
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count == 3;
limit 3;
fetch { ""title"": $m.title };"
recommendations,572,Which 5 movies had their entire plot translated into more than one language?,"MATCH (m:Movie)
WHERE size(m.languages) > 1
RETURN m.title, m.languages
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 1;
limit 5;
fetch { ""title"": $m.title };"
recommendations,584,What are the first 3 movies with the highest number of languages available?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 3;
fetch { ""title"": $m.title };"
recommendations,612,List the movies that have been released in at least three different languages.,"MATCH (m:Movie)
WHERE size(m.languages) >= 3
RETURN m.title, m.languages","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count >= 3;
fetch { ""title"": $m.title };"
recommendations,638,Identify movies that have languages lists containing more than 5 languages.,"MATCH (m:Movie)
WHERE size(m.languages) > 5
RETURN m.title, m.languages","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 5;
fetch { ""title"": $m.title };"
recommendations,651,What are the top 5 movies with the most languages available?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, m.languages, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,657,List the top 5 movies with the most countries available in their languages list.,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,683,What are the top 5 movies with the highest number of countries represented in their languages list?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,695,What are the top 5 movies with a single-country language setting and the highest imdbRating?,"MATCH (m:Movie)
WHERE size(m.languages) = 1 AND exists {(m)-[:IN_GENRE]->(:Genre)}
RETURN m.title, m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie, has imdb_rating $r;
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
$lang_count == 1;
sort $r desc;
limit 5;
fetch { ""title"": $m.title, ""imdbRating"": $r };"
recommendations,703,What are the top 5 movies with the most languages and at least one genre being 'Action'?,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name = 'Action'
RETURN m.title, m.languages
ORDER BY size(m.languages) DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
$g isa genre, has name ""Action"";
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title };"
recommendations,725,Which top 5 movies have the most diverse range of spoken languages?,"MATCH (m:Movie)
WHERE m.languages IS NOT NULL
RETURN m.title, size(m.languages) AS languageCount
ORDER BY languageCount DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $lang_count = language_count($m);
$lang_count > 0;
sort $lang_count desc;
limit 5;
fetch { ""title"": $m.title, ""languageCount"": $lang_count };"
recommendations,740,List the first 3 movies with the most diverse country production origins.,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
RETURN m.title, m.countries, size(m.countries) AS numCountries
ORDER BY numCountries DESC
LIMIT 3","with fun country_count($m: movie) -> integer:
  match $m has countries $c;
  return count;

match
$m isa movie;
let $ctry_count = country_count($m);
$ctry_count > 0;
sort $ctry_count desc;
limit 3;
fetch { ""title"": $m.title, ""numCountries"": $ctry_count };"
recommendations,63,What are the three most common languages spoken in movies directed by Anthony Stacchi?,"MATCH (d:Director {name: 'Anthony Stacchi'})-[:DIRECTED]->(m:Movie)
WITH m.languages AS languages
UNWIND languages AS language
RETURN language, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$d isa person, has name ""Anthony Stacchi"";
directed (director: $d, film: $m);
$m has languages $l;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 3;
fetch { ""language"": $l, ""count"": $count };"
recommendations,69,What are the top 3 countries producing movies with a revenue over 500 million dollars?,"MATCH (m:Movie)
WHERE m.revenue > 500000000
WITH m.countries AS countries
UNWIND countries AS country
RETURN country, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has revenue $r, has countries $c;
$r > 500000000;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c, ""count"": $count };"
recommendations,97,What are the 3 most common countries for movie settings in the database?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
UNWIND m.countries AS country
RETURN country, count(*) AS count
ORDER BY count DESC
LIMIT 3","match
$m isa movie, has countries $c;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 3;
fetch { ""country"": $c, ""count"": $count };"
recommendations,112,Which actors have featured in movies released in multiple languages?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE size(m.languages) > 1
RETURN a.name AS actor, collect(DISTINCT m.title) AS movies","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$p isa person;
$m isa movie;
acted_in (actor: $p, film: $m);
let $lang_count = language_count($m);
$lang_count > 1;
select $p;
distinct;
fetch { ""actor"": $p.name };"
recommendations,123,Which actors have acted in movies from at least three different countries?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, size(collect(distinct m.countries)) AS numCountries
WHERE numCountries >= 3
RETURN a.name AS actor, numCountries","match
$p isa person;
$m isa movie, has countries $c;
acted_in (actor: $p, film: $m);
select $p, $c;
distinct;
reduce $num_countries = count($c) groupby $p;
match
$num_countries >= 3;
fetch { ""actor"": $p.name, ""numCountries"": $num_countries };"
recommendations,138,Which directors have directed movies in more than two languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE size(m.languages) > 2
RETURN d.name AS director, collect(DISTINCT m.title) AS movies, collect(DISTINCT m.languages) AS languages","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$p isa person;
$m isa movie;
directed (director: $p, film: $m);
let $lang_count = language_count($m);
$lang_count > 2;
select $p;
distinct;
fetch { ""director"": $p.name };"
recommendations,150,"Find all movies that have been rated after January 1st, 2015.","MATCH (m:Movie)<-[r:RATED]-(u:User)
WHERE r.timestamp >= datetime('2015-01-01').epochSeconds
RETURN m, r, u","match
$m isa movie;
$u isa user;
$r isa rated (user: $u, film: $m), has timestamp $t;
$t >= 1420070400;
fetch { ""title"": $m.title, ""user"": $u.name };"
recommendations,156,What are the top 5 oldest actors who have acted in English language movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE a.born IS NOT NULL AND 'English' IN m.languages
RETURN a.name, a.born
ORDER BY a.born
LIMIT 5","match
$p isa person, has born $b;
$m isa movie, has languages ""English"";
acted_in (actor: $p, film: $m);
select $p, $b;
distinct;
sort $b;
limit 5;
fetch { ""name"": $p.name, ""born"": $b };"
recommendations,175,Which directors have directed movies in more than three different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.languages IS NOT NULL
WITH d, size(collect(DISTINCT m.languages)) AS num_languages 
WHERE num_languages > 3
RETURN d.name AS director, num_languages","match
$p isa person;
$m isa movie, has languages $l;
directed (director: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 3;
fetch { ""director"": $p.name, ""num_languages"": $num_languages };"
recommendations,188,Which directors have directed movies in both the 'Horror' and 'Romance' genres?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)-[:IN_GENRE]->(g:Genre)
WHERE g.name IN ['Horror', 'Romance']
WITH d, collect(distinct g.name) AS genres
WHERE size(genres) = 2
RETURN d.name AS director","match
$d isa person;
$m1 isa movie;
directed (director: $d, film: $m1);
$g1 isa genre, has name ""Horror"";
in_genre (film: $m1, genre: $g1);
$m2 isa movie;
directed (director: $d, film: $m2);
$g2 isa genre, has name ""Romance"";
in_genre (film: $m2, genre: $g2);
select $d;
distinct;
fetch { ""director"": $d.name };"
recommendations,198,What are the top 5 countries where the most movies originate from based on the 'countries' property of movies?,"MATCH (m:Movie)
WHERE m.countries IS NOT NULL
UNWIND m.countries AS country
RETURN country, count(*) AS numMovies
ORDER BY numMovies DESC
LIMIT 5","match
$m isa movie, has countries $c;
reduce $count = count($m) groupby $c;
sort $count desc;
limit 5;
fetch { ""country"": $c, ""numMovies"": $count };"
recommendations,200,What are the top 5 languages in which movies are made based on the 'languages' property of movies?,"MATCH (m:Movie)
UNWIND m.languages AS language
RETURN language, count(*) AS count
ORDER BY count DESC
LIMIT 5","match
$m isa movie, has languages $l;
reduce $count = count($m) groupby $l;
sort $count desc;
limit 5;
fetch { ""language"": $l, ""count"": $count };"
recommendations,253,List the top 5 genres of movies with the most language diversity.,"MATCH (m:Movie)-[:IN_GENRE]->(g:Genre)
WITH g, m.languages AS languages
WITH g, size(languages) AS languageCount
RETURN g.name AS genre, avg(languageCount) AS avgLanguages
ORDER BY avgLanguages DESC
LIMIT 5","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
in_genre (film: $m, genre: $g);
let $lang_count = language_count($m);
reduce $avg_langs = mean($lang_count) groupby $g;
sort $avg_langs desc;
limit 5;
fetch { ""genre"": $g.name, ""avgLanguages"": $avg_langs };"
recommendations,285,Which 5 directors have directed movies in more than three different countries?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, size(collect(distinct m.countries)) AS numCountries
WHERE numCountries > 3
RETURN d.name AS director, numCountries
ORDER BY numCountries DESC
LIMIT 5","match
$p isa person;
$m isa movie, has countries $c;
directed (director: $p, film: $m);
select $p, $c;
distinct;
reduce $num_countries = count($c) groupby $p;
match
$num_countries > 3;
sort $num_countries desc;
limit 5;
fetch { ""director"": $p.name, ""numCountries"": $num_countries };"
recommendations,355,Which three actors have acted in movies in more than 3 different languages?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, size(collect(distinct m.languages)) AS num_languages
WHERE num_languages > 3
RETURN a.name, num_languages
ORDER BY num_languages DESC
LIMIT 3","match
$p isa person;
$m isa movie, has languages $l;
acted_in (actor: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 3;
sort $num_languages desc;
limit 3;
fetch { ""name"": $p.name, ""num_languages"": $num_languages };"
recommendations,388,Which three directors have directed movies in more than one language?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE size(m.languages) > 1
WITH d, count(DISTINCT m) AS num_multilingual_movies
WHERE num_multilingual_movies > 1
RETURN d.name AS director, num_multilingual_movies
ORDER BY num_multilingual_movies DESC
LIMIT 3","with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$p isa person;
$m isa movie;
directed (director: $p, film: $m);
let $lang_count = language_count($m);
$lang_count > 1;
reduce $num_multilingual = count($m) groupby $p;
match
$num_multilingual > 1;
sort $num_multilingual desc;
limit 3;
fetch { ""director"": $p.name, ""num_multilingual_movies"": $num_multilingual };"
recommendations,392,List the top 3 directors based on the number of different countries their movies have been released in.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, size(collect(distinct m.countries)) AS numCountries
ORDER BY numCountries DESC
LIMIT 3
RETURN d.name AS director, numCountries AS numberOfCountries","match
$p isa person;
$m isa movie, has countries $c;
directed (director: $p, film: $m);
select $p, $c;
distinct;
reduce $num_countries = count($c) groupby $p;
sort $num_countries desc;
limit 3;
fetch { ""director"": $p.name, ""numberOfCountries"": $num_countries };"
recommendations,465,Find all movies that have been rated exactly 5 times.,"MATCH (m:Movie)
WHERE count{(u:User)-[:RATED]->(m)} = 5
RETURN m","match
$m isa movie;
$r isa rated (film: $m);
reduce $rating_count = count($r) groupby $m;
match
$rating_count == 5;
fetch { ""title"": $m.title };"
recommendations,498,Find all movies where the director has directed more than 5 movies.,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, count(m) AS num_directed
WHERE num_directed > 5
MATCH (d)-[:DIRECTED]->(movie:Movie)
RETURN d.name AS director, collect(movie.title) AS movies","match
$d isa person;
$m isa movie;
directed (director: $d, film: $m);
reduce $num_directed = count($m) groupby $d;
match
$num_directed > 5;
fetch { ""director"": $d.name };"
recommendations,548,List the first 3 movies that have been directed by more than one director.,"MATCH (m:Movie)
WHERE exists{ (m)<-[:DIRECTED]-(:Director) }
WITH m
MATCH (m)<-[:DIRECTED]-(d:Director)
WITH m, count(d) AS directorCount
WHERE directorCount > 1
RETURN m.title AS movie
LIMIT 3","match
$m isa movie;
$d isa person;
directed (director: $d, film: $m);
reduce $dir_count = count($d) groupby $m;
match
$dir_count > 1;
limit 3;
fetch { ""movie"": $m.title };"
recommendations,561,Which 5 directors have directed movies in more than 5 different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WITH d, size(collect(distinct m.languages)) AS num_languages
WHERE num_languages > 5
RETURN d.name, num_languages
ORDER BY num_languages DESC
LIMIT 5","match
$p isa person;
$m isa movie, has languages $l;
directed (director: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 5;
sort $num_languages desc;
limit 5;
fetch { ""name"": $p.name, ""num_languages"": $num_languages };"
recommendations,604,Which movies have actors who were born in the USA and have acted in a comedy genre?,"MATCH (m:Movie)-[:IN_GENRE]->(:Genre {name: 'Comedy'})
MATCH (a:Actor {bornIn: 'USA'})-[:ACTED_IN]->(m)
RETURN m.title AS movie, collect(a.name) AS actors","match
$p isa person, has born_in ""USA"";
$m isa movie;
acted_in (actor: $p, film: $m);
$g isa genre, has name ""Comedy"";
in_genre (film: $m, genre: $g);
select $m;
distinct;
fetch { ""movie"": $m.title };"
recommendations,631,Which directors have directed movies in more than three different languages?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.languages IS NOT NULL
WITH d, size(collect(DISTINCT m.languages)) AS num_languages 
WHERE num_languages > 3
RETURN d.name AS director, num_languages","match
$p isa person;
$m isa movie, has languages $l;
directed (director: $p, film: $m);
select $p, $l;
distinct;
reduce $num_languages = count($l) groupby $p;
match
$num_languages > 3;
fetch { ""director"": $p.name, ""num_languages"": $num_languages };"
recommendations,590,List the first 3 movies with the most different directors involved.,"MATCH (m:Movie)
WITH m, size([(m)<-[:DIRECTED]-(d) | d]) AS numDirectors
ORDER BY numDirectors DESC
LIMIT 3
RETURN m.title AS movie, numDirectors","match
$m isa movie;
$d isa person;
directed (director: $d, film: $m);
reduce $num_directors = count($d) groupby $m;
sort $num_directors desc;
limit 3;
fetch { ""movie"": $m.title, ""numDirectors"": $num_directors };"
recommendations,396,What are the first 3 movies with a majority of non-English languages?,"MATCH (m:Movie)
WHERE size([l IN m.languages WHERE l <> 'English']) > size(m.languages) / 2
RETURN m.title
LIMIT 3","with fun non_english_count($m: movie) -> integer:
  match $m has languages $l; $l != ""English"";
  return count;

with fun language_count($m: movie) -> integer:
  match $m has languages $l;
  return count;

match
$m isa movie;
let $ne = non_english_count($m);
let $total = language_count($m);
$total > 0;
let $half = $total / 2;
$ne > $half;
limit 3;
fetch { ""title"": $m.title };"
recommendations,46,Identify the first 3 movies that have been rated by users younger than 25.,"MATCH (u:User)-[r:RATED]->(m:Movie)
WHERE u.age < 25
RETURN m.title
LIMIT 3","match
$u isa user, has age $a;
$a < 25;
$r isa rated (user: $u, film: $m);
limit 3;
fetch { ""title"": $m.title };"
recommendations,184,What are the top 5 directors who have directed movies that won an academy award?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE m.plot CONTAINS 'Academy Award'
WITH d, count(m) AS awardCount
ORDER BY awardCount DESC
LIMIT 5
RETURN d.name AS director, awardCount","match
$p isa person;
directed (director: $p, film: $m);
won (film: $m, award: $aw);
$aw has name $an;
$an like "".*Academy Award.*"";
reduce $count = count($m) groupby $p;
sort $count desc;
limit 5;
fetch { ""director"": $p.name, ""awards"": $count };"
recommendations,255,List the first 5 movies that have been directed by women.,"MATCH (director:Person)-[:DIRECTED]->(movie:Movie)
WHERE director.name =~ ""(?i).*\\b(Ms\\.|Miss|Mrs\\.|Madam|Madame|Mademoiselle|Frau|Frulein|Seora|Seorita|Doa|Donna)\\b.*""
RETURN movie.title
LIMIT 5","match
$p isa person, has gender ""female"";
directed (director: $p, film: $m);
limit 5;
fetch { ""title"": $m.title };"
recommendations,273,List the first 5 actors who were born and died in the same country.,"MATCH (a:Actor)
WHERE a.bornIn IS NOT NULL AND a.bornIn = a.diedIn
RETURN a.name AS actor, a.bornIn AS country
LIMIT 5","match
$p isa person, has born_in $bi, has died_in $di;
$bi == $di;
limit 5;
fetch { ""actor"": $p.name, ""country"": $bi };"
recommendations,391,Which three movies have been rated by the youngest users on average?,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, avg(u.age) AS avgAge, count(r) AS numRatings
WHERE numRatings > 10
RETURN m.title, avgAge
ORDER BY avgAge
LIMIT 3","match
$m isa movie;
$u isa user, has age $a;
$r isa rated (user: $u, film: $m);
reduce $count = count($r), $avg_age = mean($a) groupby $m;
match $count > 10;
sort $avg_age asc;
limit 3;
fetch { ""title"": $m.title, ""avg_age"": $avg_age };"
recommendations,400,Which three directors have directed movies that have won any cinematic awards?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN d.name AS director
LIMIT 3","match
$p isa person;
directed (director: $p, film: $m);
won (film: $m, award: $aw);
select $p;
distinct;
limit 3;
fetch { ""director"": $p.name };"
recommendations,401,Which three directors have directed movies that have won any cinematic awards?,"MATCH (d:Director)-[:DIRECTED]->(m:Movie)
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN d.name AS director
LIMIT 3","match
$p isa person;
directed (director: $p, film: $m);
won (film: $m, award: $aw);
select $p;
distinct;
limit 3;
fetch { ""director"": $p.name };"
recommendations,423,What are the first 3 movies with a main actor over the age of 50 at the time of filming?,"MATCH (m:Movie)<-[:ACTED_IN]-(a:Actor)
WHERE date(m.released) - a.born > duration('P50Y')
RETURN m.title, a.name, duration.between(a.born, date(m.released)).years as age
ORDER BY m.released
LIMIT 3","match
$m isa movie, has year $y;
$p isa person, has born $b;
acted_in (actor: $p, film: $m);
let $threshold = $y - 50;
$b < $threshold;
limit 3;
fetch { ""title"": $m.title, ""actor"": $p.name };"
recommendations,42,Show the top 5 highest IMDb rated movies directed by female directors.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Person)
WHERE d.name =~ ""(?i).*\\b(Ms\\.|Miss|Mrs\\.|Frau|Frulein|Mademoiselle|Madame|Mlle\\.|Mme\\.|Seora|Seorita|Doa).*""
   OR exists{ (d)-[:ACTED_IN]->(:Movie) }
RETURN m.title AS movie, m.imdbRating AS rating
ORDER BY m.imdbRating DESC
LIMIT 5","match
$p isa person, has gender ""female"";
directed (director: $p, film: $m);
$m has imdb_rating $r;
sort $r desc;
limit 5;
fetch { ""movie"": $m.title, ""rating"": $r };"
recommendations,488,List all movies that have won an award and have been directed by a director born in the UK.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'UK'})
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN m.title, d.name","match
$p isa person, has born_in ""UK"";
directed (director: $p, film: $m);
won (film: $m, award: $aw);
fetch { ""title"": $m.title, ""director"": $p.name };"
recommendations,489,List all movies that have won an award and have been directed by a director born in the UK.,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director {bornIn: 'UK'})
WHERE exists{ (m)-[:WON]->(:Award) }
RETURN m.title, d.name","match
$p isa person, has born_in ""UK"";
directed (director: $p, film: $m);
won (film: $m, award: $aw);
fetch { ""title"": $m.title, ""director"": $p.name };"
recommendations,22,Show the top 3 movies that have been rated by the oldest users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, u, r
ORDER BY u.born ASC
LIMIT 3
RETURN m.title AS movie, u.name AS user, r.rating AS rating","match
$u isa user, has age $a;
$r isa rated (user: $u, film: $m);
$r has rating $rt;
sort $a desc;
limit 3;
fetch { ""movie"": $m.title, ""user"": $u.name, ""rating"": $rt };"
recommendations,242,Show the first 3 movies that have been rated by the youngest users.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, u, r
ORDER BY u.born DESC, r.timestamp
RETURN m.title AS movie, u.name AS user
LIMIT 3","match
$u isa user, has age $a;
$r isa rated (user: $u, film: $m);
sort $a asc;
limit 3;
fetch { ""movie"": $m.title, ""user"": $u.name };"
recommendations,736,Which 3 actors have acted in both a highest and lowest grossing movie?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WITH a, m
ORDER BY m.revenue DESC
WITH a, collect(m)[0] AS highestGrossingMovie, collect(m)[-1] AS lowestGrossingMovie
WHERE exists{ (a)-[:ACTED_IN]->(highestGrossingMovie) } 
  AND exists{ (a)-[:ACTED_IN]->(lowestGrossingMovie) }
RETURN a.name AS actor, highestGrossingMovie.title AS highestGrossingMovie, lowestGrossingMovie.title AS lowestGrossingMovie
LIMIT 3","with fun max_revenue() -> integer:
  match $m isa movie, has revenue $r;
  return max($r);

with fun min_revenue() -> integer:
  match $m isa movie, has revenue $r;
  $r > 0;
  return min($r);

match
$p isa person;
$m1 isa movie, has revenue $r1;
$m2 isa movie, has revenue $r2;
let $max = max_revenue();
let $min = min_revenue();
$r1 == $max;
$r2 == $min;
acted_in (actor: $p, film: $m1);
acted_in (actor: $p, film: $m2);
limit 3;
fetch { ""actor"": $p.name, ""highest"": $m1.title, ""lowest"": $m2.title };"
recommendations,580,What are the top 5 movies with the most detailed biographies of their directors?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
WHERE d.bio IS NOT NULL
RETURN m.title AS movie, d.name AS director, d.bio AS bio
ORDER BY size(d.bio) DESC
LIMIT 5","match
$d isa person, has bio $b;
$m isa movie;
directed (director: $d, film: $m);
$b != """";
sort $b desc;
limit 5;
fetch { ""movie"": $m.title, ""director"": $d.name, ""bio"": $b };"
recommendations,748,What are the top 5 movies with the most detailed biographies of their directors?,"MATCH (m:Movie)<-[:DIRECTED]-(d:Director)
WHERE d.bio IS NOT NULL
RETURN m.title AS movie, d.name AS director, d.bio AS bio
ORDER BY size(d.bio) DESC
LIMIT 5","match
$d isa person, has bio $b;
$m isa movie;
directed (director: $d, film: $m);
$b != """";
sort $b desc;
limit 5;
fetch { ""movie"": $m.title, ""director"": $d.name, ""bio"": $b };"
recommendations,737,List the first 3 movies where the main language is not English but have an IMDb rating over 7.,"MATCH (m:Movie)
WHERE m.languages[0] <> 'English' AND m.imdbRating > 7
RETURN m.title, m.languages[0], m.imdbRating
ORDER BY m.imdbRating DESC
LIMIT 3","match
$m isa movie, has imdb_rating $r;
$r > 7.0;
not { $m has languages ""English""; };
limit 3;
fetch { ""title"": $m.title, ""rating"": $r };"
recommendations,28,List the first 5 movies that have been rated by users from more than 10 different countries.,"MATCH (m:Movie)<-[r:RATED]-(u:User)
WITH m, count(DISTINCT u.name) AS numCountries
WHERE numCountries > 10
RETURN m.title
LIMIT 5","with fun user_country_count($m: movie) -> integer:
  match
  $r isa rated (film: $m, user: $u);
  located_in (resident: $u, country: $c);
  select $c;
  distinct;
  return count;

match
$m isa movie;
let $cc = user_country_count($m);
$cc > 10;
limit 5;
fetch { ""title"": $m.title, ""countries"": $cc };"
recommendations,585,Which 5 movies have the most distinct posters on IMDb?,"MATCH (m:Movie)
WHERE m.poster IS NOT NULL
RETURN m.title, m.poster
ORDER BY m.poster
LIMIT 5","with fun poster_count($m: movie) -> integer:
  match $m has poster $p;
  return count;

match
$m isa movie;
let $pc = poster_count($m);
$pc > 0;
sort $pc desc;
limit 5;
fetch { ""title"": $m.title, ""posters"": $pc };"
recommendations,624,List all movies that have been rated by both male and female users.,"MATCH (m:Movie)
WHERE exists{ (m)<-[:RATED]-(:User {name: 'Omar Huffman'}) }
  AND exists{ (m)<-[:RATED]-(:User {name: 'Myrtle Potter'}) }
RETURN m.title","match
$m isa movie;
$u1 isa user, has gender ""male"";
$u2 isa user, has gender ""female"";
rated (user: $u1, film: $m);
rated (user: $u2, film: $m);
select $m;
distinct;
fetch { ""title"": $m.title };"
recommendations,21,Which 5 movies have the most detailed plots (based on the length of the plot text)?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.plot
ORDER BY size(m.plot) DESC
LIMIT 5","match
$m isa movie, has plot $p;
$p != """";
sort $p desc;
limit 5;
fetch { ""title"": $m.title, ""plot"": $p };"
recommendations,148,Which movies have a plot description longer than 150 characters?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL AND size(m.plot) > 150
RETURN m.title, m.plot","match
$m isa movie, has plot $p;
$p like "".{150,}"";
fetch { ""title"": $m.title, ""plot"": $p };"
recommendations,257,Which 3 movies have the most detailed plot descriptions (longest text)?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.plot
ORDER BY size(m.plot) DESC
LIMIT 3","match
$m isa movie, has plot $p;
$p != """";
sort $p desc;
limit 3;
fetch { ""title"": $m.title, ""plot"": $p };"
recommendations,272,Which 3 directors have the longest bios in the database?,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
ORDER BY size(d.bio) DESC
LIMIT 3","match
$p isa person, has bio $b;
directed (director: $p, film: $m);
$b != """";
select $p, $b;
distinct;
sort $b desc;
limit 3;
fetch { ""name"": $p.name, ""bio"": $b };"
recommendations,300,Show the top 5 actors with the longest bios.,"MATCH (a:Actor)
WHERE a.bio IS NOT NULL
RETURN a.name, a.bio
ORDER BY size(a.bio) DESC
LIMIT 5","match
$p isa person, has bio $b;
acted_in (actor: $p, film: $m);
$b != """";
select $p, $b;
distinct;
sort $b desc;
limit 5;
fetch { ""name"": $p.name, ""bio"": $b };"
recommendations,506,Which actors have the longest bio in the database?,"MATCH (a:Actor)
RETURN a.name, a.bio
ORDER BY size(a.bio) DESC
LIMIT 1","match
$p isa person, has bio $b;
acted_in (actor: $p, film: $m);
$b != """";
select $p, $b;
distinct;
sort $b desc;
limit 1;
fetch { ""name"": $p.name, ""bio"": $b };"
recommendations,510,What are the top 5 movies with the most detailed plots (assuming plot length can be measured)?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.plot
ORDER BY size(m.plot) DESC
LIMIT 5","match
$m isa movie, has plot $p;
$p != """";
sort $p desc;
limit 5;
fetch { ""title"": $m.title, ""plot"": $p };"
recommendations,538,Which 5 movies have the most detailed (longest) plots?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.plot
ORDER BY size(m.plot) DESC
LIMIT 5","match
$m isa movie, has plot $p;
$p != """";
sort $p desc;
limit 5;
fetch { ""title"": $m.title, ""plot"": $p };"
recommendations,543,Which 5 directors have the longest bios on their profile?,"MATCH (d:Director)
WHERE d.bio IS NOT NULL
RETURN d.name, d.bio
ORDER BY size(d.bio) DESC
LIMIT 5","match
$p isa person, has bio $b;
directed (director: $p, film: $m);
$b != """";
select $p, $b;
distinct;
sort $b desc;
limit 5;
fetch { ""name"": $p.name, ""bio"": $b };"
recommendations,559,What are the top 5 movies with the longest plots?,"MATCH (m:Movie)
WHERE m.plot IS NOT NULL
RETURN m.title, m.plot
ORDER BY size(m.plot) DESC
LIMIT 5","match
$m isa movie, has plot $p;
$p != """";
sort $p desc;
limit 5;
fetch { ""title"": $m.title, ""plot"": $p };"
recommendations,751,Which 3 actors have a bio longer than 1000 characters and have acted in more than 5 movies?,"MATCH (a:Actor)-[:ACTED_IN]->(m:Movie)
WHERE size(a.bio) > 1000
WITH a, count(m) AS numMovies
WHERE numMovies > 5
RETURN a.name, a.bio, numMovies
ORDER BY numMovies DESC
LIMIT 3","with fun movie_count($p: person) -> integer:
  match acted_in (actor: $p, film: $m);
  return count;

match
$p isa person, has bio $b;
$b like "".{1000,}"";
let $mc = movie_count($p);
$mc > 5;
sort $mc desc;
limit 3;
fetch { ""name"": $p.name, ""bio"": $b, ""movies"": $mc };"
companies,0,List the top 5 organizations where the number of employees is greater than 1000.,"MATCH (o:Organization)
WHERE o.nbrEmployees > 1000
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
sort $o_nbr_employees desc;
limit 5;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,1,Who are the CEOs of the first 3 public companies?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o.name AS company, p.name AS ceo
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public $o_is_public;
  $o has is_public true;
limit 3;
fetch { ""company"": $o.name, ""ceo"": $p.name };"
companies,2,Find the top 5 articles with the highest sentiment score.,"MATCH (a:Article)
RETURN a.title, a.sentiment
ORDER BY a.sentiment DESC
LIMIT 5","match
  $a isa article;
  $a has sentiment $a_sentiment;
sort $a_sentiment desc;
limit 5;
fetch { ""title"": $a.title, ""sentiment"": $a.sentiment };"
companies,3,Which cities are home to organizations that have more than 500 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN DISTINCT c.name AS city","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
fetch { ""city"": $c.city_name };"
companies,4,List the first 3 organizations dissolved and their cities.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isDissolved = true
RETURN o.name AS organization, c.name AS city
LIMIT 3","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has is_dissolved true;
limit 3;
fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,5,Who are the board members of the first 5 organizations listed by revenue in descending order?,"MATCH (o:Organization)
WITH o
ORDER BY o.revenue DESC
LIMIT 5
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,8,List the names of the first 3 organizations that are competitors of 'Accenture'.,"MATCH (a:Organization {name: 'Accenture'})-[:HAS_COMPETITOR]->(c:Organization)
RETURN c.name
LIMIT 3","match
  $o isa organization, has name ""Accenture"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
limit 3;
fetch { ""competitor"": $competitor.name };"
companies,10,What are the names of the first 3 cities that have organizations with more than 100 employees?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.nbrEmployees > 100
RETURN c.name
LIMIT 3","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 100;
limit 3;
fetch { ""city_name"": $c.city_name };"
companies,11,Who are the authors of the first 5 articles that mention any organization headquartered in 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
MATCH (a:Article)-[:MENTIONS]->(o)
WITH a
ORDER BY a.date DESC
LIMIT 5
RETURN a.author AS author","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
sort $a_date desc;
limit 5;
fetch { ""author"": $a.author };"
companies,12,List the names of the first 3 organizations that have subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
RETURN o.name
LIMIT 3","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
limit 3;
fetch { ""name"": $o.name };"
companies,13,List the first 3 organizations mentioned in articles published in 2022.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date >= date(""2022-01-01"") AND a.date < date(""2023-01-01"")
RETURN o.name
LIMIT 3","match
  $a isa article, has date $a_date;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
$a_date < 2023-01-01T00:00:00; limit 3;
fetch { ""name"": $o.name };"
companies,14,Find the top 5 organizations by revenue that are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND NOT o.isDissolved
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization;
  $o has is_dissolved false;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,15,List the top 3 people who are investors in more than one organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) as num_orgs
WHERE num_orgs > 1
RETURN p.name as person, num_orgs as number_of_organizations_invested_in
ORDER BY num_orgs DESC
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
reduce $num_orgs = count($o) groupby $p;
match $num_orgs > 1;
sort $num_orgs desc;
limit 3;
fetch { ""person"": $p.name, ""number_of_organizations_invested_in"": $num_orgs };"
companies,16,Which organizations have a public status and are located in cities within the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  (organization: $o, city: $c) isa located_in;
  $o has is_public $o_is_public;
  $o has is_public true;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,17,Who are the first 3 persons mentioned as CEOs of organizations in the technology industry?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name CONTAINS 'Technology'
RETURN p.name AS name
LIMIT 3","match
  $p isa person;
  $o isa organization;
  $c isa industry_category;
  (organization: $o, ceo: $p) isa ceo_of;
  $c has industry_category_name $c_industry_category_name;
  $c_industry_category_name contains ""Technology"";
  (organization: $o, category: $c) isa in_category;
limit 3;
fetch { ""name"": $p.name };"
companies,18,List the top 3 most recent articles about organizations in the 'Electronic Products Manufacturers' industry.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN a.title AS title, a.date AS date, o.name AS organization
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  (organization: $o, category: $c) isa in_category;
sort $a_date desc;
limit 3;
fetch { ""title"": $a.title, ""date"": $a.date, ""organization"": $o.name };"
companies,19,What are the titles of the first 5 articles that mention organizations in 'Rome'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Rome'})
RETURN a.title
LIMIT 5","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
limit 5;
fetch { ""title"": $a.title };"
companies,20,List the names of the first 3 organizations that have suppliers.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(:Organization)
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $supplier isa organization; (customer: $o, supplier: $supplier) isa supplies;
limit 3;
fetch { ""name"": $o.name };"
companies,21,Which organizations are based in cities that are part of a country with the summary containing 'North America'?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE c.summary CONTAINS 'North America'
RETURN o.name AS organization, c.name AS country","match
  $o isa organization;
  $c isa country;
  $c has country_summary $c_country_summary;
  $c_country_summary contains ""North America"";
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o.name, ""country"": $c.country_name };"
companies,23,List the first 3 organizations that have a revenue greater than $100 million but fewer than 500 employees.,"MATCH (o:Organization)
WHERE o.revenue > 1E8 AND o.nbrEmployees < 500
RETURN o.name, o.revenue, o.nbrEmployees
LIMIT 3","match
  $o isa organization;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees < 500;
limit 3;
fetch { ""name"": $o.name, ""revenue"": $o.revenue, ""nbr_employees"": $o.nbr_employees };"
companies,24,Who are the first 3 board members of organizations that are public?,"MATCH (o:Organization {isPublic: true})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember, o.name AS organization
LIMIT 3","match
  $o isa organization, has is_public true;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
limit 3;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,27,Find the first 3 people who have the role of CEO in more than one organization.,"MATCH (p:Person)-[:HAS_CEO]->(o:Organization)
WITH p, count(o) as num_ceo_roles
WHERE num_ceo_roles > 1
RETURN p.name as person, num_ceo_roles as number_of_ceo_roles
ORDER BY num_ceo_roles DESC
LIMIT 3","match
  $p isa person, has name $n;
  (organization: $o1, ceo: $p) isa ceo_of;
  (organization: $o2, ceo: $p) isa ceo_of;
  $o1 has organization_id $id1;
  $o2 has organization_id $id2;
  $id1 != $id2;
limit 3;
fetch { ""person"": $n };"
companies,30,List the names of the first 3 organizations that have had articles with a sentiment higher than 0.8.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.8
RETURN o.name
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.8;
limit 3;
fetch { ""name"": $o.name };"
companies,31,Which organizations have been mentioned in articles dated before 2020?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date < date(""2020-01-01"")
RETURN DISTINCT o","match
  $a isa article, has date $a_date;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
$a_date < 2020-01-01T00:00:00; fetch { ""o"": $o };"
companies,34,Which people are board members in organizations with more than 1000 employees?,"MATCH (p:Person)<-[:HAS_BOARD_MEMBER]-(o:Organization)
WHERE o.nbrEmployees > 1000
RETURN p.name AS person, o.name AS organization, o.nbrEmployees AS numEmployees","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,35,What are the names of the first 3 organizations and their CEOs where the organization is not public?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.isPublic IS NOT NULL AND NOT o.isPublic
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public false;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,37,Who are the first 3 authors of articles mentioning organizations with revenues over $50 million?,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)
WHERE org.revenue > 5e7
RETURN DISTINCT article.author AS author
LIMIT 3","match
  $article isa article;
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
  $org has revenue $org_revenue;
  $org_revenue > 50000000;
limit 3;
fetch { ""author"": $article.author };"
companies,39,Which organizations have a revenue greater than $50 million and are not dissolved?,"MATCH (o:Organization)
WHERE o.revenue > 5E7 AND o.isDissolved IS NOT NULL AND NOT o.isDissolved
RETURN o","match
  $o isa organization;
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
  $o has is_dissolved false;
fetch { ""o"": $o };"
companies,40,Find all organizations that are public and have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o","match
  $o isa organization, has is_public true;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""o"": $o };"
companies,42,Identify the top 3 articles with the highest sentiment that mention a public organization.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {isPublic: true})
WITH a, o
ORDER BY a.sentiment DESC
LIMIT 3
RETURN a.title AS article, a.sentiment AS sentiment, o.name AS organization","match
  $a isa article;
  $o isa organization, has is_public true;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
sort $a_sentiment desc;
limit 3;
fetch { ""article"": $a.title, ""sentiment"": $a.sentiment, ""organization"": $o.name };"
companies,43,Who are the CEOs of organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization), (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,44,List all organizations with the word 'Energy' in their name and their corresponding industry categories.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE o.name CONTAINS 'Energy'
RETURN o.name AS organization, c.name AS category","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $o has name $o_name;
  $o_name contains ""Energy"";
fetch { ""organization"": $o.name, ""category"": $c.industry_category_name };"
companies,46,Which organizations are competitors of the 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor","match
  $o isa organization, has name ""New Energy Group"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
fetch { ""competitor"": $competitor };"
companies,47,Find the top 3 organizations that have a motto and are located in Seattle.,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
WHERE o.motto IS NOT NULL
RETURN o.name AS organization, o.motto AS motto
ORDER BY o.name
LIMIT 3","match
  $o isa organization;
  $o has motto $o_motto;
  $o has name $o_name;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
sort $o_name desc;
limit 3;
fetch { ""organization"": $o.name, ""motto"": $o.motto };"
companies,48,What articles published in 2022 mention organizations based in Rome?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Rome'})
WHERE a.date.year = 2022
RETURN a.title, a.siteName, a.date, o.name","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date, ""name"": $o.name };"
companies,49,List the names and titles of articles mentioning organizations that have been dissolved.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isDissolved = true
RETURN a.title AS articleTitle, a.summary AS articleSummary","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has is_dissolved true;
fetch { ""articleTitle"": $a.title, ""articleSummary"": $a.article_summary };"
companies,50,Who are the board members of organizations with more than 300 employees?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.nbrEmployees > 300
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 300;
fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,52,Which organizations have an investor named 'David Correa'?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person {name: 'David Correa'})
RETURN o.name AS organization","match
  $o isa organization;
  $p isa person, has name ""David Correa"";
  (investor: $p, organization: $o) isa invested_in;
fetch { ""organization"": $o.name };"
companies,57,Which organizations are public and have more than 300 employees?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 300
RETURN o","match
  $o isa organization;
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 300;
fetch { ""o"": $o };"
companies,58,List the top 5 organizations by revenue that are based in Rome.,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Rome'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization;
  $o has revenue $o_revenue;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,59,What are the names of the organizations dissolved and were founded in Sydney?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Sydney'})
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name","match
  $o isa organization;
  $c isa city, has city_name ""Sydney"";
  (organization: $o, city: $c) isa located_in;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
fetch { ""name"": $o.name };"
companies,61,Who are the CEOs of organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization), (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,62,Which organizations are competitors of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor","match
  $o isa organization, has name ""New Energy Group"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
fetch { ""competitor"": $competitor };"
companies,63,List the cities where organizations with more than 500 employees are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
fetch { ""city_name"": $c.city_name };"
companies,66,Which organizations have a motto and are based in cities in the United States?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
WHERE o.motto IS NOT NULL
RETURN o.name AS organization, o.motto AS motto, c.name AS city","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  (organization: $o, city: $c) isa located_in;
  $o has motto $o_motto;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""motto"": $o.motto, ""city"": $c.city_name };"
companies,68,Which articles published in 2022 mention organizations with more than 100 employees?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date.year = 2022 AND o.nbrEmployees > 100
RETURN a.title, a.siteName, a.date, o.name, o.nbrEmployees","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 100;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date, ""name"": $o.name, ""nbr_employees"": $o.nbr_employees };"
companies,71,List the organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name };"
companies,72,Who are the board members of organizations that have more than 1000 employees?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.nbrEmployees > 1000
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,73,Which organizations have their headquarters in a city that is also the country's capital?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE c.name = country.name
RETURN o.name AS organization, c.name AS capital","match
  $o isa organization;
  $c isa city;
  $country isa country;
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""capital"": $c.city_name };"
companies,74,List the organizations that are mentioned in the most articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentionCount
RETURN o.name AS organization, mentionCount
ORDER BY mentionCount DESC","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
reduce $mentionCount = count($a) groupby $o;
sort $mentionCount desc;
fetch { ""organization"": $o.name, ""mentionCount"": $mentionCount };"
companies,75,Which organizations have a revenue decrease mentioned in any articles?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0 AND exists {
  (a)-[:HAS_CHUNK]->(c:Chunk)
  WHERE c.text CONTAINS 'revenue decrease' OR c.text CONTAINS 'revenue declined'
}
RETURN DISTINCT o.name AS organization","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $c has text $c_text;
  $c_text contains ""revenue decrease"";
fetch { ""organization"": $o.name };"
companies,76,Who are the children of persons who are CEOs of public organizations?,"MATCH (ceo:Person)<-[:HAS_CEO]-(org:Organization {isPublic: true}),
      (ceo)-[:HAS_CHILD]->(child:Person)
RETURN ceo.name AS CEO, org.name AS Organization, child.name AS Child","match
  $ceo isa person;
  $org isa organization, has is_public true;
  $child isa person;
  (organization: $org, ceo: $ceo) isa ceo_of;
(parent: $ceo, child: $child) isa parent_of; fetch { ""CEO"": $ceo.name, ""Organization"": $org.name, ""Child"": $child.name };"
companies,79,List the persons who are both investors and board members in the same organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)<-[:HAS_BOARD_MEMBER]-(p)
RETURN p.name AS person, o.name AS organization","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
(organization: $o, member: $p) isa board_member_of; fetch { ""person"": $p.name, ""organization"": $o.name };"
companies,80,Which organizations have changed their CEO in the last 5 years according to articles?,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)
WHERE article.date > datetime() - duration('P5Y') 
  AND article.title CONTAINS 'CEO'
WITH org, collect(article) as articles
MATCH (org)-[:HAS_CEO]->(ceo:Person)
RETURN org.name as Organization, ceo.name as CEO, 
       [article IN articles | article.title] as RelevantArticles","match
  $article isa article;
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
  $ceo isa person;
  (organization: $org, ceo: $ceo) isa ceo_of;
  $article has title $article_title;
  $article_title contains ""CEO"";
fetch { ""Organization"": $org.name, ""CEO"": $ceo.name };"
companies,82,Which organizations have a parent organization with a higher revenue?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE o.revenue > sub.revenue
RETURN o.name AS ParentOrganization, o.revenue AS ParentRevenue, 
       sub.name AS Subsidiary, sub.revenue AS SubsidiaryRevenue","match
  $o isa organization;
  $sub isa organization;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
$o has revenue $rev1; $sub has revenue $rev2; $rev1 > $rev2; fetch { ""ParentOrganization"": $o.name, ""ParentRevenue"": $o.revenue };"
companies,83,List the top 5 cities by the number of organizations based there.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name AS city, orgCount","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 5;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,84,Which organizations have a CEO who has written an article?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:AUTHOR]-(a:Article)
RETURN o.name AS organization, ceo.name AS ceo, a.title AS article","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,86,Which organizations are involved in legal disputes according to articles?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.summary CONTAINS 'legal' OR a.summary CONTAINS 'lawsuit' OR a.summary CONTAINS 'dispute'
RETURN DISTINCT o.name AS organization","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has article_summary $a_article_summary;
  $a_article_summary contains ""legal"";
fetch { ""organization"": $o.name };"
companies,87,Who are the investors in organizations that have a motto mentioning 'innovation'?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor)
WHERE o.motto IS NOT NULL AND o.motto CONTAINS 'innovation'
RETURN o.name AS organization, investor.name AS investor","match
  $o isa organization;
  (investor: $investor, organization: $o) isa invested_in;
  $o has motto $o_motto;
  $o_motto contains ""innovation"";
fetch { ""organization"": $o.name, ""investor"": $investor.name };"
companies,88,List the organizations that have a subsidiary that was dissolved.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE s.isDissolved = true
RETURN o.name AS organization, s.name AS dissolved_subsidiary","match
  $o isa organization;
  $s isa organization;
  (parent: $o, subsidiary: $s) isa subsidiary_of;
  $s has is_dissolved true;
fetch { ""organization"": $o.name, ""dissolved_subsidiary"": $s.name };"
companies,90,Which CEOs have led an organization for more than 10 years?,"MATCH (p:Person)-[r:HAS_CEO]->(o:Organization)
WHERE duration.between(r.startDate, coalesce(r.endDate, date())).years > 10
RETURN p.name AS ceoName, o.name AS orgName, duration.between(r.startDate, coalesce(r.endDate, date())).years AS yearsAsCEO","match
  $p isa person;
  $o isa organization;
(organization: $o, ceo: $p) isa ceo_of; fetch { ""ceoName"": $p.name, ""orgName"": $o.name };"
companies,91,List articles that mention organizations headquartered in Seattle.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN a.title AS article, o.name AS organization","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,93,List the organizations that have undergone a merger or acquisition according to articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.title CONTAINS 'merger' OR a.title CONTAINS 'acquisition'
RETURN DISTINCT o.name AS organization","match
  $o isa organization, has name $on;
  $a isa article, has title $t;
  (article: $a, mentioned: $o) isa mentions;
  { $t like "".*merger.*""; } or { $t like "".*acquisition.*""; };
fetch { ""organization"": $on };"
companies,96,Which organizations have Julie Spellman Sweet as their CEO?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})<-[:HAS_CEO]-(o:Organization)
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""o"": $o };"
companies,98,What are the names of the first 5 organizations dissolved and publicly traded?,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.isPublic = true
RETURN o.name
LIMIT 5","match
  $o isa organization;
  $o has is_dissolved true;
  $o has is_public true;
limit 5;
fetch { ""name"": $o.name };"
companies,99,Who are the board members of New Energy Group?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember","match
  $o isa organization, has name ""New Energy Group"";
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""boardMember"": $p.name };"
companies,101,What are the industry categories for the first 5 organizations with more than 100 employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 100
WITH o
LIMIT 5
MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory)
RETURN o.name AS organization, c.name AS category","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 100;
limit 5;
fetch { ""organization"": $o.name, ""category"": $c.industry_category_name };"
companies,102,List the countries where the top 5 organizations by revenue are based.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WITH o, c
ORDER BY o.revenue DESC
LIMIT 5
RETURN DISTINCT c.name AS country","match
  $o isa organization;
  $c isa country, has country_name $cn;
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $o has revenue $r;
sort $r desc;
limit 5;
fetch { ""country"": $cn };"
companies,103,What are the top 3 most recent articles mentioning Deja vu Security?,"MATCH (o:Organization {name: 'Deja vu Security'})<-[:MENTIONS]-(a:Article)
RETURN a.title, a.date, a.summary
ORDER BY a.date DESC
LIMIT 3","match
  $o isa organization, has name ""Deja vu Security"";
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""title"": $a.title, ""date"": $a.date, ""article_summary"": $a.article_summary };"
companies,104,Who are the children of Julie Spellman Sweet?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child.name AS name","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $child isa person;
(parent: $p, child: $child) isa parent_of; fetch { ""name"": $child.name };"
companies,105,List the first 3 subsidiaries of Accenture.,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name
LIMIT 3","match
  $o isa organization, has name ""Accenture"";
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
limit 3;
fetch { ""subsidiary"": $subsidiary.name };"
companies,106,What are the first 3 companies that are competitors of New Energy Group?,"MATCH (o:Organization {name: ""New Energy Group""})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name
LIMIT 3","match
  $o isa organization, has name ""New Energy Group"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
limit 3;
fetch { ""name"": $competitor.name };"
companies,107,Which organizations have a sentiment score higher than 0.8 in their latest article?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.8
WITH o, max(a.date) AS latestDate
MATCH (o)<-[:MENTIONS]-(article:Article {date: latestDate})
RETURN o.name AS organization, article.title AS latestArticle, article.sentiment AS sentiment","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $article isa article;
  (article: $article, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.8;
fetch { ""organization"": $o.name, ""latestArticle"": $article.title, ""sentiment"": $article.sentiment };"
companies,110,Which organizations have more than 500 employees and are located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WHERE o.nbrEmployees > 500
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,111,Name 3 organizations mentioned in articles written by David Correa.,"MATCH (a:Article {author: 'David Correa'})-[:HAS_CHUNK]->(c:Chunk), 
      (a)-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article, has author ""David Correa"";
  $c isa chunk;
  $o isa organization;
  (article: $a, chunk: $c) isa has_chunk;
  (article: $a, mentioned: $o) isa mentions;
limit 3;
fetch { ""name"": $o.name };"
companies,112,Which countries are mentioned in the latest 5 articles about organizations in the electronic products industry?,"MATCH (ic:IndustryCategory {name: 'Electronic Products Manufacturers'})<-[:HAS_CATEGORY]-(o:Organization)<-[:MENTIONS]-(a:Article)-[:HAS_CHUNK]->(:Chunk)
WITH a
ORDER BY a.date DESC
LIMIT 5
MATCH (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
RETURN DISTINCT c.name","match
  $ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  $o isa organization;
  $a isa article;
  $c isa country, has country_name $cn;
  $city isa city;
  (organization: $o, category: $ic) isa in_category;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $a has date $d;
sort $d desc;
limit 5;
fetch { ""country_name"": $cn };"
companies,113,Name the first 3 cities in which organizations with more than 1000 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 1000
RETURN c.name
LIMIT 3","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
limit 3;
fetch { ""city_name"": $c.city_name };"
companies,114,Who are the first 3 people mentioned as board members in organizations headquartered in the United States of America?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember
LIMIT 3","match
  $o isa organization;
  $c isa country, has country_name ""United States of America"";
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; limit 3;
fetch { ""boardMember"": $p.name };"
companies,116,What are the names of the first 3 organizations that have the same investor?,"MATCH (o1:Organization)<-[:HAS_INVESTOR]-(investor)-[:HAS_INVESTOR]->(o2:Organization)
WHERE o1 <> o2
WITH investor, collect(o1) + collect(o2) AS orgs
UNWIND orgs AS org
RETURN DISTINCT investor.name AS investor, collect(org.name)[..3] AS organizations
LIMIT 1","match
  $o isa organization;
  $investor isa person;
  (organization: $o, investor: $investor) isa invested_in;
limit 3;
fetch { ""investor"": $investor.name, ""organization"": $o.name };"
companies,117,Which organizations have subsidiaries and are located in Paris?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE (o)-[:IN_CITY]->(:City {name: 'Paris'})
RETURN o","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $city isa city, has city_name ""Paris""; (organization: $o, city: $city) isa located_in;
fetch { ""o"": $o };"
companies,119,Who are the first 3 CEOs of organizations that are dissolved?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isDissolved = true
RETURN p.name AS ceoName, o.name AS orgName
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved true;
limit 3;
fetch { ""ceoName"": $p.name, ""orgName"": $o.name };"
companies,120,Which cities are the headquarters for the top 5 organizations by number of employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees IS NOT NULL
RETURN c.name AS city, o.name AS organization, o.nbrEmployees AS employees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees desc;
limit 5;
fetch { ""city"": $c.city_name, ""organization"": $o.name, ""employees"": $o.nbr_employees };"
companies,121,Name the first 3 organizations that have investments from Julie Spellman Sweet.,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_INVESTOR]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
limit 3;
fetch { ""name"": $o.name };"
companies,122,List the first 3 countries where organizations with a public status are located.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN DISTINCT c.name
LIMIT 3","match
  $o isa organization;
  $c isa country;
  $o has is_public $o_is_public;
  $o has is_public true;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; limit 3;
fetch { ""country_name"": $c.country_name };"
companies,123,What are the names of the first 3 organizations that have been dissolved but still mentioned in recent articles?,"MATCH (o:Organization {isDissolved: true})<-[:MENTIONS]-(a:Article)
WHERE a.date >= datetime() - duration('P1Y')
RETURN o.name
LIMIT 3","match
  $o isa organization, has is_dissolved true;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
limit 3;
fetch { ""name"": $o.name };"
companies,124,Who are the parents of the first 3 persons listed as CEOs in publicly traded companies?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization {isPublic: true})
WITH p
ORDER BY p.name
LIMIT 3
MATCH (parent:Person)<-[:HAS_PARENT]-(p)
RETURN p.name AS CEO, parent.name AS Parent","match
  $p isa person;
  $o isa organization, has is_public true;
  (organization: $o, ceo: $p) isa ceo_of;
  $parent isa person;
  (child: $p, parent: $parent) isa parent_of;
  $p has name $p_name;
sort $p_name asc;
limit 3;
fetch { ""CEO"": $p.name, ""Parent"": $parent.name };"
companies,125,Which organizations are mentioned in articles with a sentiment higher than 0.5 and are based in Belgium?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'Belgium'})
WHERE a.sentiment > 0.5
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  $c isa country, has country_name ""Belgium"";
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.5;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""o"": $o };"
companies,126,Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name };"
companies,129,Identify the first 3 organizations that are public and have more than 1000 employees.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 1000
RETURN o.name, o.nbrEmployees
LIMIT 3","match
  $o isa organization;
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
limit 3;
fetch { ""name"": $o.name, ""nbr_employees"": $o.nbr_employees };"
companies,130,Who are the board members of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember","match
  $o isa organization, has name ""New Energy Group"";
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""boardMember"": $p.name };"
companies,133,Find the top 5 organizations that are competitors of 'Accenture'.,"MATCH (a:Organization {name: 'Accenture'})-[:HAS_COMPETITOR]->(c:Organization)
RETURN c.name AS competitor, c.revenue AS revenue
ORDER BY revenue DESC
LIMIT 5","match
  $a isa organization, has name ""Accenture"";
  $c isa organization;
  (competitor: $a, competitor: $c) isa competes_with;
limit 5;
fetch { ""competitor"": $c.name, ""revenue"": $c.revenue };"
companies,134,What are the names of the first 3 people who are investors in organizations based in 'Seattle'?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN p.name
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
limit 3;
fetch { ""name"": $p.name };"
companies,135,Which articles about 'New Energy Group' were published after 2020-01-01?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'New Energy Group'})
WHERE a.date > date('2020-01-01')
RETURN a.title, a.date, a.siteName, a.summary","match
  $a isa article;
  $o isa organization, has name ""New Energy Group"";
  (article: $a, mentioned: $o) isa mentions;
fetch { ""title"": $a.title, ""date"": $a.date, ""site_name"": $a.site_name, ""article_summary"": $a.article_summary };"
companies,136,Who are the first 3 CEOs of public organizations?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN p.name AS ceoName, o.name AS orgName
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,137,List the first 3 organizations mentioned in articles authored by 'David Correa'.,"MATCH (a:Article {author: 'David Correa'})-[:HAS_CHUNK]->(c:Chunk)
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article, has author ""David Correa"";
  $c isa chunk;
  (article: $a, chunk: $c) isa has_chunk;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
limit 3;
fetch { ""name"": $o.name };"
companies,138,What are the names of the organizations that have 'Icon Integration' as a subsidiary?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization {name: 'Icon Integration'})
RETURN o.name","match
  $o isa organization;
  $s isa organization, has name ""Icon Integration"";
  (parent: $o, subsidiary: $s) isa subsidiary_of;
fetch { ""name"": $o.name };"
companies,140,What are the first 3 organizations that have subsidiaries and more than 500 employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 500 AND EXISTS {
  (o)-[:HAS_SUBSIDIARY]->(:Organization)
}
RETURN o.name AS organization, o.nbrEmployees AS employees
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
sort $o_nbr_employees desc;
limit 3;
fetch { ""organization"": $o.name, ""employees"": $o.nbr_employees };"
companies,141,Who are the first 3 board members of organizations with more than 100 million in revenue?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue > 1E8
RETURN p.name AS boardMember, o.name AS organization
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
limit 3;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,142,Which cities host organizations that are public and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'}),
      (o)-[:IN_CITY]->(c:City)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN DISTINCT c.name","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  $c isa city;
  (organization: $o, ceo: $p) isa ceo_of;
  (organization: $o, city: $c) isa located_in;
  $o has is_public $o_is_public;
  $o has is_public true;
fetch { ""city_name"": $c.city_name };"
companies,145,List the first 3 articles that mention any organization with more than 1000 employees and are written after 2021-01-01.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 1000 AND a.date > date(""2021-01-01"")
RETURN a.title, a.date, o.name
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
limit 3;
fetch { ""title"": $a.title, ""date"": $a.date, ""name"": $o.name };"
companies,146,Who are the children of 'Julie Spellman Sweet' listed as 'Person' nodes?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_CHILD]->(child:Person)
RETURN child.name AS childName","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $child isa person;
(parent: $p, child: $child) isa parent_of; fetch { ""childName"": $child.name };"
companies,147,Find the top 5 parent persons of CEOs of organizations with revenues exceeding 100 million.,"MATCH (p:Person)<-[:HAS_PARENT]-(ceo:Person)<-[:HAS_CEO]-(o:Organization)
WHERE o.revenue > 1E8
RETURN p.name AS parent_name, ceo.name AS ceo_name, o.name AS org_name, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $p isa person, has name $pn;
  $ceo isa person, has name $ceon;
  $o isa organization, has name $on;
  (parent: $p, child: $ceo) isa parent_of;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has revenue $r;
  $r > 100000000;
sort $r desc;
limit 5;
fetch { ""parent_name"": $pn, ""ceo_name"": $ceon, ""org_name"": $on, ""revenue"": $r };"
companies,149,List the first 3 articles that have chunks containing the text 'consumer behavior'.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'consumer behavior'
RETURN a.title, a.siteName, a.date
LIMIT 3","match
  $a isa article;
  $c isa chunk;
  (article: $a, chunk: $c) isa has_chunk;
  $c has text $c_text;
  $c_text contains ""consumer behavior"";
limit 3;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date };"
companies,150,Who are the first 3 investors in 'Accenture' and what other organizations do they invest in?,"MATCH (a:Organization {name: 'Accenture'})<-[:HAS_INVESTOR]-(investor)
WITH investor
LIMIT 3
MATCH (investor)-[:HAS_INVESTOR]->(other:Organization)
RETURN investor.name AS investor, collect(other.name) AS other_investments","match
  $a isa organization, has name ""Accenture"";
  (investor: $investor, organization: $a) isa invested_in;
  $other isa organization;
  (investor: $investor, organization: $other) isa invested_in;
limit 3;
fetch { ""investor"": $investor.name };"
companies,153,List the top 3 CEOs of organizations that are subsidiaries of 'Accenture'.,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY*]->(sub:Organization)
WHERE EXISTS {(sub)-[:HAS_CEO]->(:Person)}
WITH sub, sub.name AS subName
MATCH (sub)-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS ceoName, subName
ORDER BY ceoName
LIMIT 3","match
  $accenture isa organization, has name ""Accenture"";
  $sub isa organization;
  $ceo isa person;
  (organization: $sub, ceo: $ceo) isa ceo_of;
(parent: $accenture, subsidiary: $sub) isa subsidiary_of; limit 3;
fetch { ""ceoName"": $ceo.name };"
companies,156,Find the first 3 organizations that have a public status and are in the 'Technology' industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Technology'})
WHERE o.isPublic = true
RETURN o.name AS organization, o.summary AS summary
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Technology"";
  (organization: $o, category: $c) isa in_category;
  $o has is_public true;
limit 3;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,157,Who are the first 3 competitors of organizations with more than 1 billion in revenue?,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization)
WHERE o.revenue > 1.0E9
RETURN c.name as competitor
LIMIT 3","match
  $o isa organization;
  $c isa organization;
  (competitor: $o, competitor: $c) isa competes_with;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
limit 3;
fetch { ""competitor"": $c.name };"
companies,158,List the first 3 articles that mention 'Seattle' based organizations and have a sentiment score above 0.7.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
WHERE a.sentiment > 0.7
RETURN a.title, a.siteName, a.date
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.7;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
limit 3;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date };"
companies,161,List the first 3 organizations that have the highest revenue and are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND NOT o.isDissolved
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $o has is_dissolved false;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,162,Which organizations have subsidiaries named 'SuccessFactors'?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization {name: 'SuccessFactors'})
RETURN o.name AS organization, sub.name AS subsidiary","match
  $subsidiary isa organization, has name ""SuccessFactors"";
  $o isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
fetch { ""organization"": $o.name, ""subsidiary"": $subsidiary.name };"
companies,164,Which organizations based in 'United States of America' have more than 10000 employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE o.nbrEmployees > 10000
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $c isa country, has country_name ""United States of America"";
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 10000;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,165,List the top 3 organizations that have a CEO and are mentioned in the latest articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE EXISTS {(o)-[:HAS_CEO]->(:Person)}
WITH o, max(a.date) AS latestDate
ORDER BY latestDate DESC
LIMIT 3
RETURN o.name AS organization, latestDate","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
$ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; limit 3;
fetch { ""organization"": $o.name };"
companies,166,Who are the first 3 children of CEOs of organizations with more than 500 million in revenue?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.revenue > 5e8
WITH ceo
MATCH (ceo)-[:HAS_CHILD]->(child:Person)
RETURN child.name
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $child isa person;
  $o has revenue $o_revenue;
  $o_revenue > 500000000;
(parent: $ceo, child: $child) isa parent_of; limit 3;
fetch { ""name"": $child.name };"
companies,167,List the first 3 organizations that have a motto and are public.,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL AND o.isPublic = true
RETURN o.name, o.motto
LIMIT 3","match
  $o isa organization;
  $o has motto $o_motto;
  $o has is_public true;
limit 3;
fetch { ""name"": $o.name, ""motto"": $o.motto };"
companies,168,Which organizations have investors named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_INVESTOR]->(o:Organization)
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
fetch { ""o"": $o };"
companies,169,Find the first 3 organizations that have been mentioned in articles related to 'consumer behavior' and have a sentiment score above 0.6.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'consumer behavior'
  AND a.sentiment > 0.6
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article;
  $c isa chunk;
  (article: $a, chunk: $c) isa has_chunk;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $c has text $c_text;
  $c_text contains ""consumer behavior"";
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.6;
limit 3;
fetch { ""name"": $o.name };"
companies,170,Which organizations are based in 'Seattle' and have a revenue less than 5000000?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WHERE o.revenue < 5000000
RETURN o","match
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  (organization: $o, city: $c) isa located_in;
  $o has revenue $o_revenue;
  $o_revenue < 5000000;
fetch { ""o"": $o };"
companies,174,List the first 3 articles that mention organizations with CEOs named 'Julie Spellman Sweet' and have a sentiment score above 0.75.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE a.sentiment > 0.75
RETURN a.title, a.siteName, a.date
LIMIT 3","match
  $a isa article;
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.75;
(organization: $o, ceo: $p) isa ceo_of; limit 3;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date };"
companies,176,Find the first 3 organizations that have a supplier named 'Icon Integration'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization {name: 'Icon Integration'})
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization;
  $s isa organization, has name ""Icon Integration"";
  (customer: $o, supplier: $s) isa supplies;
limit 3;
fetch { ""organization"": $o.name };"
companies,178,Who are the first 3 board members of organizations based in 'Italy'?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'Italy'})
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember
LIMIT 3","match
  $o isa organization;
  $c isa country, has country_name ""Italy"";
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; limit 3;
fetch { ""boardMember"": $p.name };"
companies,180,Which organizations have more than 1000 employees and are in the 'Finance' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Finance'})
WHERE o.nbrEmployees > 1000
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Finance"";
  (organization: $o, category: $c) isa in_category;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,181,List the first 3 organizations with the highest number of employees that are not public.,"MATCH (o:Organization)
WHERE o.isPublic = false AND o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $o has is_public false;
  $o has nbr_employees $ne;
sort $ne desc;
limit 3;
fetch { ""organization"": $on, ""numberOfEmployees"": $ne };"
companies,182,Which organizations have CEOs named 'Julie Spellman Sweet' and are in the 'Software' industry?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Software'})
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $ic isa industry_category, has industry_category_name ""Software""; (organization: $o, category: $ic) isa in_category;
fetch { ""o"": $o };"
companies,183,Find the first 3 organizations that have been mentioned in articles authored by 'James Blackman'.,"MATCH (a:Article {author: 'James Blackman'})-[:MENTIONS]->(o:Organization)
RETURN o.name AS organization
LIMIT 3","match
  $a isa article, has author ""James Blackman"";
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
limit 3;
fetch { ""organization"": $o.name };"
companies,184,Identify the top 3 cities with the most organizations in the 'Electronic Products Manufacturers' category.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Electronic Products Manufacturers'})
WITH c, count(o) as orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name as city, orgCount as organizationCount","match
  $c isa city;
  $o isa organization;
  $ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, city: $c) isa located_in;
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""city"": $c.city_name, ""organizationCount"": $orgCount };"
companies,185,Who are the first 3 competitors of organizations named 'Accenture'?,"MATCH (o:Organization {name: 'Accenture'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name
LIMIT 3","match
  $o isa organization, has name ""Accenture"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
limit 3;
fetch { ""competitor"": $competitor.name };"
companies,186,List the 3 most recent articles mentioning any organization with a CEO named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(o:Organization)<-[:MENTIONS]-(a:Article)
RETURN a.title AS article, a.date AS published
ORDER BY a.date DESC
LIMIT 3","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  $a isa article;
  (organization: $o, ceo: $p) isa ceo_of;
  $a has date $a_date;
(article: $a, mentioned: $o) isa mentions; sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""published"": $a.date };"
companies,187,Which organizations based in 'Seattle' have a CEO named 'Julie Spellman Sweet' and have a public status?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
WHERE (o)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'}) AND o.isPublic IS NOT NULL
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
  $city isa city, has city_name ""Seattle"";
  (organization: $o, city: $city) isa located_in;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,188,Identify the first 3 organizations that have a CEO and are mentioned in articles with a low sentiment score.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0.5 AND EXISTS {(o)<-[:HAS_CEO]-(:Person)}
RETURN o.name AS organization, a.title AS article, a.sentiment AS sentiment
ORDER BY a.sentiment
LIMIT 3","match
  $o isa organization, has name $on;
  $a isa article, has title $t, has sentiment $s;
  $ceo isa person;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $s < 0.5;
sort $s asc;
limit 3;
fetch { ""organization"": $on, ""article"": $t, ""sentiment"": $s };"
companies,189,Who are the first 3 investors in organizations that have a revenue greater than 500 million?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(i)
WHERE o.revenue > 5e8
RETURN i.name as investor
LIMIT 3","match
  $o isa organization;
  $investor isa person, has name $in;
  (organization: $o, investor: $investor) isa invested_in;
  $o has revenue $r;
  $r > 500000000;
limit 3;
fetch { ""investor"": $in };"
companies,190,List the first 3 organizations with CEOs who have been mentioned in multiple articles.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:MENTIONS]-(a:Article)
WITH o, ceo, count(a) AS mentionCount
WHERE mentionCount > 1
RETURN o.name AS organization, ceo.name AS ceo
ORDER BY mentionCount DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $ceo isa person, has name $ceon;
  $a1 isa article;
  $a2 isa article;
  (organization: $o, ceo: $ceo) isa ceo_of;
  (article: $a1, mentioned: $o) isa mentions;
  (article: $a2, mentioned: $o) isa mentions;
  $a1 has article_id $aid1;
  $a2 has article_id $aid2;
  $aid1 != $aid2;
limit 3;
fetch { ""organization"": $on, ""ceo"": $ceon };"
companies,192,Find the first 3 articles that mention organizations in the 'Healthcare' industry with a high sentiment score.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Healthcare'})
WHERE a.sentiment > 0.5
RETURN a.title, a.sentiment, o.name
ORDER BY a.sentiment DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Healthcare"";
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.5;
  (organization: $o, category: $c) isa in_category;
sort $a_sentiment desc;
limit 3;
fetch { ""title"": $a.title, ""sentiment"": $a.sentiment, ""name"": $o.name };"
companies,193,Identify the top 3 organizations that have a public status and are based in 'Italy'.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'Italy'})
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o.name AS organization, o.summary AS summary
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization, has name $on, has summary $os;
  $c isa country, has country_name ""Italy"";
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $o has is_public true;
  $o has revenue $r;
sort $r desc;
limit 3;
fetch { ""organization"": $on, ""summary"": $os };"
companies,194,List the first 3 organizations with the most board members.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMemberCount
ORDER BY boardMemberCount DESC
LIMIT 3
RETURN o.name AS organization, boardMemberCount","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
reduce $boardMemberCount = count($p) groupby $o;
sort $boardMemberCount desc;
limit 3;
fetch { ""organization"": $o.name, ""boardMemberCount"": $boardMemberCount };"
companies,195,Which organizations have a CEO named 'Julie Spellman Sweet' and are based in 'Italy'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
$country isa country, has country_name ""Italy""; (child: $city, parent: $country) isa location-contains; fetch { ""o"": $o };"
companies,197,Identify the top 3 organizations that have been dissolved and are mentioned in high sentiment articles.,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true
WITH o, avg(a.sentiment) as avgSentiment
ORDER BY avgSentiment DESC
LIMIT 3
RETURN o.name as organization, avgSentiment as avgArticleSentiment","match
  $o isa organization, has name $on;
  $a isa article, has sentiment $s;
  (article: $a, mentioned: $o) isa mentions;
  $o has is_dissolved true;
sort $s desc;
limit 3;
fetch { ""organization"": $on, ""avgArticleSentiment"": $s };"
companies,198,Who are the first 3 CEOs of organizations that have subsidiaries and a revenue above 1 billion?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.revenue > 1e9 AND EXISTS {(o)-[:HAS_SUBSIDIARY]->(:Organization)}
RETURN ceo.name AS ceoName, o.name AS orgName
LIMIT 3","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
limit 3;
fetch { ""ceoName"": $ceo.name, ""orgName"": $o.name };"
companies,200,Which organizations have a revenue above 1 billion and are in the 'Technology' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Technology'})
WHERE o.revenue > 1e9
RETURN o.name AS organization, o.revenue AS revenue","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Technology"";
  (organization: $o, category: $c) isa in_category;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,201,Find the first 3 organizations that have a CEO named 'Julie Spellman Sweet' and are based in 'Seattle'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE (o)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN o
LIMIT 3","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
limit 3;
fetch { ""o"": $o };"
companies,203,Who are the first 3 board members of organizations with revenues less than 5000000?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue < 5000000
RETURN p.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue < 5000000;
limit 3;
fetch { ""name"": $p.name };"
companies,204,List the first 3 organizations that have been mentioned in articles with a sentiment score above 0.9.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o.name
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.9;
limit 3;
fetch { ""name"": $o.name };"
companies,207,Identify the first 3 organizations that have a subsidiary and a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
MATCH (o)-[:HAS_CEO]->(ceo:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $ceo isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $ceo) isa ceo_of;
limit 3;
fetch { ""organization"": $o.name };"
companies,208,Who are the first 3 investors in organizations with less than 50 employees?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor)
WHERE o.nbrEmployees < 50
WITH investor, o
ORDER BY o.nbrEmployees
RETURN DISTINCT investor.name AS investor, o.name AS company
LIMIT 3","match
  $o isa organization;
  (investor: $investor, organization: $o) isa invested_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees < 50;
sort $o_nbr_employees asc;
limit 3;
fetch { ""investor"": $investor.name, ""company"": $o.name };"
companies,210,Which organizations based in 'United States of America' have a revenue less than 10 million?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE o.revenue < 10000000
RETURN o.name AS organization, o.revenue AS revenue","match
  $o isa organization;
  $c isa country, has country_name ""United States of America"";
  $o has revenue $o_revenue;
  $o_revenue < 10000000;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,213,Who are the first 3 competitors of organizations with a CEO named 'Julie Spellman Sweet'?,"MATCH (ceo:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(org:Organization)-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name
LIMIT 3","match
  $ceo isa person, has name ""Julie Spellman Sweet"";
  $org isa organization;
  $competitor isa organization;
  (organization: $org, ceo: $ceo) isa ceo_of;
(competitor: $org, competitor: $competitor) isa competes_with; limit 3;
fetch { ""name"": $competitor.name };"
companies,214,List the first 3 organizations based in 'Italy' that have a CEO and are public.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'Italy'})
WHERE (o)-[:HAS_CEO]->(:Person) AND o.isPublic = true
RETURN o.name AS organization, o.summary AS summary
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
  $country isa country, has country_name ""Italy"";
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $country) isa location-contains;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,217,Identify the top 3 organizations that have more than 100 employees and are subsidiaries of 'Accenture'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY*]->(sub:Organization)
WHERE o.name = 'Accenture' AND sub.nbrEmployees > 100
RETURN sub.name AS subsidiary, sub.nbrEmployees AS numEmployees
ORDER BY numEmployees DESC
LIMIT 3","match
  $o isa organization;
  $sub isa organization;
  $o has name ""Accenture"";
  $sub has nbr_employees $sub_nbr_employees;
  $sub_nbr_employees > 100;
(parent: $o, subsidiary: $sub) isa subsidiary_of; limit 3;
fetch { ""subsidiary"": $sub.name, ""numEmployees"": $sub.nbr_employees };"
companies,218,Who are the first 3 board members of organizations with a CEO named 'Julie Spellman Sweet' and a revenue above 500 million?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person {name: 'Julie Spellman Sweet'})
WHERE o.revenue > 5e8
WITH o
MATCH (o)-[:HAS_BOARD_MEMBER]->(boardMember:Person)
RETURN boardMember.name
LIMIT 3","match
  $o isa organization;
  $ceo isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $ceo) isa ceo_of;
  $boardMember isa person;
  (organization: $o, member: $boardMember) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue > 500000000;
limit 3;
fetch { ""name"": $boardMember.name };"
companies,219,List the first 3 organizations that have a public status and more than 500 employees.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 500
RETURN o.name, o.nbrEmployees
LIMIT 3","match
  $o isa organization;
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
limit 3;
fetch { ""name"": $o.name, ""nbr_employees"": $o.nbr_employees };"
companies,222,Identify the top 3 organizations that have a CEO and more than 1000 employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees > 1000 AND EXISTS {(o)-[:HAS_CEO]->(:Person)}
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has nbr_employees $ne;
  $ne > 1000;
sort $ne desc;
limit 3;
fetch { ""organization"": $on, ""numberOfEmployees"": $ne };"
companies,223,Who are the first 3 CEOs of organizations that have a public status and a revenue above 1 billion?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isPublic = true AND o.revenue > 1e9
RETURN p.name AS ceoName, o.name AS orgName
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
limit 3;
fetch { ""ceoName"": $p.name, ""orgName"": $o.name };"
companies,224,List the first 3 articles mentioning organizations with a CEO named 'Julie Spellman Sweet' and have a sentiment score below 0.5.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0.5
RETURN a
LIMIT 3","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  $a isa article;
  (organization: $o, ceo: $p) isa ceo_of;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0.5;
(article: $a, mentioned: $o) isa mentions; limit 3;
fetch { ""a"": $a };"
companies,225,Which organizations based in 'Seattle' have more than 1000 employees and are public?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
WHERE o.nbrEmployees > 1000 AND o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
  $o has is_public $o_is_public;
  $o has is_public true;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
fetch { ""o"": $o };"
companies,226,Find the first 3 organizations that have a CEO named 'Julie Spellman Sweet' and have a revenue above 1 billion.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE o.revenue > 1e9
RETURN o
LIMIT 3","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
limit 3;
fetch { ""o"": $o };"
companies,228,List the first 3 organizations that have been mentioned in articles with a sentiment score above 0.7 and have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.7 AND EXISTS {
  (o)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.7;
$ceo isa person, has name ""Julie Spellman Sweet""; (organization: $o, ceo: $ceo) isa ceo_of; limit 3;
fetch { ""name"": $o.name };"
companies,229,Which organizations based in 'United States of America' have a public status and more than 1000 employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE o.isPublic = true AND o.nbrEmployees > 1000
RETURN o","match
  $o isa organization;
  $c isa country, has country_name ""United States of America"";
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""o"": $o };"
companies,230,Find the first 3 organizations that have CEOs named 'Julie Spellman Sweet' and are based in 'Seattle'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE (o)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN o
LIMIT 3","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
limit 3;
fetch { ""o"": $o };"
companies,233,Who is the CEO of an organization named 'Accenture'?,"MATCH (o:Organization {name: 'Accenture'})-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS CEO","match
  $o isa organization, has name ""Accenture"";
  $ceo isa person, has name $ceon;
  (organization: $o, ceo: $ceo) isa ceo_of;
fetch { ""CEO"": $ceon };"
companies,234,List the first 3 organizations that have more than 1000 employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees > 1000
RETURN o.name, o.nbrEmployees
LIMIT 3","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
limit 3;
fetch { ""name"": $o.name, ""nbr_employees"": $o.nbr_employees };"
companies,236,Which organizations are public and have a revenue of over 500 million?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.revenue > 5e8
RETURN o.name AS organization, o.revenue AS revenue","match
  $o isa organization;
  $o has is_public true;
  $o has revenue $o_revenue;
  $o_revenue > 500000000;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,237,Who are the board members of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember","match
  $o isa organization, has name ""New Energy Group"";
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""boardMember"": $p.name };"
companies,238,What are the first 3 cities that have organizations with more than 500 employees?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.nbrEmployees > 500
RETURN c.name AS city
ORDER BY c.name
LIMIT 3","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
  $c has city_name $c_city_name;
sort $c_city_name asc;
limit 3;
fetch { ""city"": $c.city_name };"
companies,239,List all the subsidiary companies of 'Accenture'.,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY*]->(subsidiary:Organization)
RETURN subsidiary.name AS subsidiary","match
  $accenture isa organization, has name ""Accenture"";
  $subsidiary isa organization;
(parent: $accenture, subsidiary: $subsidiary) isa subsidiary_of; fetch { ""subsidiary"": $subsidiary.name };"
companies,241,Which organizations have dissolved and are no longer operational?,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name AS organization, o.summary AS summary","match
  $o isa organization;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,242,List the top 5 articles mentioning 'Accenture'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'Accenture'})
RETURN a.title AS article, a.date AS publishedDate
ORDER BY a.date DESC
LIMIT 5","match
  $a isa article;
  $o isa organization, has name ""Accenture"";
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 5;
fetch { ""article"": $a.title, ""publishedDate"": $a.date };"
companies,243,Who are the investors of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_INVESTOR]-(investor)
RETURN investor","match
  $o isa organization, has name ""New Energy Group"";
  $investor isa person, has name $in;
  (organization: $o, investor: $investor) isa invested_in;
fetch { ""investor"": $in };"
companies,245,Which organization has the highest number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 1","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees desc;
limit 1;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,247,How many organizations are there in the 'United States of America'?,"MATCH (c:Country {name: 'United States of America'})<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
RETURN count(o) AS organizationCount","match
  $c isa country, has country_name ""United States of America"";
  $city isa city;
  $o isa organization;
  (child: $city, parent: $c) isa location-contains;
  (organization: $o, city: $city) isa located_in;
reduce $count = count($o);
fetch { ""organizationCount"": $count };"
companies,249,List three persons who are both investors and board members in any organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)<-[:HAS_BOARD_MEMBER]-(p)
RETURN p.name AS person, o.name AS organization
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
(organization: $o, member: $p) isa board_member_of; limit 3;
fetch { ""person"": $p.name, ""organization"": $o.name };"
companies,250,Which organizations are suppliers to 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WHERE o.name = 'Accenture'
RETURN supplier","match
  $o isa organization;
  $supplier isa organization;
  (customer: $o, supplier: $supplier) isa supplies;
  $o has name ""Accenture"";
fetch { ""supplier"": $supplier };"
companies,251,Which cities are these organizations based in that have more than 50 employees but less than 200?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 50 AND o.nbrEmployees < 200
RETURN c.name AS city, collect(o.name) AS organizations","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 50;
  $o_nbr_employees < 200;
fetch { ""city"": $c.city_name };"
companies,252,Which organizations are competitors to 'SAP'?,"MATCH (o:Organization {name: 'SAP'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name AS competitor","match
  $o isa organization, has name ""SAP"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
fetch { ""competitor"": $competitor.name };"
companies,253,List the first 3 organizations that were mentioned in articles published in 2022.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date >= date(""2022-01-01"") AND a.date < date(""2023-01-01"")
RETURN o.name
LIMIT 3","match
  $a isa article, has date $a_date;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
$a_date < 2023-01-01T00:00:00; limit 3;
fetch { ""name"": $o.name };"
companies,254,What is the sentiment of the article that has the highest sentiment score mentioning 'Accenture'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'Accenture'})
RETURN a.title AS article, a.sentiment AS sentiment
ORDER BY a.sentiment DESC
LIMIT 1","match
  $a isa article;
  $o isa organization, has name ""Accenture"";
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
sort $a_sentiment desc;
limit 1;
fetch { ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,256,Which countries host organizations that have a revenue over 50 million?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.revenue > 5e7
RETURN DISTINCT c.name AS country","match
  $o isa organization;
  $c isa country;
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""country"": $c.country_name };"
companies,257,What are the industry categories of organizations located in 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory)
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
fetch { ""industry_category_name"": $c.industry_category_name };"
companies,258,Who wrote the article with the highest sentiment score mentioning 'SAP'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'SAP'})
WITH a
ORDER BY a.sentiment DESC
LIMIT 1
RETURN a.author AS author","match
  $a isa article;
  $o isa organization, has name ""SAP"";
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
sort $a_sentiment desc;
limit 1;
fetch { ""author"": $a.author };"
companies,259,What are the first 3 articles about organizations with a public status?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {isPublic: true})
RETURN a.title AS article, o.name AS organization
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization, has is_public true;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,260,What organizations are headquartered in cities that are in the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,261,Which city has the most organizations with public status?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
WITH c, count(o) AS publicOrgCount
RETURN c.name AS city, publicOrgCount
ORDER BY publicOrgCount DESC
LIMIT 1","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
  $o has is_public $o_is_public;
  $o has is_public true;
reduce $publicOrgCount = count($o) groupby $c;
sort $publicOrgCount desc;
limit 1;
fetch { ""city"": $c.city_name, ""publicOrgCount"": $publicOrgCount };"
companies,262,Who are the children of 'Julie Spellman Sweet'?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_CHILD]->(child:Person)
RETURN child.name AS child","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $child isa person;
(parent: $p, child: $child) isa parent_of; fetch { ""child"": $child.name };"
companies,265,Which organizations are both public and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)
WHERE o.isPublic = true
  AND EXISTS {
    (o)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
  }
RETURN o","match
  $o isa organization;
  $o has is_public true;
$ceo isa person, has name ""Julie Spellman Sweet""; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""o"": $o };"
companies,266,What is the summary description of the organization with the lowest number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.summary AS summary
ORDER BY o.nbrEmployees
LIMIT 1","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees asc;
limit 1;
fetch { ""summary"": $o.summary };"
companies,267,List the top 5 countries by the number of organizations headquartered there.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS numOrgs
ORDER BY numOrgs DESC
LIMIT 5
RETURN c.name AS country, numOrgs","match
  $c isa country;
  $city isa city;
  $o isa organization;
  (child: $city, parent: $c) isa location-contains;
  (organization: $o, city: $city) isa located_in;
reduce $numOrgs = count($o) groupby $c;
sort $numOrgs desc;
limit 5;
fetch { ""country"": $c.country_name, ""numOrgs"": $numOrgs };"
companies,270,List the latest 3 articles mentioning any organization based in 'Rome'.,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Rome'})
MATCH (a:Article)-[:MENTIONS]->(o)
RETURN a.title AS article, a.date AS published
ORDER BY a.date DESC
LIMIT 3","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""published"": $a.date };"
companies,272,Who are the investors of organizations that have been dissolved?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN p.name AS investor, o.name AS dissolved_organization","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
fetch { ""investor"": $p.name, ""dissolved_organization"": $o.name };"
companies,274,List the first 5 articles mentioning organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(o:Organization)<-[:MENTIONS]-(a:Article)
RETURN a.title, a.summary, a.siteName, a.date
LIMIT 5","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  $a isa article;
  (organization: $o, ceo: $p) isa ceo_of;
(article: $a, mentioned: $o) isa mentions; limit 5;
fetch { ""title"": $a.title, ""article_summary"": $a.article_summary, ""site_name"": $a.site_name, ""date"": $a.date };"
companies,275,Which organizations have a city as their headquarters and have a revenue of over 1 million?,"MATCH (o:Organization)-[:IN_CITY]->(c:City) 
WHERE o.revenue > 1E6
RETURN o.name AS organization, c.name AS city, o.revenue AS revenue","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has revenue $o_revenue;
  $o_revenue > 1000000;
fetch { ""organization"": $o.name, ""city"": $c.city_name, ""revenue"": $o.revenue };"
companies,276,List the organizations that have less than 50 employees and are still operational.,"MATCH (o:Organization)
WHERE o.nbrEmployees < 50 AND o.isDissolved IS NOT NULL AND NOT o.isDissolved
RETURN o","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees < 50;
  $o has is_dissolved false;
fetch { ""o"": $o };"
companies,279,Who are the CEOs of the top 5 organizations by revenue?,"MATCH (o:Organization)
WITH o
ORDER BY o.revenue DESC
LIMIT 5
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,280,What are the first 3 organizations that have been mentioned in an article with a sentiment score greater than 0.9?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o.name
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.9;
limit 3;
fetch { ""name"": $o.name };"
companies,282,List the organizations that have the most number of competitors.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization)
WITH o, count(c) AS numCompetitors
ORDER BY numCompetitors DESC
RETURN o.name AS organization, numCompetitors
LIMIT 10","match
  $o isa organization;
  $c isa organization;
  (competitor: $o, competitor: $c) isa competes_with;
reduce $numCompetitors = count($c) groupby $o;
sort $numCompetitors desc;
limit 10;
fetch { ""organization"": $o.name, ""numCompetitors"": $numCompetitors };"
companies,283,Which organizations have a city named 'Seattle' as their headquarters and more than 500 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WHERE o.nbrEmployees > 500
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,286,Who are the top 3 investors in terms of the number of organizations they invest in?,"MATCH (i:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH i, count(o) as num_investments
ORDER BY num_investments DESC
LIMIT 3
RETURN i.name as investor, num_investments","match
  $i isa person;
  $o isa organization;
  (investor: $i, organization: $o) isa invested_in;
reduce $num_investments = count($o) groupby $i;
sort $num_investments desc;
limit 3;
fetch { ""investor"": $i.name, ""num_investments"": $num_investments };"
companies,290,What are the first 5 organizations that are mentioned in articles from 'RCR Wireless News'?,"MATCH (a:Article {siteName: 'RCR Wireless News'})-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 5","match
  $a isa article, has site_name ""RCR Wireless News"";
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
limit 5;
fetch { ""name"": $o.name };"
companies,291,Who are the CEOs of organizations that have been dissolved?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.isDissolved = true
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved true;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,293,What are the first 3 countries with organizations that have more than 1000 employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.nbrEmployees > 1000
RETURN c.name AS country, count(o) AS numOrgs
ORDER BY numOrgs DESC
LIMIT 3","match
  $o isa organization;
  $c isa country, has country_name $cn;
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $o has nbr_employees $ne;
  $ne > 1000;
limit 3;
fetch { ""country"": $cn };"
companies,295,Who are the top 5 CEOs in terms of the revenue of the organizations they lead?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)
WHERE o.revenue IS NOT NULL
RETURN p.name AS ceo, o.name AS company, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $p isa person, has name $pn;
  $o isa organization, has name $on;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has revenue $r;
sort $r desc;
limit 5;
fetch { ""ceo"": $pn, ""company"": $on, ""revenue"": $r };"
companies,297,List the names of 3 organizations that are dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
limit 3;
fetch { ""name"": $o.name };"
companies,298,Which 3 cities have the most organizations based in them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name AS city, orgCount","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,299,What are the names of the first 3 people who are CEOs of public organizations?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization {isPublic: true})
RETURN p.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,304,List the names of 3 organizations that are suppliers to technology companies.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Technology'})
RETURN s.name
LIMIT 3","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
  $ic isa industry_category, has industry_category_name ""Technology""; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $s.name };"
companies,306,Who are the board members of the first 3 organizations with the highest revenue?,"MATCH (o:Organization)
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,307,What are the names of the first 3 organizations that have subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
RETURN o.name
LIMIT 3","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
limit 3;
fetch { ""name"": $o.name };"
companies,308,Which 3 countries have the most cities with organizations based in them?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
RETURN c.name AS country, orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $c isa country;
  $city isa city;
  $o isa organization;
  (child: $city, parent: $c) isa location-contains;
  (organization: $o, city: $city) isa located_in;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""country"": $c.country_name, ""orgCount"": $orgCount };"
companies,309,Name 3 organizations that are competitors in the software industry.,"MATCH (o1:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Software'}),
      (o1)-[:HAS_COMPETITOR]->(o2:Organization)
WHERE o2.name IS NOT NULL
RETURN o1.name AS Org1, o2.name AS Org2
LIMIT 3","match
  $o1 isa organization;
  $o2 isa organization;
  (competitor: $o1, competitor: $o2) isa competes_with;
  $ic isa industry_category, has industry_category_name ""Software"";
  (organization: $o1, category: $ic) isa in_category;
limit 3;
fetch { ""org1"": $o1.name, ""org2"": $o2.name };"
companies,310,List the top 5 articles that mention organizations based in Seattle.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN a.title AS article, o.name AS organization
ORDER BY a.date DESC
LIMIT 5","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
sort $a_date desc;
limit 5;
fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,315,Who are the first 3 CEOs of organizations in the manufacturing industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS CEO, o.name AS Company
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
limit 3;
fetch { ""CEO"": $ceo.name, ""Company"": $o.name };"
companies,317,Which 3 industry categories have the most organizations with public status?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
WITH ic, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN ic.name AS industryCategory, orgCount","match
  $ic isa industry_category;
  $o isa organization;
  (organization: $o, category: $ic) isa in_category;
  $o has is_public $o_is_public;
  $o has is_public true;
reduce $orgCount = count($o) groupby $ic;
sort $orgCount desc;
limit 3;
fetch { ""industryCategory"": $ic.industry_category_name, ""orgCount"": $orgCount };"
companies,318,What are the names of the organizations where the CEOs have the same last name?,"MATCH (o1:Organization)-[:HAS_CEO]->(ceo1:Person),
      (o2:Organization)-[:HAS_CEO]->(ceo2:Person)
WHERE o1 <> o2 AND split(ceo1.name, ' ')[-1] = split(ceo2.name, ' ')[-1]
RETURN o1.name AS org1, o2.name AS org2","match
  $o1 isa organization;
  $ceo1 isa person;
  $o2 isa organization;
  $ceo2 isa person;
  (organization: $o1, ceo: $ceo1) isa ceo_of;
  (organization: $o2, ceo: $ceo2) isa ceo_of;
fetch { ""org1"": $o1.name, ""org2"": $o2.name };"
companies,324,Who are the first 3 children of people who are CEOs of public organizations?,"MATCH (ceo:Person)<-[:HAS_CEO]-(org:Organization {isPublic: true})-[:HAS_SUBSIDIARY*0..3]->(:Organization),
      (ceo)-[:HAS_CHILD]->(child:Person)
RETURN child.name
LIMIT 3","match
  $ceo isa person;
  $org isa organization, has is_public true; $subsidiary isa organization; (parent: $org, subsidiary: $subsidiary) isa subsidiary_of;
  $child isa person;
  (organization: $org, ceo: $ceo) isa ceo_of;
(parent: $ceo, child: $child) isa parent_of; limit 3;
fetch { ""name"": $child.name };"
companies,330,What are the names of the first 3 industry categories that have organizations with revenues over $100 million?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WHERE o.revenue > 1e8
RETURN ic.name
LIMIT 3","match
  $ic isa industry_category;
  $o isa organization;
  (organization: $o, category: $ic) isa in_category;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
limit 3;
fetch { ""industry_category_name"": $ic.industry_category_name };"
companies,333,Which 3 people are mentioned as investors in multiple organizations?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) as num_orgs_invested
WHERE num_orgs_invested > 1
RETURN p.name as person, num_orgs_invested as number_of_organizations_invested_in
ORDER BY num_orgs_invested DESC
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
reduce $num_orgs_invested = count($o) groupby $p;
match $num_orgs_invested > 1;
sort $num_orgs_invested desc;
limit 3;
fetch { ""person"": $p.name, ""number_of_organizations_invested_in"": $num_orgs_invested };"
companies,334,List the names of the first 3 organizations that have a public motto.,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $o has motto $o_motto;
limit 3;
fetch { ""name"": $o.name };"
companies,335,Name the first 3 organizations that have been dissolved but still have active subsidiaries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE o.isDissolved = true AND s.isDissolved IS NULL
RETURN o.name AS organization, collect(s.name) AS subsidiaries
LIMIT 3","match
  $o isa organization;
  $s isa organization;
  (parent: $o, subsidiary: $s) isa subsidiary_of;
  $o has is_dissolved true;
limit 3;
fetch { ""organization"": $o.name };"
companies,337,Which 3 organizations have the most articles mentioning them with a negative sentiment score?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0
WITH o, count(a) as negMentions
ORDER BY negMentions DESC
LIMIT 3
RETURN o.name as organization, negMentions","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0;
reduce $negMentions = count($a) groupby $o;
sort $negMentions desc;
limit 3;
fetch { ""organization"": $o.name, ""negMentions"": $negMentions };"
companies,339,Who are the first 3 people who have both parent and child roles in the database?,"MATCH (p:Person)
WHERE EXISTS {(p)-[:HAS_PARENT]->(:Person)} 
  AND EXISTS {(p)-[:HAS_CHILD]->(:Person)}
RETURN p.name
LIMIT 3","match
  $p isa person;
$parent isa person; $child isa person; (parent: $parent, child: $p) isa parent_of; (parent: $p, child: $child) isa parent_of; limit 3;
fetch { ""name"": $p.name };"
companies,340,Name the first 3 cities that have organizations with revenues exceeding $500 million.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.revenue > 5e8
RETURN c.name
LIMIT 3","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
  $o has revenue $o_revenue;
  $o_revenue > 500000000;
limit 3;
fetch { ""city_name"": $c.city_name };"
companies,343,List the first 3 articles that mention new energy technologies.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'new energy technologies'
RETURN a.title, a.summary, a.date
LIMIT 3","match
  $a isa article;
  $c isa chunk;
  (article: $a, chunk: $c) isa has_chunk;
  $c has text $c_text;
  $c_text contains ""new energy technologies"";
limit 3;
fetch { ""title"": $a.title, ""article_summary"": $a.article_summary, ""date"": $a.date };"
companies,347,Name the first 3 organizations that have been mentioned in articles about cybersecurity.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'cybersecurity'
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article;
  $c isa chunk;
  (article: $a, chunk: $c) isa has_chunk;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $c has text $c_text;
  $c_text contains ""cybersecurity"";
limit 3;
fetch { ""name"": $o.name };"
companies,349,List the names of the first 3 organizations that have a CEO with a PhD.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name CONTAINS 'PhD'
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has name $p_name;
  $p_name contains ""PhD"";
limit 3;
fetch { ""name"": $o.name };"
companies,350,Name the top 3 cities by number of organizations that are involved in environmental technology.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE ic.name CONTAINS 'Environmental'
WITH c, count(o) as orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name as city, orgCount","match
  $c isa city;
  $o isa organization;
  $ic isa industry_category;
  (organization: $o, city: $c) isa located_in;
  $ic has industry_category_name $ic_industry_category_name;
  $ic_industry_category_name contains ""Environmental"";
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,353,Which 3 cities have the most organizations in the food industry?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE ic.name CONTAINS 'Food'
WITH c, count(o) as orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name as city, orgCount","match
  $c isa city;
  $o isa organization;
  $ic isa industry_category;
  (organization: $o, city: $c) isa located_in;
  $ic has industry_category_name $ic_industry_category_name;
  $ic_industry_category_name contains ""Food"";
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,354,List the names of organizations that have a CEO and an investor who are siblings.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person),
      (o)-[:HAS_INVESTOR]->(investor:Person),
      (ceo)-[:HAS_PARENT]->(parent:Person)<-[:HAS_PARENT]-(investor)
WHERE ceo <> investor
RETURN o.name AS organization","match
  $o isa organization, has name $on;
  $ceo isa person;
  $investor isa person;
  $parent isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  (organization: $o, investor: $investor) isa invested_in;
  (parent: $parent, child: $ceo) isa parent_of;
  (parent: $parent, child: $investor) isa parent_of;
  $ceo has person_id $cid;
  $investor has person_id $iid;
  $cid != $iid;
fetch { ""organization"": $on };"
companies,355,Name the first 3 organizations that are headquartered in capital cities and are in the telecommunications industry.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE c.name = country.name
  AND (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Telecommunications'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $c isa city;
  $country isa country;
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains;
  $ic isa industry_category, has industry_category_name ""Telecommunications""; (organization: $o, category: $ic) isa in_category; limit 3;
fetch { ""name"": $o.name };"
companies,359,Which 3 organizations have been involved in the most legal disputes according to articles?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.title CONTAINS 'legal' OR a.title CONTAINS 'lawsuit' OR a.title CONTAINS 'dispute'
WITH o, count(a) AS numMentions
ORDER BY numMentions DESC
LIMIT 3
RETURN o.name AS organization, numMentions","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has title $a_title;
  $a_title contains ""legal"";
reduce $numMentions = count($a) groupby $o;
sort $numMentions desc;
limit 3;
fetch { ""organization"": $o.name, ""numMentions"": $numMentions };"
companies,362,Which 3 organizations have the most articles mentioning them with a sentiment score below 0.3?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0.3
WITH o, count(a) AS negArticleCount
ORDER BY negArticleCount DESC
LIMIT 3
RETURN o.name AS organization, negArticleCount","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0.3;
reduce $negArticleCount = count($a) groupby $o;
sort $negArticleCount desc;
limit 3;
fetch { ""organization"": $o.name, ""negArticleCount"": $negArticleCount };"
companies,364,Name the first 3 organizations that have been involved in mergers in the past 5 years.,"MATCH (o:Organization)
WHERE EXISTS {
  (o)-[:HAS_SUBSIDIARY|HAS_INVESTOR|HAS_SUPPLIER]->(:Organization)
  WHERE o.name IS NOT NULL
}
WITH o
ORDER BY o.name
LIMIT 3
RETURN o.name AS organization","match
  $o isa organization;
  $o has name $o_name;
  $supplier isa organization; (customer: $o, supplier: $supplier) isa supplies;
sort $o_name asc;
limit 3;
fetch { ""organization"": $o.name };"
companies,366,List the names of 3 organizations that have at least one female board member.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE p.name =~ "".*a"" OR p.name =~ "".*e""
WITH o, count(p) AS num_female_board_members
WHERE num_female_board_members > 0
RETURN o.name
LIMIT 3","match
  $o isa organization, has name $on;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
limit 3;
fetch { ""organization"": $on };"
companies,367,Name the top 3 organizations in terms of revenue that are headquartered in countries with developing economies.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE c.name IN ['China', 'India', 'Brazil', 'Russia', 'Mexico', 'Indonesia', 'Turkey']
  AND o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $c isa country, has country_name $cn;
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  { $cn like ""China""; } or { $cn like ""India""; } or { $cn like ""Brazil""; } or { $cn like ""Russia""; } or { $cn like ""Mexico""; } or { $cn like ""Indonesia""; } or { $cn like ""Turkey""; };
  $o has revenue $r;
sort $r desc;
limit 3;
fetch { ""organization"": $on, ""revenue"": $r };"
companies,368,Which 3 organizations have been featured in the most articles about market expansions?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.title CONTAINS 'market expansion'
WITH o, count(a) as articleCount
ORDER BY articleCount DESC
LIMIT 3
RETURN o.name as organization, articleCount","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has title $a_title;
  $a_title contains ""market expansion"";
reduce $articleCount = count($a) groupby $o;
sort $articleCount desc;
limit 3;
fetch { ""organization"": $o.name, ""articleCount"": $articleCount };"
companies,369,List the first 3 articles that mention organizations with a significant number of layoffs in the past year.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees IS NOT NULL
  AND exists {
    (o)-[:HAS_SUBSIDIARY*]->(sub:Organization)
    WHERE sub.nbrEmployees < o.nbrEmployees * 0.9
  }
RETURN a.title, a.summary, a.date
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""title"": $a.title, ""article_summary"": $a.article_summary, ""date"": $a.date };"
companies,370,Name the first 3 organizations that have a CEO who has authored a book on leadership.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (ceo)-[:HAS_AUTHORED]->(:Book)-[:HAS_CATEGORY]->(:Category {name: 'Leadership'})
}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $ic isa industry_category; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,371,Name the first 3 organizations that have a CEO who has authored a book on leadership.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (ceo)-[:HAS_AUTHORED]->(:Book)-[:HAS_CATEGORY]->(:Category {name: 'Leadership'})
}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $ic isa industry_category; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,372,Name the first 3 organizations that have a CEO who has authored a book on leadership.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (ceo)-[:HAS_AUTHORED]->(:Book)-[:HAS_CATEGORY]->(:Category {name: 'Leadership'})
}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $ic isa industry_category; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,374,List the names of the first 3 organizations that have a public commitment to diversity and inclusion.,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'diversity' OR o.summary CONTAINS 'inclusion'
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $o has summary $o_summary;
  $o_summary contains ""diversity"";
limit 3;
fetch { ""name"": $o.name };"
companies,376,Which 3 organizations have a CEO who has won international business awards?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE ceo.summary CONTAINS 'award'
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,377,Name the first 3 organizations that have a parent company with a revenue over $1 billion.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE o.revenue > 1e9
RETURN sub.name
LIMIT 3","match
  $o isa organization;
  $sub isa organization;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
limit 3;
fetch { ""name"": $sub.name };"
companies,378,Which 3 countries have the highest number of organizations involved in the energy sector?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE ic.name CONTAINS 'Energy'
WITH c, count(o) as orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN c.name as country, orgCount","match
  $c isa country;
  $city isa city;
  $o isa organization;
  $ic isa industry_category;
  (child: $city, parent: $c) isa location-contains;
  (organization: $o, category: $ic) isa in_category;
  $ic has industry_category_name $ic_industry_category_name;
  $ic_industry_category_name contains ""Energy"";
  (organization: $o, city: $city) isa located_in;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""country"": $c.country_name, ""orgCount"": $orgCount };"
companies,379,List the names of the first 3 articles that discuss changes in corporate governance.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'corporate governance'
RETURN a.title
LIMIT 3","match
  $a isa article, has title $t;
  $c isa chunk, has text $txt;
  (article: $a, chunk: $c) isa has_chunk;
  $txt like "".*corporate governance.*"";
limit 3;
fetch { ""title"": $t };"
companies,380,Name the first 3 organizations that are involved in more than one industry category and have subsidiaries in at least two different countries.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(distinct c) as categoryCount
WHERE categoryCount > 1
MATCH (o)-[:HAS_SUBSIDIARY*]->(sub:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country:Country) 
WITH o, collect(distinct country.name) as countries
WHERE size(countries) >= 2
RETURN o.name as organization
LIMIT 3","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $sub isa organization;
  $country isa country;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $country) isa location-contains; (parent: $o, subsidiary: $sub) isa subsidiary_of; limit 3;
fetch { ""organization"": $o.name };"
companies,381,List the names of the first 3 organizations that have announced significant technological breakthroughs in the past year.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date > datetime() - duration('P1Y') AND a.summary CONTAINS 'technological breakthrough'
RETURN o.name
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has article_summary $a_article_summary;
  $a_article_summary contains ""technological breakthrough"";
limit 3;
fetch { ""name"": $o.name };"
companies,383,List the names of 3 organizations that have a CEO who has been featured in a major business magazine.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:MENTIONS]-(a:Article)
WHERE a.siteName IN ['Forbes', 'Bloomberg', 'Wall Street Journal', 'Financial Times', 'Fortune', 'The Economist', 'Harvard Business Review']
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  $a isa article;
  (organization: $o, ceo: $ceo) isa ceo_of;
(article: $a, mentioned: $o) isa mentions; limit 3;
fetch { ""name"": $o.name };"
companies,384,Name the first 3 organizations that have been involved in a public scandal according to articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
WITH o, count(a) as negativeMentions
ORDER BY negativeMentions DESC
LIMIT 3
RETURN o.name as organization","match
  $article isa article;
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
  $org has revenue $org_revenue;
  $org_revenue > 500000000;
limit 3;
fetch { ""title"": $article.title, ""article_summary"": $article.article_summary, ""date"": $article.date };"
companies,386,List the names of the first 3 organizations that have a significant influence in the media industry.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name CONTAINS 'Media'
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $c has industry_category_name $c_industry_category_name;
  $c_industry_category_name contains ""Media"";
limit 3;
fetch { ""name"": $o.name };"
companies,388,Which 3 organizations have been consistently mentioned in articles about corporate social responsibility?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.title CONTAINS 'corporate social responsibility'
WITH o, count(a) as mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name as organization, mentions","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has title $a_title;
  $a_title contains ""corporate social responsibility"";
reduce $mentions = count($a) groupby $o;
sort $mentions desc;
limit 3;
fetch { ""organization"": $o.name, ""mentions"": $mentions };"
companies,389,List the names of the first 3 organizations that have a CEO who is also a significant philanthropist.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'philanthropist'
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,390,Name the first 3 organizations that have a board member who has been a government advisor.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE EXISTS {(p)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Government Advisors'})}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $ic isa industry_category, has industry_category_name ""Government Advisors""; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,394,What are the names of organizations that have a revenue greater than 100 million?,"MATCH (o:Organization)
WHERE o.revenue > 1E8
RETURN o.name","match
  $o isa organization;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
fetch { ""name"": $o.name };"
companies,395,List the names of persons who are CEOs of organizations with more than 500 employees.,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)
WHERE o.nbrEmployees > 500
RETURN p.name","match
  $p isa person;
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
fetch { ""name"": $p.name };"
companies,396,Which organizations are public and are based in cities within the United States of America?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  (organization: $o, city: $c) isa located_in;
  $o has is_public $o_is_public;
  $o has is_public true;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,397,Identify organizations that have been dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o","match
  $o isa organization;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
fetch { ""o"": $o };"
companies,399,Which cities have more than 10 organizations based in them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
WHERE orgCount > 10
RETURN c.name AS city, orgCount","match
  $o isa organization;
  $o has is_public true;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
limit 3;
fetch { ""name"": $o.name, ""summary"": $o.summary };"
companies,400,List all organizations that have subsidiaries.,"MATCH (o:Organization)
WHERE EXISTS {
  (o)-[:HAS_SUBSIDIARY]->(:Organization)
}
RETURN o","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
fetch { ""o"": $o };"
companies,401,Name persons who are board members of more than three organizations.,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WITH p, count(o) as num_orgs
WHERE num_orgs > 3
RETURN p.name as person_name, num_orgs as number_of_organizations","match
  $p isa person, has name $pn;
  $o1 isa organization;
  $o2 isa organization;
  $o3 isa organization;
  $o4 isa organization;
  (organization: $o1, member: $p) isa board_member_of;
  (organization: $o2, member: $p) isa board_member_of;
  (organization: $o3, member: $p) isa board_member_of;
  (organization: $o4, member: $p) isa board_member_of;
  $o1 has organization_id $id1;
  $o2 has organization_id $id2;
  $o3 has organization_id $id3;
  $o4 has organization_id $id4;
  $id1 != $id2;
  $id1 != $id3;
  $id1 != $id4;
  $id2 != $id3;
  $id2 != $id4;
  $id3 != $id4;
fetch { ""person_name"": $pn };"
companies,402,Which organizations have competitors also based in the same country?,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization),
       (o1)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country),
       (o2)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c)
RETURN o1.name AS organization, o2.name AS competitor, c.name AS country","match
  $o1 isa organization;
  $o2 isa organization;
  $c isa country;
  (competitor: $o1, competitor: $o2) isa competes_with;
  $city isa city; (organization: $o1, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o1.name, ""competitor"": $o2.name, ""country"": $c.country_name };"
companies,403,What are the names of organizations with suppliers that have a revenue above 50 million?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WHERE s.revenue > 5e7
RETURN o.name","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
  $s has revenue $s_revenue;
  $s_revenue > 50000000;
fetch { ""name"": $o.name };"
companies,405,What are the names of cities that host organizations with a public status?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN DISTINCT c.name","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
  $o has is_public $o_is_public;
  $o has is_public true;
fetch { ""city_name"": $c.city_name };"
companies,406,Name articles authored by 'David Correa' that mention any technology companies.,"MATCH (a:Article {author: 'David Correa'})-[:HAS_CHUNK]->(c:Chunk), 
      (a)-[:MENTIONS]->(o:Organization)
WHERE EXISTS {(o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Technology'})}
RETURN a.title, a.siteName, a.date, o.name","match
  $a isa article, has author ""David Correa"";
  $c isa chunk;
  $o isa organization;
  (article: $a, chunk: $c) isa has_chunk;
  (article: $a, mentioned: $o) isa mentions;
  $ic isa industry_category, has industry_category_name ""Technology""; (organization: $o, category: $ic) isa in_category;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date, ""name"": $o.name };"
companies,407,Which organizations are mentioned in articles published after 2020?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization) WHERE a.date > date(""2020-01-01"") RETURN DISTINCT o","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
reduce $mentionCount = count($a) groupby $o;
limit 3;
fetch { ""organization"": $o.name, ""mentionCount"": $mentionCount };"
companies,408,What is the summary of the country where 'Seattle' is located?,"MATCH (c:City {name: 'Seattle'})-[:IN_COUNTRY]->(country:Country)
RETURN country.summary","match
  $c isa city, has city_name ""Seattle"";
  $country isa country;
  (child: $c, parent: $country) isa location-contains;
fetch { ""country_summary"": $country.country_summary };"
companies,411,What are the names of organizations that have at least one investor but no subsidiaries?,"MATCH (o:Organization)
WHERE exists((o)<-[:HAS_INVESTOR]-()) 
  AND NOT exists((o)-[:HAS_SUBSIDIARY]->())
RETURN o.name","match
  $o isa organization, has name $on;
  $investor isa person;
  (organization: $o, investor: $investor) isa invested_in;
  not { (parent: $o, subsidiary: $sub) isa subsidiary_of; $sub isa organization; };
fetch { ""organization"": $on };"
companies,413,Which organizations are both suppliers and competitors to other organizations?,"MATCH (o1:Organization)-[:HAS_SUPPLIER]->(o2:Organization) WHERE (o1)-[:HAS_COMPETITOR]->(o2) RETURN o1.name AS org1, o2.name AS org2","match $o1 isa organization; $o2 isa organization; (customer: $o1, supplier: $o2) isa supplies; (competitor: $o1, competitor: $o2) isa competes_with; fetch { ""org1"": $o1.name, ""org2"": $o2.name };"
companies,421,What are the names of organizations that have at least three categories associated with them?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS categoryCount
WHERE categoryCount >= 3
RETURN o.name AS organization","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
reduce $categoryCount = count($c) groupby $o;
match $categoryCount >= 3;
fetch { ""organization"": $o.name };"
companies,426,Identify organizations that have more than 3 board members.,MATCH (o:Organization) WHERE size([(o)-[:HAS_BOARD_MEMBER]->(:Person) | 1]) > 3 RETURN o,"match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
limit 3;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,428,Which persons are investors in organizations that have a revenue over 100 million?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization) WHERE o.revenue > 1E8 RETURN p.name AS investor, o.name AS organization, o.revenue AS revenue","match
  $o isa organization;
  $investor isa person;
  (organization: $o, investor: $investor) isa invested_in;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
fetch { ""investor"": $investor.name, ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,430,Name the cities that are mentioned in articles about organizations in the 'Software' industry.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Software'}),
      (a)-[:HAS_CHUNK]->(ch:Chunk),
      (city:City)<-[:IN_CITY]-(o)
WHERE ch.text CONTAINS city.name
RETURN DISTINCT city.name","match
  $a isa article;
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Software"";
  $ch isa chunk;
  $city isa city;
  (article: $a, mentioned: $o) isa mentions;
  (article: $a, chunk: $ch) isa has_chunk;
  (organization: $o, city: $city) isa located_in;
  (organization: $o, category: $c) isa in_category;
fetch { ""city_name"": $city.city_name };"
companies,431,What is the revenue of the subsidiaries of 'Accenture'?,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY*]->(subsidiary:Organization) WHERE subsidiary.revenue IS NOT NULL RETURN subsidiary.name AS subsidiary, subsidiary.revenue AS revenue","match
  $o isa organization, has name ""Accenture"";
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $subsidiary has revenue $sub_revenue;
fetch { ""subsidiary"": $subsidiary.name, ""revenue"": $subsidiary.revenue };"
companies,433,Which organizations have a board member named 'David Correa'?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person {name: 'David Correa'})
RETURN o.name AS organization","match
  $p isa person, has name ""David Correa"";
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""boardMember"": $p.name };"
companies,434,Name the top 3 organizations by revenue within the 'Financial Services' category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Financial Services'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $c isa country, has country_name ""United States of America"";
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""o"": $o };"
companies,436,Which organizations have a CEO who has written an article?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:AUTHOR]-(a:Article) RETURN o.name AS organization, ceo.name AS ceo, a.title AS article","match $o isa organization; $ceo isa person; $a isa article; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""article"": $a.title };"
companies,437,Identify the organizations where 'Julie Spellman Sweet' is a board member.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_BOARD_MEMBER]-(o:Organization)
RETURN o.name AS organization","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""organization"": $o.name };"
companies,438,What are the names of organizations that have been competitors for more than 10 years?,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization) WHERE exists { ... duration > 10 years } RETURN o1.name AS org1, o2.name AS org2","match $o1 isa organization; $o2 isa organization; (competitor: $o1, competitor: $o2) isa competes_with; fetch { ""org1"": $o1.name, ""org2"": $o2.name };"
companies,440,Name the organizations that are headquartered in cities known for their technology industry.,"MATCH (o:Organization)-[:IN_CITY]->(c:City) WHERE c.name IN ['San Francisco', 'Seattle', ...] RETURN o.name AS organization, c.name AS city","match $o isa organization; $c isa city; (organization: $o, city: $c) isa located_in; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,442,Which organizations have the most suppliers?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WITH o, count(s) as supplierCount
RETURN o.name as organization, supplierCount
ORDER BY supplierCount DESC
LIMIT 10","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
reduce $supplierCount = count($s) groupby $o;
sort $supplierCount desc;
limit 10;
fetch { ""organization"": $o.name, ""supplierCount"": $supplierCount };"
companies,443,Name the CEOs of the top 5 organizations by number of employees.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.nbrEmployees IS NOT NULL
RETURN ceo.name AS ceoName, o.name AS orgName, o.nbrEmployees AS numEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees desc;
limit 5;
fetch { ""ceoName"": $ceo.name, ""orgName"": $o.name, ""numEmployees"": $o.nbr_employees };"
companies,444,Identify the organizations that have been dissolved but still mentioned in recent articles.,"MATCH (o:Organization {isDissolved: true})<-[:MENTIONS]-(a:Article) WHERE a.date >= datetime() - duration('P1Y') RETURN o.name AS organization, a.title AS article, a.date ORDER BY a.date DESC","match $o isa organization, has is_dissolved true; $a isa article; (article: $a, mentioned: $o) isa mentions; $a has date $a_date; sort $a_date desc; fetch { ""organization"": $o.name, ""article"": $a.title, ""date"": $a.date };"
companies,445,List the board members of organizations in the 'Healthcare' industry.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Healthcare'})
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Healthcare"";
  (organization: $o, category: $c) isa in_category;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,446,Which countries have the most cities with public organizations?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
WITH c, count(city) AS numCities
RETURN c.name AS country, numCities
ORDER BY numCities DESC
LIMIT 10","match
  $c isa country;
  $city isa city;
  $o isa organization;
  (child: $city, parent: $c) isa location-contains;
  $o has is_public $o_is_public;
  $o has is_public true;
  (organization: $o, city: $city) isa located_in;
reduce $numCities = count($city) groupby $c;
sort $numCities desc;
limit 10;
fetch { ""country"": $c.country_name, ""numCities"": $numCities };"
companies,449,Name the industry categories for organizations that have been mentioned in articles about environmental issues.,MATCH (article:Article)-[:HAS_CHUNK]->(chunk:Chunk) WHERE toLower(chunk.text) CONTAINS 'environment' ... RETURN DISTINCT category.name,"match $article isa article; $chunk isa chunk; (article: $article, chunk: $chunk) isa has_chunk; $org isa organization; $category isa industry_category; (article: $article, mentioned: $org) isa mentions; fetch { ""industry_category_name"": $category.industry_category_name };"
companies,450,Which organizations have a CEO who is also an investor in other organizations?,"MATCH (ceo:Person)<-[:HAS_CEO]-(org:Organization)-[:HAS_INVESTOR]->(investedOrg:Organization) WHERE (ceo)-[:HAS_INVESTOR]->(investedOrg) RETURN org.name AS organization, ceo.name AS ceo, investedOrg.name AS investedOrganization","match $ceo isa person; $org isa organization; $investedOrg isa organization; (organization: $org, ceo: $ceo) isa ceo_of; (organization: $org, investor: $ceo) isa invested_in; fetch { ""organization"": $org.name, ""ceo"": $ceo.name, ""investedOrganization"": $investedOrg.name };"
companies,451,List the organizations that have both a high revenue and a high number of employees.,"MATCH (o:Organization) WHERE o.revenue > 1E8 AND o.nbrEmployees > 1000 ... ORDER BY o.revenue DESC, o.nbrEmployees DESC","match $o isa organization; $o has revenue $o_revenue; $o has nbr_employees $o_nbr_employees; $o_revenue > 100000000; $o_nbr_employees > 1000; sort $o_revenue desc; fetch { ""organization"": $o.name, ""revenue"": $o.revenue, ""employees"": $o.nbr_employees };"
companies,455,Which organizations have been mentioned in articles with a sentiment score lower than 0.5?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0.5;
fetch { ""o"": $o };"
companies,456,List the organizations that have more than one category associated with them.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS categoryCount
WHERE categoryCount > 1
RETURN o.name AS organization, categoryCount","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
reduce $categoryCount = count($c) groupby $o;
match $categoryCount > 1;
fetch { ""organization"": $o.name, ""categoryCount"": $categoryCount };"
companies,457,Which organizations are based in the same city as 'Accenture'?,MATCH (accenture:Organization {name: 'Accenture'})-[:IN_CITY]->(city:City)<-[:IN_CITY]-(other:Organization) WHERE other <> accenture RETURN other.name AS organization,"match $accenture isa organization, has name ""Accenture""; $city isa city; $other isa organization; (organization: $accenture, city: $city) isa located_in; fetch { ""organization"": $other.name };"
companies,458,Identify the organizations that are both public and have more than 1000 employees.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 1000
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,459,List the articles that mention organizations with the most employees.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees IS NOT NULL
WITH a, o
ORDER BY o.nbrEmployees DESC
RETURN a.title AS article, o.name AS organization, o.nbrEmployees AS employees
LIMIT 10","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees desc;
limit 10;
fetch { ""article"": $a.title, ""organization"": $o.name, ""employees"": $o.nbr_employees };"
companies,460,Which organizations have a board member who is a CEO of a competitor organization?,"MATCH (o1:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)<-[:HAS_CEO]-(o2:Organization), (o1)-[:HAS_COMPETITOR]->(o2) RETURN ...","match $o1 isa organization; $p isa person; $o2 isa organization; (organization: $o1, member: $p) isa board_member_of; (competitor: $o1, competitor: $o2) isa competes_with; (organization: $o1, ceo: $p) isa ceo_of; fetch { ""Organization"": $o1.name, ""BoardMember"": $p.name, ""CompetitorWithBoardMemberAsCEO"": $o2.name };"
companies,461,Name the top 3 organizations by revenue in the 'Technology' category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Technology'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Technology"";
  (organization: $o, category: $c) isa in_category;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,462,List the organizations that have the most negative sentiment articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article) WITH o, avg(a.sentiment) AS avgSentiment ORDER BY avgSentiment ASC LIMIT 10 RETURN o.name AS organization, avgSentiment","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
limit 3;
fetch { ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,463,Identify the organizations that have been mentioned in articles about innovation.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'innovation'
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN DISTINCT o","match
  $a isa article;
  $c isa chunk;
  (article: $a, chunk: $c) isa has_chunk;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $c has text $c_text;
  $c_text contains ""innovation"";
fetch { ""o"": $o };"
companies,464,List the organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name };"
companies,465,Which organizations are based in a country other than their CEO's nationality?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person),
      (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country:Country),
      (ceo)-[:HAS_PARENT*0..]->(parent:Person)
WHERE parent.name IS NOT NULL
  AND NOT EXISTS {
    (parent)-[:HAS_PARENT*0..]->(:Person)-[:HAS_CHILD*0..]->(ceoNationality:Person)
    WHERE (ceoNationality)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country)
  }
RETURN o.name AS organization, ceo.name AS ceo, country.name AS country","match
  $o isa organization;
  $ceo isa person;
  $country isa country;
  $parent isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $country) isa location-contains; (parent: $ceo, child: $parent) isa parent_of; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""country"": $country.country_name };"
companies,470,List the organizations that have a subsidiary and a supplier in the same country.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization), (o)-[:HAS_SUPPLIER]->(sup:Organization), (sub)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country), (sup)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c) RETURN o.name AS organization, c.name AS country","match $o isa organization; $sub isa organization; $sup isa organization; $c isa country; (parent: $o, subsidiary: $sub) isa subsidiary_of; (customer: $o, supplier: $sup) isa supplies; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o.name, ""country"": $c.country_name };"
companies,471,Identify the organizations that have been mentioned in the most articles about technology.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article) WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Technology'}) WITH o, count(a) as mentionCount ORDER BY mentionCount DESC RETURN o.name as organization, mentionCount LIMIT 10","match $o isa organization; $a isa article; (article: $a, mentioned: $o) isa mentions; $ic isa industry_category, has industry_category_name ""Technology""; (organization: $o, category: $ic) isa in_category; reduce $mentionCount = count($a) groupby $o; sort $mentionCount desc; limit 10; fetch { ""organization"": $o.name, ""mentionCount"": $mentionCount };"
companies,473,List the top 5 organizations by number of articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article) RETURN o.name AS organization, count(a) AS mentions ORDER BY mentions DESC LIMIT 5","match $o isa organization, has name $n; $a isa article; (article: $a, mentioned: $o) isa mentions; reduce $mentions = count($a) groupby $o; match $o has name $n; sort $mentions desc; limit 5; fetch { ""organization"": $n, ""mentions"": $mentions };"
companies,474,Which organizations have been mentioned in articles about corporate social responsibility?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)
WHERE c.text CONTAINS 'corporate social responsibility'
RETURN DISTINCT o.name AS organization","match
  $a isa article;
  $c isa chunk;
  $o isa organization;
  (article: $a, chunk: $c) isa has_chunk;
  (article: $a, mentioned: $o) isa mentions;
  $c has text $c_text;
  $c_text contains ""corporate social responsibility"";
fetch { ""organization"": $o.name };"
companies,478,Who are the CEOs of the top 3 public organizations by number of employees?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.isPublic = true AND o.nbrEmployees IS NOT NULL
WITH o, ceo
ORDER BY o.nbrEmployees DESC
LIMIT 3
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees desc;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,479,Identify the first 3 industries mentioned in articles written by David Correa.,MATCH (a:Article {author: 'David Correa'})-[:HAS_CHUNK]->(c:Chunk) MATCH (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory) RETURN ic.name AS industry ORDER BY a.date DESC LIMIT 3,"match
  $a isa article, has author ""David Correa"";
  $o isa organization;
  $ic isa industry_category, has industry_category_name $icn;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, category: $ic) isa in_category;
  $a has date $d;
sort $d desc;
limit 3;
fetch { ""industry"": $icn };"
companies,483,Who are the top 3 investors in the tech industry?,"MATCH (i:Person)-[:HAS_INVESTOR]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name CONTAINS 'Tech'
WITH i, count(o) as investments
ORDER BY investments DESC
LIMIT 3
RETURN i.name as investor, investments","match
  $i isa person;
  $o isa organization;
  $c isa industry_category;
  (investor: $i, organization: $o) isa invested_in;
  $c has industry_category_name $c_industry_category_name;
  $c_industry_category_name contains ""Tech"";
  (organization: $o, category: $c) isa in_category;
reduce $investments = count($o) groupby $i;
sort $investments desc;
limit 3;
fetch { ""investor"": $i.name, ""investments"": $investments };"
companies,484,Which organizations have SAP as a competitor?,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization {name: 'SAP'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa organization, has name ""SAP"";
  (competitor: $o, competitor: $c) isa competes_with;
fetch { ""organization"": $o.name };"
companies,485,List the first 3 organizations categorized under 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
limit 3;
fetch { ""organization"": $o.name };"
companies,486,What are the first 5 articles that mention organizations based in the United States?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'}) RETURN a.title AS article, o.name AS organization ORDER BY a.date DESC LIMIT 5","match $a isa article; $o isa organization; $co isa country, has country_name ""United States of America""; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $co) isa location-contains; (article: $a, mentioned: $o) isa mentions; $a has date $a_date; sort $a_date desc; limit 5; fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,487,What are the names of the first 3 organizations that have subsidiaries?,MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization) RETURN o.name LIMIT 3,"match
  $o isa organization;
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
limit 3;
fetch { ""organization"": $o.name };"
companies,490,What are the names of the first 3 organizations that have ceased operations but are still mentioned in recent articles?,"MATCH (o:Organization)-[:MENTIONS]-(a:Article)
WHERE o.isDissolved = true
WITH o, a
ORDER BY a.date DESC
RETURN o.name
LIMIT 3","match
  $o isa organization, has name $on;
  $a isa article, has date $d;
  (article: $a, mentioned: $o) isa mentions;
  $o has is_dissolved true;
sort $d desc;
limit 3;
fetch { ""organization"": $on };"
companies,491,List the top 5 organizations by number of employees that are located in a country with 'America' in its name.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE c.name CONTAINS 'America' RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees ORDER BY o.nbrEmployees DESC LIMIT 5","match $o isa organization; $co isa country; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $co) isa location-contains; $co has country_name $c_country_name; $c_country_name contains ""America""; $o has nbr_employees $o_nbr_employees; sort $o_nbr_employees desc; limit 5; fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,495,Which organizations have been mentioned in articles with a sentiment score above 0.9?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN DISTINCT o.name AS organization","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.9;
fetch { ""organization"": $o.name };"
companies,498,What are the names of the first 3 organizations mentioned in articles published on MrWeb?,"MATCH (article:Article {siteName: 'MrWeb'})-[:MENTIONS]->(org:Organization)
RETURN org.name
LIMIT 3","match
  $article isa article, has site_name ""MrWeb"";
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
limit 3;
fetch { ""name"": $org.name };"
companies,499,Which organizations are based in a city that is also a county seat?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $c has city_summary $c_city_summary;
  $c_city_summary contains ""county seat"";
fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,502,What are the names of the first 3 organizations that have a CEO named Julie Spellman Sweet?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
limit 3;
fetch { ""name"": $o.name };"
companies,503,Who are the first 3 board members of organizations that have a revenue of over 1 million?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person) WHERE o.revenue > 1e6 RETURN p.name AS boardMember, o.name AS organization LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue > 1000000;
limit 3;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,504,Which organizations are mentioned in the most recent 5 articles by date?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WITH o, max(a.date) AS maxDate
ORDER BY maxDate DESC
LIMIT 5
RETURN o.name AS organization, maxDate AS latestMentionDate","match
  $a isa article, has date $d;
  $o isa organization, has name $on;
  (article: $a, mentioned: $o) isa mentions;
sort $d desc;
limit 5;
fetch { ""organization"": $on, ""latestMentionDate"": $d };"
companies,505,List the first 3 organizations that have subsidiaries in more than one country.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WITH o, count(DISTINCT c) AS numCountries WHERE numCountries > 1 RETURN o.name AS organization, numCountries ORDER BY numCountries DESC LIMIT 3","match $o isa organization; $sub isa organization; $c isa country; (parent: $o, subsidiary: $sub) isa subsidiary_of; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $c) isa location-contains; limit 3; fetch { ""organization"": $o.name };"
companies,506,Which organizations are headquartered in a city that is not the capital of its country?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country) WHERE c.name <> country.name RETURN o.name AS organization, c.name AS city, country.name AS country","match $o isa organization; $c isa city; $country isa country; (organization: $o, city: $c) isa located_in; (child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name, ""country"": $country.country_name };"
companies,507,Identify the first 3 organizations that have both a subsidiary and a supplier.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE EXISTS {(o)-[:HAS_SUPPLIER]->(:Organization)}
RETURN o.name
LIMIT 3","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  (customer: $o, supplier: $subsidiary) isa supplies;
limit 3;
fetch { ""name"": $o.name };"
companies,508,What are the names of the first 3 CEOs of organizations that are not public?,"MATCH (o:Organization {isPublic: false})-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name
LIMIT 3","match
  $o isa organization, has is_public false;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
limit 3;
fetch { ""name"": $ceo.name };"
companies,509,List the first 3 countries mentioned in articles related to consumer behavior.,MATCH (article:Article)-[:HAS_CHUNK]->(chunk:Chunk) WHERE toLower(article.summary) CONTAINS 'consumer behavior' ... RETURN DISTINCT country.name LIMIT 3,"match $article isa article; $chunk isa chunk; (article: $article, chunk: $chunk) isa has_chunk; $country isa country; limit 3; fetch { ""country_name"": $country.country_name };"
companies,510,What are the names of the first 3 'Electronic Products Manufacturers' with a revenue of over 500 million?,MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'}) WHERE o.revenue > 5e8 RETURN o.name LIMIT 3,"match $o isa organization; $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers""; (organization: $o, category: $c) isa in_category; $o has revenue $o_revenue; $o_revenue > 500000000; limit 3; fetch { ""name"": $o.name };"
companies,511,Who are the first 3 people who have both parent and child relationships in the database?,MATCH (p:Person) WHERE EXISTS {(p)-[:HAS_PARENT]->(:Person)} AND EXISTS {(p)-[:HAS_CHILD]->(:Person)} RETURN p.name LIMIT 3,"match $p isa person; $parent isa person; $child isa person; (parent: $parent, child: $p) isa parent_of; (parent: $p, child: $child) isa parent_of; limit 3; fetch { ""name"": $p.name };"
companies,512,Which organizations are located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  (organization: $o, city: $c) isa located_in;
fetch { ""organization"": $o.name };"
companies,515,Who are the CEOs of the first 3 organizations in the database?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS organization, ceo.name AS ceo
ORDER BY o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,516,What are the first 3 cities located in the United States of America?,"MATCH (c:City)-[:IN_COUNTRY]->(co:Country {name: 'United States of America'})
RETURN c.name AS city
LIMIT 3","match
  $c isa city;
  $co isa country, has country_name ""United States of America"";
  (child: $c, parent: $co) isa location-contains;
limit 3;
fetch { ""city"": $c.city_name };"
companies,517,Which organizations have more than 100 employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 100
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees < 50;
  $o has is_dissolved false;
fetch { ""o"": $o };"
companies,518,List the first 5 industry categories mentioned in the database.,"MATCH (c:IndustryCategory)
RETURN c.name
LIMIT 5","match
  $c isa industry_category;
limit 5;
fetch { ""industry_category_name"": $c.industry_category_name };"
companies,519,What are the names of the first 3 articles authored by 'James Blackman'?,"MATCH (a:Article {author: 'James Blackman'})
RETURN a.title
LIMIT 3","match
  $o isa organization;
fetch { ""name"": $o.name };"
companies,521,Who are the board members of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN p.name AS boardMember","match
  $o isa organization, has name ""New Energy Group"";
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""boardMember"": $p.name };"
companies,522,Which organizations are public companies?,"MATCH (o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o","match
  $o isa organization;
  $o has is_public $o_is_public;
  $o has is_public true;
fetch { ""o"": $o };"
companies,523,What are the sentiment scores of the first 3 articles mentioning 'Deja vu Security'?,"MATCH (o:Organization {name: 'Deja vu Security'})<-[:MENTIONS]-(a:Article)
RETURN a.title, a.sentiment
ORDER BY a.date DESC
LIMIT 3","match
  $o isa organization, has name ""Deja vu Security"";
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""title"": $a.title, ""sentiment"": $a.sentiment };"
companies,524,List the first 3 parent companies of 'Accenture'.,MATCH (o:Organization {name: 'Accenture'})<-[:HAS_SUBSIDIARY*1..3]-(parent:Organization) RETURN parent.name LIMIT 3,"match $o isa organization, has name ""Accenture""; $parent isa organization; (parent: $o, subsidiary: $parent) isa subsidiary_of; limit 3; fetch { ""name"": $parent.name };"
companies,525,What are the names of the first 3 subsidiaries of 'Accenture'?,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name
LIMIT 3","match
  $o isa organization, has name ""Accenture"";
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
limit 3;
fetch { ""subsidiary"": $subsidiary.name };"
companies,526,Which organizations does 'New Energy Group' supply?,MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_SUPPLIER]->(supplied:Organization) RETURN supplied,"match $o isa organization, has name ""New Energy Group""; $supplied isa organization; (supplier: $o, customer: $supplied) isa supplies; fetch { ""supplied"": $supplied };"
companies,528,What are the first 3 industry categories for organizations in Rome?,MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Rome'}) MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory) RETURN c.name AS category LIMIT 3,"match $o isa organization; $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in; $c isa industry_category; (organization: $o, category: $c) isa in_category; limit 3; fetch { ""category"": $c.industry_category_name };"
companies,529,Can you provide the names of top 5 articles published before 2020?,"MATCH (a:Article) WHERE a.date < date(""2020-01-01"") RETURN a.title ORDER BY a.date DESC LIMIT 5","match $a isa article; $a has date $a_date; $a_date < 2020-01-01T00:00:00; sort $a_date desc; limit 5; fetch { ""title"": $a.title };"
companies,530,Who are the investors of the first 3 organizations in the list?,"MATCH (o:Organization)
WITH o
ORDER BY o.name
LIMIT 3
MATCH (o)<-[:HAS_INVESTOR]-(investor)
RETURN o.name AS organization, investor.name AS investor","match $ceo isa person; $org isa organization; $investedOrg isa organization; (organization: $org, ceo: $ceo) isa ceo_of; (organization: $org, investor: $ceo) isa invested_in; fetch { ""organization"": $org.name, ""ceo"": $ceo.name, ""investedOrganization"": $investedOrg.name };"
companies,531,Which organizations are competitors of 'Deja vu Security'?,"MATCH (o:Organization {name: 'Deja vu Security'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name AS CompetitorName, competitor.summary AS CompetitorSummary","match
  $o isa organization, has name ""Deja vu Security"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
fetch { ""CompetitorName"": $competitor.name, ""CompetitorSummary"": $competitor.summary };"
companies,532,What are the first 3 articles that have a sentiment score above 0.5?,"MATCH (a:Article)
WHERE a.sentiment > 0.5
RETURN a
ORDER BY a.date DESC
LIMIT 3","match
  $o isa organization;
  $c isa city;
  $country isa country;
  (organization: $o, city: $c) isa located_in;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name, ""country"": $country.country_name, ""revenue"": $o.revenue };"
companies,533,List the first 3 countries mentioned in the database.,"MATCH (c:Country)
RETURN c.name
LIMIT 3","match
  $c isa country;
limit 3;
fetch { ""country_name"": $c.country_name };"
companies,534,Which organizations are involved in the industry category 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
fetch { ""organization"": $o.name };"
companies,535,What are the first 3 children of the person named 'Julie Spellman Sweet'?,MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_CHILD]->(child:Person) RETURN child.name LIMIT 3,"match $p isa person, has name ""Julie Spellman Sweet""; $child isa person; (parent: $p, child: $child) isa parent_of; limit 3; fetch { ""name"": $child.name };"
companies,536,Who are the first 3 parents of 'Julie Spellman Sweet'?,MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_PARENT*1..3]->(parent:Person) RETURN parent.name LIMIT 3,"match $p isa person, has name ""Julie Spellman Sweet""; $parent isa person; (parent: $parent, child: $p) isa parent_of; limit 3; fetch { ""name"": $parent.name };"
companies,537,What is the summary of the person with ID 'Eaf0bpz6NNoqLVUCqNZPAew'?,"MATCH (p:Person {id: 'Eaf0bpz6NNoqLVUCqNZPAew'})
RETURN p.summary","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
reduce $mentionCount = count($a) groupby $o;
sort $mentionCount desc;
limit 3;
fetch { ""organization"": $o.name, ""mentionCount"": $mentionCount };"
companies,539,Which organizations have a motto?,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o.name AS organization, o.motto AS motto","match
  $o1 isa organization;
  $p isa person;
  $o2 isa organization;
  (organization: $o1, ceo: $p) isa ceo_of;
(organization: $o1, member: $p) isa board_member_of; fetch { ""org1"": $o1.name, ""ceo_board_member"": $p.name, ""org2"": $o2.name };"
companies,540,What are the summaries of the first 3 cities in the database?,"MATCH (c:City)
RETURN c.summary
LIMIT 3","match
  $c isa city;
limit 3;
fetch { ""city_summary"": $c.city_summary };"
companies,541,Provide the names and IDs of the first 3 persons who are CEOs of public companies.,"MATCH (p:Person)-[:HAS_CEO]-(o:Organization)
WHERE o.isPublic = true
RETURN p.name AS name, p.id AS id
LIMIT 3","match
  $p isa person, has name $pn, has person_id $pid;
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
limit 3;
fetch { ""name"": $pn, ""id"": $pid };"
companies,542,Which person has the ID 'Eaf0bpz6NNoqLVUCqNZPAew'?,"MATCH (p:Person {id: 'Eaf0bpz6NNoqLVUCqNZPAew'})
RETURN p.name","match
  $p isa person, has person_id ""Eaf0bpz6NNoqLVUCqNZPAew"";
fetch { ""name"": $p.name };"
companies,543,What are the first 3 organizations mentioned in the article titled 'Funds for Consumer Behavior Specialist Infinite An'?,"MATCH (a:Article {title: 'Funds for Consumer Behavior Specialist Infinite An'})-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article, has title ""Funds for Consumer Behavior Specialist Infinite An"";
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
limit 3;
fetch { ""name"": $o.name };"
companies,544,List the first 5 organizations that have a CEO named 'Julie Spellman Sweet'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization
LIMIT 5","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
limit 5;
fetch { ""organization"": $o.name };"
companies,545,Which organizations have subsidiaries within the same city?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization), (o)-[:IN_CITY]->(c:City)<-[:IN_CITY]-(sub) RETURN o.name AS organization, sub.name AS subsidiary, c.name AS city","match $o isa organization; $sub isa organization; $c isa city; (parent: $o, subsidiary: $sub) isa subsidiary_of; (organization: $o, city: $c) isa located_in; fetch { ""organization"": $o.name, ""subsidiary"": $sub.name, ""city"": $c.city_name };"
companies,546,Name the first 3 organizations that have been mentioned in an article from 'MrWeb'.,"MATCH (article:Article {siteName: 'MrWeb'})-[:MENTIONS]->(org:Organization)
RETURN org.name
LIMIT 3","match $o isa organization, has name $n; $a isa article, has sentiment $s; (article: $a, mentioned: $o) isa mentions; reduce $avg_sentiment = mean($s) groupby $o; match $o has name $n; sort $avg_sentiment asc; limit 10; fetch { ""organization"": $n, ""avgSentiment"": $avg_sentiment };"
companies,547,What are the names of the first 3 CEOs who work at organizations with a revenue greater than 10 million?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)
WHERE o.revenue > 10000000
RETURN p.name
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has revenue $o_revenue;
  $o_revenue > 10000000;
limit 3;
fetch { ""name"": $p.name };"
companies,548,Who are the investors of 'Deja vu Security'?,"MATCH (o:Organization {name: 'Deja vu Security'})<-[:HAS_INVESTOR]-(investor)
RETURN investor","match
  $o isa organization, has name ""Deja vu Security"";
  $investor isa person, has name $in;
  (organization: $o, investor: $investor) isa invested_in;
fetch { ""investor"": $in };"
companies,549,List the first 3 organizations that have an investor who is a person.,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)
RETURN o.name AS organization, p.name AS investor
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (investor: $p, organization: $o) isa invested_in;
limit 3;
fetch { ""organization"": $o.name, ""investor"": $p.name };"
companies,550,What are the summaries of the first 3 organizations that have more than 200 employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 200
RETURN o.summary
LIMIT 3","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 200;
limit 3;
fetch { ""summary"": $o.summary };"
companies,551,Provide the names of the first 5 organizations that have at least one subsidiary.,MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization) RETURN o.name LIMIT 5,"match $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of; limit 5; fetch { ""name"": $o.name };"
companies,552,Which organizations are headquartered in a city with a summary containing 'capital'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'capital'
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $c has city_summary $c_city_summary;
  $c_city_summary contains ""capital"";
fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,553,List the first 3 articles that mention an organization with a revenue less than 5 million.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 5000000
RETURN a.title, a.summary, a.date
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has revenue $o_revenue;
  $o_revenue < 5000000;
limit 3;
fetch { ""title"": $a.title, ""article_summary"": $a.article_summary, ""date"": $a.date };"
companies,554,Who are the board members of the first 3 public organizations?,"MATCH (o:Organization) WHERE o.isPublic = true ... MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person) RETURN o.name AS organization, collect(p.name) AS board_members","match $o isa organization; $p isa person; (organization: $o, member: $p) isa board_member_of; $o has is_public $o_is_public; $o has is_public true; $o has name $o_name; sort $o_name asc; limit 3; fetch { ""organization"": $o.name };"
companies,555,What are the first 3 organizations that have the industry category 'Software company'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Software company'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Software company"";
  (organization: $o, category: $c) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,556,Name the first 3 organizations that have a supplier named 'New Energy Group'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization {name: 'New Energy Group'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
  $ic isa industry_category, has industry_category_name ""Technology""; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $s.name };"
companies,557,List the first 3 organizations that are competitors within the same industry category.,"MATCH (o1:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)<-[:HAS_CATEGORY]-(o2:Organization) WHERE (o1)-[:HAS_COMPETITOR]->(o2) RETURN o1.name AS Org1, o2.name AS Org2, c.name AS Category LIMIT 3","match $o1 isa organization; $c isa industry_category; $o2 isa organization; (organization: $o1, category: $c) isa in_category; (competitor: $o1, competitor: $o2) isa competes_with; limit 3; fetch { ""Org1"": $o1.name, ""Org2"": $o2.name, ""Category"": $c.industry_category_name };"
companies,558,"What are the first 3 articles with a date after January 1, 2021?","MATCH (a:Article) WHERE a.date > date(""2021-01-01"") RETURN a ORDER BY a.date LIMIT 3","match $a isa article; $a has date $a_date; $a_date > 2021-01-01T00:00:00; sort $a_date asc; limit 3; fetch { ""a"": $a };"
companies,559,Which organizations have a parent organization within the same city?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization) WHERE (o)-[:IN_CITY]->(:City)<-[:IN_CITY]-(sub) RETURN o.name AS parent_org, sub.name AS subsidiary_org","match $o isa organization; $sub isa organization; (parent: $o, subsidiary: $sub) isa subsidiary_of; $city isa city; (organization: $o, city: $city) isa located_in; fetch { ""parent_org"": $o.name, ""subsidiary_org"": $sub.name };"
companies,560,Who are the first 3 CEOs of organizations that have been dissolved?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isDissolved = true
RETURN p.name AS ceoName, o.name AS orgName
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved true;
limit 3;
fetch { ""ceoName"": $p.name, ""orgName"": $o.name };"
companies,563,Who are the first 3 persons mentioned as investors in organizations?,"MATCH (p:Person)<-[:HAS_INVESTOR]-(o:Organization)
RETURN p.name AS investor
LIMIT 3","match
  $p isa person, has name $pn;
  $o isa organization;
  (organization: $o, investor: $p) isa invested_in;
limit 3;
fetch { ""investor"": $pn };"
companies,564,What are the top 5 organizations by number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match $o isa organization, has name $n; $a isa article; (article: $a, mentioned: $o) isa mentions; reduce $mentions = count($a) groupby $o; match $o has name $n; sort $mentions desc; limit 5; fetch { ""organization"": $n, ""mentions"": $mentions };"
companies,566,Which cities have more than three organizations located within them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name AS city, orgCount","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
reduce $orgCount = count($o) groupby $c;
match $orgCount > 3;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,567,Name the first 3 organizations that have their CEOs with a summary containing 'CEO at'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'CEO at'
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization, has name $on;
  $p isa person, has summary $ps;
  (organization: $o, ceo: $p) isa ceo_of;
  $ps like "".*CEO at.*"";
limit 3;
fetch { ""organization"": $on };"
companies,568,What are the first 3 organizations that have a CEO and a board member with the same name?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), (o)-[:HAS_BOARD_MEMBER]->(board:Person) WHERE ceo.name = board.name RETURN o.name AS organization, ceo.name AS name LIMIT 3","match $o isa organization; $ceo isa person; $board isa person; (organization: $o, ceo: $ceo) isa ceo_of; (organization: $o, member: $board) isa board_member_of; limit 3; fetch { ""organization"": $o.name, ""name"": $ceo.name };"
companies,570,Which organization has the highest revenue in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) WHERE o.revenue IS NOT NULL RETURN o.name AS organization, o.revenue AS revenue ORDER BY o.revenue DESC LIMIT 1","match $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; $o has revenue $o_revenue; sort $o_revenue desc; limit 1; fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,571,Who are the CEOs of the first 3 organizations that have a category 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
WITH o
ORDER BY o.name
LIMIT 3
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $o has name $o_name;
sort $o_name asc;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,572,What are the first 3 organizations that have a public status and more than 500 employees?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees > 500
RETURN o.name AS organization, o.nbrEmployees AS employeeCount
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization;
  $o has is_public true;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
sort $o_nbr_employees desc;
limit 3;
fetch { ""organization"": $o.name, ""employeeCount"": $o.nbr_employees };"
companies,573,Which organizations have a CEO named within the first 5 chunks of an article?,"MATCH (article:Article)-[:HAS_CHUNK]->(chunk:Chunk), ... WHERE chunk.text CONTAINS ceo.name AND chunk.text IN [...first 5 chunks]","match $article isa article; $chunk isa chunk; $org isa organization; $ceo isa person; (article: $article, chunk: $chunk) isa has_chunk; (article: $article, mentioned: $org) isa mentions; (organization: $org, ceo: $ceo) isa ceo_of; fetch { ""organization"": $org.name, ""ceo"": $ceo.name };"
companies,574,List the first 3 organizations that have been competitors for more than 5 years.,"MATCH (o1:Organization)-[c:HAS_COMPETITOR]->(o2:Organization) WHERE c.since < date() - duration('P5Y') RETURN o1, o2 LIMIT 3","match $o1 isa organization; $o2 isa organization; (competitor: $o1, competitor: $o2) isa competes_with; limit 3; fetch { ""o1"": $o1, ""o2"": $o2 };"
companies,575,What are the names of the first 3 organizations that have a CEO with a name starting with 'J'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name STARTS WITH 'J'
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has name $p_name;
  $p_name like ""^J.*"";
limit 3;
fetch { ""name"": $o.name };"
companies,576,Which organizations have a category and are located in a city with a name containing 'Rome'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(:IndustryCategory)
WHERE (o)-[:IN_CITY]->(:City {name: 'Rome'})
RETURN o","match
  $o isa organization;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
  $ic isa industry_category; (organization: $o, category: $ic) isa in_category;
fetch { ""o"": $o };"
companies,577,List the first 5 organizations that have a supplier and are public companies.,MATCH (o:Organization)-[:HAS_SUPPLIER]->(:Organization) WHERE o.isPublic = true RETURN o.name LIMIT 5,"match $o isa organization; $o has is_public true; $supplier isa organization; (customer: $o, supplier: $supplier) isa supplies; limit 5; fetch { ""name"": $o.name };"
companies,578,What are the first 3 organizations with a CEO who has written an article?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE EXISTS { (ceo)-[:HAS_CHUNK]->(:Chunk)<-[:HAS_CHUNK]-(:Article) } RETURN o.name AS organization, ceo.name AS ceo LIMIT 3","match $o isa organization; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; limit 3; fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,579,Who are the investors of the first 3 organizations with a revenue above 50 million?,"MATCH (o:Organization)
WHERE o.revenue > 50000000
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)<-[:HAS_INVESTOR]-(investor)
RETURN o.name AS organization, investor.name AS investor","match
  $o isa organization;
  (investor: $investor, organization: $o) isa invested_in;
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""investor"": $investor.name };"
companies,580,Which organizations have been mentioned in articles with a sentiment score lower than 0.5?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0.5;
fetch { ""o"": $o };"
companies,581,Name the first 3 organizations that have a CEO and a board member with different nationalities.,"MATCH ... (ceo)-[:HAS_NATIONALITY]->(ceoCountry:Country), (board)-[:HAS_NATIONALITY]->(boardCountry:Country) WHERE ceoCountry <> boardCountry","match $o isa organization; $ceo isa person; $board isa person; $ceoCountry isa country; $boardCountry isa country; (organization: $o, ceo: $ceo) isa ceo_of; (organization: $o, member: $board) isa board_member_of; limit 3; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""ceoCountry"": $ceoCountry.country_name };"
companies,582,List the first 5 organizations that have more than one category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS categoryCount
WHERE categoryCount > 1
RETURN o.name AS organization, categoryCount
ORDER BY categoryCount DESC
LIMIT 5","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
reduce $categoryCount = count($c) groupby $o;
match $categoryCount > 1;
sort $categoryCount desc;
limit 5;
fetch { ""organization"": $o.name, ""categoryCount"": $categoryCount };"
companies,583,What are the first 3 articles mentioning an organization with more than 1000 employees?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 1000
RETURN a.title, a.summary, a.date
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""title"": $a.title, ""article_summary"": $a.article_summary, ""date"": $a.date };"
companies,584,Which organization in Seattle has the most employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) WHERE o.nbrEmployees IS NOT NULL RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees ORDER BY o.nbrEmployees DESC LIMIT 1","match $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; $o has nbr_employees $o_nbr_employees; sort $o_nbr_employees desc; limit 1; fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,587,What are the first 3 organizations with a CEO who has a summary mentioning 'Technology'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Technology'
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""Technology"";
limit 3;
fetch { ""organization"": $o.name };"
companies,589,List the first 5 organizations that have a category named 'Technology'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Technology'})
RETURN o.name AS organization
LIMIT 5","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Technology"";
  (organization: $o, category: $c) isa in_category;
limit 5;
fetch { ""organization"": $o.name };"
companies,590,What are the first 3 organizations with a CEO whose name ends with 'Sweet'?,MATCH (o:Organization)-[:HAS_CEO]->(p:Person) WHERE p.name ENDS WITH 'Sweet' RETURN o.name LIMIT 3,"match $o isa organization; $p isa person; (organization: $o, ceo: $p) isa ceo_of; limit 3; fetch { ""name"": $o.name };"
companies,591,Which organizations have been mentioned in articles authored by women?,MATCH (article:Article {author: 'David Correa'})-[:MENTIONS]->(org:Organization) RETURN DISTINCT org,"match $article isa article, has author ""David Correa""; $org isa organization; (article: $article, mentioned: $org) isa mentions; fetch { ""org"": $org };"
companies,592,Name the first 3 organizations that have a CEO with a name containing 'Julie'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name CONTAINS 'Julie'
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has name $p_name;
  $p_name contains ""Julie"";
limit 3;
fetch { ""name"": $o.name };"
companies,593,List the first 3 organizations that have a competitor and a supplier in the same city.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization),
      (o)-[:HAS_SUPPLIER]->(s:Organization),
      (o)-[:IN_CITY]->(city:City),
      (c)-[:IN_CITY]->(city),
      (s)-[:IN_CITY]->(city)
RETURN o.name AS organization, c.name AS competitor, s.name AS supplier, city.name AS city
LIMIT 3","match
  $o isa organization;
  $c isa organization;
  $s isa organization;
  $city isa city;
  (competitor: $o, competitor: $c) isa competes_with;
  (customer: $o, supplier: $s) isa supplies;
  (organization: $o, city: $city) isa located_in;
  (organization: $c, city: $city) isa located_in;
  (organization: $s, city: $city) isa located_in;
limit 3;
fetch { ""organization"": $o.name, ""competitor"": $c.name, ""supplier"": $s.name, ""city"": $city.city_name };"
companies,594,Which organizations have a CEO who was mentioned in an article on 'RCR Wireless News'?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:MENTIONS]-(a:Article {siteName: 'RCR Wireless News'}) RETURN o.name AS organization, ceo.name AS ceo","match $o isa organization; $ceo isa person; $a isa article, has site_name ""RCR Wireless News""; (organization: $o, ceo: $ceo) isa ceo_of; (article: $a, mentioned: $o) isa mentions; fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,595,List the first 5 organizations that have a CEO with a summary mentioning 'Leader'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Leader'
RETURN o.name AS organization, p.name AS ceo
LIMIT 5","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""Leader"";
limit 5;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,596,What are the first 3 organizations that have a category and a CEO named 'Julie Spellman Sweet'?,MATCH (o:Organization)-[:HAS_CATEGORY]->(:IndustryCategory) MATCH (o)-[:HAS_CEO]->(ceo:Person {name: 'Julie Spellman Sweet'}) RETURN o.name AS organization LIMIT 3,"match $o isa organization; $ceo isa person, has name ""Julie Spellman Sweet""; (organization: $o, ceo: $ceo) isa ceo_of; $ic isa industry_category; (organization: $o, category: $ic) isa in_category; limit 3; fetch { ""organization"": $o.name };"
companies,600,Name 3 organizations that are suppliers to 'New Energy Group'.,MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_SUPPLIER]-(supplier:Organization) RETURN supplier.name LIMIT 3,"match
  $o isa organization;
  $s isa organization;
  $sub isa organization;
  $sc isa country;
  $subc isa country;
  (customer: $o, supplier: $s) isa supplies;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $sc) isa location-contains; fetch { ""organization"": $o.name };"
companies,601,Which cities are home to organizations with more than 300 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 300
RETURN c.name AS city","match
  $a isa article;
  $c isa chunk;
  $o isa organization;
  $ic isa industry_category, has industry_category_name ""Finance"";
  $city isa city;
  (article: $a, chunk: $c) isa has_chunk;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, city: $city) isa located_in;
  (organization: $o, category: $ic) isa in_category;
limit 3;
reduce $mentions = count($a);"
companies,602,Identify the top 5 articles with a positive sentiment greater than 0.8.,"MATCH (a:Article)
WHERE a.sentiment > 0.8
RETURN a.title, a.sentiment, a.siteName, a.date
ORDER BY a.sentiment DESC
LIMIT 5","match
  $a isa article;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.8;
sort $a_sentiment desc;
limit 5;
fetch { ""title"": $a.title, ""sentiment"": $a.sentiment, ""site_name"": $a.site_name, ""date"": $a.date };"
companies,603,What are the names of the organizations that are subsidiaries of 'Accenture'?,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name","match
  $o isa organization, has name ""Accenture"";
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
fetch { ""subsidiary"": $subsidiary.name };"
companies,604,Which organizations have 'Julie Spellman Sweet' as a CEO?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(o:Organization)
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,605,List the industry categories for organizations located in 'Seattle'.,MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory) RETURN DISTINCT c.name,"match $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; $c isa industry_category; (organization: $o, category: $c) isa in_category; fetch { ""industry_category_name"": $c.industry_category_name };"
companies,606,Which organizations are competitors of 'Deis'?,"MATCH (o:Organization {name: 'Deis'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor.name AS competitor","match
  $o isa organization, has name ""Deis"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
fetch { ""competitor"": $competitor.name };"
companies,607,Who are the board members of organizations with revenue over 50000000?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE o.revenue > 50000000
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,608,Which organizations have a summary mentioning 'software' and are located in a city with a population summary mentioning 'capital'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City) WHERE toLower(o.summary) CONTAINS 'software' AND toLower(c.summary) CONTAINS 'capital' RETURN o.name AS organization, c.name AS city","match $o isa organization; $c isa city; (organization: $o, city: $c) isa located_in; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,609,Who are the children of 'Julie Spellman Sweet' listed in the database?,MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_CHILD]->(child:Person) RETURN child.name AS child,"match $p isa person, has name ""Julie Spellman Sweet""; $child isa person; (parent: $p, child: $child) isa parent_of; fetch { ""child"": $child.name };"
companies,611,Identify articles mentioning organizations based in 'Rome'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Rome'}) RETURN a.title AS article, o.name AS organization","match $a isa article; $o isa organization; $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in; (article: $a, mentioned: $o) isa mentions; fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,613,Name 3 people who are board members for organizations with a motto.,"MATCH (p:Person)<-[:HAS_BOARD_MEMBER]-(o:Organization)
WHERE o.motto IS NOT NULL
RETURN p.name
LIMIT 3","match
  $p isa person, has name $pn;
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
  $o has motto $m;
limit 3;
fetch { ""name"": $pn };"
companies,615,Which organizations are located in cities within 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,616,Who are the investors in 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_INVESTOR]-(investor)
WHERE investor:Person OR investor:Organization
RETURN investor","match
  $o isa organization, has name ""New Energy Group"";
  $investor isa person, has name $in;
  (organization: $o, investor: $investor) isa invested_in;
fetch { ""investor"": $in };"
companies,617,List the organizations that have a category named 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
fetch { ""organization"": $o.name };"
companies,620,Which articles mention organizations that have been dissolved?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN a, o","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
fetch { ""a"": $a, ""o"": $o };"
companies,621,List the CEOs of organizations that have a category in 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Electronic Products Manufacturers'}) RETURN o.name AS company, ceo.name AS ceo","match $o isa organization; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; $ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers""; (organization: $o, category: $ic) isa in_category; fetch { ""company"": $o.name, ""ceo"": $ceo.name };"
companies,622,Which organization has the highest number of employees and is located in a capital city?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE c.name = country.name
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 1","match
  $o isa organization, has name $on;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $ne;
sort $ne desc;
limit 1;
fetch { ""organization"": $on, ""numberOfEmployees"": $ne };"
companies,623,What are the top 5 articles with the highest sentiment scores?,"MATCH (a:Article)
RETURN a.title AS title, a.sentiment AS sentiment
ORDER BY a.sentiment DESC
LIMIT 5","match
  $a isa article;
  $a has sentiment $a_sentiment;
sort $a_sentiment desc;
limit 5;
fetch { ""title"": $a.title, ""sentiment"": $a.sentiment };"
companies,624,List all organizations that have a supplier named 'Accenture'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization {name: 'Accenture'})
RETURN o.name AS organization","match
  $o isa organization;
  $s isa organization, has name ""Accenture"";
  (customer: $o, supplier: $s) isa supplies;
fetch { ""organization"": $o.name };"
companies,625,Which organizations have a CEO and are also public companies?,MATCH (o:Organization) WHERE o.isPublic = true AND EXISTS { (o)-[:HAS_CEO]->(:Person) } RETURN o.name AS organization,"match $o isa organization; $o has is_public true; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""organization"": $o.name };"
companies,626,Name the organizations with competitors that have more than 300 employees.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization)
WHERE c.nbrEmployees > 300
RETURN o.name AS organization, c.name AS competitor","match
  $o isa organization;
  $c isa organization;
  (competitor: $o, competitor: $c) isa competes_with;
  $c has nbr_employees $c_nbr_employees;
  $c_nbr_employees > 300;
fetch { ""organization"": $o.name, ""competitor"": $c.name };"
companies,627,List 3 organizations that have their headquarters in a city that is also a capital.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country) WHERE c.name = country.name RETURN o.name AS organization, c.name AS city LIMIT 3","match $o isa organization; $c isa city; $country isa country; (organization: $o, city: $c) isa located_in; (child: $c, parent: $country) isa location-contains; limit 3; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,628,Which articles have chunks containing the text 'consumer behavior analyses'?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'consumer behavior analyses'
RETURN a","match $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of; limit 3; fetch { ""name"": $o.name };"
companies,629,Identify the organizations that have been mentioned in articles published after 2021-01-01.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization) WHERE a.date > date(""2021-01-01"") RETURN DISTINCT o","match $a isa article, has date $a_date; $o isa organization; (article: $a, mentioned: $o) isa mentions; $a_date > 2021-01-01T00:00:00; fetch { ""o"": $o };"
companies,630,What are the summaries of organizations that have a CEO named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(o:Organization)
RETURN o.summary","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""summary"": $o.summary };"
companies,632,List the organizations that have 'Julie Spellman Sweet' as an investor.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_INVESTOR]-(o:Organization)
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization, has name $on;
  (organization: $o, investor: $p) isa invested_in;
fetch { ""organization"": $on };"
companies,633,Which organizations in 'United States of America' have more than 200 employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'}) WHERE o.nbrEmployees > 200 RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match $o isa organization; $co isa country, has country_name ""United States of America""; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $co) isa location-contains; $o has nbr_employees $o_nbr_employees; $o_nbr_employees > 200; fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,635,Name the organizations that have subsidiaries and are located in cities with a summary mentioning 'county seat'.,MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization) MATCH (o)-[:IN_CITY]->(c:City) WHERE c.summary CONTAINS 'county seat' RETURN o.name AS organization,"match $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of; $c isa city; (organization: $o, city: $c) isa located_in; $c has city_summary $c_city_summary; $c_city_summary contains ""county seat""; fetch { ""organization"": $o.name };"
companies,636,Which organizations have board members who are also CEOs of other organizations?,"MATCH (o1:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)<-[:HAS_CEO]-(o2:Organization) WHERE o1 <> o2 RETURN o1.name AS BoardMemberOrg, p.name AS BoardMemberName, o2.name AS CEOOrg","match $o1 isa organization; $p isa person; $o2 isa organization; (organization: $o1, member: $p) isa board_member_of; (organization: $o1, ceo: $p) isa ceo_of; fetch { ""BoardMemberOrg"": $o1.name, ""BoardMemberName"": $p.name, ""CEOOrg"": $o2.name };"
companies,637,List the articles that mention organizations headquartered in 'Rome'.,MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Rome'}) RETURN ...,"match $a isa article; $o isa organization; $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in; (article: $a, mentioned: $o) isa mentions; fetch { ""article_id"": $a.article_id, ""title"": $a.title, ""author"": $a.author, ""site_name"": $a.site_name, ""date"": $a.date, ""article_summary"": $a.article_summary };"
companies,638,What are the titles of articles that report negative sentiments and mention organizations?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
RETURN a.title","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0;
fetch { ""title"": $a.title };"
companies,640,Which organizations are public and have been mentioned in articles with a positive sentiment?,"MATCH (o:Organization {isPublic: true})<-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.5
RETURN DISTINCT o.name AS organization, a.title AS article, a.sentiment AS sentiment","match
  $o isa organization, has is_public true;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.5;
fetch { ""organization"": $o.name, ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,641,List the industry categories of organizations that have a revenue above 100000000.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE o.revenue > 100000000
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
fetch { ""industry_category_name"": $c.industry_category_name };"
companies,642,What are the relationships of 'Julie Spellman Sweet' within the context of the organization she is associated with?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})-[r]-(o:Organization)
WHERE p.name IS NOT NULL AND o.name IS NOT NULL
RETURN p, r, o","match
  $c isa city;
  $o isa organization;
  $ic isa industry_category;
  (organization: $o, city: $c) isa located_in;
  $ic has industry_category_name $ic_industry_category_name;
  $ic_industry_category_name contains ""Environmental"";
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,643,Which organizations have subsidiaries and are located in the same city?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization), (o)-[:IN_CITY]->(city:City)<-[:IN_CITY]-(sub) RETURN o.name AS organization, sub.name AS subsidiary, city.name AS city","match $o isa organization; $sub isa organization; $city isa city; (parent: $o, subsidiary: $sub) isa subsidiary_of; (organization: $o, city: $city) isa located_in; fetch { ""organization"": $o.name, ""subsidiary"": $sub.name, ""city"": $city.city_name };"
companies,644,Who are the CEOs of organizations that have a competitor named 'New Energy Group'?,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization {name: 'New Energy Group'})
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS ceoName, o.name AS orgName","match
  $o isa organization;
  $c isa organization, has name ""New Energy Group"";
  (competitor: $o, competitor: $c) isa competes_with;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
fetch { ""ceoName"": $ceo.name, ""orgName"": $o.name };"
companies,645,What are the organizations mentioned in articles with a sentiment score below 0.5?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0.5;
fetch { ""o"": $o };"
companies,646,List the cities where organizations with a summary mentioning 'financial services' are based.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.summary CONTAINS 'financial services'
RETURN DISTINCT c.name","match
  $c isa city;
  $o isa organization;
  $ic isa industry_category;
  (organization: $o, city: $c) isa located_in;
  $ic has industry_category_name $ic_industry_category_name;
  $ic_industry_category_name contains ""Food"";
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 3;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,647,Identify the organizations that are suppliers to public companies.,"MATCH (supplier:Organization)-[:HAS_SUPPLIER]->(company:Organization) WHERE company.isPublic = true RETURN supplier, company","match $supplier isa organization; $company isa organization; (supplier: $supplier, customer: $company) isa supplies; $company has is_public true; fetch { ""supplier"": $supplier, ""company"": $company };"
companies,649,Which organizations have a CEO who is also a board member of another organization?,"MATCH (o1:Organization)-[:HAS_CEO]->(ceo:Person),
      (ceo)-[:HAS_BOARD_MEMBER]->(o2:Organization)
WHERE o1 <> o2
RETURN o1.name AS org1, ceo.name AS ceo_name, o2.name AS org2","match
  $o1 isa organization, has name $on1;
  $ceo isa person, has name $ceon;
  $o2 isa organization, has name $on2;
  (organization: $o1, ceo: $ceo) isa ceo_of;
  (organization: $o2, member: $ceo) isa board_member_of;
  $o1 has organization_id $id1;
  $o2 has organization_id $id2;
  $id1 != $id2;
fetch { ""org1"": $on1, ""ceo_name"": $ceon, ""org2"": $on2 };"
companies,650,List the top 3 organizations by revenue that are located in a city with a summary mentioning 'metropolitan'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'metropolitan'
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $c has city_summary $c_city_summary;
  $c_city_summary contains ""metropolitan"";
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,651,What are the top 5 articles that mention organizations based in 'United States of America'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'}) RETURN a.title AS article, a.date AS publishedDate ORDER BY a.date DESC LIMIT 5","match $a isa article; $o isa organization; $co isa country, has country_name ""United States of America""; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $co) isa location-contains; (article: $a, mentioned: $o) isa mentions; $a has date $a_date; sort $a_date desc; limit 5; fetch { ""article"": $a.title, ""publishedDate"": $a.date };"
companies,653,Name the organizations that have investors named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_INVESTOR]->(o:Organization)
RETURN o.name AS organization","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
fetch { ""organization"": $o.name };"
companies,654,List the cities that are home to organizations with a revenue exceeding 50000000.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 50000000
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
fetch { ""city_name"": $c.city_name };"
companies,656,Identify the organizations that have CEOs who are also investors in other companies.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE EXISTS { (ceo)-[:HAS_INVESTOR]->(:Organization) } RETURN o.name AS organization, ceo.name AS ceo","match $o isa organization; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; (organization: $o, investor: $ceo) isa invested_in; fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,657,List the industry categories of organizations that have a CEO with a summary mentioning 'executive'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'executive'
WITH o
MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory) 
RETURN DISTINCT c.name","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $p has summary $p_summary;
  $p_summary contains ""executive"";
fetch { ""industry_category_name"": $c.industry_category_name };"
companies,658,What are the names of organizations with a CEO named 'Julie Spellman Sweet' and are located in a city named 'Seattle'?,MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'}) WHERE (o)-[:IN_CITY]->(:City {name: 'Seattle'}) RETURN o.name,"match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $city isa city, has city_name ""Seattle"";
  (organization: $o, city: $city) isa located_in;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,659,Which organizations have investors who are also board members?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)-[:HAS_BOARD_MEMBER]->(o) RETURN o.name AS organization, p.name AS investor_board_member","match $o isa organization; $p isa person; (investor: $p, organization: $o) isa invested_in; (organization: $o, member: $p) isa board_member_of; fetch { ""organization"": $o.name, ""investor_board_member"": $p.name };"
companies,661,What are the articles mentioning organizations that have a CEO with a name containing 'Sweet'?,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)-[:HAS_CEO]->(ceo:Person) WHERE ceo.name CONTAINS 'Sweet' RETURN article, org, ceo","match
  $article isa article, has title $t;
  $org isa organization, has name $on;
  $ceo isa person, has name $ceon;
  (article: $article, mentioned: $org) isa mentions;
  (organization: $org, ceo: $ceo) isa ceo_of;
  $ceon like "".*Sweet.*"";
fetch { ""article"": $t, ""organization"": $on, ""ceo"": $ceon };"
companies,662,List the organizations that have a subsidiary and also have a supplier named 'Accenture'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE EXISTS {(o)-[:HAS_SUPPLIER]->(:Organization {name: 'Accenture'})}
RETURN o","match
  $o isa organization, has name ""Accenture""; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  (customer: $o, supplier: $subsidiary) isa supplies;
fetch { ""o"": $o };"
companies,663,Which organizations have a board member named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_BOARD_MEMBER]-(o:Organization)
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""o"": $o };"
companies,665,List the organizations located in cities that have been mentioned in articles with a high sentiment score.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)<-[:MENTIONS]-(a:Article) WHERE a.sentiment > 0.8 RETURN o.name AS organization, c.name AS city, a.title AS article, a.sentiment AS sentiment","match $o isa organization; $c isa city; $a isa article; (organization: $o, city: $c) isa located_in; $a has sentiment $a_sentiment; $a_sentiment > 0.8; (article: $a, mentioned: $o) isa mentions; fetch { ""organization"": $o.name, ""city"": $c.city_name, ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,669,Which organizations have a CEO and a motto that includes 'innovation'?,MATCH (o:Organization) WHERE (o)-[:HAS_CEO]->(:Person) AND o.motto IS NOT NULL AND toLower(o.motto) CONTAINS 'innovation' RETURN o,"match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,671,List the children of CEOs who are mentioned as investors in the database.,"MATCH (ceo:Person)<-[:HAS_CEO]-(company:Organization)
MATCH (child:Person)<-[:HAS_CHILD]-(ceo)
WHERE EXISTS {
  (company)-[:HAS_INVESTOR]->(ceo)
}
RETURN ceo.name AS CEO, child.name AS Child, company.name AS Company","match
  $ceo isa person;
  $company isa organization;
  (organization: $company, ceo: $ceo) isa ceo_of;
  $child isa person;
(organization: $company, investor: $ceo) isa invested_in; (parent: $ceo, child: $child) isa parent_of; fetch { ""CEO"": $ceo.name, ""Child"": $child.name, ""Company"": $company.name };"
companies,673,Identify the organizations that have a CEO with a summary including 'executive' and are located in a country named 'United States of America'.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE ceo.summary CONTAINS 'executive' AND (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(:Country {name: 'United States of America'}) RETURN o, ceo","match $o isa organization; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; $ceo has summary $ceo_summary; $ceo_summary contains ""executive""; $city isa city; (organization: $o, city: $city) isa located_in; $country isa country, has country_name ""United States of America""; (child: $city, parent: $country) isa location-contains; fetch { ""o"": $o, ""ceo"": $ceo };"
companies,674,Which organizations have a CEO named 'Julie Spellman Sweet' and have a revenue exceeding 50000000?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE o.revenue > 50000000
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
fetch { ""o"": $o };"
companies,675,List the organizations that have a public status and a summary mentioning 'software'.,"MATCH (o:Organization) WHERE o.isPublic = true AND toLower(o.summary) CONTAINS 'software' RETURN o.name AS organization, o.summary AS summary","match $o isa organization; $o has is_public true; fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,679,Which 3 cities have organizations that are not dissolved?,MATCH (c:City)<-[:IN_CITY]-(o:Organization) WHERE o.isDissolved IS NOT NULL AND NOT o.isDissolved RETURN c.name AS city LIMIT 3,"match $c isa city; $o isa organization; (organization: $o, city: $c) isa located_in; $o has is_dissolved false; limit 3; fetch { ""city"": $c.city_name };"
companies,680,List the top 3 organizations with the most employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
sort $o_nbr_employees desc;
limit 3;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,683,What are the 5 latest articles mentioning the organization 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:MENTIONS]-(a:Article)
WITH a
ORDER BY a.date DESC
LIMIT 5
RETURN a.title AS title, a.date AS date, a.author AS author, a.siteName AS siteName, a.summary AS summary","match
  $o isa organization, has name ""New Energy Group"";
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 5;
fetch { ""title"": $a.title, ""date"": $a.date, ""author"": $a.author, ""siteName"": $a.site_name, ""summary"": $a.article_summary };"
companies,684,Can you name 3 organizations that have subsidiaries?,MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization) RETURN o.name AS organization LIMIT 3,"match
  $o isa organization;
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
limit 3;
fetch { ""organization"": $o.name };"
companies,685,Which 3 organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
limit 3;
fetch { ""organization"": $o.name };"
companies,686,List the top 5 articles by positive sentiment.,"MATCH (a:Article) WHERE a.sentiment IS NOT NULL RETURN a.title AS title, a.sentiment AS sentiment ORDER BY sentiment DESC LIMIT 5","match $a isa article; $a has sentiment $a_sentiment; limit 5; fetch { ""title"": $a.title, ""sentiment"": $a.sentiment };"
companies,687,Who are the board members of the top 3 organizations by revenue?,"MATCH (o:Organization)
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""boardMember"": $p.name, ""organization"": $o.name };"
companies,688,Name 3 organizations that have suppliers.,MATCH (o:Organization)-[:HAS_SUPPLIER]->(:Organization) RETURN o.name LIMIT 3,"match $o isa organization; $supplier isa organization; (customer: $o, supplier: $supplier) isa supplies; limit 3; fetch { ""name"": $o.name };"
companies,689,What are the top 5 cities by number of organizations located in them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name AS city, orgCount","match
  $c isa city;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
reduce $orgCount = count($o) groupby $c;
sort $orgCount desc;
limit 5;
fetch { ""city"": $c.city_name, ""orgCount"": $orgCount };"
companies,690,Name 3 countries hosting organizations with revenue over 100 million.,MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE o.revenue > 1E8 RETURN DISTINCT c.name LIMIT 3,"match
  $o isa organization;
  $c isa country, has country_name $cn;
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $o has revenue $r;
  $r > 100000000;
limit 3;
fetch { ""country"": $cn };"
companies,691,List 3 organizations that have a competitor in the same industry.,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization), (o1)-[:HAS_CATEGORY]->(c:IndustryCategory)<-[:HAS_CATEGORY]-(o2) RETURN o1.name AS org1, o2.name AS org2, c.name AS industry LIMIT 3","match $o1 isa organization; $o2 isa organization; $c isa industry_category; (competitor: $o1, competitor: $o2) isa competes_with; (organization: $o1, category: $c) isa in_category; limit 3; fetch { ""org1"": $o1.name, ""org2"": $o2.name, ""industry"": $c.industry_category_name };"
companies,692,Who are the investors in the top 3 organizations by revenue?,"MATCH (o:Organization)
WITH o
ORDER BY o.revenue DESC
LIMIT 3
MATCH (o)<-[:HAS_INVESTOR]-(investor)
WHERE investor:Person OR investor:Organization
RETURN o.name AS organization, investor.name AS investor","match
  $o isa organization;
  $investor isa person;
  (organization: $o, investor: $investor) isa invested_in;
limit 3;
fetch { ""investor"": $investor.name, ""organization"": $o.name };"
companies,694,Name 3 organizations that are listed as dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
limit 3;
fetch { ""name"": $o.name };"
companies,697,Who are the top 3 CEOs of tech companies by number of articles mentioning them?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name CONTAINS 'Technology'
WITH p, count(p) as mentions
ORDER BY mentions DESC
LIMIT 3
RETURN p.name as name, p.summary as summary, mentions","match
  $p isa person;
  $o isa organization;
  $c isa industry_category;
  (organization: $o, ceo: $p) isa ceo_of;
  $c has industry_category_name $c_industry_category_name;
  $c_industry_category_name contains ""Technology"";
  (organization: $o, category: $c) isa in_category;
reduce $mentions = count($p) groupby $p;
sort $mentions desc;
limit 3;
fetch { ""name"": $p.name, ""summary"": $p.summary, ""mentions"": $mentions };"
companies,698,Which 3 organizations have changed their CEOs in the last year?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.name IS NOT NULL
WITH o
ORDER BY o.name
LIMIT 3
MATCH (o)-[:MENTIONED_IN]->(a:Article)
WHERE a.date >= datetime() - duration('P1Y') 
RETURN DISTINCT o.name AS organization, a.title AS article_title","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $a isa article;
  $p has name $p_name;
  $o has name $o_name;
sort $o_name asc;
limit 3;
fetch { ""organization"": $o.name, ""article_title"": $a.title };"
companies,699,Name the top 5 industries by number of organizations associated with them.,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization) RETURN ic.name AS industry, count(o) AS numOrganizations ORDER BY numOrganizations DESC LIMIT 5","match $ic isa industry_category, has industry_category_name $name; $o isa organization; (organization: $o, category: $ic) isa in_category; reduce $numOrganizations = count($o) groupby $ic; match $ic has industry_category_name $name; sort $numOrganizations desc; limit 5; fetch { ""industry"": $name, ""numOrganizations"": $numOrganizations };"
companies,701,List 5 organizations that have acquired other organizations in the past year.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE exists {
  (o)-[:MENTIONS]-(:Article)-[:HAS_CHUNK]->(c:Chunk)
  WHERE c.text CONTAINS 'acquired' AND c.text CONTAINS 'past year'
}
RETURN o.name AS organization, collect(s.name) AS subsidiaries
LIMIT 5","match
  $o isa organization;
  $s isa organization;
  (parent: $o, subsidiary: $s) isa subsidiary_of;
  $c has text $c_text;
  $c_text contains ""acquired"";
  $c_text contains ""past year"";
limit 5;
fetch { ""organization"": $o.name };"
companies,702,Name 3 organizations that have been involved in legal disputes according to recent articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.summary CONTAINS 'legal' OR a.summary CONTAINS 'lawsuit' OR a.summary CONTAINS 'dispute'
WITH o, count(a) AS num_articles
ORDER BY num_articles DESC
LIMIT 3
RETURN o.name AS organization","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has article_summary $a_article_summary;
  $a_article_summary contains ""legal"";
reduce $num_articles = count($a) groupby $o;
sort $num_articles desc;
limit 3;
fetch { ""organization"": $o.name };"
companies,704,What are the 5 most recent articles about organizations in 'Seattle'?,"MATCH (c:City {name: 'Seattle'})<-[:IN_CITY]-(o:Organization)<-[:MENTIONS]-(a:Article) RETURN a.title AS title, a.date AS date, o.name AS organization ORDER BY a.date DESC LIMIT 5","match $c isa city, has city_name ""Seattle""; $o isa organization; $a isa article; (organization: $o, city: $c) isa located_in; $a has date $a_date; (article: $a, mentioned: $o) isa mentions; sort $a_date desc; limit 5; fetch { ""title"": $a.title, ""date"": $a.date, ""organization"": $o.name };"
companies,705,Who are the 3 most recently appointed CEOs in the tech industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name CONTAINS 'Technology'
WITH o
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS CEO, o.name AS Company
ORDER BY ceo.id DESC
LIMIT 3","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $c has industry_category_name $c_industry_category_name;
  $c_industry_category_name contains ""Technology"";
  $ceo has person_id $ceo_person_id;
sort $ceo_person_id desc;
limit 3;
fetch { ""CEO"": $ceo.name, ""Company"": $o.name };"
companies,709,Name the top 5 organizations by number of articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article) RETURN o.name AS organization, count(a) AS mentions ORDER BY mentions DESC LIMIT 5","match $o isa organization, has name $n; $a isa article; (article: $a, mentioned: $o) isa mentions; reduce $mentions = count($a) groupby $o; match $o has name $n; sort $mentions desc; limit 5; fetch { ""organization"": $n, ""mentions"": $mentions };"
companies,710,Who are the top 5 CEOs of organizations based in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) MATCH (o)-[:HAS_CEO]->(ceo:Person) RETURN ceo.name AS ceoName, o.name AS orgName ORDER BY o.revenue DESC LIMIT 5","match $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; $o has revenue $o_revenue; sort $o_revenue desc; limit 5; fetch { ""ceoName"": $ceo.name, ""orgName"": $o.name };"
companies,711,List the first 3 organizations mentioned in articles published by 'Silicon UK'.,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)
WHERE article.siteName = 'Silicon UK'
RETURN org.name
LIMIT 3","match
  $article isa article;
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
  $article has site_name ""Silicon UK"";
limit 3;
fetch { ""name"": $org.name };"
companies,713,Find the top 5 organizations with revenue over 100 million that have subsidiaries.,"MATCH (o:Organization)
WHERE o.revenue > 1E8 AND EXISTS {
  (o)-[:HAS_SUBSIDIARY]->(:Organization)
}
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,714,Who are the board members of the first 3 public organizations?,"MATCH (o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
WITH o
ORDER BY o.name
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, collect(p.name) AS board_members","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has is_public $o_is_public;
  $o has is_public true;
  $o has name $o_name;
sort $o_name asc;
limit 3;
fetch { ""organization"": $o.name };"
companies,716,List the first 3 cities where 'Accenture' has subsidiaries.,MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(city:City) RETURN city.name LIMIT 3,"match $accenture isa organization, has name ""Accenture""; $sub isa organization; $city isa city; (parent: $accenture, subsidiary: $sub) isa subsidiary_of; (organization: $accenture, city: $city) isa located_in; limit 3; fetch { ""city_name"": $city.city_name };"
companies,717,What are the top 5 highest revenue organizations that are not public?,"MATCH (o:Organization)
WHERE o.isPublic = false AND o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization;
  $o has is_public false;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,718,"Which organizations in New York City have the most employees, list the top 3.","MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'New York'}) WHERE o.nbrEmployees IS NOT NULL RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees ORDER BY o.nbrEmployees DESC LIMIT 3","match $o isa organization; $city isa city, has city_name ""New York""; (organization: $o, city: $city) isa located_in; $o has nbr_employees $o_nbr_employees; sort $o_nbr_employees desc; limit 3; fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,719,List the first 3 organizations in the 'Software' industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Software'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Software"";
  (organization: $o, category: $c) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,720,Who are the top 3 investors of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_INVESTOR]-(investor)
RETURN investor.name AS investor, investor.summary AS summary
ORDER BY investor.name
LIMIT 3","match
  $o isa organization, has name ""New Energy Group"";
  (investor: $investor, organization: $o) isa invested_in;
  $investor has name $investor_name;
sort $investor_name desc;
limit 3;
fetch { ""investor"": $investor.name, ""summary"": $investor.summary };"
companies,722,"Which organizations have more than 2 competitors, list the top 3.","MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization)
WITH o, count(c) AS numCompetitors
WHERE numCompetitors > 2
RETURN o.name AS organization, numCompetitors
ORDER BY numCompetitors DESC
LIMIT 3","match
  $o isa organization;
  $c isa organization;
  (competitor: $o, competitor: $c) isa competes_with;
reduce $numCompetitors = count($c) groupby $o;
match $numCompetitors > 2;
sort $numCompetitors desc;
limit 3;
fetch { ""organization"": $o.name, ""numCompetitors"": $numCompetitors };"
companies,723,What are the top 3 articles mentioning organizations in the 'Financial Services' industry?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Financial Services'})
RETURN a.title AS article, a.date AS publishedDate
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Financial Services"";
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  (organization: $o, category: $c) isa in_category;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""publishedDate"": $a.date };"
companies,724,"Which cities are linked to more than 5 organizations, list the first 3.","MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
WHERE orgCount > 5
RETURN c.name AS city, orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $o1 isa organization;
  $o2 isa organization;
  $c isa country;
  (competitor: $o1, competitor: $o2) isa competes_with;
  $city isa city; (organization: $o1, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o1.name, ""competitor"": $o2.name, ""country"": $c.country_name };"
companies,726,List the top 5 organizations that are competitors of 'Accenture'.,"MATCH (a:Organization {name: 'Accenture'})-[:HAS_COMPETITOR]->(c:Organization) RETURN c.name AS competitor, c.revenue AS revenue ORDER BY revenue DESC LIMIT 5","match $a isa organization, has name ""Accenture""; $c isa organization; (competitor: $a, competitor: $c) isa competes_with; limit 5; fetch { ""competitor"": $c.name, ""revenue"": $c.revenue };"
companies,727,What are the first 3 industries mentioned in articles with a positive sentiment over 0.8?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(i:IndustryCategory) WHERE a.sentiment > 0.8 RETURN DISTINCT i.name LIMIT 3","match $a isa article; $c isa chunk; $o isa organization; $i isa industry_category; (article: $a, chunk: $c) isa has_chunk; (article: $a, mentioned: $o) isa mentions; $a has sentiment $a_sentiment; $a_sentiment > 0.8; (organization: $o, category: $i) isa in_category; limit 3; fetch { ""industry_category_name"": $i.industry_category_name };"
companies,728,List the top 5 countries by number of cities mentioned in the database.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)
WITH c, count(city) AS cityCount
ORDER BY cityCount DESC
LIMIT 5
RETURN c.name AS country, cityCount","match
  $c isa country;
  $city isa city;
  (child: $city, parent: $c) isa location-contains;
reduce $cityCount = count($city) groupby $c;
sort $cityCount desc;
limit 5;
fetch { ""country"": $c.country_name, ""cityCount"": $cityCount };"
companies,729,Which organizations are mentioned in articles authored by 'David Correa'?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)
RETURN DISTINCT o.name AS organization","match
  $a isa article, has author ""David Correa"";
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
fetch { ""organization"": $o.name };"
companies,734,List the top 5 CEOs of organizations with revenue greater than 50 million.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE o.revenue > 5e7 RETURN ceo.name AS ceoName, o.name AS orgName, o.revenue AS revenue ORDER BY o.revenue DESC LIMIT 5","match $o isa organization; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; $o has revenue $o_revenue; $o_revenue > 50000000; sort $o_revenue desc; limit 5; fetch { ""ceoName"": $ceo.name, ""orgName"": $o.name, ""revenue"": $o.revenue };"
companies,735,"Which industries have more than 5 organizations associated with them, list the top 3.","MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WITH ic, count(o) AS orgCount
WHERE orgCount > 5
RETURN ic.name AS industry, orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $ic isa industry_category;
  $o isa organization;
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $ic;
match $orgCount > 5;
sort $orgCount desc;
limit 3;
fetch { ""industry"": $ic.industry_category_name, ""orgCount"": $orgCount };"
companies,736,What are the first 3 articles mentioning organizations based in the United States?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN a.title AS article, o.name AS organization
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article, has title $t, has date $d;
  $o isa organization, has name $on;
  $c isa country, has country_name ""United States of America"";
  $city isa city;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
sort $d desc;
limit 3;
fetch { ""article"": $t, ""organization"": $on };"
companies,737,List the first 3 organizations that have 'Google' as a competitor.,MATCH (o:Organization)-[:HAS_COMPETITOR]->(:Organization {name: 'Google'}) RETURN o.name AS organization LIMIT 3,"match
  $o isa organization, has name ""Google"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
limit 3;
fetch { ""competitor"": $competitor.name };"
companies,739,Who are the board members of the first 3 organizations in the 'Technology' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Technology'})
WITH o
ORDER BY o.name
LIMIT 3
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, collect(p.name) AS board_members","match
  $o isa organization, has name $on;
  $c isa industry_category, has industry_category_name ""Technology"";
  $p isa person, has name $pn;
  (organization: $o, category: $c) isa in_category;
  (organization: $o, member: $p) isa board_member_of;
limit 3;
fetch { ""organization"": $on, ""board_member"": $pn };"
companies,741,Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""o"": $o };"
companies,743,What are the top 5 articles with the highest sentiment scores mentioning organizations in 'Seattle'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) RETURN a.title AS article, a.sentiment AS sentiment ORDER BY sentiment DESC LIMIT 5","match $a isa article; $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; (article: $a, mentioned: $o) isa mentions; limit 5; fetch { ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,744,Who are the top 3 parents of 'Julie Spellman Sweet'?,MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CHILD]-(parent:Person) RETURN parent.name LIMIT 3,"match $p isa person, has name ""Julie Spellman Sweet""; $parent isa person; (parent: $p, child: $parent) isa parent_of; limit 3; fetch { ""name"": $parent.name };"
companies,746,"Which organizations have a motto related to 'security', list the top 3.","MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
RETURN o.name AS organization, o.motto AS motto
ORDER BY o.name
LIMIT 3","match $a isa article; $a has date $a_date; $a_date > 2021-01-01T00:00:00; sort $a_date desc; limit 3; fetch { ""a"": $a };"
companies,747,List the first 3 countries with organizations that have more than 100 employees.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization) WHERE o.nbrEmployees > 100 RETURN c.name AS country, count(o) AS numOrganizations ORDER BY numOrganizations DESC LIMIT 3","match $c isa country; $city isa city; $o isa organization; (child: $city, parent: $c) isa location-contains; $o has nbr_employees $o_nbr_employees; $o_nbr_employees > 100; (organization: $o, city: $city) isa located_in; limit 3; reduce $numOrganizations = count($o);"
companies,748,What are the top 3 articles mentioning 'New Energy Group'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'New Energy Group'})
RETURN a.title AS title, a.siteName AS siteName, a.date AS date
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization, has name ""New Energy Group"";
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""title"": $a.title, ""siteName"": $a.site_name, ""date"": $a.date };"
companies,750,"Which organizations in Rome have a 'Software' category, list the top 3.","MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Rome'})
WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Software'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
  $ic isa industry_category, has industry_category_name ""Software""; (organization: $o, category: $ic) isa in_category;
limit 3;
fetch { ""name"": $o.name };"
companies,752,What are the top 5 articles with the earliest publication dates mentioning 'Accenture'?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'Accenture'})
RETURN a.title AS title, a.date AS publicationDate, a.siteName AS siteName, a.author AS author
ORDER BY a.date
LIMIT 5","match
  $a isa article;
  $o isa organization, has name ""Accenture"";
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
sort $a_date asc;
limit 5;
fetch { ""title"": $a.title, ""publicationDate"": $a.date, ""siteName"": $a.site_name, ""author"": $a.author };"
companies,753,"Which organizations have been mentioned in articles with a sentiment greater than 0.7, list the top 3.","MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.7
RETURN o.name AS organization, a.title AS article, a.sentiment AS sentiment
ORDER BY sentiment DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.7;
limit 3;
fetch { ""organization"": $o.name, ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,754,Who are the top 3 CEOs of dissolved organizations?,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)
WHERE o.isDissolved = true
RETURN p.name AS ceoName, o.name AS orgName
ORDER BY o.revenue DESC
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved true;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""ceoName"": $p.name, ""orgName"": $o.name };"
companies,756,"Which organizations have 'Apple' as a competitor, list the top 3.","MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization {name: 'Apple'})
RETURN o.name AS organization
ORDER BY o.name
LIMIT 3","match
  $o isa organization;
  $c isa organization, has name ""Apple"";
  (competitor: $o, competitor: $c) isa competes_with;
  $o has name $o_name;
sort $o_name desc;
limit 3;
fetch { ""organization"": $o.name };"
companies,757,List the first 3 CEOs of organizations with less than 50 employees.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.nbrEmployees < 50
RETURN p.name AS CEO, o.name AS Organization
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name, ""numEmployees"": $o.nbr_employees };"
companies,758,What are the top 5 organizations in the 'Transportation' industry with the most revenue?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Transportation'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Transportation"";
  (organization: $o, category: $c) isa in_category;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,759,List the top 3 articles mentioning organizations with a summary containing 'financial services'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.summary CONTAINS 'financial services'
RETURN a.title AS article, a.siteName AS site, a.date AS published
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has summary $o_summary;
  $o_summary contains ""financial services"";
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""site"": $a.site_name, ""published"": $a.date };"
companies,760,"Which organizations have a board member named 'Julie Spellman Sweet', list the top 3.","MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_BOARD_MEMBER]-(o:Organization)
RETURN o.name AS organization
LIMIT 3","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
limit 3;
fetch { ""organization"": $o.name };"
companies,761,List the top 5 organizations that have an investor named 'Julie Spellman Sweet'.,"MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_INVESTOR]->(o:Organization)
RETURN o.name AS organization, o.summary AS summary
LIMIT 5","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
limit 5;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,763,List the first 3 organizations in 'Chicago' that have been mentioned in articles with a sentiment below 0.6.,MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Chicago'}) WHERE EXISTS { ... (a:Article) WHERE a.sentiment < 0.6 } RETURN o.name LIMIT 3,"match $o isa organization; $city isa city, has city_name ""Chicago""; (organization: $o, city: $city) isa located_in; $a has sentiment $a_sentiment; $a_sentiment < 0.6; limit 3; fetch { ""name"": $o.name };"
companies,764,Which organizations are mentioned in articles authored by David Correa?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Software"";
  $ch isa chunk;
  $city isa city;
  (article: $a, mentioned: $o) isa mentions;
  (article: $a, chunk: $ch) isa has_chunk;
  (organization: $o, city: $city) isa located_in;
  (organization: $o, category: $c) isa in_category;
fetch { ""city_name"": $city.city_name };"
companies,765,List all organizations that have a revenue greater than $1 billion.,"MATCH (o:Organization) WHERE o.revenue > 1.0E9 RETURN o.name AS organization, o.revenue AS revenue","match $o isa organization; $o has revenue $o_revenue; $o_revenue > 1000000000; fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,767,Who are the CEOs of organizations located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) MATCH (o)-[:HAS_CEO]->(ceo:Person) RETURN o.name AS organization, ceo.name AS ceo","match $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,768,Which organizations are competitors of Deja vu Security?,"MATCH (o:Organization {name: 'Deja vu Security'})-[:HAS_COMPETITOR]->(competitor:Organization)
RETURN competitor","match
  $o isa organization, has name ""Deja vu Security"";
  $competitor isa organization;
  (competitor: $o, competitor: $competitor) isa competes_with;
fetch { ""competitor"": $competitor };"
companies,769,"Which organizations have more than 1,000 employees and are not public?","MATCH (o:Organization)
WHERE o.nbrEmployees > 1000 AND o.isPublic = false
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
  $o has is_public false;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $o.nbr_employees };"
companies,771,Which organizations are suppliers to Accenture?,"MATCH (supplier:Organization)-[:HAS_SUPPLIER]->(accenture:Organization {name: 'Accenture'})
RETURN supplier","match
  $supplier isa organization;
  $accenture isa organization, has name ""Accenture"";
  (customer: $supplier, supplier: $accenture) isa supplies;
fetch { ""supplier"": $supplier };"
companies,772,What are the top 5 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match $o isa organization; $ceo isa person; $a isa article; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""article"": $a.title };"
companies,773,Which industry categories does New Energy Group belong to?,"MATCH (o:Organization {name: 'New Energy Group'})-[:HAS_CATEGORY]->(c:IndustryCategory)
RETURN c.name","match
  $o isa organization, has name ""New Energy Group"";
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
fetch { ""industry_category_name"": $c.industry_category_name };"
companies,774,List all people who are board members of organizations in Houston.,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]-(o:Organization)-[:IN_CITY]->(:City {name: 'Houston'})
RETURN p.name AS person, o.name AS organization","match
  $p isa person, has name $pn;
  $o isa organization, has name $on;
  $city isa city, has city_name ""Houston"";
  (organization: $o, member: $p) isa board_member_of;
  (organization: $o, city: $city) isa located_in;
fetch { ""person"": $pn, ""organization"": $on };"
companies,776,List the articles that mention the organization 'New Energy Group'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'New Energy Group'})
RETURN a","match
  $a isa article;
  $o isa organization, has name ""New Energy Group"";
  (article: $a, mentioned: $o) isa mentions;
fetch { ""a"": $a };"
companies,777,What are the names of the children of Julie Spellman Sweet?,"MATCH (p:Person {name: ""Julie Spellman Sweet""})-[:HAS_CHILD]->(child:Person)
RETURN child.name","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $child isa person;
(parent: $p, child: $child) isa parent_of; fetch { ""name"": $child.name };"
companies,778,Which countries have cities that are mentioned in articles with a positive sentiment (>0.5)?,MATCH (article:Article)-[:HAS_CHUNK]->(:Chunk) WHERE article.sentiment > 0.5 WITH article MATCH (article)-[:MENTIONS]->(:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country:Country) RETURN DISTINCT country.name,"match $article isa article; $country isa country; $article has sentiment $article_sentiment; $article_sentiment > 0.5; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $country) isa location-contains; fetch { ""country_name"": $country.country_name };"
companies,779,Which organizations are headquartered in cities within the United States of America?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'})
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,780,Who are the board members of organizations with more than $500 million in revenue?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person) WHERE o.revenue > 5e8 RETURN o.name AS organization, p.name AS board_member","match $o isa organization; $p isa person; (organization: $o, member: $p) isa board_member_of; $o has revenue $o_revenue; $o_revenue > 500000000; fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,781,What are the names of organizations that are subsidiaries of Accenture?,"MATCH (accenture:Organization {name: 'Accenture'})-[:HAS_SUBSIDIARY]->(subsidiary:Organization)
RETURN subsidiary.name","match
  $o isa organization, has name ""Accenture"";
  $subsidiary isa organization;
  (parent: $o, subsidiary: $subsidiary) isa subsidiary_of;
fetch { ""subsidiary"": $subsidiary.name };"
companies,782,List all organizations that are public and have no employees listed.,MATCH (o:Organization) WHERE o.isPublic = true AND o.nbrEmployees IS NULL RETURN o,"match $o isa organization; $o has is_public true; fetch { ""o"": $o };"
companies,784,List the organizations that have a sentiment score above 0.8 in their latest article mention.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, max(a.date) AS latestDate
MATCH (o)<-[:MENTIONS]-(article:Article {date: latestDate})
WHERE article.sentiment > 0.8
RETURN o.name AS organization, article.title AS latestArticle, article.sentiment AS sentiment","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $article isa article;
  (article: $article, mentioned: $o) isa mentions;
fetch { ""organization"": $o.name, ""latestArticle"": $article.title, ""sentiment"": $article.sentiment };"
companies,785,What is the summary of the city where New Energy Group is located?,"MATCH (o:Organization {name: 'New Energy Group'})-[:IN_CITY]->(c:City)
RETURN c.summary","match
  $o isa organization, has name ""New Energy Group"";
  $c isa city;
  (organization: $o, city: $c) isa located_in;
fetch { ""city_summary"": $c.city_summary };"
companies,786,Which organizations have a motto that includes the word 'technology'?,"MATCH (o:Organization) WHERE o.motto IS NOT NULL AND toLower(o.motto) CONTAINS 'technology' RETURN o.name AS organization, o.motto AS motto","match $o isa organization; $o has motto $o_motto; fetch { ""organization"": $o.name, ""motto"": $o.motto };"
companies,787,List the authors who have mentioned more than three different organizations in their articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization) 
WITH a.author AS author, count(DISTINCT o) AS org_count
WHERE org_count > 3
RETURN author","match
  $a isa article, has author $auth;
  $o1 isa organization;
  $o2 isa organization;
  $o3 isa organization;
  $o4 isa organization;
  (article: $a, mentioned: $o1) isa mentions;
  (article: $a, mentioned: $o2) isa mentions;
  (article: $a, mentioned: $o3) isa mentions;
  (article: $a, mentioned: $o4) isa mentions;
  $o1 has organization_id $id1;
  $o2 has organization_id $id2;
  $o3 has organization_id $id3;
  $o4 has organization_id $id4;
  $id1 != $id2;
  $id1 != $id3;
  $id1 != $id4;
  $id2 != $id3;
  $id2 != $id4;
  $id3 != $id4;
fetch { ""author"": $auth };"
companies,788,Which organizations are mentioned in articles posted on MrWeb?,"MATCH (article:Article {siteName: 'MrWeb'})-[:MENTIONS]->(org:Organization)
RETURN DISTINCT org.name AS organization","match
  $article isa article, has site_name ""MrWeb"";
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
fetch { ""organization"": $org.name };"
companies,789,List all organizations that are not public but have subsidiaries.,MATCH (o:Organization) WHERE o.isPublic IS NOT NULL AND NOT o.isPublic AND EXISTS { (o)-[:HAS_SUBSIDIARY]->(:Organization) } RETURN o,"match $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of; $o has is_public $o_is_public; fetch { ""o"": $o };"
companies,790,Who are the investors in the organization 'Accenture' who are also people?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization {name: 'Accenture'})
RETURN p.name AS investor","match
  $p isa person;
  $o isa organization, has name ""Accenture"";
  (investor: $p, organization: $o) isa invested_in;
fetch { ""investor"": $p.name };"
companies,792,"Which organizations have more than 10,000 employees and are located in a city that is not the capital of a country?","MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country) WHERE o.nbrEmployees > 10000 AND NOT EXISTS {(c)<-[:CAPITAL_OF]-(country)} RETURN o.name AS organization, c.name AS city, country.name AS country","match $o isa organization; $c isa city; $country isa country; (organization: $o, city: $c) isa located_in; $o has nbr_employees $o_nbr_employees; $o_nbr_employees > 10000; (child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name, ""country"": $country.country_name };"
companies,793,List the articles that have a sentiment score below 0.3.,"MATCH (a:Article)
WHERE a.sentiment < 0.3
RETURN a","match
  $a isa article;
  $a has sentiment $a_sentiment;
  $a_sentiment < 0.3;
fetch { ""a"": $a };"
companies,794,Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""o"": $o };"
companies,795,What are the names of the top 5 organizations in terms of number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match
  $c isa country;
  $city isa city;
  $o isa organization;
  (child: $city, parent: $c) isa location-contains;
  $o has is_public $o_is_public;
  $o has is_public true;
  (organization: $o, city: $city) isa located_in;
reduce $numCities = count($city) groupby $c;
sort $numCities desc;
limit 10;
fetch { ""country"": $c.country_name, ""numCities"": $numCities };"
companies,796,Which organizations are mentioned in articles about cybersecurity?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)
WHERE c.text CONTAINS 'cybersecurity'
RETURN DISTINCT o.name AS organization","match
  $a isa article;
  $c isa chunk;
  $o isa organization;
  (article: $a, chunk: $c) isa has_chunk;
  (article: $a, mentioned: $o) isa mentions;
  $c has text $c_text;
  $c_text contains ""cybersecurity"";
fetch { ""organization"": $o.name };"
companies,797,Which organizations have a parent organization with a revenue of more than $100 million?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE o.revenue > 1E8
RETURN sub.name AS Subsidiary, o.name AS Parent","match
  $o isa organization;
  $sub isa organization;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
fetch { ""Subsidiary"": $sub.name, ""Parent"": $o.name };"
companies,798,List the cities where organizations with a public status are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has is_public $o_is_public;
  $o has is_public true;
fetch { ""city_name"": $c.city_name };"
companies,799,What are the industry categories for organizations headquartered in Chattanooga?,MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Chattanooga'}) MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory) RETURN DISTINCT c.name,"match $o isa organization; $city isa city, has city_name ""Chattanooga""; (organization: $o, city: $city) isa located_in; $c isa industry_category; (organization: $o, category: $c) isa in_category; fetch { ""industry_category_name"": $c.industry_category_name };"
companies,800,Which organizations have a summary that mentions the word 'software'?,MATCH (o:Organization) WHERE o.summary IS NOT NULL AND toLower(o.summary) CONTAINS 'software' RETURN o,"match $o isa organization; $o has summary $o_summary; fetch { ""o"": $o };"
companies,802,Which organizations are mentioned in articles from the year 2022?,MATCH (a:Article)-[:MENTIONS]->(o:Organization) WHERE a.date.year = 2022 RETURN DISTINCT o,"match $a isa article; $o isa organization; (article: $a, mentioned: $o) isa mentions; fetch { ""o"": $o };"
companies,804,What are the summaries of articles mentioning organizations in the electronics industry?,MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory) WHERE c.name CONTAINS 'Electronic' RETURN a.summary,"match $a isa article; $o isa organization; $c isa industry_category; (article: $a, mentioned: $o) isa mentions; $c has industry_category_name $c_industry_category_name; $c_industry_category_name contains ""Electronic""; (organization: $o, category: $c) isa in_category; fetch { ""article_summary"": $a.article_summary };"
companies,805,Which countries are associated with cities that host major software companies?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Software'})
RETURN DISTINCT c.name AS country","match
  $c isa country;
  $city isa city;
  $o isa organization;
  (child: $city, parent: $c) isa location-contains;
  (organization: $o, city: $city) isa located_in;
  $ic isa industry_category, has industry_category_name ""Software""; (organization: $o, category: $ic) isa in_category;
fetch { ""country"": $c.country_name };"
companies,806,List all organizations that have subsidiaries and are not dissolved.,MATCH (o:Organization) WHERE EXISTS {(o)-[:HAS_SUBSIDIARY]->(:Organization)} AND o.isDissolved IS NOT NULL AND NOT o.isDissolved RETURN o,"match $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of; $o has is_dissolved false; fetch { ""o"": $o };"
companies,807,Who are the children of persons named in the organization board member directories?,"MATCH (p:Person)<-[:HAS_BOARD_MEMBER]-(o:Organization) WITH p MATCH (p)-[:HAS_CHILD]->(child:Person) RETURN p.name AS boardMember, child.name AS childName","match $p isa person; $o isa organization; (organization: $o, member: $p) isa board_member_of; $child isa person; (parent: $p, child: $child) isa parent_of; fetch { ""boardMember"": $p.name, ""childName"": $child.name };"
companies,808,List the top 3 organizations with the highest sentiment score in their mentioned articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article) WITH o, avg(a.sentiment) AS avgSentiment WHERE avgSentiment IS NOT NULL RETURN o.name AS organization, avgSentiment ORDER BY avgSentiment DESC LIMIT 3","match $o isa organization, has name $n; $a isa article, has sentiment $s; (article: $a, mentioned: $o) isa mentions; reduce $avg_sentiment = mean($s) groupby $o; match $o has name $n; sort $avg_sentiment desc; limit 3; fetch { ""organization"": $n, ""avgSentiment"": $avg_sentiment };"
companies,809,Which organizations have industry categories that include 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE c.name = 'Electronic Products Manufacturers'
RETURN o.name AS organization","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
  $c has industry_category_name ""Electronic Products Manufacturers"";
fetch { ""organization"": $o.name };"
companies,810,Who are the current CEOs of public organizations?,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(p:Person) WHERE o.isDissolved IS NOT NULL AND NOT o.isDissolved RETURN o.name AS organization, p.name AS ceo","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,811,What are the challenges faced by organizations headquartered in non-capital cities?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.name <> c.summary AND c.summary CONTAINS ""capital""
WITH o, c
OPTIONAL MATCH (o)-[:HAS_CATEGORY]->(cat:IndustryCategory)
OPTIONAL MATCH (o)<-[:MENTIONS]-(a:Article)
RETURN o.name AS organization, o.summary AS org_summary, c.name AS city, 
       c.summary AS city_summary, cat.name AS industry, 
       a.title AS article_title, a.summary AS article_summary
ORDER BY o.name","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has name $o_name;
  $ic isa industry_category; (organization: $o, category: $ic) isa in_category;
sort $o_name asc;
fetch { ""organization"": $o.name, ""org_summary"": $o.summary, ""city"": $c.city_name };"
companies,812,List the countries where organizations with a revenue less than $10 million are located.,MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE o.revenue < 10000000 RETURN DISTINCT c.name,"match
  $o isa organization;
  $c isa country, has country_name $cn;
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $o has revenue $r;
  $r < 10000000;
fetch { ""country"": $cn };"
companies,813,Which organizations have a CEO and also have a subsidiary?,MATCH (o:Organization)-[:HAS_CEO]->(:Person) WHERE EXISTS {(o)-[:HAS_SUBSIDIARY]->(:Organization)} RETURN o,"match $o isa organization; $subsidiary isa organization; (parent: $o, subsidiary: $subsidiary) isa subsidiary_of; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""o"": $o };"
companies,815,Which organizations are suppliers to companies in the energy sector?,"MATCH (supplier:Organization)-[:HAS_SUPPLIER]->(company:Organization) WHERE (company)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Energy'}) RETURN supplier, company","match $supplier isa organization; $company isa organization; (customer: $supplier, supplier: $company) isa supplies; $ic isa industry_category, has industry_category_name ""Energy""; (organization: $supplier, category: $ic) isa in_category; fetch { ""supplier"": $supplier, ""company"": $company };"
companies,817,List the industries that have organizations with CEOs named 'Julie Spellman Sweet'.,MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_CEO]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory) RETURN DISTINCT ic.name,"match $p isa person, has name ""Julie Spellman Sweet""; $o isa organization; $ic isa industry_category; (organization: $o, ceo: $p) isa ceo_of; (organization: $o, category: $ic) isa in_category; fetch { ""industry_category_name"": $ic.industry_category_name };"
companies,818,Which organizations have more than 500 employees and have been dissolved?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 500 AND o.isDissolved = true
RETURN o","match
  $o isa organization;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
  $o has is_dissolved true;
fetch { ""o"": $o };"
companies,819,Who are the board members of the top 5 organizations by revenue?,"MATCH (o:Organization)
WITH o
ORDER BY o.revenue DESC
LIMIT 5
MATCH (o)-[:HAS_BOARD_MEMBER]->(p:Person)
RETURN o.name AS organization, p.name AS board_member","match
  $o isa organization;
  $p isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 5;
fetch { ""organization"": $o.name, ""board_member"": $p.name };"
companies,820,What are the names of organizations that are suppliers to more than three other organizations?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(supplier:Organization)
WITH supplier, count(o) as num_orgs_supplied
WHERE num_orgs_supplied > 3
RETURN supplier.name as supplier_name","match
  $o isa organization;
  $supplier isa organization;
  (customer: $o, supplier: $supplier) isa supplies;
reduce $num_orgs_supplied = count($o) groupby $supplier;
match $num_orgs_supplied > 3;
fetch { ""supplier_name"": $supplier.name };"
companies,821,Which organizations have a parent company named 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE o.name = 'Accenture'
RETURN sub","match
  $o isa organization;
  $sub isa organization;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $o has name ""Accenture"";
fetch { ""sub"": $sub };"
companies,823,Which organizations have a CEO who has authored articles?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:AUTHOR]-(a:Article) RETURN o.name AS organization, ceo.name AS ceo, a.title AS article","match $o isa organization; $ceo isa person; $a isa article; (organization: $o, ceo: $ceo) isa ceo_of; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""article"": $a.title };"
companies,824,What are the organizations that are headquartered in cities that are also mentioned in articles with a positive sentiment?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)<-[:MENTIONS]-(a:Article) WHERE a.sentiment > 0 RETURN DISTINCT o.name AS organization, c.name AS city","match $o isa organization; $c isa city; $a isa article; (organization: $o, city: $c) isa located_in; $a has sentiment $a_sentiment; $a_sentiment > 0; (article: $a, mentioned: $o) isa mentions; fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,825,Which organizations have CEOs that are also board members of other organizations?,"MATCH (o1:Organization)-[:HAS_CEO]->(p:Person) WHERE EXISTS { (p)-[:HAS_BOARD_MEMBER]->(o2:Organization) WHERE o1 <> o2 } RETURN o1.name AS organization, p.name AS ceo_and_board_member","match $o1 isa organization; $p isa person; (organization: $o1, ceo: $p) isa ceo_of; (organization: $o1, member: $p) isa board_member_of; fetch { ""organization"": $o1.name, ""ceo_and_board_member"": $p.name };"
companies,826,Who are the investors of organizations with a revenue exceeding $500 million?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor)
WHERE o.revenue > 5e8
RETURN o.name AS organization, investor.name AS investor","match
  $o isa organization, has name $on;
  $investor isa person, has name $in;
  (organization: $o, investor: $investor) isa invested_in;
  $o has revenue $r;
  $r > 500000000;
fetch { ""organization"": $on, ""investor"": $in };"
companies,827,What are the names of the top 3 organizations in terms of revenue in the electronics industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,828,Which organizations have more than one industry category?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) as categoryCount
WHERE categoryCount > 1
RETURN o.name as organization, categoryCount","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
reduce $categoryCount = count($c) groupby $o;
match $categoryCount > 1;
fetch { ""organization"": $o.name, ""categoryCount"": $categoryCount };"
companies,830,What are the names of organizations that have a motto mentioning 'innovation'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'innovation'
RETURN o.name","match
  $o isa organization;
  $ceo isa person;
  $country isa country;
  $parent isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $country) isa location-contains; (parent: $ceo, child: $parent) isa parent_of; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""country"": $country.country_name };"
companies,831,Which organizations are headquartered in cities named 'Rome' across different countries?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Rome'})-[:IN_COUNTRY]->(country:Country)
RETURN o.name AS organization, country.name AS country","match
  $o isa organization;
  $c isa city, has city_name ""Rome"";
  $country isa country;
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""country"": $country.country_name };"
companies,832,Who are the children of CEOs of organizations with a revenue over $1 billion?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE o.revenue > 1.0E9 WITH ceo MATCH (ceo)-[:HAS_CHILD]->(child:Person) RETURN ceo.name AS ceo_name, child.name AS child_name","match $o isa organization; $ceo isa person; (organization: $o, ceo: $ceo) isa ceo_of; $child isa person; $o has revenue $o_revenue; $o_revenue > 1000000000; (parent: $ceo, child: $child) isa parent_of; fetch { ""ceo_name"": $ceo.name, ""child_name"": $child.name };"
companies,833,List the cities where organizations with more than 500 employees are headquartered.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
fetch { ""city_name"": $c.city_name };"
companies,834,Which organizations have subsidiaries in more than three different countries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WITH o, count(DISTINCT c) AS numCountries
WHERE numCountries > 3
RETURN o.name AS organization, numCountries","match
  $o isa organization;
  $sub isa organization;
  $c isa country;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o.name };"
companies,835,What are the names of organizations that have been dissolved but still have a CEO listed?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name AS organization_name","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved $o_is_dissolved;
  $o has is_dissolved true;
fetch { ""organization_name"": $o.name };"
companies,836,Which organizations have a board member named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_BOARD_MEMBER]-(o:Organization)
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""o"": $o };"
companies,837,Who are the parents of CEOs of organizations that are public?,"MATCH (ceo:Person)<-[:HAS_CEO]-(org:Organization {isPublic: true})<-[:HAS_CHILD]-(parent:Person)
RETURN ceo.name AS CEO, org.name AS Organization, parent.name AS Parent","match
  $ceo isa person;
  $org isa organization, has is_public true;
  $parent isa person;
  (organization: $org, ceo: $ceo) isa ceo_of;
(parent: $ceo, child: $parent) isa parent_of; fetch { ""CEO"": $ceo.name, ""Organization"": $org.name, ""Parent"": $parent.name };"
companies,838,List the organizations that have been mentioned in articles with a sentiment score of exactly 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment = 0.5
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment == 0.5;
fetch { ""o"": $o };"
companies,839,Which organizations have a summary that mentions 'consumer behavior'?,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'consumer behavior'
RETURN o","match $o isa organization; $sub isa organization; $sup isa organization; $c isa country; (parent: $o, subsidiary: $sub) isa subsidiary_of; (customer: $o, supplier: $sup) isa supplies; $city isa city; (organization: $o, city: $city) isa located_in; (child: $city, parent: $c) isa location-contains; fetch { ""organization"": $o.name, ""country"": $c.country_name };"
companies,840,What are the countries where organizations with a public status are headquartered?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN DISTINCT c.name","match
  $o isa organization;
  $c isa country;
  $o has is_public $o_is_public;
  $o has is_public true;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; fetch { ""country_name"": $c.country_name };"
companies,841,Which organizations are mentioned in articles with titles containing the word 'security'?,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)
WHERE article.title CONTAINS 'security'
RETURN DISTINCT org.name AS organization","match
  $article isa article;
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
  $article has title $article_title;
  $article_title contains ""security"";
fetch { ""organization"": $org.name };"
companies,842,List the organizations that have more than five categories listed in their industry classification.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(c) AS categoryCount
WHERE categoryCount > 5
RETURN o.name AS organization, categoryCount","match
  $o isa organization;
  $c isa industry_category;
  (organization: $o, category: $c) isa in_category;
reduce $categoryCount = count($c) groupby $o;
match $categoryCount > 5;
fetch { ""organization"": $o.name, ""categoryCount"": $categoryCount };"
companies,844,List the organizations that have a CEO with the name 'David Correa'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'David Correa'})
RETURN o","match
  $p isa person, has name ""David Correa"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,845,What are the names of organizations that are suppliers to those in the telecommunications industry?,"MATCH (supplier:Organization)-[:HAS_SUPPLIER]->(org:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: 'Telecommunications'})
RETURN supplier.name AS supplier_name","match
  $supplier isa organization;
  $org isa organization;
  $cat isa industry_category, has industry_category_name ""Telecommunications"";
  (customer: $supplier, supplier: $org) isa supplies;
  (organization: $supplier, category: $cat) isa in_category;
fetch { ""supplier_name"": $supplier.name };"
companies,846,Which organizations have a city location with a summary mentioning 'county seat'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city;
  (organization: $o, city: $c) isa located_in;
  $c has city_summary $c_city_summary;
  $c_city_summary contains ""county seat"";
fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,847,"List the articles mentioning organizations with revenues under $500,000.","MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 500000
RETURN a.title, a.summary, a.siteName, a.date, o.name, o.revenue","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has revenue $o_revenue;
  $o_revenue < 500000;
fetch { ""title"": $a.title, ""article_summary"": $a.article_summary, ""site_name"": $a.site_name, ""date"": $a.date, ""name"": $o.name, ""revenue"": $o.revenue };"
companies,848,Who are the parents of the board members of organizations with revenues over $1 million?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)-[:HAS_PARENT]->(parent:Person)
WHERE o.revenue > 1e6
RETURN p.name AS board_member, parent.name AS parent","match
  $o isa organization;
  $p isa person;
  $parent isa person;
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue > 1000000;
(parent: $parent, child: $p) isa parent_of; fetch { ""board_member"": $p.name, ""parent"": $parent.name };"
companies,850,Who are the investors of organizations mentioned in articles with a positive sentiment?,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)<-[:HAS_INVESTOR]-(investor)
WHERE article.sentiment > 0
RETURN DISTINCT investor, org, article","match
  $o isa organization;
  $investor isa person;
  (organization: $o, investor: $investor) isa invested_in;
  $article isa article;
  (article: $article, mentioned: $o) isa mentions;
  $article has sentiment $article_sentiment;
  $article_sentiment > 0;
fetch { ""investor"": $investor.name, ""organization"": $o.name };"
companies,851,Which organizations have a revenue greater than 100 million and are not dissolved?,"MATCH (o:Organization)
WHERE o.revenue > 1E8 AND o.isDissolved IS NOT NULL AND NOT o.isDissolved
RETURN o","match
  $o isa organization;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
  $o has is_dissolved false;
fetch { ""o"": $o };"
companies,852,"List the first 5 organizations that have been mentioned in articles published after January 1st, 2020.","MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date > date(""2020-01-01"")
RETURN o.name
LIMIT 5","match
  $a isa article, has date $a_date;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
$a_date > 2020-01-01T00:00:00; limit 5;
fetch { ""name"": $o.name };"
companies,854,What are the names of the industry categories that have at least three organizations associated with them?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WITH ic, count(o) AS orgCount
WHERE orgCount >= 3
RETURN ic.name","match
  $ic isa industry_category;
  $o isa organization;
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $ic;
match $orgCount >= 3;
fetch { ""industry_category_name"": $ic.industry_category_name };"
companies,855,Identify the first 5 people who are CEOs of public companies.,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization)
WHERE o.isPublic = true
RETURN p.name AS name, o.name AS company
LIMIT 5","match
  $p isa person;
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
limit 5;
fetch { ""name"": $p.name, ""company"": $o.name };"
companies,856,Which organizations have a subsidiary with fewer than 50 employees?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE sub.nbrEmployees < 50
RETURN o.name AS organization, sub.name AS subsidiary, sub.nbrEmployees AS subsidiary_employees","match
  $o isa organization;
  $sub isa organization;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $sub has nbr_employees $sub_nbr_employees;
  $sub_nbr_employees < 50;
fetch { ""organization"": $o.name, ""subsidiary"": $sub.name, ""subsidiary_employees"": $sub.nbr_employees };"
companies,857,List the first 3 countries that are home to more than one city mentioned in the schema.,"MATCH (co:Country)<-[:IN_COUNTRY]-(c:City)
WITH co, count(c) AS numCities
WHERE numCities > 1
RETURN co.name AS country, numCities
ORDER BY numCities DESC
LIMIT 3","match
  $co isa country;
  $c isa city;
  (child: $c, parent: $co) isa location-contains;
reduce $numCities = count($c) groupby $co;
match $numCities > 1;
sort $numCities desc;
limit 3;
fetch { ""country"": $co.country_name, ""numCities"": $numCities };"
companies,859,List the first 5 organizations that are competitors and are both public companies.,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization)
WHERE o1.isPublic = true AND o2.isPublic = true
RETURN o1.name AS Org1, o2.name AS Org2
LIMIT 5","match
  $o1 isa organization;
  $o2 isa organization;
  (competitor: $o1, competitor: $o2) isa competes_with;
  $o1 has is_public true;
  $o2 has is_public true;
limit 5;
fetch { ""Org1"": $o1.name, ""Org2"": $o2.name };"
companies,860,Which organizations have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
RETURN o.name AS organization","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name };"
companies,861,Find the top 3 organizations that have been invested in by more than one person.,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(p:Person)
WITH o, count(p) AS num_investors
WHERE num_investors > 1
RETURN o.name AS organization, num_investors
ORDER BY num_investors DESC
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (investor: $p, organization: $o) isa invested_in;
reduce $num_investors = count($p) groupby $o;
match $num_investors > 1;
sort $num_investors desc;
limit 3;
fetch { ""organization"": $o.name, ""num_investors"": $num_investors };"
companies,863,Identify the first 5 articles that mention organizations headquartered in the United States of America.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN a.title, a.siteName, a.date
LIMIT 5","match
  $a isa article;
  $o isa organization;
  $c isa country, has country_name ""United States of America"";
  (article: $a, mentioned: $o) isa mentions;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; limit 5;
fetch { ""title"": $a.title, ""site_name"": $a.site_name, ""date"": $a.date };"
companies,866,What are the names of the people who are board members of at least two different organizations?,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(o:Organization)
WITH p, count(o) as num_orgs
WHERE num_orgs >= 2
RETURN p.name","match
  $p isa person, has name $pn;
  $o1 isa organization;
  $o2 isa organization;
  (organization: $o1, member: $p) isa board_member_of;
  (organization: $o2, member: $p) isa board_member_of;
  $o1 has organization_id $id1;
  $o2 has organization_id $id2;
  $id1 != $id2;
fetch { ""name"": $pn };"
companies,869,Which organizations are headquartered in a city that is not the capital of its country?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE c.name <> country.name
RETURN o.name AS organization, c.name AS city, country.name AS country","match
  $o isa organization;
  $c isa city;
  $country isa country;
  (organization: $o, city: $c) isa located_in;
(child: $c, parent: $country) isa location-contains; fetch { ""organization"": $o.name, ""city"": $c.city_name, ""country"": $country.country_name };"
companies,870,What are the names of the organizations that have an industry category named 'Electronic Products Manufacturers'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  (organization: $o, category: $c) isa in_category;
limit 3;
fetch { ""organization"": $o.name };"
companies,871,Find the top 3 articles with the highest sentiment scores mentioning organizations with over 1000 employees.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 1000
WITH a
ORDER BY a.sentiment DESC
LIMIT 3
RETURN a.title AS article, a.sentiment AS sentiment","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 1000;
  $a has sentiment $a_sentiment;
sort $a_sentiment desc;
limit 3;
fetch { ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,872,List the first 5 people who are investors in more than one organization.,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) as num_orgs_invested
WHERE num_orgs_invested > 1
RETURN p.name as person, num_orgs_invested as number_of_organizations
ORDER BY num_orgs_invested DESC
LIMIT 5","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
reduce $num_orgs_invested = count($o) groupby $p;
match $num_orgs_invested > 1;
sort $num_orgs_invested desc;
limit 5;
fetch { ""person"": $p.name, ""number_of_organizations"": $num_orgs_invested };"
companies,874,Identify the top 3 organizations that have been dissolved but still have a CEO listed.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE o.isDissolved = true
RETURN o.name AS organization, p.name AS ceo
ORDER BY o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved true;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,875,List the first 5 organizations with the most number of employees that have a subsidiary.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match $o isa organization; $sub isa organization; $city isa city; (parent: $o, subsidiary: $sub) isa subsidiary_of; (organization: $o, city: $city) isa located_in; fetch { ""organization"": $o.name, ""subsidiary"": $sub.name, ""city"": $city.city_name };"
companies,876,What are the names of the organizations that have a subsidiary named 'Accenture'?,"MATCH (parent:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization {name: 'Accenture'})
RETURN parent.name","match
  $parent isa organization;
  $sub isa organization, has name ""Accenture"";
  (parent: $parent, subsidiary: $sub) isa subsidiary_of;
fetch { ""name"": $parent.name };"
companies,878,List the first 5 organizations that have a CEO who has authored an article.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:AUTHORED]-(a:Article)
RETURN o.name AS organization, ceo.name AS ceo, a.title AS article
LIMIT 5","match
  $o isa organization;
  $ceo isa person;
  $a isa article;
  (organization: $o, ceo: $ceo) isa ceo_of;
limit 5;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""article"": $a.title };"
companies,881,List the first 5 organizations with a revenue greater than 50 million that have a competitor.,"MATCH (o:Organization)
WHERE o.revenue > 5e7 AND EXISTS {
  (o)-[:HAS_COMPETITOR]->(:Organization)
}
RETURN o.name AS organization, o.revenue AS revenue
LIMIT 5","match
  $o1 isa organization;
  $o2 isa organization;
  (competitor: $o1, competitor: $o2) isa competes_with;
limit 5;
fetch { ""org1"": $o1.name, ""org2"": $o2.name };"
companies,882,What are the names of the organizations that have a CEO with a summary mentioning 'CEO at Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'CEO at Accenture'
RETURN o.name","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""CEO at Accenture"";
fetch { ""name"": $o.name };"
companies,883,Find the top 3 articles that mention organizations based in Rome.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Rome'})
RETURN a.title AS article, a.date AS publishedDate
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  $city isa city, has city_name ""Rome""; (organization: $o, city: $city) isa located_in;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""publishedDate"": $a.date };"
companies,884,List the first 5 industry categories that have organizations with a summary mentioning 'technology'.,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WHERE o.summary CONTAINS 'technology'
RETURN ic.name AS category
LIMIT 5","match
  $ic isa industry_category;
  $o isa organization;
  (organization: $o, category: $ic) isa in_category;
  $o has summary $o_summary;
  $o_summary contains ""technology"";
limit 5;
fetch { ""category"": $ic.industry_category_name };"
companies,885,Which organizations are mentioned in articles with a sentiment score greater than 0.8?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.8
RETURN DISTINCT o","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.8;
fetch { ""o"": $o };"
companies,886,List the first 5 organizations that have a CEO who is also a board member of another organization.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {(ceo)-[:HAS_BOARD_MEMBER]-(:Organization)}
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 5","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
(organization: $o, member: $ceo) isa board_member_of; limit 5;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,887,What are the names of the organizations that have a supplier with a revenue less than 5 million?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WHERE s.revenue < 5e6
RETURN o.name","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
  $s has revenue $s_revenue;
  $s_revenue < 5;
fetch { ""name"": $o.name };"
companies,888,Find the top 3 organizations that are public and have been mentioned in the most articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
WITH o, count(a) AS mentionCount
ORDER BY mentionCount DESC
LIMIT 3
RETURN o.name AS organization, mentionCount","match
  $o isa organization;
  $a isa article;
  (article: $a, mentioned: $o) isa mentions;
  $o has is_public $o_is_public;
  $o has is_public true;
reduce $mentionCount = count($a) groupby $o;
sort $mentionCount desc;
limit 3;
fetch { ""organization"": $o.name, ""mentionCount"": $mentionCount };"
companies,889,List the first 5 people who have children that are CEOs of an organization.,"MATCH (p:Person)-[:HAS_CHILD]->(child:Person)<-[:HAS_CEO]-(o:Organization)
RETURN p.name AS parent, child.name AS child, o.name AS organization
LIMIT 5","match
  $p isa person;
  $child isa person;
  $o isa organization;
(organization: $o, ceo: $p) isa ceo_of; (parent: $p, child: $child) isa parent_of; limit 5;
fetch { ""parent"": $p.name, ""child"": $child.name, ""organization"": $o.name };"
companies,890,Which organizations have a CEO with the name 'Julie Spellman Sweet' and a revenue greater than 100 million?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE o.revenue > 1E8
RETURN o","match $o isa organization; $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in; $p isa person, has name ""Julie Spellman Sweet""; (organization: $o, ceo: $p) isa ceo_of; fetch { ""name"": $o.name };"
companies,892,List the first 5 organizations that have a subsidiary with a summary mentioning 'Dublin'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE s.summary CONTAINS 'Dublin'
RETURN o.name AS organization, s.name AS subsidiary
LIMIT 5","match
  $o isa organization;
  $s isa organization;
  (parent: $o, subsidiary: $s) isa subsidiary_of;
  $s has summary $s_summary;
  $s_summary contains ""Dublin"";
limit 5;
fetch { ""organization"": $o.name, ""subsidiary"": $s.name };"
companies,893,What are the names of the organizations that have a CEO with a summary mentioning 'Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture'
RETURN o.name","match
  $o isa organization;
  $o has name ""Accenture"";
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $p.name, ""summary"": $o.summary };"
companies,894,Find the top 3 cities mentioned in articles with the highest sentiment scores.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(:Organization)-[:IN_CITY]->(city:City)
WITH city, max(a.sentiment) AS maxSentiment
ORDER BY maxSentiment DESC
LIMIT 3
RETURN city.name AS cityName, maxSentiment","match
  $a isa article;
  $c isa chunk;
  $city isa city;
  (article: $a, chunk: $c) isa has_chunk;
limit 3;
fetch { ""cityName"": $city.city_name };"
companies,896,Which organizations have a subsidiary in a city named 'Seattle'?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o.name AS organization, sub.name AS subsidiary","match
  $o isa organization;
  $sub isa organization;
  $c isa city, has city_name ""Seattle"";
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  (organization: $o, city: $c) isa located_in;
fetch { ""organization"": $o.name, ""subsidiary"": $sub.name };"
companies,898,List the first 5 organizations that have a supplier with a revenue greater than 100 million.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WHERE s.revenue > 1E8
RETURN o.name AS organization, s.name AS supplier
LIMIT 5","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
  $s has revenue $s_revenue;
  $s_revenue > 100000000;
limit 5;
fetch { ""organization"": $o.name, ""supplier"": $s.name };"
companies,899,What are the names of the organizations that have a CEO named after a person with a summary mentioning 'CEO at Accenture'?,"MATCH (p:Person)
WHERE p.summary IS NOT NULL AND p.summary CONTAINS 'CEO at Accenture'
WITH p
MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE ceo.name IS NOT NULL AND ceo.name = p.name
RETURN o.name AS organization","match
  $p isa person;
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""CEO at Accenture"";
fetch { ""organization"": $o.name };"
companies,900,Find the top 3 industry categories with the most organizations.,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WITH ic, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN ic.name AS industryCategory, orgCount","match
  $ic isa industry_category;
  $o isa organization;
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $ic;
sort $orgCount desc;
limit 3;
fetch { ""industryCategory"": $ic.industry_category_name, ""orgCount"": $orgCount };"
companies,901,List the first 5 organizations that have a board member with the same name as a CEO of another organization.,"MATCH (o1:Organization)-[:HAS_BOARD_MEMBER]->(p:Person),
      (o2:Organization)-[:HAS_CEO]->(p2:Person)
WHERE p.name = p2.name AND o1 <> o2
RETURN o1.name AS org_with_board_member, p.name AS person_name, o2.name AS org_with_same_name_ceo
LIMIT 5","match
  $o1 isa organization;
  $p isa person;
  $o2 isa organization;
  $p2 isa person;
  (organization: $o1, member: $p) isa board_member_of;
  (organization: $o2, ceo: $p2) isa ceo_of;
limit 5;
fetch { ""org_with_board_member"": $o1.name, ""person_name"": $p.name, ""org_with_same_name_ceo"": $o2.name };"
companies,902,Which organizations have a supplier named 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization {name: 'Accenture'})
RETURN o.name AS organization","match
  $o isa organization;
  $s isa organization, has name ""Accenture"";
  (customer: $o, supplier: $s) isa supplies;
fetch { ""organization"": $o.name };"
companies,903,What are the names of the organizations that have a board member named 'Julie Spellman Sweet'?,"MATCH (p:Person {name: 'Julie Spellman Sweet'})<-[:HAS_BOARD_MEMBER]-(o:Organization)
RETURN o.name","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""name"": $o.name };"
companies,905,List the first 5 organizations with a motto mentioning 'security' and more than 500 employees.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security' AND o.nbrEmployees > 500
RETURN o.name AS organization, o.motto AS motto, o.nbrEmployees AS employees
LIMIT 5","match
  $o isa organization;
  $o has motto $o_motto;
  $o_motto contains ""security"";
  $o has nbr_employees $o_nbr_employees;
  $o_nbr_employees > 500;
limit 5;
fetch { ""organization"": $o.name, ""motto"": $o.motto, ""employees"": $o.nbr_employees };"
companies,907,Find the top 3 articles with the lowest sentiment scores mentioning organizations based in Chicago.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Chicago'})
WHERE a.sentiment IS NOT NULL
RETURN a.title AS article, a.sentiment AS sentiment
ORDER BY sentiment
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has sentiment $a_sentiment;
  $city isa city, has city_name ""Chicago""; (organization: $o, city: $city) isa located_in;
limit 3;
fetch { ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,908,List the first 5 organizations that have a revenue greater than 10 million and are headquartered in a city named 'Seattle'.,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WHERE o.revenue > 10000000
RETURN o.name AS organization, o.revenue AS revenue
LIMIT 5","match
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  (organization: $o, city: $c) isa located_in;
  $o has revenue $o_revenue;
  $o_revenue > 10000000;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,909,Which organizations have a board member who has authored an article?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)<-[:AUTHORED]-(a:Article)
RETURN DISTINCT o.name AS organization, p.name AS board_member, a.title AS article_title","match
  $o isa organization;
  $p isa person;
  $a isa article;
  (organization: $o, member: $p) isa board_member_of;
fetch { ""organization"": $o.name, ""board_member"": $p.name, ""article_title"": $a.title };"
companies,910,Identify the top 3 organizations with a CEO who has a summary mentioning 'Accenture'.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE ceo.summary CONTAINS 'Accenture'
RETURN o.name AS organization, ceo.name AS ceo
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $ceo has summary $ceo_summary;
  $ceo_summary contains ""Accenture"";
  $o has revenue $o_revenue;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,911,List the first 5 organizations that have a summary mentioning 'software company'.,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'software company'
RETURN o.name, o.summary
LIMIT 5","match
  $o isa organization;
  $o has summary $o_summary;
  $o_summary contains ""software company"";
limit 5;
fetch { ""name"": $o.name, ""summary"": $o.summary };"
companies,912,What are the names of the organizations that have a subsidiary with a revenue greater than 50 million?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization)
WHERE s.revenue > 5e7
RETURN o.name","match
  $o isa organization;
  $s isa organization;
  (parent: $o, subsidiary: $s) isa subsidiary_of;
  $s has revenue $s_revenue;
  $s_revenue > 50000000;
fetch { ""name"": $o.name };"
companies,913,Find the top 3 organizations with the most suppliers.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WITH o, count(s) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 3
RETURN o.name AS organization, supplierCount","match
  $o isa organization;
  $s isa organization;
  (customer: $o, supplier: $s) isa supplies;
reduce $supplierCount = count($s) groupby $o;
sort $supplierCount desc;
limit 3;
fetch { ""organization"": $o.name, ""supplierCount"": $supplierCount };"
companies,914,List the first 5 organizations that are public and have a CEO with a summary mentioning 'Accenture'.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(ceo:Person)
WHERE ceo.summary CONTAINS 'Accenture'
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 5","match
  $o isa organization;
  $o has name ""Accenture"";
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_public true;
limit 5;
fetch { ""organization"": $o.name, ""ceo"": $p.name, ""summary"": $o.summary };"
companies,915,Which organizations have a CEO named 'Julie Spellman Sweet' and are headquartered in 'Seattle'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE (o)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
fetch { ""o"": $o };"
companies,917,List the first 5 organizations with a subsidiary in a country named 'United States of America'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN o.name AS organization, sub.name AS subsidiary
LIMIT 5","match
  $o isa organization;
  $sub isa organization;
  $c isa country, has country_name ""United States of America"";
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $city isa city; (organization: $o, city: $city) isa located_in;
(child: $city, parent: $c) isa location-contains; limit 5;
fetch { ""organization"": $o.name, ""subsidiary"": $sub.name };"
companies,920,List the first 5 organizations that have a CEO with a summary mentioning 'software'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'software'
RETURN o.name AS organization, p.name AS ceo
LIMIT 5","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""software"";
limit 5;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,921,Identify the top 3 organizations with the highest revenue that are headquartered in a country named 'United States of America'.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $c isa country, has country_name ""United States of America"";
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $c) isa location-contains;
  $o has revenue $r;
sort $r desc;
limit 3;
fetch { ""organization"": $on, ""revenue"": $r };"
companies,922,What are the names of the organizations that have a board member named 'Julie Spellman Sweet' and a revenue greater than 100 million?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE o.revenue > 1E8
RETURN o.name","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, member: $p) isa board_member_of;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
fetch { ""name"": $o.name };"
companies,923,Find the top 3 organizations that have a CEO with a summary mentioning 'Accenture' and a revenue greater than 50 million.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture' AND o.revenue > 5e7
RETURN o.name AS organization, p.name AS ceo
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""Accenture"";
  $o has revenue $o_revenue;
  $o_revenue > 50000000;
sort $o_revenue desc;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,924,List the first 5 organizations that have a supplier headquartered in a city named 'Seattle'.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o.name AS organization, s.name AS supplier
LIMIT 5","match
  $o isa organization;
  $s isa organization;
  $c isa city, has city_name ""Seattle"";
  (customer: $o, supplier: $s) isa supplies;
  (organization: $o, city: $c) isa located_in;
limit 5;
fetch { ""organization"": $o.name, ""supplier"": $s.name };"
companies,925,Which organizations have a CEO who has authored an article with a sentiment score greater than 0.5?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:MENTIONS]-(a:Article)
WHERE a.sentiment > 0.5
RETURN o.name AS organization, ceo.name AS ceo, a.title AS article, a.sentiment AS sentiment","match
  $o isa organization;
  $ceo isa person;
  $a isa article;
  (organization: $o, ceo: $ceo) isa ceo_of;
  $a has sentiment $a_sentiment;
  $a_sentiment > 0.5;
(article: $a, mentioned: $o) isa mentions; fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""article"": $a.title, ""sentiment"": $a.sentiment };"
companies,926,Identify the top 3 organizations that have a subsidiary with the largest number of employees.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE sub.nbrEmployees IS NOT NULL
WITH o, max(sub.nbrEmployees) AS maxEmployees
ORDER BY maxEmployees DESC
LIMIT 3
RETURN o.name AS organization, maxEmployees","match
  $o isa organization;
  $sub isa organization;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $sub has nbr_employees $sub_nbr_employees;
limit 3;
fetch { ""organization"": $o.name };"
companies,927,What are the names of the organizations that have a CEO with a summary mentioning 'Accenture' and a revenue greater than 100 million?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture' AND o.revenue > 1E8
RETURN o.name","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $p has summary $p_summary;
  $p_summary contains ""Accenture"";
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
fetch { ""name"": $o.name };"
companies,928,Find the top 3 articles that mention organizations based in 'Seattle'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN a.title AS article, a.siteName AS site, a.date AS published
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $a has date $a_date;
  $city isa city, has city_name ""Seattle""; (organization: $o, city: $city) isa located_in;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title, ""site"": $a.site_name, ""published"": $a.date };"
companies,929,List the first 5 organizations that have a CEO with a name mentioned in at least two different articles and a revenue greater than 50 million.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.revenue > 5e7
WITH o, ceo
MATCH (article1:Article)-[:MENTIONS]->(ceo)
WITH o, ceo, count(article1) AS mentionCount
WHERE mentionCount >= 2
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 5","match
  $o isa organization, has name $on;
  $ceo isa person, has name $ceon;
  $a1 isa article;
  $a2 isa article;
  (organization: $o, ceo: $ceo) isa ceo_of;
  (article: $a1, mentioned: $o) isa mentions;
  (article: $a2, mentioned: $o) isa mentions;
  $a1 has article_id $aid1;
  $a2 has article_id $aid2;
  $aid1 != $aid2;
  $o has revenue $r;
  $r > 50000000;
limit 5;
fetch { ""organization"": $on, ""ceo"": $ceon };"
companies,930,Which organizations have a CEO named 'Julie Spellman Sweet' and a summary mentioning 'Accenture'?,"MATCH (o:Organization)
WHERE (o)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'})
  AND o.summary CONTAINS 'Accenture'
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o has name ""Accenture"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
fetch { ""organization"": $o.name, ""ceo"": $p.name, ""summary"": $o.summary };"
companies,932,List the first 5 organizations that have a CEO with a name mentioned in more than one article and a revenue greater than 100 million.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE o.revenue > 1E8
WITH o, ceo
MATCH (article:Article)-[:MENTIONS]->(o)
WHERE article.title CONTAINS ceo.name
WITH o, ceo, count(article) AS mentionCount
WHERE mentionCount > 1
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 5","match
  $o isa organization, has name $on;
  $ceo isa person, has name $ceon;
  $a1 isa article;
  $a2 isa article;
  (organization: $o, ceo: $ceo) isa ceo_of;
  (article: $a1, mentioned: $o) isa mentions;
  (article: $a2, mentioned: $o) isa mentions;
  $a1 has article_id $aid1;
  $a2 has article_id $aid2;
  $aid1 != $aid2;
  $o has revenue $r;
  $r > 100000000;
limit 5;
fetch { ""organization"": $on, ""ceo"": $ceon };"
companies,7,Which organizations have 'Accenture' as an investor?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor:Organization {name: 'Accenture'})
RETURN o.name AS organization, o.summary AS summary","match
$o isa organization;
$investor isa organization, has name ""Accenture"";
invested_in (organization: $o, investor: $investor);
fetch { ""organization"": $o.name };"
companies,53,Identify organizations that are both suppliers and investors to other organizations.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization) 
WHERE EXISTS {(s)-[:HAS_INVESTOR]->(o)}
RETURN o.name AS organization, s.name AS supplier_investor","match
$supplier isa organization, has name $sn;
$customer isa organization;
$investee isa organization;
supplies (supplier: $supplier, customer: $customer);
invested_in (organization: $investee, investor: $supplier);
fetch { ""organization"": $sn };"
companies,70,Which organizations have foreign investors (investors from a different country)?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c1:Country),
      (o)<-[:HAS_INVESTOR]-(investor:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c2:Country)
WHERE c1 <> c2
RETURN o.name AS organization, c1.name AS organization_country,
       investor.name AS investor, c2.name AS investor_country","match
$o isa organization;
$investor isa organization;
invested_in (organization: $o, investor: $investor);
$c1 isa city; $c2 isa city;
$country1 isa country; $country2 isa country;
located_in (organization: $o, city: $c1);
located_in (organization: $investor, city: $c2);
location-contains (parent: $country1, child: $c1);
location-contains (parent: $country2, child: $c2);
$country1 has country_name $cn1;
$country2 has country_name $cn2;
not { $cn1 == $cn2; };
fetch { ""organization"": $o.name, ""investor"": $investor.name };"
companies,77,List the organizations that are investors in more than one other organization.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor:Organization)
WITH investor, count(o) as num_investments
WHERE num_investments > 1
RETURN investor.name as investor_name, num_investments","match
$investor isa organization;
invested_in (organization: $o, investor: $investor);
reduce $count = count($o) groupby $investor;
match $count > 1;
fetch { ""investor"": $investor.name, ""investments"": $count };"
companies,94,List organizations that have a philanthropic foundation as an investor.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor:Organization)
WHERE investor.name CONTAINS 'Foundation'
RETURN o.name AS organization, investor.name AS investor","match
$o isa organization;
$investor isa organization, has name $inv_name;
invested_in (organization: $o, investor: $investor);
$inv_name like "".*Foundation.*"";
fetch { ""organization"": $o.name, ""investor"": $inv_name };"
companies,154,Identify the first 3 organizations that have the same investor and are competitors.,"MATCH (o1:Organization)-[:HAS_INVESTOR]->(investor)<-[:HAS_INVESTOR]-(o2:Organization)
WHERE (o1)-[:HAS_COMPETITOR]->(o2)
RETURN o1.name AS Org1, o2.name AS Org2, investor.name AS CommonInvestor
LIMIT 3","match
$o1 isa organization, has name $n1;
$o2 isa organization, has name $n2;
$investor isa organization, has name $inv_name;
invested_in (organization: $o1, investor: $investor);
invested_in (organization: $o2, investor: $investor);
competes_with (competitor: $o1, competitor: $o2);
not { $o1 is $o2; };
limit 3;
fetch { ""org1"": $n1, ""org2"": $n2, ""investor"": $inv_name };"
companies,212,Identify the first 3 organizations that have the same investor and are based in 'Italy'.,"MATCH (o1:Organization)-[:HAS_INVESTOR]->(investor)<-[:HAS_INVESTOR]-(o2:Organization)
WHERE o1 <> o2 AND o1.id < o2.id
  AND (o1)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(:Country {name: 'Italy'})
  AND (o2)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(:Country {name: 'Italy'})
RETURN o1.name AS org1, o2.name AS org2, investor.name AS investor
LIMIT 3","match
$o1 isa organization, has name $n1;
$o2 isa organization, has name $n2;
$investor isa organization, has name $inv_name;
invested_in (organization: $o1, investor: $investor);
invested_in (organization: $o2, investor: $investor);
$c1 isa city; $c2 isa city;
$italy isa country, has country_name ""Italy"";
located_in (organization: $o1, city: $c1);
located_in (organization: $o2, city: $c2);
location-contains (parent: $italy, child: $c1);
location-contains (parent: $italy, child: $c2);
not { $o1 is $o2; };
limit 3;
fetch { ""org1"": $n1, ""org2"": $n2, ""investor"": $inv_name };"
companies,311,What are the names of the first 3 organizations that are investors in other organizations?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor:Organization)
RETURN DISTINCT investor.name
LIMIT 3","match
$investor isa organization;
invested_in (organization: $o, investor: $investor);
limit 3;
fetch { ""investor"": $investor.name };"
companies,329,Name the first 3 organizations that are headquartered in cities with more than 5 million inhabitants.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.population > 5000000
RETURN o.name
LIMIT 3","match
$o isa organization;
$c isa city, has population $pop;
located_in (organization: $o, city: $c);
$pop > 5000000;
limit 3;
fetch { ""organization"": $o.name };"
companies,338,List the names of the cities where the headquarters of the first 5 organizations founded before 1950 are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.foundingDate < date('1950-01-01')
RETURN c.name
LIMIT 5","match
$o isa organization, has founding-date $fd;
$c isa city;
located_in (organization: $o, city: $c);
$fd < 1950-01-01T00:00:00;
limit 5;
fetch { ""city"": $c.city_name };"
companies,348,Which 3 organizations are the most frequent collaborators in joint ventures?,"MATCH (o1:Organization)-[:HAS_SUBSIDIARY|HAS_SUPPLIER|HAS_INVESTOR]-(o2:Organization)
WITH o1, o2, count(*) as collaborations
ORDER BY collaborations DESC
RETURN o1.name, o2.name, collaborations
LIMIT 3","match
$o1 isa organization, has name $n1;
$o2 isa organization, has name $n2;
{ subsidiary_of ($o1, $o2); } or
{ supplies ($o1, $o2); } or
{ invested_in ($o1, $o2); };
reduce $collaborations = count groupby $n1, $n2;
sort $collaborations desc;
limit 3;
fetch { ""org1"": $n1, ""org2"": $n2, ""collaborations"": $collaborations };"
companies,352,List the names of the first 3 organizations that have invested in startups in the past year.,"MATCH (investor:Organization)-[:HAS_INVESTOR]->(startup:Organization)
WHERE startup.nbrEmployees < 100 AND EXISTS {
  (startup)<-[:MENTIONS]-(:Article {date: date('2022-01-01') < date() < date('2023-01-01')})
}
RETURN investor.name
LIMIT 3","match
$investor isa organization;
$startup isa organization, has nbr_employees $emp;
$emp < 100;
invested_in (investor: $investor, organization: $startup);
limit 3;
fetch { ""investor"": $investor.name };"
companies,356,Which 3 organizations have the longest history of continuous operation according to their founding dates in the database?,"MATCH (o:Organization)
WHERE o.foundingDate IS NOT NULL
RETURN o.name AS organization, o.foundingDate AS founded
ORDER BY o.foundingDate
LIMIT 3","match
$o isa organization, has founding-date $fd, has name $n;
sort $fd asc;
limit 3;
fetch { ""organization"": $n, ""founded"": $fd };"
companies,391,Which 3 organizations have the most patents filed according to the database?,"MATCH (o:Organization)
WHERE o.nbrPatents IS NOT NULL
RETURN o.name, o.nbrPatents
ORDER BY o.nbrPatents DESC
LIMIT 3","match
$o isa organization, has patent-count $pc, has name $n;
sort $pc desc;
limit 3;
fetch { ""name"": $n, ""patents"": $pc };"
companies,409,Which organizations are investors in more than two other organizations?,"MATCH (o:Organization)-[:HAS_INVESTOR]->(investor:Organization)
WITH investor, count(o) as num_investments
WHERE num_investments > 2
RETURN investor.name as investor, num_investments","match
$investor isa organization;
invested_in (investor: $investor, organization: $o);
reduce $count = count($o) groupby $investor;
match $count > 2;
fetch { ""investor"": $investor.name, ""investments"": $count };"
companies,439,Which organizations have been investors in 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_INVESTOR]-(investor:Organization)
RETURN investor.name AS investor","match
$o isa organization, has name ""New Energy Group"";
$investor isa organization;
invested_in (investor: $investor, organization: $o);
fetch { ""investor"": $investor.name };"
companies,448,"Which organizations are based in a city with a population less than 100,000?","MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.population < 100000
RETURN o.name AS organization, c.name AS city","match
$o isa organization;
$c isa city, has population $pop;
$pop < 100000;
located_in (organization: $o, city: $c);
fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,452,Which organizations have CEOs who have been in their position for less than 3 years?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.startDate IS NOT NULL AND duration.between(p.startDate, date()).years < 3
RETURN o.name AS organization, p.name AS ceo","match
$o isa organization;
$p isa person;
$rel isa ceo_of (organization: $o, ceo: $p);
$rel has start-date $sd;
$sd > 2023-01-22T00:00:00;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,466,Name the organizations that have made the most investments in startups.,"MATCH (investor:Organization)-[r:HAS_INVESTOR]->(company:Organization)
WITH investor, count(r) AS num_investments
ORDER BY num_investments DESC
LIMIT 10
RETURN investor.name AS investor, num_investments","match
$investor isa organization;
$startup isa organization, has nbr_employees $emp;
$emp < 100;
invested_in (investor: $investor, organization: $startup);
reduce $count = count($startup) groupby $investor;
sort $count desc;
limit 10;
fetch { ""investor"": $investor.name, ""investments"": $count };"
companies,496,Who are the first 3 CEOs of organizations that have been invested in by another organization?,"MATCH (investor:Organization)-[:HAS_INVESTOR]->(company:Organization)-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS ceoName, company.name AS companyName, investor.name AS investorName
LIMIT 3","match
$investor isa organization;
$o isa organization;
$ceo isa person;
invested_in (organization: $o, investor: $investor);
ceo_of (organization: $o, ceo: $ceo);
limit 3;
fetch { ""ceo"": $ceo.name };"
companies,612,Which organizations have an investor named 'Accenture'?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor:Organization {name: 'Accenture'})
RETURN o.name AS organization","match
$o isa organization;
$investor isa organization, has name ""Accenture"";
invested_in (organization: $o, investor: $investor);
fetch { ""organization"": $o.name };"
companies,639,Identify the organizations that have an investor with more than 50 employees.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(i:Organization)
WHERE i.nbrEmployees > 50
RETURN o.name AS organization, i.name AS investor, i.nbrEmployees AS employeeCount","match
$o isa organization;
$investor isa organization, has nbr_employees $emp;
$emp > 50;
invested_in (organization: $o, investor: $investor);
fetch { ""organization"": $o.name, ""investor"": $investor.name };"
companies,667,Who are the investors in organizations that have subsidiaries in 'United States of America'?,"MATCH (investor)-[:HAS_INVESTOR]->(org)-[:HAS_SUBSIDIARY*]->(sub)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE investor:Person OR investor:Organization
RETURN DISTINCT investor","match
$parent isa organization;
$sub isa organization;
$investor isa! organization;
$c isa city;
$usa isa country, has country_name ""United States of America"";
subsidiary_of (parent: $parent, subsidiary: $sub);
located_in (organization: $sub, city: $c);
location-contains (parent: $usa, child: $c);
invested_in (organization: $parent, investor: $investor);
fetch { ""investor"": $investor.name };"
companies,695,Which 3 organizations have the oldest founding dates?,"MATCH (o:Organization)
WHERE o.foundingDate IS NOT NULL
RETURN o.name, o.foundingDate
ORDER BY o.foundingDate
LIMIT 3","match
$o isa organization, has founding-date $fd, has name $n;
sort $fd asc;
limit 3;
fetch { ""name"": $n, ""founded"": $fd };"
companies,700,What are the 3 latest investments made by organizations in the software industry?,"MATCH (investor:Organization)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Software'})-[:HAS_INVESTOR]->(company:Organization)
MATCH (article:Article)-[:MENTIONS]->(company)
WHERE article.date IS NOT NULL
RETURN investor.name AS Investor, company.name AS Company, article.title AS Article, article.date AS Date
ORDER BY article.date DESC
LIMIT 3","match
$investor isa organization, has name $investor_name;
in_category (organization: $investor, category: $cat);
$cat isa industry_category, has industry_category_name ""Software"";
invested_in (investor: $investor, organization: $company);
$company isa organization, has name $company_name;
mentions (article: $article, mentioned: $company);
$article isa article, has date $date;
sort $date desc;
limit 3;
fetch { ""investor"": $investor_name, ""company"": $company_name, ""date"": $date };"
companies,732,Find the first 3 organizations that have been investors in more than 3 other organizations.,"MATCH (o:Organization)-[:HAS_INVESTOR]->(i:Organization)
WITH i, count(o) as num_investments
WHERE num_investments > 3
RETURN i.name as investor, num_investments
ORDER BY num_investments DESC
LIMIT 3","match
$investor isa organization;
invested_in (investor: $investor, organization: $o);
reduce $count = count($o) groupby $investor;
match $count > 3;
sort $count desc;
limit 3;
fetch { ""investor"": $investor.name, ""investments"": $count };"
companies,770,What are the names of organizations that have 'Accenture' as an investor?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor:Organization {name: 'Accenture'})
RETURN o.name AS organization","match
$o isa organization;
$investor isa organization, has name ""Accenture"";
invested_in (organization: $o, investor: $investor);
fetch { ""organization"": $o.name };"
companies,6,Find the top 3 countries with the most cities hosting public organizations.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
WITH c, count(DISTINCT city) AS numCities
RETURN c.name AS country, numCities
ORDER BY numCities DESC
LIMIT 3","match
  $c isa country;
  $city isa city;
  $o isa organization, has is_public true;
  location-contains (parent: $c, child: $city);
  located_in (organization: $o, city: $city);
select $city, $c;
distinct;
reduce $numCities = count groupby $c;
sort $numCities desc;
limit 3;
fetch { ""country"": $c.country_name, ""numCities"": $numCities };"
companies,9,List the top 3 industries mentioned in articles about 'Accenture'.,"MATCH (a:Article)-[:MENTIONS]->(:Organization {name: 'Accenture'})
MATCH (a)-[:HAS_CHUNK]->(c:Chunk)
MATCH (o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
WHERE c.text CONTAINS o.name
RETURN ic.name AS industry, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $accenture isa organization, has name ""Accenture"";
  $a isa article;
  mentions (article: $a, mentioned: $accenture);
  $other_org isa organization;
  mentions (article: $a, mentioned: $other_org);
  in_category (organization: $other_org, category: $ic);
  $ic has industry_category_name $industry;
reduce $mentions = count groupby $industry;
sort $mentions desc;
limit 3;
fetch { ""industry"": $industry };"
companies,22,List the first 3 organizations that were dissolved but mentioned in recent articles.,"MATCH (o:Organization {isDissolved: true})<-[:MENTIONS]-(a:Article)
WHERE a.date >= datetime() - duration('P1Y')
RETURN o.name AS organization, a.title AS article
ORDER BY a.date DESC
LIMIT 3","match
  $o isa organization, has is_dissolved true, has name $org_name;
  $a isa article, has title $article_title, has date $d;
  mentions (article: $a, mentioned: $o);
sort $d desc;
limit 3;
fetch {
  ""organization"": $org_name,
  ""article"": $article_title
};"
companies,25,What are the names of the first 3 organizations with the most competitors?,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(c:Organization)
WITH o, count(c) AS numCompetitors
ORDER BY numCompetitors DESC
LIMIT 3
RETURN o.name AS organization, numCompetitors","match $o isa organization, has name $n; $c isa organization; competes_with (competitor: $o, competitor: $c); reduce $numCompetitors = count($c) groupby $o; match $o has name $n; sort $numCompetitors desc; limit 3; fetch { ""organization"": $n, ""numCompetitors"": $numCompetitors };"
companies,26,List the first 3 organizations that have a city as their headquarters and are also public.,"MATCH (o:Organization)-[:IN_CITY]->(:City)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization, has is_public true;
  located_in (organization: $o, city: $c);
limit 3;
fetch { ""organization"": $o.name };"
companies,28,List the names and IDs of the top 5 cities by the number of public organizations located in them.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isPublic = true
WITH c, count(o) as orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name as cityName, c.id as cityId","match
  $c isa city;
  $o isa organization, has is_public true;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 5;
fetch { ""cityName"": $c.city_name, ""cityId"": $c.city_id };"
companies,29,Who are the authors of the first 3 articles that negatively mention any organization?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
WITH a, o
ORDER BY a.date DESC
LIMIT 3
RETURN a.author AS author, a.title AS title, o.name AS organization","match
  $o isa organization;
  $a isa article;
  $a has sentiment $s;
  $s < 0;
  mentions (article: $a, mentioned: $o);
  $a has date $d;
sort $d desc;
limit 3;
fetch { ""author"": $a.author, ""title"": $a.title, ""organization"": $o.name };"
companies,32,What are the names of the first 3 organizations that have a motto containing 'world'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'world'
RETURN o.name
LIMIT 3","match
  $o isa organization, has motto $m;
  $m like "".*world.*"";
limit 3;
fetch { ""name"": $o.name };"
companies,33,List the first 3 organizations that are suppliers to more than one organization.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WITH s, count(o) as num_orgs
WHERE num_orgs > 1
RETURN s.name as supplier, num_orgs as number_of_organizations
ORDER BY num_orgs DESC
LIMIT 3","match
  $s isa organization;
  $o isa organization;
  supplies (supplier: $s, customer: $o);
reduce $num_orgs = count($o) groupby $s;
match $num_orgs > 1;
sort $num_orgs desc;
limit 3;
fetch { ""supplier"": $s.name, ""number_of_organizations"": $num_orgs };"
companies,36,List the first 3 cities that have more than three organizations based in them.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name AS city
ORDER BY orgCount DESC
LIMIT 3","match
  $c isa city;
  $o isa organization;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c;
match $count > 3;
sort $count desc;
limit 3;
fetch { ""city"": $c.city_name };"
companies,41,What are the names of the top 5 organizations with the most employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match
  $o isa organization;
  $o has nbr_employees $nbr;
sort $nbr desc;
limit 5;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $nbr };"
companies,38,List the top 3 cities where organizations are based that have at least 100 employees.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees >= 100
RETURN c.name AS city, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3","match
  $o isa organization, has nbr_employees $emp;
  $emp >= 100;
  $c isa city, has city_name $city_name;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c, $city_name;
sort $count desc;
limit 3;
fetch { ""city"": $city_name, ""numOrganizations"": $count };"
companies,45,Which countries have cities that are home to more than three organizations?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)
WITH c, city, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name AS country, collect(city.name) AS cities","match
  $c isa country, has country_name $cn;
  $city isa city;
  $o isa organization;
  location-contains (parent: $c, child: $city);
  located_in (organization: $o, city: $city);
reduce $org_count = count($o) groupby $city, $c, $cn;
match $org_count > 3;
select $c, $cn;
distinct;
fetch { ""country"": $cn };"
companies,51,Find the organizations that are suppliers to 'New Energy Group' and their number of employees.,"MATCH (o:Organization)<-[:HAS_SUPPLIER]-(supplier:Organization {name: 'New Energy Group'})
WHERE supplier.nbrEmployees IS NOT NULL
RETURN supplier.name AS supplier, supplier.nbrEmployees AS numberOfEmployees","match
  $neg isa organization, has name ""New Energy Group"";
  $o isa organization, has nbr_employees $employees;
  supplies (supplier: $o, customer: $neg);
fetch { ""supplier"": $o.name, ""numberOfEmployees"": $employees };"
companies,54,List the names and summaries of articles that mention organizations with a revenue of at least $1 million.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue >= 1e6
RETURN a.title AS title, a.summary AS summary","match
  $a isa article;
  $o isa organization;
  (article: $a, mentioned: $o) isa mentions;
  $o has revenue $o_revenue;
  $o_revenue >= 1000000;
fetch { ""title"": $a.title, ""summary"": $a.article_summary };"
companies,55,Which organizations have a CEO with the summary 'CEO at Accenture'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary = 'CEO at Accenture'
RETURN o","match
  $o isa organization;
  $p isa person, has summary ""CEO at Accenture"";
  ceo_of (organization: $o, ceo: $p);
fetch { ""organization"": $o.name };"
companies,56,"Find the top 5 organizations with a summary containing 'based in Dublin, Ireland'.","MATCH (o:Organization)
WHERE o.summary CONTAINS 'based in Dublin, Ireland'
RETURN o.name AS organization, o.summary AS summary
ORDER BY o.name
LIMIT 5","match
  $o isa organization;
  $o has summary $o_summary;
  $o_summary like "".*based in Dublin, Ireland.*"";
  $o has name $o_name;
sort $o_name asc;
limit 5;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,60,Which organizations have a revenue greater than 100 million and are not public?,"MATCH (o:Organization)
WHERE o.revenue > 1E8 AND o.isPublic IS NOT NULL AND NOT o.isPublic
RETURN o","match
  $o isa organization;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
  $o has is_public false;
fetch { ""organization"": $o.name };"
companies,64,Which organizations have 'Electronic Products Manufacturers' as their industry category?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  in_category (organization: $o, category: $c);
fetch { ""organization"": $o.name };"
companies,65,What are the names of organizations that have suppliers also mentioned in articles?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)<-[:MENTIONS]-(a:Article)
RETURN DISTINCT o.name","match
  $o isa organization;
  $s isa organization;
  $a isa article;
  supplies (customer: $o, supplier: $s);
  mentions (article: $a, mentioned: $s);
select $o;
distinct;
fetch { ""name"": $o.name };"
companies,67,List the top 5 articles by sentiment that mention organizations based in California.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE o.summary CONTAINS 'California'
RETURN a.title AS article, a.sentiment AS sentiment
ORDER BY sentiment DESC
LIMIT 5","match
  $a isa article;
  $o isa organization, has summary $o_summary;
  $o_summary contains ""California"";
  mentions (article: $a, mentioned: $o);
  $a has sentiment $sentiment;
sort $sentiment desc;
limit 5;
fetch { ""article"": $a.title, ""sentiment"": $sentiment };"
companies,69,List the articles that mention both public and private organizations.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.isPublic = true AND 
      EXISTS {(a)-[:MENTIONS]->(:Organization {isPublic: false})}
RETURN a","match
  $a isa article;
  mentions (article: $a, mentioned: $o1);
  $o1 has is_public true;
  mentions (article: $a, mentioned: $o2);
  $o2 has is_public false;
fetch { ""a"": $a };"
companies,78,Which organizations have subsidiaries in more than three different cities?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE sub.name IS NOT NULL
WITH o, count(DISTINCT sub.name) AS num_subsidiaries, collect(DISTINCT sub) AS subsidiaries
WHERE num_subsidiaries > 3
UNWIND subsidiaries AS s
MATCH (s)-[:IN_CITY]->(city:City)
RETURN o.name AS organization, collect(DISTINCT city.name) AS subsidiary_cities","match
  $o isa organization;
  subsidiary_of (parent: $o, subsidiary: $sub);
  located_in (organization: $sub, city: $city);
select $o, $city;
distinct;
reduce $city_count = count groupby $o;
match $city_count > 3;
fetch { ""organization"": $o.name };"
companies,81,List the organizations that have a summary mentioning 'software' and are in the tech industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WHERE toLower(o.summary) CONTAINS 'software' AND c.name CONTAINS 'tech'
RETURN o.name AS organization, o.summary AS summary","match
  $o isa organization, has summary $summary;
  $summary like ""(?i).*software.*"";
  $c isa industry_category, has industry_category_name $cat_name;
  $cat_name like ""(?i).*tech.*"";
  in_category (organization: $o, category: $c);
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,85,List the organizations that have been mentioned in articles about environmental issues.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'environment'
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN DISTINCT o.name AS organization","match
  $a isa article;
  $c isa chunk, has text $t;
  $t like "".*environment.*"";
  has_chunk (article: $a, chunk: $c);
  $o isa organization, has name $n;
  mentions (article: $a, mentioned: $o);
select $n;
distinct;
fetch { ""organization"": $n };"
companies,89,Which organizations have a supplier based in a different country?,"MATCH (o1:Organization)-[:HAS_SUPPLIER]->(o2:Organization),
       (o1)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c1:Country),
       (o2)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c2:Country)
WHERE c1 <> c2
RETURN o1.name AS Organization, o2.name AS Supplier, c1.name AS OrgCountry, c2.name AS SupplierCountry","match
  $o1 isa organization;
  $o2 isa organization;
  $c1 isa country;
  $c2 isa country;
  supplies (customer: $o1, supplier: $o2);
  $city1 isa city;
  located_in (organization: $o1, city: $city1);
  location-contains (child: $city1, parent: $c1);
  $city2 isa city;
  located_in (organization: $o2, city: $city2);
  location-contains (child: $city2, parent: $c2);
  not { $c1 is $c2; };
fetch { ""Organization"": $o1.name, ""Supplier"": $o2.name, ""OrgCountry"": $c1.country_name, ""SupplierCountry"": $c2.country_name };"
companies,92,Which organizations have a female CEO and are in the healthcare industry category?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), 
      (o)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Healthcare'})
WHERE ceo.name =~ '.*(Mrs\\.|Ms\\.|Miss).*'
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization, has name $org_name;
  $ceo isa person, has name $ceo_name;
  $c isa industry_category, has industry_category_name ""Healthcare"";
  (organization: $o, ceo: $ceo) isa ceo_of;
  (organization: $o, category: $c) isa in_category;
  $ceo_name like "".*Mrs\\..*|.*Ms\\..*|.*Miss.*"";
fetch { ""organization"": $org_name, ""ceo"": $ceo_name };"
companies,95,Which organizations are based in cities with a population of more than one million people according to city summaries?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'population of more than one million'
RETURN o.name AS organization, c.name AS city","match
  $o isa organization, has name $o_name;
  $c isa city, has city_name $c_name, has city_summary $cs;
  $cs like "".*population of more than one million.*"";
  located_in (organization: $o, city: $c);
fetch { ""organization"": $o_name, ""city"": $c_name };"
companies,97,List the top 3 cities where organizations with a revenue of more than 100 million are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue > 1E8
RETURN c.name AS city, count(*) AS orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $o isa organization, has revenue $r;
  $r > 100000000;
  located_in (organization: $o, city: $c);
  $c has city_name $cn;
reduce $count = count($o) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""city"": $cn };"
companies,100,Can you name 3 people who are both investors and CEOs of different organizations?,"MATCH (p:Person)
WHERE EXISTS {(p)-[:HAS_CEO]->(:Organization)}
  AND EXISTS {(p)-[:HAS_INVESTOR]->(:Organization)}
WITH p LIMIT 3
RETURN p.name AS name","match
  $p isa person;
  ceo_of (organization: $o1, ceo: $p);
  invested_in (organization: $o2, investor: $p);
  not { $o1 is $o2; };
limit 3;
fetch { ""name"": $p.name };"
companies,108,List the top 5 suppliers of Accenture.,"MATCH (a:Organization {name: 'Accenture'})<-[:HAS_SUPPLIER]-(s:Organization)
RETURN s.name AS supplier, s.summary AS summary
ORDER BY s.revenue DESC
LIMIT 5","match
  $a isa organization, has name ""Accenture"";
  supplies (supplier: $s, customer: $a);
  $s has name $sname;
  $s has summary $summary;
  $s has revenue $revenue;
sort $revenue desc;
limit 5;
fetch { ""supplier"": $sname, ""summary"": $summary };"
companies,109,What are the names of the first 3 organizations with a motto?,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o.name
LIMIT 3","match
  $o isa organization, has motto $m;
limit 3;
fetch { ""name"": $o.name };"
companies,115,List the first 3 articles mentioning organizations with a revenue less than 5 million.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue < 5000000
RETURN a.title, a.summary, a.date
LIMIT 3","match
$a isa article;
$o isa organization, has revenue $r;
$r < 5000000;
mentions (article: $a, mentioned: $o);
limit 3;
fetch {
  ""title"": $a.title,
  ""summary"": $a.article_summary,
  ""date"": $a.date
};"
companies,118,What are the top 3 industries with the most organizations in them?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
RETURN ic.name AS industry, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $ic isa industry_category, has industry_category_name $name;
  $o isa organization;
  in_category (category: $ic, organization: $o);
reduce $count = count($o) groupby $ic, $name;
sort $count desc;
limit 3;
fetch { ""industry"": $name, ""orgCount"": $count };"
companies,127,List the top 5 industries where the organizations are based in 'Seattle'.,"MATCH (c:City {name: 'Seattle'})<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory)
RETURN ic.name AS industry, count(*) AS orgCount
ORDER BY orgCount DESC
LIMIT 5","match
  $c isa city, has city_name ""Seattle"";
  $o isa organization;
  $ic isa industry_category, has industry_category_name $icn;
  (organization: $o, city: $c) isa located_in;
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $icn;
sort $orgCount desc;
limit 5;"
companies,128,What are the names of the first 3 organizations dissolved and have revenue greater than 10000000?,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.revenue > 10000000
RETURN o.name
LIMIT 3","match
  $o isa organization, has is_dissolved true, has revenue $r;
  $r > 10000000;
limit 3;
fetch { ""name"": $o.name };"
companies,131,List the top 3 cities where 'Electronic Products Manufacturers' organizations are located.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN c.name AS city, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $c isa city, has city_name $cn;
  $o isa organization;
  $ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  located_in (organization: $o, city: $c);
  in_category (organization: $o, category: $ic);
reduce $count = count($o) groupby $c, $cn;
sort $count desc;
limit 3;
fetch { ""city"": $cn, ""orgCount"": $count };"
companies,132,Which 5 articles mention 'Accenture' and have a sentiment score above 0.8?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {name: 'Accenture'})
WHERE a.sentiment > 0.8
RETURN a.title, a.sentiment, a.siteName, a.date
LIMIT 5","match
  $a isa article, has sentiment $s;
  $s > 0.8;
  $o isa organization, has name ""Accenture"";
  mentions (article: $a, mentioned: $o);
limit 5;
fetch { ""title"": $a.title, ""sentiment"": $s, ""siteName"": $a.site_name, ""date"": $a.date };"
companies,139,Which organizations have more than 50 employees and are in the 'Software' industry?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Software'})
WHERE o.nbrEmployees > 50
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization, has nbr_employees $emp;
  $emp > 50;
  $c isa industry_category, has industry_category_name ""Software"";
  in_category (organization: $o, category: $c);
fetch {
  ""organization"": $o.name,
  ""numberOfEmployees"": $emp
};"
companies,143,Identify the top 3 countries with the most organizations in the 'Electronic Products Manufacturers' category.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(cat:IndustryCategory {name: 'Electronic Products Manufacturers'})
WITH c.name AS country, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3
RETURN country, orgCount","match
  $c isa country, has country_name $cn;
  $city isa city;
  $o isa organization;
  $ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  location-contains (child: $city, parent: $c);
  located_in (organization: $o, city: $city);
  in_category (organization: $o, category: $ic);
reduce $orgCount = count($o) groupby $cn;
sort $orgCount desc;
limit 3;
fetch { ""country"": $cn, ""orgCount"": $orgCount };"
companies,144,Which 3 organizations have been dissolved and are mentioned in articles with a sentiment score below 0.5?,"MATCH (o:Organization)-[:MENTIONED_IN]->(a:Article)
WHERE o.isDissolved = true AND a.sentiment < 0.5
RETURN o.name
LIMIT 3","match
  $o isa organization, has is_dissolved true;
  $a isa article, has sentiment $s;
  $s < 0.5;
  mentions (mentioned: $o, article: $a);
limit 3;
fetch { ""name"": $o.name };"
companies,148,Which organizations have a motto containing 'security' and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
  AND (o)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'})
RETURN o","match
  $o isa organization, has motto $m;
  $m like "".*security.*"";
  $p isa person, has name ""Julie Spellman Sweet"";
  ceo_of (organization: $o, ceo: $p);
fetch { ""organization"": $o.name };"
companies,151,What are the names of organizations with more than 500 employees and have been mentioned in articles with high sentiment scores?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 500 AND EXISTS {
  (o)<-[:MENTIONS]-(a:Article)
  WHERE a.sentiment > 0.8
}
RETURN o.name","match
  $o isa organization, has nbr_employees $emp;
  $emp > 500;
  $a isa article, has sentiment $s;
  $s > 0.8;
  mentions (mentioned: $o, article: $a);
fetch { ""name"": $o.name };"
companies,152,Which 3 organizations are suppliers to 'New Energy Group' and are based in 'United States of America'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_SUPPLIER]-(supplier:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
RETURN supplier.name
LIMIT 3","match
  $o isa organization, has name ""New Energy Group"";
  $supplier isa organization;
  $c isa country, has country_name ""United States of America"";
  supplies (supplier: $supplier, customer: $o);
  $city isa city;
  located_in (organization: $supplier, city: $city);
  location-contains (child: $city, parent: $c);
limit 3;
fetch { ""name"": $supplier.name };"
companies,155,Which 3 organizations have the most subsidiaries within the same country?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization),
      (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country),
      (sub)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c)
WITH o, count(sub) AS numSubs
ORDER BY numSubs DESC
LIMIT 3
RETURN o.name AS organization, numSubs AS numberOfSubsidiaries","match
  $o isa organization, has name $on;
  $sub isa organization;
  $c isa country;
  subsidiary_of (parent: $o, subsidiary: $sub);
  located_in (organization: $o, city: $city1);
  location-contains (parent: $c, child: $city1);
  located_in (organization: $sub, city: $city2);
  location-contains (parent: $c, child: $city2);
reduce $count = count($sub) groupby $o, $on;
sort $count desc;
limit 3;
fetch { ""organization"": $on, ""numberOfSubsidiaries"": $count };"
companies,159,Which organizations have CEOs who are also board members of other organizations?,"MATCH (o1:Organization)-[:HAS_CEO]->(p:Person)
WHERE EXISTS {
  (p)-[:HAS_BOARD_MEMBER]->(o2:Organization)
  WHERE o1 <> o2
}
RETURN o1.name AS organization, p.name AS ceo_and_board_member","match
  $o1 isa organization;
  $o2 isa organization;
  $p isa person;
  ceo_of (organization: $o1, ceo: $p);
  board_member_of (organization: $o2, member: $p);
  not { $o1 is $o2; };
fetch { ""organization"": $o1.name, ""ceo_and_board_member"": $p.name };"
companies,160,Identify the top 3 cities where the headquarters of organizations with more than 1000 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 1000
RETURN c.name AS city, count(*) AS numOrgs
ORDER BY numOrgs DESC
LIMIT 3","match
  $o isa organization, has nbr_employees $n;
  $n > 1000;
  $c isa city;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 3;
fetch { ""city"": $c.city_name, ""numOrgs"": $count };"
companies,163,Find the first 3 organizations that have been mentioned in articles by 'MrWeb' site.,"MATCH (article:Article {siteName: 'MrWeb'})-[:MENTIONS]->(org:Organization)
RETURN org.name AS organization
LIMIT 3","match
$a isa article, has site_name ""MrWeb"";
$o isa organization;
mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""organization"": $o.name };"
companies,171,List the first 3 organizations that have a dissolved status and are mentioned in articles authored by 'David Correa'.,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization {isDissolved: true})
RETURN o.name AS organization
LIMIT 3","match
  $a isa article, has author ""David Correa"";
  $o isa organization, has is_dissolved true;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""organization"": $o.name };"
companies,172,Identify the top 3 organizations that have a public status and are in the 'Healthcare' industry category.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Healthcare'})
WHERE o.isPublic = true
RETURN o.name AS organization, o.summary AS summary
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization, has is_public true, has revenue $rev;
  $c isa industry_category, has industry_category_name ""Healthcare"";
  in_category (organization: $o, category: $c);
sort $rev desc;
limit 3;
fetch {
  ""organization"": $o.name,
  ""summary"": $o.summary
};"
companies,173,Who are the first 3 CEOs of organizations that have been mentioned in the most articles?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentionCount
ORDER BY mentionCount DESC
LIMIT 3
MATCH (o)-[:HAS_CEO]->(ceo:Person)
RETURN ceo.name AS ceoName, o.name AS orgName, mentionCount","match
  $o isa organization, has name $on;
  $a isa article;
  mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o, $on;
sort $count desc;
limit 3;
match
  $ceo isa person, has name $ceon;
  ceo_of (organization: $o, ceo: $ceo);
fetch { ""ceoName"": $ceon, ""orgName"": $on, ""mentionCount"": $count };"
companies,175,Which organizations based in 'United States of America' have a CEO named 'Julie Spellman Sweet' and are not dissolved?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'})
WHERE (o)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'}) AND o.isDissolved IS NOT NULL AND NOT o.isDissolved
RETURN o","match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  (organization: $o, ceo: $p) isa ceo_of;
  $o has is_dissolved false;
  $country isa country, has country_name ""United States of America"";
  $city isa city;
  (organization: $o, city: $city) isa located_in;
  (child: $city, parent: $country) isa location-contains;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,177,Identify the first 3 articles where the organizations mentioned have more than 50 employees.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 50
WITH a, o
ORDER BY a.date DESC
LIMIT 3
RETURN a.title AS article, collect(o.name) AS organizations","match
  $a isa article, has title $t, has date $d;
  $o isa organization, has nbr_employees $e, has name $n;
  $e > 50;
  mentions (article: $a, mentioned: $o);
sort $d desc;
limit 3;
fetch { ""article"": $t, ""organization"": $n };"
companies,179,List the top 3 organizations that have been mentioned in articles with a sentiment score below 0.3.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.3
WITH o, count(*) as mentionCount
ORDER BY mentionCount DESC
LIMIT 3
RETURN o.name as organization, mentionCount","match
$a isa article, has sentiment $s;
$s < 0.3;
$o isa organization;
mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o;
sort $count desc;
limit 3;
fetch { ""organization"": $o.name, ""mentionCount"": $count };"
companies,191,Which organizations have investors from 'Seattle'?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor)-[:IN_CITY]->(:City {name: 'Seattle'})
RETURN o.name AS organization, investor.name AS investor","match
  $o isa organization;
  invested_in (organization: $o, investor: $investor);
  $investor isa organization;
  $city isa city, has city_name ""Seattle"";
  located_in (organization: $investor, city: $city);
fetch { ""organization"": $o.name, ""investor"": $investor.name };"
companies,196,Find the first 3 articles mentioning organizations with a CEO named 'Julie Spellman Sweet' and a revenue above 500 million.,"MATCH (article:Article)-[:MENTIONS]->(org:Organization)
WHERE org.revenue > 5e8 AND (org)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'})
RETURN article.title, article.summary, article.date
LIMIT 3","match
  $article isa article, has title $title, has article_summary $summary, has date $date;
  mentions (article: $article, mentioned: $o);
  $o isa organization, has revenue $r;
  $r > 500000000;
  ceo_of (organization: $o, ceo: $p);
  $p isa person, has name ""Julie Spellman Sweet"";
limit 3;
fetch { ""title"": $title, ""summary"": $summary, ""date"": $date };"
companies,199,List the first 3 articles mentioning organizations with more than 500 employees and a low sentiment score.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 500 AND a.sentiment < 0.5
RETURN a.title, a.sentiment, o.name
LIMIT 3","match
  $a isa article, has sentiment $s;
  $s < 0.5;
  $o isa organization, has nbr_employees $e;
  $e > 500;
  mentions (mentioned: $o, article: $a);
limit 3;
fetch { ""title"": $a.title, ""sentiment"": $s, ""name"": $o.name };"
companies,202,Identify the top 3 organizations that have a CEO and are based in 'New York City'.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
MATCH (o)-[:IN_CITY]->(:City {name: 'New York City'})
RETURN o.name AS organization, o.summary AS summary
ORDER BY o.revenue DESC
LIMIT 3","match
  $o isa organization, has revenue $rev;
  $p isa person;
  ceo_of (organization: $o, ceo: $p);
  $city isa city, has city_name ""New York City"";
  located_in (organization: $o, city: $city);
sort $rev desc;
limit 3;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,205,Which organizations have a CEO named 'Julie Spellman Sweet' and have subsidiaries named 'Icon Integration'?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE EXISTS {
  (o)-[:HAS_SUBSIDIARY]->(:Organization {name: 'Icon Integration'})  
}
RETURN o","match
  $o isa organization;
  $subsidiary isa organization, has name ""Icon Integration"";
  subsidiary_of (parent: $o, subsidiary: $subsidiary);
  $p isa person, has name ""Julie Spellman Sweet"";
  ceo_of (organization: $o, ceo: $p);
fetch { ""o"": $o.name };"
companies,206,Find the first 3 organizations based in 'Seattle' that have a public status and are not dissolved.,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
WHERE o.isPublic = true AND (o.isDissolved = false OR o.isDissolved IS NULL)
RETURN o.name, o.summary
LIMIT 3","match
  $o isa organization;
  $o has is_public true;
  not { $o has is_dissolved true; };
  $city isa city, has city_name ""Seattle"";
  located_in (organization: $o, city: $city);
limit 3;
fetch { ""name"": $o.name, ""summary"": $o.summary };"
companies,209,List the top 3 organizations that have a CEO and have been mentioned in the most recent articles.,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
MATCH (a:Article)-[:MENTIONS]->(o)
WITH o, count(a) AS mentionCount, max(a.date) AS latestMentionDate
ORDER BY latestMentionDate DESC, mentionCount DESC
RETURN o.name AS organization, latestMentionDate, mentionCount
LIMIT 3","match
  $o isa organization;
  ceo_of (organization: $o, ceo: $p);
  $a isa article, has date $d;
  mentions (article: $a, mentioned: $o);
reduce $latestDate = max($d), $mentionCount = count($a) groupby $o;
sort $latestDate desc, $mentionCount desc;
limit 3;
fetch { ""organization"": $o.name, ""latestMentionDate"": $latestDate, ""mentionCount"": $mentionCount };"
companies,211,Find the first 3 organizations that have CEOs named 'Julie Spellman Sweet' and are mentioned in articles with a sentiment score above 0.5.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE EXISTS {
  (o)<-[:MENTIONS]-(a:Article)
  WHERE a.sentiment > 0.5
}
RETURN o
LIMIT 3","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  ceo_of (organization: $o, ceo: $p);
  $a isa article, has sentiment $s;
  $s > 0.5;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""o"": $o };"
companies,215,Which organizations have more than 1000 employees and are mentioned in articles with a sentiment score below 0.5?,"MATCH (o:Organization)
WHERE o.nbrEmployees > 1000
AND EXISTS {
  (o)<-[:MENTIONS]-(a:Article)
  WHERE a.sentiment < 0.5
}
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization, has nbr_employees $emp;
  $emp > 1000;
  $a isa article, has sentiment $sent;
  $sent < 0.5;
  mentions (article: $a, mentioned: $o);
fetch { ""organization"": $o.name, ""numberOfEmployees"": $emp };"
companies,216,Find the first 3 organizations based in 'Seattle' that have been mentioned in articles authored by 'David Correa'.,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'})
WHERE EXISTS {
  (o)<-[:MENTIONS]-(:Article {author: 'David Correa'})
}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $city isa city, has city_name ""Seattle"";
  located_in (organization: $o, city: $city);
  $article isa article, has author ""David Correa"";
  mentions (article: $article, mentioned: $o);
limit 3;
fetch { ""name"": $o.name };"
companies,220,Which organizations have a CEO named 'Julie Spellman Sweet' and have been mentioned in articles with a sentiment score above 0.8?,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'})
WHERE EXISTS {
  (o)<-[:MENTIONS]-(a:Article)
  WHERE a.sentiment > 0.8
}
RETURN o","match
  $o isa organization;
  $p isa person, has name ""Julie Spellman Sweet"";
  ceo_of (organization: $o, ceo: $p);
  $a isa article, has sentiment $s;
  $s > 0.8;
  mentions (article: $a, mentioned: $o);
fetch { ""o"": $o };"
companies,221,Find the first 3 organizations based in 'Italy' that have a public status and are not dissolved.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'Italy'})
WHERE o.isPublic = true AND (o.isDissolved IS NULL OR o.isDissolved = false)
RETURN o.name AS organization, o.summary AS summary
LIMIT 3","match
  $o isa organization;
  $o has is_public true;
  not { $o has is_dissolved true; };
  $city isa city;
  $c isa country, has country_name ""Italy"";
  located_in (organization: $o, city: $city);
  location-contains (child: $city, parent: $c);
limit 3;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,227,Who are the first 3 board members of organizations that have a CEO and are based in 'United States of America'?,"MATCH (o:Organization)-[:HAS_CEO]->(:Person)
WHERE (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(:Country {name: 'United States of America'})
WITH o
MATCH (o)-[:HAS_BOARD_MEMBER]->(boardMember:Person)
RETURN boardMember.name
LIMIT 3","match
  $o isa organization;
  ceo_of (organization: $o, ceo: $ceo);
  $city isa city;
  located_in (organization: $o, city: $city);
  $country isa country, has country_name ""United States of America"";
  location-contains (parent: $country, child: $city);
  $boardMember isa person;
  board_member_of (organization: $o, member: $boardMember);
limit 3;
fetch { ""name"": $boardMember.name };"
companies,231,Identify the top 3 organizations that have been mentioned in articles authored by 'James Blackman'.,"MATCH (a:Article {author: 'James Blackman'})-[:MENTIONS]->(o:Organization)
RETURN o.name AS organization, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $a isa article, has author ""James Blackman"";
  $o isa organization, has name $name;
  mentions (article: $a, mentioned: $o);
reduce $mentions = count($a) groupby $o, $name;
sort $mentions desc;
limit 3;
fetch { ""organization"": $name };"
companies,232,Which organizations have a revenue greater than 100 million but less than 500 million?,"MATCH (o:Organization)
WHERE o.revenue > 1E8 AND o.revenue < 5E8
RETURN o.name AS organization, o.revenue AS revenue","match
  $o isa organization;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
  $o_revenue < 500000000;
fetch { ""organization"": $o.name, ""revenue"": $o.revenue };"
companies,235,What are the top 5 organizations in terms of revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization, has revenue $r;
sort $r desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $r };"
companies,240,What organizations have 'Electronic Products Manufacturers' as their industry category?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  in_category (organization: $o, category: $c);
fetch { ""organization"": $o.name };"
companies,244,What are the top 3 articles by sentiment that mention an organization with a revenue of over 1 billion?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.revenue > 1e9
RETURN a.title AS article, a.sentiment AS sentiment
ORDER BY sentiment DESC
LIMIT 3","match
  $a isa article;
  $o isa organization;
  mentions (article: $a, mentioned: $o);
  $o has revenue $o_revenue;
  $o_revenue > 1000000000;
  $a has sentiment $sentiment;
sort $sentiment desc;
limit 3;
fetch { ""article"": $a.title, ""sentiment"": $sentiment };"
companies,246,What are the first 5 cities by the number of organizations located there?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name AS city, orgCount","match
  $c isa city;
  $o isa organization;
  located_in (city: $c, organization: $o);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 5;
fetch { ""city"": $c.city_name, ""orgCount"": $count };"
companies,248,What organizations are mentioned in the article titled 'Funds for Consumer Behavior Specialist Infinite Analytics'?,"MATCH (a:Article {title: 'Funds for Consumer Behavior Specialist Infinite An'})-[:MENTIONS]->(o:Organization)
RETURN o.name AS organization","match
  $o isa organization;
  $a isa article, has article_summary ""Funds for Consumer Behavior Specialist Infinite Analytics"";
  mentions (article: $a, mentioned: $o);
fetch { ""organization"": $o.name };"
companies,255,Which organizations have a motto containing the word 'technology'?,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'technology'
RETURN o.name AS organization, o.motto AS motto","match
  $o isa organization, has motto $m, has name $name;
  $m like "".*technology.*"";
fetch {
  ""organization"": $name,
  ""motto"": $m
};"
companies,263,List the parents of 'David Correa'.,"MATCH (p:Person {name: 'David Correa'})<-[:HAS_CHILD]-(parent:Person)
RETURN parent.name AS parent","match
  $p isa person, has name ""David Correa"";
  $parent isa person;
  parent_of (parent: $parent, child: $p);
fetch { ""parent"": $parent.name };"
companies,264,What are the first 3 organizations mentioned in articles from 'MrWeb'?,"MATCH (article:Article {siteName: 'MrWeb'})-[:MENTIONS]->(org:Organization)
RETURN org.name
LIMIT 3","match
  $article isa article, has site_name ""MrWeb"";
  $org isa organization;
  (article: $article, mentioned: $org) isa mentions;
limit 3;
fetch {
  ""name"": $org.name
};"
companies,268,Which cities have more than two industries represented by organizations within them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(i:IndustryCategory)
WITH c, count(DISTINCT i) AS industryCount
WHERE industryCount > 2
RETURN c.name AS city, industryCount","match
  $c isa city;
  $o isa organization;
  $i isa industry_category;
  located_in (organization: $o, city: $c);
  in_category (organization: $o, category: $i);
select $c, $i;
distinct;
reduce $count = count($i) groupby $c;
match $count > 2;
fetch { ""city"": $c.city_name, ""industryCount"": $count };"
companies,269,What are the top 3 industries by the number of organizations in each?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
RETURN ic.name AS industry, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3","match
  $ic isa industry_category, has industry_category_name $name;
  $o isa organization;
  in_category (organization: $o, category: $ic);
reduce $numOrganizations = count($o) groupby $ic, $name;
sort $numOrganizations desc;
limit 3;
fetch {
  ""industry"": $name,
  ""numOrganizations"": $numOrganizations
};"
companies,271,Which organization has the highest revenue and is not public?,"MATCH (o:Organization)
WHERE o.isPublic = false
RETURN o
ORDER BY o.revenue DESC
LIMIT 1","match
  $o isa organization, has is_public false, has revenue $r;
sort $r desc;
limit 1;
fetch { ""organization"": $o.name };"
companies,273,"Which organizations have more than 10,000 employees and are located in a country outside of 'United States of America'?","MATCH (o:Organization)
WHERE o.nbrEmployees > 10000 AND EXISTS {
  (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
  WHERE c.name <> 'United States of America'
}
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization, has nbr_employees $emp;
  $emp > 10000;
  $city isa city;
  $country isa country, has country_name $cname;
  $cname != ""United States of America"";
  located_in (organization: $o, city: $city);
  location-contains (parent: $country, child: $city);
fetch { ""organization"": $o.name, ""numberOfEmployees"": $emp };"
companies,277,What are the names of organizations that have at least 2 board members?,"MATCH (o:Organization)
WHERE size([(o)-[:HAS_BOARD_MEMBER]->(:Person) | 1]) >= 2
RETURN o.name","match
  $o isa organization;
  board_member_of (organization: $o, member: $p);
reduce $count = count($p) groupby $o;
match $count >= 2;
fetch { ""name"": $o.name };"
companies,278,Which countries have organizations with a revenue less than 10 million?,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WHERE o.revenue < 1E7
RETURN DISTINCT c.name","match
$o isa organization, has revenue $o_revenue;
$o_revenue < 10000000;
$city isa city;
located_in (organization: $o, city: $city);
location-contains (child: $city, parent: $c);
$c isa country, has country_name $name;
select $name;
distinct;
fetch { ""country_name"": $name };"
companies,281,Which articles mention any organizations that are suppliers to 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_SUPPLIER]-(supplier:Organization)<-[:MENTIONS]-(a:Article)
RETURN a","match
  $o isa organization, has name ""New Energy Group"";
  $supplier isa organization;
  supplies (supplier: $supplier, customer: $o);
  mentions (article: $a, mentioned: $supplier);
fetch { ""a"": $a };"
companies,284,List the first 3 organizations that were mentioned in articles with a sentiment less than 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0.5
RETURN o.name
LIMIT 3","match
  $a isa article, has sentiment $s;
  $s < 0.5;
  mentions (article: $a, mentioned: $o);
  $o isa organization;
limit 3;
fetch { ""name"": $o.name };"
companies,285,What is the name of the organization that has the highest number of employees and is headquartered in a city named 'Seattle'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 1","match
  $o isa organization, has name $name, has nbr_employees $emp;
  $c isa city, has city_name ""Seattle"";
  located_in (organization: $o, city: $c);
sort $emp desc;
limit 1;
fetch { ""organization"": $name };"
companies,287,Which organizations are headquartered in a city that is not in 'United States of America' and have a revenue of over 100 million?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country)
WHERE country.name <> 'United States of America' AND o.revenue > 1E8
RETURN o.name AS organization, c.name AS city, country.name AS country, o.revenue AS revenue","match
  $o isa organization;
  $c isa city;
  $country isa country;
  (organization: $o, city: $c) isa located_in;
  (child: $c, parent: $country) isa location-contains;
  $o has revenue $o_revenue;
  $o_revenue > 100000000;
  not { $country has country_name ""United States of America""; };
fetch { ""organization"": $o.name, ""city"": $c.city_name, ""country"": $country.country_name, ""revenue"": $o.revenue };"
companies,288,List the organizations that are public and have a CEO who is a female.,"MATCH (o:Organization {isPublic: true})-[:HAS_CEO]->(ceo:Person)
WHERE ceo.name IS NOT NULL AND ceo.name =~ "".*\\s(Ms\\.|Mrs\\.|Miss).*""
RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization, has is_public true;
  $ceo isa person, has name $ceo_name;
  ceo_of (organization: $o, ceo: $ceo);
  { $ceo_name like "".* Ms\\..*""; } or { $ceo_name like "".* Mrs\\..*""; } or { $ceo_name like "".* Miss .*""; };
fetch { ""organization"": $o.name, ""ceo"": $ceo_name };"
companies,289,Which cities have the most organizations that are dissolved?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isDissolved = true
RETURN c.name AS city, count(o) AS dissolvedOrgs
ORDER BY dissolvedOrgs DESC
LIMIT 1","match
  $c isa city, has city_name $city_name;
  $o isa organization, has is_dissolved true;
  located_in (organization: $o, city: $c);
reduce $dissolvedOrgs = count($o) groupby $city_name;
sort $dissolvedOrgs desc;
limit 1;
fetch { ""city"": $city_name, ""dissolvedOrgs"": $dissolvedOrgs };"
companies,294,Which organizations have a CEO who is also a board member in another organization?,"MATCH (o1:Organization)-[:HAS_CEO]->(p:Person)<-[:HAS_BOARD_MEMBER]-(o2:Organization)
WHERE o1 <> o2
RETURN o1.name AS org1, p.name AS ceo_board_member, o2.name AS org2","match
$o1 isa organization;
$o2 isa organization;
$p isa person;
ceo_of (organization: $o1, ceo: $p);
board_member_of (organization: $o2, member: $p);
not { $o1 is $o2; };
fetch { ""org1"": $o1.name, ""ceo_board_member"": $p.name, ""org2"": $o2.name };"
companies,296,What are the names of the top 5 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization, has revenue $r;
sort $r desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $r };"
companies,300,Which 3 organizations have the most employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization, has nbr_employees $n;
sort $n desc;
limit 3;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $n };"
companies,301,Name the top 5 articles with the highest sentiment scores.,"MATCH (a:Article)
RETURN a.title AS title, a.sentiment AS sentiment
ORDER BY a.sentiment DESC
LIMIT 5","match
  $a isa article, has title $title, has sentiment $sentiment;
sort $sentiment desc;
limit 5;
fetch { ""title"": $title, ""sentiment"": $sentiment };"
companies,302,Can you identify 3 organizations mentioned in articles published in 2022?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.date.year = 2022
RETURN DISTINCT o.name
LIMIT 3","match
  $a isa article, has date $d;
  $o isa organization, has name $n;
  mentions (article: $a, mentioned: $o);
  $d >= 2022-01-01;
  $d < 2023-01-01;
select $n;
distinct;
limit 3;
fetch { ""name"": $n };"
companies,303,What are the names of 3 industry categories that the most organizations belong to?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
RETURN ic.name AS category, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $ic isa industry_category, has industry_category_name $icn;
  $o isa organization;
  in_category (organization: $o, category: $ic);
reduce $count = count($o) groupby $icn;
sort $count desc;
limit 3;
fetch { ""category"": $icn };"
companies,312,Which 3 people have the most children listed in the database?,"MATCH (p:Person)-[:HAS_CHILD]->(child:Person)
WITH p, count(child) AS num_children
ORDER BY num_children DESC
LIMIT 3
RETURN p.name AS name, num_children","match
  $p isa person, has name $pn;
  parent_of (parent: $p, child: $child);
reduce $count = count($child) groupby $p, $pn;
sort $count desc;
limit 3;
fetch { ""name"": $pn, ""num_children"": $count };"
companies,313,Name the first 3 organizations that have at least one board member who is also a CEO of another organization.,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WHERE EXISTS {(p)-[:HAS_CEO]-(:Organization)}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  board_member_of (organization: $o, member: $p);
  $o2 isa organization;
  ceo_of (organization: $o2, ceo: $p);
  not { $o is $o2; };
limit 3;
fetch { ""name"": $o.name };"
companies,314,List the top 5 cities where the headquarters of public organizations are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isPublic = true
RETURN c.name AS city, count(*) AS numPublicOrgs
ORDER BY numPublicOrgs DESC
LIMIT 5","match
  $o isa organization, has is_public true;
  located_in (organization: $o, city: $c);
  $c has city_name $city;
reduce $count = count($o) groupby $city;
sort $count desc;
limit 5;
fetch { ""city"": $city, ""numPublicOrgs"": $count };"
companies,316,Name 3 organizations that have been mentioned in articles with a sentiment score above 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.5
RETURN DISTINCT o.name
LIMIT 3","match
  $o isa organization;
  $a isa article, has sentiment $s;
  $s > 0.5;
  mentions (article: $a, mentioned: $o);
select $o;
distinct;
limit 3;
fetch { ""name"": $o.name };"
companies,319,Which 3 organizations have the highest number of investors?,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor)
WITH o, count(investor) AS investorCount
ORDER BY investorCount DESC
LIMIT 3
RETURN o.name AS organization, investorCount","match
  $o isa organization;
  invested_in (organization: $o, investor: $investor);
reduce $count = count($investor) groupby $o;
sort $count desc;
limit 3;
fetch { ""organization"": $o.name, ""investor_count"": $count };"
companies,320,Name the first 3 organizations that have been mentioned in articles related to environmental issues.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'environment'
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article;
  $c isa chunk, has text $t;
  $t like "".*environment.*"";
  has_chunk (article: $a, chunk: $c);
  $o isa organization;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""name"": $o.name };"
companies,321,What are the names of 3 organizations that have been dissolved but are still mentioned in recent articles?,"MATCH (o:Organization {isDissolved: true})<-[:MENTIONS]-(a:Article)
WHERE a.date >= datetime() - duration('P1Y')
RETURN o.name
LIMIT 3","match
  $o isa organization, has is_dissolved true, has name $name;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""name"": $name };"
companies,322,Which 3 countries are mentioned the most in articles regarding technology advancements?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory), (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country:Country)
WHERE ic.name CONTAINS 'Technology'
WITH country, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3
RETURN country.name AS country, mentions","match
  $a isa article;
  $o isa organization;
  $ic isa industry_category, has industry_category_name $icn;
  $icn contains ""Technology"";
  $city isa city;
  $country isa country;
  mentions (article: $a, mentioned: $o);
  in_category (organization: $o, category: $ic);
  located_in (organization: $o, city: $city);
  location-contains (child: $city, parent: $country);
reduce $count = count($a) groupby $country;
sort $count desc;
limit 3;
fetch { ""country"": $country.country_name, ""mentions"": $count };"
companies,323,List the top 5 organizations that have a subsidiary in the same city where they are headquartered.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(s:Organization), 
      (o)-[:IN_CITY]->(c:City)<-[:IN_CITY]-(s)
RETURN o.name AS organization, c.name AS city
LIMIT 5","match
  $o isa organization;
  $s isa organization;
  $c isa city;
  (parent: $o, subsidiary: $s) isa subsidiary_of;
  (organization: $o, city: $c) isa located_in;
  (organization: $s, city: $c) isa located_in;
limit 5;
fetch { ""organization"": $o.name, ""city"": $c.city_name };"
companies,325,Name the top 3 organizations by number of articles mentioning them in 2021.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date >= date(""2021-01-01"") AND a.date <= date(""2021-12-31"") 
WITH o, count(a) as mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name as organization, mentions","match
  $o isa organization;
  $a isa article, has date $d;
  $d >= 2021-01-01T00:00:00;
  $d <= 2021-12-31T23:59:59;
  (article: $a, mentioned: $o) isa mentions;
reduce $mentions = count($a) groupby $o;
sort $mentions desc;
limit 3;
fetch { ""organization"": $o.name, ""mentions"": $mentions };"
companies,326,List the first 3 organizations that have a CEO and a board member with the same name.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), 
      (o)-[:HAS_BOARD_MEMBER]->(board:Person)
WHERE ceo.name = board.name
RETURN o.name AS organization, ceo.name AS name
LIMIT 3","match
  $o isa organization;
  $ceo isa person, has name $n;
  $board isa person, has name $n;
  (organization: $o, ceo: $ceo) isa ceo_of;
  (organization: $o, member: $board) isa board_member_of;
limit 3;
fetch { ""organization"": $o.name, ""name"": $n };"
companies,327,What are the names of organizations that have both a supplier and a subsidiary in Europe?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization), 
      (o)-[:HAS_SUBSIDIARY]->(sub:Organization),
      (s)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(sc:Country),
      (sub)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(subc:Country)
WHERE sc.name IN ['France', 'Germany', 'Spain', 'Italy', 'United Kingdom'] 
  AND subc.name IN ['France', 'Germany', 'Spain', 'Italy', 'United Kingdom']
RETURN DISTINCT o.name AS organization","match
  $o isa organization;
  $s isa organization;
  $sub isa organization;
  $sc isa country;
  $subc isa country;
  (customer: $o, supplier: $s) isa supplies;
  (parent: $o, subsidiary: $sub) isa subsidiary_of;
  $city1 isa city;
  (organization: $s, city: $city1) isa located_in;
  (child: $city1, parent: $sc) isa location-contains;
  $city2 isa city;
  (organization: $sub, city: $city2) isa located_in;
  (child: $city2, parent: $subc) isa location-contains;
  { $sc has country_name ""France""; } or { $sc has country_name ""Germany""; } or { $sc has country_name ""Spain""; } or { $sc has country_name ""Italy""; } or { $sc has country_name ""United Kingdom""; };
  { $subc has country_name ""France""; } or { $subc has country_name ""Germany""; } or { $subc has country_name ""Spain""; } or { $subc has country_name ""Italy""; } or { $subc has country_name ""United Kingdom""; };
select $o;
distinct;
fetch { ""organization"": $o.name };"
companies,328,Which 3 cities are the most frequently mentioned settings in articles about finance?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Finance'}), (o)-[:IN_CITY]->(city:City)
RETURN city.name AS city, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
  $ic isa industry_category, has industry_category_name ""Finance"";
  $o isa organization;
  $a isa article;
  $city isa city;
  (organization: $o, category: $ic) isa in_category;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, city: $city) isa located_in;
reduce $count = count groupby $city;
sort $count desc;
limit 3;
fetch { ""city"": $city.city_name, ""mentions"": $count };"
companies,331,Which 3 countries have organizations that are major players in the electronics industry?,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Electronic Products Manufacturers'})
RETURN c.name AS country, count(o) AS num_orgs
ORDER BY num_orgs DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $city isa city;
  $o isa organization;
  $ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  location-contains (child: $city, parent: $c);
  located_in (organization: $o, city: $city);
  in_category (organization: $o, category: $ic);
reduce $num_orgs = count($o) groupby $cn;
sort $num_orgs desc;
limit 3;
fetch { ""country"": $cn, ""num_orgs"": $num_orgs };"
companies,332,Name the top 3 articles that discuss organizations with a history of more than 50 years.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE date(o.foundingDate) < date() - duration('P50Y')
WITH a, o
ORDER BY a.date DESC
LIMIT 3
RETURN a.title AS article, collect(o.name) AS organizations","match
  $a isa article;
  $o isa organization, has founding-date $fd;
  $fd < 1976-01-22;
  mentions (article: $a, mentioned: $o);
  $a has date $a_date;
sort $a_date desc;
limit 3;
fetch { ""article"": $a.title };"
companies,336,What are the names of 3 organizations that have a CEO who was previously a board member of a competitor?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (ceo)-[:HAS_BOARD_MEMBER]->(competitor:Organization)<-[:HAS_COMPETITOR]-(o)
}
RETURN o.name
LIMIT 3","match
  $o isa organization;
  ceo_of (organization: $o, ceo: $ceo);
  $competitor isa organization;
  competes_with (competitor: $o, competitor: $competitor);
  board_member_of (organization: $competitor, member: $ceo);
limit 3;
fetch { ""name"": $o.name };"
companies,342,Which 3 organizations have the most board members?,"MATCH (o:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)
WITH o, count(p) AS boardMemberCount
ORDER BY boardMemberCount DESC
LIMIT 3
RETURN o.name AS organization, boardMemberCount","match
  $o isa organization;
  board_member_of (organization: $o, member: $p);
reduce $count = count($p) groupby $o;
sort $count desc;
limit 3;
fetch { ""organization"": $o.name, ""boardMemberCount"": $count };"
companies,344,Name the top 3 organizations in terms of number of times they are mentioned as competitors in different industries.,"MATCH (o:Organization)-[:HAS_COMPETITOR]->(competitor:Organization)
WITH competitor, count(*) AS competitorCount
RETURN competitor.name AS competitorName, competitorCount
ORDER BY competitorCount DESC
LIMIT 3","match
  $o isa organization;
  $competitor isa organization;
  competes_with (competitor: $o, competitor: $competitor);
reduce $count = count($o) groupby $competitor;
sort $count desc;
limit 3;
fetch { ""competitorName"": $competitor.name, ""competitorCount"": $count };"
companies,345,Which 3 organizations have CEOs who have written articles about their own organizations?,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:MENTIONS]-(a:Article)-[:MENTIONS]->(o)
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 3","match
  $o isa organization;
  $p isa person, has name $ceo_name;
  ceo_of (organization: $o, ceo: $p);
  $a isa article, has author $author_val;
  $author_val == $ceo_name;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,346,List the names of 3 organizations that have subsidiaries in more than 3 countries.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country)
WITH o, count(DISTINCT c) AS numCountries
WHERE numCountries > 3
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $sub isa organization;
  subsidiary_of (parent: $o, subsidiary: $sub);
  located_in (organization: $sub, city: $city);
  location-contains (parent: $c, child: $city);
  $c isa country;
select $o, $c;
distinct;
reduce $count = count($c) groupby $o;
match $count > 3;
limit 3;
fetch { ""name"": $o.name };"
companies,351,Which 3 organizations have the most diverse range of industry categories they belong to?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory)
WITH o, count(distinct c) as categoryCount
ORDER BY categoryCount DESC
LIMIT 3
RETURN o.name as organization, categoryCount","match
  $o isa organization;
  in_category (organization: $o, category: $c);
reduce $count = count($c) groupby $o;
sort $count desc;
limit 3;
fetch { ""organization"": $o.name, ""categoryCount"": $count };"
companies,357,List the top 3 articles that focus on the impact of technology on education.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'technology' AND c.text CONTAINS 'education'
WITH a, count(c) AS relevance
ORDER BY relevance DESC
LIMIT 3
RETURN a.title AS article, a.summary AS summary","match
  $a isa article;
  has_chunk (article: $a, chunk: $c);
  $c has text $t;
  $t like "".*technology.*"";
  $t like "".*education.*"";
reduce $relevance = count($c) groupby $a;
sort $relevance desc;
limit 3;
fetch { ""article"": $a.article_id, ""summary"": $a.article_summary };"
companies,358,Name the first 3 organizations that have both a CEO and a board member from the same family.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person),
      (o)-[:HAS_BOARD_MEMBER]->(board_member:Person),
      (ceo)-[:HAS_PARENT|HAS_CHILD*]-(board_member)
RETURN o.name AS organization, ceo.name AS ceo, board_member.name AS board_member
LIMIT 3","match
  $o isa organization;
  $ceo isa person;
  $board_member isa person;
  (organization: $o, ceo: $ceo) isa ceo_of;
  (organization: $o, member: $board_member) isa board_member_of;
  parent_of ($ceo, $board_member);
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name, ""board_member"": $board_member.name };"
companies,360,"List the names of the first 3 organizations that have more than 10,000 employees.","MATCH (o:Organization)
WHERE o.nbrEmployees > 10000
RETURN o.name
LIMIT 3","match
  $o isa organization, has nbr_employees $e;
  $e > 10000;
limit 3;
fetch { ""name"": $o.name };"
companies,361,Name the top 3 countries by number of organizations that have been mentioned in articles related to healthcare.,"MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization)<-[:MENTIONS]-(a:Article)
WHERE (o)-[:HAS_CATEGORY]->(:IndustryCategory {name: 'Healthcare'})
RETURN c.name AS country, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $c isa country, has country_name $cn;
  $city isa city;
  $o isa organization;
  $a isa article;
  $ic isa industry_category, has industry_category_name ""Healthcare"";
  (child: $city, parent: $c) isa location-contains;
  (organization: $o, city: $city) isa located_in;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, category: $ic) isa in_category;
reduce $orgCount = count($o) groupby $cn;
sort $orgCount desc;
limit 3;"
companies,363,List the names of 3 organizations that have a motto related to sustainability.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'sustainability' OR o.motto CONTAINS 'sustainable'
RETURN o.name
LIMIT 3","match
  $o isa organization, has motto $m;
  { $m like "".*sustainability.*""; } or { $m like "".*sustainable.*""; };
limit 3;
fetch { ""name"": $o.name };"
companies,365,Which 3 cities are most frequently cited in articles about urban development?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(city:City)
WHERE c.text CONTAINS 'urban development'
RETURN city.name, count(*) as frequency
ORDER BY frequency DESC
LIMIT 3","match
  $a isa article;
  has_chunk (article: $a, chunk: $c);
  $c has text $text;
  $text like "".*urban development.*"";
  mentions (article: $a, mentioned: $o);
  located_in (organization: $o, city: $city);
  $city has city_name $cn;
reduce $frequency = count groupby $city, $cn;
sort $frequency desc;
limit 3;
fetch { ""city_name"": $cn, ""frequency"": $frequency };"
companies,373,Which 3 organizations have the most subsidiaries in different industries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(sub:Organization)
WHERE sub.id <> o.id
WITH o, count(DISTINCT sub.id) AS numSubs, collect(DISTINCT sub.id) AS subIds
WITH o, numSubs, size(apoc.coll.toSet([(sub)-[:HAS_CATEGORY]->(c) | c.name])) AS numIndustries, subIds
ORDER BY numIndustries DESC
LIMIT 3
RETURN o.name AS organization, numSubs, numIndustries, subIds","match
  $o isa organization;
  $sub isa organization;
  subsidiary_of (parent: $o, subsidiary: $sub);
  in_category (organization: $sub, category: $ic);
select $o, $ic;
distinct;
reduce $industry_count = count groupby $o;
sort $industry_count desc;
limit 3;
fetch { ""organization"": $o.name };"
companies,375,Name the top 3 organizations with the most mentions in articles about technology innovation.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE (a)-[:HAS_CHUNK]->(:Chunk)
WITH o, count(a) AS mentionCount
ORDER BY mentionCount DESC
LIMIT 3
RETURN o.name AS organization, mentionCount","match
  $o isa organization;
  $a isa article;
  mentions (article: $a, mentioned: $o);
  { $a has title $t1; $t1 like "".*[Tt]echnology.*""; } or 
  { $a has title $t2; $t2 like "".*[Ii]nnovation.*""; } or
  { $a has article_summary $s1; $s1 like "".*[Tt]echnology.*""; } or
  { $a has article_summary $s2; $s2 like "".*[Ii]nnovation.*""; };
reduce $count = count($a) groupby $o;
sort $count desc;
limit 3;
fetch { ""organization"": $o.name, ""mentionCount"": $count };"
companies,382,Name the top 3 articles that mention organizations affected by global economic changes.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.title CONTAINS 'economic'
RETURN a.title, a.summary
ORDER BY a.sentiment DESC
LIMIT 3","match
  $a isa article, has title $t, has sentiment $s;
  $t like "".*economic.*"";
  $o isa organization;
  mentions (article: $a, mentioned: $o);
sort $s desc;
limit 3;
fetch { ""title"": $a.title, ""summary"": $a.article_summary };"
companies,385,Which 3 organizations have the most diverse geographical distribution of subsidiaries?,"MATCH (o:Organization)-[:HAS_SUBSIDIARY*]->(s:Organization)
WITH o, count(DISTINCT s.id) AS numSubsidiaries, size(collect(DISTINCT s.id)) AS numUniqueSubsidiaries
WHERE numUniqueSubsidiaries > 1
RETURN o.name AS organization, numSubsidiaries, numUniqueSubsidiaries
ORDER BY numUniqueSubsidiaries DESC
LIMIT 3","match
$o isa organization;
subsidiary_of (parent: $o, subsidiary: $s);
reduce $count = count($s) groupby $o;
sort $count desc;
limit 3;
fetch { ""organization"": $o.name };"
companies,387,Name the top 3 organizations in terms of environmental impact according to articles.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WITH o, count(a) AS mentionCount
RETURN o.name AS organization, mentionCount
ORDER BY mentionCount DESC
LIMIT 3","match
  $o isa organization;
  $a isa article;
  mentions (article: $a, mentioned: $o);
reduce $mentionCount = count($a) groupby $o;
sort $mentionCount desc;
limit 3;
fetch { ""organization"": $o.name, ""mentionCount"": $mentionCount };"
companies,392,List the names of 3 organizations that have been involved in major international trade deals in the past year.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date >= datetime() - duration('P1Y')
WITH o, count(a) as mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name","match
  $o isa organization;
  mentions (article: $a, mentioned: $o);
reduce $mentions = count($a) groupby $o;
sort $mentions desc;
limit 3;
fetch { ""name"": $o.name };"
companies,393,Which 3 organizations have been mentioned the most in articles about financial crises?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.summary CONTAINS 'financial crisis'
WITH o, count(*) as mentions
ORDER BY mentions DESC
LIMIT 3
RETURN o.name as organization, mentions","match
  $a isa article, has article_summary $s;
  $s like "".*financial crisis.*"";
  $o isa organization;
  mentions (article: $a, mentioned: $o);
reduce $mentions = count($a) groupby $o;
sort $mentions desc;
limit 3;
fetch { ""organization"": $o.name, ""mentions"": $mentions };"
companies,398,What are the names of industry categories that have associated organizations with more than 100 employees?,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WHERE o.nbrEmployees > 100
RETURN DISTINCT ic.name","match
  $ic isa industry_category;
  in_category (organization: $o, category: $ic);
  $o has nbr_employees $n;
  $n > 100;
select $ic;
distinct;
fetch { ""name"": $ic.industry_category_name };"
companies,404,Identify articles with a sentiment score above 0.8.,"MATCH (a:Article)
WHERE a.sentiment > 0.8
RETURN a","match
  $a isa article, has sentiment $s;
  $s > 0.8;
fetch { ""article"": $a };"
companies,410,Name the organizations that are suppliers to 'Accenture'.,"MATCH (o:Organization)<-[:HAS_SUPPLIER]-(a:Organization {name: 'Accenture'})
RETURN o.name AS supplier","match
  $a isa organization, has name ""Accenture"";
  $o isa organization;
  supplies (supplier: $o, customer: $a);
fetch { ""supplier"": $o.name };"
companies,412,List the top 5 organizations by number of employees.,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 5","match
  $o isa organization, has nbr_employees $n;
sort $n desc;
limit 5;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $n };"
companies,414,Identify the organizations with the highest revenue in the 'Electronic Products Manufacturers' industry.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 10","match
  $o isa organization, has revenue $rev;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  in_category (organization: $o, category: $c);
sort $rev desc;
limit 10;
fetch { ""organization"": $o.name, ""revenue"": $rev };"
companies,415,Which articles mention organizations with a revenue less than 10 million?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization) WHERE o.revenue < 1E7 RETURN a, o","match
  $a isa article;
  $o isa organization, has revenue $r;
  $r < 10000000;
  mentions (article: $a, mentioned: $o);
fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,416,What are the names and summaries of organizations mentioned in articles with a high sentiment score (>0.9)?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment > 0.9
RETURN o.name AS organization, o.summary AS summary","match
  $a isa article, has sentiment $s;
  $s > 0.9;
  mentions (article: $a, mentioned: $o);
  $o isa organization;
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,417,List the organizations that have their CEOs also serving as board members in other organizations.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person) WHERE EXISTS { (ceo)-[:HAS_BOARD_MEMBER]-(:Organization) } RETURN o.name AS organization, ceo.name AS ceo","match
  $o isa organization;
  $p isa person;
  (organization: $o, ceo: $p) isa ceo_of;
  $other isa organization;
  (organization: $other, member: $p) isa board_member_of;
  not { $o is $other; };
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,418,Name the children of 'Julie Spellman Sweet'.,MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_CHILD]->(child:Person) RETURN child.name,"match
  $p isa person, has name ""Julie Spellman Sweet"";
  $child isa person;
  parent_of (parent: $p, child: $child);
fetch { ""child_name"": $child.name };"
companies,419,Which organizations are based in cities not in the 'United States of America'?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)-[:IN_COUNTRY]->(country:Country) WHERE country.name <> 'United States of America' RETURN o.name AS organization, c.name AS city, country.name AS country","match $o isa organization; $c isa city; $country isa country, has country_name $cn; (organization: $o, city: $c) isa located_in; (child: $c, parent: $country) isa location-contains; not { $cn == ""United States of America""; }; fetch { ""organization"": $o.name, ""city"": $c.city_name, ""country"": $cn };"
companies,420,Identify all organizations that have a motto containing the word 'security'.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
RETURN o","match
  $o isa organization, has motto $m;
  $m like "".*security.*"";
fetch { ""organization"": $o };"
companies,422,Which organizations have the most articles mentioning them?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) as mentionCount
RETURN o.name as organization, mentionCount
ORDER BY mentionCount DESC
LIMIT 10","match
  $o isa organization;
  mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o;
sort $count desc;
limit 10;
fetch { ""organization"": $o.name, ""mentionCount"": $count };"
companies,423,List all the organizations and their respective CEOs who are mentioned in the same article.,"MATCH (article:Article)-[:MENTIONS]->(org:Organization), 
      (org)-[:HAS_CEO]->(ceo:Person)
RETURN org.name AS organization, ceo.name AS ceo","match
  $a isa article;
  $o isa organization;
  $p isa person;
  mentions (article: $a, mentioned: $o);
  ceo_of (organization: $o, ceo: $p);
fetch { ""organization"": $o.name, ""ceo"": $p.name };"
companies,424,Name the industry categories that have the most organizations associated with them.,"MATCH (ic:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)
WITH ic, count(o) as orgCount
ORDER BY orgCount DESC
RETURN ic.name as industryCategory, orgCount
LIMIT 10","match
  $ic isa industry_category, has industry_category_name $icn;
  $o isa organization;
  in_category (organization: $o, category: $ic);
reduce $count = count($o) groupby $ic, $icn;
sort $count desc;
limit 10;
fetch { ""industryCategory"": $icn, ""orgCount"": $count };"
companies,425,Which organizations have been mentioned in the most negative sentiment articles?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment IS NOT NULL
WITH o, min(a.sentiment) AS minSentiment, count(a) AS numMentions
RETURN o.name AS organization, minSentiment, numMentions
ORDER BY minSentiment
LIMIT 10","match
  $o isa organization, has name $on;
  $a isa article, has sentiment $s;
  mentions (article: $a, mentioned: $o);
reduce $minSentiment = min($s), $numMentions = count($a) groupby $o, $on;
sort $minSentiment asc;
limit 10;
fetch { ""organization"": $on, ""minSentiment"": $minSentiment, ""numMentions"": $numMentions };"
companies,427,What are the names of organizations that have both public and private subsidiaries?,MATCH (o:Organization) WHERE EXISTS { (o)-[:HAS_SUBSIDIARY]->(:Organization {isPublic: true}) } AND EXISTS { (o)-[:HAS_SUBSIDIARY]->(:Organization {isPublic: false}) } RETURN o.name,"match
  $o isa organization;
  $sub1 isa organization, has is_public true;
  $sub2 isa organization, has is_public false;
  subsidiary_of (parent: $o, subsidiary: $sub1);
  subsidiary_of (parent: $o, subsidiary: $sub2);
fetch { ""name"": $o.name };"
companies,429,List the organizations that have been mentioned in articles related to security threats.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk)
WHERE c.text CONTAINS 'security threats'
WITH a
MATCH (a)-[:MENTIONS]->(o:Organization)
RETURN DISTINCT o.name AS organization","match
  $c isa chunk, has text $t;
  $t like "".*security threats.*"";
  has_chunk (article: $a, chunk: $c);
  mentions (article: $a, mentioned: $o);
  $o has name $name;
select $name;
distinct;
fetch { ""organization"": $name };"
companies,432,List the organizations that have the most investors.,"MATCH (o:Organization)<-[:HAS_INVESTOR]-(investor)
WITH o, count(investor) AS investorCount
RETURN o.name AS organization, investorCount
ORDER BY investorCount DESC
LIMIT 10","match
  $o isa organization;
  invested_in (organization: $o, investor: $investor);
reduce $count = count($investor) groupby $o;
sort $count desc;
limit 10;
fetch { ""organization"": $o.name, ""investorCount"": $count };"
companies,435,List the organizations that have been mentioned in the most articles.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WITH o, count(a) AS mentionCount
RETURN o.name AS organization, mentionCount
ORDER BY mentionCount DESC","match
  $o isa organization, has name $name;
  mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o, $name;
sort $count desc;
fetch { ""organization"": $name, ""mentionCount"": $count };"
companies,441,List the cities that have organizations with a revenue exceeding 500 million.,MATCH (c:City)<-[:IN_CITY]-(o:Organization) WHERE o.revenue > 5e8 RETURN c.name AS city,"match
  $c isa city;
  $o isa organization, has revenue $r;
  $r > 500000000;
  located_in (city: $c, organization: $o);
fetch { ""city"": $c.city_name };"
companies,447,List the articles that mention organizations headquartered in 'Seattle'.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) RETURN a.title, a.summary, a.date, o.name","match
  $a isa article;
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  mentions (article: $a, mentioned: $o);
  located_in (organization: $o, city: $c);
fetch { ""title"": $a.title, ""summary"": $a.article_summary, ""date"": $a.date, ""organization"": $o.name };"
companies,453,Name the organizations with the most board members who are also CEOs of other organizations.,"MATCH (o:Organization)<-[:HAS_BOARD_MEMBER]-(boardMember:Person)
WHERE EXISTS {
  (boardMember)-[:HAS_CEO]->(:Organization)
}
WITH o, count(boardMember) AS boardMemberCEOCount
RETURN o.name AS organization, boardMemberCEOCount
ORDER BY boardMemberCEOCount DESC
LIMIT 10","match
  $o isa organization;
  $bm isa person;
  $other isa organization;
  board_member_of (organization: $o, member: $bm);
  ceo_of (organization: $other, ceo: $bm);
  not { $o is $other; };
reduce $count = count($bm) groupby $o;
sort $count desc;
limit 10;
fetch { ""organization"": $o.name, ""boardMemberCEOCount"": $count };"
companies,454,List the top 5 cities by number of public organizations.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.isPublic = true
WITH c, count(o) as orgCount
ORDER BY orgCount DESC
LIMIT 5
RETURN c.name as city, orgCount as numberOfPublicOrganizations","match
  $o isa organization, has is_public true;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 5;
fetch { ""city"": $c.city_name, ""numberOfPublicOrganizations"": $count };"
companies,467,List the cities where the most CEOs of large organizations reside.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CEO]->(p:Person) WHERE o.nbrEmployees > 1000 RETURN c.name AS city, count(p) AS ceoCount ORDER BY ceoCount DESC LIMIT 10","match
$c isa city;
$o isa organization, has nbr_employees $e;
$e > 1000;
$p isa person;
(organization: $o, city: $c) isa located_in;
(organization: $o, ceo: $p) isa ceo_of;
reduce $ceoCount = count($p) groupby $c;
sort $ceoCount desc;
limit 10;
fetch {
  ""city"": $c.city_name,
  ""ceoCount"": $ceoCount
};"
companies,468,Which organizations have the most positive sentiment articles mentioning them?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article) WITH o, avg(a.sentiment) AS avgSentiment ORDER BY avgSentiment DESC LIMIT 10 RETURN o.name AS organization, avgSentiment","match
  $o isa organization, has name $name;
  $a isa article, has sentiment $s;
  mentions (article: $a, mentioned: $o);
reduce $avgSentiment = mean($s) groupby $o, $name;
sort $avgSentiment desc;
limit 10;
fetch {
  ""organization"": $name,
  ""avgSentiment"": $avgSentiment
};"
companies,469,Name the organizations that have been mentioned in articles about financial fraud.,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)
WHERE c.text CONTAINS 'financial fraud'
RETURN DISTINCT o.name","match
$a isa article;
$c isa chunk, has text $t;
$t like "".*financial fraud.*"";
has_chunk (article: $a, chunk: $c);
$o isa organization, has name $n;
mentions (article: $a, mentioned: $o);
select $n;
distinct;
fetch { ""name"": $n };"
companies,472,List the organizations that are mentioned in articles with a sentiment score of exactly 0.5.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment = 0.5
RETURN DISTINCT o","match
  $a isa article, has sentiment 0.5;
  $o isa organization;
  mentions (article: $a, mentioned: $o);
select $o;
distinct;
fetch { ""organization"": $o.name };"
companies,475,What are the names of the first 3 organizations that have been dissolved?,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name
LIMIT 3","match $o isa organization, has is_dissolved true;
limit 3;
fetch { ""name"": $o.name };"
companies,476,List the top 5 organizations with the highest revenue.,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
$o isa organization, has revenue $r;
sort $r desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $r };"
companies,477,Which organizations are located in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
RETURN o.name AS organization","match
  $o isa organization;
  $c isa city, has city_name ""Seattle"";
  located_in (organization: $o, city: $c);
fetch { ""organization"": $o.name };"
companies,480,What are the names of the first 3 organizations that have a motto?,"MATCH (o:Organization)
WHERE o.motto IS NOT NULL
RETURN o.name
LIMIT 3","match
  $o isa organization, has motto $m, has name $name;
limit 3;
fetch { ""name"": $name };"
companies,481,Identify the first 3 cities where organizations with more than 1000 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 1000
RETURN c.name AS city
ORDER BY c.name
LIMIT 3","match
  $o isa organization, has nbr_employees $e;
  $e > 1000;
  $c isa city, has city_name $name;
  located_in (organization: $o, city: $c);
sort $name asc;
limit 3;
fetch { ""city"": $name };"
companies,482,What are the names of the first 5 people who are board members of more than one organization?,"MATCH (p:Person)-[:HAS_BOARD_MEMBER]->(:Organization) WITH p, count(p) AS num_orgs WHERE num_orgs > 1 RETURN p.name LIMIT 5","match
  $p isa person;
  $o isa organization;
  board_member_of (organization: $o, member: $p);
reduce $count = count($o) groupby $p;
match $count > 1;
limit 5;
fetch { ""name"": $p.name };"
companies,488,Which organizations are suppliers to New Energy Group?,"MATCH (o:Organization {name: ""New Energy Group""})<-[:HAS_SUPPLIER]-(supplier:Organization) RETURN supplier","match
$o isa organization, has name ""New Energy Group"";
$supplier isa organization;
supplies (customer: $o, supplier: $supplier);
fetch { ""supplier"": $supplier };"
companies,489,Who are the first 3 people with children also working in the same organization?,"MATCH (p:Person)-[:HAS_CHILD]->(c:Person), (p)-[:HAS_CEO|HAS_BOARD_MEMBER]->(:Organization)<-[:HAS_CEO|HAS_BOARD_MEMBER]-(c) RETURN p.name AS parent, c.name AS child LIMIT 3","match
$p isa person;
$c isa person;
$org isa organization;
parent_of (parent: $p, child: $c);
{ ceo_of (ceo: $p, organization: $org); } or { board_member_of (member: $p, organization: $org); };
{ ceo_of (ceo: $c, organization: $org); } or { board_member_of (member: $c, organization: $org); };
limit 3;
fetch { ""parent"": $p.name, ""child"": $c.name };"
companies,492,Which organizations have a revenue greater than 1 billion and are public?,MATCH (o:Organization) WHERE o.revenue > 1e9 AND o.isPublic = true RETURN o,"match
  $o isa organization, has revenue $r, has is_public true;
  $r > 1000000000;
fetch { ""organization"": $o };"
companies,493,What are the names of the first 3 persons who are investors in more than one organization?,"MATCH (p:Person)-[:HAS_INVESTOR]->(o:Organization)
WITH p, count(o) as num_orgs
WHERE num_orgs > 1
RETURN p.name
LIMIT 3","match
  $p isa person;
  $o isa organization;
  (investor: $p, organization: $o) isa invested_in;
reduce $num_orgs = count($o) groupby $p;
match $num_orgs > 1;
limit 3;
fetch { ""name"": $p.name };"
companies,494,What are the names of the first 3 organizations with the least number of employees?,"MATCH (o:Organization)
WHERE o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees
LIMIT 3","match
  $o isa organization, has nbr_employees $n;
sort $n asc;
limit 3;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $n };"
companies,497,List the top 5 organizations that have more than one supplier.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WITH o, count(s) as supplierCount
WHERE supplierCount > 1
RETURN o.name as organization, supplierCount
ORDER BY supplierCount DESC
LIMIT 5","match
  $o isa organization;
  supplies (customer: $o, supplier: $s);
reduce $supplierCount = count($s) groupby $o;
match $supplierCount > 1;
sort $supplierCount desc;
limit 5;
fetch { ""organization"": $o.name, ""supplierCount"": $supplierCount };"
companies,500,Identify the first 3 organizations that have a public status and are mentioned in articles with a negative sentiment.,"MATCH (o:Organization {isPublic: true})<-[:MENTIONS]-(a:Article)
WHERE a.sentiment < 0
RETURN o.name
LIMIT 3","match
  $o isa organization, has is_public true;
  $a isa article, has sentiment $s;
  $s < 0;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""name"": $o.name };"
companies,501,List the first 3 countries where organizations with over 500 employees are based.,MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE o.nbrEmployees > 500 RETURN DISTINCT c.name LIMIT 3,"match
  $o isa organization, has nbr_employees $e;
  $e > 500;
  $c isa city;
  $co isa country;
  located_in (organization: $o, city: $c);
  location-contains (parent: $co, child: $c);
select $co;
distinct;
limit 3;
fetch { ""country"": $co.country_name };"
companies,513,What are the first 3 articles that mention the organization 'Accenture'?,"MATCH (o:Organization {name: 'Accenture'})<-[:MENTIONS]-(a:Article)
RETURN a.title, a.summary, a.date
ORDER BY a.date DESC
LIMIT 3","match
  $o isa organization, has name ""Accenture"";
  $a isa article, has date $d;
  mentions (mentioned: $o, article: $a);
sort $d desc;
limit 3;
fetch { ""title"": $a.title, ""summary"": $a.article_summary, ""date"": $d };"
companies,514,List top 5 organizations that have a revenue greater than 100 million.,"MATCH (o:Organization)
WHERE o.revenue > 1E8
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization, has revenue $r;
  $r > 100000000;
sort $r desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $r };"
companies,520,Can you provide the first 3 organizations that have been dissolved?,"MATCH (o:Organization)
WHERE o.isDissolved IS NOT NULL AND o.isDissolved = true
RETURN o.name AS organization
LIMIT 3","match
  $o isa organization, has is_dissolved true;
limit 3;
fetch { ""organization"": $o.name };"
companies,527,List the first 5 cities that have organizations with more than 300 employees.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WHERE o.nbrEmployees > 300
RETURN c.name AS city
LIMIT 5","match
$c isa city;
$o isa organization, has nbr_employees $e;
$e > 300;
located_in (city: $c, organization: $o);
limit 5;
fetch { ""city"": $c.city_name };"
companies,538,What are the top 5 highest revenue organizations in the database?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization, has revenue $r, has name $n;
sort $r desc;
limit 5;
fetch {
  ""organization"": $n,
  ""revenue"": $r
};"
companies,561,List the first 5 organizations that have a motto containing 'world'.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'world'
RETURN o.name, o.motto
LIMIT 5","match
  $o isa organization, has motto $m;
  $m like "".*world.*"";
limit 5;
fetch { ""name"": $o.name, ""motto"": $m };"
companies,562,What are the first 3 organizations that have been mentioned in articles by 'David Correa'?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)
RETURN o.name
LIMIT 3","match
  $a isa article, has author ""David Correa"";
  $o isa organization, has name $n;
  mentions (article: $a, mentioned: $o);
limit 3;
fetch { ""name"": $n };"
companies,565,List the first 3 organizations that have a subsidiary and an investor.,MATCH (o:Organization)-[:HAS_SUBSIDIARY]->(:Organization) WHERE EXISTS {(o)<-[:HAS_INVESTOR]-(:Organization)} RETURN o.name LIMIT 3,"match
  $o isa organization;
  subsidiary_of (parent: $o, subsidiary: $sub);
  invested_in (organization: $o, investor: $inv);
limit 3;
fetch { ""name"": $o.name };"
companies,569,List the first 5 organizations that have a CEO with a summary mentioning 'Accenture'.,"MATCH (o:Organization)-[:HAS_CEO]->(p:Person)
WHERE p.summary CONTAINS 'Accenture'
RETURN o.name AS organization
LIMIT 5","match
$o isa organization;
$p isa person, has summary $s;
$s like "".*Accenture.*"";
ceo_of (organization: $o, ceo: $p);
limit 5;
fetch { ""organization"": $o.name };"
companies,585,Name the first 3 CEOs of organizations that are headquartered in a city starting with 'S'.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person), (o)-[:IN_CITY]->(city:City)
WHERE city.name STARTS WITH 'S'
RETURN ceo.name
LIMIT 3","match
  $o isa organization;
  $p isa person;
  $c isa city, has city_name $cn;
  $cn like ""S.*"";
  ceo_of (organization: $o, ceo: $p);
  located_in (organization: $o, city: $c);
limit 3;
fetch { ""ceo"": $p.name };"
companies,586,List the names of the first 3 organizations that have both a CEO and a board member named in their summary.,MATCH (o:Organization) WHERE EXISTS {(o)-[:HAS_CEO]->(:Person)} AND EXISTS {(o)-[:HAS_BOARD_MEMBER]->(:Person)} AND o.summary IS NOT NULL RETURN o.name LIMIT 3,"match
  $o isa organization, has name $name, has summary $s;
  ceo_of (organization: $o, ceo: $p1);
  board_member_of (organization: $o, member: $p2);
limit 3;
fetch { ""name"": $name };"
companies,588,Which organizations have a CEO and are headquartered in a country other than the USA?,"MATCH (o:Organization)-[:HAS_CEO]->(:Person) WHERE EXISTS { (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE c.name <> 'United States of America' } RETURN o.name AS organization, o.summary AS summary","match
$o isa organization;
$ceo isa person;
ceo_of (organization: $o, ceo: $ceo);
$city isa city;
located_in (organization: $o, city: $city);
$country isa country, has country_name $cn;
location-contains (parent: $country, child: $city);
not { $cn == ""United States of America""; };
fetch { ""organization"": $o.name, ""summary"": $o.summary };"
companies,597,Which organizations are mentioned in articles authored by 'David Correa'?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)
RETURN DISTINCT o.name AS organization","match
  $o isa organization;
  $a isa article, has author ""David Correa"";
  mentions (article: $a, mentioned: $o);
fetch { ""organization"": $o.name };"
companies,598,List the top 5 organizations that have more than 100 employees and are not dissolved.,"MATCH (o:Organization) WHERE o.nbrEmployees > 100 AND o.isDissolved IS NOT NULL AND NOT o.isDissolved RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees ORDER BY o.nbrEmployees DESC LIMIT 5","match
  $o isa organization, has nbr_employees $n, has is_dissolved false;
  $n > 100;
sort $n desc;
limit 5;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $n };"
companies,599,What are the names of the organizations that have a public status and revenue greater than 100000000?,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.revenue > 100000000
RETURN o.name","match $o isa organization, has is_public true, has revenue $r; $r > 100000000; fetch { ""name"": $o.name };"
companies,610,List the countries where organizations with a revenue of over 50000000 are located.,MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE o.revenue > 50000000 RETURN DISTINCT c.name,"match
  $o isa organization, has revenue $r;
  $r > 50000000;
  located_in (organization: $o, city: $city);
  location-contains (parent: $c, child: $city);
  $c isa country, has country_name $name;
select $name;
distinct;
fetch { ""name"": $name };"
companies,614,What are the top 3 latest articles mentioning any organization?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
RETURN a.title AS article, a.date AS published, o.name AS organization
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article, has date $d;
  mentions (article: $a, mentioned: $o);
  $o isa organization;
sort $d desc;
limit 3;
fetch { ""article"": $a.title, ""published"": $d, ""organization"": $o.name };"
companies,618,Which cities have organizations with a public status?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.isPublic IS NOT NULL AND o.isPublic = true
RETURN DISTINCT c.name","match
  $o isa organization, has is_public true;
  located_in (organization: $o, city: $c);
select $c;
distinct;
fetch { ""city_name"": $c.city_name };"
companies,619,Name the children and parents of persons who are CEOs of organizations with more than 50 employees.,"MATCH (p:Person)<-[:HAS_CEO]-(o:Organization) WHERE o.nbrEmployees > 50 OPTIONAL MATCH (p)-[:HAS_CHILD]->(child:Person) OPTIONAL MATCH (p)-[:HAS_PARENT]->(parent:Person) RETURN p.name AS ceo, collect(child.name) AS children, collect(parent.name) AS parents","match
  $p isa person;
  $o isa organization, has nbr_employees $emp;
  $emp > 50;
  ceo_of (organization: $o, ceo: $p);
  try { parent_of (parent: $p, child: $child); $child isa person; };
  try { parent_of (child: $p, parent: $parent); $parent isa person; };
fetch {
  ""ceo"": $p.name,
  ""children"": [ $child.name ],
  ""parents"": [ $parent.name ]
};"
companies,631,Who are the children of people working in organizations in 'Seattle'?,"MATCH (p:Person)-[:HAS_CHILD]->(child:Person) WHERE EXISTS { (p)-[:HAS_BOARD_MEMBER|HAS_CEO]->(:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) } RETURN p.name AS parent, child.name AS child","match
  $p isa person;
  $child isa person;
  parent_of (parent: $p, child: $child);
  $org isa organization;
  $city isa city, has city_name ""Seattle"";
  located_in (organization: $org, city: $city);
  { ceo_of (ceo: $p, organization: $org); } or { board_member_of (member: $p, organization: $org); };
fetch { ""parent"": $p.name, ""child"": $child.name };"
companies,634,What is the sentiment of articles authored by 'David Correa' regarding organizations in the tech industry?,"MATCH (a:Article {author: 'David Correa'})-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory) WHERE c.name CONTAINS 'Tech' RETURN a.title, a.sentiment","match
  $a isa article, has author ""David Correa"", has title $title, has sentiment $sentiment;
  $o isa organization;
  $c isa industry_category, has industry_category_name $cat_name;
  mentions (article: $a, mentioned: $o);
  in_category (organization: $o, category: $c);
  $cat_name like "".*Tech.*"";
fetch { ""title"": $title, ""sentiment"": $sentiment };"
companies,648,Which organizations have more than two categories and are located in 'United States of America'?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory), (o)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country:Country {name: 'United States of America'}) WITH o, count(c) AS categoryCount WHERE categoryCount > 2 RETURN o.name AS organization, categoryCount","match
  $o isa organization;
  $c isa city;
  $country isa country, has country_name ""United States of America"";
  located_in (organization: $o, city: $c);
  location-contains (parent: $country, child: $c);
  $ic isa industry_category;
  in_category (organization: $o, category: $ic);
reduce $categoryCount = count($ic) groupby $o;
match $categoryCount > 2;
fetch { ""organization"": $o.name, ""categoryCount"": $categoryCount };"
companies,652,Which organizations have a summary that includes 'based in San Francisco' and are not dissolved?,MATCH (o:Organization) WHERE o.summary CONTAINS 'based in San Francisco' AND o.isDissolved IS NOT NULL AND NOT o.isDissolved RETURN o,"match
  $o isa organization, has summary $s, has is_dissolved false;
  $s like "".*based in San Francisco.*"";
fetch { ""organization"": $o.name };"
companies,655,What are the top 3 articles mentioning organizations with a public status?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization {isPublic: true})
RETURN a.title AS article, a.date AS publishedDate, o.name AS organization
ORDER BY a.date DESC
LIMIT 3","match
  $a isa article, has title $title, has date $date;
  $o isa organization, has is_public true, has name $org_name;
  mentions (article: $a, mentioned: $o);
sort $date desc;
limit 3;
fetch {
  ""article"": $title,
  ""publishedDate"": $date,
  ""organization"": $org_name
};"
companies,660,Name the top 3 countries where organizations with a revenue of over 100000000 are based.,"MATCH (o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE o.revenue > 100000000 RETURN c.name AS country, count(*) AS orgCount ORDER BY orgCount DESC LIMIT 3","match
$o isa organization, has revenue $rev;
$rev > 100000000;
$city isa city;
$co isa country, has country_name $country_name;
located_in (organization: $o, city: $city);
location-contains (parent: $co, child: $city);
reduce $orgCount = count($o) groupby $co, $country_name;
sort $orgCount desc;
limit 3;
fetch { ""country"": $country_name };"
companies,664,Name the organizations that are public and have a category in 'Electronic Products Manufacturers'.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Electronic Products Manufacturers'})
WHERE o.isPublic = true
RETURN o.name AS organization","match
  $o isa organization, has is_public true, has name $name;
  $c isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
  in_category (organization: $o, category: $c);
fetch { ""organization"": $name };"
companies,666,Identify the articles that mention organizations with a CEO named 'Julie Spellman Sweet' and a revenue over 100000000.,MATCH (article:Article)-[:MENTIONS]->(org:Organization) WHERE org.revenue > 100000000 AND (org)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'}) RETURN article,"match
  $p isa person, has name ""Julie Spellman Sweet"";
  (organization: $o, ceo: $p) isa ceo_of;
  $o has revenue $r; $r > 100000000;
  (article: $a, mentioned: $o) isa mentions;
fetch { ""article"": $a.article_id };"
companies,668,List the organizations that have competitors and a public status.,MATCH (o:Organization) WHERE o.isPublic = true AND EXISTS { (o)-[:HAS_COMPETITOR]->(:Organization) } RETURN o.name AS organization,"match
  $o isa organization, has is_public true;
  competes_with (competitor: $o);
fetch { ""organization"": $o.name };"
companies,670,Name the organizations headquartered in 'Rome' that have a public status.,MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Rome'}) WHERE o.isPublic = true RETURN o.name,"match
  $o isa organization, has is_public true;
  $c isa city, has city_name ""Rome"";
  located_in (organization: $o, city: $c);
fetch { ""name"": $o.name };"
companies,672,What are the summaries of organizations that have a supplier named 'Accenture'?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization {name: 'Accenture'})
RETURN o.summary AS organization_summary","match
  $o isa organization;
  $s isa organization, has name ""Accenture"";
  supplies (customer: $o, supplier: $s);
fetch { ""organization_summary"": $o.summary };"
companies,676,What are the top 3 articles mentioning organizations with more than 200 employees?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE o.nbrEmployees > 200
WITH a, o
ORDER BY a.sentiment DESC
LIMIT 3
RETURN a.title AS article, o.name AS organization","match
  $a isa article;
  $o isa organization, has nbr_employees $e;
  $e > 200;
  mentions (article: $a, mentioned: $o);
  $a has sentiment $s;
sort $s desc;
limit 3;
fetch { ""article"": $a.title, ""organization"": $o.name };"
companies,677,Identify organizations that have both a CEO and an investor named 'Julie Spellman Sweet'.,MATCH (o:Organization) WHERE (o)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'}) AND (o)-[:HAS_INVESTOR]->(:Person {name: 'Julie Spellman Sweet'}) RETURN o,"match
  $p isa person, has name ""Julie Spellman Sweet"";
  $o isa organization;
  ceo_of (organization: $o, ceo: $p);
  invested_in (organization: $o, investor: $p);
fetch { ""organization"": $o.name };"
companies,678,What are the top 5 organizations with the highest revenue?,"MATCH (o:Organization)
WHERE o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization, has revenue $r;
sort $r desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $r };"
companies,681,Name 5 organizations that have been marked as public.,"MATCH (o:Organization)
WHERE o.isPublic = true
RETURN o.name
LIMIT 5","match
$o isa organization, has is_public true;
limit 5;
fetch { ""name"": $o.name };"
companies,682,Which 3 industries are most commonly associated with organizations in Seattle?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Seattle'}) MATCH (o)-[:HAS_CATEGORY]->(c:IndustryCategory) RETURN c.name AS category, count(*) AS num_orgs ORDER BY num_orgs DESC LIMIT 3","match
  $c isa city, has city_name ""Seattle"";
  located_in (organization: $o, city: $c);
  in_category (organization: $o, category: $cat);
reduce $count = count($o) groupby $cat;
sort $count desc;
limit 3;
fetch { ""category"": $cat.industry_category_name, ""num_orgs"": $count };"
companies,693,What are the top 5 cities mentioned in recent articles?,"MATCH (a:Article)-[:HAS_CHUNK]->(c:Chunk), (a)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(city:City)
WHERE a.date >= datetime() - duration('P30D')
RETURN city.name AS city, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 5","match
  $a isa article;
  $o isa organization;
  $city isa city, has city_name $cn;
  (article: $a, mentioned: $o) isa mentions;
  (organization: $o, city: $city) isa located_in;
reduce $mentions = count($a) groupby $city, $cn;
sort $mentions desc;
limit 5;
fetch { ""city"": $cn, ""mentions"": $mentions };"
companies,696,List the 5 most recent articles that mention organizations in the technology sector.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory) WHERE c.name CONTAINS 'Technology' RETURN a.title AS article, a.date AS published ORDER BY a.date DESC LIMIT 5","match
  $a isa article, has date $d;
  $o isa organization;
  $c isa industry_category, has industry_category_name $cn;
  $cn like "".*Technology.*"";
  mentions (article: $a, mentioned: $o);
  in_category (organization: $o, category: $c);
sort $d desc;
limit 5;
fetch { ""article"": $a.title, ""published"": $d };"
companies,703,List the top 3 cities where tech organizations are based.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory) WHERE ic.name CONTAINS 'Technology' RETURN c.name AS city, count(o) AS count ORDER BY count DESC LIMIT 3","match
$c isa city, has city_name $city_name;
$o isa organization;
$ic isa industry_category, has industry_category_name $ic_name;
$ic_name contains ""Technology"";
located_in (organization: $o, city: $c);
in_category (organization: $o, category: $ic);
reduce $count = count($o) groupby $city_name;
sort $count desc;
limit 3;
fetch { ""city"": $city_name, ""count"": $count };"
companies,706,Which 3 organizations have the most negative sentiment in recent articles?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization) WHERE a.sentiment < 0 WITH o, avg(a.sentiment) AS avgSentiment ORDER BY avgSentiment LIMIT 3 RETURN o.name AS organization, avgSentiment","match
  $o isa organization;
  $a isa article, has sentiment $s;
  $s < 0;
  mentions (article: $a, mentioned: $o);
reduce $avg = mean($s) groupby $o;
sort $avg asc;
limit 3;
fetch { ""organization"": $o.name, ""avgSentiment"": $avg };"
companies,707,List the 5 organizations with the most diverse industry categories.,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory) WITH o, count(distinct c) as categoryCount ORDER BY categoryCount DESC LIMIT 5 RETURN o.name as organization, categoryCount","match
$o isa organization;
$c isa industry_category;
in_category (organization: $o, category: $c);
reduce $count = count($c) groupby $o;
sort $count desc;
limit 5;
fetch {
  ""organization"": $o.name,
  ""categoryCount"": $count
};"
companies,712,Which organizations in the city of Chicago have more than 300 employees?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Chicago'}) WHERE o.nbrEmployees > 300 RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees","match
  $o isa organization;
  $o has nbr_employees $emp;
  $emp > 300;
  $c isa city, has city_name ""Chicago"";
  located_in (organization: $o, city: $c);
fetch { ""organization"": $o.name, ""numberOfEmployees"": $emp };"
companies,715,What are the names of the top 5 organizations that have been dissolved?,"MATCH (o:Organization)
WHERE o.isDissolved = true
RETURN o.name
ORDER BY o.revenue DESC
LIMIT 5","match
  $o isa organization, has is_dissolved true, has revenue $r;
sort $r desc;
limit 5;
fetch { ""name"": $o.name };"
companies,721,List the first 3 organizations that have 'Accenture' as a supplier.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(a:Organization {name: 'Accenture'})
RETURN o.name
LIMIT 3","match
  $o isa organization;
  $accenture isa organization, has name ""Accenture"";
  supplies (supplier: $accenture, customer: $o);
limit 3;
fetch { ""name"": $o.name };"
companies,725,"Who are the children of 'Julie Spellman Sweet', list the first 3.",MATCH (p:Person {name: 'Julie Spellman Sweet'})-[:HAS_CHILD]->(child:Person) RETURN child.name LIMIT 3,"match
  $p isa person, has name ""Julie Spellman Sweet"";
  parent_of (parent: $p, child: $child);
limit 3;
fetch { ""name"": $child.name };"
companies,730,List the first 3 organizations with the highest number of employees that are public.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees DESC
LIMIT 3","match
  $o isa organization, has is_public true, has nbr_employees $n;
sort $n desc;
limit 3;
fetch { ""organization"": $o.name, ""numberOfEmployees"": $n };"
companies,731,What are the top 3 cities where the software companies are based?,"MATCH (o:Organization)-[:HAS_CATEGORY]->(c:IndustryCategory {name: 'Software'})-[:IN_CITY]->(city:City) RETURN city.name, count(*) as count ORDER BY count DESC LIMIT 3","match
$o isa organization;
$c isa industry_category, has industry_category_name ""Software"";
in_category (organization: $o, category: $c);
located_in (organization: $o, city: $city);
reduce $count = count($o) groupby $city;
sort $count desc;
limit 3;
fetch { ""city"": $city.city_name, ""count"": $count };"
companies,733,Who are the top 3 suppliers of 'New Energy Group'?,"MATCH (o:Organization {name: 'New Energy Group'})<-[:HAS_SUPPLIER]-(supplier:Organization) RETURN supplier.name AS supplier, supplier.summary AS summary ORDER BY supplier.revenue DESC LIMIT 3","match
  $o isa organization, has name ""New Energy Group"";
  $supplier isa organization, has name $name, has summary $summary, has revenue $rev;
  supplies (supplier: $supplier, customer: $o);
sort $rev desc;
limit 3;
fetch { ""supplier"": $name, ""summary"": $summary };"
companies,738,What are the top 5 organizations that are mentioned the most in articles with a sentiment below 0.5?,"MATCH (a:Article)-[:MENTIONS]->(o:Organization) WHERE a.sentiment < 0.5 WITH o, count(*) as mentions RETURN o.name as organization, mentions ORDER BY mentions DESC LIMIT 5","match
$a isa article, has sentiment $s;
$s < 0.5;
$o isa organization;
mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o;
sort $count desc;
limit 5;
fetch { ""organization"": $o.name, ""mentions"": $count };"
companies,740,List the top 5 organizations that have the most suppliers.,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
RETURN o.name AS organization, count(s) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 5","match
  $o isa organization, has name $on;
  $s isa organization;
  supplies (customer: $o, supplier: $s);
reduce $count = count($s) groupby $o, $on;
sort $count desc;
limit 5;
fetch { ""organization"": $on, ""supplierCount"": $count };"
companies,742,List the first 3 organizations with the lowest revenue that are not dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = false AND o.revenue IS NOT NULL
RETURN o.name, o.revenue
ORDER BY o.revenue
LIMIT 3","match
$o isa organization, has is_dissolved false, has revenue $r;
sort $r asc;
limit 3;
fetch { ""name"": $o.name, ""revenue"": $r };"
companies,745,List the top 5 cities with the most organizations in the 'Healthcare' industry.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Healthcare'}) WITH c, count(o) as orgCount ORDER BY orgCount DESC LIMIT 5 RETURN c.name as city, orgCount as numberOfHealthcareOrgs","match
  $c isa city, has city_name $cn;
  $o isa organization;
  $ic isa industry_category, has industry_category_name ""Healthcare"";
  located_in (organization: $o, city: $c);
  in_category (organization: $o, category: $ic);
reduce $count = count($o) groupby $c, $cn;
sort $count desc;
limit 5;
fetch { ""city"": $cn, ""numberOfHealthcareOrgs"": $count };"
companies,749,List the top 5 organizations that are public and have a revenue less than 10 million.,"MATCH (o:Organization) WHERE o.isPublic = true AND o.revenue < 1E7 RETURN o.name AS organization, o.revenue AS revenue ORDER BY o.revenue DESC LIMIT 5","match
$o isa organization, has is_public true, has revenue $r;
$r < 10000000;
sort $r desc;
limit 5;
fetch { ""organization"": $o.name, ""revenue"": $r };"
companies,751,List the first 3 industries that have the most organizations with a CEO named 'Julie Spellman Sweet'.,"MATCH (i:IndustryCategory)<-[:HAS_CATEGORY]-(o:Organization)-[:HAS_CEO]->(p:Person {name: 'Julie Spellman Sweet'}) RETURN i.name AS industry, count(o) AS orgCount ORDER BY orgCount DESC LIMIT 3","match
$i isa industry_category;
$o isa organization;
$p isa person, has name ""Julie Spellman Sweet"";
(organization: $o, category: $i) isa in_category;
(organization: $o, ceo: $p) isa ceo_of;
reduce $orgCount = count($o) groupby $i;
sort $orgCount desc;
limit 3;
fetch {
  ""industry"": $i.industry_category_name,
  ""orgCount"": $orgCount
};"
companies,755,List the top 5 cities where the electronic products manufacturers are based.,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)-[:HAS_CATEGORY]->(ic:IndustryCategory {name: 'Electronic Products Manufacturers'}) RETURN c.name AS city, count(o) AS company_count ORDER BY company_count DESC LIMIT 5","match
$c isa city;
$o isa organization;
$ic isa industry_category, has industry_category_name ""Electronic Products Manufacturers"";
located_in (organization: $o, city: $c);
in_category (organization: $o, category: $ic);
reduce $company_count = count($o) groupby $c;
sort $company_count desc;
limit 5;
fetch {
  ""city"": $c.city_name
};"
companies,762,Who are the top 3 suppliers of organizations in 'New York City'?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'New York City'})
MATCH (o)<-[:HAS_SUPPLIER]-(supplier:Organization)
RETURN supplier.name, count(*) as supplierCount
ORDER BY supplierCount DESC
LIMIT 3","match
  $o isa organization;
  $city isa city, has city_name ""New York City"";
  $supplier isa organization, has name $sn;
  (organization: $o, city: $city) isa located_in;
  (customer: $o, supplier: $supplier) isa supplies;
reduce $count = count($o) groupby $supplier, $sn;
sort $count desc;
limit 3;
fetch { ""supplier"": $sn, ""supplierCount"": $count };"
companies,766,What are the names of organizations dissolved and were public?,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.isPublic = true
RETURN o.name","match $o isa organization, has is_dissolved true, has is_public true; fetch { ""name"": $o.name };"
companies,775,Which cities host organizations with more than 100 employees?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 100
RETURN DISTINCT c.name AS city","match
$o isa organization, has nbr_employees $e;
$e > 100;
located_in (organization: $o, city: $c);
$c has city_name $name;
select $name;
distinct;
fetch { ""city"": $name };"
companies,791,What is the revenue and employee number for organizations headquartered in Rome?,"MATCH (o:Organization)-[:IN_CITY]->(:City {name: 'Rome'}) WHERE o.revenue IS NOT NULL AND o.nbrEmployees IS NOT NULL RETURN o.name AS organization, o.revenue AS revenue, o.nbrEmployees AS employees","match
$o isa organization, has revenue $r, has nbr_employees $e;
$c isa city, has city_name ""Rome"";
located_in (organization: $o, city: $c);
fetch {
  ""organization"": $o.name,
  ""revenue"": $r,
  ""employees"": $e
};"
companies,801,List the countries that have organizations with a motto.,MATCH (c:Country)<-[:IN_COUNTRY]-(city:City)<-[:IN_CITY]-(o:Organization) WHERE o.motto IS NOT NULL RETURN DISTINCT c.name,"match
  $o isa organization, has motto $m;
  $c isa city;
  $country isa country, has country_name $cn;
  (organization: $o, city: $c) isa located_in;
  (parent: $country, child: $c) isa location-contains;
select $cn;
distinct;
fetch { ""country_name"": $cn };
"
companies,803,Which cities have more than three organizations based in them?,"MATCH (c:City)<-[:IN_CITY]-(o:Organization)
WITH c, count(o) AS orgCount
WHERE orgCount > 3
RETURN c.name AS city, orgCount","match
  $c isa city, has city_name $cn;
  $o isa organization;
  (organization: $o, city: $c) isa located_in;
reduce $org_count = count($o) groupby $c, $cn;
match $org_count > 3;
fetch { ""city"": $cn, ""org_count"": $org_count };"
companies,814,List all articles that mention organizations headquartered in the United States of America.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country {name: 'United States of America'}) RETURN a, o","match
$a isa article;
$o isa organization;
$city isa city;
$country isa country, has country_name ""United States of America"";
mentions (article: $a, mentioned: $o);
located_in (organization: $o, city: $city);
location-contains (parent: $country, child: $city);
fetch {
  ""article"": $a.title,
  ""organization"": $o.name
};"
companies,816,What are the cities where organizations with the highest number of suppliers are located?,"MATCH (o:Organization)-[:HAS_SUPPLIER]->(s:Organization)
WITH o, count(s) AS supplierCount
ORDER BY supplierCount DESC
LIMIT 1
MATCH (o)-[:IN_CITY]->(c:City)
RETURN c.name AS city","match
  $o isa organization;
  $c isa city, has city_name $cn;
  supplies (customer: $o, supplier: $s);
  located_in (organization: $o, city: $c);
reduce $count = count($s) groupby $o, $c, $cn;
sort $count desc;
limit 1;
fetch { ""city"": $cn };"
companies,822,List all organizations that have been mentioned in articles with a negative sentiment.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)
WHERE a.sentiment < 0
RETURN DISTINCT o","match
  $o isa organization;
  $a isa article, has sentiment $s;
  $s < 0;
  mentions (article: $a, mentioned: $o);
select $o;
distinct;
fetch { ""organization"": $o.name };"
companies,829,List articles that mention organizations based in countries not in North America.,"MATCH (a:Article)-[:MENTIONS]->(o:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(c:Country) WHERE c.name <> 'United States of America' AND c.name <> 'Canada' AND c.name <> 'Mexico' RETURN a.title, a.siteName, a.date, o.name, c.name","match
  $a isa article;
  $o isa organization;
  $city isa city;
  $c isa country, has country_name $cn;
  mentions (article: $a, mentioned: $o);
  located_in (organization: $o, city: $city);
  location-contains (parent: $c, child: $city);
  not { $cn == ""United States of America""; };
  not { $cn == ""Canada""; };
  not { $cn == ""Mexico""; };
fetch {
  ""title"": $a.title,
  ""siteName"": $a.site_name,
  ""date"": $a.date,
  ""organization"": $o.name,
  ""country"": $cn
};
"
companies,849,Which organizations have the most articles mentioning them in 2022?,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date.year = 2022
WITH o, count(a) as numMentions
RETURN o.name as organization, numMentions
ORDER BY numMentions DESC
LIMIT 10","match
  $o isa organization;
  $a isa article, has date $d;
  mentions (article: $a, mentioned: $o);
  $d >= 2022-01-01T00:00:00;
  $d < 2023-01-01T00:00:00;
reduce $count = count($a) groupby $o;
sort $count desc;
limit 10;
fetch { ""organization"": $o.name, ""numMentions"": $count };"
companies,853,Find the top 3 cities where organizations with more than 500 employees are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.nbrEmployees > 500
RETURN c.name AS city, count(o) AS numOrganizations
ORDER BY numOrganizations DESC
LIMIT 3","match
  $o isa organization, has nbr_employees $emp;
  $emp > 500;
  $c isa city;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 3;
fetch { ""city"": $c.city_name, ""numOrganizations"": $count };"
companies,858,What are the names of the people who have both a parent and a child listed in the schema?,"MATCH (p:Person)-[:HAS_PARENT]->(parent:Person)
WHERE EXISTS {(p)-[:HAS_CHILD]->(:Person)}
RETURN p.name","match
  $p isa person;
  parent_of (parent: $parent, child: $p);
  parent_of (parent: $p, child: $child);
fetch { ""name"": $p.name };"
companies,862,What are the names of the organizations that are headquartered in cities with a summary stating they are a county seat?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o.name","match
  $o isa organization;
  $c isa city, has city_summary $summary;
  $summary like "".*county seat.*"";
  located_in (organization: $o, city: $c);
fetch { ""name"": $o.name };"
companies,864,Which organizations have a board member who is also a CEO of another organization?,"MATCH (o1:Organization)-[:HAS_BOARD_MEMBER]->(p:Person)<-[:HAS_CEO]-(o2:Organization)
WHERE o1 <> o2
RETURN o1.name AS BoardMemberOrg, p.name AS Person, o2.name AS CEOOrg","match
  $o1 isa organization;
  $p isa person;
  $o2 isa organization;
  board_member_of (organization: $o1, member: $p);
  ceo_of (organization: $o2, ceo: $p);
  not { $o1 is $o2; };
fetch {
  ""BoardMemberOrg"": $o1.name,
  ""Person"": $p.name,
  ""CEOOrg"": $o2.name
};"
companies,865,List the first 3 organizations with the highest revenue that are also dissolved.,"MATCH (o:Organization)
WHERE o.isDissolved = true AND o.revenue IS NOT NULL
RETURN o.name AS organization, o.revenue AS revenue
ORDER BY o.revenue DESC
LIMIT 3","match
$o isa organization, has is_dissolved true, has revenue $r, has name $n;
sort $r desc;
limit 3;
fetch { ""organization"": $n, ""revenue"": $r };"
companies,867,Identify the top 3 cities where organizations with a revenue less than 10 million are located.,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE o.revenue < 10000000
RETURN c.name AS city, count(o) AS orgCount
ORDER BY orgCount DESC
LIMIT 3","match
  $o isa organization, has revenue $r;
  $r < 10000000;
  $c isa city;
  located_in (organization: $o, city: $c);
reduce $count = count($o) groupby $c;
sort $count desc;
limit 3;
fetch { ""city"": $c.city_name, ""count"": $count };"
companies,868,List the first 5 organizations that have a motto including the word 'security'.,"MATCH (o:Organization)
WHERE o.motto CONTAINS 'security'
RETURN o.name, o.motto
LIMIT 5","match
$o isa organization, has motto $m;
$m like "".*security.*"";
limit 5;
fetch {
  ""name"": $o.name,
  ""motto"": $m
};"
companies,873,Which organizations have a summary mentioning 'software' and are public companies?,"MATCH (o:Organization)
WHERE o.summary CONTAINS 'software' AND o.isPublic = true
RETURN o","match
  $o isa organization, has summary $s, has is_public true;
  $s like "".*software.*"";
fetch {
  ""organization"": $o
};"
companies,877,Find the top 3 countries mentioned in articles that have the lowest sentiment scores.,"MATCH (article:Article)-[:HAS_CHUNK]->(chunk:Chunk)
WHERE article.sentiment IS NOT NULL
WITH article
ORDER BY article.sentiment ASC
LIMIT 3
MATCH (article)-[:MENTIONS]->(:Organization)-[:IN_CITY]->(:City)-[:IN_COUNTRY]->(country:Country)
RETURN country.name AS country, count(*) AS mentions
ORDER BY mentions DESC","match
  $article isa article, has sentiment $s;
  $o isa organization;
  $city isa city;
  $country isa country;
  mentions (article: $article, mentioned: $o);
  located_in (organization: $o, city: $city);
  location-contains (parent: $country, child: $city);
select $article, $s;
distinct;
sort $s asc;
limit 3;
match
  $country2 isa country;
  mentions (article: $article, mentioned: $o2);
  located_in (organization: $o2, city: $city2);
  location-contains (parent: $country2, child: $city2);
reduce $count = count groupby $country2;
sort $count desc;
limit 3;
fetch { ""country"": $country2.country_name, ""mentions"": $count };"
companies,879,Which organizations have a city with a summary mentioning 'county seat' as their location?,"MATCH (o:Organization)-[:IN_CITY]->(c:City)
WHERE c.summary CONTAINS 'county seat'
RETURN o.name AS organization, c.name AS city","match
  $o isa organization;
  $c isa city, has city_summary $summary;
  $summary like "".*county seat.*"";
  located_in (organization: $o, city: $c);
fetch {
  ""organization"": $o.name,
  ""city"": $c.city_name
};
"
companies,880,Identify the top 3 organizations with the smallest number of employees that are public.,"MATCH (o:Organization)
WHERE o.isPublic = true AND o.nbrEmployees IS NOT NULL
RETURN o.name AS organization, o.nbrEmployees AS numberOfEmployees
ORDER BY o.nbrEmployees
LIMIT 3","match
  $o isa organization,
    has is_public true,
    has nbr_employees $employees;
sort $employees asc;
limit 3;
fetch {
  ""organization"": $o.name,
  ""numberOfEmployees"": $employees
};
"
companies,891,Identify the top 3 organizations with the most articles mentioning them.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
RETURN o.name AS organization, count(a) AS mentionCount
ORDER BY mentionCount DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $a isa article;
  mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o, $on;
sort $count desc;
limit 3;
fetch { ""organization"": $on, ""mentionCount"": $count };"
companies,895,List the first 5 organizations that have a CEO who is also a board member of a competitor.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)
WHERE EXISTS {
  (o)-[:HAS_COMPETITOR]->(competitor:Organization)<-[:HAS_BOARD_MEMBER]-(ceo)
}
RETURN o.name AS organization, ceo.name AS ceo
LIMIT 5","match
  $o isa organization;
  $ceo isa person;
  $competitor isa organization;
  ceo_of (organization: $o, ceo: $ceo);
  competes_with (competitor: $o, competitor: $competitor);
  board_member_of (organization: $competitor, member: $ceo);
limit 5;
fetch { ""organization"": $o.name, ""ceo"": $ceo.name };"
companies,897,Identify the top 3 organizations with the most board members.,"MATCH (o:Organization)<-[:HAS_BOARD_MEMBER]-(p:Person)
WITH o, count(p) AS boardMemberCount
ORDER BY boardMemberCount DESC
LIMIT 3
RETURN o.name AS organization, boardMemberCount","match
  $o isa organization, has name $on;
  board_member_of (organization: $o, member: $p);
reduce $count = count($p) groupby $o, $on;
sort $count desc;
limit 3;
fetch { ""organization"": $on, ""board_member_count"": $count };"
companies,904,Find the top 3 countries with the most cities mentioned in the schema.,"MATCH (country:Country)<-[:IN_COUNTRY]-(city:City)
RETURN country.name AS country, count(city) AS numCities
ORDER BY numCities DESC
LIMIT 3","match
  $country isa country;
  $city isa city;
  location-contains (parent: $country, child: $city);
reduce $num_cities = count($city) groupby $country;
sort $num_cities desc;
limit 3;
fetch { ""country"": $country.country_name, ""num_cities"": $num_cities };"
companies,906,What are the names of the organizations that are competitors and have a CEO named 'Julie Spellman Sweet'?,"MATCH (o1:Organization)-[:HAS_COMPETITOR]->(o2:Organization)
WHERE (o1)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'})
   OR (o2)-[:HAS_CEO]->(:Person {name: 'Julie Spellman Sweet'})
RETURN o1.name AS org1, o2.name AS org2","match
  $p isa person, has name ""Julie Spellman Sweet"";
  competes_with (competitor: $o1, competitor: $o2);
  { ceo_of (organization: $o1, ceo: $p); } or { ceo_of (organization: $o2, ceo: $p); };
fetch { ""org1"": $o1.name, ""org2"": $o2.name };"
companies,916,Identify the top 3 organizations with a CEO who has authored an article.,"MATCH (o:Organization)-[:HAS_CEO]->(ceo:Person)<-[:AUTHOR]-(a:Article)
RETURN o.name AS organization, ceo.name AS ceo, count(a) AS articleCount
ORDER BY articleCount DESC
LIMIT 3","match
  $o isa organization;
  $p isa person, has name $ceo_name;
  ceo_of (organization: $o, ceo: $p);
  $a isa article, has author $author_name;
  $ceo_name == $author_name;
reduce $articleCount = count($a) groupby $o, $p;
sort $articleCount desc;
limit 3;
fetch { ""organization"": $o.name, ""ceo"": $p.name, ""articleCount"": $articleCount };"
companies,918,What are the names of the organizations that have a CEO with a name mentioned in an article with a sentiment score greater than 0.8?,"MATCH (article:Article)-[:HAS_CHUNK]->(chunk:Chunk),
      (article)-[:MENTIONS]->(org:Organization),
      (org)-[:HAS_CEO]->(ceo:Person)
WHERE article.sentiment > 0.8 AND ceo.name IS NOT NULL
RETURN DISTINCT org.name","match
  $a isa article, has sentiment $s;
  $s > 0.8;
  $o isa organization, has name $on;
  $p isa person, has name $pn;
  mentions (article: $a, mentioned: $o);
  ceo_of (organization: $o, ceo: $p);
select $on;
distinct;
fetch { ""organization"": $on };"
companies,919,Find the top 3 organizations that have the most board members who are also CEOs of other organizations.,"MATCH (o:Organization)<-[:HAS_BOARD_MEMBER]-(p:Person)
WHERE EXISTS {(p)-[:HAS_CEO]->(:Organization)}
WITH o, count(p) AS ceo_board_members
RETURN o.name AS organization, ceo_board_members
ORDER BY ceo_board_members DESC
LIMIT 3","match
  $o isa organization, has name $on;
  $p isa person;
  $other isa organization;
  board_member_of (organization: $o, member: $p);
  ceo_of (organization: $other, ceo: $p);
  $o has organization_id $oid;
  $other has organization_id $otherid;
  $oid != $otherid;
reduce $count = count($p) groupby $o, $on;
sort $count desc;
limit 3;
fetch { ""organization"": $on, ""ceo_board_members"": $count };"
companies,931,Identify the top 3 organizations with the most subsidiaries headquartered in a city named 'Seattle'.,"MATCH (o:Organization)-[:HAS_SUBSIDIARY*]->(sub:Organization)-[:IN_CITY]->(c:City {name: 'Seattle'})
WITH o, count(sub) AS numSubs
ORDER BY numSubs DESC
LIMIT 3
RETURN o.name AS organization, numSubs AS numberOfSubsidiaries","match
  $o isa organization, has name $on;
  $sub isa organization;
  $c isa city, has city_name ""Seattle"";
  subsidiary_of (parent: $o, subsidiary: $sub);
  located_in (organization: $sub, city: $c);
reduce $count = count($sub) groupby $o, $on;
sort $count desc;
limit 3;
fetch { ""organization"": $on, ""numberOfSubsidiaries"": $count };"
companies,292,List the top 3 organizations by the number of articles mentioning them in 2021.,"MATCH (o:Organization)<-[:MENTIONS]-(a:Article)
WHERE a.date >= date(""2021-01-01"") AND a.date <= date(""2021-12-31"") 
WITH o, count(a) as mentionCount
ORDER BY mentionCount DESC
LIMIT 3
RETURN o.name as organization, mentionCount","match
$o isa organization, has name $org_name;
$a isa article, has date $d;
$d >= 2021-01-01T00:00:00;
$d <= 2021-12-31T23:59:59;
mentions (article: $a, mentioned: $o);
reduce $count = count($a) groupby $o, $org_name;
sort $count desc;
limit 3;
fetch {
  ""organization"": $org_name,
  ""mention_count"": $count
};"
companies,305,Which 3 cities are mentioned most frequently in articles?,"MATCH (a:Article)-[:HAS_CHUNK]->(:Chunk)-[:MENTIONS]->(c:City)
RETURN c.name AS city, count(*) AS mentions
ORDER BY mentions DESC
LIMIT 3","match
$a isa article;
$c isa city, has city_name $cn;
mentions (article: $a, mentioned: $c);
reduce $count = count($a) groupby $c, $cn;
sort $count desc;
limit 3;
fetch {
  ""city"": $cn,
  ""mentions"": $count
};"
gameofthrones,0,Which characters have a book1BetweennessCentrality greater than 2000?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 2000
RETURN c.name AS character, c.book1BetweennessCentrality AS centrality","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality > 2000;
fetch { ""character"": $c.name, ""centrality"": $c.book1_betweenness_centrality };"
gameofthrones,1,List the top 3 characters with the highest book45PageRank.,"MATCH (c:Character)
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
sort $c_book45_page_rank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,2,Find all characters with a centrality of 0 and limit the results to 5.,"MATCH (c:Character)
WHERE c.centrality = 0
RETURN c
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,3,Who are the top 5 characters by degree in the database?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,4,Retrieve the names of 3 characters who have a louvain community number of 1.,"MATCH (c:Character)
WHERE c.louvain = 1
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 1;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,5,Which characters are part of a community number greater than 750?,"MATCH (c:Character)
WHERE c.community > 750
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community > 750;
fetch { ""c_name"": $c.name };"
gameofthrones,6,List three characters with a pagerank less than 1.,"MATCH (c:Character)
WHERE c.pagerank < 1
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 1;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,8,What are the names of the characters that have an INTERACTS45 relationship with a weight greater than 50?,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
WHERE i.weight > 50
RETURN c1.name, c2.name","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight > 50;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,9,Fetch the top 5 characters based on the book1PageRank.,"MATCH (c:Character)
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
sort $c_book1_page_rank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,10,"Find all characters involved in an INTERACTS relationship with a weight below 10, limit to 5 results.","MATCH (c1:Character)-[i:INTERACTS]->(c2:Character)
WHERE i.weight < 10
RETURN c1.name, i.weight, c2.name
LIMIT 5","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight < 10;
limit 5;
fetch { ""c1_name"": $c1.name, ""weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,11,Who are the characters with a community number between 600 and 700?,"MATCH (c:Character)
WHERE c.community >= 600 AND c.community <= 700
RETURN c.name AS character","match
  $c isa character;
  $c has community $c_community;
  $c_community >= 600;
  $c_community <= 700;
fetch { ""character"": $c.name };"
gameofthrones,12,Retrieve the first 3 characters who interact in book 1 with a weight of exactly 291.,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight = 291
RETURN c1.name, c2.name
LIMIT 3","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight == 291;
limit 3;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,13,List the characters with an INTERACTS2 relationship of weight less than 20.,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
WHERE r.weight < 20
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has weight $rel_weight;
  $rel_weight < 20;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,14,Who are the characters connected by an INTERACTS3 relationship with a weight above 80?,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.weight > 80
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight > 80;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,15,Find characters who have a book45PageRank less than 0.7 and limit the results to three.,"MATCH (c:Character)
WHERE c.book45PageRank < 0.7
RETURN c
LIMIT 3","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank < 0.7;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,17,List the names of three characters who have a book1BetweennessCentrality of 0.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 0
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality == 0;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,18,Retrieve the names of the characters who have a louvain community number of 6.,"MATCH (c:Character)
WHERE c.louvain = 6
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 6;
fetch { ""c_name"": $c.name };"
gameofthrones,19,Find three characters whose degree is exactly 0.,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 0;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,20,Identify the characters with an INTERACTS relationship with a weight over 300.,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight > 300
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight > 300;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,21,What are the top 5 characters by centrality in the database?,"MATCH (c:Character)
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,22,List three characters with the highest pagerank in the database.,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,23,"Find characters involved in an INTERACTS1 relationship with a weight of 150, limit to 3 results.","MATCH (c1:Character)-[i:INTERACTS1 {weight: 150}]-(c2:Character)
RETURN c1.name, c2.name
LIMIT 3","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight == 150;
limit 3;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,24,Retrieve characters with a book1PageRank greater than 5 and limit to 5 results.,"MATCH (c:Character)
WHERE c.book1PageRank > 5
RETURN c
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank > 5;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,25,Who are the characters with a community number less than 580?,"MATCH (c:Character)
WHERE c.community < 580
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community < 580;
fetch { ""c_name"": $c.name };"
gameofthrones,26,List three characters whose degree is greater than 100.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 100;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,27,Find characters with a pagerank between 2 and 3.,"MATCH (c:Character)
WHERE c.pagerank >= 2 AND c.pagerank <= 3
RETURN c","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank >= 2;
  $c_pagerank <= 3;
fetch { ""c_name"": $c.name };"
gameofthrones,28,Who are three characters with a centrality exactly 0.8333333333333334?,"MATCH (c:Character)
WHERE c.centrality = 0.8333333333333334
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0.8333333333333334;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,29,Which characters have a 'book1PageRank' higher than 1? List the first 5.,"MATCH (c:Character)
WHERE c.book1PageRank > 1
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank > 1;
sort $c_book1_page_rank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,30,Find all characters with a 'centrality' exactly at 0.5.,"MATCH (c:Character)
WHERE c.centrality = 0.5
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0.5;
fetch { ""c_name"": $c.name };"
gameofthrones,31,Who are the top 3 characters by 'degree' in the graph?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,32,List all characters who have a 'book45PageRank' less than 1.,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c.name","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank < 1;
fetch { ""c_name"": $c.name };"
gameofthrones,33,Which characters are part of community 579? Provide top 5 results.,"MATCH (c:Character)
WHERE c.community = 579
RETURN c.name
LIMIT 5","match
  $c isa character;
  $c has community $c_community;
  $c_community == 579;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,34,Identify characters with a 'louvain' value of 1 and show the first 5.,"MATCH (c:Character {louvain: 1})
RETURN c.name
LIMIT 5","match
  $c isa character, has louvain 1;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,35,What are the names of characters who interact with 'Theon-Greyjoy' in any book? List up to 5.,"MATCH (c:Character)-[:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(:Character {name: 'Theon-Greyjoy'})
RETURN c.name
LIMIT 5","match
  $c isa character, has name $n;
  $t isa character, has name ""Theon-Greyjoy"";
  {(character1: $c, character2: $t) isa interacts;} or
  {(character1: $c, character2: $t) isa interacts1;} or
  {(character1: $c, character2: $t) isa interacts2;} or
  {(character1: $c, character2: $t) isa interacts3;} or
  {(character1: $c, character2: $t) isa interacts45;};
limit 5;
fetch { ""name"": $n };"
gameofthrones,36,Who has the highest 'pagerank' among all characters? Show top 3.,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,37,Find characters that have 'book1BetweennessCentrality' greater than 100.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 100
RETURN c","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality > 100;
fetch { ""c_name"": $c.name };"
gameofthrones,38,List the characters who have a 'degree' of zero.,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,39,Who are the top 5 characters by 'book1PageRank' in descending order?,"MATCH (c:Character)
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
sort $c_book1_page_rank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,40,Which characters have an 'INTERACTS45' relationship with a weight above 50?,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
WHERE i.weight > 50
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight > 50;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,41,Display characters with a 'community' of 642 and list top 3.,"MATCH (c:Character)
WHERE c.community = 642
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 642;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,42,Find all characters that have interacted in 'book 2'.,"MATCH (c1:Character)-[:INTERACTS2]->(c2:Character)
RETURN c1, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,43,Who interacted with 'Aegon-Frey-(son-of-Stevron)'? List first 3 characters.,"MATCH (c:Character)-[:INTERACTS]->(a:Character {name: 'Aegon-Frey-(son-of-Stevron)'})
RETURN c.name
LIMIT 3","match
  $c isa character, has name $cn;
  $target isa character, has name ""Aegon-Frey-(son-of-Stevron)"";
  (character1: $c, character2: $target) isa interacts;
limit 3;
fetch { ""c_name"": $cn };"
gameofthrones,44,Which characters from community 795 have 'pagerank' above 0.15?,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank > 0.15
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 795;
  $c_pagerank > 0.15;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,45,Identify the top 5 characters by 'book45PageRank' who are in the same community as 'Murenmure'.,"MATCH (c:Character)
WHERE c.name = 'Murenmure'
WITH c.community AS community
MATCH (other:Character)
WHERE other.community = community
RETURN other.name, other.book45PageRank
ORDER BY other.book45PageRank DESC
LIMIT 5","match
  $m isa character, has name ""Murenmure"", has community $comm;
  $c isa character, has community $comm, has name $n, has book45_page_rank $pr;
sort $pr desc;
limit 5;
fetch { ""name"": $n, ""book45_page_rank"": $pr };"
gameofthrones,46,Who are the top 3 characters in terms of 'pagerank' who also have a 'louvain' value of 6?,"MATCH (c:Character)
WHERE c.louvain = 6
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 6;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,47,List characters that have interacted in 'book 3' with a relationship weight less than 10.,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.weight < 10
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight < 10;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,48,Which characters have a 'book1BetweennessCentrality' of exactly 0 and are part of community 642?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 0 AND c.community = 642
RETURN c","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c has community $c_community;
  $c_book1_betweenness_centrality == 0;
  $c_community == 642;
fetch { ""c_name"": $c.name };"
gameofthrones,49,Find the characters who have interacted with 'Roose-Bolton' in 'book 1'. List the top 5.,"MATCH (c:Character)-[i:INTERACTS1]->(roose:Character {name: 'Roose-Bolton'})
RETURN c.name AS character, i.weight AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $target isa character, has name ""Roose-Bolton"";
  $rel isa interacts1 (character1: $c, character2: $target), has weight $w;
sort $w desc;
limit 5;
fetch { ""character"": $cn, ""interactions"": $w };"
gameofthrones,50,Who are the characters in the louvain community 5 with a 'book45PageRank' greater than 5?,"MATCH (c:Character)
WHERE c.louvain = 5 AND c.book45PageRank > 5
RETURN c.name AS character","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has book45_page_rank $c_book45_page_rank;
  $c_louvain == 5;
  $c_book45_page_rank > 5;
fetch { ""character"": $c.name };"
gameofthrones,51,List the top 3 characters by 'degree' who also have a 'book1PageRank' higher than 0.5.,"MATCH (c:Character)
WHERE c.book1PageRank > 0.5
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank > 0.5;
sort $c_degree desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,54,Which characters interacted in 'book 45' with a weight of exactly 96?,"MATCH (c1:Character)-[i:INTERACTS45 {weight: 96}]->(c2:Character)
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight == 96;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,55,List the top 5 characters by 'centrality' who have a 'book45PageRank' above 1.,"MATCH (c:Character)
WHERE c.book45PageRank > 1
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c has centrality $c_centrality;
  $c_book45_page_rank > 1;
sort $c_centrality desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,56,Find all characters that have 'INTERACTS3' relationship with a weight above 90.,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.weight > 90
RETURN c1, i, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight > 90;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,57,Who are the top 3 characters with the highest 'book1BetweennessCentrality' in community 795?,"MATCH (c:Character)
WHERE c.community = 795
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 795;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,58,Identify characters with a 'degree' over 100. List the first 5.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c.name
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 100;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,59,Which characters have interacted in 'book 1' with a weight less than 5?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight < 5
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight < 5;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,60,Who are the characters with a 'louvain' value of 10? Provide first 3 names.,"MATCH (c:Character {louvain: 10})
RETURN c.name
LIMIT 3","match
  $c isa character, has louvain 10;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,61,List the characters who have a 'book45PageRank' over 10.,"MATCH (c:Character)
WHERE c.book45PageRank > 10
RETURN c.name","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank > 10;
fetch { ""c_name"": $c.name };"
gameofthrones,62,Which characters have a 'community' number higher than 700 and a 'pagerank' above 1? List top 3.,"MATCH (c:Character)
WHERE c.community > 700 AND c.pagerank > 1
RETURN c.name, c.community, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community > 700;
  $c_pagerank > 1;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_community"": $c.community, ""c_pagerank"": $c.pagerank };"
gameofthrones,64,Who has the highest 'book1BetweennessCentrality' among all characters? Show top 3.,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,65,Find characters that have 'INTERACTS1' relationship with a weight above 200.,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight > 200
RETURN c1, i, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 200;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,66,Display characters with a 'community' of 504 and list top 3.,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 504;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,67,Find all characters that have interacted in 'book 2' and have a 'louvain' value greater than 5.,"MATCH (c1:Character)-[:INTERACTS2]-(c2:Character)
WHERE c1.louvain > 5 AND c2.louvain > 5
RETURN c1, c2","match
  $c1 isa character;
  $c2 isa character;
  $c1 has louvain $c1_louvain;
  $c2 has louvain $c2_louvain;
  (character1: $c1, character2: $c2) isa interacts2;
  $c1_louvain > 5;
  $c2_louvain > 5;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,69,Which characters from community 642 have 'pagerank' above 1?,"MATCH (c:Character)
WHERE c.community = 642 AND c.pagerank > 1
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 642;
  $c_pagerank > 1;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,70,Who are the top 3 characters in terms of 'pagerank' who also have a 'louvain' value of 1?,"MATCH (c:Character)
WHERE c.louvain = 1
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 1;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,71,List characters that have interacted in 'book 3' with a relationship weight of exactly 95.,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.weight = 95
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight == 95;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,72,Which characters have a 'book1BetweennessCentrality' of exactly 168.75234023581112 and are part of community 642?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 168.75234023581112 AND c.community = 642
RETURN c.name AS character","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c has community $c_community;
  $c_book1_betweenness_centrality == 168.75234023581112;
  $c_community == 642;
fetch { ""character"": $c.name };"
gameofthrones,74,Who are the characters in the louvain community 6 with a 'book45PageRank' greater than 3?,"MATCH (c:Character)
WHERE c.louvain = 6 AND c.book45PageRank > 3
RETURN c.name AS character","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has book45_page_rank $c_book45_page_rank;
  $c_louvain == 6;
  $c_book45_page_rank > 3;
fetch { ""character"": $c.name };"
gameofthrones,75,List the top 3 characters by 'degree' who also have a 'book1PageRank' higher than 1.,"MATCH (c:Character)
WHERE c.book1PageRank > 1
RETURN c.name, c.degree, c.book1PageRank
ORDER BY c.degree DESC
LIMIT 3","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank > 1;
sort $c_degree desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,78,Which characters interacted in 'book 45' with a weight of exactly 50?,"MATCH (c1:Character)-[i:INTERACTS45 {weight: 50}]->(c2:Character)
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight == 50;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,79,List the top 5 characters by 'centrality' who have a 'book45PageRank' above 2.,"MATCH (c:Character)
WHERE c.book45PageRank > 2
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c has centrality $c_centrality;
  $c_book45_page_rank > 2;
sort $c_centrality desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,80,Find all characters that have 'INTERACTS2' relationship with a weight above 50.,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
WHERE r.weight > 50
RETURN c1, r, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has weight $rel_weight;
  $rel_weight > 50;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,81,Who are the top 3 characters with the highest 'book1BetweennessCentrality' in community 504?,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 504;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,82,Identify characters with a 'degree' over 150. List the first 5.,"MATCH (c:Character)
WHERE c.degree > 150
RETURN c.name
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 150;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,83,Which characters have interacted in 'book 1' with a weight less than 10?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight < 10
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight < 10;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,84,Who are the characters with a 'louvain' value of 0? Provide first 3 names.,"MATCH (c:Character {louvain: 0})
RETURN c.name
LIMIT 3","match
  $c isa character, has louvain 0;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,85,List the characters who have a 'book45PageRank' over 11.,"MATCH (c:Character)
WHERE c.book45PageRank > 11
RETURN c.name","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank > 11;
fetch { ""c_name"": $c.name };"
gameofthrones,86,Which characters have a 'community' number higher than 600 and a 'pagerank' above 0.5? List top 3.,"MATCH (c:Character)
WHERE c.community > 600 AND c.pagerank > 0.5
RETURN c.name, c.community, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community > 600;
  $c_pagerank > 0.5;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_community"": $c.community, ""c_pagerank"": $c.pagerank };"
gameofthrones,88,Who has the highest 'book1PageRank' among all characters? Show top 3.,"MATCH (c:Character)
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 3","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
sort $c_book1_page_rank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,89,Find characters that have 'INTERACTS1' relationship with a weight above 250.,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight > 250
RETURN c1, i, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 250;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,90,Display characters with a 'community' of 735 and list top 3.,"MATCH (c:Character)
WHERE c.community = 735
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 735;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,91,Find all characters that have interacted in 'book 2' and have a 'louvain' value greater than 3.,"MATCH (c1:Character)-[:INTERACTS2]-(c2:Character)
WHERE c1.louvain > 3 AND c2.louvain > 3
RETURN c1, c2","match
  $c1 isa character;
  $c2 isa character;
  $c1 has louvain $c1_louvain;
  $c2 has louvain $c2_louvain;
  (character1: $c1, character2: $c2) isa interacts2;
  $c1_louvain > 3;
  $c2_louvain > 3;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,93,Which characters from community 795 have 'pagerank' above 0.2?,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank > 0.2
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 795;
  $c_pagerank > 0.2;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,94,Which characters have a book1PageRank greater than 5?,"MATCH (c:Character)
WHERE c.book1PageRank > 5
RETURN c.name, c.book1PageRank","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank > 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,95,List all characters with a degree greater than 100.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 100;
fetch { ""c_name"": $c.name };"
gameofthrones,96,What are the names of characters who have a centrality of 1.0?,"MATCH (c:Character)
WHERE c.centrality = 1.0
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 1.0;
fetch { ""c_name"": $c.name };"
gameofthrones,97,Identify characters who belong to community 579.,"MATCH (c:Character)
WHERE c.community = 579
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c_community == 579;
fetch { ""c_name"": $c.name };"
gameofthrones,98,Who are the top 5 characters with the highest pagerank?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,99,Which characters have a book45PageRank less than 1?,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c.name AS character","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank < 1;
fetch { ""character"": $c.name };"
gameofthrones,100,List characters with a louvain community value of 6.,"MATCH (c:Character)
WHERE c.louvain = 6
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 6;
fetch { ""c_name"": $c.name };"
gameofthrones,101,Who are the top 3 characters based on their book1BetweennessCentrality?,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,102,Which characters interact in book 1 with a weight greater than 50?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight > 50
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 50;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,103,Who are characters that interact in book 45 with a weight of exactly 96?,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
WHERE i.weight = 96
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight == 96;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,105,What are the names of characters with a degree of zero?,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,106,List characters whose louvain community index is less than 5.,"MATCH (c:Character)
WHERE c.louvain < 5
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain < 5;
fetch { ""c_name"": $c.name };"
gameofthrones,107,Which characters have a community number between 600 and 700?,"MATCH (c:Character)
WHERE c.community >= 600 AND c.community <= 700
RETURN c.name AS character","match
  $c isa character;
  $c has community $c_community;
  $c_community >= 600;
  $c_community <= 700;
fetch { ""character"": $c.name };"
gameofthrones,108,Identify the top 3 characters by degree in the graph.,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,109,Which characters have an INTERACTS relationship with a weight under 10?,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight < 10
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight < 10;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,110,What are the top 5 characters by book1PageRank in descending order?,"MATCH (c:Character)
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
sort $c_book1_page_rank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,111,List all characters with a book45PageRank above 8.,"MATCH (c:Character)
WHERE c.book45PageRank > 8
RETURN c.name, c.book45PageRank","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank > 8;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,112,Who has the highest centrality score in the graph?,"MATCH (c:Character)
RETURN c.name AS character, c.centrality AS centrality
ORDER BY centrality DESC
LIMIT 1","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 1;
fetch { ""character"": $c.name, ""centrality"": $c.centrality };"
gameofthrones,113,List the characters who interact in book 3 with a weight over 50.,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.weight > 50
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight > 50;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,114,Which characters are in the same community as Daenerys Targaryen?,"MATCH (d:Character {name: 'Daenerys Targaryen'})-[:INTERACTS*0..]->(c:Character)
WHERE d.community = c.community
RETURN c.name","match
  $d isa character, has name ""Daenerys-Targaryen"", has community $comm;
  $c isa character, has community $comm, has name $n;
fetch { ""name"": $n };"
gameofthrones,115,Who are the top 5 characters with the lowest book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name AS character, c.book1BetweennessCentrality AS centrality
ORDER BY centrality
LIMIT 5","match
  $c isa character, has name $n, has book1_betweenness_centrality $bc;
sort $bc asc;
limit 5;
fetch { ""character"": $n, ""centrality"": $bc };"
gameofthrones,116,Identify characters with a pagerank higher than 4.,"MATCH (c:Character)
WHERE c.pagerank > 4
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank > 4;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,117,List all characters with a louvain value of 10.,"MATCH (c:Character)
WHERE c.louvain = 10
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 10;
fetch { ""c_name"": $c.name };"
gameofthrones,118,Which characters have an INTERACTS1 relationship with a weight less than 100?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight < 100
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight < 100;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,119,Who are the characters with a degree greater than 50 and less than 150?,"MATCH (c:Character)
WHERE c.degree > 50 AND c.degree < 150
RETURN c.name AS character","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 50;
  $c_degree < 150;
fetch { ""character"": $c.name };"
gameofthrones,120,List the characters whose name starts with 'A'.,"MATCH (c:Character)
WHERE c.name STARTS WITH 'A'
RETURN c.name","match
  $c isa character, has name $n;
  $n like ""^A.*"";
fetch { ""name"": $n };"
gameofthrones,121,Which characters have a community number exactly 795?,"MATCH (c:Character)
WHERE c.community = 795
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c_community == 795;
fetch { ""c_name"": $c.name };"
gameofthrones,123,Who are the characters with the lowest book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank
LIMIT 5","match
  $c isa character, has name $n, has book45_page_rank $pr;
sort $pr asc;
limit 5;
fetch { ""name"": $n, ""book45_page_rank"": $pr };"
gameofthrones,124,List the characters with an INTERACTS2 relationship and a weight of 92.,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
WHERE r.weight = 92
RETURN c1.name, c2.name","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has weight $rel_weight;
  $rel_weight == 92;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,125,Which characters have a book1PageRank exactly 0.15000000000000002?,"MATCH (c:Character)
WHERE c.book1PageRank = 0.15000000000000002
RETURN c.name","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank == 0.15000000000000002;
fetch { ""c_name"": $c.name };"
gameofthrones,126,Identify characters with a centrality less than 0.5.,"MATCH (c:Character)
WHERE c.centrality < 0.5
RETURN c.name AS character","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality < 0.5;
fetch { ""character"": $c.name };"
gameofthrones,127,List characters in community 504.,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community == 504;
fetch { ""c_name"": $c.name };"
gameofthrones,128,Which characters have an INTERACTS3 relationship with a weight over 90?,"MATCH (c1:Character)-[r:INTERACTS3]->(c2:Character)
WHERE r.weight > 90
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight > 90;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,129,Who are the characters with a book45PageRank between 2 and 5?,"MATCH (c:Character)
WHERE c.book45PageRank >= 2 AND c.book45PageRank <= 5
RETURN c.name AS character","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank >= 2;
  $c_book45_page_rank <= 5;
fetch { ""character"": $c.name };"
gameofthrones,131,Who are the characters with a book1PageRank and a book45PageRank over 3?,"MATCH (c:Character)
WHERE c.book1PageRank > 3 AND c.book45PageRank > 3
RETURN c.name AS character","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book1_page_rank > 3;
  $c_book45_page_rank > 3;
fetch { ""character"": $c.name };"
gameofthrones,132,Identify characters whose pagerank is exactly 0.15000000000000002.,"MATCH (c:Character)
WHERE c.pagerank = 0.15000000000000002
RETURN c","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank == 0.15000000000000002;
fetch { ""c_name"": $c.name };"
gameofthrones,133,List all characters with a degree less than 5 but greater than 0.,"MATCH (c:Character)
WHERE c.degree < 5 AND c.degree > 0
RETURN c","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree < 5;
  $c_degree > 0;
fetch { ""c_name"": $c.name };"
gameofthrones,134,Which characters have a louvain community value of 3 and a pagerank over 2?,"MATCH (c:Character)
WHERE c.louvain = 3 AND c.pagerank > 2
RETURN c.name AS character, c.pagerank AS pagerank","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 3;
  $c_pagerank > 2;
fetch { ""character"": $c.name, ""pagerank"": $c.pagerank };"
gameofthrones,135,Identify the characters who interact with 'Theon-Greyjoy' in any book.,"MATCH (c:Character)-[:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(theon:Character {name: 'Theon-Greyjoy'})
RETURN c.name AS character","match
  $c isa character, has name $n;
  $t isa character, has name ""Theon-Greyjoy"";
  {(character1: $c, character2: $t) isa interacts;} or
  {(character1: $c, character2: $t) isa interacts1;} or
  {(character1: $c, character2: $t) isa interacts2;} or
  {(character1: $c, character2: $t) isa interacts3;} or
  {(character1: $c, character2: $t) isa interacts45;};
fetch { ""character"": $n };"
gameofthrones,136,Who are the top 5 characters by degree in ascending order?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree ASC
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree asc;
limit 5;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,138,Which characters have a community number and a louvain value both above 600?,"MATCH (c:Character)
WHERE c.community > 600 AND c.louvain > 600
RETURN c.name AS character","match
  $c isa character;
  $c has community $c_community;
  $c has louvain $c_louvain;
  $c_community > 600;
  $c_louvain > 600;
fetch { ""character"": $c.name };"
gameofthrones,139,Identify characters with a book1BetweennessCentrality over 1000.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 1000
RETURN c.name, c.book1BetweennessCentrality","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality > 1000;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,140,List the characters who interact in book 1 with a weight exactly 291.,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight = 291
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight == 291;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,141,Who are the characters with a book1PageRank less than 1 and a degree over 10?,"MATCH (c:Character)
WHERE c.book1PageRank < 1 AND c.degree > 10
RETURN c.name","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank < 1;
  $c_degree > 10;
fetch { ""c_name"": $c.name };"
gameofthrones,142,Identify characters with an INTERACTS45 relationship and a weight between 10 and 50.,"MATCH (c1:Character)-[r:INTERACTS45]->(c2:Character)
WHERE r.weight >= 10 AND r.weight <= 50
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight >= 10;
  $rel_weight <= 50;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,143,List all characters whose name ends in 'Targaryen'.,"MATCH (c:Character)
WHERE c.name ENDS WITH 'Targaryen'
RETURN c","match
  $c isa character, has name $n;
  $n like "".*Targaryen$"";
fetch { ""name"": $n };"
gameofthrones,144,Which characters have a pagerank less than 0.5?,"MATCH (c:Character)
WHERE c.pagerank < 0.5
RETURN c.name AS character","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 0.5;
fetch { ""character"": $c.name };"
gameofthrones,145,Identify the characters with a louvain value of exactly 2.,"MATCH (c:Character)
WHERE c.louvain = 2
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 2;
fetch { ""c_name"": $c.name };"
gameofthrones,146,Who are the characters with a degree of 300?,"MATCH (c:Character)
WHERE c.degree = 300
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 300;
fetch { ""c_name"": $c.name };"
gameofthrones,147,List characters with a community number below 550.,"MATCH (c:Character)
WHERE c.community < 550
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community < 550;
fetch { ""c_name"": $c.name };"
gameofthrones,148,Which characters have an INTERACTS relationship with a weight exactly 334?,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight = 334
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight == 334;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,149,Identify characters with a centrality exactly 0.0 and a degree over 20.,"MATCH (c:Character)
WHERE c.centrality = 0.0 AND c.degree > 20
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has degree $c_degree;
  $c_centrality == 0.0;
  $c_degree > 20;
fetch { ""c_name"": $c.name };"
gameofthrones,151,Who are the top 3 characters by book45PageRank?,"MATCH (c:Character)
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
sort $c_book45_page_rank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,152,List characters with a pagerank between 0.2 and 1.0.,"MATCH (c:Character)
WHERE c.pagerank >= 0.2 AND c.pagerank <= 1.0
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank >= 0.2;
  $c_pagerank <= 1.0;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,153,Which characters have a book1PageRank less than 0.4?,"MATCH (c:Character)
WHERE c.book1PageRank < 0.4
RETURN c.name AS character","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank < 0.4;
fetch { ""character"": $c.name };"
gameofthrones,154,Identify characters with a community number exactly 642.,"MATCH (c:Character)
WHERE c.community = 642
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c_community == 642;
fetch { ""c_name"": $c.name };"
gameofthrones,155,List all characters with a book1BetweennessCentrality above 1500.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 1500
RETURN c.name AS character, c.book1BetweennessCentrality AS centrality","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality > 1500;
fetch { ""character"": $c.name, ""centrality"": $c.book1_betweenness_centrality };"
gameofthrones,156,Who are the characters with an INTERACTS1 relationship and a weight under 30?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight < 30
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight < 30;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,158,Which characters have a louvain value exactly 5 and a pagerank less than 2?,"MATCH (c:Character)
WHERE c.louvain = 5 AND c.pagerank < 2
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 5;
  $c_pagerank < 2;
fetch { ""c_name"": $c.name };"
gameofthrones,159,Identify characters with a degree exactly 125.,"MATCH (c:Character)
WHERE c.degree = 125
RETURN c","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 125;
fetch { ""c_name"": $c.name };"
gameofthrones,160,Who are the characters with a community number above 750?,"MATCH (c:Character)
WHERE c.community > 750
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community > 750;
fetch { ""c_name"": $c.name };"
gameofthrones,161,Which characters have a degree greater than 100?,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 100;
fetch { ""c_name"": $c.name };"
gameofthrones,162,List all characters with a book1PageRank higher than 5.,"MATCH (c:Character)
WHERE c.book1PageRank > 5
RETURN c.name, c.book1PageRank","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank > 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,163,Who are the top 5 characters by centrality metric?,"MATCH (c:Character)
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,164,Find characters with a book45PageRank less than 1.,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank < 1;
fetch { ""c_name"": $c.name };"
gameofthrones,165,Which characters belong to community 579?,"MATCH (c:Character)
WHERE c.community = 579
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community == 579;
fetch { ""c_name"": $c.name };"
gameofthrones,166,Identify characters with a louvain value of 2.,"MATCH (c:Character)
WHERE c.louvain = 2
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 2;
fetch { ""c_name"": $c.name };"
gameofthrones,167,What are the names of characters who have a pagerank above 8?,"MATCH (c:Character)
WHERE c.pagerank > 8
RETURN c.name","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank > 8;
fetch { ""c_name"": $c.name };"
gameofthrones,168,Which characters have a centrality of exactly 0?,"MATCH (c:Character)
WHERE c.centrality = 0
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,169,List all characters who have a book1BetweennessCentrality greater than 1000.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 1000
RETURN c.name AS character","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality > 1000;
fetch { ""character"": $c.name };"
gameofthrones,170,Who are the characters with a degree under 10?,"MATCH (c:Character)
WHERE c.degree < 10
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree < 10;
fetch { ""c_name"": $c.name };"
gameofthrones,172,Who has the highest book45PageRank in community 759?,"MATCH (c:Character)
WHERE c.community = 759
RETURN c.name AS name, c.book45PageRank AS pageRank
ORDER BY c.book45PageRank DESC
LIMIT 1","match
  $c isa character;
  $c has community $c_community;
  $c has book45_page_rank $c_book45_page_rank;
  $c_community == 759;
sort $c_book45_page_rank desc;
limit 1;
fetch { ""name"": $c.name, ""pageRank"": $c.book45_page_rank };"
gameofthrones,173,List characters with the lowest 5 book1PageRanks.,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name AS character, c.book1PageRank AS pageRank
ORDER BY pageRank
LIMIT 5","match
  $c isa character, has name $n, has book1_page_rank $pr;
sort $pr asc;
limit 5;
fetch { ""character"": $n, ""pageRank"": $pr };"
gameofthrones,174,Which characters interact in book 1 with a weight greater than 100?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight > 100
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 100;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,175,Identify the top 5 strongest INTERACTS relationships by weight.,"MATCH (c1:Character)-[i:INTERACTS]->(c2:Character)
RETURN c1.name, c2.name, i.weight
ORDER BY i.weight DESC
LIMIT 5","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
sort $rel_weight desc;
limit 5;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,176,What are the characters involved in the top 3 heaviest INTERACTS45 relationships?,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
RETURN c1.name, c2.name, i.weight AS weight
ORDER BY i.weight DESC
LIMIT 3","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
sort $rel_weight desc;
limit 3;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,177,List all characters who interact in book 2.,"MATCH (c:Character)-[:INTERACTS2]-(other:Character)
RETURN c.name AS character, other.name AS interacts_with","match
  $c isa character;
  $other isa character;
  (character1: $c, character2: $other) isa interacts2;
fetch { ""character"": $c.name, ""interacts_with"": $other.name };"
gameofthrones,178,Who are the characters with an INTERACTS relationship of exact weight 45?,"MATCH (c1:Character)-[i:INTERACTS]->(c2:Character)
WHERE i.weight = 45
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight == 45;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,179,Find all characters connected by INTERACTS3 with a weight less than 20.,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.weight < 20
RETURN c1, i, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight < 20;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,180,Which characters have an INTERACTS2 relationship with a book value of 2?,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
WHERE r.book = 2
RETURN c1, r, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has book $rel_book, has weight $rel_weight;
  $rel_book == 2;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,181,Identify all pairs of characters connected by INTERACTS where the weight is between 50 and 100.,"MATCH (c1:Character)-[i:INTERACTS]->(c2:Character)
WHERE i.weight >= 50 AND i.weight <= 100
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight >= 50;
  $rel_weight <= 100;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,182,List characters who share the same community and have INTERACTS relationships.,"MATCH (c1:Character)-[:INTERACTS]-(c2:Character)
WHERE c1.community = c2.community
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  $c1 has community $c1_community;
  $c2 has community $c2_community;
  (character1: $c1, character2: $c2) isa interacts;
  $c1_community == $c2_community;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,184,Who are the top 3 characters with the highest degree in community 795?,"MATCH (c:Character)
WHERE c.community = 795
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has degree $c_degree;
  $c_community == 795;
sort $c_degree desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,185,List the characters with a centrality between 0.2 and 0.5.,"MATCH (c:Character)
WHERE c.centrality >= 0.2 AND c.centrality <= 0.5
RETURN c.name AS character, c.centrality","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality >= 0.2;
  $c_centrality <= 0.5;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,186,Which characters have a book1BetweennessCentrality of zero?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 0
RETURN c.name","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,187,What are the names of characters with a degree of exactly 0?,"MATCH (c:Character)
WHERE c.degree = 0
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,188,List characters within louvain communities 0 to 5 with a pagerank greater than 0.5.,"MATCH (c:Character)
WHERE c.louvain >= 0 AND c.louvain <= 5 AND c.pagerank > 0.5
RETURN c.name, c.louvain, c.pagerank","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain >= 0;
  $c_louvain <= 5;
  $c_pagerank > 0.5;
fetch { ""c_name"": $c.name, ""c_louvain"": $c.louvain, ""c_pagerank"": $c.pagerank };"
gameofthrones,189,Find characters with a book1PageRank and book45PageRank both above 3.,"MATCH (c:Character)
WHERE c.book1PageRank > 3 AND c.book45PageRank > 3
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book1_page_rank > 3;
  $c_book45_page_rank > 3;
fetch { ""c_name"": $c.name };"
gameofthrones,190,Who are the characters with a louvain value higher than 5?,"MATCH (c:Character)
WHERE c.louvain > 5
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain > 5;
fetch { ""c_name"": $c.name };"
gameofthrones,191,List the characters with a pagerank less than 0.2.,"MATCH (c:Character)
WHERE c.pagerank < 0.2
RETURN c.name","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 0.2;
fetch { ""c_name"": $c.name };"
gameofthrones,193,Identify characters with a centrality greater than 0.8 and a pagerank less than 0.4.,"MATCH (c:Character)
WHERE c.centrality > 0.8 AND c.pagerank < 0.4
RETURN c.name AS character, c.centrality, c.pagerank","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has pagerank $c_pagerank;
  $c_centrality > 0.8;
  $c_pagerank < 0.4;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality, ""c_pagerank"": $c.pagerank };"
gameofthrones,194,What are the names of characters who have a pagerank and a centrality of 0?,"MATCH (c:Character)
WHERE c.pagerank = 0 AND c.centrality = 0
RETURN c.name","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c has centrality $c_centrality;
  $c_pagerank == 0;
  $c_centrality == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,195,List all characters with a book1BetweennessCentrality lower than 50 and a book1PageRank higher than 2.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality < 50 AND c.book1PageRank > 2
RETURN c","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_betweenness_centrality < 50;
  $c_book1_page_rank > 2;
fetch { ""c_name"": $c.name };"
gameofthrones,196,Who are the characters in community 504?,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community == 504;
fetch { ""c_name"": $c.name };"
gameofthrones,197,Find characters with a book45PageRank in the top 5 highest values.,"MATCH (c:Character)
WITH c
ORDER BY c.book45PageRank DESC
LIMIT 5
RETURN c.name AS character, c.book45PageRank AS book45PageRank","match
  $c isa character, has name $n, has book45_page_rank $pr;
sort $pr desc;
limit 5;
fetch { ""character"": $n, ""book45_page_rank"": $pr };"
gameofthrones,198,Which characters have a centrality less than 0.1?,"MATCH (c:Character)
WHERE c.centrality < 0.1
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality < 0.1;
fetch { ""c_name"": $c.name };"
gameofthrones,199,List characters with the highest 5 book1PageRanks in community 795.,"MATCH (c:Character)
WHERE c.community = 795
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5","match
  $c isa character;
  $c has community $c_community;
  $c has book1_page_rank $c_book1_page_rank;
  $c_community == 795;
sort $c_book1_page_rank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,200,Identify characters in community 578 with a pagerank above 0.3.,"MATCH (c:Character)
WHERE c.community = 578 AND c.pagerank > 0.3
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 578;
  $c_pagerank > 0.3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,201,What are the names of characters with a degree between 50 and 100?,"MATCH (c:Character)
WHERE c.degree >= 50 AND c.degree <= 100
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree >= 50;
  $c_degree <= 100;
fetch { ""c_name"": $c.name };"
gameofthrones,202,List all characters with a centrality of 1.,"MATCH (c:Character)
WHERE c.centrality = 1.0
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 1.0;
fetch { ""c_name"": $c.name };"
gameofthrones,203,Who are the characters with a louvain value of 1 and a pagerank above 0.5?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank > 0.5
RETURN c.name AS character","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 1;
  $c_pagerank > 0.5;
fetch { ""character"": $c.name };"
gameofthrones,204,Find characters with a book1PageRank less than 1 and a degree greater than 10.,"MATCH (c:Character)
WHERE c.book1PageRank < 1 AND c.degree > 10
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank < 1;
  $c_degree > 10;
fetch { ""c_name"": $c.name };"
gameofthrones,205,Which characters are connected by INTERACTS1 with a weight less than 10?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight < 10
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight < 10;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,207,List characters who interact in book 45 with a weight greater than 90.,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
WHERE i.weight > 90
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight > 90;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,208,Who are the characters with an INTERACTS2 relationship with a weight exactly 92?,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
WHERE r.weight = 92
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has weight $rel_weight;
  $rel_weight == 92;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,209,Which characters have an INTERACTS relationship in book 1 with a weight over 150?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight > 150
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 150;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,210,Identify characters with a centrality greater than 0.5 and a book1BetweennessCentrality less than 100.,"MATCH (c:Character)
WHERE c.centrality > 0.5 AND c.book1BetweennessCentrality < 100
RETURN c.name AS character, c.centrality, c.book1BetweennessCentrality","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_centrality > 0.5;
  $c_book1_betweenness_centrality < 100;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,211,List characters with a pagerank greater than 7 and a degree less than 50.,"MATCH (c:Character)
WHERE c.pagerank > 7 AND c.degree < 50
RETURN c.name, c.pagerank, c.degree","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c has degree $c_degree;
  $c_pagerank > 7;
  $c_degree < 50;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank, ""c_degree"": $c.degree };"
gameofthrones,214,List the characters with a centrality between 0.5 and 0.8.,"MATCH (c:Character)
WHERE c.centrality >= 0.5 AND c.centrality <= 0.8
RETURN c.name AS character, c.centrality","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality >= 0.5;
  $c_centrality <= 0.8;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,215,Which characters have a book1BetweennessCentrality of exactly 2604.7556467555924?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality = 2604.7556467555924
RETURN c.name","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality == 2604.7556467555924;
fetch { ""c_name"": $c.name };"
gameofthrones,216,Identify characters with a degree greater than 20 and a pagerank less than 0.3.,"MATCH (c:Character)
WHERE c.degree > 20 AND c.pagerank < 0.3
RETURN c.name, c.degree, c.pagerank","match
  $c isa character;
  $c has degree $c_degree;
  $c has pagerank $c_pagerank;
  $c_degree > 20;
  $c_pagerank < 0.3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree, ""c_pagerank"": $c.pagerank };"
gameofthrones,217,What are the names of characters with a degree of 300?,"MATCH (c:Character)
WHERE c.degree = 300
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 300;
fetch { ""c_name"": $c.name };"
gameofthrones,218,List characters within louvain community 1 with a pagerank greater than 0.4.,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank > 0.4
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 1;
  $c_pagerank > 0.4;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,219,Find characters with a book1PageRank and book45PageRank both under 2.,"MATCH (c:Character)
WHERE c.book1PageRank < 2 AND c.book45PageRank < 2
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book1_page_rank < 2;
  $c_book45_page_rank < 2;
fetch { ""c_name"": $c.name };"
gameofthrones,220,Who are the characters with a louvain value less than 1?,"MATCH (c:Character)
WHERE c.louvain < 1
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain < 1;
fetch { ""c_name"": $c.name };"
gameofthrones,221,List the characters with a pagerank less than 0.15.,"MATCH (c:Character)
WHERE c.pagerank < 0.15
RETURN c.name","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 0.15;
fetch { ""c_name"": $c.name };"
gameofthrones,223,Identify characters with a centrality greater than 0.9 and a pagerank less than 0.5.,"MATCH (c:Character)
WHERE c.centrality > 0.9 AND c.pagerank < 0.5
RETURN c.name AS character, c.centrality, c.pagerank","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has pagerank $c_pagerank;
  $c_centrality > 0.9;
  $c_pagerank < 0.5;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality, ""c_pagerank"": $c.pagerank };"
gameofthrones,224,What are the names of characters who have a pagerank and a centrality of 1?,"MATCH (c:Character)
WHERE c.pagerank = 1 AND c.centrality = 1
RETURN c.name","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c has centrality $c_centrality;
  $c_pagerank == 1;
  $c_centrality == 1;
fetch { ""c_name"": $c.name };"
gameofthrones,225,List all characters with a book1BetweennessCentrality higher than 2000 and a book1PageRank lower than 3.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 2000 AND c.book1PageRank < 3
RETURN c.name AS character, c.book1BetweennessCentrality AS betweenness, c.book1PageRank AS pagerank","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_betweenness_centrality > 2000;
  $c_book1_page_rank < 3;
fetch { ""character"": $c.name, ""betweenness"": $c.book1_betweenness_centrality, ""pagerank"": $c.book1_page_rank };"
gameofthrones,226,Who are the characters in community 795 with a pagerank above 0.5?,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank > 0.5
RETURN c.name AS character, c.pagerank AS pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 795;
  $c_pagerank > 0.5;
fetch { ""character"": $c.name, ""pagerank"": $c.pagerank };"
gameofthrones,227,Find characters with a book45PageRank in the top 10 highest values.,"MATCH (c:Character)
WITH c
ORDER BY c.book45PageRank DESC
LIMIT 10
RETURN c.name AS character, c.book45PageRank AS book45PageRank","match
  $c isa character, has name $n, has book45_page_rank $pr;
sort $pr desc;
limit 10;
fetch { ""character"": $n, ""book45_page_rank"": $pr };"
gameofthrones,228,Which characters have a centrality less than 0.05?,"MATCH (c:Character)
WHERE c.centrality < 0.05
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality < 0.05;
fetch { ""c_name"": $c.name };"
gameofthrones,229,List characters with the highest 3 book1PageRanks in community 504.,"MATCH (c:Character)
WHERE c.community = 504
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has book1_page_rank $c_book1_page_rank;
  $c_community == 504;
sort $c_book1_page_rank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,230,Identify characters in community 759 with a pagerank above 0.4.,"MATCH (c:Character)
WHERE c.community = 759 AND c.pagerank > 0.4
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 759;
  $c_pagerank > 0.4;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,231,What are the names of characters with a degree between 10 and 20?,"MATCH (c:Character)
WHERE c.degree >= 10 AND c.degree <= 20
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree >= 10;
  $c_degree <= 20;
fetch { ""c_name"": $c.name };"
gameofthrones,232,List all characters with a centrality of 0.5.,"MATCH (c:Character)
WHERE c.centrality = 0.5
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0.5;
fetch { ""c_name"": $c.name };"
gameofthrones,233,Who are the characters with a louvain value of 3 and a pagerank above 0.6?,"MATCH (c:Character)
WHERE c.louvain = 3 AND c.pagerank > 0.6
RETURN c.name AS character","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 3;
  $c_pagerank > 0.6;
fetch { ""character"": $c.name };"
gameofthrones,234,Find characters with a book1PageRank less than 0.5 and a degree greater than 5.,"MATCH (c:Character)
WHERE c.book1PageRank < 0.5 AND c.degree > 5
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank < 0.5;
  $c_degree > 5;
fetch { ""c_name"": $c.name };"
gameofthrones,235,Which characters are connected by INTERACTS1 with a weight greater than 200?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight > 200
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 200;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,237,List characters who interact in book 45 with a weight greater than 95.,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
WHERE i.weight > 95
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight > 95;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,238,Who are the characters with an INTERACTS3 relationship with a weight exactly 95?,"MATCH (c1:Character)-[i:INTERACTS3 {weight: 95}]->(c2:Character)
RETURN c1.name AS character1, c2.name AS character2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
  $rel_weight == 95;
fetch { ""character1"": $c1.name, ""character2"": $c2.name };"
gameofthrones,239,Which characters have an INTERACTS relationship in book 1 with a weight over 250?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WHERE r.weight > 250
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 250;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,240,Which characters have a book1PageRank greater than 3?,"MATCH (c:Character)
WHERE c.book1PageRank > 3
RETURN c.name, c.book1PageRank","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank > 3;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,241,List all characters with a degree higher than 100.,"MATCH (c:Character)
WHERE c.degree > 100
RETURN c.name, c.degree","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 100;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,242,Find characters with a book45PageRank below 1.,"MATCH (c:Character)
WHERE c.book45PageRank < 1
RETURN c","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank < 1;
fetch { ""c_name"": $c.name };"
gameofthrones,243,Who are the top 5 characters by pagerank?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,244,Identify characters that have a centrality of 0.,"MATCH (c:Character)
WHERE c.centrality = 0
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,245,Which characters are part of community 584?,"MATCH (c:Character)
WHERE c.community = 584
RETURN c.name","match
  $c isa character;
  $c has community $c_community;
  $c_community == 584;
fetch { ""c_name"": $c.name };"
gameofthrones,246,Who has the highest book1BetweennessCentrality?,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 1","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 1;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,247,List characters with a centrality greater than 0.5.,"MATCH (c:Character)
WHERE c.centrality > 0.5
RETURN c.name","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality > 0.5;
fetch { ""c_name"": $c.name };"
gameofthrones,248,Which characters belong to the louvain community 3?,"MATCH (c:Character)
WHERE c.louvain = 3
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 3;
fetch { ""c_name"": $c.name };"
gameofthrones,249,List the top 3 characters by book1BetweennessCentrality.,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,250,Who interacts in book 45 with a weight greater than 90?,"MATCH (c1:Character)-[i:INTERACTS45]->(c2:Character)
WHERE i.weight > 90
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts45, has weight $rel_weight;
  $rel_weight > 90;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,251,Find characters with an INTERACTS relationship having a weight over 100.,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight > 100
RETURN c1, r, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight > 100;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,252,Which characters have an INTERACTS2 relationship in book 2?,"MATCH (c1:Character)-[r:INTERACTS2]->(c2:Character)
WHERE r.book = 2
RETURN c1.name, c2.name","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has book $rel_book;
  $rel_book == 2;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name };"
gameofthrones,253,List characters with INTERACTS3 relationships in book 3 with weights greater than 50.,"MATCH (c1:Character)-[i:INTERACTS3]->(c2:Character)
WHERE i.book = 3 AND i.weight > 50
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has book $rel_book, has weight $rel_weight;
  $rel_book == 3;
  $rel_weight > 50;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,254,Who has the highest weight in an INTERACTS1 relationship?,"MATCH (c1:Character)-[r:INTERACTS1]->(c2:Character)
WITH r
ORDER BY r.weight DESC
LIMIT 1
MATCH (c1:Character)-[r]->(c2:Character)
RETURN c1.name, c2.name, r.weight","match
  (character1: $c1, character2: $c2) isa interacts1, has weight $w;
  $c1 has name $n1;
  $c2 has name $n2;
sort $w desc;
limit 1;
fetch { ""character1"": $n1, ""character2"": $n2, ""weight"": $w };"
gameofthrones,255,Find characters that interact with a weight of exactly 92 in book 2.,"MATCH (c1:Character)-[i:INTERACTS2 {weight: 92}]->(c2:Character)
RETURN c1, i, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has weight $rel_weight;
  $rel_weight == 92;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,256,Which characters have the least centrality but more than 30 degree?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL AND c.degree > 30
RETURN c.name, c.centrality, c.degree
ORDER BY c.centrality ASC
LIMIT 10","match
  $c isa character, has name $n, has centrality $cent, has degree $deg;
  $deg > 30;
sort $cent asc;
limit 10;
fetch { ""name"": $n, ""centrality"": $cent, ""degree"": $deg };"
gameofthrones,257,List characters with a pagerank less than 1 but more than 0.5.,"MATCH (c:Character)
WHERE c.pagerank < 1 AND c.pagerank > 0.5
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 1;
  $c_pagerank > 0.5;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,258,Who are the top 5 characters with the highest degree?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,259,Find characters with a louvain value of 0 and a community above 750.,"MATCH (c:Character)
WHERE c.louvain = 0 AND c.community > 750
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has community $c_community;
  $c_louvain == 0;
  $c_community > 750;
fetch { ""c_name"": $c.name };"
gameofthrones,260,Which characters have a book1PageRank exactly 0.15?,"MATCH (c:Character)
WHERE c.book1PageRank = 0.15
RETURN c.name AS character","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank == 0.15;
fetch { ""character"": $c.name };"
gameofthrones,261,List all characters with a book45PageRank above 10.,"MATCH (c:Character)
WHERE c.book45PageRank > 10
RETURN c.name, c.book45PageRank","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank > 10;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,262,Find characters in community 578 with a degree of 0.,"MATCH (c:Character)
WHERE c.community = 578 AND c.degree = 0
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has degree $c_degree;
  $c_community == 578;
  $c_degree == 0;
fetch { ""c_name"": $c.name };"
gameofthrones,263,Who are the top 3 characters with the lowest book1BetweennessCentrality?,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name AS character, c.book1BetweennessCentrality AS centrality
ORDER BY centrality
LIMIT 3","match
  $c isa character, has name $n, has book1_betweenness_centrality $bc;
sort $bc asc;
limit 3;
fetch { ""character"": $n, ""centrality"": $bc };"
gameofthrones,264,Which characters belong to louvain community 1 and have a pagerank above 1?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.pagerank > 1
RETURN c.name AS character, c.pagerank AS pagerank","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 1;
  $c_pagerank > 1;
fetch { ""character"": $c.name, ""pagerank"": $c.pagerank };"
gameofthrones,265,List characters with an INTERACTS relationship having a weight below 10.,"MATCH (c1:Character)-[r:INTERACTS]->(c2:Character)
WHERE r.weight < 10
RETURN c1.name AS character1, c2.name AS character2, r.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts, has weight $rel_weight;
  $rel_weight < 10;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,266,Find characters with INTERACTS2 relationships in book 2 with a weight less than 20.,"MATCH (c1:Character)-[i2:INTERACTS2]->(c2:Character)
WHERE i2.book = 2 AND i2.weight < 20
RETURN c1, i2, c2","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has book $rel_book, has weight $rel_weight;
  $rel_book == 2;
  $rel_weight < 20;
fetch { ""c1_name"": $c1.name, ""rel_weight"": $rel_weight, ""c2_name"": $c2.name };"
gameofthrones,268,List characters with a louvain value of 1 and a degree above 50.,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.degree > 50
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has degree $c_degree;
  $c_louvain == 1;
  $c_degree > 50;
fetch { ""c_name"": $c.name };"
gameofthrones,269,Find characters with a book1PageRank between 2 and 4.,"MATCH (c:Character)
WHERE c.book1PageRank >= 2 AND c.book1PageRank <= 4
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank >= 2;
  $c_book1_page_rank <= 4;
fetch { ""c_name"": $c.name };"
gameofthrones,270,Who are the top 5 characters with the highest book1PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank DESC
LIMIT 5","match
  $c isa character, has name $n, has book1_page_rank $pr;
sort $pr desc;
limit 5;
fetch { ""name"": $n, ""book1_page_rank"": $pr };"
gameofthrones,271,List characters with a book45PageRank of exactly 2.,"MATCH (c:Character)
WHERE c.book45PageRank = 2
RETURN c.name","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank == 2;
fetch { ""c_name"": $c.name };"
gameofthrones,272,Find characters in community 759 with a pagerank less than 1.,"MATCH (c:Character)
WHERE c.community = 759 AND c.pagerank < 1
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 759;
  $c_pagerank < 1;
fetch { ""c_name"": $c.name };"
gameofthrones,273,Who are the top 3 characters by centrality?,"MATCH (c:Character)
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,274,Which characters have a degree exactly 300?,"MATCH (c:Character)
WHERE c.degree = 300
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree == 300;
fetch { ""c_name"": $c.name };"
gameofthrones,275,List characters with a pagerank greater than 8.,"MATCH (c:Character)
WHERE c.pagerank > 8
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank > 8;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,276,Find characters with a centrality less than 0.1 and a book1PageRank above 5.,"MATCH (c:Character)
WHERE c.centrality < 0.1 AND c.book1PageRank > 5
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_page_rank $c_book1_page_rank;
  $c_centrality < 0.1;
  $c_book1_page_rank > 5;
fetch { ""c_name"": $c.name };"
gameofthrones,278,List characters with a louvain value of 0 and a community below 600.,"MATCH (c:Character)
WHERE c.louvain = 0 AND c.community < 600
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has community $c_community;
  $c_louvain == 0;
  $c_community < 600;
fetch { ""c_name"": $c.name };"
gameofthrones,279,Find characters with a degree between 50 and 100.,"MATCH (c:Character)
WHERE c.degree >= 50 AND c.degree <= 100
RETURN c","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree >= 50;
  $c_degree <= 100;
fetch { ""c_name"": $c.name };"
gameofthrones,280,Who are the top 5 characters with the lowest book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank
LIMIT 5","match
  $c isa character, has name $n, has book45_page_rank $pr;
sort $pr asc;
limit 5;
fetch { ""name"": $n, ""book45_page_rank"": $pr };"
gameofthrones,281,List characters with a centrality above 0.5 and a book1PageRank below 1.,"MATCH (c:Character)
WHERE c.centrality > 0.5 AND c.book1PageRank < 1
RETURN c.name AS character","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_page_rank $c_book1_page_rank;
  $c_centrality > 0.5;
  $c_book1_page_rank < 1;
fetch { ""character"": $c.name };"
gameofthrones,282,Find characters in community 584 with a pagerank above 9.,"MATCH (c:Character)
WHERE c.community = 584 AND c.pagerank > 9
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 584;
  $c_pagerank > 9;
fetch { ""c_name"": $c.name };"
gameofthrones,283,Who are the top 3 characters by book45PageRank?,"MATCH (c:Character)
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
sort $c_book45_page_rank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,284,Which characters have a degree less than 10?,"MATCH (c:Character)
WHERE c.degree < 10
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree < 10;
fetch { ""c_name"": $c.name };"
gameofthrones,285,List characters with a pagerank of exactly 0.15.,"MATCH (c:Character)
WHERE c.pagerank = 0.15
RETURN c.name","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank == 0.15;
fetch { ""c_name"": $c.name };"
gameofthrones,286,Find characters with a centrality above 0.2 and a book1BetweennessCentrality above 1000.,"MATCH (c:Character)
WHERE c.centrality > 0.2 AND c.book1BetweennessCentrality > 1000
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_centrality > 0.2;
  $c_book1_betweenness_centrality > 1000;
fetch { ""c_name"": $c.name };"
gameofthrones,287,Who are the top 5 characters with the highest centrality?,"MATCH (c:Character)
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,288,List characters with a louvain value of 2 and a degree above 20.,"MATCH (c:Character)
WHERE c.louvain = 2 AND c.degree > 20
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has degree $c_degree;
  $c_louvain == 2;
  $c_degree > 20;
fetch { ""c_name"": $c.name };"
gameofthrones,289,Find characters with a book1PageRank of exactly 8.,"MATCH (c:Character)
WHERE c.book1PageRank = 8
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book1_page_rank == 8;
fetch { ""c_name"": $c.name };"
gameofthrones,291,List characters with a centrality below 0.1 and a pagerank above 2.,"MATCH (c:Character)
WHERE c.centrality < 0.1 AND c.pagerank > 2
RETURN c.name AS character, c.centrality, c.pagerank","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has pagerank $c_pagerank;
  $c_centrality < 0.1;
  $c_pagerank > 2;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality, ""c_pagerank"": $c.pagerank };"
gameofthrones,292,Find characters in community 759 with a book45PageRank less than 4.,"MATCH (c:Character)
WHERE c.community = 759 AND c.book45PageRank < 4
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has book45_page_rank $c_book45_page_rank;
  $c_community == 759;
  $c_book45_page_rank < 4;
fetch { ""c_name"": $c.name };"
gameofthrones,293,Who are the top 5 characters by book1BetweennessCentrality?,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 5","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,294,List characters with a book45PageRank above 5 and a community of 584.,"MATCH (c:Character)
WHERE c.book45PageRank > 5 AND c.community = 584
RETURN c.name AS character","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c has community $c_community;
  $c_book45_page_rank > 5;
  $c_community == 584;
fetch { ""character"": $c.name };"
gameofthrones,295,Find characters with a pagerank above 7 and a degree above 150.,"MATCH (c:Character)
WHERE c.pagerank > 7 AND c.degree > 150
RETURN c.name, c.pagerank, c.degree","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c has degree $c_degree;
  $c_pagerank > 7;
  $c_degree > 150;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank, ""c_degree"": $c.degree };"
gameofthrones,297,List characters with a book1PageRank below 0.2 and a degree above 10.,"MATCH (c:Character)
WHERE c.book1PageRank < 0.2 AND c.degree > 10
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank < 0.2;
  $c_degree > 10;
fetch { ""c_name"": $c.name };"
gameofthrones,298,Find characters with a centrality above 0.3 and a louvain value of 1.,"MATCH (c:Character)
WHERE c.centrality > 0.3 AND c.louvain = 1
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has louvain $c_louvain;
  $c_centrality > 0.3;
  $c_louvain == 1;
fetch { ""c_name"": $c.name };"
gameofthrones,299,Who are the top 5 characters with the lowest book1PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank
LIMIT 5","match
  $c isa character, has name $n, has book1_page_rank $pr;
sort $pr asc;
limit 5;
fetch { ""name"": $n, ""book1_page_rank"": $pr };"
gameofthrones,300,List characters with a pagerank below 0.5.,"MATCH (c:Character)
WHERE c.pagerank < 0.5
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 0.5;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,301,Find characters in community 578 with a book1BetweennessCentrality above 500.,"MATCH (c:Character)
WHERE c.community = 578 AND c.book1BetweennessCentrality > 500
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 578;
  $c_book1_betweenness_centrality > 500;
fetch { ""c_name"": $c.name };"
gameofthrones,303,List characters with a louvain value of 3 and a degree below 5.,"MATCH (c:Character)
WHERE c.louvain = 3 AND c.degree < 5
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has degree $c_degree;
  $c_louvain == 3;
  $c_degree < 5;
fetch { ""c_name"": $c.name };"
gameofthrones,304,Find characters with a centrality below 0.2 and a book45PageRank above 3.,"MATCH (c:Character)
WHERE c.centrality < 0.2 AND c.book45PageRank > 3
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book45_page_rank $c_book45_page_rank;
  $c_centrality < 0.2;
  $c_book45_page_rank > 3;
fetch { ""c_name"": $c.name };"
gameofthrones,305,Who are the top 5 characters by degree?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,306,List characters with a pagerank above 9.,"MATCH (c:Character)
WHERE c.pagerank > 9
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank > 9;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,307,Find characters with a centrality above 0.4 and a book1PageRank below 0.3.,"MATCH (c:Character)
WHERE c.centrality > 0.4 AND c.book1PageRank < 0.3
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_page_rank $c_book1_page_rank;
  $c_centrality > 0.4;
  $c_book1_page_rank < 0.3;
fetch { ""c_name"": $c.name };"
gameofthrones,308,Who are the top 3 characters with the highest weight in INTERACTS1 relationships?,"MATCH (c:Character)-[i:INTERACTS1]->(other:Character)
RETURN c.name AS character, max(i.weight) AS max_weight
ORDER BY max_weight DESC
LIMIT 3","match
  $c isa character, has name $cn;
  $other isa character;
  $rel isa interacts1 (character1: $c, character2: $other), has weight $w;
sort $w desc;
limit 3;
fetch { ""character"": $cn };"
gameofthrones,309,List characters with a book1BetweennessCentrality above 2000.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality > 2000
RETURN c.name, c.book1BetweennessCentrality","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_book1_betweenness_centrality > 2000;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,310,Find characters with a centrality below 0.1 and a louvain value above 5.,"MATCH (c:Character)
WHERE c.centrality < 0.1 AND c.louvain > 5
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has louvain $c_louvain;
  $c_centrality < 0.1;
  $c_louvain > 5;
fetch { ""c_name"": $c.name };"
gameofthrones,311,Who are the top 5 characters with the lowest centrality?,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
RETURN c.name, c.centrality
ORDER BY c.centrality
LIMIT 5","match
  $c isa character, has name $n, has centrality $cent;
sort $cent asc;
limit 5;
fetch { ""name"": $n, ""centrality"": $cent };"
gameofthrones,312,List characters with a book45PageRank below 1.5.,"MATCH (c:Character)
WHERE c.book45PageRank < 1.5
RETURN c.name AS character","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank < 1.5;
fetch { ""character"": $c.name };"
gameofthrones,313,Find characters in community 759 with a degree above 30.,"MATCH (c:Character)
WHERE c.community = 759 AND c.degree > 30
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has degree $c_degree;
  $c_community == 759;
  $c_degree > 30;
fetch { ""c_name"": $c.name };"
gameofthrones,314,Who are the top 3 characters with the highest book1BetweennessCentrality?,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,315,List characters with a centrality above 0.6 and a pagerank below 1.,"MATCH (c:Character)
WHERE c.centrality > 0.6 AND c.pagerank < 1
RETURN c.name AS character","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has pagerank $c_pagerank;
  $c_centrality > 0.6;
  $c_pagerank < 1;
fetch { ""character"": $c.name };"
gameofthrones,316,Find characters with a book1PageRank above 5 and a community of 578.,"MATCH (c:Character)
WHERE c.book1PageRank > 5 AND c.community = 578
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has community $c_community;
  $c_book1_page_rank > 5;
  $c_community == 578;
fetch { ""c_name"": $c.name };"
gameofthrones,317,Who are the top 5 characters with the highest weight in INTERACTS2 relationships?,"MATCH (c:Character)-[i:INTERACTS2]->(other:Character)
RETURN c.name AS character, max(i.weight) AS max_weight
ORDER BY max_weight DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $other isa character;
  $rel isa interacts2 (character1: $c, character2: $other), has weight $w;
sort $w desc;
limit 5;
fetch { ""character"": $cn };"
gameofthrones,318,List characters with a centrality below 0.4 and a book45PageRank above 2.,"MATCH (c:Character)
WHERE c.centrality < 0.4 AND c.book45PageRank > 2
RETURN c.name AS character, c.centrality, c.book45PageRank","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book45_page_rank $c_book45_page_rank;
  $c_centrality < 0.4;
  $c_book45_page_rank > 2;
fetch { ""character"": $c.name, ""c_centrality"": $c.centrality, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,319,Find characters with a pagerank below 0.6 and a degree above 20.,"MATCH (c:Character)
WHERE c.pagerank < 0.6 AND c.degree > 20
RETURN c","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c has degree $c_degree;
  $c_pagerank < 0.6;
  $c_degree > 20;
fetch { ""c_name"": $c.name };"
gameofthrones,321,List characters with a community above 750 and a pagerank below 1.,"MATCH (c:Character)
WHERE c.community > 750 AND c.pagerank < 1
RETURN c.name AS character","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community > 750;
  $c_pagerank < 1;
fetch { ""character"": $c.name };"
gameofthrones,322,Find characters with a centrality above 0.5 and a book1BetweennessCentrality above 3000.,"MATCH (c:Character)
WHERE c.centrality > 0.5 AND c.book1BetweennessCentrality > 3000
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_centrality > 0.5;
  $c_book1_betweenness_centrality > 3000;
fetch { ""c_name"": $c.name };"
gameofthrones,324,List characters with a louvain value of 0 and a pagerank above 8.,"MATCH (c:Character)
WHERE c.louvain = 0 AND c.pagerank > 8
RETURN c.name, c.pagerank","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 0;
  $c_pagerank > 8;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,325,Find characters with a book1PageRank below 0.25 and a degree above 5.,"MATCH (c:Character)
WHERE c.book1PageRank < 0.25 AND c.degree > 5
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has degree $c_degree;
  $c_book1_page_rank < 0.25;
  $c_degree > 5;
fetch { ""c_name"": $c.name };"
gameofthrones,326,Who are the top 3 characters with the highest centrality?,"MATCH (c:Character)
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,327,List characters with a community of 795 and a pagerank below 0.2.,"MATCH (c:Character)
WHERE c.community = 795 AND c.pagerank < 0.2
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 795;
  $c_pagerank < 0.2;
fetch { ""c_name"": $c.name };"
gameofthrones,328,Find characters with a centrality above 0.8 and a book1BetweennessCentrality above 4000.,"MATCH (c:Character)
WHERE c.centrality > 0.8 AND c.book1BetweennessCentrality > 4000
RETURN c","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_centrality > 0.8;
  $c_book1_betweenness_centrality > 4000;
fetch { ""c_name"": $c.name };"
gameofthrones,329,Who are the top 5 characters with the highest weight in INTERACTS45 relationships?,"MATCH (c:Character)-[i:INTERACTS45]->(other:Character)
RETURN c.name AS character, sum(i.weight) AS total_weight
ORDER BY total_weight DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $other isa character;
  $rel isa interacts45 (character1: $c, character2: $other), has weight $w;
sort $w desc;
limit 5;
fetch { ""character"": $cn };"
gameofthrones,330,What are the names of the top 5 characters with the highest book1PageRank?,"MATCH (c:Character)
RETURN c.name AS character, c.book1PageRank AS pageRank
ORDER BY pageRank DESC
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
sort $c_book1_page_rank desc;
limit 5;
fetch { ""character"": $c.name, ""pageRank"": $c.book1_page_rank };"
gameofthrones,331,List the top 3 characters with the highest degree of centrality.,"MATCH (c:Character)
RETURN c.name, c.centrality
ORDER BY c.centrality DESC
LIMIT 3","match
  $c isa character;
  $c has centrality $c_centrality;
sort $c_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_centrality"": $c.centrality };"
gameofthrones,332,Which characters have a louvain community number less than 5? Limit to 5 characters.,"MATCH (c:Character)
WHERE c.louvain < 5
RETURN c.name
LIMIT 5","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain < 5;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,333,Identify 3 characters with a book45PageRank greater than 5.,"MATCH (c:Character)
WHERE c.book45PageRank > 5
RETURN c.name
LIMIT 3","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book45_page_rank > 5;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,334,Who are the top 5 characters by pagerank in the entire dataset?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank DESC
LIMIT 5","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,335,What are the names of the characters who have a degree greater than 50?,"MATCH (c:Character)
WHERE c.degree > 50
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c_degree > 50;
fetch { ""c_name"": $c.name };"
gameofthrones,337,List the top 3 characters with the least betweenness centrality in book 1.,"MATCH (c:Character)
WHERE c.book1BetweennessCentrality IS NOT NULL
RETURN c.name AS character, c.book1BetweennessCentrality AS betweenness 
ORDER BY betweenness
LIMIT 3","match
  $c isa character, has name $n, has book1_betweenness_centrality $bc;
sort $bc asc;
limit 3;
fetch { ""character"": $n, ""betweenness"": $bc };"
gameofthrones,338,Who are the characters with a louvain value of 0? Limit to top 5.,"MATCH (c:Character)
WHERE c.louvain = 0
RETURN c.name
LIMIT 5","match
  $c isa character;
  $c has louvain $c_louvain;
  $c_louvain == 0;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,339,Find the top 5 characters with the highest weight in INTERACTS relationship.,"MATCH (c:Character)-[i:INTERACTS]->(other:Character)
RETURN c.name AS character, sum(i.weight) AS total_weight
ORDER BY total_weight DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $other isa character;
  $rel isa interacts (character1: $c, character2: $other), has weight $w;
sort $w desc;
limit 5;
fetch { ""character"": $cn };"
gameofthrones,340,Which characters interact in book 1 with a weight greater than 100?,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
WHERE i.weight > 100
RETURN c1.name AS character1, c2.name AS character2, i.weight AS weight","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts1, has weight $rel_weight;
  $rel_weight > 100;
fetch { ""character1"": $c1.name, ""character2"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,341,Name the characters involved in the INTERACTS2 relationship with the highest weights. Limit to 3 characters.,"MATCH (c1:Character)-[i:INTERACTS2]->(c2:Character)
RETURN c1.name, c2.name, i.weight AS weight
ORDER BY i.weight DESC
LIMIT 3","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts2, has weight $rel_weight;
sort $rel_weight desc;
limit 3;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,344,What are the top 3 characters with a community number exactly 579?,"MATCH (c:Character)
WHERE c.community = 579
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 579;
sort $c_pagerank desc;
limit 3;
fetch { ""c_name"": $c.name };"
gameofthrones,345,Identify characters who have both high pagerank and high degree of centrality. Limit to top 5.,"MATCH (c:Character)
WHERE c.pagerank IS NOT NULL AND c.centrality IS NOT NULL
RETURN c.name AS character, c.pagerank AS pagerank, c.centrality AS centrality
ORDER BY c.pagerank DESC, c.centrality DESC
LIMIT 5","match
  $c isa character, has name $n, has pagerank $pr, has centrality $cent;
sort $pr desc;
limit 5;
fetch { ""character"": $n, ""pagerank"": $pr, ""centrality"": $cent };"
gameofthrones,346,Which characters have a book45PageRank less than 1 but a book1PageRank greater than 2?,"MATCH (c:Character)
WHERE c.book45PageRank < 1 AND c.book1PageRank > 2
RETURN c.name AS character, c.book45PageRank AS book45PageRank, c.book1PageRank AS book1PageRank","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
  $c has book1_page_rank $c_book1_page_rank;
  $c_book45_page_rank < 1;
  $c_book1_page_rank > 2;
fetch { ""character"": $c.name, ""book45PageRank"": $c.book45_page_rank, ""book1PageRank"": $c.book1_page_rank };"
gameofthrones,347,Name the 3 characters with the highest INTERACTS3 relationship weight.,"MATCH (c:Character)-[i:INTERACTS3]->(other:Character)
RETURN c.name, other.name, i.weight AS weight
ORDER BY i.weight DESC
LIMIT 3","match
  $c isa character;
  $other isa character;
  (character1: $c, character2: $other) isa interacts3, has weight $rel_weight;
sort $rel_weight desc;
limit 3;
fetch { ""c_name"": $c.name, ""other_name"": $other.name, ""weight"": $rel_weight };"
gameofthrones,350,Who has the highest book1BetweennessCentrality and is from community 759?,"MATCH (c:Character)
WHERE c.community = 759
RETURN c.name AS name, c.book1BetweennessCentrality AS centrality
ORDER BY centrality DESC
LIMIT 1","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 759;
sort $c_book1_betweenness_centrality desc;
limit 1;
fetch { ""name"": $c.name, ""centrality"": $c.book1_betweenness_centrality };"
gameofthrones,351,What are the names of characters with a louvain value of 1 and degree greater than 10?,"MATCH (c:Character)
WHERE c.louvain = 1 AND c.degree > 10
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has degree $c_degree;
  $c_louvain == 1;
  $c_degree > 10;
fetch { ""c_name"": $c.name };"
gameofthrones,352,Identify the top 3 characters with the lowest pagerank but who interact in book 45.,"MATCH (c:Character)-[:INTERACTS45]->(other:Character)
WHERE exists {(c)-[:INTERACTS45]->()} 
RETURN c.name, c.pagerank
ORDER BY c.pagerank
LIMIT 3","match
  $c isa character, has name $n, has pagerank $pr;
  (character1: $c, character2: $other) isa interacts45;
sort $pr asc;
limit 3;
fetch { ""name"": $n, ""pagerank"": $pr };"
gameofthrones,354,Name the characters with a degree of zero and a centrality greater than 0.5.,"MATCH (c:Character)
WHERE c.degree = 0 AND c.centrality > 0.5
RETURN c.name","match
  $c isa character;
  $c has degree $c_degree;
  $c has centrality $c_centrality;
  $c_degree == 0;
  $c_centrality > 0.5;
fetch { ""c_name"": $c.name };"
gameofthrones,355,Who are the top 5 characters in terms of INTERACTS45 weight?,"MATCH (c:Character)-[i:INTERACTS45]->(other:Character)
RETURN c.name AS character, sum(i.weight) AS total_weight
ORDER BY total_weight DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $other isa character;
  $rel isa interacts45 (character1: $c, character2: $other), has weight $w;
sort $w desc;
limit 5;
fetch { ""character"": $cn };"
gameofthrones,356,List 3 characters with a book1PageRank less than 1 but an INTERACTS weight greater than 150.,"MATCH (c:Character)
WHERE c.book1PageRank < 1 AND EXISTS {
  (c)-[i:INTERACTS]->(:Character)
  WHERE i.weight > 150
}
RETURN c.name
LIMIT 3","match
  $c isa character, has name $n, has book1_page_rank $pr;
  (character1: $c, character2: $other) isa interacts, has weight $w;
  $pr < 1;
  $w > 150;
limit 3;
fetch { ""name"": $n };"
gameofthrones,357,Find the characters who have a louvain community number of 10 and a pagerank greater than 0.5.,"MATCH (c:Character)
WHERE c.louvain = 10 AND c.pagerank > 0.5
RETURN c","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 10;
  $c_pagerank > 0.5;
fetch { ""c_name"": $c.name };"
gameofthrones,362,Find the characters with a community number less than 600 and a centrality of 1.,"MATCH (c:Character)
WHERE c.community < 600 AND c.centrality = 1.0
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has centrality $c_centrality;
  $c_community < 600;
  $c_centrality == 1.0;
fetch { ""c_name"": $c.name };"
gameofthrones,363,Name the top 5 characters with the highest degree in the entire dataset.,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree DESC
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,364,What are the names of characters who have an INTERACTS1 book value of 1 and a weight greater than 50?,"MATCH (c:Character)-[i:INTERACTS1]->(other:Character)
WHERE i.book = 1 AND i.weight > 50
RETURN c.name","match
  $c isa character;
  $other isa character;
  (character1: $c, character2: $other) isa interacts1, has book $rel_book, has weight $rel_weight;
  $rel_book == 1;
  $rel_weight > 50;
fetch { ""c_name"": $c.name };"
gameofthrones,365,List the top 3 characters with the highest book1BetweennessCentrality.,"MATCH (c:Character)
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,366,Identify characters with a pagerank less than 0.2 but a degree greater than 10.,"MATCH (c:Character)
WHERE c.pagerank < 0.2 AND c.degree > 10
RETURN c.name, c.pagerank, c.degree","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c has degree $c_degree;
  $c_pagerank < 0.2;
  $c_degree > 10;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank, ""c_degree"": $c.degree };"
gameofthrones,370,List the characters who have a centrality value of exactly 0.8. Limit to top 5.,"MATCH (c:Character)
WHERE c.centrality = 0.8
RETURN c.name
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
  $c_centrality == 0.8;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,371,Name the 3 characters with the highest pagerank in book 45.,"MATCH (c:Character)
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank DESC
LIMIT 3","match
  $c isa character;
  $c has book45_page_rank $c_book45_page_rank;
sort $c_book45_page_rank desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank };"
gameofthrones,372,What are the names of the top 5 characters by degree who are also in louvain community 2?,"MATCH (c:Character)
WHERE c.louvain = 2
RETURN c.name
ORDER BY c.degree DESC
LIMIT 5","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has degree $c_degree;
  $c_louvain == 2;
sort $c_degree desc;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,373,Find the characters with a book1PageRank greater than 3 and a book45PageRank less than 2.,"MATCH (c:Character)
WHERE c.book1PageRank > 3 AND c.book45PageRank < 2
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book1_page_rank > 3;
  $c_book45_page_rank < 2;
fetch { ""c_name"": $c.name };"
gameofthrones,375,List the characters who are part of community 504 and have a degree greater than 20.,"MATCH (c:Character)
WHERE c.community = 504 AND c.degree > 20
RETURN c","match
  $c isa character;
  $c has community $c_community;
  $c has degree $c_degree;
  $c_community == 504;
  $c_degree > 20;
fetch { ""c_name"": $c.name };"
gameofthrones,378,Name the characters with a louvain value of 6 and a pagerank greater than 0.3.,"MATCH (c:Character)
WHERE c.louvain = 6 AND c.pagerank > 0.3
RETURN c.name","match
  $c isa character;
  $c has louvain $c_louvain;
  $c has pagerank $c_pagerank;
  $c_louvain == 6;
  $c_pagerank > 0.3;
fetch { ""c_name"": $c.name };"
gameofthrones,379,List the top 5 characters with a community number exactly 795.,"MATCH (c:Character)
WHERE c.community = 795
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 5","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community == 795;
sort $c_pagerank desc;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,380,Find the characters who have a degree of zero and a book1PageRank greater than 0.5.,"MATCH (c:Character)
WHERE c.degree = 0 AND c.book1PageRank > 0.5
RETURN c","match
  $c isa character;
  $c has degree $c_degree;
  $c has book1_page_rank $c_book1_page_rank;
  $c_degree == 0;
  $c_book1_page_rank > 0.5;
fetch { ""c_name"": $c.name };"
gameofthrones,382,List the characters with a pagerank above 0.5 and an INTERACTS weight over 200.,"MATCH (c:Character)
WHERE c.pagerank > 0.5 AND EXISTS {
  (c)-[i:INTERACTS]->(other:Character)
  WHERE i.weight > 200
}
RETURN c.name AS character, c.pagerank AS pagerank","match
  $c isa character, has name $n, has pagerank $pr;
  (character1: $c, character2: $other) isa interacts, has weight $w;
  $pr > 0.5;
  $w > 200;
fetch { ""character"": $n, ""pagerank"": $pr };"
gameofthrones,383,What are the names of characters who have an INTERACTS2 book value of 2 and a weight greater than 50?,"MATCH (c:Character)-[i:INTERACTS2]->(other:Character)
WHERE i.book = 2 AND i.weight > 50
RETURN c.name","match
  $c isa character;
  $other isa character;
  (character1: $c, character2: $other) isa interacts2, has book $rel_book, has weight $rel_weight;
  $rel_book == 2;
  $rel_weight > 50;
fetch { ""c_name"": $c.name };"
gameofthrones,384,Identify the top 3 characters with the highest book1BetweennessCentrality and a community number of 759.,"MATCH (c:Character)
WHERE c.community = 759
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality DESC
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 759;
sort $c_book1_betweenness_centrality desc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c.book1_betweenness_centrality };"
gameofthrones,387,List the characters with a community number less than 600 and a pagerank greater than 0.4.,"MATCH (c:Character)
WHERE c.community < 600 AND c.pagerank > 0.4
RETURN c.name, c.community, c.pagerank","match
  $c isa character;
  $c has community $c_community;
  $c has pagerank $c_pagerank;
  $c_community < 600;
  $c_pagerank > 0.4;
fetch { ""c_name"": $c.name, ""c_community"": $c.community, ""c_pagerank"": $c.pagerank };"
gameofthrones,389,Find the characters with a book1PageRank less than 2 and a community number greater than 750.,"MATCH (c:Character)
WHERE c.book1PageRank < 2 AND c.community > 750
RETURN c","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has community $c_community;
  $c_book1_page_rank < 2;
  $c_community > 750;
fetch { ""c_name"": $c.name };"
gameofthrones,390,What are the names of the top 5 characters by pagerank who also have a centrality greater than 0.5?,"MATCH (c:Character)
WHERE c.centrality > 0.5
RETURN c.name
ORDER BY c.pagerank DESC
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has pagerank $c_pagerank;
  $c_centrality > 0.5;
sort $c_pagerank desc;
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,391,List the top 3 characters with the highest INTERACTS3 relationship weight.,"MATCH (c:Character)-[i:INTERACTS3]->(other:Character)
RETURN c.name AS character, max(i.weight) AS max_weight
ORDER BY max_weight DESC
LIMIT 3","match
  $c isa character, has name $cn;
  $other isa character;
  $rel isa interacts3 (character1: $c, character2: $other), has weight $w;
sort $w desc;
limit 3;
fetch { ""character"": $cn };"
gameofthrones,192,Which characters belong to the community with the highest number of relationships?,"MATCH (c:Character)
WITH c.community AS community, count(c) AS num_characters, count{(c)-[:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->()} AS num_relationships
ORDER BY num_relationships DESC
LIMIT 1
WITH community
MATCH (c:Character {community: community})
RETURN c.name AS character","match
$c isa character, has community $comm;
$rel isa $t ($c);
{ $t label interacts; } or { $t label interacts1; } or { $t label interacts2; } or { $t label interacts3; } or { $t label interacts45; };
reduce $rel_count = count($rel) groupby $comm;
sort $rel_count desc;
limit 1;
match $member isa character, has community $comm;
fetch { ""character"": $member.name };"
gameofthrones,222,Which characters belong to the community with the lowest number of relationships?,"MATCH (c:Character)
WHERE c.community IS NOT NULL
WITH c.community AS community, count{(c)-[:INTERACTS]->()} AS num_relationships
ORDER BY num_relationships
LIMIT 1
WITH community
MATCH (c:Character {community: community})
RETURN c.name AS character","match
$c isa character, has community $comm;
$rel isa interacts ($c);
reduce $rel_count = count($rel) groupby $comm;
sort $rel_count asc;
limit 1;
match $member isa character, has community $comm;
fetch { ""character"": $member.name };"
gameofthrones,348,List the top 5 characters based on the sum weight of their INTERACTS1 and INTERACTS2 relationships.,"MATCH (c:Character)
OPTIONAL MATCH (c)-[i1:INTERACTS1]->(other1)
OPTIONAL MATCH (c)-[i2:INTERACTS2]->(other2)
WITH c, sum(i1.weight) AS weight1, sum(i2.weight) AS weight2
RETURN c.name AS character, weight1 + weight2 AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5","with fun interacts1_weight_sum($c: character) -> integer:
  match $rel isa interacts1 ($c), has weight $w;
  return sum($w);
with fun interacts2_weight_sum($c: character) -> integer:
  match $rel isa interacts2 ($c), has weight $w;
  return sum($w);
match
$c isa character;
let $w1 = interacts1_weight_sum($c);
let $w2 = interacts2_weight_sum($c);
let $total = $w1 + $w2;
sort $total desc;
limit 5;
fetch { ""character"": $c.name, ""totalWeight"": $total };"
gameofthrones,359,Identify the top 3 characters based on the sum of their centrality values across all books.,"MATCH (c:Character)
WITH c, c.centrality + c.book45PageRank + c.book1BetweennessCentrality + c.book1PageRank + c.pagerank AS totalCentrality
RETURN c.name AS character, totalCentrality
ORDER BY totalCentrality DESC
LIMIT 3","match
$c isa character, has centrality $cent, has book45_page_rank $b45pr, 
  has book1_betweenness_centrality $b1bc, has book1_page_rank $b1pr, has pagerank $pr;
let $total = $cent + $b45pr + $b1bc + $b1pr + $pr;
sort $total desc;
limit 3;
fetch { ""character"": $c.name, ""totalCentrality"": $total };"
gameofthrones,361,Who are the top 3 characters based on the combination of book1PageRank and book45PageRank?,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL AND c.book45PageRank IS NOT NULL
RETURN c.name AS character, c.book1PageRank + c.book45PageRank AS combinedPageRank
ORDER BY combinedPageRank DESC
LIMIT 3","match
$c isa character, has book1_page_rank $b1pr, has book45_page_rank $b45pr;
let $combined = $b1pr + $b45pr;
sort $combined desc;
limit 3;
fetch { ""character"": $c.name, ""combinedPageRank"": $combined };"
gameofthrones,374,Who are the top 3 characters based on the sum of weights in their INTERACTS and INTERACTS3 relationships?,"MATCH (c:Character)
OPTIONAL MATCH (c)-[i:INTERACTS]->()
OPTIONAL MATCH (c)-[i3:INTERACTS3]->()
WITH c, sum(i.weight) AS interactsWeight, sum(i3.weight) AS interacts3Weight
RETURN c.name AS character, interactsWeight + interacts3Weight AS totalWeight
ORDER BY totalWeight DESC
LIMIT 3","with fun interacts_weight_sum($c: character) -> integer:
  match $rel isa interacts ($c), has weight $w;
  return sum($w);
with fun interacts3_weight_sum($c: character) -> integer:
  match $rel isa interacts3 ($c), has weight $w;
  return sum($w);
match
$c isa character;
let $w1 = interacts_weight_sum($c);
let $w2 = interacts3_weight_sum($c);
let $total = $w1 + $w2;
sort $total desc;
limit 3;
fetch { ""character"": $c.name, ""totalWeight"": $total };"
gameofthrones,385,Which characters are in the top 5 for the sum of their INTERACTS1 and INTERACTS2 weights?,"MATCH (c:Character)
OPTIONAL MATCH (c)-[i1:INTERACTS1]->(other1)
OPTIONAL MATCH (c)-[i2:INTERACTS2]->(other2)
WITH c, sum(i1.weight) AS weight1, sum(i2.weight) AS weight2
RETURN c.name AS character, weight1 + weight2 AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5","with fun interacts1_weight_sum($c: character) -> integer:
  match $rel isa interacts1 ($c), has weight $w;
  return sum($w);
with fun interacts2_weight_sum($c: character) -> integer:
  match $rel isa interacts2 ($c), has weight $w;
  return sum($w);
match
$c isa character;
let $w1 = interacts1_weight_sum($c);
let $w2 = interacts2_weight_sum($c);
let $total = $w1 + $w2;
sort $total desc;
limit 5;
fetch { ""character"": $c.name, ""totalWeight"": $total };"
gameofthrones,386,Name the top 3 characters based on the sum of their book1PageRank and book45PageRank.,"MATCH (c:Character)
WHERE c.book1PageRank IS NOT NULL AND c.book45PageRank IS NOT NULL
RETURN c.name, c.book1PageRank + c.book45PageRank AS totalPageRank
ORDER BY totalPageRank DESC
LIMIT 3","match
$c isa character, has book1_page_rank $b1pr, has book45_page_rank $b45pr;
let $total = $b1pr + $b45pr;
sort $total desc;
limit 3;
fetch { ""name"": $c.name, ""totalPageRank"": $total };"
gameofthrones,360,List the characters with the highest sum of INTERACTS weights across all books. Limit to top 5.,"MATCH (c:Character)-[i:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(other)
WITH c, sum(i.weight) AS totalWeight
ORDER BY totalWeight DESC
LIMIT 5
RETURN c.name AS character, totalWeight","match
  $c isa character, has name $n;
  $rel isa $t (character1: $c), has weight $w;
  { $t label interacts; } or { $t label interacts1; } or { $t label interacts2; } or { $t label interacts3; } or { $t label interacts45; };
reduce $total = sum($w) groupby $c, $n;
sort $total desc;
limit 5;
fetch { ""character"": $n, ""totalWeight"": $total };"
gameofthrones,367,Which characters are in the top 5 for louvain community size?,"MATCH (c:Character)
WITH c.louvain AS community, count(*) AS size
ORDER BY size DESC
LIMIT 5
MATCH (c:Character)
WHERE c.louvain = community
RETURN community, collect(c.name) AS characters","match
  $c isa character, has louvain $l;
reduce $count = count($c) groupby $l;
sort $count desc;
limit 5;
match
  $c2 isa character, has louvain $l, has name $n;
fetch { ""louvain"": $l, ""name"": $n };"
gameofthrones,369,Identify the top 5 characters with the most interactions in book 3.,"MATCH (c:Character)-[i:INTERACTS3]->(other:Character)
RETURN c.name AS character, sum(i.weight) AS total_interactions
ORDER BY total_interactions DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $rel isa interacts3 ($c), has weight $w;
reduce $total = sum($w) groupby $c, $cn;
sort $total desc;
limit 5;
fetch { ""character"": $cn, ""total_interactions"": $total };"
gameofthrones,376,Identify the top 5 characters based on the average of their centrality values across all books.,"MATCH (c:Character)
WHERE c.centrality IS NOT NULL
  AND exists {(c)-[:INTERACTS1]->()}
  AND exists {(c)-[:INTERACTS2]->()}
  AND exists {(c)-[:INTERACTS3]->()}
  AND exists {(c)-[:INTERACTS45]->()}
WITH c, 
  (coalesce(c.book1PageRank, 0) + 
   coalesce(c.book45PageRank, 0) +
   coalesce(c.pagerank, 0)) / 3 AS avgCentrality
RETURN c.name AS character, avgCentrality
ORDER BY avgCentrality DESC
LIMIT 5","match
  $c isa character, has name $n, has centrality $cent, has book1_page_rank $b1pr, has book45_page_rank $b45pr, has pagerank $pr;
  interacts1 (character1: $c);
  interacts2 (character1: $c);
  interacts3 (character1: $c);
  interacts45 (character1: $c);
let $avg_centrality = ($b1pr + $b45pr + $pr) / 3;
sort $avg_centrality desc;
limit 5;
fetch { ""character"": $n, ""avgCentrality"": $avg_centrality };
"
gameofthrones,377,Which characters have the highest sum of pagerank values across all books? Limit to top 5.,"MATCH (c:Character)
RETURN c.name AS character,
       c.pagerank + c.book1PageRank + c.book45PageRank AS totalPageRank
ORDER BY totalPageRank DESC
LIMIT 5","match
  $c isa character;
  $c has pagerank $pr;
  $c has book1_page_rank $b1pr;
  $c has book45_page_rank $b45pr;
let $total = $pr + $b1pr + $b45pr;
sort $total desc;
limit 5;
fetch { ""character"": $c.name, ""totalPageRank"": $total };
"
gameofthrones,381,Who are the top 5 characters with the lowest book45PageRank but a book1PageRank greater than 4?,"MATCH (c:Character)
WHERE c.book1PageRank > 4
RETURN c.name, c.book45PageRank, c.book1PageRank
ORDER BY c.book45PageRank
LIMIT 5","match
  $c isa character;
  $c has book1_page_rank $c_book1_page_rank;
  $c has book45_page_rank $c_book45_page_rank;
  $c_book1_page_rank > 4;
sort $c_book45_page_rank asc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book45_page_rank"": $c.book45_page_rank, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,388,Who are the top 5 characters based on the combination of centrality and degree?,"MATCH (c:Character)
RETURN c.name, c.centrality, c.degree
ORDER BY c.centrality DESC, c.degree DESC
LIMIT 5","match
  $c isa character;
  $c has centrality $c_centrality;
  $c has degree $c_degree;
sort $c_centrality desc, $c_degree desc;
limit 5;
fetch { ""c_name"": $c.name, ""c_centrality"": $c_centrality, ""c_degree"": $c_degree };"
gameofthrones,52,Which characters have the lowest 'book1BetweennessCentrality' and are part of community 579? Provide first 3 results.,"MATCH (c:Character)
WHERE c.community = 579
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 579;
sort $c_book1_betweenness_centrality asc;
limit 3;
fetch { ""name"": $c.name, ""book1_betweenness_centrality"": $c_book1_betweenness_centrality };"
gameofthrones,53,Identify all characters with a 'pagerank' below 0.2 and list top 3.,"MATCH (c:Character)
WHERE c.pagerank < 0.2
RETURN c.name, c.pagerank
ORDER BY c.pagerank
LIMIT 3","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 0.2;
sort $c_pagerank asc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,68,Who interacted with 'Walder-Rivers' in 'book 45'? List first 3 characters.,"MATCH (c:Character)-[i:INTERACTS45]->(w:Character {name: 'Walder-Rivers'})
RETURN c.name
LIMIT 3","match
  $c isa character, has name $cn;
  $target isa character, has name ""Walder-Rivers"";
  interacts45 ($c, $target);
limit 3;
fetch { ""c_name"": $cn };"
gameofthrones,73,Find the characters who have interacted with 'Murenmure' in 'book 45'. List the top 5.,"MATCH (c:Character)-[i:INTERACTS45]->(m:Character {name: 'Murenmure'})
RETURN c.name AS character, i.weight AS interactions
ORDER BY interactions DESC
LIMIT 5","match
  $c isa character, has name $cn;
  $target isa character, has name ""Murenmure"";
  $rel isa interacts45 ($c, $target);
  $rel has weight $w;
sort $w desc;
limit 5;
fetch { ""character"": $cn, ""interactions"": $w };"
gameofthrones,76,Which characters have the lowest 'book1BetweennessCentrality' and are part of community 642? Provide first 3 results.,"MATCH (c:Character)
WHERE c.community = 642
RETURN c.name, c.book1BetweennessCentrality
ORDER BY c.book1BetweennessCentrality
LIMIT 3","match
  $c isa character;
  $c has community $c_community;
  $c has book1_betweenness_centrality $c_book1_betweenness_centrality;
  $c_community == 642;
sort $c_book1_betweenness_centrality asc;
limit 3;
fetch { ""c_name"": $c.name, ""c_book1_betweenness_centrality"": $c_book1_betweenness_centrality };"
gameofthrones,77,Identify all characters with a 'pagerank' below 0.3 and list top 3.,"MATCH (c:Character)
WHERE c.pagerank < 0.3
RETURN c.name, c.pagerank
ORDER BY c.pagerank
LIMIT 3","match
  $c isa character;
  $c has pagerank $c_pagerank;
  $c_pagerank < 0.3;
sort $c_pagerank asc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,92,Who interacted with 'Aeron-Greyjoy' in 'book 45'? List first 3 characters.,"MATCH (c:Character)-[i:INTERACTS45]->(a:Character {name: 'Aeron-Greyjoy'})
RETURN c.name
LIMIT 3","match
  $c isa character, has name $cn;
  $target isa character, has name ""Aeron-Greyjoy"";
  interacts45 ($c, $target);
  not { $c is $target; };
limit 3;
fetch { ""c_name"": $cn };"
gameofthrones,130,List the characters that interact in book 45 with any character named 'Aegon-I-Targaryen'.,"MATCH (c1:Character)-[:INTERACTS45]->(c2:Character {name: 'Aegon-I-Targaryen'})
RETURN c1.name AS character","match
  $c isa character, has name $cn;
  $target isa character, has name ""Aegon-I-Targaryen"";
  (character1: $c, character2: $target) isa interacts45;
fetch { ""character"": $cn };"
gameofthrones,157,List the characters whose name contains 'Greyjoy'.,"MATCH (c:Character)
WHERE c.name CONTAINS 'Greyjoy'
RETURN c.name","match
  $c isa character, has name $n;
  $n like "".*Greyjoy.*"";
fetch { ""c_name"": $n };"
gameofthrones,171,Find characters in the top 3 communities by number of members.,"MATCH (c:Character)
WITH c.community AS community, count(*) AS members
ORDER BY members DESC
LIMIT 3
WITH collect(community) AS top_communities
MATCH (c:Character)
WHERE c.community IN top_communities
RETURN c.name AS character, c.community AS community","match
  $c isa character, has community $comm;
reduce $count = count($c) groupby $comm;
sort $count desc;
limit 3;
match
  $c2 isa character, has community $comm, has name $n;
fetch { ""character"": $n, ""community"": $comm };"
gameofthrones,183,Find characters connected by any INTERACTS relationship with a weight over 200.,"MATCH (c1:Character)-[r:INTERACTS|INTERACTS1|INTERACTS2|INTERACTS3|INTERACTS45]->(c2:Character)
WHERE r.weight > 200
RETURN c1.name, r, c2.name","match
  $rel isa $t (character1: $c1, character2: $c2);
  { $t label interacts; } or { $t label interacts1; } or { $t label interacts2; } or { $t label interacts3; } or { $t label interacts45; };
  $rel has weight $w;
  $w > 200;
  $c1 has name $n1;
  $c2 has name $n2;
fetch { ""character1"": $n1, ""character2"": $n2, ""weight"": $w };"
gameofthrones,206,Identify the top 3 most frequent communities in INTERACTS relationships.,"MATCH (c1:Character)-[i:INTERACTS]->(c2:Character)
RETURN c1.community, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 3","match
  interacts (character1: $c1, character2: $c2);
  $c1 has community $comm;
reduce $count = count groupby $comm;
sort $count desc;
limit 3;
fetch { ""community"": $comm, ""frequency"": $count };
"
gameofthrones,212,Find characters in the top 3 louvain communities by centrality.,"MATCH (c:Character)
WHERE c.louvain IN [0, 1, 2]
RETURN c.name AS character, c.louvain AS community, c.centrality
ORDER BY c.centrality DESC","match
  $c isa character, has louvain $l, has centrality $centrality;
  { $l == 0; } or { $l == 1; } or { $l == 2; };
sort $centrality desc;
fetch { ""character"": $c.name, ""community"": $l, ""centrality"": $centrality };"
gameofthrones,213,Who has the lowest book1PageRank in community 579?,"MATCH (c:Character)
WHERE c.community = 579
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank
LIMIT 1","match
  $c isa character;
  $c has community $c_community;
  $c has book1_page_rank $c_book1_page_rank;
  $c_community == 579;
sort $c_book1_page_rank asc;
limit 1;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,236,Identify the top 5 most frequent communities in INTERACTS1 relationships.,"MATCH (c1:Character)-[i:INTERACTS1]->(c2:Character)
RETURN c1.community AS community, count(*) AS frequency
ORDER BY frequency DESC
LIMIT 5","match
  interacts1 (character1: $c1, character2: $c2);
  $c1 has community $comm;
reduce $count = count groupby $comm;
sort $count desc;
limit 5;
fetch { ""community"": $comm, ""frequency"": $count };
"
gameofthrones,267,Who has the lowest weight in an INTERACTS3 relationship?,"MATCH (c1:Character)-[r:INTERACTS3]->(c2:Character)
RETURN c1.name, c2.name, r.weight AS weight
ORDER BY r.weight
LIMIT 1","match
  $c1 isa character;
  $c2 isa character;
  (character1: $c1, character2: $c2) isa interacts3, has weight $rel_weight;
sort $rel_weight asc;
limit 1;
fetch { ""c1_name"": $c1.name, ""c2_name"": $c2.name, ""weight"": $rel_weight };"
gameofthrones,277,Who are the top 5 characters with the lowest pagerank?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank
LIMIT 5","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank asc;
limit 5;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,290,Who are the top 3 characters with the lowest degree?,"MATCH (c:Character)
RETURN c.name, c.degree
ORDER BY c.degree
LIMIT 3","match
  $c isa character;
  $c has degree $c_degree;
sort $c_degree asc;
limit 3;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
gameofthrones,296,Who are the top 3 characters with the highest weight in INTERACTS relationships?,"MATCH (c:Character)-[i:INTERACTS]->(other:Character)
RETURN c.name AS character, sum(i.weight) AS total_weight
ORDER BY total_weight DESC
LIMIT 3","match
  $c isa character, has name $cn;
  $rel isa interacts ($c), has weight $w;
reduce $total = sum($w) groupby $c, $cn;
sort $total desc;
limit 3;
fetch { ""character"": $cn, ""total_weight"": $total };"
gameofthrones,302,Who are the top 3 characters with the lowest pagerank?,"MATCH (c:Character)
RETURN c.name, c.pagerank
ORDER BY c.pagerank
LIMIT 3","match
  $c isa character;
  $c has pagerank $c_pagerank;
sort $c_pagerank asc;
limit 3;
fetch { ""c_name"": $c.name, ""c_pagerank"": $c.pagerank };"
gameofthrones,320,Who are the top 3 characters with the lowest book45PageRank?,"MATCH (c:Character)
WHERE c.book45PageRank IS NOT NULL
RETURN c.name, c.book45PageRank
ORDER BY c.book45PageRank
LIMIT 3","match
  $c isa character, has name $n, has book45_page_rank $pr;
sort $pr asc;
limit 3;
fetch { ""name"": $n, ""book45_page_rank"": $pr };"
gameofthrones,323,Who are the top 5 characters with the lowest weight in INTERACTS3 relationships?,"MATCH (c:Character)-[i:INTERACTS3]->(other:Character)
RETURN c.name, min(i.weight) AS minWeight
ORDER BY minWeight
LIMIT 5","match
  $c isa character;
  $other isa character;
  $rel isa interacts3 (character1: $c, character2: $other), has weight $w;
sort $w asc;
limit 5;
fetch { ""name"": $c.name, ""weight"": $w };"
gameofthrones,336,Name 3 characters from the community with the highest number of members.,"MATCH (c:Character)
WITH c.community AS community, count(*) AS members
ORDER BY members DESC
LIMIT 1
WITH collect(community)[0] AS top_community
MATCH (c:Character {community: top_community})
RETURN c.name
LIMIT 3","match
  $c isa character, has community $comm;
reduce $count = count($c) groupby $comm;
sort $count desc;
limit 1;
match
  $c2 isa character, has community $comm, has name $n;
limit 3;
fetch { ""name"": $n };"
gameofthrones,342,Who are the top 5 characters with the lowest book1PageRank but more than zero degree?,"MATCH (c:Character)
WHERE c.degree > 0
RETURN c.name, c.book1PageRank
ORDER BY c.book1PageRank
LIMIT 5","match
  $c isa character;
  $c has degree $c_degree;
  $c has book1_page_rank $c_book1_page_rank;
  $c_degree > 0;
sort $c_book1_page_rank asc;
limit 5;
fetch { ""c_name"": $c.name, ""c_book1_page_rank"": $c.book1_page_rank };"
gameofthrones,353,List the characters who are part of both community 578 and 579. Limit to 5 characters.,"MATCH (c:Character)
WHERE c.community IN [578, 579]
RETURN c.name
LIMIT 5","match
  $c isa character, has community $comm;
  { $comm == 578; } or { $comm == 579; };
limit 5;
fetch { ""c_name"": $c.name };"
gameofthrones,358,Which characters have the lowest degree but are part of community 795? Limit to top 5.,"MATCH (c:Character)
WHERE c.community = 795
RETURN c.name, c.degree
ORDER BY c.degree
LIMIT 5","match
  $c isa character;
  $c has community $c_community;
  $c has degree $c_degree;
  $c_community == 795;
sort $c_degree asc;
limit 5;
fetch { ""c_name"": $c.name, ""c_degree"": $c.degree };"
